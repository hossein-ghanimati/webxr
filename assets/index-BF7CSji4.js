(function(){const U=document.createElement("link").relList;if(U&&U.supports&&U.supports("modulepreload"))return;for(const ne of document.querySelectorAll('link[rel="modulepreload"]'))ie(ne);new MutationObserver(ne=>{for(const F of ne)if(F.type==="childList")for(const fe of F.addedNodes)fe.tagName==="LINK"&&fe.rel==="modulepreload"&&ie(fe)}).observe(document,{childList:!0,subtree:!0});function Y(ne){const F={};return ne.integrity&&(F.integrity=ne.integrity),ne.referrerPolicy&&(F.referrerPolicy=ne.referrerPolicy),ne.crossOrigin==="use-credentials"?F.credentials="include":ne.crossOrigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function ie(ne){if(ne.ep)return;ne.ep=!0;const F=Y(ne);fetch(ne.href,F)}})();function getAugmentedNamespace(re){if(re.__esModule)return re;var U=re.default;if(typeof U=="function"){var Y=function ie(){return this instanceof ie?Reflect.construct(U,arguments,this.constructor):U.apply(this,arguments)};Y.prototype=U.prototype}else Y={};return Object.defineProperty(Y,"__esModule",{value:!0}),Object.keys(re).forEach(function(ie){var ne=Object.getOwnPropertyDescriptor(re,ie);Object.defineProperty(Y,ie,ne.get?ne:{enumerable:!0,get:function(){return re[ie]}})}),Y}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var re=Symbol.for("react.element"),U=Symbol.for("react.portal"),Y=Symbol.for("react.fragment"),ie=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),fe=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),ve=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),me=Symbol.iterator;function Te(Tt){return Tt===null||typeof Tt!="object"?null:(Tt=me&&Tt[me]||Tt["@@iterator"],typeof Tt=="function"?Tt:null)}var Re={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},be=Object.assign,Pe={};function Le(Tt,Xt,hn){this.props=Tt,this.context=Xt,this.refs=Pe,this.updater=hn||Re}Le.prototype.isReactComponent={},Le.prototype.setState=function(Tt,Xt){if(typeof Tt!="object"&&typeof Tt!="function"&&Tt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Tt,Xt,"setState")},Le.prototype.forceUpdate=function(Tt){this.updater.enqueueForceUpdate(this,Tt,"forceUpdate")};function xe(){}xe.prototype=Le.prototype;function Fe(Tt,Xt,hn){this.props=Tt,this.context=Xt,this.refs=Pe,this.updater=hn||Re}var Oe=Fe.prototype=new xe;Oe.constructor=Fe,be(Oe,Le.prototype),Oe.isPureReactComponent=!0;var Ne=Array.isArray,ke=Object.prototype.hasOwnProperty,Ve={current:null},Xe={key:!0,ref:!0,__self:!0,__source:!0};function $e(Tt,Xt,hn){var nn,An={},Cn=null,Nn=null;if(Xt!=null)for(nn in Xt.ref!==void 0&&(Nn=Xt.ref),Xt.key!==void 0&&(Cn=""+Xt.key),Xt)ke.call(Xt,nn)&&!Xe.hasOwnProperty(nn)&&(An[nn]=Xt[nn]);var Qn=arguments.length-2;if(Qn===1)An.children=hn;else if(1<Qn){for(var fi=Array(Qn),hi=0;hi<Qn;hi++)fi[hi]=arguments[hi+2];An.children=fi}if(Tt&&Tt.defaultProps)for(nn in Qn=Tt.defaultProps,Qn)An[nn]===void 0&&(An[nn]=Qn[nn]);return{$$typeof:re,type:Tt,key:Cn,ref:Nn,props:An,_owner:Ve.current}}function st(Tt,Xt){return{$$typeof:re,type:Tt.type,key:Xt,ref:Tt.ref,props:Tt.props,_owner:Tt._owner}}function ze(Tt){return typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===re}function tt(Tt){var Xt={"=":"=0",":":"=2"};return"$"+Tt.replace(/[=:]/g,function(hn){return Xt[hn]})}var ft=/\/+/g;function Rt(Tt,Xt){return typeof Tt=="object"&&Tt!==null&&Tt.key!=null?tt(""+Tt.key):Xt.toString(36)}function Mt(Tt,Xt,hn,nn,An){var Cn=typeof Tt;(Cn==="undefined"||Cn==="boolean")&&(Tt=null);var Nn=!1;if(Tt===null)Nn=!0;else switch(Cn){case"string":case"number":Nn=!0;break;case"object":switch(Tt.$$typeof){case re:case U:Nn=!0}}if(Nn)return Nn=Tt,An=An(Nn),Tt=nn===""?"."+Rt(Nn,0):nn,Ne(An)?(hn="",Tt!=null&&(hn=Tt.replace(ft,"$&/")+"/"),Mt(An,Xt,hn,"",function(hi){return hi})):An!=null&&(ze(An)&&(An=st(An,hn+(!An.key||Nn&&Nn.key===An.key?"":(""+An.key).replace(ft,"$&/")+"/")+Tt)),Xt.push(An)),1;if(Nn=0,nn=nn===""?".":nn+":",Ne(Tt))for(var Qn=0;Qn<Tt.length;Qn++){Cn=Tt[Qn];var fi=nn+Rt(Cn,Qn);Nn+=Mt(Cn,Xt,hn,fi,An)}else if(fi=Te(Tt),typeof fi=="function")for(Tt=fi.call(Tt),Qn=0;!(Cn=Tt.next()).done;)Cn=Cn.value,fi=nn+Rt(Cn,Qn++),Nn+=Mt(Cn,Xt,hn,fi,An);else if(Cn==="object")throw Xt=String(Tt),Error("Objects are not valid as a React child (found: "+(Xt==="[object Object]"?"object with keys {"+Object.keys(Tt).join(", ")+"}":Xt)+"). If you meant to render a collection of children, use an array instead.");return Nn}function Gt(Tt,Xt,hn){if(Tt==null)return Tt;var nn=[],An=0;return Mt(Tt,nn,"","",function(Cn){return Xt.call(hn,Cn,An++)}),nn}function _t(Tt){if(Tt._status===-1){var Xt=Tt._result;Xt=Xt(),Xt.then(function(hn){(Tt._status===0||Tt._status===-1)&&(Tt._status=1,Tt._result=hn)},function(hn){(Tt._status===0||Tt._status===-1)&&(Tt._status=2,Tt._result=hn)}),Tt._status===-1&&(Tt._status=0,Tt._result=Xt)}if(Tt._status===1)return Tt._result.default;throw Tt._result}var Bt={current:null},dt={transition:null},ut={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:dt,ReactCurrentOwner:Ve};function Ut(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:Gt,forEach:function(Tt,Xt,hn){Gt(Tt,function(){Xt.apply(this,arguments)},hn)},count:function(Tt){var Xt=0;return Gt(Tt,function(){Xt++}),Xt},toArray:function(Tt){return Gt(Tt,function(Xt){return Xt})||[]},only:function(Tt){if(!ze(Tt))throw Error("React.Children.only expected to receive a single React element child.");return Tt}},react_production_min.Component=Le,react_production_min.Fragment=Y,react_production_min.Profiler=ne,react_production_min.PureComponent=Fe,react_production_min.StrictMode=ie,react_production_min.Suspense=Me,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ut,react_production_min.act=Ut,react_production_min.cloneElement=function(Tt,Xt,hn){if(Tt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Tt+".");var nn=be({},Tt.props),An=Tt.key,Cn=Tt.ref,Nn=Tt._owner;if(Xt!=null){if(Xt.ref!==void 0&&(Cn=Xt.ref,Nn=Ve.current),Xt.key!==void 0&&(An=""+Xt.key),Tt.type&&Tt.type.defaultProps)var Qn=Tt.type.defaultProps;for(fi in Xt)ke.call(Xt,fi)&&!Xe.hasOwnProperty(fi)&&(nn[fi]=Xt[fi]===void 0&&Qn!==void 0?Qn[fi]:Xt[fi])}var fi=arguments.length-2;if(fi===1)nn.children=hn;else if(1<fi){Qn=Array(fi);for(var hi=0;hi<fi;hi++)Qn[hi]=arguments[hi+2];nn.children=Qn}return{$$typeof:re,type:Tt.type,key:An,ref:Cn,props:nn,_owner:Nn}},react_production_min.createContext=function(Tt){return Tt={$$typeof:fe,_currentValue:Tt,_currentValue2:Tt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Tt.Provider={$$typeof:F,_context:Tt},Tt.Consumer=Tt},react_production_min.createElement=$e,react_production_min.createFactory=function(Tt){var Xt=$e.bind(null,Tt);return Xt.type=Tt,Xt},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(Tt){return{$$typeof:pe,render:Tt}},react_production_min.isValidElement=ze,react_production_min.lazy=function(Tt){return{$$typeof:se,_payload:{_status:-1,_result:Tt},_init:_t}},react_production_min.memo=function(Tt,Xt){return{$$typeof:ve,type:Tt,compare:Xt===void 0?null:Xt}},react_production_min.startTransition=function(Tt){var Xt=dt.transition;dt.transition={};try{Tt()}finally{dt.transition=Xt}},react_production_min.unstable_act=Ut,react_production_min.useCallback=function(Tt,Xt){return Bt.current.useCallback(Tt,Xt)},react_production_min.useContext=function(Tt){return Bt.current.useContext(Tt)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(Tt){return Bt.current.useDeferredValue(Tt)},react_production_min.useEffect=function(Tt,Xt){return Bt.current.useEffect(Tt,Xt)},react_production_min.useId=function(){return Bt.current.useId()},react_production_min.useImperativeHandle=function(Tt,Xt,hn){return Bt.current.useImperativeHandle(Tt,Xt,hn)},react_production_min.useInsertionEffect=function(Tt,Xt){return Bt.current.useInsertionEffect(Tt,Xt)},react_production_min.useLayoutEffect=function(Tt,Xt){return Bt.current.useLayoutEffect(Tt,Xt)},react_production_min.useMemo=function(Tt,Xt){return Bt.current.useMemo(Tt,Xt)},react_production_min.useReducer=function(Tt,Xt,hn){return Bt.current.useReducer(Tt,Xt,hn)},react_production_min.useRef=function(Tt){return Bt.current.useRef(Tt)},react_production_min.useState=function(Tt){return Bt.current.useState(Tt)},react_production_min.useSyncExternalStore=function(Tt,Xt,hn){return Bt.current.useSyncExternalStore(Tt,Xt,hn)},react_production_min.useTransition=function(){return Bt.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var re=requireReact(),U=Symbol.for("react.element"),Y=Symbol.for("react.fragment"),ie=Object.prototype.hasOwnProperty,ne=re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F={key:!0,ref:!0,__self:!0,__source:!0};function fe(pe,Me,ve){var se,me={},Te=null,Re=null;ve!==void 0&&(Te=""+ve),Me.key!==void 0&&(Te=""+Me.key),Me.ref!==void 0&&(Re=Me.ref);for(se in Me)ie.call(Me,se)&&!F.hasOwnProperty(se)&&(me[se]=Me[se]);if(pe&&pe.defaultProps)for(se in Me=pe.defaultProps,Me)me[se]===void 0&&(me[se]=Me[se]);return{$$typeof:U,type:pe,key:Te,ref:Re,props:me,_owner:ne.current}}return reactJsxRuntime_production_min.Fragment=Y,reactJsxRuntime_production_min.jsx=fe,reactJsxRuntime_production_min.jsxs=fe,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact(),client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,function(re){function U(dt,ut){var Ut=dt.length;dt.push(ut);e:for(;0<Ut;){var Tt=Ut-1>>>1,Xt=dt[Tt];if(0<ne(Xt,ut))dt[Tt]=ut,dt[Ut]=Xt,Ut=Tt;else break e}}function Y(dt){return dt.length===0?null:dt[0]}function ie(dt){if(dt.length===0)return null;var ut=dt[0],Ut=dt.pop();if(Ut!==ut){dt[0]=Ut;e:for(var Tt=0,Xt=dt.length,hn=Xt>>>1;Tt<hn;){var nn=2*(Tt+1)-1,An=dt[nn],Cn=nn+1,Nn=dt[Cn];if(0>ne(An,Ut))Cn<Xt&&0>ne(Nn,An)?(dt[Tt]=Nn,dt[Cn]=Ut,Tt=Cn):(dt[Tt]=An,dt[nn]=Ut,Tt=nn);else if(Cn<Xt&&0>ne(Nn,Ut))dt[Tt]=Nn,dt[Cn]=Ut,Tt=Cn;else break e}}return ut}function ne(dt,ut){var Ut=dt.sortIndex-ut.sortIndex;return Ut!==0?Ut:dt.id-ut.id}if(typeof performance=="object"&&typeof performance.now=="function"){var F=performance;re.unstable_now=function(){return F.now()}}else{var fe=Date,pe=fe.now();re.unstable_now=function(){return fe.now()-pe}}var Me=[],ve=[],se=1,me=null,Te=3,Re=!1,be=!1,Pe=!1,Le=typeof setTimeout=="function"?setTimeout:null,xe=typeof clearTimeout=="function"?clearTimeout:null,Fe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Oe(dt){for(var ut=Y(ve);ut!==null;){if(ut.callback===null)ie(ve);else if(ut.startTime<=dt)ie(ve),ut.sortIndex=ut.expirationTime,U(Me,ut);else break;ut=Y(ve)}}function Ne(dt){if(Pe=!1,Oe(dt),!be)if(Y(Me)!==null)be=!0,_t(ke);else{var ut=Y(ve);ut!==null&&Bt(Ne,ut.startTime-dt)}}function ke(dt,ut){be=!1,Pe&&(Pe=!1,xe($e),$e=-1),Re=!0;var Ut=Te;try{for(Oe(ut),me=Y(Me);me!==null&&(!(me.expirationTime>ut)||dt&&!tt());){var Tt=me.callback;if(typeof Tt=="function"){me.callback=null,Te=me.priorityLevel;var Xt=Tt(me.expirationTime<=ut);ut=re.unstable_now(),typeof Xt=="function"?me.callback=Xt:me===Y(Me)&&ie(Me),Oe(ut)}else ie(Me);me=Y(Me)}if(me!==null)var hn=!0;else{var nn=Y(ve);nn!==null&&Bt(Ne,nn.startTime-ut),hn=!1}return hn}finally{me=null,Te=Ut,Re=!1}}var Ve=!1,Xe=null,$e=-1,st=5,ze=-1;function tt(){return!(re.unstable_now()-ze<st)}function ft(){if(Xe!==null){var dt=re.unstable_now();ze=dt;var ut=!0;try{ut=Xe(!0,dt)}finally{ut?Rt():(Ve=!1,Xe=null)}}else Ve=!1}var Rt;if(typeof Fe=="function")Rt=function(){Fe(ft)};else if(typeof MessageChannel<"u"){var Mt=new MessageChannel,Gt=Mt.port2;Mt.port1.onmessage=ft,Rt=function(){Gt.postMessage(null)}}else Rt=function(){Le(ft,0)};function _t(dt){Xe=dt,Ve||(Ve=!0,Rt())}function Bt(dt,ut){$e=Le(function(){dt(re.unstable_now())},ut)}re.unstable_IdlePriority=5,re.unstable_ImmediatePriority=1,re.unstable_LowPriority=4,re.unstable_NormalPriority=3,re.unstable_Profiling=null,re.unstable_UserBlockingPriority=2,re.unstable_cancelCallback=function(dt){dt.callback=null},re.unstable_continueExecution=function(){be||Re||(be=!0,_t(ke))},re.unstable_forceFrameRate=function(dt){0>dt||125<dt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):st=0<dt?Math.floor(1e3/dt):5},re.unstable_getCurrentPriorityLevel=function(){return Te},re.unstable_getFirstCallbackNode=function(){return Y(Me)},re.unstable_next=function(dt){switch(Te){case 1:case 2:case 3:var ut=3;break;default:ut=Te}var Ut=Te;Te=ut;try{return dt()}finally{Te=Ut}},re.unstable_pauseExecution=function(){},re.unstable_requestPaint=function(){},re.unstable_runWithPriority=function(dt,ut){switch(dt){case 1:case 2:case 3:case 4:case 5:break;default:dt=3}var Ut=Te;Te=dt;try{return ut()}finally{Te=Ut}},re.unstable_scheduleCallback=function(dt,ut,Ut){var Tt=re.unstable_now();switch(typeof Ut=="object"&&Ut!==null?(Ut=Ut.delay,Ut=typeof Ut=="number"&&0<Ut?Tt+Ut:Tt):Ut=Tt,dt){case 1:var Xt=-1;break;case 2:Xt=250;break;case 5:Xt=1073741823;break;case 4:Xt=1e4;break;default:Xt=5e3}return Xt=Ut+Xt,dt={id:se++,callback:ut,priorityLevel:dt,startTime:Ut,expirationTime:Xt,sortIndex:-1},Ut>Tt?(dt.sortIndex=Ut,U(ve,dt),Y(Me)===null&&dt===Y(ve)&&(Pe?(xe($e),$e=-1):Pe=!0,Bt(Ne,Ut-Tt))):(dt.sortIndex=Xt,U(Me,dt),be||Re||(be=!0,_t(ke))),dt},re.unstable_shouldYield=tt,re.unstable_wrapCallback=function(dt){var ut=Te;return function(){var Ut=Te;Te=ut;try{return dt.apply(this,arguments)}finally{Te=Ut}}}}(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var re=requireReact(),U=requireScheduler();function Y(Ee){for(var Se="https://reactjs.org/docs/error-decoder.html?invariant="+Ee,Ge=1;Ge<arguments.length;Ge++)Se+="&args[]="+encodeURIComponent(arguments[Ge]);return"Minified React error #"+Ee+"; visit "+Se+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ie=new Set,ne={};function F(Ee,Se){fe(Ee,Se),fe(Ee+"Capture",Se)}function fe(Ee,Se){for(ne[Ee]=Se,Ee=0;Ee<Se.length;Ee++)ie.add(Se[Ee])}var pe=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Me=Object.prototype.hasOwnProperty,ve=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,se={},me={};function Te(Ee){return Me.call(me,Ee)?!0:Me.call(se,Ee)?!1:ve.test(Ee)?me[Ee]=!0:(se[Ee]=!0,!1)}function Re(Ee,Se,Ge,nt){if(Ge!==null&&Ge.type===0)return!1;switch(typeof Se){case"function":case"symbol":return!0;case"boolean":return nt?!1:Ge!==null?!Ge.acceptsBooleans:(Ee=Ee.toLowerCase().slice(0,5),Ee!=="data-"&&Ee!=="aria-");default:return!1}}function be(Ee,Se,Ge,nt){if(Se===null||typeof Se>"u"||Re(Ee,Se,Ge,nt))return!0;if(nt)return!1;if(Ge!==null)switch(Ge.type){case 3:return!Se;case 4:return Se===!1;case 5:return isNaN(Se);case 6:return isNaN(Se)||1>Se}return!1}function Pe(Ee,Se,Ge,nt,gt,Pt,en){this.acceptsBooleans=Se===2||Se===3||Se===4,this.attributeName=nt,this.attributeNamespace=gt,this.mustUseProperty=Ge,this.propertyName=Ee,this.type=Se,this.sanitizeURL=Pt,this.removeEmptyString=en}var Le={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(Ee){Le[Ee]=new Pe(Ee,0,!1,Ee,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(Ee){var Se=Ee[0];Le[Se]=new Pe(Se,1,!1,Ee[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(Ee){Le[Ee]=new Pe(Ee,2,!1,Ee.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(Ee){Le[Ee]=new Pe(Ee,2,!1,Ee,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(Ee){Le[Ee]=new Pe(Ee,3,!1,Ee.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(Ee){Le[Ee]=new Pe(Ee,3,!0,Ee,null,!1,!1)}),["capture","download"].forEach(function(Ee){Le[Ee]=new Pe(Ee,4,!1,Ee,null,!1,!1)}),["cols","rows","size","span"].forEach(function(Ee){Le[Ee]=new Pe(Ee,6,!1,Ee,null,!1,!1)}),["rowSpan","start"].forEach(function(Ee){Le[Ee]=new Pe(Ee,5,!1,Ee.toLowerCase(),null,!1,!1)});var xe=/[\-:]([a-z])/g;function Fe(Ee){return Ee[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(Ee){var Se=Ee.replace(xe,Fe);Le[Se]=new Pe(Se,1,!1,Ee,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(Ee){var Se=Ee.replace(xe,Fe);Le[Se]=new Pe(Se,1,!1,Ee,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(Ee){var Se=Ee.replace(xe,Fe);Le[Se]=new Pe(Se,1,!1,Ee,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(Ee){Le[Ee]=new Pe(Ee,1,!1,Ee.toLowerCase(),null,!1,!1)}),Le.xlinkHref=new Pe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(Ee){Le[Ee]=new Pe(Ee,1,!1,Ee.toLowerCase(),null,!0,!0)});function Oe(Ee,Se,Ge,nt){var gt=Le.hasOwnProperty(Se)?Le[Se]:null;(gt!==null?gt.type!==0:nt||!(2<Se.length)||Se[0]!=="o"&&Se[0]!=="O"||Se[1]!=="n"&&Se[1]!=="N")&&(be(Se,Ge,gt,nt)&&(Ge=null),nt||gt===null?Te(Se)&&(Ge===null?Ee.removeAttribute(Se):Ee.setAttribute(Se,""+Ge)):gt.mustUseProperty?Ee[gt.propertyName]=Ge===null?gt.type===3?!1:"":Ge:(Se=gt.attributeName,nt=gt.attributeNamespace,Ge===null?Ee.removeAttribute(Se):(gt=gt.type,Ge=gt===3||gt===4&&Ge===!0?"":""+Ge,nt?Ee.setAttributeNS(nt,Se,Ge):Ee.setAttribute(Se,Ge))))}var Ne=re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ke=Symbol.for("react.element"),Ve=Symbol.for("react.portal"),Xe=Symbol.for("react.fragment"),$e=Symbol.for("react.strict_mode"),st=Symbol.for("react.profiler"),ze=Symbol.for("react.provider"),tt=Symbol.for("react.context"),ft=Symbol.for("react.forward_ref"),Rt=Symbol.for("react.suspense"),Mt=Symbol.for("react.suspense_list"),Gt=Symbol.for("react.memo"),_t=Symbol.for("react.lazy"),Bt=Symbol.for("react.offscreen"),dt=Symbol.iterator;function ut(Ee){return Ee===null||typeof Ee!="object"?null:(Ee=dt&&Ee[dt]||Ee["@@iterator"],typeof Ee=="function"?Ee:null)}var Ut=Object.assign,Tt;function Xt(Ee){if(Tt===void 0)try{throw Error()}catch(Ge){var Se=Ge.stack.trim().match(/\n( *(at )?)/);Tt=Se&&Se[1]||""}return`
`+Tt+Ee}var hn=!1;function nn(Ee,Se){if(!Ee||hn)return"";hn=!0;var Ge=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Se)if(Se=function(){throw Error()},Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(Ei){var nt=Ei}Reflect.construct(Ee,[],Se)}else{try{Se.call()}catch(Ei){nt=Ei}Ee.call(Se.prototype)}else{try{throw Error()}catch(Ei){nt=Ei}Ee()}}catch(Ei){if(Ei&&nt&&typeof Ei.stack=="string"){for(var gt=Ei.stack.split(`
`),Pt=nt.stack.split(`
`),en=gt.length-1,Tn=Pt.length-1;1<=en&&0<=Tn&&gt[en]!==Pt[Tn];)Tn--;for(;1<=en&&0<=Tn;en--,Tn--)if(gt[en]!==Pt[Tn]){if(en!==1||Tn!==1)do if(en--,Tn--,0>Tn||gt[en]!==Pt[Tn]){var Hn=`
`+gt[en].replace(" at new "," at ");return Ee.displayName&&Hn.includes("<anonymous>")&&(Hn=Hn.replace("<anonymous>",Ee.displayName)),Hn}while(1<=en&&0<=Tn);break}}}finally{hn=!1,Error.prepareStackTrace=Ge}return(Ee=Ee?Ee.displayName||Ee.name:"")?Xt(Ee):""}function An(Ee){switch(Ee.tag){case 5:return Xt(Ee.type);case 16:return Xt("Lazy");case 13:return Xt("Suspense");case 19:return Xt("SuspenseList");case 0:case 2:case 15:return Ee=nn(Ee.type,!1),Ee;case 11:return Ee=nn(Ee.type.render,!1),Ee;case 1:return Ee=nn(Ee.type,!0),Ee;default:return""}}function Cn(Ee){if(Ee==null)return null;if(typeof Ee=="function")return Ee.displayName||Ee.name||null;if(typeof Ee=="string")return Ee;switch(Ee){case Xe:return"Fragment";case Ve:return"Portal";case st:return"Profiler";case $e:return"StrictMode";case Rt:return"Suspense";case Mt:return"SuspenseList"}if(typeof Ee=="object")switch(Ee.$$typeof){case tt:return(Ee.displayName||"Context")+".Consumer";case ze:return(Ee._context.displayName||"Context")+".Provider";case ft:var Se=Ee.render;return Ee=Ee.displayName,Ee||(Ee=Se.displayName||Se.name||"",Ee=Ee!==""?"ForwardRef("+Ee+")":"ForwardRef"),Ee;case Gt:return Se=Ee.displayName||null,Se!==null?Se:Cn(Ee.type)||"Memo";case _t:Se=Ee._payload,Ee=Ee._init;try{return Cn(Ee(Se))}catch{}}return null}function Nn(Ee){var Se=Ee.type;switch(Ee.tag){case 24:return"Cache";case 9:return(Se.displayName||"Context")+".Consumer";case 10:return(Se._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return Ee=Se.render,Ee=Ee.displayName||Ee.name||"",Se.displayName||(Ee!==""?"ForwardRef("+Ee+")":"ForwardRef");case 7:return"Fragment";case 5:return Se;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cn(Se);case 8:return Se===$e?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Se=="function")return Se.displayName||Se.name||null;if(typeof Se=="string")return Se}return null}function Qn(Ee){switch(typeof Ee){case"boolean":case"number":case"string":case"undefined":return Ee;case"object":return Ee;default:return""}}function fi(Ee){var Se=Ee.type;return(Ee=Ee.nodeName)&&Ee.toLowerCase()==="input"&&(Se==="checkbox"||Se==="radio")}function hi(Ee){var Se=fi(Ee)?"checked":"value",Ge=Object.getOwnPropertyDescriptor(Ee.constructor.prototype,Se),nt=""+Ee[Se];if(!Ee.hasOwnProperty(Se)&&typeof Ge<"u"&&typeof Ge.get=="function"&&typeof Ge.set=="function"){var gt=Ge.get,Pt=Ge.set;return Object.defineProperty(Ee,Se,{configurable:!0,get:function(){return gt.call(this)},set:function(en){nt=""+en,Pt.call(this,en)}}),Object.defineProperty(Ee,Se,{enumerable:Ge.enumerable}),{getValue:function(){return nt},setValue:function(en){nt=""+en},stopTracking:function(){Ee._valueTracker=null,delete Ee[Se]}}}}function Qi(Ee){Ee._valueTracker||(Ee._valueTracker=hi(Ee))}function Zi(Ee){if(!Ee)return!1;var Se=Ee._valueTracker;if(!Se)return!0;var Ge=Se.getValue(),nt="";return Ee&&(nt=fi(Ee)?Ee.checked?"true":"false":Ee.value),Ee=nt,Ee!==Ge?(Se.setValue(Ee),!0):!1}function Mn(Ee){if(Ee=Ee||(typeof document<"u"?document:void 0),typeof Ee>"u")return null;try{return Ee.activeElement||Ee.body}catch{return Ee.body}}function Vr(Ee,Se){var Ge=Se.checked;return Ut({},Se,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:Ge??Ee._wrapperState.initialChecked})}function Ir(Ee,Se){var Ge=Se.defaultValue==null?"":Se.defaultValue,nt=Se.checked!=null?Se.checked:Se.defaultChecked;Ge=Qn(Se.value!=null?Se.value:Ge),Ee._wrapperState={initialChecked:nt,initialValue:Ge,controlled:Se.type==="checkbox"||Se.type==="radio"?Se.checked!=null:Se.value!=null}}function Rr(Ee,Se){Se=Se.checked,Se!=null&&Oe(Ee,"checked",Se,!1)}function ir(Ee,Se){Rr(Ee,Se);var Ge=Qn(Se.value),nt=Se.type;if(Ge!=null)nt==="number"?(Ge===0&&Ee.value===""||Ee.value!=Ge)&&(Ee.value=""+Ge):Ee.value!==""+Ge&&(Ee.value=""+Ge);else if(nt==="submit"||nt==="reset"){Ee.removeAttribute("value");return}Se.hasOwnProperty("value")?Br(Ee,Se.type,Ge):Se.hasOwnProperty("defaultValue")&&Br(Ee,Se.type,Qn(Se.defaultValue)),Se.checked==null&&Se.defaultChecked!=null&&(Ee.defaultChecked=!!Se.defaultChecked)}function zr(Ee,Se,Ge){if(Se.hasOwnProperty("value")||Se.hasOwnProperty("defaultValue")){var nt=Se.type;if(!(nt!=="submit"&&nt!=="reset"||Se.value!==void 0&&Se.value!==null))return;Se=""+Ee._wrapperState.initialValue,Ge||Se===Ee.value||(Ee.value=Se),Ee.defaultValue=Se}Ge=Ee.name,Ge!==""&&(Ee.name=""),Ee.defaultChecked=!!Ee._wrapperState.initialChecked,Ge!==""&&(Ee.name=Ge)}function Br(Ee,Se,Ge){(Se!=="number"||Mn(Ee.ownerDocument)!==Ee)&&(Ge==null?Ee.defaultValue=""+Ee._wrapperState.initialValue:Ee.defaultValue!==""+Ge&&(Ee.defaultValue=""+Ge))}var kt=Array.isArray;function rn(Ee,Se,Ge,nt){if(Ee=Ee.options,Se){Se={};for(var gt=0;gt<Ge.length;gt++)Se["$"+Ge[gt]]=!0;for(Ge=0;Ge<Ee.length;Ge++)gt=Se.hasOwnProperty("$"+Ee[Ge].value),Ee[Ge].selected!==gt&&(Ee[Ge].selected=gt),gt&&nt&&(Ee[Ge].defaultSelected=!0)}else{for(Ge=""+Qn(Ge),Se=null,gt=0;gt<Ee.length;gt++){if(Ee[gt].value===Ge){Ee[gt].selected=!0,nt&&(Ee[gt].defaultSelected=!0);return}Se!==null||Ee[gt].disabled||(Se=Ee[gt])}Se!==null&&(Se.selected=!0)}}function Kn(Ee,Se){if(Se.dangerouslySetInnerHTML!=null)throw Error(Y(91));return Ut({},Se,{value:void 0,defaultValue:void 0,children:""+Ee._wrapperState.initialValue})}function ai(Ee,Se){var Ge=Se.value;if(Ge==null){if(Ge=Se.children,Se=Se.defaultValue,Ge!=null){if(Se!=null)throw Error(Y(92));if(kt(Ge)){if(1<Ge.length)throw Error(Y(93));Ge=Ge[0]}Se=Ge}Se==null&&(Se=""),Ge=Se}Ee._wrapperState={initialValue:Qn(Ge)}}function Ui(Ee,Se){var Ge=Qn(Se.value),nt=Qn(Se.defaultValue);Ge!=null&&(Ge=""+Ge,Ge!==Ee.value&&(Ee.value=Ge),Se.defaultValue==null&&Ee.defaultValue!==Ge&&(Ee.defaultValue=Ge)),nt!=null&&(Ee.defaultValue=""+nt)}function yi(Ee){var Se=Ee.textContent;Se===Ee._wrapperState.initialValue&&Se!==""&&Se!==null&&(Ee.value=Se)}function Nr(Ee){switch(Ee){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ar(Ee,Se){return Ee==null||Ee==="http://www.w3.org/1999/xhtml"?Nr(Se):Ee==="http://www.w3.org/2000/svg"&&Se==="foreignObject"?"http://www.w3.org/1999/xhtml":Ee}var fr,Bi=function(Ee){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(Se,Ge,nt,gt){MSApp.execUnsafeLocalFunction(function(){return Ee(Se,Ge,nt,gt)})}:Ee}(function(Ee,Se){if(Ee.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in Ee)Ee.innerHTML=Se;else{for(fr=fr||document.createElement("div"),fr.innerHTML="<svg>"+Se.valueOf().toString()+"</svg>",Se=fr.firstChild;Ee.firstChild;)Ee.removeChild(Ee.firstChild);for(;Se.firstChild;)Ee.appendChild(Se.firstChild)}});function Kt(Ee,Se){if(Se){var Ge=Ee.firstChild;if(Ge&&Ge===Ee.lastChild&&Ge.nodeType===3){Ge.nodeValue=Se;return}}Ee.textContent=Se}var Yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fn=["Webkit","ms","Moz","O"];Object.keys(Yt).forEach(function(Ee){fn.forEach(function(Se){Se=Se+Ee.charAt(0).toUpperCase()+Ee.substring(1),Yt[Se]=Yt[Ee]})});function on(Ee,Se,Ge){return Se==null||typeof Se=="boolean"||Se===""?"":Ge||typeof Se!="number"||Se===0||Yt.hasOwnProperty(Ee)&&Yt[Ee]?(""+Se).trim():Se+"px"}function an(Ee,Se){Ee=Ee.style;for(var Ge in Se)if(Se.hasOwnProperty(Ge)){var nt=Ge.indexOf("--")===0,gt=on(Ge,Se[Ge],nt);Ge==="float"&&(Ge="cssFloat"),nt?Ee.setProperty(Ge,gt):Ee[Ge]=gt}}var gn=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nt(Ee,Se){if(Se){if(gn[Ee]&&(Se.children!=null||Se.dangerouslySetInnerHTML!=null))throw Error(Y(137,Ee));if(Se.dangerouslySetInnerHTML!=null){if(Se.children!=null)throw Error(Y(60));if(typeof Se.dangerouslySetInnerHTML!="object"||!("__html"in Se.dangerouslySetInnerHTML))throw Error(Y(61))}if(Se.style!=null&&typeof Se.style!="object")throw Error(Y(62))}}function ht(Ee,Se){if(Ee.indexOf("-")===-1)return typeof Se.is=="string";switch(Ee){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ot=null;function Vt(Ee){return Ee=Ee.target||Ee.srcElement||window,Ee.correspondingUseElement&&(Ee=Ee.correspondingUseElement),Ee.nodeType===3?Ee.parentNode:Ee}var Wt=null,sn=null,yn=null;function ni(Ee){if(Ee=n0(Ee)){if(typeof Wt!="function")throw Error(Y(280));var Se=Ee.stateNode;Se&&(Se=vu(Se),Wt(Ee.stateNode,Ee.type,Se))}}function ki(Ee){sn?yn?yn.push(Ee):yn=[Ee]:sn=Ee}function Hi(){if(sn){var Ee=sn,Se=yn;if(yn=sn=null,ni(Ee),Se)for(Ee=0;Ee<Se.length;Ee++)ni(Se[Ee])}}function ji(Ee,Se){return Ee(Se)}function Xi(){}var Ws=!1;function Jr(Ee,Se,Ge){if(Ws)return Ee(Se,Ge);Ws=!0;try{return ji(Ee,Se,Ge)}finally{Ws=!1,(sn!==null||yn!==null)&&(Xi(),Hi())}}function Ai(Ee,Se){var Ge=Ee.stateNode;if(Ge===null)return null;var nt=vu(Ge);if(nt===null)return null;Ge=nt[Se];e:switch(Se){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(nt=!nt.disabled)||(Ee=Ee.type,nt=!(Ee==="button"||Ee==="input"||Ee==="select"||Ee==="textarea")),Ee=!nt;break e;default:Ee=!1}if(Ee)return null;if(Ge&&typeof Ge!="function")throw Error(Y(231,Se,typeof Ge));return Ge}var js=!1;if(pe)try{var Qs={};Object.defineProperty(Qs,"passive",{get:function(){js=!0}}),window.addEventListener("test",Qs,Qs),window.removeEventListener("test",Qs,Qs)}catch{js=!1}function Vo(Ee,Se,Ge,nt,gt,Pt,en,Tn,Hn){var Ei=Array.prototype.slice.call(arguments,3);try{Se.apply(Ge,Ei)}catch(ur){this.onError(ur)}}var Mo=!1,Ia=null,Do=!1,Ca=null,l0={onError:function(Ee){Mo=!0,Ia=Ee}};function Ra(Ee,Se,Ge,nt,gt,Pt,en,Tn,Hn){Mo=!1,Ia=null,Vo.apply(l0,arguments)}function ko(Ee,Se,Ge,nt,gt,Pt,en,Tn,Hn){if(Ra.apply(this,arguments),Mo){if(Mo){var Ei=Ia;Mo=!1,Ia=null}else throw Error(Y(198));Do||(Do=!0,Ca=Ei)}}function Ts(Ee){var Se=Ee,Ge=Ee;if(Ee.alternate)for(;Se.return;)Se=Se.return;else{Ee=Se;do Se=Ee,Se.flags&4098&&(Ge=Se.return),Ee=Se.return;while(Ee)}return Se.tag===3?Ge:null}function ta(Ee){if(Ee.tag===13){var Se=Ee.memoizedState;if(Se===null&&(Ee=Ee.alternate,Ee!==null&&(Se=Ee.memoizedState)),Se!==null)return Se.dehydrated}return null}function q0(Ee){if(Ts(Ee)!==Ee)throw Error(Y(188))}function dn(Ee){var Se=Ee.alternate;if(!Se){if(Se=Ts(Ee),Se===null)throw Error(Y(188));return Se!==Ee?null:Ee}for(var Ge=Ee,nt=Se;;){var gt=Ge.return;if(gt===null)break;var Pt=gt.alternate;if(Pt===null){if(nt=gt.return,nt!==null){Ge=nt;continue}break}if(gt.child===Pt.child){for(Pt=gt.child;Pt;){if(Pt===Ge)return q0(gt),Ee;if(Pt===nt)return q0(gt),Se;Pt=Pt.sibling}throw Error(Y(188))}if(Ge.return!==nt.return)Ge=gt,nt=Pt;else{for(var en=!1,Tn=gt.child;Tn;){if(Tn===Ge){en=!0,Ge=gt,nt=Pt;break}if(Tn===nt){en=!0,nt=gt,Ge=Pt;break}Tn=Tn.sibling}if(!en){for(Tn=Pt.child;Tn;){if(Tn===Ge){en=!0,Ge=Pt,nt=gt;break}if(Tn===nt){en=!0,nt=Pt,Ge=gt;break}Tn=Tn.sibling}if(!en)throw Error(Y(189))}}if(Ge.alternate!==nt)throw Error(Y(190))}if(Ge.tag!==3)throw Error(Y(188));return Ge.stateNode.current===Ge?Ee:Se}function qn(Ee){return Ee=dn(Ee),Ee!==null?di(Ee):null}function di(Ee){if(Ee.tag===5||Ee.tag===6)return Ee;for(Ee=Ee.child;Ee!==null;){var Se=di(Ee);if(Se!==null)return Se;Ee=Ee.sibling}return null}var $t=U.unstable_scheduleCallback,Jt=U.unstable_cancelCallback,xn=U.unstable_shouldYield,Vn=U.unstable_requestPaint,Dn=U.unstable_now,jn=U.unstable_getCurrentPriorityLevel,gi=U.unstable_ImmediatePriority,Wi=U.unstable_UserBlockingPriority,Li=U.unstable_NormalPriority,vi=U.unstable_LowPriority,yr=U.unstable_IdlePriority,Sr=null,Ur=null;function hs(Ee){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(Sr,Ee,void 0,(Ee.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:eo,as=Math.log,Yr=Math.LN2;function eo(Ee){return Ee>>>=0,Ee===0?32:31-(as(Ee)/Yr|0)|0}var wo=64,Er=4194304;function Ss(Ee){switch(Ee&-Ee){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Ee&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return Ee&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return Ee}}function bs(Ee,Se){var Ge=Ee.pendingLanes;if(Ge===0)return 0;var nt=0,gt=Ee.suspendedLanes,Pt=Ee.pingedLanes,en=Ge&268435455;if(en!==0){var Tn=en&~gt;Tn!==0?nt=Ss(Tn):(Pt&=en,Pt!==0&&(nt=Ss(Pt)))}else en=Ge&~gt,en!==0?nt=Ss(en):Pt!==0&&(nt=Ss(Pt));if(nt===0)return 0;if(Se!==0&&Se!==nt&&!(Se&gt)&&(gt=nt&-nt,Pt=Se&-Se,gt>=Pt||gt===16&&(Pt&4194240)!==0))return Se;if(nt&4&&(nt|=Ge&16),Se=Ee.entangledLanes,Se!==0)for(Ee=Ee.entanglements,Se&=nt;0<Se;)Ge=31-er(Se),gt=1<<Ge,nt|=Ee[Ge],Se&=~gt;return nt}function Ns(Ee,Se){switch(Ee){case 1:case 2:case 4:return Se+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Se+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function It(Ee,Se){for(var Ge=Ee.suspendedLanes,nt=Ee.pingedLanes,gt=Ee.expirationTimes,Pt=Ee.pendingLanes;0<Pt;){var en=31-er(Pt),Tn=1<<en,Hn=gt[en];Hn===-1?(!(Tn&Ge)||Tn&nt)&&(gt[en]=Ns(Tn,Se)):Hn<=Se&&(Ee.expiredLanes|=Tn),Pt&=~Tn}}function Ot(Ee){return Ee=Ee.pendingLanes&-1073741825,Ee!==0?Ee:Ee&1073741824?1073741824:0}function zt(){var Ee=wo;return wo<<=1,!(wo&4194240)&&(wo=64),Ee}function jt(Ee){for(var Se=[],Ge=0;31>Ge;Ge++)Se.push(Ee);return Se}function mn(Ee,Se,Ge){Ee.pendingLanes|=Se,Se!==536870912&&(Ee.suspendedLanes=0,Ee.pingedLanes=0),Ee=Ee.eventTimes,Se=31-er(Se),Ee[Se]=Ge}function kn(Ee,Se){var Ge=Ee.pendingLanes&~Se;Ee.pendingLanes=Se,Ee.suspendedLanes=0,Ee.pingedLanes=0,Ee.expiredLanes&=Se,Ee.mutableReadLanes&=Se,Ee.entangledLanes&=Se,Se=Ee.entanglements;var nt=Ee.eventTimes;for(Ee=Ee.expirationTimes;0<Ge;){var gt=31-er(Ge),Pt=1<<gt;Se[gt]=0,nt[gt]=-1,Ee[gt]=-1,Ge&=~Pt}}function Yn(Ee,Se){var Ge=Ee.entangledLanes|=Se;for(Ee=Ee.entanglements;Ge;){var nt=31-er(Ge),gt=1<<nt;gt&Se|Ee[nt]&Se&&(Ee[nt]|=Se),Ge&=~gt}}var xi=0;function zi(Ee){return Ee&=-Ee,1<Ee?4<Ee?Ee&268435455?16:536870912:4:1}var ti,bi,cr,Gr,Ki,As=!1,Ls=[],ys=null,ds=null,$s=null,Ao=new Map,Po=new Map,mo=[],fa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pa(Ee,Se){switch(Ee){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":$s=null;break;case"pointerover":case"pointerout":Ao.delete(Se.pointerId);break;case"gotpointercapture":case"lostpointercapture":Po.delete(Se.pointerId)}}function zo(Ee,Se,Ge,nt,gt,Pt){return Ee===null||Ee.nativeEvent!==Pt?(Ee={blockedOn:Se,domEventName:Ge,eventSystemFlags:nt,nativeEvent:Pt,targetContainers:[gt]},Se!==null&&(Se=n0(Se),Se!==null&&bi(Se)),Ee):(Ee.eventSystemFlags|=nt,Se=Ee.targetContainers,gt!==null&&Se.indexOf(gt)===-1&&Se.push(gt),Ee)}function Aa(Ee,Se,Ge,nt,gt){switch(Se){case"focusin":return ys=zo(ys,Ee,Se,Ge,nt,gt),!0;case"dragenter":return ds=zo(ds,Ee,Se,Ge,nt,gt),!0;case"mouseover":return $s=zo($s,Ee,Se,Ge,nt,gt),!0;case"pointerover":var Pt=gt.pointerId;return Ao.set(Pt,zo(Ao.get(Pt)||null,Ee,Se,Ge,nt,gt)),!0;case"gotpointercapture":return Pt=gt.pointerId,Po.set(Pt,zo(Po.get(Pt)||null,Ee,Se,Ge,nt,gt)),!0}return!1}function na(Ee){var Se=dl(Ee.target);if(Se!==null){var Ge=Ts(Se);if(Ge!==null){if(Se=Ge.tag,Se===13){if(Se=ta(Ge),Se!==null){Ee.blockedOn=Se,Ki(Ee.priority,function(){cr(Ge)});return}}else if(Se===3&&Ge.stateNode.current.memoizedState.isDehydrated){Ee.blockedOn=Ge.tag===3?Ge.stateNode.containerInfo:null;return}}}Ee.blockedOn=null}function ma(Ee){if(Ee.blockedOn!==null)return!1;for(var Se=Ee.targetContainers;0<Se.length;){var Ge=Ba(Ee.domEventName,Ee.eventSystemFlags,Se[0],Ee.nativeEvent);if(Ge===null){Ge=Ee.nativeEvent;var nt=new Ge.constructor(Ge.type,Ge);ot=nt,Ge.target.dispatchEvent(nt),ot=null}else return Se=n0(Ge),Se!==null&&bi(Se),Ee.blockedOn=Ge,!1;Se.shift()}return!0}function L0(Ee,Se,Ge){ma(Ee)&&Ge.delete(Se)}function J0(){As=!1,ys!==null&&ma(ys)&&(ys=null),ds!==null&&ma(ds)&&(ds=null),$s!==null&&ma($s)&&($s=null),Ao.forEach(L0),Po.forEach(L0)}function C0(Ee,Se){Ee.blockedOn===Se&&(Ee.blockedOn=null,As||(As=!0,U.unstable_scheduleCallback(U.unstable_NormalPriority,J0)))}function H0(Ee){function Se(gt){return C0(gt,Ee)}if(0<Ls.length){C0(Ls[0],Ee);for(var Ge=1;Ge<Ls.length;Ge++){var nt=Ls[Ge];nt.blockedOn===Ee&&(nt.blockedOn=null)}}for(ys!==null&&C0(ys,Ee),ds!==null&&C0(ds,Ee),$s!==null&&C0($s,Ee),Ao.forEach(Se),Po.forEach(Se),Ge=0;Ge<mo.length;Ge++)nt=mo[Ge],nt.blockedOn===Ee&&(nt.blockedOn=null);for(;0<mo.length&&(Ge=mo[0],Ge.blockedOn===null);)na(Ge),Ge.blockedOn===null&&mo.shift()}var D0=Ne.ReactCurrentBatchConfig,Z0=!0;function Tl(Ee,Se,Ge,nt){var gt=xi,Pt=D0.transition;D0.transition=null;try{xi=1,Va(Ee,Se,Ge,nt)}finally{xi=gt,D0.transition=Pt}}function Il(Ee,Se,Ge,nt){var gt=xi,Pt=D0.transition;D0.transition=null;try{xi=4,Va(Ee,Se,Ge,nt)}finally{xi=gt,D0.transition=Pt}}function Va(Ee,Se,Ge,nt){if(Z0){var gt=Ba(Ee,Se,Ge,nt);if(gt===null)xa(Ee,Se,nt,V0,Ge),pa(Ee,nt);else if(Aa(gt,Ee,Se,Ge,nt))nt.stopPropagation();else if(pa(Ee,nt),Se&4&&-1<fa.indexOf(Ee)){for(;gt!==null;){var Pt=n0(gt);if(Pt!==null&&ti(Pt),Pt=Ba(Ee,Se,Ge,nt),Pt===null&&xa(Ee,Se,nt,V0,Ge),Pt===gt)break;gt=Pt}gt!==null&&nt.stopPropagation()}else xa(Ee,Se,nt,null,Ge)}}var V0=null;function Ba(Ee,Se,Ge,nt){if(V0=null,Ee=Vt(nt),Ee=dl(Ee),Ee!==null)if(Se=Ts(Ee),Se===null)Ee=null;else if(Ge=Se.tag,Ge===13){if(Ee=ta(Se),Ee!==null)return Ee;Ee=null}else if(Ge===3){if(Se.stateNode.current.memoizedState.isDehydrated)return Se.tag===3?Se.stateNode.containerInfo:null;Ee=null}else Se!==Ee&&(Ee=null);return V0=Ee,null}function lo(Ee){switch(Ee){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jn()){case gi:return 1;case Wi:return 4;case Li:case vi:return 16;case yr:return 536870912;default:return 16}default:return 16}}var za=null,bc=null,Rl=null;function Tc(){if(Rl)return Rl;var Ee,Se=bc,Ge=Se.length,nt,gt="value"in za?za.value:za.textContent,Pt=gt.length;for(Ee=0;Ee<Ge&&Se[Ee]===gt[Ee];Ee++);var en=Ge-Ee;for(nt=1;nt<=en&&Se[Ge-nt]===gt[Pt-nt];nt++);return Rl=gt.slice(Ee,1<nt?1-nt:void 0)}function bo(Ee){var Se=Ee.keyCode;return"charCode"in Ee?(Ee=Ee.charCode,Ee===0&&Se===13&&(Ee=13)):Ee=Se,Ee===10&&(Ee=13),32<=Ee||Ee===13?Ee:0}function Bl(){return!0}function Ic(){return!1}function x0(Ee){function Se(Ge,nt,gt,Pt,en){this._reactName=Ge,this._targetInst=gt,this.type=nt,this.nativeEvent=Pt,this.target=en,this.currentTarget=null;for(var Tn in Ee)Ee.hasOwnProperty(Tn)&&(Ge=Ee[Tn],this[Tn]=Ge?Ge(Pt):Pt[Tn]);return this.isDefaultPrevented=(Pt.defaultPrevented!=null?Pt.defaultPrevented:Pt.returnValue===!1)?Bl:Ic,this.isPropagationStopped=Ic,this}return Ut(Se.prototype,{preventDefault:function(){this.defaultPrevented=!0;var Ge=this.nativeEvent;Ge&&(Ge.preventDefault?Ge.preventDefault():typeof Ge.returnValue!="unknown"&&(Ge.returnValue=!1),this.isDefaultPrevented=Bl)},stopPropagation:function(){var Ge=this.nativeEvent;Ge&&(Ge.stopPropagation?Ge.stopPropagation():typeof Ge.cancelBubble!="unknown"&&(Ge.cancelBubble=!0),this.isPropagationStopped=Bl)},persist:function(){},isPersistent:Bl}),Se}var P0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(Ee){return Ee.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uu=x0(P0),zc=Ut({},P0,{view:0,detail:0}),Ed=x0(zc),ku,Gu,hu,Qu=Ut({},zc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sc,button:0,buttons:0,relatedTarget:function(Ee){return Ee.relatedTarget===void 0?Ee.fromElement===Ee.srcElement?Ee.toElement:Ee.fromElement:Ee.relatedTarget},movementX:function(Ee){return"movementX"in Ee?Ee.movementX:(Ee!==hu&&(hu&&Ee.type==="mousemove"?(ku=Ee.screenX-hu.screenX,Gu=Ee.screenY-hu.screenY):Gu=ku=0,hu=Ee),ku)},movementY:function(Ee){return"movementY"in Ee?Ee.movementY:Gu}}),Eh=x0(Qu),yd=Ut({},Qu,{dataTransfer:0}),Cd=x0(yd),xd=Ut({},zc,{relatedTarget:0}),Hu=x0(xd),wd=Ut({},P0,{animationName:0,elapsedTime:0,pseudoElement:0}),Vu=x0(wd),yh=Ut({},P0,{clipboardData:function(Ee){return"clipboardData"in Ee?Ee.clipboardData:window.clipboardData}}),Ch=x0(yh),xh=Ut({},P0,{data:0}),du=x0(xh),wh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bh(Ee){var Se=this.nativeEvent;return Se.getModifierState?Se.getModifierState(Ee):(Ee=Mh[Ee])?!!Se[Ee]:!1}function sc(){return bh}var Sd=Ut({},zc,{key:function(Ee){if(Ee.key){var Se=wh[Ee.key]||Ee.key;if(Se!=="Unidentified")return Se}return Ee.type==="keypress"?(Ee=bo(Ee),Ee===13?"Enter":String.fromCharCode(Ee)):Ee.type==="keydown"||Ee.type==="keyup"?Sh[Ee.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sc,charCode:function(Ee){return Ee.type==="keypress"?bo(Ee):0},keyCode:function(Ee){return Ee.type==="keydown"||Ee.type==="keyup"?Ee.keyCode:0},which:function(Ee){return Ee.type==="keypress"?bo(Ee):Ee.type==="keydown"||Ee.type==="keyup"?Ee.keyCode:0}}),Md=x0(Sd),bd=Ut({},Qu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Th=x0(bd),Td=Ut({},zc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sc}),Id=x0(Td),Rd=Ut({},P0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bd=x0(Rd),Ld=Ut({},Qu,{deltaX:function(Ee){return"deltaX"in Ee?Ee.deltaX:"wheelDeltaX"in Ee?-Ee.wheelDeltaX:0},deltaY:function(Ee){return"deltaY"in Ee?Ee.deltaY:"wheelDeltaY"in Ee?-Ee.wheelDeltaY:"wheelDelta"in Ee?-Ee.wheelDelta:0},deltaZ:0,deltaMode:0}),zu=x0(Ld),j0=[9,13,27,32],oc=pe&&"CompositionEvent"in window,La=null;pe&&"documentMode"in document&&(La=document.documentMode);var Wa=pe&&"TextEvent"in window&&!La,Wu=pe&&(!oc||La&&8<La&&11>=La),Ll=" ",ac=!1;function c0(Ee,Se){switch(Ee){case"keyup":return j0.indexOf(Se.keyCode)!==-1;case"keydown":return Se.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qo(Ee){return Ee=Ee.detail,typeof Ee=="object"&&"data"in Ee?Ee.data:null}var Dl=!1;function Dd(Ee,Se){switch(Ee){case"compositionend":return qo(Se);case"keypress":return Se.which!==32?null:(ac=!0,Ll);case"textInput":return Ee=Se.data,Ee===Ll&&ac?null:Ee;default:return null}}function Pd(Ee,Se){if(Dl)return Ee==="compositionend"||!oc&&c0(Ee,Se)?(Ee=Tc(),Rl=bc=za=null,Dl=!1,Ee):null;switch(Ee){case"paste":return null;case"keypress":if(!(Se.ctrlKey||Se.altKey||Se.metaKey)||Se.ctrlKey&&Se.altKey){if(Se.char&&1<Se.char.length)return Se.char;if(Se.which)return String.fromCharCode(Se.which)}return null;case"compositionend":return Wu&&Se.locale!=="ko"?null:Se.data;default:return null}}var Wc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ih(Ee){var Se=Ee&&Ee.nodeName&&Ee.nodeName.toLowerCase();return Se==="input"?!!Wc[Ee.type]:Se==="textarea"}function Rh(Ee,Se,Ge,nt){ki(nt),Se=Is(Se,"onChange"),0<Se.length&&(Ge=new Uu("onChange","change",null,Ge,nt),Ee.push({event:Ge,listeners:Se}))}var $c=null,Xc=null;function Fd(Ee){$o(Ee,0)}function fu(Ee){var Se=jc(Ee);if(Zi(Se))return Ee}function Od(Ee,Se){if(Ee==="change")return Se}var Bh=!1;if(pe){var pu;if(pe){var $u="oninput"in document;if(!$u){var Lh=document.createElement("div");Lh.setAttribute("oninput","return;"),$u=typeof Lh.oninput=="function"}pu=$u}else pu=!1;Bh=pu&&(!document.documentMode||9<document.documentMode)}function Dh(){$c&&($c.detachEvent("onpropertychange",Ph),Xc=$c=null)}function Ph(Ee){if(Ee.propertyName==="value"&&fu(Xc)){var Se=[];Rh(Se,Xc,Ee,Vt(Ee)),Jr(Fd,Se)}}function Nd(Ee,Se,Ge){Ee==="focusin"?(Dh(),$c=Se,Xc=Ge,$c.attachEvent("onpropertychange",Ph)):Ee==="focusout"&&Dh()}function $a(Ee){if(Ee==="selectionchange"||Ee==="keyup"||Ee==="keydown")return fu(Xc)}function Us(Ee,Se){if(Ee==="click")return fu(Se)}function Ud(Ee,Se){if(Ee==="input"||Ee==="change")return fu(Se)}function qi(Ee,Se){return Ee===Se&&(Ee!==0||1/Ee===1/Se)||Ee!==Ee&&Se!==Se}var gs=typeof Object.is=="function"?Object.is:qi;function Pl(Ee,Se){if(gs(Ee,Se))return!0;if(typeof Ee!="object"||Ee===null||typeof Se!="object"||Se===null)return!1;var Ge=Object.keys(Ee),nt=Object.keys(Se);if(Ge.length!==nt.length)return!1;for(nt=0;nt<Ge.length;nt++){var gt=Ge[nt];if(!Me.call(Se,gt)||!gs(Ee[gt],Se[gt]))return!1}return!0}function Au(Ee){for(;Ee&&Ee.firstChild;)Ee=Ee.firstChild;return Ee}function Xu(Ee,Se){var Ge=Au(Ee);Ee=0;for(var nt;Ge;){if(Ge.nodeType===3){if(nt=Ee+Ge.textContent.length,Ee<=Se&&nt>=Se)return{node:Ge,offset:Se-Ee};Ee=nt}e:{for(;Ge;){if(Ge.nextSibling){Ge=Ge.nextSibling;break e}Ge=Ge.parentNode}Ge=void 0}Ge=Au(Ge)}}function Fl(Ee,Se){return Ee&&Se?Ee===Se?!0:Ee&&Ee.nodeType===3?!1:Se&&Se.nodeType===3?Fl(Ee,Se.parentNode):"contains"in Ee?Ee.contains(Se):Ee.compareDocumentPosition?!!(Ee.compareDocumentPosition(Se)&16):!1:!1}function cc(){for(var Ee=window,Se=Mn();Se instanceof Ee.HTMLIFrameElement;){try{var Ge=typeof Se.contentWindow.location.href=="string"}catch{Ge=!1}if(Ge)Ee=Se.contentWindow;else break;Se=Mn(Ee.document)}return Se}function mu(Ee){var Se=Ee&&Ee.nodeName&&Ee.nodeName.toLowerCase();return Se&&(Se==="input"&&(Ee.type==="text"||Ee.type==="search"||Ee.type==="tel"||Ee.type==="url"||Ee.type==="password")||Se==="textarea"||Ee.contentEditable==="true")}function uc(Ee){var Se=cc(),Ge=Ee.focusedElem,nt=Ee.selectionRange;if(Se!==Ge&&Ge&&Ge.ownerDocument&&Fl(Ge.ownerDocument.documentElement,Ge)){if(nt!==null&&mu(Ge)){if(Se=nt.start,Ee=nt.end,Ee===void 0&&(Ee=Se),"selectionStart"in Ge)Ge.selectionStart=Se,Ge.selectionEnd=Math.min(Ee,Ge.value.length);else if(Ee=(Se=Ge.ownerDocument||document)&&Se.defaultView||window,Ee.getSelection){Ee=Ee.getSelection();var gt=Ge.textContent.length,Pt=Math.min(nt.start,gt);nt=nt.end===void 0?Pt:Math.min(nt.end,gt),!Ee.extend&&Pt>nt&&(gt=nt,nt=Pt,Pt=gt),gt=Xu(Ge,Pt);var en=Xu(Ge,nt);gt&&en&&(Ee.rangeCount!==1||Ee.anchorNode!==gt.node||Ee.anchorOffset!==gt.offset||Ee.focusNode!==en.node||Ee.focusOffset!==en.offset)&&(Se=Se.createRange(),Se.setStart(gt.node,gt.offset),Ee.removeAllRanges(),Pt>nt?(Ee.addRange(Se),Ee.extend(en.node,en.offset)):(Se.setEnd(en.node,en.offset),Ee.addRange(Se)))}}for(Se=[],Ee=Ge;Ee=Ee.parentNode;)Ee.nodeType===1&&Se.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof Ge.focus=="function"&&Ge.focus(),Ge=0;Ge<Se.length;Ge++)Ee=Se[Ge],Ee.element.scrollLeft=Ee.left,Ee.element.scrollTop=Ee.top}}var oa=pe&&"documentMode"in document&&11>=document.documentMode,hc=null,gu=null,Ol=null,Ku=!1;function To(Ee,Se,Ge){var nt=Ge.window===Ge?Ge.document:Ge.nodeType===9?Ge:Ge.ownerDocument;Ku||hc==null||hc!==Mn(nt)||(nt=hc,"selectionStart"in nt&&mu(nt)?nt={start:nt.selectionStart,end:nt.selectionEnd}:(nt=(nt.ownerDocument&&nt.ownerDocument.defaultView||window).getSelection(),nt={anchorNode:nt.anchorNode,anchorOffset:nt.anchorOffset,focusNode:nt.focusNode,focusOffset:nt.focusOffset}),Ol&&Pl(Ol,nt)||(Ol=nt,nt=Is(gu,"onSelect"),0<nt.length&&(Se=new Uu("onSelect","select",null,Se,Ge),Ee.push({event:Se,listeners:nt}),Se.target=hc)))}function Nl(Ee,Se){var Ge={};return Ge[Ee.toLowerCase()]=Se.toLowerCase(),Ge["Webkit"+Ee]="webkit"+Se,Ge["Moz"+Ee]="moz"+Se,Ge}var Ul={animationend:Nl("Animation","AnimationEnd"),animationiteration:Nl("Animation","AnimationIteration"),animationstart:Nl("Animation","AnimationStart"),transitionend:Nl("Transition","TransitionEnd")},cl={},dc={};pe&&(dc=document.createElement("div").style,"AnimationEvent"in window||(delete Ul.animationend.animation,delete Ul.animationiteration.animation,delete Ul.animationstart.animation),"TransitionEvent"in window||delete Ul.transitionend.transition);function Kc(Ee){if(cl[Ee])return cl[Ee];if(!Ul[Ee])return Ee;var Se=Ul[Ee],Ge;for(Ge in Se)if(Se.hasOwnProperty(Ge)&&Ge in dc)return cl[Ee]=Se[Ge];return Ee}var Wo=Kc("animationend"),Yc=Kc("animationiteration"),Yu=Kc("animationstart"),Fo=Kc("transitionend"),go=new Map,fc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ga(Ee,Se){go.set(Ee,Se),F(Se,[Ee])}for(var Rc=0;Rc<fc.length;Rc++){var Kr=fc[Rc],Fs=Kr.toLowerCase(),co=Kr[0].toUpperCase()+Kr.slice(1);ga(Fs,"on"+co)}ga(Wo,"onAnimationEnd"),ga(Yc,"onAnimationIteration"),ga(Yu,"onAnimationStart"),ga("dblclick","onDoubleClick"),ga("focusin","onFocus"),ga("focusout","onBlur"),ga(Fo,"onTransitionEnd"),fe("onMouseEnter",["mouseout","mouseover"]),fe("onMouseLeave",["mouseout","mouseover"]),fe("onPointerEnter",["pointerout","pointerover"]),fe("onPointerLeave",["pointerout","pointerover"]),F("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),F("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),F("onBeforeInput",["compositionend","keypress","textInput","paste"]),F("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),F("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),F("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var to="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vn=new Set("cancel close invalid load scroll toggle".split(" ").concat(to));function u0(Ee,Se,Ge){var nt=Ee.type||"unknown-event";Ee.currentTarget=Ge,ko(nt,Se,void 0,Ee),Ee.currentTarget=null}function $o(Ee,Se){Se=(Se&4)!==0;for(var Ge=0;Ge<Ee.length;Ge++){var nt=Ee[Ge],gt=nt.event;nt=nt.listeners;e:{var Pt=void 0;if(Se)for(var en=nt.length-1;0<=en;en--){var Tn=nt[en],Hn=Tn.instance,Ei=Tn.currentTarget;if(Tn=Tn.listener,Hn!==Pt&&gt.isPropagationStopped())break e;u0(gt,Tn,Ei),Pt=Hn}else for(en=0;en<nt.length;en++){if(Tn=nt[en],Hn=Tn.instance,Ei=Tn.currentTarget,Tn=Tn.listener,Hn!==Pt&&gt.isPropagationStopped())break e;u0(gt,Tn,Ei),Pt=Hn}}}if(Do)throw Ee=Ca,Do=!1,Ca=null,Ee}function Rs(Ee,Se){var Ge=Se[kd];Ge===void 0&&(Ge=Se[kd]=new Set);var nt=Ee+"__bubble";Ge.has(nt)||(w0(Se,Ee,2,!1),Ge.add(nt))}function Zs(Ee,Se,Ge){var nt=0;Se&&(nt|=4),w0(Ge,Ee,nt,Se)}var Da="_reactListening"+Math.random().toString(36).slice(2);function F0(Ee){if(!Ee[Da]){Ee[Da]=!0,ie.forEach(function(Ge){Ge!=="selectionchange"&&(vn.has(Ge)||Zs(Ge,!1,Ee),Zs(Ge,!0,Ee))});var Se=Ee.nodeType===9?Ee:Ee.ownerDocument;Se===null||Se[Da]||(Se[Da]=!0,Zs("selectionchange",!1,Se))}}function w0(Ee,Se,Ge,nt){switch(lo(Se)){case 1:var gt=Tl;break;case 4:gt=Il;break;default:gt=Va}Ge=gt.bind(null,Se,Ge,Ee),gt=void 0,!js||Se!=="touchstart"&&Se!=="touchmove"&&Se!=="wheel"||(gt=!0),nt?gt!==void 0?Ee.addEventListener(Se,Ge,{capture:!0,passive:gt}):Ee.addEventListener(Se,Ge,!0):gt!==void 0?Ee.addEventListener(Se,Ge,{passive:gt}):Ee.addEventListener(Se,Ge,!1)}function xa(Ee,Se,Ge,nt,gt){var Pt=nt;if(!(Se&1)&&!(Se&2)&&nt!==null)e:for(;;){if(nt===null)return;var en=nt.tag;if(en===3||en===4){var Tn=nt.stateNode.containerInfo;if(Tn===gt||Tn.nodeType===8&&Tn.parentNode===gt)break;if(en===4)for(en=nt.return;en!==null;){var Hn=en.tag;if((Hn===3||Hn===4)&&(Hn=en.stateNode.containerInfo,Hn===gt||Hn.nodeType===8&&Hn.parentNode===gt))return;en=en.return}for(;Tn!==null;){if(en=dl(Tn),en===null)return;if(Hn=en.tag,Hn===5||Hn===6){nt=Pt=en;continue e}Tn=Tn.parentNode}}nt=nt.return}Jr(function(){var Ei=Pt,ur=Vt(Ge),pr=[];e:{var rr=go.get(Ee);if(rr!==void 0){var Hr=Uu,Zr=Ee;switch(Ee){case"keypress":if(bo(Ge)===0)break e;case"keydown":case"keyup":Hr=Md;break;case"focusin":Zr="focus",Hr=Hu;break;case"focusout":Zr="blur",Hr=Hu;break;case"beforeblur":case"afterblur":Hr=Hu;break;case"click":if(Ge.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Hr=Eh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Hr=Cd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Hr=Id;break;case Wo:case Yc:case Yu:Hr=Vu;break;case Fo:Hr=Bd;break;case"scroll":Hr=Ed;break;case"wheel":Hr=zu;break;case"copy":case"cut":case"paste":Hr=Ch;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Hr=Th}var cs=(Se&4)!==0,ua=!cs&&Ee==="scroll",li=cs?rr!==null?rr+"Capture":null:rr;cs=[];for(var $n=Ei,ui;$n!==null;){ui=$n;var dr=ui.stateNode;if(ui.tag===5&&dr!==null&&(ui=dr,li!==null&&(dr=Ai($n,li),dr!=null&&cs.push(Ms($n,dr,ui)))),ua)break;$n=$n.return}0<cs.length&&(rr=new Hr(rr,Zr,null,Ge,ur),pr.push({event:rr,listeners:cs}))}}if(!(Se&7)){e:{if(rr=Ee==="mouseover"||Ee==="pointerover",Hr=Ee==="mouseout"||Ee==="pointerout",rr&&Ge!==ot&&(Zr=Ge.relatedTarget||Ge.fromElement)&&(dl(Zr)||Zr[Eo]))break e;if((Hr||rr)&&(rr=ur.window===ur?ur:(rr=ur.ownerDocument)?rr.defaultView||rr.parentWindow:window,Hr?(Zr=Ge.relatedTarget||Ge.toElement,Hr=Ei,Zr=Zr?dl(Zr):null,Zr!==null&&(ua=Ts(Zr),Zr!==ua||Zr.tag!==5&&Zr.tag!==6)&&(Zr=null)):(Hr=null,Zr=Ei),Hr!==Zr)){if(cs=Eh,dr="onMouseLeave",li="onMouseEnter",$n="mouse",(Ee==="pointerout"||Ee==="pointerover")&&(cs=Th,dr="onPointerLeave",li="onPointerEnter",$n="pointer"),ua=Hr==null?rr:jc(Hr),ui=Zr==null?rr:jc(Zr),rr=new cs(dr,$n+"leave",Hr,Ge,ur),rr.target=ua,rr.relatedTarget=ui,dr=null,dl(ur)===Ei&&(cs=new cs(li,$n+"enter",Zr,Ge,ur),cs.target=ui,cs.relatedTarget=ua,dr=cs),ua=dr,Hr&&Zr)t:{for(cs=Hr,li=Zr,$n=0,ui=cs;ui;ui=aa(ui))$n++;for(ui=0,dr=li;dr;dr=aa(dr))ui++;for(;0<$n-ui;)cs=aa(cs),$n--;for(;0<ui-$n;)li=aa(li),ui--;for(;$n--;){if(cs===li||li!==null&&cs===li.alternate)break t;cs=aa(cs),li=aa(li)}cs=null}else cs=null;Hr!==null&&Pa(pr,rr,Hr,cs,!1),Zr!==null&&ua!==null&&Pa(pr,ua,Zr,cs,!0)}}e:{if(rr=Ei?jc(Ei):window,Hr=rr.nodeName&&rr.nodeName.toLowerCase(),Hr==="select"||Hr==="input"&&rr.type==="file")var ls=Od;else if(Ih(rr))if(Bh)ls=Ud;else{ls=$a;var W=Nd}else(Hr=rr.nodeName)&&Hr.toLowerCase()==="input"&&(rr.type==="checkbox"||rr.type==="radio")&&(ls=Us);if(ls&&(ls=ls(Ee,Ei))){Rh(pr,ls,Ge,ur);break e}W&&W(Ee,rr,Ei),Ee==="focusout"&&(W=rr._wrapperState)&&W.controlled&&rr.type==="number"&&Br(rr,"number",rr.value)}switch(W=Ei?jc(Ei):window,Ee){case"focusin":(Ih(W)||W.contentEditable==="true")&&(hc=W,gu=Ei,Ol=null);break;case"focusout":Ol=gu=hc=null;break;case"mousedown":Ku=!0;break;case"contextmenu":case"mouseup":case"dragend":Ku=!1,To(pr,Ge,ur);break;case"selectionchange":if(oa)break;case"keydown":case"keyup":To(pr,Ge,ur)}var q;if(oc)e:{switch(Ee){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Dl?c0(Ee,Ge)&&(j="onCompositionEnd"):Ee==="keydown"&&Ge.keyCode===229&&(j="onCompositionStart");j&&(Wu&&Ge.locale!=="ko"&&(Dl||j!=="onCompositionStart"?j==="onCompositionEnd"&&Dl&&(q=Tc()):(za=ur,bc="value"in za?za.value:za.textContent,Dl=!0)),W=Is(Ei,j),0<W.length&&(j=new du(j,Ee,null,Ge,ur),pr.push({event:j,listeners:W}),q?j.data=q:(q=qo(Ge),q!==null&&(j.data=q)))),(q=Wa?Dd(Ee,Ge):Pd(Ee,Ge))&&(Ei=Is(Ei,"onBeforeInput"),0<Ei.length&&(ur=new du("onBeforeInput","beforeinput",null,Ge,ur),pr.push({event:ur,listeners:Ei}),ur.data=q))}$o(pr,Se)})}function Ms(Ee,Se,Ge){return{instance:Ee,listener:Se,currentTarget:Ge}}function Is(Ee,Se){for(var Ge=Se+"Capture",nt=[];Ee!==null;){var gt=Ee,Pt=gt.stateNode;gt.tag===5&&Pt!==null&&(gt=Pt,Pt=Ai(Ee,Ge),Pt!=null&&nt.unshift(Ms(Ee,Pt,gt)),Pt=Ai(Ee,Se),Pt!=null&&nt.push(Ms(Ee,Pt,gt))),Ee=Ee.return}return nt}function aa(Ee){if(Ee===null)return null;do Ee=Ee.return;while(Ee&&Ee.tag!==5);return Ee||null}function Pa(Ee,Se,Ge,nt,gt){for(var Pt=Se._reactName,en=[];Ge!==null&&Ge!==nt;){var Tn=Ge,Hn=Tn.alternate,Ei=Tn.stateNode;if(Hn!==null&&Hn===nt)break;Tn.tag===5&&Ei!==null&&(Tn=Ei,gt?(Hn=Ai(Ge,Pt),Hn!=null&&en.unshift(Ms(Ge,Hn,Tn))):gt||(Hn=Ai(Ge,Pt),Hn!=null&&en.push(Ms(Ge,Hn,Tn)))),Ge=Ge.return}en.length!==0&&Ee.push({event:Se,listeners:en})}var vo=/\r\n?/g,Xs=/\u0000|\uFFFD/g;function Lr(Ee){return(typeof Ee=="string"?Ee:""+Ee).replace(vo,`
`).replace(Xs,"")}function Hs(Ee,Se,Ge){if(Se=Lr(Se),Lr(Ee)!==Se&&Ge)throw Error(Y(425))}function Xa(){}var ul=null,hl=null;function pc(Ee,Se){return Ee==="textarea"||Ee==="noscript"||typeof Se.children=="string"||typeof Se.children=="number"||typeof Se.dangerouslySetInnerHTML=="object"&&Se.dangerouslySetInnerHTML!==null&&Se.dangerouslySetInnerHTML.__html!=null}var la=typeof setTimeout=="function"?setTimeout:void 0,el=typeof clearTimeout=="function"?clearTimeout:void 0,kl=typeof Promise=="function"?Promise:void 0,qc=typeof queueMicrotask=="function"?queueMicrotask:typeof kl<"u"?function(Ee){return kl.resolve(null).then(Ee).catch(Gl)}:la;function Gl(Ee){setTimeout(function(){throw Ee})}function Jc(Ee,Se){var Ge=Se,nt=0;do{var gt=Ge.nextSibling;if(Ee.removeChild(Ge),gt&&gt.nodeType===8)if(Ge=gt.data,Ge==="/$"){if(nt===0){Ee.removeChild(gt),H0(Se);return}nt--}else Ge!=="$"&&Ge!=="$?"&&Ge!=="$!"||nt++;Ge=gt}while(Ge);H0(Se)}function z0(Ee){for(;Ee!=null;Ee=Ee.nextSibling){var Se=Ee.nodeType;if(Se===1||Se===3)break;if(Se===8){if(Se=Ee.data,Se==="$"||Se==="$!"||Se==="$?")break;if(Se==="/$")return null}}return Ee}function Zc(Ee){Ee=Ee.previousSibling;for(var Se=0;Ee;){if(Ee.nodeType===8){var Ge=Ee.data;if(Ge==="$"||Ge==="$!"||Ge==="$?"){if(Se===0)return Ee;Se--}else Ge==="/$"&&Se++}Ee=Ee.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),kr="__reactFiber$"+Jo,ia="__reactProps$"+Jo,Eo="__reactContainer$"+Jo,kd="__reactEvents$"+Jo,Zf="__reactListeners$"+Jo,Bc="__reactHandles$"+Jo;function dl(Ee){var Se=Ee[kr];if(Se)return Se;for(var Ge=Ee.parentNode;Ge;){if(Se=Ge[Eo]||Ge[kr]){if(Ge=Se.alternate,Se.child!==null||Ge!==null&&Ge.child!==null)for(Ee=Zc(Ee);Ee!==null;){if(Ge=Ee[kr])return Ge;Ee=Zc(Ee)}return Se}Ee=Ge,Ge=Ee.parentNode}return null}function n0(Ee){return Ee=Ee[kr]||Ee[Eo],!Ee||Ee.tag!==5&&Ee.tag!==6&&Ee.tag!==13&&Ee.tag!==3?null:Ee}function jc(Ee){if(Ee.tag===5||Ee.tag===6)return Ee.stateNode;throw Error(Y(33))}function vu(Ee){return Ee[ia]||null}var S0=[],Ql=-1;function W0(Ee){return{current:Ee}}function Xo(Ee){0>Ql||(Ee.current=S0[Ql],S0[Ql]=null,Ql--)}function Co(Ee,Se){Ql++,S0[Ql]=Ee.current,Ee.current=Se}var i0={},va=W0(i0),Ka=W0(!1),Ac=i0;function mc(Ee,Se){var Ge=Ee.type.contextTypes;if(!Ge)return i0;var nt=Ee.stateNode;if(nt&&nt.__reactInternalMemoizedUnmaskedChildContext===Se)return nt.__reactInternalMemoizedMaskedChildContext;var gt={},Pt;for(Pt in Ge)gt[Pt]=Se[Pt];return nt&&(Ee=Ee.stateNode,Ee.__reactInternalMemoizedUnmaskedChildContext=Se,Ee.__reactInternalMemoizedMaskedChildContext=gt),gt}function M0(Ee){return Ee=Ee.childContextTypes,Ee!=null}function eu(){Xo(Ka),Xo(va)}function Fh(Ee,Se,Ge){if(va.current!==i0)throw Error(Y(168));Co(va,Se),Co(Ka,Ge)}function Gd(Ee,Se,Ge){var nt=Ee.stateNode;if(Se=Se.childContextTypes,typeof nt.getChildContext!="function")return Ge;nt=nt.getChildContext();for(var gt in nt)if(!(gt in Se))throw Error(Y(108,Nn(Ee)||"Unknown",gt));return Ut({},Ge,nt)}function qu(Ee){return Ee=(Ee=Ee.stateNode)&&Ee.__reactInternalMemoizedMergedChildContext||i0,Ac=va.current,Co(va,Ee),Co(Ka,Ka.current),!0}function Go(Ee,Se,Ge){var nt=Ee.stateNode;if(!nt)throw Error(Y(169));Ge?(Ee=Gd(Ee,Se,Ac),nt.__reactInternalMemoizedMergedChildContext=Ee,Xo(Ka),Xo(va),Co(va,Ee)):Xo(Ka),Co(Ka,Ge)}var pl=null,uo=!1,Ya=!1;function Hl(Ee){pl===null?pl=[Ee]:pl.push(Ee)}function Qd(Ee){uo=!0,Hl(Ee)}function h0(){if(!Ya&&pl!==null){Ya=!0;var Ee=0,Se=xi;try{var Ge=pl;for(xi=1;Ee<Ge.length;Ee++){var nt=Ge[Ee];do nt=nt(!0);while(nt!==null)}pl=null,uo=!1}catch(gt){throw pl!==null&&(pl=pl.slice(Ee+1)),$t(gi,h0),gt}finally{xi=Se,Ya=!1}}return null}var tl=[],Al=0,Ju=null,Eu=0,qa=[],O0=0,Fa=null,Vl=1,wa="";function ml(Ee,Se){tl[Al++]=Eu,tl[Al++]=Ju,Ju=Ee,Eu=Se}function Oh(Ee,Se,Ge){qa[O0++]=Vl,qa[O0++]=wa,qa[O0++]=Fa,Fa=Ee;var nt=Vl;Ee=wa;var gt=32-er(nt)-1;nt&=~(1<<gt),Ge+=1;var Pt=32-er(Se)+gt;if(30<Pt){var en=gt-gt%5;Pt=(nt&(1<<en)-1).toString(32),nt>>=en,gt-=en,Vl=1<<32-er(Se)+gt|Ge<<gt|nt,wa=Pt+Ee}else Vl=1<<Pt|Ge<<gt|nt,wa=Ee}function Wr(Ee){Ee.return!==null&&(ml(Ee,1),Oh(Ee,1,0))}function Oa(Ee){for(;Ee===Ju;)Ju=tl[--Al],tl[Al]=null,Eu=tl[--Al],tl[Al]=null;for(;Ee===Fa;)Fa=qa[--O0],qa[O0]=null,wa=qa[--O0],qa[O0]=null,Vl=qa[--O0],qa[O0]=null}var Na=null,Oo=null,Io=!1,Ua=null;function k1(Ee,Se){var Ge=E0(5,null,null,0);Ge.elementType="DELETED",Ge.stateNode=Se,Ge.return=Ee,Se=Ee.deletions,Se===null?(Ee.deletions=[Ge],Ee.flags|=16):Se.push(Ge)}function d0(Ee,Se){switch(Ee.tag){case 5:var Ge=Ee.type;return Se=Se.nodeType!==1||Ge.toLowerCase()!==Se.nodeName.toLowerCase()?null:Se,Se!==null?(Ee.stateNode=Se,Na=Ee,Oo=z0(Se.firstChild),!0):!1;case 6:return Se=Ee.pendingProps===""||Se.nodeType!==3?null:Se,Se!==null?(Ee.stateNode=Se,Na=Ee,Oo=null,!0):!1;case 13:return Se=Se.nodeType!==8?null:Se,Se!==null?(Ge=Fa!==null?{id:Vl,overflow:wa}:null,Ee.memoizedState={dehydrated:Se,treeContext:Ge,retryLane:1073741824},Ge=E0(18,null,null,0),Ge.stateNode=Se,Ge.return=Ee,Ee.child=Ge,Na=Ee,Oo=null,!0):!1;default:return!1}}function Lc(Ee){return(Ee.mode&1)!==0&&(Ee.flags&128)===0}function Hd(Ee){if(Io){var Se=Oo;if(Se){var Ge=Se;if(!d0(Ee,Se)){if(Lc(Ee))throw Error(Y(418));Se=z0(Ge.nextSibling);var nt=Na;Se&&d0(Ee,Se)?k1(nt,Ge):(Ee.flags=Ee.flags&-4097|2,Io=!1,Na=Ee)}}else{if(Lc(Ee))throw Error(Y(418));Ee.flags=Ee.flags&-4097|2,Io=!1,Na=Ee}}}function Ea(Ee){for(Ee=Ee.return;Ee!==null&&Ee.tag!==5&&Ee.tag!==3&&Ee.tag!==13;)Ee=Ee.return;Na=Ee}function gc(Ee){if(Ee!==Na)return!1;if(!Io)return Ea(Ee),Io=!0,!1;var Se;if((Se=Ee.tag!==3)&&!(Se=Ee.tag!==5)&&(Se=Ee.type,Se=Se!=="head"&&Se!=="body"&&!pc(Ee.type,Ee.memoizedProps)),Se&&(Se=Oo)){if(Lc(Ee))throw So(),Error(Y(418));for(;Se;)k1(Ee,Se),Se=z0(Se.nextSibling)}if(Ea(Ee),Ee.tag===13){if(Ee=Ee.memoizedState,Ee=Ee!==null?Ee.dehydrated:null,!Ee)throw Error(Y(317));e:{for(Ee=Ee.nextSibling,Se=0;Ee;){if(Ee.nodeType===8){var Ge=Ee.data;if(Ge==="/$"){if(Se===0){Oo=z0(Ee.nextSibling);break e}Se--}else Ge!=="$"&&Ge!=="$!"&&Ge!=="$?"||Se++}Ee=Ee.nextSibling}Oo=null}}else Oo=Na?z0(Ee.stateNode.nextSibling):null;return!0}function So(){for(var Ee=Oo;Ee;)Ee=z0(Ee.nextSibling)}function _u(){Oo=Na=null,Io=!1}function Zu(Ee){Ua===null?Ua=[Ee]:Ua.push(Ee)}var Nh=Ne.ReactCurrentBatchConfig;function yu(Ee,Se,Ge){if(Ee=Ge.ref,Ee!==null&&typeof Ee!="function"&&typeof Ee!="object"){if(Ge._owner){if(Ge=Ge._owner,Ge){if(Ge.tag!==1)throw Error(Y(309));var nt=Ge.stateNode}if(!nt)throw Error(Y(147,Ee));var gt=nt,Pt=""+Ee;return Se!==null&&Se.ref!==null&&typeof Se.ref=="function"&&Se.ref._stringRef===Pt?Se.ref:(Se=function(en){var Tn=gt.refs;en===null?delete Tn[Pt]:Tn[Pt]=en},Se._stringRef=Pt,Se)}if(typeof Ee!="string")throw Error(Y(284));if(!Ge._owner)throw Error(Y(290,Ee))}return Ee}function Cu(Ee,Se){throw Ee=Object.prototype.toString.call(Se),Error(Y(31,Ee==="[object Object]"?"object with keys {"+Object.keys(Se).join(", ")+"}":Ee))}function Vd(Ee){var Se=Ee._init;return Se(Ee._payload)}function vc(Ee){function Se(li,$n){if(Ee){var ui=li.deletions;ui===null?(li.deletions=[$n],li.flags|=16):ui.push($n)}}function Ge(li,$n){if(!Ee)return null;for(;$n!==null;)Se(li,$n),$n=$n.sibling;return null}function nt(li,$n){for(li=new Map;$n!==null;)$n.key!==null?li.set($n.key,$n):li.set($n.index,$n),$n=$n.sibling;return li}function gt(li,$n){return li=Sl(li,$n),li.index=0,li.sibling=null,li}function Pt(li,$n,ui){return li.index=ui,Ee?(ui=li.alternate,ui!==null?(ui=ui.index,ui<$n?(li.flags|=2,$n):ui):(li.flags|=2,$n)):(li.flags|=1048576,$n)}function en(li){return Ee&&li.alternate===null&&(li.flags|=2),li}function Tn(li,$n,ui,dr){return $n===null||$n.tag!==6?($n=v1(ui,li.mode,dr),$n.return=li,$n):($n=gt($n,ui),$n.return=li,$n)}function Hn(li,$n,ui,dr){var ls=ui.type;return ls===Xe?ur(li,$n,ui.props.children,dr,ui.key):$n!==null&&($n.elementType===ls||typeof ls=="object"&&ls!==null&&ls.$$typeof===_t&&Vd(ls)===$n.type)?(dr=gt($n,ui.props),dr.ref=yu(li,$n,ui),dr.return=li,dr):(dr=rd(ui.type,ui.key,ui.props,null,li.mode,dr),dr.ref=yu(li,$n,ui),dr.return=li,dr)}function Ei(li,$n,ui,dr){return $n===null||$n.tag!==4||$n.stateNode.containerInfo!==ui.containerInfo||$n.stateNode.implementation!==ui.implementation?($n=E1(ui,li.mode,dr),$n.return=li,$n):($n=gt($n,ui.children||[]),$n.return=li,$n)}function ur(li,$n,ui,dr,ls){return $n===null||$n.tag!==7?($n=lu(ui,li.mode,dr,ls),$n.return=li,$n):($n=gt($n,ui),$n.return=li,$n)}function pr(li,$n,ui){if(typeof $n=="string"&&$n!==""||typeof $n=="number")return $n=v1(""+$n,li.mode,ui),$n.return=li,$n;if(typeof $n=="object"&&$n!==null){switch($n.$$typeof){case ke:return ui=rd($n.type,$n.key,$n.props,null,li.mode,ui),ui.ref=yu(li,null,$n),ui.return=li,ui;case Ve:return $n=E1($n,li.mode,ui),$n.return=li,$n;case _t:var dr=$n._init;return pr(li,dr($n._payload),ui)}if(kt($n)||ut($n))return $n=lu($n,li.mode,ui,null),$n.return=li,$n;Cu(li,$n)}return null}function rr(li,$n,ui,dr){var ls=$n!==null?$n.key:null;if(typeof ui=="string"&&ui!==""||typeof ui=="number")return ls!==null?null:Tn(li,$n,""+ui,dr);if(typeof ui=="object"&&ui!==null){switch(ui.$$typeof){case ke:return ui.key===ls?Hn(li,$n,ui,dr):null;case Ve:return ui.key===ls?Ei(li,$n,ui,dr):null;case _t:return ls=ui._init,rr(li,$n,ls(ui._payload),dr)}if(kt(ui)||ut(ui))return ls!==null?null:ur(li,$n,ui,dr,null);Cu(li,ui)}return null}function Hr(li,$n,ui,dr,ls){if(typeof dr=="string"&&dr!==""||typeof dr=="number")return li=li.get(ui)||null,Tn($n,li,""+dr,ls);if(typeof dr=="object"&&dr!==null){switch(dr.$$typeof){case ke:return li=li.get(dr.key===null?ui:dr.key)||null,Hn($n,li,dr,ls);case Ve:return li=li.get(dr.key===null?ui:dr.key)||null,Ei($n,li,dr,ls);case _t:var W=dr._init;return Hr(li,$n,ui,W(dr._payload),ls)}if(kt(dr)||ut(dr))return li=li.get(ui)||null,ur($n,li,dr,ls,null);Cu($n,dr)}return null}function Zr(li,$n,ui,dr){for(var ls=null,W=null,q=$n,j=$n=0,X=null;q!==null&&j<ui.length;j++){q.index>j?(X=q,q=null):X=q.sibling;var G=rr(li,q,ui[j],dr);if(G===null){q===null&&(q=X);break}Ee&&q&&G.alternate===null&&Se(li,q),$n=Pt(G,$n,j),W===null?ls=G:W.sibling=G,W=G,q=X}if(j===ui.length)return Ge(li,q),Io&&ml(li,j),ls;if(q===null){for(;j<ui.length;j++)q=pr(li,ui[j],dr),q!==null&&($n=Pt(q,$n,j),W===null?ls=q:W.sibling=q,W=q);return Io&&ml(li,j),ls}for(q=nt(li,q);j<ui.length;j++)X=Hr(q,li,j,ui[j],dr),X!==null&&(Ee&&X.alternate!==null&&q.delete(X.key===null?j:X.key),$n=Pt(X,$n,j),W===null?ls=X:W.sibling=X,W=X);return Ee&&q.forEach(function(O){return Se(li,O)}),Io&&ml(li,j),ls}function cs(li,$n,ui,dr){var ls=ut(ui);if(typeof ls!="function")throw Error(Y(150));if(ui=ls.call(ui),ui==null)throw Error(Y(151));for(var W=ls=null,q=$n,j=$n=0,X=null,G=ui.next();q!==null&&!G.done;j++,G=ui.next()){q.index>j?(X=q,q=null):X=q.sibling;var O=rr(li,q,G.value,dr);if(O===null){q===null&&(q=X);break}Ee&&q&&O.alternate===null&&Se(li,q),$n=Pt(O,$n,j),W===null?ls=O:W.sibling=O,W=O,q=X}if(G.done)return Ge(li,q),Io&&ml(li,j),ls;if(q===null){for(;!G.done;j++,G=ui.next())G=pr(li,G.value,dr),G!==null&&($n=Pt(G,$n,j),W===null?ls=G:W.sibling=G,W=G);return Io&&ml(li,j),ls}for(q=nt(li,q);!G.done;j++,G=ui.next())G=Hr(q,li,j,G.value,dr),G!==null&&(Ee&&G.alternate!==null&&q.delete(G.key===null?j:G.key),$n=Pt(G,$n,j),W===null?ls=G:W.sibling=G,W=G);return Ee&&q.forEach(function(ee){return Se(li,ee)}),Io&&ml(li,j),ls}function ua(li,$n,ui,dr){if(typeof ui=="object"&&ui!==null&&ui.type===Xe&&ui.key===null&&(ui=ui.props.children),typeof ui=="object"&&ui!==null){switch(ui.$$typeof){case ke:e:{for(var ls=ui.key,W=$n;W!==null;){if(W.key===ls){if(ls=ui.type,ls===Xe){if(W.tag===7){Ge(li,W.sibling),$n=gt(W,ui.props.children),$n.return=li,li=$n;break e}}else if(W.elementType===ls||typeof ls=="object"&&ls!==null&&ls.$$typeof===_t&&Vd(ls)===W.type){Ge(li,W.sibling),$n=gt(W,ui.props),$n.ref=yu(li,W,ui),$n.return=li,li=$n;break e}Ge(li,W);break}else Se(li,W);W=W.sibling}ui.type===Xe?($n=lu(ui.props.children,li.mode,dr,ui.key),$n.return=li,li=$n):(dr=rd(ui.type,ui.key,ui.props,null,li.mode,dr),dr.ref=yu(li,$n,ui),dr.return=li,li=dr)}return en(li);case Ve:e:{for(W=ui.key;$n!==null;){if($n.key===W)if($n.tag===4&&$n.stateNode.containerInfo===ui.containerInfo&&$n.stateNode.implementation===ui.implementation){Ge(li,$n.sibling),$n=gt($n,ui.children||[]),$n.return=li,li=$n;break e}else{Ge(li,$n);break}else Se(li,$n);$n=$n.sibling}$n=E1(ui,li.mode,dr),$n.return=li,li=$n}return en(li);case _t:return W=ui._init,ua(li,$n,W(ui._payload),dr)}if(kt(ui))return Zr(li,$n,ui,dr);if(ut(ui))return cs(li,$n,ui,dr);Cu(li,ui)}return typeof ui=="string"&&ui!==""||typeof ui=="number"?(ui=""+ui,$n!==null&&$n.tag===6?(Ge(li,$n.sibling),$n=gt($n,ui),$n.return=li,li=$n):(Ge(li,$n),$n=v1(ui,li.mode,dr),$n.return=li,li=$n),en(li)):Ge(li,$n)}return ua}var ra=vc(!0),$i=vc(!1),Mr=W0(null),f0=null,zl=null,Dc=null;function p0(){Dc=zl=f0=null}function Wl(Ee){var Se=Mr.current;Xo(Mr),Ee._currentValue=Se}function Sa(Ee,Se,Ge){for(;Ee!==null;){var nt=Ee.alternate;if((Ee.childLanes&Se)!==Se?(Ee.childLanes|=Se,nt!==null&&(nt.childLanes|=Se)):nt!==null&&(nt.childLanes&Se)!==Se&&(nt.childLanes|=Se),Ee===Ge)break;Ee=Ee.return}}function Ds(Ee,Se){f0=Ee,Dc=zl=null,Ee=Ee.dependencies,Ee!==null&&Ee.firstContext!==null&&(Ee.lanes&Se&&(G0=!0),Ee.firstContext=null)}function $0(Ee){var Se=Ee._currentValue;if(Dc!==Ee)if(Ee={context:Ee,memoizedValue:Se,next:null},zl===null){if(f0===null)throw Error(Y(308));zl=Ee,f0.dependencies={lanes:0,firstContext:Ee}}else zl=zl.next=Ee;return Se}var N0=null;function xu(Ee){N0===null?N0=[Ee]:N0.push(Ee)}function Uh(Ee,Se,Ge,nt){var gt=Se.interleaved;return gt===null?(Ge.next=Ge,xu(Se)):(Ge.next=gt.next,gt.next=Ge),Se.interleaved=Ge,U0(Ee,nt)}function U0(Ee,Se){Ee.lanes|=Se;var Ge=Ee.alternate;for(Ge!==null&&(Ge.lanes|=Se),Ge=Ee,Ee=Ee.return;Ee!==null;)Ee.childLanes|=Se,Ge=Ee.alternate,Ge!==null&&(Ge.childLanes|=Se),Ge=Ee,Ee=Ee.return;return Ge.tag===3?Ge.stateNode:null}var Jn=!1;function $l(Ee){Ee.updateQueue={baseState:Ee.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kh(Ee,Se){Ee=Ee.updateQueue,Se.updateQueue===Ee&&(Se.updateQueue={baseState:Ee.baseState,firstBaseUpdate:Ee.firstBaseUpdate,lastBaseUpdate:Ee.lastBaseUpdate,shared:Ee.shared,effects:Ee.effects})}function nl(Ee,Se){return{eventTime:Ee,lane:Se,tag:0,payload:null,callback:null,next:null}}function gl(Ee,Se,Ge){var nt=Ee.updateQueue;if(nt===null)return null;if(nt=nt.shared,xo&2){var gt=nt.pending;return gt===null?Se.next=Se:(Se.next=gt.next,gt.next=Se),nt.pending=Se,U0(Ee,Ge)}return gt=nt.interleaved,gt===null?(Se.next=Se,xu(nt)):(Se.next=gt.next,gt.next=Se),nt.interleaved=Se,U0(Ee,Ge)}function Ja(Ee,Se,Ge){if(Se=Se.updateQueue,Se!==null&&(Se=Se.shared,(Ge&4194240)!==0)){var nt=Se.lanes;nt&=Ee.pendingLanes,Ge|=nt,Se.lanes=Ge,Yn(Ee,Ge)}}function ju(Ee,Se){var Ge=Ee.updateQueue,nt=Ee.alternate;if(nt!==null&&(nt=nt.updateQueue,Ge===nt)){var gt=null,Pt=null;if(Ge=Ge.firstBaseUpdate,Ge!==null){do{var en={eventTime:Ge.eventTime,lane:Ge.lane,tag:Ge.tag,payload:Ge.payload,callback:Ge.callback,next:null};Pt===null?gt=Pt=en:Pt=Pt.next=en,Ge=Ge.next}while(Ge!==null);Pt===null?gt=Pt=Se:Pt=Pt.next=Se}else gt=Pt=Se;Ge={baseState:nt.baseState,firstBaseUpdate:gt,lastBaseUpdate:Pt,shared:nt.shared,effects:nt.effects},Ee.updateQueue=Ge;return}Ee=Ge.lastBaseUpdate,Ee===null?Ge.firstBaseUpdate=Se:Ee.next=Se,Ge.lastBaseUpdate=Se}function Ec(Ee,Se,Ge,nt){var gt=Ee.updateQueue;Jn=!1;var Pt=gt.firstBaseUpdate,en=gt.lastBaseUpdate,Tn=gt.shared.pending;if(Tn!==null){gt.shared.pending=null;var Hn=Tn,Ei=Hn.next;Hn.next=null,en===null?Pt=Ei:en.next=Ei,en=Hn;var ur=Ee.alternate;ur!==null&&(ur=ur.updateQueue,Tn=ur.lastBaseUpdate,Tn!==en&&(Tn===null?ur.firstBaseUpdate=Ei:Tn.next=Ei,ur.lastBaseUpdate=Hn))}if(Pt!==null){var pr=gt.baseState;en=0,ur=Ei=Hn=null,Tn=Pt;do{var rr=Tn.lane,Hr=Tn.eventTime;if((nt&rr)===rr){ur!==null&&(ur=ur.next={eventTime:Hr,lane:0,tag:Tn.tag,payload:Tn.payload,callback:Tn.callback,next:null});e:{var Zr=Ee,cs=Tn;switch(rr=Se,Hr=Ge,cs.tag){case 1:if(Zr=cs.payload,typeof Zr=="function"){pr=Zr.call(Hr,pr,rr);break e}pr=Zr;break e;case 3:Zr.flags=Zr.flags&-65537|128;case 0:if(Zr=cs.payload,rr=typeof Zr=="function"?Zr.call(Hr,pr,rr):Zr,rr==null)break e;pr=Ut({},pr,rr);break e;case 2:Jn=!0}}Tn.callback!==null&&Tn.lane!==0&&(Ee.flags|=64,rr=gt.effects,rr===null?gt.effects=[Tn]:rr.push(Tn))}else Hr={eventTime:Hr,lane:rr,tag:Tn.tag,payload:Tn.payload,callback:Tn.callback,next:null},ur===null?(Ei=ur=Hr,Hn=pr):ur=ur.next=Hr,en|=rr;if(Tn=Tn.next,Tn===null){if(Tn=gt.shared.pending,Tn===null)break;rr=Tn,Tn=rr.next,rr.next=null,gt.lastBaseUpdate=rr,gt.shared.pending=null}}while(!0);if(ur===null&&(Hn=pr),gt.baseState=Hn,gt.firstBaseUpdate=Ei,gt.lastBaseUpdate=ur,Se=gt.shared.interleaved,Se!==null){gt=Se;do en|=gt.lane,gt=gt.next;while(gt!==Se)}else Pt===null&&(gt.shared.lanes=0);Du|=en,Ee.lanes=en,Ee.memoizedState=pr}}function Gh(Ee,Se,Ge){if(Ee=Se.effects,Se.effects=null,Ee!==null)for(Se=0;Se<Ee.length;Se++){var nt=Ee[Se],gt=nt.callback;if(gt!==null){if(nt.callback=null,nt=Ge,typeof gt!="function")throw Error(Y(191,gt));gt.call(nt)}}}var wu={},es=W0(wu),Xl=W0(wu),Zo=W0(wu);function tu(Ee){if(Ee===wu)throw Error(Y(174));return Ee}function yc(Ee,Se){switch(Co(Zo,Se),Co(Xl,Ee),Co(es,wu),Ee=Se.nodeType,Ee){case 9:case 11:Se=(Se=Se.documentElement)?Se.namespaceURI:Ar(null,"");break;default:Ee=Ee===8?Se.parentNode:Se,Se=Ee.namespaceURI||null,Ee=Ee.tagName,Se=Ar(Se,Ee)}Xo(es),Co(es,Se)}function il(){Xo(es),Xo(Xl),Xo(Zo)}function nu(Ee){tu(Zo.current);var Se=tu(es.current),Ge=Ar(Se,Ee.type);Se!==Ge&&(Co(Xl,Ee),Co(es,Ge))}function r0(Ee){Xl.current===Ee&&(Xo(es),Xo(Xl))}var sa=W0(0);function eh(Ee){for(var Se=Ee;Se!==null;){if(Se.tag===13){var Ge=Se.memoizedState;if(Ge!==null&&(Ge=Ge.dehydrated,Ge===null||Ge.data==="$?"||Ge.data==="$!"))return Se}else if(Se.tag===19&&Se.memoizedProps.revealOrder!==void 0){if(Se.flags&128)return Se}else if(Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===Ee)break;for(;Se.sibling===null;){if(Se.return===null||Se.return===Ee)return null;Se=Se.return}Se.sibling.return=Se.return,Se=Se.sibling}return null}var Qh=[];function Hh(){for(var Ee=0;Ee<Qh.length;Ee++)Qh[Ee]._workInProgressVersionPrimary=null;Qh.length=0}var Pc=Ne.ReactCurrentDispatcher,k0=Ne.ReactCurrentBatchConfig,Kl=0,Ro=null,Ks=null,Ma=null,jo=!1,b0=!1,Yl=0,Vh=0;function ba(){throw Error(Y(321))}function th(Ee,Se){if(Se===null)return!1;for(var Ge=0;Ge<Se.length&&Ge<Ee.length;Ge++)if(!gs(Ee[Ge],Se[Ge]))return!1;return!0}function Su(Ee,Se,Ge,nt,gt,Pt){if(Kl=Pt,Ro=Se,Se.memoizedState=null,Se.updateQueue=null,Se.lanes=0,Pc.current=Ee===null||Ee.memoizedState===null?np:ip,Ee=Ge(nt,gt),b0){Pt=0;do{if(b0=!1,Yl=0,25<=Pt)throw Error(Y(301));Pt+=1,Ma=Ks=null,Se.updateQueue=null,Pc.current=rp,Ee=Ge(nt,gt)}while(b0)}if(Pc.current=$h,Se=Ks!==null&&Ks.next!==null,Kl=0,Ma=Ks=Ro=null,jo=!1,Se)throw Error(Y(300));return Ee}function zh(){var Ee=Yl!==0;return Yl=0,Ee}function vl(){var Ee={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ma===null?Ro.memoizedState=Ma=Ee:Ma=Ma.next=Ee,Ma}function ka(){if(Ks===null){var Ee=Ro.alternate;Ee=Ee!==null?Ee.memoizedState:null}else Ee=Ks.next;var Se=Ma===null?Ro.memoizedState:Ma.next;if(Se!==null)Ma=Se,Ks=Ee;else{if(Ee===null)throw Error(Y(310));Ks=Ee,Ee={memoizedState:Ks.memoizedState,baseState:Ks.baseState,baseQueue:Ks.baseQueue,queue:Ks.queue,next:null},Ma===null?Ro.memoizedState=Ma=Ee:Ma=Ma.next=Ee}return Ma}function El(Ee,Se){return typeof Se=="function"?Se(Ee):Se}function X0(Ee){var Se=ka(),Ge=Se.queue;if(Ge===null)throw Error(Y(311));Ge.lastRenderedReducer=Ee;var nt=Ks,gt=nt.baseQueue,Pt=Ge.pending;if(Pt!==null){if(gt!==null){var en=gt.next;gt.next=Pt.next,Pt.next=en}nt.baseQueue=gt=Pt,Ge.pending=null}if(gt!==null){Pt=gt.next,nt=nt.baseState;var Tn=en=null,Hn=null,Ei=Pt;do{var ur=Ei.lane;if((Kl&ur)===ur)Hn!==null&&(Hn=Hn.next={lane:0,action:Ei.action,hasEagerState:Ei.hasEagerState,eagerState:Ei.eagerState,next:null}),nt=Ei.hasEagerState?Ei.eagerState:Ee(nt,Ei.action);else{var pr={lane:ur,action:Ei.action,hasEagerState:Ei.hasEagerState,eagerState:Ei.eagerState,next:null};Hn===null?(Tn=Hn=pr,en=nt):Hn=Hn.next=pr,Ro.lanes|=ur,Du|=ur}Ei=Ei.next}while(Ei!==null&&Ei!==Pt);Hn===null?en=nt:Hn.next=Tn,gs(nt,Se.memoizedState)||(G0=!0),Se.memoizedState=nt,Se.baseState=en,Se.baseQueue=Hn,Ge.lastRenderedState=nt}if(Ee=Ge.interleaved,Ee!==null){gt=Ee;do Pt=gt.lane,Ro.lanes|=Pt,Du|=Pt,gt=gt.next;while(gt!==Ee)}else gt===null&&(Ge.lanes=0);return[Se.memoizedState,Ge.dispatch]}function Cc(Ee){var Se=ka(),Ge=Se.queue;if(Ge===null)throw Error(Y(311));Ge.lastRenderedReducer=Ee;var nt=Ge.dispatch,gt=Ge.pending,Pt=Se.memoizedState;if(gt!==null){Ge.pending=null;var en=gt=gt.next;do Pt=Ee(Pt,en.action),en=en.next;while(en!==gt);gs(Pt,Se.memoizedState)||(G0=!0),Se.memoizedState=Pt,Se.baseQueue===null&&(Se.baseState=Pt),Ge.lastRenderedState=Pt}return[Pt,nt]}function Mu(){}function G1(Ee,Se){var Ge=Ro,nt=ka(),gt=Se(),Pt=!gs(nt.memoizedState,gt);if(Pt&&(nt.memoizedState=gt,G0=!0),nt=nt.queue,zd(H1.bind(null,Ge,nt,Ee),[Ee]),nt.getSnapshot!==Se||Pt||Ma!==null&&Ma.memoizedState.tag&1){if(Ge.flags|=2048,bu(9,Q1.bind(null,Ge,nt,gt,Se),void 0,null),Za===null)throw Error(Y(349));Kl&30||ql(Ge,Se,gt)}return gt}function ql(Ee,Se,Ge){Ee.flags|=16384,Ee={getSnapshot:Se,value:Ge},Se=Ro.updateQueue,Se===null?(Se={lastEffect:null,stores:null},Ro.updateQueue=Se,Se.stores=[Ee]):(Ge=Se.stores,Ge===null?Se.stores=[Ee]:Ge.push(Ee))}function Q1(Ee,Se,Ge,nt){Se.value=Ge,Se.getSnapshot=nt,V1(Se)&&z1(Ee)}function H1(Ee,Se,Ge){return Ge(function(){V1(Se)&&z1(Ee)})}function V1(Ee){var Se=Ee.getSnapshot;Ee=Ee.value;try{var Ge=Se();return!gs(Ee,Ge)}catch{return!0}}function z1(Ee){var Se=U0(Ee,1);Se!==null&&wl(Se,Ee,1,-1)}function W1(Ee){var Se=vl();return typeof Ee=="function"&&(Ee=Ee()),Se.memoizedState=Se.baseState=Ee,Ee={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:El,lastRenderedState:Ee},Se.queue=Ee,Ee=Ee.dispatch=tp.bind(null,Ro,Ee),[Se.memoizedState,Ee]}function bu(Ee,Se,Ge,nt){return Ee={tag:Ee,create:Se,destroy:Ge,deps:nt,next:null},Se=Ro.updateQueue,Se===null?(Se={lastEffect:null,stores:null},Ro.updateQueue=Se,Se.lastEffect=Ee.next=Ee):(Ge=Se.lastEffect,Ge===null?Se.lastEffect=Ee.next=Ee:(nt=Ge.next,Ge.next=Ee,Ee.next=nt,Se.lastEffect=Ee)),Ee}function $1(){return ka().memoizedState}function Fc(Ee,Se,Ge,nt){var gt=vl();Ro.flags|=Ee,gt.memoizedState=bu(1|Se,Ge,void 0,nt===void 0?null:nt)}function Wh(Ee,Se,Ge,nt){var gt=ka();nt=nt===void 0?null:nt;var Pt=void 0;if(Ks!==null){var en=Ks.memoizedState;if(Pt=en.destroy,nt!==null&&th(nt,en.deps)){gt.memoizedState=bu(Se,Ge,Pt,nt);return}}Ro.flags|=Ee,gt.memoizedState=bu(1|Se,Ge,Pt,nt)}function X1(Ee,Se){return Fc(8390656,8,Ee,Se)}function zd(Ee,Se){return Wh(2048,8,Ee,Se)}function Wd(Ee,Se){return Wh(4,2,Ee,Se)}function K1(Ee,Se){return Wh(4,4,Ee,Se)}function Y1(Ee,Se){if(typeof Se=="function")return Ee=Ee(),Se(Ee),function(){Se(null)};if(Se!=null)return Ee=Ee(),Se.current=Ee,function(){Se.current=null}}function q1(Ee,Se,Ge){return Ge=Ge!=null?Ge.concat([Ee]):null,Wh(4,4,Y1.bind(null,Se,Ee),Ge)}function $d(){}function J1(Ee,Se){var Ge=ka();Se=Se===void 0?null:Se;var nt=Ge.memoizedState;return nt!==null&&Se!==null&&th(Se,nt[1])?nt[0]:(Ge.memoizedState=[Ee,Se],Ee)}function Z1(Ee,Se){var Ge=ka();Se=Se===void 0?null:Se;var nt=Ge.memoizedState;return nt!==null&&Se!==null&&th(Se,nt[1])?nt[0]:(Ee=Ee(),Ge.memoizedState=[Ee,Se],Ee)}function j1(Ee,Se,Ge){return Kl&21?(gs(Ge,Se)||(Ge=zt(),Ro.lanes|=Ge,Du|=Ge,Ee.baseState=!0),Se):(Ee.baseState&&(Ee.baseState=!1,G0=!0),Ee.memoizedState=Ge)}function jf(Ee,Se){var Ge=xi;xi=Ge!==0&&4>Ge?Ge:4,Ee(!0);var nt=k0.transition;k0.transition={};try{Ee(!1),Se()}finally{xi=Ge,k0.transition=nt}}function ef(){return ka().memoizedState}function ep(Ee,Se,Ge){var nt=e0(Ee);if(Ge={lane:nt,action:Ge,hasEagerState:!1,eagerState:null,next:null},tf(Ee))nf(Se,Ge);else if(Ge=Uh(Ee,Se,Ge,nt),Ge!==null){var gt=v0();wl(Ge,Ee,nt,gt),rf(Ge,Se,nt)}}function tp(Ee,Se,Ge){var nt=e0(Ee),gt={lane:nt,action:Ge,hasEagerState:!1,eagerState:null,next:null};if(tf(Ee))nf(Se,gt);else{var Pt=Ee.alternate;if(Ee.lanes===0&&(Pt===null||Pt.lanes===0)&&(Pt=Se.lastRenderedReducer,Pt!==null))try{var en=Se.lastRenderedState,Tn=Pt(en,Ge);if(gt.hasEagerState=!0,gt.eagerState=Tn,gs(Tn,en)){var Hn=Se.interleaved;Hn===null?(gt.next=gt,xu(Se)):(gt.next=Hn.next,Hn.next=gt),Se.interleaved=gt;return}}catch{}finally{}Ge=Uh(Ee,Se,gt,nt),Ge!==null&&(gt=v0(),wl(Ge,Ee,nt,gt),rf(Ge,Se,nt))}}function tf(Ee){var Se=Ee.alternate;return Ee===Ro||Se!==null&&Se===Ro}function nf(Ee,Se){b0=jo=!0;var Ge=Ee.pending;Ge===null?Se.next=Se:(Se.next=Ge.next,Ge.next=Se),Ee.pending=Se}function rf(Ee,Se,Ge){if(Ge&4194240){var nt=Se.lanes;nt&=Ee.pendingLanes,Ge|=nt,Se.lanes=Ge,Yn(Ee,Ge)}}var $h={readContext:$0,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useInsertionEffect:ba,useLayoutEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useMutableSource:ba,useSyncExternalStore:ba,useId:ba,unstable_isNewReconciler:!1},np={readContext:$0,useCallback:function(Ee,Se){return vl().memoizedState=[Ee,Se===void 0?null:Se],Ee},useContext:$0,useEffect:X1,useImperativeHandle:function(Ee,Se,Ge){return Ge=Ge!=null?Ge.concat([Ee]):null,Fc(4194308,4,Y1.bind(null,Se,Ee),Ge)},useLayoutEffect:function(Ee,Se){return Fc(4194308,4,Ee,Se)},useInsertionEffect:function(Ee,Se){return Fc(4,2,Ee,Se)},useMemo:function(Ee,Se){var Ge=vl();return Se=Se===void 0?null:Se,Ee=Ee(),Ge.memoizedState=[Ee,Se],Ee},useReducer:function(Ee,Se,Ge){var nt=vl();return Se=Ge!==void 0?Ge(Se):Se,nt.memoizedState=nt.baseState=Se,Ee={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ee,lastRenderedState:Se},nt.queue=Ee,Ee=Ee.dispatch=ep.bind(null,Ro,Ee),[nt.memoizedState,Ee]},useRef:function(Ee){var Se=vl();return Ee={current:Ee},Se.memoizedState=Ee},useState:W1,useDebugValue:$d,useDeferredValue:function(Ee){return vl().memoizedState=Ee},useTransition:function(){var Ee=W1(!1),Se=Ee[0];return Ee=jf.bind(null,Ee[1]),vl().memoizedState=Ee,[Se,Ee]},useMutableSource:function(){},useSyncExternalStore:function(Ee,Se,Ge){var nt=Ro,gt=vl();if(Io){if(Ge===void 0)throw Error(Y(407));Ge=Ge()}else{if(Ge=Se(),Za===null)throw Error(Y(349));Kl&30||ql(nt,Se,Ge)}gt.memoizedState=Ge;var Pt={value:Ge,getSnapshot:Se};return gt.queue=Pt,X1(H1.bind(null,nt,Pt,Ee),[Ee]),nt.flags|=2048,bu(9,Q1.bind(null,nt,Pt,Ge,Se),void 0,null),Ge},useId:function(){var Ee=vl(),Se=Za.identifierPrefix;if(Io){var Ge=wa,nt=Vl;Ge=(nt&~(1<<32-er(nt)-1)).toString(32)+Ge,Se=":"+Se+"R"+Ge,Ge=Yl++,0<Ge&&(Se+="H"+Ge.toString(32)),Se+=":"}else Ge=Vh++,Se=":"+Se+"r"+Ge.toString(32)+":";return Ee.memoizedState=Se},unstable_isNewReconciler:!1},ip={readContext:$0,useCallback:J1,useContext:$0,useEffect:zd,useImperativeHandle:q1,useInsertionEffect:Wd,useLayoutEffect:K1,useMemo:Z1,useReducer:X0,useRef:$1,useState:function(){return X0(El)},useDebugValue:$d,useDeferredValue:function(Ee){var Se=ka();return j1(Se,Ks.memoizedState,Ee)},useTransition:function(){var Ee=X0(El)[0],Se=ka().memoizedState;return[Ee,Se]},useMutableSource:Mu,useSyncExternalStore:G1,useId:ef,unstable_isNewReconciler:!1},rp={readContext:$0,useCallback:J1,useContext:$0,useEffect:zd,useImperativeHandle:q1,useInsertionEffect:Wd,useLayoutEffect:K1,useMemo:Z1,useReducer:Cc,useRef:$1,useState:function(){return Cc(El)},useDebugValue:$d,useDeferredValue:function(Ee){var Se=ka();return Ks===null?Se.memoizedState=Ee:j1(Se,Ks.memoizedState,Ee)},useTransition:function(){var Ee=Cc(El)[0],Se=ka().memoizedState;return[Ee,Se]},useMutableSource:Mu,useSyncExternalStore:G1,useId:ef,unstable_isNewReconciler:!1};function yl(Ee,Se){if(Ee&&Ee.defaultProps){Se=Ut({},Se),Ee=Ee.defaultProps;for(var Ge in Ee)Se[Ge]===void 0&&(Se[Ge]=Ee[Ge]);return Se}return Se}function Xd(Ee,Se,Ge,nt){Se=Ee.memoizedState,Ge=Ge(nt,Se),Ge=Ge==null?Se:Ut({},Se,Ge),Ee.memoizedState=Ge,Ee.lanes===0&&(Ee.updateQueue.baseState=Ge)}var Xh={isMounted:function(Ee){return(Ee=Ee._reactInternals)?Ts(Ee)===Ee:!1},enqueueSetState:function(Ee,Se,Ge){Ee=Ee._reactInternals;var nt=v0(),gt=e0(Ee),Pt=nl(nt,gt);Pt.payload=Se,Ge!=null&&(Pt.callback=Ge),Se=gl(Ee,Pt,gt),Se!==null&&(wl(Se,Ee,gt,nt),Ja(Se,Ee,gt))},enqueueReplaceState:function(Ee,Se,Ge){Ee=Ee._reactInternals;var nt=v0(),gt=e0(Ee),Pt=nl(nt,gt);Pt.tag=1,Pt.payload=Se,Ge!=null&&(Pt.callback=Ge),Se=gl(Ee,Pt,gt),Se!==null&&(wl(Se,Ee,gt,nt),Ja(Se,Ee,gt))},enqueueForceUpdate:function(Ee,Se){Ee=Ee._reactInternals;var Ge=v0(),nt=e0(Ee),gt=nl(Ge,nt);gt.tag=2,Se!=null&&(gt.callback=Se),Se=gl(Ee,gt,nt),Se!==null&&(wl(Se,Ee,nt,Ge),Ja(Se,Ee,nt))}};function sf(Ee,Se,Ge,nt,gt,Pt,en){return Ee=Ee.stateNode,typeof Ee.shouldComponentUpdate=="function"?Ee.shouldComponentUpdate(nt,Pt,en):Se.prototype&&Se.prototype.isPureReactComponent?!Pl(Ge,nt)||!Pl(gt,Pt):!0}function of(Ee,Se,Ge){var nt=!1,gt=i0,Pt=Se.contextType;return typeof Pt=="object"&&Pt!==null?Pt=$0(Pt):(gt=M0(Se)?Ac:va.current,nt=Se.contextTypes,Pt=(nt=nt!=null)?mc(Ee,gt):i0),Se=new Se(Ge,Pt),Ee.memoizedState=Se.state!==null&&Se.state!==void 0?Se.state:null,Se.updater=Xh,Ee.stateNode=Se,Se._reactInternals=Ee,nt&&(Ee=Ee.stateNode,Ee.__reactInternalMemoizedUnmaskedChildContext=gt,Ee.__reactInternalMemoizedMaskedChildContext=Pt),Se}function af(Ee,Se,Ge,nt){Ee=Se.state,typeof Se.componentWillReceiveProps=="function"&&Se.componentWillReceiveProps(Ge,nt),typeof Se.UNSAFE_componentWillReceiveProps=="function"&&Se.UNSAFE_componentWillReceiveProps(Ge,nt),Se.state!==Ee&&Xh.enqueueReplaceState(Se,Se.state,null)}function Kd(Ee,Se,Ge,nt){var gt=Ee.stateNode;gt.props=Ge,gt.state=Ee.memoizedState,gt.refs={},$l(Ee);var Pt=Se.contextType;typeof Pt=="object"&&Pt!==null?gt.context=$0(Pt):(Pt=M0(Se)?Ac:va.current,gt.context=mc(Ee,Pt)),gt.state=Ee.memoizedState,Pt=Se.getDerivedStateFromProps,typeof Pt=="function"&&(Xd(Ee,Se,Pt,Ge),gt.state=Ee.memoizedState),typeof Se.getDerivedStateFromProps=="function"||typeof gt.getSnapshotBeforeUpdate=="function"||typeof gt.UNSAFE_componentWillMount!="function"&&typeof gt.componentWillMount!="function"||(Se=gt.state,typeof gt.componentWillMount=="function"&&gt.componentWillMount(),typeof gt.UNSAFE_componentWillMount=="function"&&gt.UNSAFE_componentWillMount(),Se!==gt.state&&Xh.enqueueReplaceState(gt,gt.state,null),Ec(Ee,Ge,gt,nt),gt.state=Ee.memoizedState),typeof gt.componentDidMount=="function"&&(Ee.flags|=4194308)}function Tu(Ee,Se){try{var Ge="",nt=Se;do Ge+=An(nt),nt=nt.return;while(nt);var gt=Ge}catch(Pt){gt=`
Error generating stack: `+Pt.message+`
`+Pt.stack}return{value:Ee,source:Se,stack:gt,digest:null}}function Yd(Ee,Se,Ge){return{value:Ee,source:null,stack:Ge??null,digest:Se??null}}function qd(Ee,Se){try{console.error(Se.value)}catch(Ge){setTimeout(function(){throw Ge})}}var Jd=typeof WeakMap=="function"?WeakMap:Map;function lf(Ee,Se,Ge){Ge=nl(-1,Ge),Ge.tag=3,Ge.payload={element:null};var nt=Se.value;return Ge.callback=function(){u1||(u1=!0,Ff=nt),qd(Ee,Se)},Ge}function cf(Ee,Se,Ge){Ge=nl(-1,Ge),Ge.tag=3;var nt=Ee.type.getDerivedStateFromError;if(typeof nt=="function"){var gt=Se.value;Ge.payload=function(){return nt(gt)},Ge.callback=function(){qd(Ee,Se)}}var Pt=Ee.stateNode;return Pt!==null&&typeof Pt.componentDidCatch=="function"&&(Ge.callback=function(){qd(Ee,Se),typeof nt!="function"&&(Uc===null?Uc=new Set([this]):Uc.add(this));var en=Se.stack;this.componentDidCatch(Se.value,{componentStack:en!==null?en:""})}),Ge}function uf(Ee,Se,Ge){var nt=Ee.pingCache;if(nt===null){nt=Ee.pingCache=new Jd;var gt=new Set;nt.set(Se,gt)}else gt=nt.get(Se),gt===void 0&&(gt=new Set,nt.set(Se,gt));gt.has(Ge)||(gt.add(Ge),Ee=nc.bind(null,Ee,Se,Ge),Se.then(Ee,Ee))}function hf(Ee){do{var Se;if((Se=Ee.tag===13)&&(Se=Ee.memoizedState,Se=Se!==null?Se.dehydrated!==null:!0),Se)return Ee;Ee=Ee.return}while(Ee!==null);return null}function df(Ee,Se,Ge,nt,gt){return Ee.mode&1?(Ee.flags|=65536,Ee.lanes=gt,Ee):(Ee===Se?Ee.flags|=65536:(Ee.flags|=128,Ge.flags|=131072,Ge.flags&=-52805,Ge.tag===1&&(Ge.alternate===null?Ge.tag=17:(Se=nl(-1,1),Se.tag=2,gl(Ge,Se,1))),Ge.lanes|=1),Ee)}var sp=Ne.ReactCurrentOwner,G0=!1;function T0(Ee,Se,Ge,nt){Se.child=Ee===null?$i(Se,null,Ge,nt):ra(Se,Ee.child,Ge,nt)}function ff(Ee,Se,Ge,nt,gt){Ge=Ge.render;var Pt=Se.ref;return Ds(Se,gt),nt=Su(Ee,Se,Ge,nt,Pt,gt),Ge=zh(),Ee!==null&&!G0?(Se.updateQueue=Ee.updateQueue,Se.flags&=-2053,Ee.lanes&=~gt,Q0(Ee,Se,gt)):(Io&&Ge&&Wr(Se),Se.flags|=1,T0(Ee,Se,nt,gt),Se.child)}function pf(Ee,Se,Ge,nt,gt){if(Ee===null){var Pt=Ge.type;return typeof Pt=="function"&&!Gc(Pt)&&Pt.defaultProps===void 0&&Ge.compare===null&&Ge.defaultProps===void 0?(Se.tag=15,Se.type=Pt,Af(Ee,Se,Pt,nt,gt)):(Ee=rd(Ge.type,null,nt,Se,Se.mode,gt),Ee.ref=Se.ref,Ee.return=Se,Se.child=Ee)}if(Pt=Ee.child,!(Ee.lanes&gt)){var en=Pt.memoizedProps;if(Ge=Ge.compare,Ge=Ge!==null?Ge:Pl,Ge(en,nt)&&Ee.ref===Se.ref)return Q0(Ee,Se,gt)}return Se.flags|=1,Ee=Sl(Pt,nt),Ee.ref=Se.ref,Ee.return=Se,Se.child=Ee}function Af(Ee,Se,Ge,nt,gt){if(Ee!==null){var Pt=Ee.memoizedProps;if(Pl(Pt,nt)&&Ee.ref===Se.ref)if(G0=!1,Se.pendingProps=nt=Pt,(Ee.lanes&gt)!==0)Ee.flags&131072&&(G0=!0);else return Se.lanes=Ee.lanes,Q0(Ee,Se,gt)}return qs(Ee,Se,Ge,nt,gt)}function mf(Ee,Se,Ge){var nt=Se.pendingProps,gt=nt.children,Pt=Ee!==null?Ee.memoizedState:null;if(nt.mode==="hidden")if(!(Se.mode&1))Se.memoizedState={baseLanes:0,cachePool:null,transitions:null},Co(ih,sl),sl|=Ge;else{if(!(Ge&1073741824))return Ee=Pt!==null?Pt.baseLanes|Ge:Ge,Se.lanes=Se.childLanes=1073741824,Se.memoizedState={baseLanes:Ee,cachePool:null,transitions:null},Se.updateQueue=null,Co(ih,sl),sl|=Ee,null;Se.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt=Pt!==null?Pt.baseLanes:Ge,Co(ih,sl),sl|=nt}else Pt!==null?(nt=Pt.baseLanes|Ge,Se.memoizedState=null):nt=Ge,Co(ih,sl),sl|=nt;return T0(Ee,Se,gt,Ge),Se.child}function Ys(Ee,Se){var Ge=Se.ref;(Ee===null&&Ge!==null||Ee!==null&&Ee.ref!==Ge)&&(Se.flags|=512,Se.flags|=2097152)}function qs(Ee,Se,Ge,nt,gt){var Pt=M0(Ge)?Ac:va.current;return Pt=mc(Se,Pt),Ds(Se,gt),Ge=Su(Ee,Se,Ge,nt,Pt,gt),nt=zh(),Ee!==null&&!G0?(Se.updateQueue=Ee.updateQueue,Se.flags&=-2053,Ee.lanes&=~gt,Q0(Ee,Se,gt)):(Io&&nt&&Wr(Se),Se.flags|=1,T0(Ee,Se,Ge,gt),Se.child)}function gf(Ee,Se,Ge,nt,gt){if(M0(Ge)){var Pt=!0;qu(Se)}else Pt=!1;if(Ds(Se,gt),Se.stateNode===null)Ru(Ee,Se),of(Se,Ge,nt),Kd(Se,Ge,nt,gt),nt=!0;else if(Ee===null){var en=Se.stateNode,Tn=Se.memoizedProps;en.props=Tn;var Hn=en.context,Ei=Ge.contextType;typeof Ei=="object"&&Ei!==null?Ei=$0(Ei):(Ei=M0(Ge)?Ac:va.current,Ei=mc(Se,Ei));var ur=Ge.getDerivedStateFromProps,pr=typeof ur=="function"||typeof en.getSnapshotBeforeUpdate=="function";pr||typeof en.UNSAFE_componentWillReceiveProps!="function"&&typeof en.componentWillReceiveProps!="function"||(Tn!==nt||Hn!==Ei)&&af(Se,en,nt,Ei),Jn=!1;var rr=Se.memoizedState;en.state=rr,Ec(Se,nt,en,gt),Hn=Se.memoizedState,Tn!==nt||rr!==Hn||Ka.current||Jn?(typeof ur=="function"&&(Xd(Se,Ge,ur,nt),Hn=Se.memoizedState),(Tn=Jn||sf(Se,Ge,Tn,nt,rr,Hn,Ei))?(pr||typeof en.UNSAFE_componentWillMount!="function"&&typeof en.componentWillMount!="function"||(typeof en.componentWillMount=="function"&&en.componentWillMount(),typeof en.UNSAFE_componentWillMount=="function"&&en.UNSAFE_componentWillMount()),typeof en.componentDidMount=="function"&&(Se.flags|=4194308)):(typeof en.componentDidMount=="function"&&(Se.flags|=4194308),Se.memoizedProps=nt,Se.memoizedState=Hn),en.props=nt,en.state=Hn,en.context=Ei,nt=Tn):(typeof en.componentDidMount=="function"&&(Se.flags|=4194308),nt=!1)}else{en=Se.stateNode,kh(Ee,Se),Tn=Se.memoizedProps,Ei=Se.type===Se.elementType?Tn:yl(Se.type,Tn),en.props=Ei,pr=Se.pendingProps,rr=en.context,Hn=Ge.contextType,typeof Hn=="object"&&Hn!==null?Hn=$0(Hn):(Hn=M0(Ge)?Ac:va.current,Hn=mc(Se,Hn));var Hr=Ge.getDerivedStateFromProps;(ur=typeof Hr=="function"||typeof en.getSnapshotBeforeUpdate=="function")||typeof en.UNSAFE_componentWillReceiveProps!="function"&&typeof en.componentWillReceiveProps!="function"||(Tn!==pr||rr!==Hn)&&af(Se,en,nt,Hn),Jn=!1,rr=Se.memoizedState,en.state=rr,Ec(Se,nt,en,gt);var Zr=Se.memoizedState;Tn!==pr||rr!==Zr||Ka.current||Jn?(typeof Hr=="function"&&(Xd(Se,Ge,Hr,nt),Zr=Se.memoizedState),(Ei=Jn||sf(Se,Ge,Ei,nt,rr,Zr,Hn)||!1)?(ur||typeof en.UNSAFE_componentWillUpdate!="function"&&typeof en.componentWillUpdate!="function"||(typeof en.componentWillUpdate=="function"&&en.componentWillUpdate(nt,Zr,Hn),typeof en.UNSAFE_componentWillUpdate=="function"&&en.UNSAFE_componentWillUpdate(nt,Zr,Hn)),typeof en.componentDidUpdate=="function"&&(Se.flags|=4),typeof en.getSnapshotBeforeUpdate=="function"&&(Se.flags|=1024)):(typeof en.componentDidUpdate!="function"||Tn===Ee.memoizedProps&&rr===Ee.memoizedState||(Se.flags|=4),typeof en.getSnapshotBeforeUpdate!="function"||Tn===Ee.memoizedProps&&rr===Ee.memoizedState||(Se.flags|=1024),Se.memoizedProps=nt,Se.memoizedState=Zr),en.props=nt,en.state=Zr,en.context=Hn,nt=Ei):(typeof en.componentDidUpdate!="function"||Tn===Ee.memoizedProps&&rr===Ee.memoizedState||(Se.flags|=4),typeof en.getSnapshotBeforeUpdate!="function"||Tn===Ee.memoizedProps&&rr===Ee.memoizedState||(Se.flags|=1024),nt=!1)}return Iu(Ee,Se,Ge,nt,Pt,gt)}function Iu(Ee,Se,Ge,nt,gt,Pt){Ys(Ee,Se);var en=(Se.flags&128)!==0;if(!nt&&!en)return gt&&Go(Se,Ge,!1),Q0(Ee,Se,Pt);nt=Se.stateNode,sp.current=Se;var Tn=en&&typeof Ge.getDerivedStateFromError!="function"?null:nt.render();return Se.flags|=1,Ee!==null&&en?(Se.child=ra(Se,Ee.child,null,Pt),Se.child=ra(Se,null,Tn,Pt)):T0(Ee,Se,Tn,Pt),Se.memoizedState=nt.state,gt&&Go(Se,Ge,!0),Se.child}function Zd(Ee){var Se=Ee.stateNode;Se.pendingContext?Fh(Ee,Se.pendingContext,Se.pendingContext!==Se.context):Se.context&&Fh(Ee,Se.context,!1),yc(Ee,Se.containerInfo)}function jd(Ee,Se,Ge,nt,gt){return _u(),Zu(gt),Se.flags|=256,T0(Ee,Se,Ge,nt),Se.child}var e1={dehydrated:null,treeContext:null,retryLane:0};function iu(Ee){return{baseLanes:Ee,cachePool:null,transitions:null}}function K0(Ee,Se,Ge){var nt=Se.pendingProps,gt=sa.current,Pt=!1,en=(Se.flags&128)!==0,Tn;if((Tn=en)||(Tn=Ee!==null&&Ee.memoizedState===null?!1:(gt&2)!==0),Tn?(Pt=!0,Se.flags&=-129):(Ee===null||Ee.memoizedState!==null)&&(gt|=1),Co(sa,gt&1),Ee===null)return Hd(Se),Ee=Se.memoizedState,Ee!==null&&(Ee=Ee.dehydrated,Ee!==null)?(Se.mode&1?Ee.data==="$!"?Se.lanes=8:Se.lanes=1073741824:Se.lanes=1,null):(en=nt.children,Ee=nt.fallback,Pt?(nt=Se.mode,Pt=Se.child,en={mode:"hidden",children:en},!(nt&1)&&Pt!==null?(Pt.childLanes=0,Pt.pendingProps=en):Pt=sd(en,nt,0,null),Ee=lu(Ee,nt,Ge,null),Pt.return=Se,Ee.return=Se,Pt.sibling=Ee,Se.child=Pt,Se.child.memoizedState=iu(Ge),Se.memoizedState=e1,Ee):Kh(Se,en));if(gt=Ee.memoizedState,gt!==null&&(Tn=gt.dehydrated,Tn!==null))return op(Ee,Se,en,nt,Tn,gt,Ge);if(Pt){Pt=nt.fallback,en=Se.mode,gt=Ee.child,Tn=gt.sibling;var Hn={mode:"hidden",children:nt.children};return!(en&1)&&Se.child!==gt?(nt=Se.child,nt.childLanes=0,nt.pendingProps=Hn,Se.deletions=null):(nt=Sl(gt,Hn),nt.subtreeFlags=gt.subtreeFlags&14680064),Tn!==null?Pt=Sl(Tn,Pt):(Pt=lu(Pt,en,Ge,null),Pt.flags|=2),Pt.return=Se,nt.return=Se,nt.sibling=Pt,Se.child=nt,nt=Pt,Pt=Se.child,en=Ee.child.memoizedState,en=en===null?iu(Ge):{baseLanes:en.baseLanes|Ge,cachePool:null,transitions:en.transitions},Pt.memoizedState=en,Pt.childLanes=Ee.childLanes&~Ge,Se.memoizedState=e1,nt}return Pt=Ee.child,Ee=Pt.sibling,nt=Sl(Pt,{mode:"visible",children:nt.children}),!(Se.mode&1)&&(nt.lanes=Ge),nt.return=Se,nt.sibling=null,Ee!==null&&(Ge=Se.deletions,Ge===null?(Se.deletions=[Ee],Se.flags|=16):Ge.push(Ee)),Se.child=nt,Se.memoizedState=null,nt}function Kh(Ee,Se){return Se=sd({mode:"visible",children:Se},Ee.mode,0,null),Se.return=Ee,Ee.child=Se}function xc(Ee,Se,Ge,nt){return nt!==null&&Zu(nt),ra(Se,Ee.child,null,Ge),Ee=Kh(Se,Se.pendingProps.children),Ee.flags|=2,Se.memoizedState=null,Ee}function op(Ee,Se,Ge,nt,gt,Pt,en){if(Ge)return Se.flags&256?(Se.flags&=-257,nt=Yd(Error(Y(422))),xc(Ee,Se,en,nt)):Se.memoizedState!==null?(Se.child=Ee.child,Se.flags|=128,null):(Pt=nt.fallback,gt=Se.mode,nt=sd({mode:"visible",children:nt.children},gt,0,null),Pt=lu(Pt,gt,en,null),Pt.flags|=2,nt.return=Se,Pt.return=Se,nt.sibling=Pt,Se.child=nt,Se.mode&1&&ra(Se,Ee.child,null,en),Se.child.memoizedState=iu(en),Se.memoizedState=e1,Pt);if(!(Se.mode&1))return xc(Ee,Se,en,null);if(gt.data==="$!"){if(nt=gt.nextSibling&&gt.nextSibling.dataset,nt)var Tn=nt.dgst;return nt=Tn,Pt=Error(Y(419)),nt=Yd(Pt,nt,void 0),xc(Ee,Se,en,nt)}if(Tn=(en&Ee.childLanes)!==0,G0||Tn){if(nt=Za,nt!==null){switch(en&-en){case 4:gt=2;break;case 16:gt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:gt=32;break;case 536870912:gt=268435456;break;default:gt=0}gt=gt&(nt.suspendedLanes|en)?0:gt,gt!==0&&gt!==Pt.retryLane&&(Pt.retryLane=gt,U0(Ee,gt),wl(nt,Ee,gt,-1))}return jl(),nt=Yd(Error(Y(421))),xc(Ee,Se,en,nt)}return gt.data==="$?"?(Se.flags|=128,Se.child=Ee.child,Se=Qp.bind(null,Ee),gt._reactRetry=Se,null):(Ee=Pt.treeContext,Oo=z0(gt.nextSibling),Na=Se,Io=!0,Ua=null,Ee!==null&&(qa[O0++]=Vl,qa[O0++]=wa,qa[O0++]=Fa,Vl=Ee.id,wa=Ee.overflow,Fa=Se),Se=Kh(Se,nt.children),Se.flags|=4096,Se)}function vf(Ee,Se,Ge){Ee.lanes|=Se;var nt=Ee.alternate;nt!==null&&(nt.lanes|=Se),Sa(Ee.return,Se,Ge)}function t1(Ee,Se,Ge,nt,gt){var Pt=Ee.memoizedState;Pt===null?Ee.memoizedState={isBackwards:Se,rendering:null,renderingStartTime:0,last:nt,tail:Ge,tailMode:gt}:(Pt.isBackwards=Se,Pt.rendering=null,Pt.renderingStartTime=0,Pt.last=nt,Pt.tail=Ge,Pt.tailMode=gt)}function n1(Ee,Se,Ge){var nt=Se.pendingProps,gt=nt.revealOrder,Pt=nt.tail;if(T0(Ee,Se,nt.children,Ge),nt=sa.current,nt&2)nt=nt&1|2,Se.flags|=128;else{if(Ee!==null&&Ee.flags&128)e:for(Ee=Se.child;Ee!==null;){if(Ee.tag===13)Ee.memoizedState!==null&&vf(Ee,Ge,Se);else if(Ee.tag===19)vf(Ee,Ge,Se);else if(Ee.child!==null){Ee.child.return=Ee,Ee=Ee.child;continue}if(Ee===Se)break e;for(;Ee.sibling===null;){if(Ee.return===null||Ee.return===Se)break e;Ee=Ee.return}Ee.sibling.return=Ee.return,Ee=Ee.sibling}nt&=1}if(Co(sa,nt),!(Se.mode&1))Se.memoizedState=null;else switch(gt){case"forwards":for(Ge=Se.child,gt=null;Ge!==null;)Ee=Ge.alternate,Ee!==null&&eh(Ee)===null&&(gt=Ge),Ge=Ge.sibling;Ge=gt,Ge===null?(gt=Se.child,Se.child=null):(gt=Ge.sibling,Ge.sibling=null),t1(Se,!1,gt,Ge,Pt);break;case"backwards":for(Ge=null,gt=Se.child,Se.child=null;gt!==null;){if(Ee=gt.alternate,Ee!==null&&eh(Ee)===null){Se.child=gt;break}Ee=gt.sibling,gt.sibling=Ge,Ge=gt,gt=Ee}t1(Se,!0,Ge,null,Pt);break;case"together":t1(Se,!1,null,null,void 0);break;default:Se.memoizedState=null}return Se.child}function Ru(Ee,Se){!(Se.mode&1)&&Ee!==null&&(Ee.alternate=null,Se.alternate=null,Se.flags|=2)}function Q0(Ee,Se,Ge){if(Ee!==null&&(Se.dependencies=Ee.dependencies),Du|=Se.lanes,!(Ge&Se.childLanes))return null;if(Ee!==null&&Se.child!==Ee.child)throw Error(Y(153));if(Se.child!==null){for(Ee=Se.child,Ge=Sl(Ee,Ee.pendingProps),Se.child=Ge,Ge.return=Se;Ee.sibling!==null;)Ee=Ee.sibling,Ge=Ge.sibling=Sl(Ee,Ee.pendingProps),Ge.return=Se;Ge.sibling=null}return Se.child}function ap(Ee,Se,Ge){switch(Se.tag){case 3:Zd(Se),_u();break;case 5:nu(Se);break;case 1:M0(Se.type)&&qu(Se);break;case 4:yc(Se,Se.stateNode.containerInfo);break;case 10:var nt=Se.type._context,gt=Se.memoizedProps.value;Co(Mr,nt._currentValue),nt._currentValue=gt;break;case 13:if(nt=Se.memoizedState,nt!==null)return nt.dehydrated!==null?(Co(sa,sa.current&1),Se.flags|=128,null):Ge&Se.child.childLanes?K0(Ee,Se,Ge):(Co(sa,sa.current&1),Ee=Q0(Ee,Se,Ge),Ee!==null?Ee.sibling:null);Co(sa,sa.current&1);break;case 19:if(nt=(Ge&Se.childLanes)!==0,Ee.flags&128){if(nt)return n1(Ee,Se,Ge);Se.flags|=128}if(gt=Se.memoizedState,gt!==null&&(gt.rendering=null,gt.tail=null,gt.lastEffect=null),Co(sa,sa.current),nt)break;return null;case 22:case 23:return Se.lanes=0,mf(Ee,Se,Ge)}return Q0(Ee,Se,Ge)}var Yh,i1,Ef,yf;Yh=function(Ee,Se){for(var Ge=Se.child;Ge!==null;){if(Ge.tag===5||Ge.tag===6)Ee.appendChild(Ge.stateNode);else if(Ge.tag!==4&&Ge.child!==null){Ge.child.return=Ge,Ge=Ge.child;continue}if(Ge===Se)break;for(;Ge.sibling===null;){if(Ge.return===null||Ge.return===Se)return;Ge=Ge.return}Ge.sibling.return=Ge.return,Ge=Ge.sibling}},i1=function(){},Ef=function(Ee,Se,Ge,nt){var gt=Ee.memoizedProps;if(gt!==nt){Ee=Se.stateNode,tu(es.current);var Pt=null;switch(Ge){case"input":gt=Vr(Ee,gt),nt=Vr(Ee,nt),Pt=[];break;case"select":gt=Ut({},gt,{value:void 0}),nt=Ut({},nt,{value:void 0}),Pt=[];break;case"textarea":gt=Kn(Ee,gt),nt=Kn(Ee,nt),Pt=[];break;default:typeof gt.onClick!="function"&&typeof nt.onClick=="function"&&(Ee.onclick=Xa)}Nt(Ge,nt);var en;Ge=null;for(Ei in gt)if(!nt.hasOwnProperty(Ei)&&gt.hasOwnProperty(Ei)&&gt[Ei]!=null)if(Ei==="style"){var Tn=gt[Ei];for(en in Tn)Tn.hasOwnProperty(en)&&(Ge||(Ge={}),Ge[en]="")}else Ei!=="dangerouslySetInnerHTML"&&Ei!=="children"&&Ei!=="suppressContentEditableWarning"&&Ei!=="suppressHydrationWarning"&&Ei!=="autoFocus"&&(ne.hasOwnProperty(Ei)?Pt||(Pt=[]):(Pt=Pt||[]).push(Ei,null));for(Ei in nt){var Hn=nt[Ei];if(Tn=gt!=null?gt[Ei]:void 0,nt.hasOwnProperty(Ei)&&Hn!==Tn&&(Hn!=null||Tn!=null))if(Ei==="style")if(Tn){for(en in Tn)!Tn.hasOwnProperty(en)||Hn&&Hn.hasOwnProperty(en)||(Ge||(Ge={}),Ge[en]="");for(en in Hn)Hn.hasOwnProperty(en)&&Tn[en]!==Hn[en]&&(Ge||(Ge={}),Ge[en]=Hn[en])}else Ge||(Pt||(Pt=[]),Pt.push(Ei,Ge)),Ge=Hn;else Ei==="dangerouslySetInnerHTML"?(Hn=Hn?Hn.__html:void 0,Tn=Tn?Tn.__html:void 0,Hn!=null&&Tn!==Hn&&(Pt=Pt||[]).push(Ei,Hn)):Ei==="children"?typeof Hn!="string"&&typeof Hn!="number"||(Pt=Pt||[]).push(Ei,""+Hn):Ei!=="suppressContentEditableWarning"&&Ei!=="suppressHydrationWarning"&&(ne.hasOwnProperty(Ei)?(Hn!=null&&Ei==="onScroll"&&Rs("scroll",Ee),Pt||Tn===Hn||(Pt=[])):(Pt=Pt||[]).push(Ei,Hn))}Ge&&(Pt=Pt||[]).push("style",Ge);var Ei=Pt;(Se.updateQueue=Ei)&&(Se.flags|=4)}},yf=function(Ee,Se,Ge,nt){Ge!==nt&&(Se.flags|=4)};function nh(Ee,Se){if(!Io)switch(Ee.tailMode){case"hidden":Se=Ee.tail;for(var Ge=null;Se!==null;)Se.alternate!==null&&(Ge=Se),Se=Se.sibling;Ge===null?Ee.tail=null:Ge.sibling=null;break;case"collapsed":Ge=Ee.tail;for(var nt=null;Ge!==null;)Ge.alternate!==null&&(nt=Ge),Ge=Ge.sibling;nt===null?Se||Ee.tail===null?Ee.tail=null:Ee.tail.sibling=null:nt.sibling=null}}function A0(Ee){var Se=Ee.alternate!==null&&Ee.alternate.child===Ee.child,Ge=0,nt=0;if(Se)for(var gt=Ee.child;gt!==null;)Ge|=gt.lanes|gt.childLanes,nt|=gt.subtreeFlags&14680064,nt|=gt.flags&14680064,gt.return=Ee,gt=gt.sibling;else for(gt=Ee.child;gt!==null;)Ge|=gt.lanes|gt.childLanes,nt|=gt.subtreeFlags,nt|=gt.flags,gt.return=Ee,gt=gt.sibling;return Ee.subtreeFlags|=nt,Ee.childLanes=Ge,Se}function lp(Ee,Se,Ge){var nt=Se.pendingProps;switch(Oa(Se),Se.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return A0(Se),null;case 1:return M0(Se.type)&&eu(),A0(Se),null;case 3:return nt=Se.stateNode,il(),Xo(Ka),Xo(va),Hh(),nt.pendingContext&&(nt.context=nt.pendingContext,nt.pendingContext=null),(Ee===null||Ee.child===null)&&(gc(Se)?Se.flags|=4:Ee===null||Ee.memoizedState.isDehydrated&&!(Se.flags&256)||(Se.flags|=1024,Ua!==null&&(Pu(Ua),Ua=null))),i1(Ee,Se),A0(Se),null;case 5:r0(Se);var gt=tu(Zo.current);if(Ge=Se.type,Ee!==null&&Se.stateNode!=null)Ef(Ee,Se,Ge,nt,gt),Ee.ref!==Se.ref&&(Se.flags|=512,Se.flags|=2097152);else{if(!nt){if(Se.stateNode===null)throw Error(Y(166));return A0(Se),null}if(Ee=tu(es.current),gc(Se)){nt=Se.stateNode,Ge=Se.type;var Pt=Se.memoizedProps;switch(nt[kr]=Se,nt[ia]=Pt,Ee=(Se.mode&1)!==0,Ge){case"dialog":Rs("cancel",nt),Rs("close",nt);break;case"iframe":case"object":case"embed":Rs("load",nt);break;case"video":case"audio":for(gt=0;gt<to.length;gt++)Rs(to[gt],nt);break;case"source":Rs("error",nt);break;case"img":case"image":case"link":Rs("error",nt),Rs("load",nt);break;case"details":Rs("toggle",nt);break;case"input":Ir(nt,Pt),Rs("invalid",nt);break;case"select":nt._wrapperState={wasMultiple:!!Pt.multiple},Rs("invalid",nt);break;case"textarea":ai(nt,Pt),Rs("invalid",nt)}Nt(Ge,Pt),gt=null;for(var en in Pt)if(Pt.hasOwnProperty(en)){var Tn=Pt[en];en==="children"?typeof Tn=="string"?nt.textContent!==Tn&&(Pt.suppressHydrationWarning!==!0&&Hs(nt.textContent,Tn,Ee),gt=["children",Tn]):typeof Tn=="number"&&nt.textContent!==""+Tn&&(Pt.suppressHydrationWarning!==!0&&Hs(nt.textContent,Tn,Ee),gt=["children",""+Tn]):ne.hasOwnProperty(en)&&Tn!=null&&en==="onScroll"&&Rs("scroll",nt)}switch(Ge){case"input":Qi(nt),zr(nt,Pt,!0);break;case"textarea":Qi(nt),yi(nt);break;case"select":case"option":break;default:typeof Pt.onClick=="function"&&(nt.onclick=Xa)}nt=gt,Se.updateQueue=nt,nt!==null&&(Se.flags|=4)}else{en=gt.nodeType===9?gt:gt.ownerDocument,Ee==="http://www.w3.org/1999/xhtml"&&(Ee=Nr(Ge)),Ee==="http://www.w3.org/1999/xhtml"?Ge==="script"?(Ee=en.createElement("div"),Ee.innerHTML="<script><\/script>",Ee=Ee.removeChild(Ee.firstChild)):typeof nt.is=="string"?Ee=en.createElement(Ge,{is:nt.is}):(Ee=en.createElement(Ge),Ge==="select"&&(en=Ee,nt.multiple?en.multiple=!0:nt.size&&(en.size=nt.size))):Ee=en.createElementNS(Ee,Ge),Ee[kr]=Se,Ee[ia]=nt,Yh(Ee,Se,!1,!1),Se.stateNode=Ee;e:{switch(en=ht(Ge,nt),Ge){case"dialog":Rs("cancel",Ee),Rs("close",Ee),gt=nt;break;case"iframe":case"object":case"embed":Rs("load",Ee),gt=nt;break;case"video":case"audio":for(gt=0;gt<to.length;gt++)Rs(to[gt],Ee);gt=nt;break;case"source":Rs("error",Ee),gt=nt;break;case"img":case"image":case"link":Rs("error",Ee),Rs("load",Ee),gt=nt;break;case"details":Rs("toggle",Ee),gt=nt;break;case"input":Ir(Ee,nt),gt=Vr(Ee,nt),Rs("invalid",Ee);break;case"option":gt=nt;break;case"select":Ee._wrapperState={wasMultiple:!!nt.multiple},gt=Ut({},nt,{value:void 0}),Rs("invalid",Ee);break;case"textarea":ai(Ee,nt),gt=Kn(Ee,nt),Rs("invalid",Ee);break;default:gt=nt}Nt(Ge,gt),Tn=gt;for(Pt in Tn)if(Tn.hasOwnProperty(Pt)){var Hn=Tn[Pt];Pt==="style"?an(Ee,Hn):Pt==="dangerouslySetInnerHTML"?(Hn=Hn?Hn.__html:void 0,Hn!=null&&Bi(Ee,Hn)):Pt==="children"?typeof Hn=="string"?(Ge!=="textarea"||Hn!=="")&&Kt(Ee,Hn):typeof Hn=="number"&&Kt(Ee,""+Hn):Pt!=="suppressContentEditableWarning"&&Pt!=="suppressHydrationWarning"&&Pt!=="autoFocus"&&(ne.hasOwnProperty(Pt)?Hn!=null&&Pt==="onScroll"&&Rs("scroll",Ee):Hn!=null&&Oe(Ee,Pt,Hn,en))}switch(Ge){case"input":Qi(Ee),zr(Ee,nt,!1);break;case"textarea":Qi(Ee),yi(Ee);break;case"option":nt.value!=null&&Ee.setAttribute("value",""+Qn(nt.value));break;case"select":Ee.multiple=!!nt.multiple,Pt=nt.value,Pt!=null?rn(Ee,!!nt.multiple,Pt,!1):nt.defaultValue!=null&&rn(Ee,!!nt.multiple,nt.defaultValue,!0);break;default:typeof gt.onClick=="function"&&(Ee.onclick=Xa)}switch(Ge){case"button":case"input":case"select":case"textarea":nt=!!nt.autoFocus;break e;case"img":nt=!0;break e;default:nt=!1}}nt&&(Se.flags|=4)}Se.ref!==null&&(Se.flags|=512,Se.flags|=2097152)}return A0(Se),null;case 6:if(Ee&&Se.stateNode!=null)yf(Ee,Se,Ee.memoizedProps,nt);else{if(typeof nt!="string"&&Se.stateNode===null)throw Error(Y(166));if(Ge=tu(Zo.current),tu(es.current),gc(Se)){if(nt=Se.stateNode,Ge=Se.memoizedProps,nt[kr]=Se,(Pt=nt.nodeValue!==Ge)&&(Ee=Na,Ee!==null))switch(Ee.tag){case 3:Hs(nt.nodeValue,Ge,(Ee.mode&1)!==0);break;case 5:Ee.memoizedProps.suppressHydrationWarning!==!0&&Hs(nt.nodeValue,Ge,(Ee.mode&1)!==0)}Pt&&(Se.flags|=4)}else nt=(Ge.nodeType===9?Ge:Ge.ownerDocument).createTextNode(nt),nt[kr]=Se,Se.stateNode=nt}return A0(Se),null;case 13:if(Xo(sa),nt=Se.memoizedState,Ee===null||Ee.memoizedState!==null&&Ee.memoizedState.dehydrated!==null){if(Io&&Oo!==null&&Se.mode&1&&!(Se.flags&128))So(),_u(),Se.flags|=98560,Pt=!1;else if(Pt=gc(Se),nt!==null&&nt.dehydrated!==null){if(Ee===null){if(!Pt)throw Error(Y(318));if(Pt=Se.memoizedState,Pt=Pt!==null?Pt.dehydrated:null,!Pt)throw Error(Y(317));Pt[kr]=Se}else _u(),!(Se.flags&128)&&(Se.memoizedState=null),Se.flags|=4;A0(Se),Pt=!1}else Ua!==null&&(Pu(Ua),Ua=null),Pt=!0;if(!Pt)return Se.flags&65536?Se:null}return Se.flags&128?(Se.lanes=Ge,Se):(nt=nt!==null,nt!==(Ee!==null&&Ee.memoizedState!==null)&&nt&&(Se.child.flags|=8192,Se.mode&1&&(Ee===null||sa.current&1?ja===0&&(ja=3):jl())),Se.updateQueue!==null&&(Se.flags|=4),A0(Se),null);case 4:return il(),i1(Ee,Se),Ee===null&&F0(Se.stateNode.containerInfo),A0(Se),null;case 10:return Wl(Se.type._context),A0(Se),null;case 17:return M0(Se.type)&&eu(),A0(Se),null;case 19:if(Xo(sa),Pt=Se.memoizedState,Pt===null)return A0(Se),null;if(nt=(Se.flags&128)!==0,en=Pt.rendering,en===null)if(nt)nh(Pt,!1);else{if(ja!==0||Ee!==null&&Ee.flags&128)for(Ee=Se.child;Ee!==null;){if(en=eh(Ee),en!==null){for(Se.flags|=128,nh(Pt,!1),nt=en.updateQueue,nt!==null&&(Se.updateQueue=nt,Se.flags|=4),Se.subtreeFlags=0,nt=Ge,Ge=Se.child;Ge!==null;)Pt=Ge,Ee=nt,Pt.flags&=14680066,en=Pt.alternate,en===null?(Pt.childLanes=0,Pt.lanes=Ee,Pt.child=null,Pt.subtreeFlags=0,Pt.memoizedProps=null,Pt.memoizedState=null,Pt.updateQueue=null,Pt.dependencies=null,Pt.stateNode=null):(Pt.childLanes=en.childLanes,Pt.lanes=en.lanes,Pt.child=en.child,Pt.subtreeFlags=0,Pt.deletions=null,Pt.memoizedProps=en.memoizedProps,Pt.memoizedState=en.memoizedState,Pt.updateQueue=en.updateQueue,Pt.type=en.type,Ee=en.dependencies,Pt.dependencies=Ee===null?null:{lanes:Ee.lanes,firstContext:Ee.firstContext}),Ge=Ge.sibling;return Co(sa,sa.current&1|2),Se.child}Ee=Ee.sibling}Pt.tail!==null&&Dn()>rh&&(Se.flags|=128,nt=!0,nh(Pt,!1),Se.lanes=4194304)}else{if(!nt)if(Ee=eh(en),Ee!==null){if(Se.flags|=128,nt=!0,Ge=Ee.updateQueue,Ge!==null&&(Se.updateQueue=Ge,Se.flags|=4),nh(Pt,!0),Pt.tail===null&&Pt.tailMode==="hidden"&&!en.alternate&&!Io)return A0(Se),null}else 2*Dn()-Pt.renderingStartTime>rh&&Ge!==1073741824&&(Se.flags|=128,nt=!0,nh(Pt,!1),Se.lanes=4194304);Pt.isBackwards?(en.sibling=Se.child,Se.child=en):(Ge=Pt.last,Ge!==null?Ge.sibling=en:Se.child=en,Pt.last=en)}return Pt.tail!==null?(Se=Pt.tail,Pt.rendering=Se,Pt.tail=Se.sibling,Pt.renderingStartTime=Dn(),Se.sibling=null,Ge=sa.current,Co(sa,nt?Ge&1|2:Ge&1),Se):(A0(Se),null);case 22:case 23:return p1(),nt=Se.memoizedState!==null,Ee!==null&&Ee.memoizedState!==null!==nt&&(Se.flags|=8192),nt&&Se.mode&1?sl&1073741824&&(A0(Se),Se.subtreeFlags&6&&(Se.flags|=8192)):A0(Se),null;case 24:return null;case 25:return null}throw Error(Y(156,Se.tag))}function cp(Ee,Se){switch(Oa(Se),Se.tag){case 1:return M0(Se.type)&&eu(),Ee=Se.flags,Ee&65536?(Se.flags=Ee&-65537|128,Se):null;case 3:return il(),Xo(Ka),Xo(va),Hh(),Ee=Se.flags,Ee&65536&&!(Ee&128)?(Se.flags=Ee&-65537|128,Se):null;case 5:return r0(Se),null;case 13:if(Xo(sa),Ee=Se.memoizedState,Ee!==null&&Ee.dehydrated!==null){if(Se.alternate===null)throw Error(Y(340));_u()}return Ee=Se.flags,Ee&65536?(Se.flags=Ee&-65537|128,Se):null;case 19:return Xo(sa),null;case 4:return il(),null;case 10:return Wl(Se.type._context),null;case 22:case 23:return p1(),null;case 24:return null;default:return null}}var qh=!1,m0=!1,up=typeof WeakSet=="function"?WeakSet:Set,ts=null;function Bu(Ee,Se){var Ge=Ee.ref;if(Ge!==null)if(typeof Ge=="function")try{Ge(null)}catch(nt){Bs(Ee,Se,nt)}else Ge.current=null}function r1(Ee,Se,Ge){try{Ge()}catch(nt){Bs(Ee,Se,nt)}}var Cf=!1;function hp(Ee,Se){if(ul=Z0,Ee=cc(),mu(Ee)){if("selectionStart"in Ee)var Ge={start:Ee.selectionStart,end:Ee.selectionEnd};else e:{Ge=(Ge=Ee.ownerDocument)&&Ge.defaultView||window;var nt=Ge.getSelection&&Ge.getSelection();if(nt&&nt.rangeCount!==0){Ge=nt.anchorNode;var gt=nt.anchorOffset,Pt=nt.focusNode;nt=nt.focusOffset;try{Ge.nodeType,Pt.nodeType}catch{Ge=null;break e}var en=0,Tn=-1,Hn=-1,Ei=0,ur=0,pr=Ee,rr=null;t:for(;;){for(var Hr;pr!==Ge||gt!==0&&pr.nodeType!==3||(Tn=en+gt),pr!==Pt||nt!==0&&pr.nodeType!==3||(Hn=en+nt),pr.nodeType===3&&(en+=pr.nodeValue.length),(Hr=pr.firstChild)!==null;)rr=pr,pr=Hr;for(;;){if(pr===Ee)break t;if(rr===Ge&&++Ei===gt&&(Tn=en),rr===Pt&&++ur===nt&&(Hn=en),(Hr=pr.nextSibling)!==null)break;pr=rr,rr=pr.parentNode}pr=Hr}Ge=Tn===-1||Hn===-1?null:{start:Tn,end:Hn}}else Ge=null}Ge=Ge||{start:0,end:0}}else Ge=null;for(hl={focusedElem:Ee,selectionRange:Ge},Z0=!1,ts=Se;ts!==null;)if(Se=ts,Ee=Se.child,(Se.subtreeFlags&1028)!==0&&Ee!==null)Ee.return=Se,ts=Ee;else for(;ts!==null;){Se=ts;try{var Zr=Se.alternate;if(Se.flags&1024)switch(Se.tag){case 0:case 11:case 15:break;case 1:if(Zr!==null){var cs=Zr.memoizedProps,ua=Zr.memoizedState,li=Se.stateNode,$n=li.getSnapshotBeforeUpdate(Se.elementType===Se.type?cs:yl(Se.type,cs),ua);li.__reactInternalSnapshotBeforeUpdate=$n}break;case 3:var ui=Se.stateNode.containerInfo;ui.nodeType===1?ui.textContent="":ui.nodeType===9&&ui.documentElement&&ui.removeChild(ui.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(dr){Bs(Se,Se.return,dr)}if(Ee=Se.sibling,Ee!==null){Ee.return=Se.return,ts=Ee;break}ts=Se.return}return Zr=Cf,Cf=!1,Zr}function Lu(Ee,Se,Ge){var nt=Se.updateQueue;if(nt=nt!==null?nt.lastEffect:null,nt!==null){var gt=nt=nt.next;do{if((gt.tag&Ee)===Ee){var Pt=gt.destroy;gt.destroy=void 0,Pt!==void 0&&r1(Se,Ge,Pt)}gt=gt.next}while(gt!==nt)}}function Jh(Ee,Se){if(Se=Se.updateQueue,Se=Se!==null?Se.lastEffect:null,Se!==null){var Ge=Se=Se.next;do{if((Ge.tag&Ee)===Ee){var nt=Ge.create;Ge.destroy=nt()}Ge=Ge.next}while(Ge!==Se)}}function s1(Ee){var Se=Ee.ref;if(Se!==null){var Ge=Ee.stateNode;switch(Ee.tag){case 5:Ee=Ge;break;default:Ee=Ge}typeof Se=="function"?Se(Ee):Se.current=Ee}}function xf(Ee){var Se=Ee.alternate;Se!==null&&(Ee.alternate=null,xf(Se)),Ee.child=null,Ee.deletions=null,Ee.sibling=null,Ee.tag===5&&(Se=Ee.stateNode,Se!==null&&(delete Se[kr],delete Se[ia],delete Se[kd],delete Se[Zf],delete Se[Bc])),Ee.stateNode=null,Ee.return=null,Ee.dependencies=null,Ee.memoizedProps=null,Ee.memoizedState=null,Ee.pendingProps=null,Ee.stateNode=null,Ee.updateQueue=null}function wf(Ee){return Ee.tag===5||Ee.tag===3||Ee.tag===4}function Sf(Ee){e:for(;;){for(;Ee.sibling===null;){if(Ee.return===null||wf(Ee.return))return null;Ee=Ee.return}for(Ee.sibling.return=Ee.return,Ee=Ee.sibling;Ee.tag!==5&&Ee.tag!==6&&Ee.tag!==18;){if(Ee.flags&2||Ee.child===null||Ee.tag===4)continue e;Ee.child.return=Ee,Ee=Ee.child}if(!(Ee.flags&2))return Ee.stateNode}}function o1(Ee,Se,Ge){var nt=Ee.tag;if(nt===5||nt===6)Ee=Ee.stateNode,Se?Ge.nodeType===8?Ge.parentNode.insertBefore(Ee,Se):Ge.insertBefore(Ee,Se):(Ge.nodeType===8?(Se=Ge.parentNode,Se.insertBefore(Ee,Ge)):(Se=Ge,Se.appendChild(Ee)),Ge=Ge._reactRootContainer,Ge!=null||Se.onclick!==null||(Se.onclick=Xa));else if(nt!==4&&(Ee=Ee.child,Ee!==null))for(o1(Ee,Se,Ge),Ee=Ee.sibling;Ee!==null;)o1(Ee,Se,Ge),Ee=Ee.sibling}function a1(Ee,Se,Ge){var nt=Ee.tag;if(nt===5||nt===6)Ee=Ee.stateNode,Se?Ge.insertBefore(Ee,Se):Ge.appendChild(Ee);else if(nt!==4&&(Ee=Ee.child,Ee!==null))for(a1(Ee,Se,Ge),Ee=Ee.sibling;Ee!==null;)a1(Ee,Se,Ge),Ee=Ee.sibling}var s0=null,Cl=!1;function Oc(Ee,Se,Ge){for(Ge=Ge.child;Ge!==null;)Mf(Ee,Se,Ge),Ge=Ge.sibling}function Mf(Ee,Se,Ge){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(Sr,Ge)}catch{}switch(Ge.tag){case 5:m0||Bu(Ge,Se);case 6:var nt=s0,gt=Cl;s0=null,Oc(Ee,Se,Ge),s0=nt,Cl=gt,s0!==null&&(Cl?(Ee=s0,Ge=Ge.stateNode,Ee.nodeType===8?Ee.parentNode.removeChild(Ge):Ee.removeChild(Ge)):s0.removeChild(Ge.stateNode));break;case 18:s0!==null&&(Cl?(Ee=s0,Ge=Ge.stateNode,Ee.nodeType===8?Jc(Ee.parentNode,Ge):Ee.nodeType===1&&Jc(Ee,Ge),H0(Ee)):Jc(s0,Ge.stateNode));break;case 4:nt=s0,gt=Cl,s0=Ge.stateNode.containerInfo,Cl=!0,Oc(Ee,Se,Ge),s0=nt,Cl=gt;break;case 0:case 11:case 14:case 15:if(!m0&&(nt=Ge.updateQueue,nt!==null&&(nt=nt.lastEffect,nt!==null))){gt=nt=nt.next;do{var Pt=gt,en=Pt.destroy;Pt=Pt.tag,en!==void 0&&(Pt&2||Pt&4)&&r1(Ge,Se,en),gt=gt.next}while(gt!==nt)}Oc(Ee,Se,Ge);break;case 1:if(!m0&&(Bu(Ge,Se),nt=Ge.stateNode,typeof nt.componentWillUnmount=="function"))try{nt.props=Ge.memoizedProps,nt.state=Ge.memoizedState,nt.componentWillUnmount()}catch(Tn){Bs(Ge,Se,Tn)}Oc(Ee,Se,Ge);break;case 21:Oc(Ee,Se,Ge);break;case 22:Ge.mode&1?(m0=(nt=m0)||Ge.memoizedState!==null,Oc(Ee,Se,Ge),m0=nt):Oc(Ee,Se,Ge);break;default:Oc(Ee,Se,Ge)}}function bf(Ee){var Se=Ee.updateQueue;if(Se!==null){Ee.updateQueue=null;var Ge=Ee.stateNode;Ge===null&&(Ge=Ee.stateNode=new up),Se.forEach(function(nt){var gt=m1.bind(null,Ee,nt);Ge.has(nt)||(Ge.add(nt),nt.then(gt,gt))})}}function xl(Ee,Se){var Ge=Se.deletions;if(Ge!==null)for(var nt=0;nt<Ge.length;nt++){var gt=Ge[nt];try{var Pt=Ee,en=Se,Tn=en;e:for(;Tn!==null;){switch(Tn.tag){case 5:s0=Tn.stateNode,Cl=!1;break e;case 3:s0=Tn.stateNode.containerInfo,Cl=!0;break e;case 4:s0=Tn.stateNode.containerInfo,Cl=!0;break e}Tn=Tn.return}if(s0===null)throw Error(Y(160));Mf(Pt,en,gt),s0=null,Cl=!1;var Hn=gt.alternate;Hn!==null&&(Hn.return=null),gt.return=null}catch(Ei){Bs(gt,Se,Ei)}}if(Se.subtreeFlags&12854)for(Se=Se.child;Se!==null;)Tf(Se,Ee),Se=Se.sibling}function Tf(Ee,Se){var Ge=Ee.alternate,nt=Ee.flags;switch(Ee.tag){case 0:case 11:case 14:case 15:if(xl(Se,Ee),Jl(Ee),nt&4){try{Lu(3,Ee,Ee.return),Jh(3,Ee)}catch(cs){Bs(Ee,Ee.return,cs)}try{Lu(5,Ee,Ee.return)}catch(cs){Bs(Ee,Ee.return,cs)}}break;case 1:xl(Se,Ee),Jl(Ee),nt&512&&Ge!==null&&Bu(Ge,Ge.return);break;case 5:if(xl(Se,Ee),Jl(Ee),nt&512&&Ge!==null&&Bu(Ge,Ge.return),Ee.flags&32){var gt=Ee.stateNode;try{Kt(gt,"")}catch(cs){Bs(Ee,Ee.return,cs)}}if(nt&4&&(gt=Ee.stateNode,gt!=null)){var Pt=Ee.memoizedProps,en=Ge!==null?Ge.memoizedProps:Pt,Tn=Ee.type,Hn=Ee.updateQueue;if(Ee.updateQueue=null,Hn!==null)try{Tn==="input"&&Pt.type==="radio"&&Pt.name!=null&&Rr(gt,Pt),ht(Tn,en);var Ei=ht(Tn,Pt);for(en=0;en<Hn.length;en+=2){var ur=Hn[en],pr=Hn[en+1];ur==="style"?an(gt,pr):ur==="dangerouslySetInnerHTML"?Bi(gt,pr):ur==="children"?Kt(gt,pr):Oe(gt,ur,pr,Ei)}switch(Tn){case"input":ir(gt,Pt);break;case"textarea":Ui(gt,Pt);break;case"select":var rr=gt._wrapperState.wasMultiple;gt._wrapperState.wasMultiple=!!Pt.multiple;var Hr=Pt.value;Hr!=null?rn(gt,!!Pt.multiple,Hr,!1):rr!==!!Pt.multiple&&(Pt.defaultValue!=null?rn(gt,!!Pt.multiple,Pt.defaultValue,!0):rn(gt,!!Pt.multiple,Pt.multiple?[]:"",!1))}gt[ia]=Pt}catch(cs){Bs(Ee,Ee.return,cs)}}break;case 6:if(xl(Se,Ee),Jl(Ee),nt&4){if(Ee.stateNode===null)throw Error(Y(162));gt=Ee.stateNode,Pt=Ee.memoizedProps;try{gt.nodeValue=Pt}catch(cs){Bs(Ee,Ee.return,cs)}}break;case 3:if(xl(Se,Ee),Jl(Ee),nt&4&&Ge!==null&&Ge.memoizedState.isDehydrated)try{H0(Se.containerInfo)}catch(cs){Bs(Ee,Ee.return,cs)}break;case 4:xl(Se,Ee),Jl(Ee);break;case 13:xl(Se,Ee),Jl(Ee),gt=Ee.child,gt.flags&8192&&(Pt=gt.memoizedState!==null,gt.stateNode.isHidden=Pt,!Pt||gt.alternate!==null&&gt.alternate.memoizedState!==null||(Pf=Dn())),nt&4&&bf(Ee);break;case 22:if(ur=Ge!==null&&Ge.memoizedState!==null,Ee.mode&1?(m0=(Ei=m0)||ur,xl(Se,Ee),m0=Ei):xl(Se,Ee),Jl(Ee),nt&8192){if(Ei=Ee.memoizedState!==null,(Ee.stateNode.isHidden=Ei)&&!ur&&Ee.mode&1)for(ts=Ee,ur=Ee.child;ur!==null;){for(pr=ts=ur;ts!==null;){switch(rr=ts,Hr=rr.child,rr.tag){case 0:case 11:case 14:case 15:Lu(4,rr,rr.return);break;case 1:Bu(rr,rr.return);var Zr=rr.stateNode;if(typeof Zr.componentWillUnmount=="function"){nt=rr,Ge=rr.return;try{Se=nt,Zr.props=Se.memoizedProps,Zr.state=Se.memoizedState,Zr.componentWillUnmount()}catch(cs){Bs(nt,Ge,cs)}}break;case 5:Bu(rr,rr.return);break;case 22:if(rr.memoizedState!==null){Bf(pr);continue}}Hr!==null?(Hr.return=rr,ts=Hr):Bf(pr)}ur=ur.sibling}e:for(ur=null,pr=Ee;;){if(pr.tag===5){if(ur===null){ur=pr;try{gt=pr.stateNode,Ei?(Pt=gt.style,typeof Pt.setProperty=="function"?Pt.setProperty("display","none","important"):Pt.display="none"):(Tn=pr.stateNode,Hn=pr.memoizedProps.style,en=Hn!=null&&Hn.hasOwnProperty("display")?Hn.display:null,Tn.style.display=on("display",en))}catch(cs){Bs(Ee,Ee.return,cs)}}}else if(pr.tag===6){if(ur===null)try{pr.stateNode.nodeValue=Ei?"":pr.memoizedProps}catch(cs){Bs(Ee,Ee.return,cs)}}else if((pr.tag!==22&&pr.tag!==23||pr.memoizedState===null||pr===Ee)&&pr.child!==null){pr.child.return=pr,pr=pr.child;continue}if(pr===Ee)break e;for(;pr.sibling===null;){if(pr.return===null||pr.return===Ee)break e;ur===pr&&(ur=null),pr=pr.return}ur===pr&&(ur=null),pr.sibling.return=pr.return,pr=pr.sibling}}break;case 19:xl(Se,Ee),Jl(Ee),nt&4&&bf(Ee);break;case 21:break;default:xl(Se,Ee),Jl(Ee)}}function Jl(Ee){var Se=Ee.flags;if(Se&2){try{e:{for(var Ge=Ee.return;Ge!==null;){if(wf(Ge)){var nt=Ge;break e}Ge=Ge.return}throw Error(Y(160))}switch(nt.tag){case 5:var gt=nt.stateNode;nt.flags&32&&(Kt(gt,""),nt.flags&=-33);var Pt=Sf(Ee);a1(Ee,Pt,gt);break;case 3:case 4:var en=nt.stateNode.containerInfo,Tn=Sf(Ee);o1(Ee,Tn,en);break;default:throw Error(Y(161))}}catch(Hn){Bs(Ee,Ee.return,Hn)}Ee.flags&=-3}Se&4096&&(Ee.flags&=-4097)}function dp(Ee,Se,Ge){ts=Ee,If(Ee)}function If(Ee,Se,Ge){for(var nt=(Ee.mode&1)!==0;ts!==null;){var gt=ts,Pt=gt.child;if(gt.tag===22&&nt){var en=gt.memoizedState!==null||qh;if(!en){var Tn=gt.alternate,Hn=Tn!==null&&Tn.memoizedState!==null||m0;Tn=qh;var Ei=m0;if(qh=en,(m0=Hn)&&!Ei)for(ts=gt;ts!==null;)en=ts,Hn=en.child,en.tag===22&&en.memoizedState!==null?fp(gt):Hn!==null?(Hn.return=en,ts=Hn):fp(gt);for(;Pt!==null;)ts=Pt,If(Pt),Pt=Pt.sibling;ts=gt,qh=Tn,m0=Ei}Rf(Ee)}else gt.subtreeFlags&8772&&Pt!==null?(Pt.return=gt,ts=Pt):Rf(Ee)}}function Rf(Ee){for(;ts!==null;){var Se=ts;if(Se.flags&8772){var Ge=Se.alternate;try{if(Se.flags&8772)switch(Se.tag){case 0:case 11:case 15:m0||Jh(5,Se);break;case 1:var nt=Se.stateNode;if(Se.flags&4&&!m0)if(Ge===null)nt.componentDidMount();else{var gt=Se.elementType===Se.type?Ge.memoizedProps:yl(Se.type,Ge.memoizedProps);nt.componentDidUpdate(gt,Ge.memoizedState,nt.__reactInternalSnapshotBeforeUpdate)}var Pt=Se.updateQueue;Pt!==null&&Gh(Se,Pt,nt);break;case 3:var en=Se.updateQueue;if(en!==null){if(Ge=null,Se.child!==null)switch(Se.child.tag){case 5:Ge=Se.child.stateNode;break;case 1:Ge=Se.child.stateNode}Gh(Se,en,Ge)}break;case 5:var Tn=Se.stateNode;if(Ge===null&&Se.flags&4){Ge=Tn;var Hn=Se.memoizedProps;switch(Se.type){case"button":case"input":case"select":case"textarea":Hn.autoFocus&&Ge.focus();break;case"img":Hn.src&&(Ge.src=Hn.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(Se.memoizedState===null){var Ei=Se.alternate;if(Ei!==null){var ur=Ei.memoizedState;if(ur!==null){var pr=ur.dehydrated;pr!==null&&H0(pr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}m0||Se.flags&512&&s1(Se)}catch(rr){Bs(Se,Se.return,rr)}}if(Se===Ee){ts=null;break}if(Ge=Se.sibling,Ge!==null){Ge.return=Se.return,ts=Ge;break}ts=Se.return}}function Bf(Ee){for(;ts!==null;){var Se=ts;if(Se===Ee){ts=null;break}var Ge=Se.sibling;if(Ge!==null){Ge.return=Se.return,ts=Ge;break}ts=Se.return}}function fp(Ee){for(;ts!==null;){var Se=ts;try{switch(Se.tag){case 0:case 11:case 15:var Ge=Se.return;try{Jh(4,Se)}catch(Hn){Bs(Se,Ge,Hn)}break;case 1:var nt=Se.stateNode;if(typeof nt.componentDidMount=="function"){var gt=Se.return;try{nt.componentDidMount()}catch(Hn){Bs(Se,gt,Hn)}}var Pt=Se.return;try{s1(Se)}catch(Hn){Bs(Se,Pt,Hn)}break;case 5:var en=Se.return;try{s1(Se)}catch(Hn){Bs(Se,en,Hn)}}}catch(Hn){Bs(Se,Se.return,Hn)}if(Se===Ee){ts=null;break}var Tn=Se.sibling;if(Tn!==null){Tn.return=Se.return,ts=Tn;break}ts=Se.return}}var Gp=Math.ceil,l1=Ne.ReactCurrentDispatcher,Lf=Ne.ReactCurrentOwner,rl=Ne.ReactCurrentBatchConfig,xo=0,Za=null,Ga=null,g0=0,sl=0,ih=W0(0),ja=0,Zh=null,Du=0,c1=0,Df=0,ru=null,Y0=null,Pf=0,rh=1/0,Nc=null,u1=!1,Ff=null,Uc=null,jh=!1,su=null,Zl=0,ed=0,h1=null,nd=-1,d1=0;function v0(){return xo&6?Dn():nd!==-1?nd:nd=Dn()}function e0(Ee){return Ee.mode&1?xo&2&&g0!==0?g0&-g0:Nh.transition!==null?(d1===0&&(d1=zt()),d1):(Ee=xi,Ee!==0||(Ee=window.event,Ee=Ee===void 0?16:lo(Ee.type)),Ee):1}function wl(Ee,Se,Ge,nt){if(50<ed)throw ed=0,h1=null,Error(Y(185));mn(Ee,Ge,nt),(!(xo&2)||Ee!==Za)&&(Ee===Za&&(!(xo&2)&&(c1|=Ge),ja===4&&kc(Ee,g0)),vs(Ee,nt),Ge===1&&xo===0&&!(Se.mode&1)&&(rh=Dn()+500,uo&&h0()))}function vs(Ee,Se){var Ge=Ee.callbackNode;It(Ee,Se);var nt=bs(Ee,Ee===Za?g0:0);if(nt===0)Ge!==null&&Jt(Ge),Ee.callbackNode=null,Ee.callbackPriority=0;else if(Se=nt&-nt,Ee.callbackPriority!==Se){if(Ge!=null&&Jt(Ge),Se===1)Ee.tag===0?Qd(Of.bind(null,Ee)):Hl(Of.bind(null,Ee)),qc(function(){!(xo&6)&&h0()}),Ge=null;else{switch(zi(nt)){case 1:Ge=gi;break;case 4:Ge=Wi;break;case 16:Ge=Li;break;case 536870912:Ge=yr;break;default:Ge=Li}Ge=pp(Ge,Or.bind(null,Ee))}Ee.callbackPriority=Se,Ee.callbackNode=Ge}}function Or(Ee,Se){if(nd=-1,d1=0,xo&6)throw Error(Y(327));var Ge=Ee.callbackNode;if(ii()&&Ee.callbackNode!==Ge)return null;var nt=bs(Ee,Ee===Za?g0:0);if(nt===0)return null;if(nt&30||nt&Ee.expiredLanes||Se)Se=oh(Ee,nt);else{Se=nt;var gt=xo;xo|=2;var Pt=sh();(Za!==Ee||g0!==Se)&&(Nc=null,rh=Dn()+500,au(Ee,Se));do try{id();break}catch(Tn){Nf(Ee,Tn)}while(!0);p0(),l1.current=Pt,xo=gt,Ga!==null?Se=0:(Za=null,g0=0,Se=ja)}if(Se!==0){if(Se===2&&(gt=Ot(Ee),gt!==0&&(nt=gt,Se=I0(Ee,gt))),Se===1)throw Ge=Zh,au(Ee,0),kc(Ee,nt),vs(Ee,Dn()),Ge;if(Se===6)kc(Ee,nt);else{if(gt=Ee.current.alternate,!(nt&30)&&!ou(gt)&&(Se=oh(Ee,nt),Se===2&&(Pt=Ot(Ee),Pt!==0&&(nt=Pt,Se=I0(Ee,Pt))),Se===1))throw Ge=Zh,au(Ee,0),kc(Ee,nt),vs(Ee,Dn()),Ge;switch(Ee.finishedWork=gt,Ee.finishedLanes=nt,Se){case 0:case 1:throw Error(Y(345));case 2:Sc(Ee,Y0,Nc);break;case 3:if(kc(Ee,nt),(nt&130023424)===nt&&(Se=Pf+500-Dn(),10<Se)){if(bs(Ee,0)!==0)break;if(gt=Ee.suspendedLanes,(gt&nt)!==nt){v0(),Ee.pingedLanes|=Ee.suspendedLanes&gt;break}Ee.timeoutHandle=la(Sc.bind(null,Ee,Y0,Nc),Se);break}Sc(Ee,Y0,Nc);break;case 4:if(kc(Ee,nt),(nt&4194240)===nt)break;for(Se=Ee.eventTimes,gt=-1;0<nt;){var en=31-er(nt);Pt=1<<en,en=Se[en],en>gt&&(gt=en),nt&=~Pt}if(nt=gt,nt=Dn()-nt,nt=(120>nt?120:480>nt?480:1080>nt?1080:1920>nt?1920:3e3>nt?3e3:4320>nt?4320:1960*Gp(nt/1960))-nt,10<nt){Ee.timeoutHandle=la(Sc.bind(null,Ee,Y0,Nc),nt);break}Sc(Ee,Y0,Nc);break;case 5:Sc(Ee,Y0,Nc);break;default:throw Error(Y(329))}}}return vs(Ee,Dn()),Ee.callbackNode===Ge?Or.bind(null,Ee):null}function I0(Ee,Se){var Ge=ru;return Ee.current.memoizedState.isDehydrated&&(au(Ee,Se).flags|=256),Ee=oh(Ee,Se),Ee!==2&&(Se=Y0,Y0=Ge,Se!==null&&Pu(Se)),Ee}function Pu(Ee){Y0===null?Y0=Ee:Y0.push.apply(Y0,Ee)}function ou(Ee){for(var Se=Ee;;){if(Se.flags&16384){var Ge=Se.updateQueue;if(Ge!==null&&(Ge=Ge.stores,Ge!==null))for(var nt=0;nt<Ge.length;nt++){var gt=Ge[nt],Pt=gt.getSnapshot;gt=gt.value;try{if(!gs(Pt(),gt))return!1}catch{return!1}}}if(Ge=Se.child,Se.subtreeFlags&16384&&Ge!==null)Ge.return=Se,Se=Ge;else{if(Se===Ee)break;for(;Se.sibling===null;){if(Se.return===null||Se.return===Ee)return!0;Se=Se.return}Se.sibling.return=Se.return,Se=Se.sibling}}return!0}function kc(Ee,Se){for(Se&=~Df,Se&=~c1,Ee.suspendedLanes|=Se,Ee.pingedLanes&=~Se,Ee=Ee.expirationTimes;0<Se;){var Ge=31-er(Se),nt=1<<Ge;Ee[Ge]=-1,Se&=~nt}}function Of(Ee){if(xo&6)throw Error(Y(327));ii();var Se=bs(Ee,0);if(!(Se&1))return vs(Ee,Dn()),null;var Ge=oh(Ee,Se);if(Ee.tag!==0&&Ge===2){var nt=Ot(Ee);nt!==0&&(Se=nt,Ge=I0(Ee,nt))}if(Ge===1)throw Ge=Zh,au(Ee,0),kc(Ee,Se),vs(Ee,Dn()),Ge;if(Ge===6)throw Error(Y(345));return Ee.finishedWork=Ee.current.alternate,Ee.finishedLanes=Se,Sc(Ee,Y0,Nc),vs(Ee,Dn()),null}function f1(Ee,Se){var Ge=xo;xo|=1;try{return Ee(Se)}finally{xo=Ge,xo===0&&(rh=Dn()+500,uo&&h0())}}function wc(Ee){su!==null&&su.tag===0&&!(xo&6)&&ii();var Se=xo;xo|=1;var Ge=rl.transition,nt=xi;try{if(rl.transition=null,xi=1,Ee)return Ee()}finally{xi=nt,rl.transition=Ge,xo=Se,!(xo&6)&&h0()}}function p1(){sl=ih.current,Xo(ih)}function au(Ee,Se){Ee.finishedWork=null,Ee.finishedLanes=0;var Ge=Ee.timeoutHandle;if(Ge!==-1&&(Ee.timeoutHandle=-1,el(Ge)),Ga!==null)for(Ge=Ga.return;Ge!==null;){var nt=Ge;switch(Oa(nt),nt.tag){case 1:nt=nt.type.childContextTypes,nt!=null&&eu();break;case 3:il(),Xo(Ka),Xo(va),Hh();break;case 5:r0(nt);break;case 4:il();break;case 13:Xo(sa);break;case 19:Xo(sa);break;case 10:Wl(nt.type._context);break;case 22:case 23:p1()}Ge=Ge.return}if(Za=Ee,Ga=Ee=Sl(Ee.current,null),g0=sl=Se,ja=0,Zh=null,Df=c1=Du=0,Y0=ru=null,N0!==null){for(Se=0;Se<N0.length;Se++)if(Ge=N0[Se],nt=Ge.interleaved,nt!==null){Ge.interleaved=null;var gt=nt.next,Pt=Ge.pending;if(Pt!==null){var en=Pt.next;Pt.next=gt,nt.next=en}Ge.pending=nt}N0=null}return Ee}function Nf(Ee,Se){do{var Ge=Ga;try{if(p0(),Pc.current=$h,jo){for(var nt=Ro.memoizedState;nt!==null;){var gt=nt.queue;gt!==null&&(gt.pending=null),nt=nt.next}jo=!1}if(Kl=0,Ma=Ks=Ro=null,b0=!1,Yl=0,Lf.current=null,Ge===null||Ge.return===null){ja=1,Zh=Se,Ga=null;break}e:{var Pt=Ee,en=Ge.return,Tn=Ge,Hn=Se;if(Se=g0,Tn.flags|=32768,Hn!==null&&typeof Hn=="object"&&typeof Hn.then=="function"){var Ei=Hn,ur=Tn,pr=ur.tag;if(!(ur.mode&1)&&(pr===0||pr===11||pr===15)){var rr=ur.alternate;rr?(ur.updateQueue=rr.updateQueue,ur.memoizedState=rr.memoizedState,ur.lanes=rr.lanes):(ur.updateQueue=null,ur.memoizedState=null)}var Hr=hf(en);if(Hr!==null){Hr.flags&=-257,df(Hr,en,Tn,Pt,Se),Hr.mode&1&&uf(Pt,Ei,Se),Se=Hr,Hn=Ei;var Zr=Se.updateQueue;if(Zr===null){var cs=new Set;cs.add(Hn),Se.updateQueue=cs}else Zr.add(Hn);break e}else{if(!(Se&1)){uf(Pt,Ei,Se),jl();break e}Hn=Error(Y(426))}}else if(Io&&Tn.mode&1){var ua=hf(en);if(ua!==null){!(ua.flags&65536)&&(ua.flags|=256),df(ua,en,Tn,Pt,Se),Zu(Tu(Hn,Tn));break e}}Pt=Hn=Tu(Hn,Tn),ja!==4&&(ja=2),ru===null?ru=[Pt]:ru.push(Pt),Pt=en;do{switch(Pt.tag){case 3:Pt.flags|=65536,Se&=-Se,Pt.lanes|=Se;var li=lf(Pt,Hn,Se);ju(Pt,li);break e;case 1:Tn=Hn;var $n=Pt.type,ui=Pt.stateNode;if(!(Pt.flags&128)&&(typeof $n.getDerivedStateFromError=="function"||ui!==null&&typeof ui.componentDidCatch=="function"&&(Uc===null||!Uc.has(ui)))){Pt.flags|=65536,Se&=-Se,Pt.lanes|=Se;var dr=cf(Pt,Tn,Se);ju(Pt,dr);break e}}Pt=Pt.return}while(Pt!==null)}ah(Ge)}catch(ls){Se=ls,Ga===Ge&&Ge!==null&&(Ga=Ge=Ge.return);continue}break}while(!0)}function sh(){var Ee=l1.current;return l1.current=$h,Ee===null?$h:Ee}function jl(){(ja===0||ja===3||ja===2)&&(ja=4),Za===null||!(Du&268435455)&&!(c1&268435455)||kc(Za,g0)}function oh(Ee,Se){var Ge=xo;xo|=2;var nt=sh();(Za!==Ee||g0!==Se)&&(Nc=null,au(Ee,Se));do try{tc();break}catch(gt){Nf(Ee,gt)}while(!0);if(p0(),xo=Ge,l1.current=nt,Ga!==null)throw Error(Y(261));return Za=null,g0=0,ja}function tc(){for(;Ga!==null;)A1(Ga)}function id(){for(;Ga!==null&&!xn();)A1(Ga)}function A1(Ee){var Se=lh(Ee.alternate,Ee,sl);Ee.memoizedProps=Ee.pendingProps,Se===null?ah(Ee):Ga=Se,Lf.current=null}function ah(Ee){var Se=Ee;do{var Ge=Se.alternate;if(Ee=Se.return,Se.flags&32768){if(Ge=cp(Ge,Se),Ge!==null){Ge.flags&=32767,Ga=Ge;return}if(Ee!==null)Ee.flags|=32768,Ee.subtreeFlags=0,Ee.deletions=null;else{ja=6,Ga=null;return}}else if(Ge=lp(Ge,Se,sl),Ge!==null){Ga=Ge;return}if(Se=Se.sibling,Se!==null){Ga=Se;return}Ga=Se=Ee}while(Se!==null);ja===0&&(ja=5)}function Sc(Ee,Se,Ge){var nt=xi,gt=rl.transition;try{rl.transition=null,xi=1,o0(Ee,Se,Ge,nt)}finally{rl.transition=gt,xi=nt}return null}function o0(Ee,Se,Ge,nt){do ii();while(su!==null);if(xo&6)throw Error(Y(327));Ge=Ee.finishedWork;var gt=Ee.finishedLanes;if(Ge===null)return null;if(Ee.finishedWork=null,Ee.finishedLanes=0,Ge===Ee.current)throw Error(Y(177));Ee.callbackNode=null,Ee.callbackPriority=0;var Pt=Ge.lanes|Ge.childLanes;if(kn(Ee,Pt),Ee===Za&&(Ga=Za=null,g0=0),!(Ge.subtreeFlags&2064)&&!(Ge.flags&2064)||jh||(jh=!0,pp(Li,function(){return ii(),null})),Pt=(Ge.flags&15990)!==0,Ge.subtreeFlags&15990||Pt){Pt=rl.transition,rl.transition=null;var en=xi;xi=1;var Tn=xo;xo|=4,Lf.current=null,hp(Ee,Ge),Tf(Ge,Ee),uc(hl),Z0=!!ul,hl=ul=null,Ee.current=Ge,dp(Ge),Vn(),xo=Tn,xi=en,rl.transition=Pt}else Ee.current=Ge;if(jh&&(jh=!1,su=Ee,Zl=gt),Pt=Ee.pendingLanes,Pt===0&&(Uc=null),hs(Ge.stateNode),vs(Ee,Dn()),Se!==null)for(nt=Ee.onRecoverableError,Ge=0;Ge<Se.length;Ge++)gt=Se[Ge],nt(gt.value,{componentStack:gt.stack,digest:gt.digest});if(u1)throw u1=!1,Ee=Ff,Ff=null,Ee;return Zl&1&&Ee.tag!==0&&ii(),Pt=Ee.pendingLanes,Pt&1?Ee===h1?ed++:(ed=0,h1=Ee):ed=0,h0(),null}function ii(){if(su!==null){var Ee=zi(Zl),Se=rl.transition,Ge=xi;try{if(rl.transition=null,xi=16>Ee?16:Ee,su===null)var nt=!1;else{if(Ee=su,su=null,Zl=0,xo&6)throw Error(Y(331));var gt=xo;for(xo|=4,ts=Ee.current;ts!==null;){var Pt=ts,en=Pt.child;if(ts.flags&16){var Tn=Pt.deletions;if(Tn!==null){for(var Hn=0;Hn<Tn.length;Hn++){var Ei=Tn[Hn];for(ts=Ei;ts!==null;){var ur=ts;switch(ur.tag){case 0:case 11:case 15:Lu(8,ur,Pt)}var pr=ur.child;if(pr!==null)pr.return=ur,ts=pr;else for(;ts!==null;){ur=ts;var rr=ur.sibling,Hr=ur.return;if(xf(ur),ur===Ei){ts=null;break}if(rr!==null){rr.return=Hr,ts=rr;break}ts=Hr}}}var Zr=Pt.alternate;if(Zr!==null){var cs=Zr.child;if(cs!==null){Zr.child=null;do{var ua=cs.sibling;cs.sibling=null,cs=ua}while(cs!==null)}}ts=Pt}}if(Pt.subtreeFlags&2064&&en!==null)en.return=Pt,ts=en;else e:for(;ts!==null;){if(Pt=ts,Pt.flags&2048)switch(Pt.tag){case 0:case 11:case 15:Lu(9,Pt,Pt.return)}var li=Pt.sibling;if(li!==null){li.return=Pt.return,ts=li;break e}ts=Pt.return}}var $n=Ee.current;for(ts=$n;ts!==null;){en=ts;var ui=en.child;if(en.subtreeFlags&2064&&ui!==null)ui.return=en,ts=ui;else e:for(en=$n;ts!==null;){if(Tn=ts,Tn.flags&2048)try{switch(Tn.tag){case 0:case 11:case 15:Jh(9,Tn)}}catch(ls){Bs(Tn,Tn.return,ls)}if(Tn===en){ts=null;break e}var dr=Tn.sibling;if(dr!==null){dr.return=Tn.return,ts=dr;break e}ts=Tn.return}}if(xo=gt,h0(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(Sr,Ee)}catch{}nt=!0}return nt}finally{xi=Ge,rl.transition=Se}}return!1}function Bo(Ee,Se,Ge){Se=Tu(Ge,Se),Se=lf(Ee,Se,1),Ee=gl(Ee,Se,1),Se=v0(),Ee!==null&&(mn(Ee,1,Se),vs(Ee,Se))}function Bs(Ee,Se,Ge){if(Ee.tag===3)Bo(Ee,Ee,Ge);else for(;Se!==null;){if(Se.tag===3){Bo(Se,Ee,Ge);break}else if(Se.tag===1){var nt=Se.stateNode;if(typeof Se.type.getDerivedStateFromError=="function"||typeof nt.componentDidCatch=="function"&&(Uc===null||!Uc.has(nt))){Ee=Tu(Ge,Ee),Ee=cf(Se,Ee,1),Se=gl(Se,Ee,1),Ee=v0(),Se!==null&&(mn(Se,1,Ee),vs(Se,Ee));break}}Se=Se.return}}function nc(Ee,Se,Ge){var nt=Ee.pingCache;nt!==null&&nt.delete(Se),Se=v0(),Ee.pingedLanes|=Ee.suspendedLanes&Ge,Za===Ee&&(g0&Ge)===Ge&&(ja===4||ja===3&&(g0&130023424)===g0&&500>Dn()-Pf?au(Ee,0):Df|=Ge),vs(Ee,Se)}function Ko(Ee,Se){Se===0&&(Ee.mode&1?(Se=Er,Er<<=1,!(Er&130023424)&&(Er=4194304)):Se=1);var Ge=v0();Ee=U0(Ee,Se),Ee!==null&&(mn(Ee,Se,Ge),vs(Ee,Ge))}function Qp(Ee){var Se=Ee.memoizedState,Ge=0;Se!==null&&(Ge=Se.retryLane),Ko(Ee,Ge)}function m1(Ee,Se){var Ge=0;switch(Ee.tag){case 13:var nt=Ee.stateNode,gt=Ee.memoizedState;gt!==null&&(Ge=gt.retryLane);break;case 19:nt=Ee.stateNode;break;default:throw Error(Y(314))}nt!==null&&nt.delete(Se),Ko(Ee,Ge)}var lh;lh=function(Ee,Se,Ge){if(Ee!==null)if(Ee.memoizedProps!==Se.pendingProps||Ka.current)G0=!0;else{if(!(Ee.lanes&Ge)&&!(Se.flags&128))return G0=!1,ap(Ee,Se,Ge);G0=!!(Ee.flags&131072)}else G0=!1,Io&&Se.flags&1048576&&Oh(Se,Eu,Se.index);switch(Se.lanes=0,Se.tag){case 2:var nt=Se.type;Ru(Ee,Se),Ee=Se.pendingProps;var gt=mc(Se,va.current);Ds(Se,Ge),gt=Su(null,Se,nt,Ee,gt,Ge);var Pt=zh();return Se.flags|=1,typeof gt=="object"&&gt!==null&&typeof gt.render=="function"&&gt.$$typeof===void 0?(Se.tag=1,Se.memoizedState=null,Se.updateQueue=null,M0(nt)?(Pt=!0,qu(Se)):Pt=!1,Se.memoizedState=gt.state!==null&&gt.state!==void 0?gt.state:null,$l(Se),gt.updater=Xh,Se.stateNode=gt,gt._reactInternals=Se,Kd(Se,nt,Ee,Ge),Se=Iu(null,Se,nt,!0,Pt,Ge)):(Se.tag=0,Io&&Pt&&Wr(Se),T0(null,Se,gt,Ge),Se=Se.child),Se;case 16:nt=Se.elementType;e:{switch(Ru(Ee,Se),Ee=Se.pendingProps,gt=nt._init,nt=gt(nt._payload),Se.type=nt,gt=Se.tag=g1(nt),Ee=yl(nt,Ee),gt){case 0:Se=qs(null,Se,nt,Ee,Ge);break e;case 1:Se=gf(null,Se,nt,Ee,Ge);break e;case 11:Se=ff(null,Se,nt,Ee,Ge);break e;case 14:Se=pf(null,Se,nt,yl(nt.type,Ee),Ge);break e}throw Error(Y(306,nt,""))}return Se;case 0:return nt=Se.type,gt=Se.pendingProps,gt=Se.elementType===nt?gt:yl(nt,gt),qs(Ee,Se,nt,gt,Ge);case 1:return nt=Se.type,gt=Se.pendingProps,gt=Se.elementType===nt?gt:yl(nt,gt),gf(Ee,Se,nt,gt,Ge);case 3:e:{if(Zd(Se),Ee===null)throw Error(Y(387));nt=Se.pendingProps,Pt=Se.memoizedState,gt=Pt.element,kh(Ee,Se),Ec(Se,nt,null,Ge);var en=Se.memoizedState;if(nt=en.element,Pt.isDehydrated)if(Pt={element:nt,isDehydrated:!1,cache:en.cache,pendingSuspenseBoundaries:en.pendingSuspenseBoundaries,transitions:en.transitions},Se.updateQueue.baseState=Pt,Se.memoizedState=Pt,Se.flags&256){gt=Tu(Error(Y(423)),Se),Se=jd(Ee,Se,nt,Ge,gt);break e}else if(nt!==gt){gt=Tu(Error(Y(424)),Se),Se=jd(Ee,Se,nt,Ge,gt);break e}else for(Oo=z0(Se.stateNode.containerInfo.firstChild),Na=Se,Io=!0,Ua=null,Ge=$i(Se,null,nt,Ge),Se.child=Ge;Ge;)Ge.flags=Ge.flags&-3|4096,Ge=Ge.sibling;else{if(_u(),nt===gt){Se=Q0(Ee,Se,Ge);break e}T0(Ee,Se,nt,Ge)}Se=Se.child}return Se;case 5:return nu(Se),Ee===null&&Hd(Se),nt=Se.type,gt=Se.pendingProps,Pt=Ee!==null?Ee.memoizedProps:null,en=gt.children,pc(nt,gt)?en=null:Pt!==null&&pc(nt,Pt)&&(Se.flags|=32),Ys(Ee,Se),T0(Ee,Se,en,Ge),Se.child;case 6:return Ee===null&&Hd(Se),null;case 13:return K0(Ee,Se,Ge);case 4:return yc(Se,Se.stateNode.containerInfo),nt=Se.pendingProps,Ee===null?Se.child=ra(Se,null,nt,Ge):T0(Ee,Se,nt,Ge),Se.child;case 11:return nt=Se.type,gt=Se.pendingProps,gt=Se.elementType===nt?gt:yl(nt,gt),ff(Ee,Se,nt,gt,Ge);case 7:return T0(Ee,Se,Se.pendingProps,Ge),Se.child;case 8:return T0(Ee,Se,Se.pendingProps.children,Ge),Se.child;case 12:return T0(Ee,Se,Se.pendingProps.children,Ge),Se.child;case 10:e:{if(nt=Se.type._context,gt=Se.pendingProps,Pt=Se.memoizedProps,en=gt.value,Co(Mr,nt._currentValue),nt._currentValue=en,Pt!==null)if(gs(Pt.value,en)){if(Pt.children===gt.children&&!Ka.current){Se=Q0(Ee,Se,Ge);break e}}else for(Pt=Se.child,Pt!==null&&(Pt.return=Se);Pt!==null;){var Tn=Pt.dependencies;if(Tn!==null){en=Pt.child;for(var Hn=Tn.firstContext;Hn!==null;){if(Hn.context===nt){if(Pt.tag===1){Hn=nl(-1,Ge&-Ge),Hn.tag=2;var Ei=Pt.updateQueue;if(Ei!==null){Ei=Ei.shared;var ur=Ei.pending;ur===null?Hn.next=Hn:(Hn.next=ur.next,ur.next=Hn),Ei.pending=Hn}}Pt.lanes|=Ge,Hn=Pt.alternate,Hn!==null&&(Hn.lanes|=Ge),Sa(Pt.return,Ge,Se),Tn.lanes|=Ge;break}Hn=Hn.next}}else if(Pt.tag===10)en=Pt.type===Se.type?null:Pt.child;else if(Pt.tag===18){if(en=Pt.return,en===null)throw Error(Y(341));en.lanes|=Ge,Tn=en.alternate,Tn!==null&&(Tn.lanes|=Ge),Sa(en,Ge,Se),en=Pt.sibling}else en=Pt.child;if(en!==null)en.return=Pt;else for(en=Pt;en!==null;){if(en===Se){en=null;break}if(Pt=en.sibling,Pt!==null){Pt.return=en.return,en=Pt;break}en=en.return}Pt=en}T0(Ee,Se,gt.children,Ge),Se=Se.child}return Se;case 9:return gt=Se.type,nt=Se.pendingProps.children,Ds(Se,Ge),gt=$0(gt),nt=nt(gt),Se.flags|=1,T0(Ee,Se,nt,Ge),Se.child;case 14:return nt=Se.type,gt=yl(nt,Se.pendingProps),gt=yl(nt.type,gt),pf(Ee,Se,nt,gt,Ge);case 15:return Af(Ee,Se,Se.type,Se.pendingProps,Ge);case 17:return nt=Se.type,gt=Se.pendingProps,gt=Se.elementType===nt?gt:yl(nt,gt),Ru(Ee,Se),Se.tag=1,M0(nt)?(Ee=!0,qu(Se)):Ee=!1,Ds(Se,Ge),of(Se,nt,gt),Kd(Se,nt,gt,Ge),Iu(null,Se,nt,!0,Ee,Ge);case 19:return n1(Ee,Se,Ge);case 22:return mf(Ee,Se,Ge)}throw Error(Y(156,Se.tag))};function pp(Ee,Se){return $t(Ee,Se)}function Ap(Ee,Se,Ge,nt){this.tag=Ee,this.key=Ge,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Se,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=nt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function E0(Ee,Se,Ge,nt){return new Ap(Ee,Se,Ge,nt)}function Gc(Ee){return Ee=Ee.prototype,!(!Ee||!Ee.isReactComponent)}function g1(Ee){if(typeof Ee=="function")return Gc(Ee)?1:0;if(Ee!=null){if(Ee=Ee.$$typeof,Ee===ft)return 11;if(Ee===Gt)return 14}return 2}function Sl(Ee,Se){var Ge=Ee.alternate;return Ge===null?(Ge=E0(Ee.tag,Se,Ee.key,Ee.mode),Ge.elementType=Ee.elementType,Ge.type=Ee.type,Ge.stateNode=Ee.stateNode,Ge.alternate=Ee,Ee.alternate=Ge):(Ge.pendingProps=Se,Ge.type=Ee.type,Ge.flags=0,Ge.subtreeFlags=0,Ge.deletions=null),Ge.flags=Ee.flags&14680064,Ge.childLanes=Ee.childLanes,Ge.lanes=Ee.lanes,Ge.child=Ee.child,Ge.memoizedProps=Ee.memoizedProps,Ge.memoizedState=Ee.memoizedState,Ge.updateQueue=Ee.updateQueue,Se=Ee.dependencies,Ge.dependencies=Se===null?null:{lanes:Se.lanes,firstContext:Se.firstContext},Ge.sibling=Ee.sibling,Ge.index=Ee.index,Ge.ref=Ee.ref,Ge}function rd(Ee,Se,Ge,nt,gt,Pt){var en=2;if(nt=Ee,typeof Ee=="function")Gc(Ee)&&(en=1);else if(typeof Ee=="string")en=5;else e:switch(Ee){case Xe:return lu(Ge.children,gt,Pt,Se);case $e:en=8,gt|=8;break;case st:return Ee=E0(12,Ge,Se,gt|2),Ee.elementType=st,Ee.lanes=Pt,Ee;case Rt:return Ee=E0(13,Ge,Se,gt),Ee.elementType=Rt,Ee.lanes=Pt,Ee;case Mt:return Ee=E0(19,Ge,Se,gt),Ee.elementType=Mt,Ee.lanes=Pt,Ee;case Bt:return sd(Ge,gt,Pt,Se);default:if(typeof Ee=="object"&&Ee!==null)switch(Ee.$$typeof){case ze:en=10;break e;case tt:en=9;break e;case ft:en=11;break e;case Gt:en=14;break e;case _t:en=16,nt=null;break e}throw Error(Y(130,Ee==null?Ee:typeof Ee,""))}return Se=E0(en,Ge,Se,gt),Se.elementType=Ee,Se.type=nt,Se.lanes=Pt,Se}function lu(Ee,Se,Ge,nt){return Ee=E0(7,Ee,nt,Se),Ee.lanes=Ge,Ee}function sd(Ee,Se,Ge,nt){return Ee=E0(22,Ee,nt,Se),Ee.elementType=Bt,Ee.lanes=Ge,Ee.stateNode={isHidden:!1},Ee}function v1(Ee,Se,Ge){return Ee=E0(6,Ee,null,Se),Ee.lanes=Ge,Ee}function E1(Ee,Se,Ge){return Se=E0(4,Ee.children!==null?Ee.children:[],Ee.key,Se),Se.lanes=Ge,Se.stateNode={containerInfo:Ee.containerInfo,pendingChildren:null,implementation:Ee.implementation},Se}function mp(Ee,Se,Ge,nt,gt){this.tag=Se,this.containerInfo=Ee,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jt(0),this.expirationTimes=jt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jt(0),this.identifierPrefix=nt,this.onRecoverableError=gt,this.mutableSourceEagerHydrationData=null}function ch(Ee,Se,Ge,nt,gt,Pt,en,Tn,Hn){return Ee=new mp(Ee,Se,Ge,Tn,Hn),Se===1?(Se=1,Pt===!0&&(Se|=8)):Se=0,Pt=E0(3,null,null,Se),Ee.current=Pt,Pt.stateNode=Ee,Pt.memoizedState={element:nt,isDehydrated:Ge,cache:null,transitions:null,pendingSuspenseBoundaries:null},$l(Pt),Ee}function Uf(Ee,Se,Ge){var nt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ve,key:nt==null?null:""+nt,children:Ee,containerInfo:Se,implementation:Ge}}function _1(Ee){if(!Ee)return i0;Ee=Ee._reactInternals;e:{if(Ts(Ee)!==Ee||Ee.tag!==1)throw Error(Y(170));var Se=Ee;do{switch(Se.tag){case 3:Se=Se.stateNode.context;break e;case 1:if(M0(Se.type)){Se=Se.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Se=Se.return}while(Se!==null);throw Error(Y(171))}if(Ee.tag===1){var Ge=Ee.type;if(M0(Ge))return Gd(Ee,Ge,Se)}return Se}function y1(Ee,Se,Ge,nt,gt,Pt,en,Tn,Hn){return Ee=ch(Ge,nt,!0,Ee,gt,Pt,en,Tn,Hn),Ee.context=_1(null),Ge=Ee.current,nt=v0(),gt=e0(Ge),Pt=nl(nt,gt),Pt.callback=Se??null,gl(Ge,Pt,gt),Ee.current.lanes=gt,mn(Ee,gt,nt),vs(Ee,nt),Ee}function uh(Ee,Se,Ge,nt){var gt=Se.current,Pt=v0(),en=e0(gt);return Ge=_1(Ge),Se.context===null?Se.context=Ge:Se.pendingContext=Ge,Se=nl(Pt,en),Se.payload={element:Ee},nt=nt===void 0?null:nt,nt!==null&&(Se.callback=nt),Ee=gl(gt,Se,en),Ee!==null&&(wl(Ee,gt,en,Pt),Ja(Ee,gt,en)),en}function hh(Ee){if(Ee=Ee.current,!Ee.child)return null;switch(Ee.child.tag){case 5:return Ee.child.stateNode;default:return Ee.child.stateNode}}function C1(Ee,Se){if(Ee=Ee.memoizedState,Ee!==null&&Ee.dehydrated!==null){var Ge=Ee.retryLane;Ee.retryLane=Ge!==0&&Ge<Se?Ge:Se}}function od(Ee,Se){C1(Ee,Se),(Ee=Ee.alternate)&&C1(Ee,Se)}var x1=typeof reportError=="function"?reportError:function(Ee){console.error(Ee)};function ad(Ee){this._internalRoot=Ee}dh.prototype.render=ad.prototype.render=function(Ee){var Se=this._internalRoot;if(Se===null)throw Error(Y(409));uh(Ee,Se,null,null)},dh.prototype.unmount=ad.prototype.unmount=function(){var Ee=this._internalRoot;if(Ee!==null){this._internalRoot=null;var Se=Ee.containerInfo;wc(function(){uh(null,Ee,null,null)}),Se[Eo]=null}};function dh(Ee){this._internalRoot=Ee}dh.prototype.unstable_scheduleHydration=function(Ee){if(Ee){var Se=Gr();Ee={blockedOn:null,target:Ee,priority:Se};for(var Ge=0;Ge<mo.length&&Se!==0&&Se<mo[Ge].priority;Ge++);mo.splice(Ge,0,Ee),Ge===0&&na(Ee)}};function Qc(Ee){return!(!Ee||Ee.nodeType!==1&&Ee.nodeType!==9&&Ee.nodeType!==11)}function ca(Ee){return!(!Ee||Ee.nodeType!==1&&Ee.nodeType!==9&&Ee.nodeType!==11&&(Ee.nodeType!==8||Ee.nodeValue!==" react-mount-point-unstable "))}function Ta(){}function ld(Ee,Se,Ge,nt,gt){if(gt){if(typeof nt=="function"){var Pt=nt;nt=function(){var Ei=hh(en);Pt.call(Ei)}}var en=y1(Se,nt,Ee,0,null,!1,!1,"",Ta);return Ee._reactRootContainer=en,Ee[Eo]=en.current,F0(Ee.nodeType===8?Ee.parentNode:Ee),wc(),en}for(;gt=Ee.lastChild;)Ee.removeChild(gt);if(typeof nt=="function"){var Tn=nt;nt=function(){var Ei=hh(Hn);Tn.call(Ei)}}var Hn=ch(Ee,0,!1,null,null,!1,!1,"",Ta);return Ee._reactRootContainer=Hn,Ee[Eo]=Hn.current,F0(Ee.nodeType===8?Ee.parentNode:Ee),wc(function(){uh(Se,Hn,Ge,nt)}),Hn}function cd(Ee,Se,Ge,nt,gt){var Pt=Ge._reactRootContainer;if(Pt){var en=Pt;if(typeof gt=="function"){var Tn=gt;gt=function(){var Hn=hh(en);Tn.call(Hn)}}uh(Se,en,Ee,gt)}else en=ld(Ge,Se,Ee,gt,nt);return hh(en)}ti=function(Ee){switch(Ee.tag){case 3:var Se=Ee.stateNode;if(Se.current.memoizedState.isDehydrated){var Ge=Ss(Se.pendingLanes);Ge!==0&&(Yn(Se,Ge|1),vs(Se,Dn()),!(xo&6)&&(rh=Dn()+500,h0()))}break;case 13:wc(function(){var nt=U0(Ee,1);if(nt!==null){var gt=v0();wl(nt,Ee,1,gt)}}),od(Ee,1)}},bi=function(Ee){if(Ee.tag===13){var Se=U0(Ee,134217728);if(Se!==null){var Ge=v0();wl(Se,Ee,134217728,Ge)}od(Ee,134217728)}},cr=function(Ee){if(Ee.tag===13){var Se=e0(Ee),Ge=U0(Ee,Se);if(Ge!==null){var nt=v0();wl(Ge,Ee,Se,nt)}od(Ee,Se)}},Gr=function(){return xi},Ki=function(Ee,Se){var Ge=xi;try{return xi=Ee,Se()}finally{xi=Ge}},Wt=function(Ee,Se,Ge){switch(Se){case"input":if(ir(Ee,Ge),Se=Ge.name,Ge.type==="radio"&&Se!=null){for(Ge=Ee;Ge.parentNode;)Ge=Ge.parentNode;for(Ge=Ge.querySelectorAll("input[name="+JSON.stringify(""+Se)+'][type="radio"]'),Se=0;Se<Ge.length;Se++){var nt=Ge[Se];if(nt!==Ee&&nt.form===Ee.form){var gt=vu(nt);if(!gt)throw Error(Y(90));Zi(nt),ir(nt,gt)}}}break;case"textarea":Ui(Ee,Ge);break;case"select":Se=Ge.value,Se!=null&&rn(Ee,!!Ge.multiple,Se,!1)}},ji=f1,Xi=wc;var kf={usingClientEntryPoint:!1,Events:[n0,jc,vu,ki,Hi,f1]},fh={findFiberByHostInstance:dl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_0={bundleType:fh.bundleType,version:fh.version,rendererPackageName:fh.rendererPackageName,rendererConfig:fh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ne.ReactCurrentDispatcher,findHostInstanceByFiber:function(Ee){return Ee=qn(Ee),Ee===null?null:Ee.stateNode},findFiberByHostInstance:fh.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ud.isDisabled&&ud.supportsFiber)try{Sr=ud.inject(_0),Ur=ud}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kf,reactDom_production_min.createPortal=function(Ee,Se){var Ge=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qc(Se))throw Error(Y(200));return Uf(Ee,Se,null,Ge)},reactDom_production_min.createRoot=function(Ee,Se){if(!Qc(Ee))throw Error(Y(299));var Ge=!1,nt="",gt=x1;return Se!=null&&(Se.unstable_strictMode===!0&&(Ge=!0),Se.identifierPrefix!==void 0&&(nt=Se.identifierPrefix),Se.onRecoverableError!==void 0&&(gt=Se.onRecoverableError)),Se=ch(Ee,1,!1,null,null,Ge,!1,nt,gt),Ee[Eo]=Se.current,F0(Ee.nodeType===8?Ee.parentNode:Ee),new ad(Se)},reactDom_production_min.findDOMNode=function(Ee){if(Ee==null)return null;if(Ee.nodeType===1)return Ee;var Se=Ee._reactInternals;if(Se===void 0)throw typeof Ee.render=="function"?Error(Y(188)):(Ee=Object.keys(Ee).join(","),Error(Y(268,Ee)));return Ee=qn(Se),Ee=Ee===null?null:Ee.stateNode,Ee},reactDom_production_min.flushSync=function(Ee){return wc(Ee)},reactDom_production_min.hydrate=function(Ee,Se,Ge){if(!ca(Se))throw Error(Y(200));return cd(null,Ee,Se,!0,Ge)},reactDom_production_min.hydrateRoot=function(Ee,Se,Ge){if(!Qc(Ee))throw Error(Y(405));var nt=Ge!=null&&Ge.hydratedSources||null,gt=!1,Pt="",en=x1;if(Ge!=null&&(Ge.unstable_strictMode===!0&&(gt=!0),Ge.identifierPrefix!==void 0&&(Pt=Ge.identifierPrefix),Ge.onRecoverableError!==void 0&&(en=Ge.onRecoverableError)),Se=y1(Se,null,Ee,1,Ge??null,gt,!1,Pt,en),Ee[Eo]=Se.current,F0(Ee),nt)for(Ee=0;Ee<nt.length;Ee++)Ge=nt[Ee],gt=Ge._getVersion,gt=gt(Ge._source),Se.mutableSourceEagerHydrationData==null?Se.mutableSourceEagerHydrationData=[Ge,gt]:Se.mutableSourceEagerHydrationData.push(Ge,gt);return new dh(Se)},reactDom_production_min.render=function(Ee,Se,Ge){if(!ca(Se))throw Error(Y(200));return cd(null,Ee,Se,!1,Ge)},reactDom_production_min.unmountComponentAtNode=function(Ee){if(!ca(Ee))throw Error(Y(40));return Ee._reactRootContainer?(wc(function(){cd(null,null,Ee,!1,function(){Ee._reactRootContainer=null,Ee[Eo]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=f1,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(Ee,Se,Ge,nt){if(!ca(Ge))throw Error(Y(200));if(Ee==null||Ee._reactInternals===void 0)throw Error(Y(38));return cd(Ee,Se,Ge,!1,nt)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function re(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(re)}catch(U){console.error(U)}}return re(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var re=requireReactDom();return client.createRoot=re.createRoot,client.hydrateRoot=re.hydrateRoot,client}var clientExports=requireClient();/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const i$2=(re,U)=>U.kind==="method"&&U.descriptor&&!("value"in U.descriptor)?{...U,finisher(Y){Y.createProperty(U.key,re)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:U.key,initializer(){typeof U.initializer=="function"&&(this[U.key]=U.initializer.call(this))},finisher(Y){Y.createProperty(U.key,re)}},e$3=(re,U,Y)=>{U.constructor.createProperty(Y,re)};function n$6(re){return(U,Y)=>Y!==void 0?e$3(re,U,Y):i$2(re,U)}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var n$5;((n$5=window.HTMLSlotElement)===null||n$5===void 0?void 0:n$5.prototype.assignedElements)!=null;/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="169",CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,NeutralToneMapping=7,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipmapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",KeepStencilOp=7680,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,GLSL3="300 es",WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(U,Y){this._listeners===void 0&&(this._listeners={});const ie=this._listeners;ie[U]===void 0&&(ie[U]=[]),ie[U].indexOf(Y)===-1&&ie[U].push(Y)}hasEventListener(U,Y){if(this._listeners===void 0)return!1;const ie=this._listeners;return ie[U]!==void 0&&ie[U].indexOf(Y)!==-1}removeEventListener(U,Y){if(this._listeners===void 0)return;const ne=this._listeners[U];if(ne!==void 0){const F=ne.indexOf(Y);F!==-1&&ne.splice(F,1)}}dispatchEvent(U){if(this._listeners===void 0)return;const ie=this._listeners[U.type];if(ie!==void 0){U.target=this;const ne=ie.slice(0);for(let F=0,fe=ne.length;F<fe;F++)ne[F].call(this,U);U.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const re=Math.random()*4294967295|0,U=Math.random()*4294967295|0,Y=Math.random()*4294967295|0,ie=Math.random()*4294967295|0;return(_lut[re&255]+_lut[re>>8&255]+_lut[re>>16&255]+_lut[re>>24&255]+"-"+_lut[U&255]+_lut[U>>8&255]+"-"+_lut[U>>16&15|64]+_lut[U>>24&255]+"-"+_lut[Y&63|128]+_lut[Y>>8&255]+"-"+_lut[Y>>16&255]+_lut[Y>>24&255]+_lut[ie&255]+_lut[ie>>8&255]+_lut[ie>>16&255]+_lut[ie>>24&255]).toLowerCase()}function clamp$1(re,U,Y){return Math.max(U,Math.min(Y,re))}function euclideanModulo(re,U){return(re%U+U)%U}function mapLinear(re,U,Y,ie,ne){return ie+(re-U)*(ne-ie)/(Y-U)}function inverseLerp(re,U,Y){return re!==U?(Y-re)/(U-re):0}function lerp$1(re,U,Y){return(1-Y)*re+Y*U}function damp(re,U,Y,ie){return lerp$1(re,U,1-Math.exp(-Y*ie))}function pingpong(re,U=1){return U-Math.abs(euclideanModulo(re,U*2)-U)}function smoothstep(re,U,Y){return re<=U?0:re>=Y?1:(re=(re-U)/(Y-U),re*re*(3-2*re))}function smootherstep(re,U,Y){return re<=U?0:re>=Y?1:(re=(re-U)/(Y-U),re*re*re*(re*(re*6-15)+10))}function randInt(re,U){return re+Math.floor(Math.random()*(U-re+1))}function randFloat(re,U){return re+Math.random()*(U-re)}function randFloatSpread(re){return re*(.5-Math.random())}function seededRandom(re){re!==void 0&&(_seed=re);let U=_seed+=1831565813;return U=Math.imul(U^U>>>15,U|1),U^=U+Math.imul(U^U>>>7,U|61),((U^U>>>14)>>>0)/4294967296}function degToRad(re){return re*DEG2RAD}function radToDeg(re){return re*RAD2DEG}function isPowerOfTwo(re){return(re&re-1)===0&&re!==0}function ceilPowerOfTwo(re){return Math.pow(2,Math.ceil(Math.log(re)/Math.LN2))}function floorPowerOfTwo(re){return Math.pow(2,Math.floor(Math.log(re)/Math.LN2))}function setQuaternionFromProperEuler(re,U,Y,ie,ne){const F=Math.cos,fe=Math.sin,pe=F(Y/2),Me=fe(Y/2),ve=F((U+ie)/2),se=fe((U+ie)/2),me=F((U-ie)/2),Te=fe((U-ie)/2),Re=F((ie-U)/2),be=fe((ie-U)/2);switch(ne){case"XYX":re.set(pe*se,Me*me,Me*Te,pe*ve);break;case"YZY":re.set(Me*Te,pe*se,Me*me,pe*ve);break;case"ZXZ":re.set(Me*me,Me*Te,pe*se,pe*ve);break;case"XZX":re.set(pe*se,Me*be,Me*Re,pe*ve);break;case"YXY":re.set(Me*Re,pe*se,Me*be,pe*ve);break;case"ZYZ":re.set(Me*be,Me*Re,pe*se,pe*ve);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+ne)}}function denormalize(re,U){switch(U.constructor){case Float32Array:return re;case Uint32Array:return re/4294967295;case Uint16Array:return re/65535;case Uint8Array:return re/255;case Int32Array:return Math.max(re/2147483647,-1);case Int16Array:return Math.max(re/32767,-1);case Int8Array:return Math.max(re/127,-1);default:throw new Error("Invalid component type.")}}function normalize(re,U){switch(U.constructor){case Float32Array:return re;case Uint32Array:return Math.round(re*4294967295);case Uint16Array:return Math.round(re*65535);case Uint8Array:return Math.round(re*255);case Int32Array:return Math.round(re*2147483647);case Int16Array:return Math.round(re*32767);case Int8Array:return Math.round(re*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp:clamp$1,euclideanModulo,mapLinear,inverseLerp,lerp:lerp$1,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(U=0,Y=0){Vector2.prototype.isVector2=!0,this.x=U,this.y=Y}get width(){return this.x}set width(U){this.x=U}get height(){return this.y}set height(U){this.y=U}set(U,Y){return this.x=U,this.y=Y,this}setScalar(U){return this.x=U,this.y=U,this}setX(U){return this.x=U,this}setY(U){return this.y=U,this}setComponent(U,Y){switch(U){case 0:this.x=Y;break;case 1:this.y=Y;break;default:throw new Error("index is out of range: "+U)}return this}getComponent(U){switch(U){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+U)}}clone(){return new this.constructor(this.x,this.y)}copy(U){return this.x=U.x,this.y=U.y,this}add(U){return this.x+=U.x,this.y+=U.y,this}addScalar(U){return this.x+=U,this.y+=U,this}addVectors(U,Y){return this.x=U.x+Y.x,this.y=U.y+Y.y,this}addScaledVector(U,Y){return this.x+=U.x*Y,this.y+=U.y*Y,this}sub(U){return this.x-=U.x,this.y-=U.y,this}subScalar(U){return this.x-=U,this.y-=U,this}subVectors(U,Y){return this.x=U.x-Y.x,this.y=U.y-Y.y,this}multiply(U){return this.x*=U.x,this.y*=U.y,this}multiplyScalar(U){return this.x*=U,this.y*=U,this}divide(U){return this.x/=U.x,this.y/=U.y,this}divideScalar(U){return this.multiplyScalar(1/U)}applyMatrix3(U){const Y=this.x,ie=this.y,ne=U.elements;return this.x=ne[0]*Y+ne[3]*ie+ne[6],this.y=ne[1]*Y+ne[4]*ie+ne[7],this}min(U){return this.x=Math.min(this.x,U.x),this.y=Math.min(this.y,U.y),this}max(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this}clamp(U,Y){return this.x=Math.max(U.x,Math.min(Y.x,this.x)),this.y=Math.max(U.y,Math.min(Y.y,this.y)),this}clampScalar(U,Y){return this.x=Math.max(U,Math.min(Y,this.x)),this.y=Math.max(U,Math.min(Y,this.y)),this}clampLength(U,Y){const ie=this.length();return this.divideScalar(ie||1).multiplyScalar(Math.max(U,Math.min(Y,ie)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(U){return this.x*U.x+this.y*U.y}cross(U){return this.x*U.y-this.y*U.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(U){const Y=Math.sqrt(this.lengthSq()*U.lengthSq());if(Y===0)return Math.PI/2;const ie=this.dot(U)/Y;return Math.acos(clamp$1(ie,-1,1))}distanceTo(U){return Math.sqrt(this.distanceToSquared(U))}distanceToSquared(U){const Y=this.x-U.x,ie=this.y-U.y;return Y*Y+ie*ie}manhattanDistanceTo(U){return Math.abs(this.x-U.x)+Math.abs(this.y-U.y)}setLength(U){return this.normalize().multiplyScalar(U)}lerp(U,Y){return this.x+=(U.x-this.x)*Y,this.y+=(U.y-this.y)*Y,this}lerpVectors(U,Y,ie){return this.x=U.x+(Y.x-U.x)*ie,this.y=U.y+(Y.y-U.y)*ie,this}equals(U){return U.x===this.x&&U.y===this.y}fromArray(U,Y=0){return this.x=U[Y],this.y=U[Y+1],this}toArray(U=[],Y=0){return U[Y]=this.x,U[Y+1]=this.y,U}fromBufferAttribute(U,Y){return this.x=U.getX(Y),this.y=U.getY(Y),this}rotateAround(U,Y){const ie=Math.cos(Y),ne=Math.sin(Y),F=this.x-U.x,fe=this.y-U.y;return this.x=F*ie-fe*ne+U.x,this.y=F*ne+fe*ie+U.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(U,Y,ie,ne,F,fe,pe,Me,ve){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],U!==void 0&&this.set(U,Y,ie,ne,F,fe,pe,Me,ve)}set(U,Y,ie,ne,F,fe,pe,Me,ve){const se=this.elements;return se[0]=U,se[1]=ne,se[2]=pe,se[3]=Y,se[4]=F,se[5]=Me,se[6]=ie,se[7]=fe,se[8]=ve,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(U){const Y=this.elements,ie=U.elements;return Y[0]=ie[0],Y[1]=ie[1],Y[2]=ie[2],Y[3]=ie[3],Y[4]=ie[4],Y[5]=ie[5],Y[6]=ie[6],Y[7]=ie[7],Y[8]=ie[8],this}extractBasis(U,Y,ie){return U.setFromMatrix3Column(this,0),Y.setFromMatrix3Column(this,1),ie.setFromMatrix3Column(this,2),this}setFromMatrix4(U){const Y=U.elements;return this.set(Y[0],Y[4],Y[8],Y[1],Y[5],Y[9],Y[2],Y[6],Y[10]),this}multiply(U){return this.multiplyMatrices(this,U)}premultiply(U){return this.multiplyMatrices(U,this)}multiplyMatrices(U,Y){const ie=U.elements,ne=Y.elements,F=this.elements,fe=ie[0],pe=ie[3],Me=ie[6],ve=ie[1],se=ie[4],me=ie[7],Te=ie[2],Re=ie[5],be=ie[8],Pe=ne[0],Le=ne[3],xe=ne[6],Fe=ne[1],Oe=ne[4],Ne=ne[7],ke=ne[2],Ve=ne[5],Xe=ne[8];return F[0]=fe*Pe+pe*Fe+Me*ke,F[3]=fe*Le+pe*Oe+Me*Ve,F[6]=fe*xe+pe*Ne+Me*Xe,F[1]=ve*Pe+se*Fe+me*ke,F[4]=ve*Le+se*Oe+me*Ve,F[7]=ve*xe+se*Ne+me*Xe,F[2]=Te*Pe+Re*Fe+be*ke,F[5]=Te*Le+Re*Oe+be*Ve,F[8]=Te*xe+Re*Ne+be*Xe,this}multiplyScalar(U){const Y=this.elements;return Y[0]*=U,Y[3]*=U,Y[6]*=U,Y[1]*=U,Y[4]*=U,Y[7]*=U,Y[2]*=U,Y[5]*=U,Y[8]*=U,this}determinant(){const U=this.elements,Y=U[0],ie=U[1],ne=U[2],F=U[3],fe=U[4],pe=U[5],Me=U[6],ve=U[7],se=U[8];return Y*fe*se-Y*pe*ve-ie*F*se+ie*pe*Me+ne*F*ve-ne*fe*Me}invert(){const U=this.elements,Y=U[0],ie=U[1],ne=U[2],F=U[3],fe=U[4],pe=U[5],Me=U[6],ve=U[7],se=U[8],me=se*fe-pe*ve,Te=pe*Me-se*F,Re=ve*F-fe*Me,be=Y*me+ie*Te+ne*Re;if(be===0)return this.set(0,0,0,0,0,0,0,0,0);const Pe=1/be;return U[0]=me*Pe,U[1]=(ne*ve-se*ie)*Pe,U[2]=(pe*ie-ne*fe)*Pe,U[3]=Te*Pe,U[4]=(se*Y-ne*Me)*Pe,U[5]=(ne*F-pe*Y)*Pe,U[6]=Re*Pe,U[7]=(ie*Me-ve*Y)*Pe,U[8]=(fe*Y-ie*F)*Pe,this}transpose(){let U;const Y=this.elements;return U=Y[1],Y[1]=Y[3],Y[3]=U,U=Y[2],Y[2]=Y[6],Y[6]=U,U=Y[5],Y[5]=Y[7],Y[7]=U,this}getNormalMatrix(U){return this.setFromMatrix4(U).invert().transpose()}transposeIntoArray(U){const Y=this.elements;return U[0]=Y[0],U[1]=Y[3],U[2]=Y[6],U[3]=Y[1],U[4]=Y[4],U[5]=Y[7],U[6]=Y[2],U[7]=Y[5],U[8]=Y[8],this}setUvTransform(U,Y,ie,ne,F,fe,pe){const Me=Math.cos(F),ve=Math.sin(F);return this.set(ie*Me,ie*ve,-ie*(Me*fe+ve*pe)+fe+U,-ne*ve,ne*Me,-ne*(-ve*fe+Me*pe)+pe+Y,0,0,1),this}scale(U,Y){return this.premultiply(_m3.makeScale(U,Y)),this}rotate(U){return this.premultiply(_m3.makeRotation(-U)),this}translate(U,Y){return this.premultiply(_m3.makeTranslation(U,Y)),this}makeTranslation(U,Y){return U.isVector2?this.set(1,0,U.x,0,1,U.y,0,0,1):this.set(1,0,U,0,1,Y,0,0,1),this}makeRotation(U){const Y=Math.cos(U),ie=Math.sin(U);return this.set(Y,-ie,0,ie,Y,0,0,0,1),this}makeScale(U,Y){return this.set(U,0,0,0,Y,0,0,0,1),this}equals(U){const Y=this.elements,ie=U.elements;for(let ne=0;ne<9;ne++)if(Y[ne]!==ie[ne])return!1;return!0}fromArray(U,Y=0){for(let ie=0;ie<9;ie++)this.elements[ie]=U[ie+Y];return this}toArray(U=[],Y=0){const ie=this.elements;return U[Y]=ie[0],U[Y+1]=ie[1],U[Y+2]=ie[2],U[Y+3]=ie[3],U[Y+4]=ie[4],U[Y+5]=ie[5],U[Y+6]=ie[6],U[Y+7]=ie[7],U[Y+8]=ie[8],U}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(re){for(let U=re.length-1;U>=0;--U)if(re[U]>=65535)return!0;return!1}function createElementNS(re){return document.createElementNS("http://www.w3.org/1999/xhtml",re)}function createCanvasElement(){const re=createElementNS("canvas");return re.style.display="block",re}const _cache={};function warnOnce(re){re in _cache||(_cache[re]=!0,console.warn(re))}function probeAsync(re,U,Y){return new Promise(function(ie,ne){function F(){switch(re.clientWaitSync(U,re.SYNC_FLUSH_COMMANDS_BIT,0)){case re.WAIT_FAILED:ne();break;case re.TIMEOUT_EXPIRED:setTimeout(F,Y);break;default:ie()}}setTimeout(F,Y)})}function toNormalizedProjectionMatrix(re){const U=re.elements;U[2]=.5*U[2]+.5*U[3],U[6]=.5*U[6]+.5*U[7],U[10]=.5*U[10]+.5*U[11],U[14]=.5*U[14]+.5*U[15]}function toReversedProjectionMatrix(re){const U=re.elements;U[11]===-1?(U[10]=-U[10]-1,U[14]=-U[14]):(U[10]=-U[10],U[14]=-U[14]+1)}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,luminanceCoefficients:[.2126,.7152,.0722],toReference:re=>re,fromReference:re=>re},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,luminanceCoefficients:[.2126,.7152,.0722],toReference:re=>re.convertSRGBToLinear(),fromReference:re=>re.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,luminanceCoefficients:[.2289,.6917,.0793],toReference:re=>re.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:re=>re.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,luminanceCoefficients:[.2289,.6917,.0793],toReference:re=>re.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:re=>re.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(re){if(!SUPPORTED_WORKING_COLOR_SPACES.has(re))throw new Error(`Unsupported working color space, "${re}".`);this._workingColorSpace=re},convert:function(re,U,Y){if(this.enabled===!1||U===Y||!U||!Y)return re;const ie=COLOR_SPACES[U].toReference,ne=COLOR_SPACES[Y].fromReference;return ne(ie(re))},fromWorkingColorSpace:function(re,U){return this.convert(re,this._workingColorSpace,U)},toWorkingColorSpace:function(re,U){return this.convert(re,U,this._workingColorSpace)},getPrimaries:function(re){return COLOR_SPACES[re].primaries},getTransfer:function(re){return re===NoColorSpace?LinearTransfer:COLOR_SPACES[re].transfer},getLuminanceCoefficients:function(re,U=this._workingColorSpace){return re.fromArray(COLOR_SPACES[U].luminanceCoefficients)}};function SRGBToLinear(re){return re<.04045?re*.0773993808:Math.pow(re*.9478672986+.0521327014,2.4)}function LinearToSRGB(re){return re<.0031308?re*12.92:1.055*Math.pow(re,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(U){if(/^data:/i.test(U.src)||typeof HTMLCanvasElement>"u")return U.src;let Y;if(U instanceof HTMLCanvasElement)Y=U;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=U.width,_canvas.height=U.height;const ie=_canvas.getContext("2d");U instanceof ImageData?ie.putImageData(U,0,0):ie.drawImage(U,0,0,U.width,U.height),Y=_canvas}return Y.width>2048||Y.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",U),Y.toDataURL("image/jpeg",.6)):Y.toDataURL("image/png")}static sRGBToLinear(U){if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){const Y=createElementNS("canvas");Y.width=U.width,Y.height=U.height;const ie=Y.getContext("2d");ie.drawImage(U,0,0,U.width,U.height);const ne=ie.getImageData(0,0,U.width,U.height),F=ne.data;for(let fe=0;fe<F.length;fe++)F[fe]=SRGBToLinear(F[fe]/255)*255;return ie.putImageData(ne,0,0),Y}else if(U.data){const Y=U.data.slice(0);for(let ie=0;ie<Y.length;ie++)Y instanceof Uint8Array||Y instanceof Uint8ClampedArray?Y[ie]=Math.floor(SRGBToLinear(Y[ie]/255)*255):Y[ie]=SRGBToLinear(Y[ie]);return{data:Y,width:U.width,height:U.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),U}}let _sourceId=0;class Source{constructor(U=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=U,this.dataReady=!0,this.version=0}set needsUpdate(U){U===!0&&this.version++}toJSON(U){const Y=U===void 0||typeof U=="string";if(!Y&&U.images[this.uuid]!==void 0)return U.images[this.uuid];const ie={uuid:this.uuid,url:""},ne=this.data;if(ne!==null){let F;if(Array.isArray(ne)){F=[];for(let fe=0,pe=ne.length;fe<pe;fe++)ne[fe].isDataTexture?F.push(serializeImage(ne[fe].image)):F.push(serializeImage(ne[fe]))}else F=serializeImage(ne);ie.url=F}return Y||(U.images[this.uuid]=ie),ie}}function serializeImage(re){return typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&re instanceof ImageBitmap?ImageUtils.getDataURL(re):re.data?{data:Array.from(re.data),width:re.width,height:re.height,type:re.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0,Texture$1=class UA extends EventDispatcher{constructor(U=UA.DEFAULT_IMAGE,Y=UA.DEFAULT_MAPPING,ie=ClampToEdgeWrapping,ne=ClampToEdgeWrapping,F=LinearFilter,fe=LinearMipmapLinearFilter,pe=RGBAFormat,Me=UnsignedByteType,ve=UA.DEFAULT_ANISOTROPY,se=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(U),this.mipmaps=[],this.mapping=Y,this.channel=0,this.wrapS=ie,this.wrapT=ne,this.magFilter=F,this.minFilter=fe,this.anisotropy=ve,this.format=pe,this.internalFormat=null,this.type=Me,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=se,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(U=null){this.source.data=U}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(U){return this.name=U.name,this.source=U.source,this.mipmaps=U.mipmaps.slice(0),this.mapping=U.mapping,this.channel=U.channel,this.wrapS=U.wrapS,this.wrapT=U.wrapT,this.magFilter=U.magFilter,this.minFilter=U.minFilter,this.anisotropy=U.anisotropy,this.format=U.format,this.internalFormat=U.internalFormat,this.type=U.type,this.offset.copy(U.offset),this.repeat.copy(U.repeat),this.center.copy(U.center),this.rotation=U.rotation,this.matrixAutoUpdate=U.matrixAutoUpdate,this.matrix.copy(U.matrix),this.generateMipmaps=U.generateMipmaps,this.premultiplyAlpha=U.premultiplyAlpha,this.flipY=U.flipY,this.unpackAlignment=U.unpackAlignment,this.colorSpace=U.colorSpace,this.userData=JSON.parse(JSON.stringify(U.userData)),this.needsUpdate=!0,this}toJSON(U){const Y=U===void 0||typeof U=="string";if(!Y&&U.textures[this.uuid]!==void 0)return U.textures[this.uuid];const ie={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(U).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(ie.userData=this.userData),Y||(U.textures[this.uuid]=ie),ie}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(U){if(this.mapping!==UVMapping)return U;if(U.applyMatrix3(this.matrix),U.x<0||U.x>1)switch(this.wrapS){case RepeatWrapping:U.x=U.x-Math.floor(U.x);break;case ClampToEdgeWrapping:U.x=U.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(U.x)%2)===1?U.x=Math.ceil(U.x)-U.x:U.x=U.x-Math.floor(U.x);break}if(U.y<0||U.y>1)switch(this.wrapT){case RepeatWrapping:U.y=U.y-Math.floor(U.y);break;case ClampToEdgeWrapping:U.y=U.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(U.y)%2)===1?U.y=Math.ceil(U.y)-U.y:U.y=U.y-Math.floor(U.y);break}return this.flipY&&(U.y=1-U.y),U}set needsUpdate(U){U===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(U){U===!0&&this.pmremVersion++}};Texture$1.DEFAULT_IMAGE=null;Texture$1.DEFAULT_MAPPING=UVMapping;Texture$1.DEFAULT_ANISOTROPY=1;class Vector4{constructor(U=0,Y=0,ie=0,ne=1){Vector4.prototype.isVector4=!0,this.x=U,this.y=Y,this.z=ie,this.w=ne}get width(){return this.z}set width(U){this.z=U}get height(){return this.w}set height(U){this.w=U}set(U,Y,ie,ne){return this.x=U,this.y=Y,this.z=ie,this.w=ne,this}setScalar(U){return this.x=U,this.y=U,this.z=U,this.w=U,this}setX(U){return this.x=U,this}setY(U){return this.y=U,this}setZ(U){return this.z=U,this}setW(U){return this.w=U,this}setComponent(U,Y){switch(U){case 0:this.x=Y;break;case 1:this.y=Y;break;case 2:this.z=Y;break;case 3:this.w=Y;break;default:throw new Error("index is out of range: "+U)}return this}getComponent(U){switch(U){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+U)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(U){return this.x=U.x,this.y=U.y,this.z=U.z,this.w=U.w!==void 0?U.w:1,this}add(U){return this.x+=U.x,this.y+=U.y,this.z+=U.z,this.w+=U.w,this}addScalar(U){return this.x+=U,this.y+=U,this.z+=U,this.w+=U,this}addVectors(U,Y){return this.x=U.x+Y.x,this.y=U.y+Y.y,this.z=U.z+Y.z,this.w=U.w+Y.w,this}addScaledVector(U,Y){return this.x+=U.x*Y,this.y+=U.y*Y,this.z+=U.z*Y,this.w+=U.w*Y,this}sub(U){return this.x-=U.x,this.y-=U.y,this.z-=U.z,this.w-=U.w,this}subScalar(U){return this.x-=U,this.y-=U,this.z-=U,this.w-=U,this}subVectors(U,Y){return this.x=U.x-Y.x,this.y=U.y-Y.y,this.z=U.z-Y.z,this.w=U.w-Y.w,this}multiply(U){return this.x*=U.x,this.y*=U.y,this.z*=U.z,this.w*=U.w,this}multiplyScalar(U){return this.x*=U,this.y*=U,this.z*=U,this.w*=U,this}applyMatrix4(U){const Y=this.x,ie=this.y,ne=this.z,F=this.w,fe=U.elements;return this.x=fe[0]*Y+fe[4]*ie+fe[8]*ne+fe[12]*F,this.y=fe[1]*Y+fe[5]*ie+fe[9]*ne+fe[13]*F,this.z=fe[2]*Y+fe[6]*ie+fe[10]*ne+fe[14]*F,this.w=fe[3]*Y+fe[7]*ie+fe[11]*ne+fe[15]*F,this}divideScalar(U){return this.multiplyScalar(1/U)}setAxisAngleFromQuaternion(U){this.w=2*Math.acos(U.w);const Y=Math.sqrt(1-U.w*U.w);return Y<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=U.x/Y,this.y=U.y/Y,this.z=U.z/Y),this}setAxisAngleFromRotationMatrix(U){let Y,ie,ne,F;const Me=U.elements,ve=Me[0],se=Me[4],me=Me[8],Te=Me[1],Re=Me[5],be=Me[9],Pe=Me[2],Le=Me[6],xe=Me[10];if(Math.abs(se-Te)<.01&&Math.abs(me-Pe)<.01&&Math.abs(be-Le)<.01){if(Math.abs(se+Te)<.1&&Math.abs(me+Pe)<.1&&Math.abs(be+Le)<.1&&Math.abs(ve+Re+xe-3)<.1)return this.set(1,0,0,0),this;Y=Math.PI;const Oe=(ve+1)/2,Ne=(Re+1)/2,ke=(xe+1)/2,Ve=(se+Te)/4,Xe=(me+Pe)/4,$e=(be+Le)/4;return Oe>Ne&&Oe>ke?Oe<.01?(ie=0,ne=.707106781,F=.707106781):(ie=Math.sqrt(Oe),ne=Ve/ie,F=Xe/ie):Ne>ke?Ne<.01?(ie=.707106781,ne=0,F=.707106781):(ne=Math.sqrt(Ne),ie=Ve/ne,F=$e/ne):ke<.01?(ie=.707106781,ne=.707106781,F=0):(F=Math.sqrt(ke),ie=Xe/F,ne=$e/F),this.set(ie,ne,F,Y),this}let Fe=Math.sqrt((Le-be)*(Le-be)+(me-Pe)*(me-Pe)+(Te-se)*(Te-se));return Math.abs(Fe)<.001&&(Fe=1),this.x=(Le-be)/Fe,this.y=(me-Pe)/Fe,this.z=(Te-se)/Fe,this.w=Math.acos((ve+Re+xe-1)/2),this}setFromMatrixPosition(U){const Y=U.elements;return this.x=Y[12],this.y=Y[13],this.z=Y[14],this.w=Y[15],this}min(U){return this.x=Math.min(this.x,U.x),this.y=Math.min(this.y,U.y),this.z=Math.min(this.z,U.z),this.w=Math.min(this.w,U.w),this}max(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this.z=Math.max(this.z,U.z),this.w=Math.max(this.w,U.w),this}clamp(U,Y){return this.x=Math.max(U.x,Math.min(Y.x,this.x)),this.y=Math.max(U.y,Math.min(Y.y,this.y)),this.z=Math.max(U.z,Math.min(Y.z,this.z)),this.w=Math.max(U.w,Math.min(Y.w,this.w)),this}clampScalar(U,Y){return this.x=Math.max(U,Math.min(Y,this.x)),this.y=Math.max(U,Math.min(Y,this.y)),this.z=Math.max(U,Math.min(Y,this.z)),this.w=Math.max(U,Math.min(Y,this.w)),this}clampLength(U,Y){const ie=this.length();return this.divideScalar(ie||1).multiplyScalar(Math.max(U,Math.min(Y,ie)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(U){return this.x*U.x+this.y*U.y+this.z*U.z+this.w*U.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(U){return this.normalize().multiplyScalar(U)}lerp(U,Y){return this.x+=(U.x-this.x)*Y,this.y+=(U.y-this.y)*Y,this.z+=(U.z-this.z)*Y,this.w+=(U.w-this.w)*Y,this}lerpVectors(U,Y,ie){return this.x=U.x+(Y.x-U.x)*ie,this.y=U.y+(Y.y-U.y)*ie,this.z=U.z+(Y.z-U.z)*ie,this.w=U.w+(Y.w-U.w)*ie,this}equals(U){return U.x===this.x&&U.y===this.y&&U.z===this.z&&U.w===this.w}fromArray(U,Y=0){return this.x=U[Y],this.y=U[Y+1],this.z=U[Y+2],this.w=U[Y+3],this}toArray(U=[],Y=0){return U[Y]=this.x,U[Y+1]=this.y,U[Y+2]=this.z,U[Y+3]=this.w,U}fromBufferAttribute(U,Y){return this.x=U.getX(Y),this.y=U.getY(Y),this.z=U.getZ(Y),this.w=U.getW(Y),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher{constructor(U=1,Y=1,ie={}){super(),this.isRenderTarget=!0,this.width=U,this.height=Y,this.depth=1,this.scissor=new Vector4(0,0,U,Y),this.scissorTest=!1,this.viewport=new Vector4(0,0,U,Y);const ne={width:U,height:Y,depth:1};ie=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},ie);const F=new Texture$1(ne,ie.mapping,ie.wrapS,ie.wrapT,ie.magFilter,ie.minFilter,ie.format,ie.type,ie.anisotropy,ie.colorSpace);F.flipY=!1,F.generateMipmaps=ie.generateMipmaps,F.internalFormat=ie.internalFormat,this.textures=[];const fe=ie.count;for(let pe=0;pe<fe;pe++)this.textures[pe]=F.clone(),this.textures[pe].isRenderTargetTexture=!0;this.depthBuffer=ie.depthBuffer,this.stencilBuffer=ie.stencilBuffer,this.resolveDepthBuffer=ie.resolveDepthBuffer,this.resolveStencilBuffer=ie.resolveStencilBuffer,this.depthTexture=ie.depthTexture,this.samples=ie.samples}get texture(){return this.textures[0]}set texture(U){this.textures[0]=U}setSize(U,Y,ie=1){if(this.width!==U||this.height!==Y||this.depth!==ie){this.width=U,this.height=Y,this.depth=ie;for(let ne=0,F=this.textures.length;ne<F;ne++)this.textures[ne].image.width=U,this.textures[ne].image.height=Y,this.textures[ne].image.depth=ie;this.dispose()}this.viewport.set(0,0,U,Y),this.scissor.set(0,0,U,Y)}clone(){return new this.constructor().copy(this)}copy(U){this.width=U.width,this.height=U.height,this.depth=U.depth,this.scissor.copy(U.scissor),this.scissorTest=U.scissorTest,this.viewport.copy(U.viewport),this.textures.length=0;for(let ie=0,ne=U.textures.length;ie<ne;ie++)this.textures[ie]=U.textures[ie].clone(),this.textures[ie].isRenderTargetTexture=!0;const Y=Object.assign({},U.texture.image);return this.texture.source=new Source(Y),this.depthBuffer=U.depthBuffer,this.stencilBuffer=U.stencilBuffer,this.resolveDepthBuffer=U.resolveDepthBuffer,this.resolveStencilBuffer=U.resolveStencilBuffer,U.depthTexture!==null&&(this.depthTexture=U.depthTexture.clone()),this.samples=U.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(U=1,Y=1,ie={}){super(U,Y,ie),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture$1{constructor(U=null,Y=1,ie=1,ne=1){super(null),this.isDataArrayTexture=!0,this.image={data:U,width:Y,height:ie,depth:ne},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(U){this.layerUpdates.add(U)}clearLayerUpdates(){this.layerUpdates.clear()}}class Data3DTexture extends Texture$1{constructor(U=null,Y=1,ie=1,ne=1){super(null),this.isData3DTexture=!0,this.image={data:U,width:Y,height:ie,depth:ne},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Quaternion{constructor(U=0,Y=0,ie=0,ne=1){this.isQuaternion=!0,this._x=U,this._y=Y,this._z=ie,this._w=ne}static slerpFlat(U,Y,ie,ne,F,fe,pe){let Me=ie[ne+0],ve=ie[ne+1],se=ie[ne+2],me=ie[ne+3];const Te=F[fe+0],Re=F[fe+1],be=F[fe+2],Pe=F[fe+3];if(pe===0){U[Y+0]=Me,U[Y+1]=ve,U[Y+2]=se,U[Y+3]=me;return}if(pe===1){U[Y+0]=Te,U[Y+1]=Re,U[Y+2]=be,U[Y+3]=Pe;return}if(me!==Pe||Me!==Te||ve!==Re||se!==be){let Le=1-pe;const xe=Me*Te+ve*Re+se*be+me*Pe,Fe=xe>=0?1:-1,Oe=1-xe*xe;if(Oe>Number.EPSILON){const ke=Math.sqrt(Oe),Ve=Math.atan2(ke,xe*Fe);Le=Math.sin(Le*Ve)/ke,pe=Math.sin(pe*Ve)/ke}const Ne=pe*Fe;if(Me=Me*Le+Te*Ne,ve=ve*Le+Re*Ne,se=se*Le+be*Ne,me=me*Le+Pe*Ne,Le===1-pe){const ke=1/Math.sqrt(Me*Me+ve*ve+se*se+me*me);Me*=ke,ve*=ke,se*=ke,me*=ke}}U[Y]=Me,U[Y+1]=ve,U[Y+2]=se,U[Y+3]=me}static multiplyQuaternionsFlat(U,Y,ie,ne,F,fe){const pe=ie[ne],Me=ie[ne+1],ve=ie[ne+2],se=ie[ne+3],me=F[fe],Te=F[fe+1],Re=F[fe+2],be=F[fe+3];return U[Y]=pe*be+se*me+Me*Re-ve*Te,U[Y+1]=Me*be+se*Te+ve*me-pe*Re,U[Y+2]=ve*be+se*Re+pe*Te-Me*me,U[Y+3]=se*be-pe*me-Me*Te-ve*Re,U}get x(){return this._x}set x(U){this._x=U,this._onChangeCallback()}get y(){return this._y}set y(U){this._y=U,this._onChangeCallback()}get z(){return this._z}set z(U){this._z=U,this._onChangeCallback()}get w(){return this._w}set w(U){this._w=U,this._onChangeCallback()}set(U,Y,ie,ne){return this._x=U,this._y=Y,this._z=ie,this._w=ne,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(U){return this._x=U.x,this._y=U.y,this._z=U.z,this._w=U.w,this._onChangeCallback(),this}setFromEuler(U,Y=!0){const ie=U._x,ne=U._y,F=U._z,fe=U._order,pe=Math.cos,Me=Math.sin,ve=pe(ie/2),se=pe(ne/2),me=pe(F/2),Te=Me(ie/2),Re=Me(ne/2),be=Me(F/2);switch(fe){case"XYZ":this._x=Te*se*me+ve*Re*be,this._y=ve*Re*me-Te*se*be,this._z=ve*se*be+Te*Re*me,this._w=ve*se*me-Te*Re*be;break;case"YXZ":this._x=Te*se*me+ve*Re*be,this._y=ve*Re*me-Te*se*be,this._z=ve*se*be-Te*Re*me,this._w=ve*se*me+Te*Re*be;break;case"ZXY":this._x=Te*se*me-ve*Re*be,this._y=ve*Re*me+Te*se*be,this._z=ve*se*be+Te*Re*me,this._w=ve*se*me-Te*Re*be;break;case"ZYX":this._x=Te*se*me-ve*Re*be,this._y=ve*Re*me+Te*se*be,this._z=ve*se*be-Te*Re*me,this._w=ve*se*me+Te*Re*be;break;case"YZX":this._x=Te*se*me+ve*Re*be,this._y=ve*Re*me+Te*se*be,this._z=ve*se*be-Te*Re*me,this._w=ve*se*me-Te*Re*be;break;case"XZY":this._x=Te*se*me-ve*Re*be,this._y=ve*Re*me-Te*se*be,this._z=ve*se*be+Te*Re*me,this._w=ve*se*me+Te*Re*be;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+fe)}return Y===!0&&this._onChangeCallback(),this}setFromAxisAngle(U,Y){const ie=Y/2,ne=Math.sin(ie);return this._x=U.x*ne,this._y=U.y*ne,this._z=U.z*ne,this._w=Math.cos(ie),this._onChangeCallback(),this}setFromRotationMatrix(U){const Y=U.elements,ie=Y[0],ne=Y[4],F=Y[8],fe=Y[1],pe=Y[5],Me=Y[9],ve=Y[2],se=Y[6],me=Y[10],Te=ie+pe+me;if(Te>0){const Re=.5/Math.sqrt(Te+1);this._w=.25/Re,this._x=(se-Me)*Re,this._y=(F-ve)*Re,this._z=(fe-ne)*Re}else if(ie>pe&&ie>me){const Re=2*Math.sqrt(1+ie-pe-me);this._w=(se-Me)/Re,this._x=.25*Re,this._y=(ne+fe)/Re,this._z=(F+ve)/Re}else if(pe>me){const Re=2*Math.sqrt(1+pe-ie-me);this._w=(F-ve)/Re,this._x=(ne+fe)/Re,this._y=.25*Re,this._z=(Me+se)/Re}else{const Re=2*Math.sqrt(1+me-ie-pe);this._w=(fe-ne)/Re,this._x=(F+ve)/Re,this._y=(Me+se)/Re,this._z=.25*Re}return this._onChangeCallback(),this}setFromUnitVectors(U,Y){let ie=U.dot(Y)+1;return ie<Number.EPSILON?(ie=0,Math.abs(U.x)>Math.abs(U.z)?(this._x=-U.y,this._y=U.x,this._z=0,this._w=ie):(this._x=0,this._y=-U.z,this._z=U.y,this._w=ie)):(this._x=U.y*Y.z-U.z*Y.y,this._y=U.z*Y.x-U.x*Y.z,this._z=U.x*Y.y-U.y*Y.x,this._w=ie),this.normalize()}angleTo(U){return 2*Math.acos(Math.abs(clamp$1(this.dot(U),-1,1)))}rotateTowards(U,Y){const ie=this.angleTo(U);if(ie===0)return this;const ne=Math.min(1,Y/ie);return this.slerp(U,ne),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(U){return this._x*U._x+this._y*U._y+this._z*U._z+this._w*U._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let U=this.length();return U===0?(this._x=0,this._y=0,this._z=0,this._w=1):(U=1/U,this._x=this._x*U,this._y=this._y*U,this._z=this._z*U,this._w=this._w*U),this._onChangeCallback(),this}multiply(U){return this.multiplyQuaternions(this,U)}premultiply(U){return this.multiplyQuaternions(U,this)}multiplyQuaternions(U,Y){const ie=U._x,ne=U._y,F=U._z,fe=U._w,pe=Y._x,Me=Y._y,ve=Y._z,se=Y._w;return this._x=ie*se+fe*pe+ne*ve-F*Me,this._y=ne*se+fe*Me+F*pe-ie*ve,this._z=F*se+fe*ve+ie*Me-ne*pe,this._w=fe*se-ie*pe-ne*Me-F*ve,this._onChangeCallback(),this}slerp(U,Y){if(Y===0)return this;if(Y===1)return this.copy(U);const ie=this._x,ne=this._y,F=this._z,fe=this._w;let pe=fe*U._w+ie*U._x+ne*U._y+F*U._z;if(pe<0?(this._w=-U._w,this._x=-U._x,this._y=-U._y,this._z=-U._z,pe=-pe):this.copy(U),pe>=1)return this._w=fe,this._x=ie,this._y=ne,this._z=F,this;const Me=1-pe*pe;if(Me<=Number.EPSILON){const Re=1-Y;return this._w=Re*fe+Y*this._w,this._x=Re*ie+Y*this._x,this._y=Re*ne+Y*this._y,this._z=Re*F+Y*this._z,this.normalize(),this}const ve=Math.sqrt(Me),se=Math.atan2(ve,pe),me=Math.sin((1-Y)*se)/ve,Te=Math.sin(Y*se)/ve;return this._w=fe*me+this._w*Te,this._x=ie*me+this._x*Te,this._y=ne*me+this._y*Te,this._z=F*me+this._z*Te,this._onChangeCallback(),this}slerpQuaternions(U,Y,ie){return this.copy(U).slerp(Y,ie)}random(){const U=2*Math.PI*Math.random(),Y=2*Math.PI*Math.random(),ie=Math.random(),ne=Math.sqrt(1-ie),F=Math.sqrt(ie);return this.set(ne*Math.sin(U),ne*Math.cos(U),F*Math.sin(Y),F*Math.cos(Y))}equals(U){return U._x===this._x&&U._y===this._y&&U._z===this._z&&U._w===this._w}fromArray(U,Y=0){return this._x=U[Y],this._y=U[Y+1],this._z=U[Y+2],this._w=U[Y+3],this._onChangeCallback(),this}toArray(U=[],Y=0){return U[Y]=this._x,U[Y+1]=this._y,U[Y+2]=this._z,U[Y+3]=this._w,U}fromBufferAttribute(U,Y){return this._x=U.getX(Y),this._y=U.getY(Y),this._z=U.getZ(Y),this._w=U.getW(Y),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(U){return this._onChangeCallback=U,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(U=0,Y=0,ie=0){Vector3.prototype.isVector3=!0,this.x=U,this.y=Y,this.z=ie}set(U,Y,ie){return ie===void 0&&(ie=this.z),this.x=U,this.y=Y,this.z=ie,this}setScalar(U){return this.x=U,this.y=U,this.z=U,this}setX(U){return this.x=U,this}setY(U){return this.y=U,this}setZ(U){return this.z=U,this}setComponent(U,Y){switch(U){case 0:this.x=Y;break;case 1:this.y=Y;break;case 2:this.z=Y;break;default:throw new Error("index is out of range: "+U)}return this}getComponent(U){switch(U){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+U)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(U){return this.x=U.x,this.y=U.y,this.z=U.z,this}add(U){return this.x+=U.x,this.y+=U.y,this.z+=U.z,this}addScalar(U){return this.x+=U,this.y+=U,this.z+=U,this}addVectors(U,Y){return this.x=U.x+Y.x,this.y=U.y+Y.y,this.z=U.z+Y.z,this}addScaledVector(U,Y){return this.x+=U.x*Y,this.y+=U.y*Y,this.z+=U.z*Y,this}sub(U){return this.x-=U.x,this.y-=U.y,this.z-=U.z,this}subScalar(U){return this.x-=U,this.y-=U,this.z-=U,this}subVectors(U,Y){return this.x=U.x-Y.x,this.y=U.y-Y.y,this.z=U.z-Y.z,this}multiply(U){return this.x*=U.x,this.y*=U.y,this.z*=U.z,this}multiplyScalar(U){return this.x*=U,this.y*=U,this.z*=U,this}multiplyVectors(U,Y){return this.x=U.x*Y.x,this.y=U.y*Y.y,this.z=U.z*Y.z,this}applyEuler(U){return this.applyQuaternion(_quaternion$4.setFromEuler(U))}applyAxisAngle(U,Y){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(U,Y))}applyMatrix3(U){const Y=this.x,ie=this.y,ne=this.z,F=U.elements;return this.x=F[0]*Y+F[3]*ie+F[6]*ne,this.y=F[1]*Y+F[4]*ie+F[7]*ne,this.z=F[2]*Y+F[5]*ie+F[8]*ne,this}applyNormalMatrix(U){return this.applyMatrix3(U).normalize()}applyMatrix4(U){const Y=this.x,ie=this.y,ne=this.z,F=U.elements,fe=1/(F[3]*Y+F[7]*ie+F[11]*ne+F[15]);return this.x=(F[0]*Y+F[4]*ie+F[8]*ne+F[12])*fe,this.y=(F[1]*Y+F[5]*ie+F[9]*ne+F[13])*fe,this.z=(F[2]*Y+F[6]*ie+F[10]*ne+F[14])*fe,this}applyQuaternion(U){const Y=this.x,ie=this.y,ne=this.z,F=U.x,fe=U.y,pe=U.z,Me=U.w,ve=2*(fe*ne-pe*ie),se=2*(pe*Y-F*ne),me=2*(F*ie-fe*Y);return this.x=Y+Me*ve+fe*me-pe*se,this.y=ie+Me*se+pe*ve-F*me,this.z=ne+Me*me+F*se-fe*ve,this}project(U){return this.applyMatrix4(U.matrixWorldInverse).applyMatrix4(U.projectionMatrix)}unproject(U){return this.applyMatrix4(U.projectionMatrixInverse).applyMatrix4(U.matrixWorld)}transformDirection(U){const Y=this.x,ie=this.y,ne=this.z,F=U.elements;return this.x=F[0]*Y+F[4]*ie+F[8]*ne,this.y=F[1]*Y+F[5]*ie+F[9]*ne,this.z=F[2]*Y+F[6]*ie+F[10]*ne,this.normalize()}divide(U){return this.x/=U.x,this.y/=U.y,this.z/=U.z,this}divideScalar(U){return this.multiplyScalar(1/U)}min(U){return this.x=Math.min(this.x,U.x),this.y=Math.min(this.y,U.y),this.z=Math.min(this.z,U.z),this}max(U){return this.x=Math.max(this.x,U.x),this.y=Math.max(this.y,U.y),this.z=Math.max(this.z,U.z),this}clamp(U,Y){return this.x=Math.max(U.x,Math.min(Y.x,this.x)),this.y=Math.max(U.y,Math.min(Y.y,this.y)),this.z=Math.max(U.z,Math.min(Y.z,this.z)),this}clampScalar(U,Y){return this.x=Math.max(U,Math.min(Y,this.x)),this.y=Math.max(U,Math.min(Y,this.y)),this.z=Math.max(U,Math.min(Y,this.z)),this}clampLength(U,Y){const ie=this.length();return this.divideScalar(ie||1).multiplyScalar(Math.max(U,Math.min(Y,ie)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(U){return this.x*U.x+this.y*U.y+this.z*U.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(U){return this.normalize().multiplyScalar(U)}lerp(U,Y){return this.x+=(U.x-this.x)*Y,this.y+=(U.y-this.y)*Y,this.z+=(U.z-this.z)*Y,this}lerpVectors(U,Y,ie){return this.x=U.x+(Y.x-U.x)*ie,this.y=U.y+(Y.y-U.y)*ie,this.z=U.z+(Y.z-U.z)*ie,this}cross(U){return this.crossVectors(this,U)}crossVectors(U,Y){const ie=U.x,ne=U.y,F=U.z,fe=Y.x,pe=Y.y,Me=Y.z;return this.x=ne*Me-F*pe,this.y=F*fe-ie*Me,this.z=ie*pe-ne*fe,this}projectOnVector(U){const Y=U.lengthSq();if(Y===0)return this.set(0,0,0);const ie=U.dot(this)/Y;return this.copy(U).multiplyScalar(ie)}projectOnPlane(U){return _vector$c.copy(this).projectOnVector(U),this.sub(_vector$c)}reflect(U){return this.sub(_vector$c.copy(U).multiplyScalar(2*this.dot(U)))}angleTo(U){const Y=Math.sqrt(this.lengthSq()*U.lengthSq());if(Y===0)return Math.PI/2;const ie=this.dot(U)/Y;return Math.acos(clamp$1(ie,-1,1))}distanceTo(U){return Math.sqrt(this.distanceToSquared(U))}distanceToSquared(U){const Y=this.x-U.x,ie=this.y-U.y,ne=this.z-U.z;return Y*Y+ie*ie+ne*ne}manhattanDistanceTo(U){return Math.abs(this.x-U.x)+Math.abs(this.y-U.y)+Math.abs(this.z-U.z)}setFromSpherical(U){return this.setFromSphericalCoords(U.radius,U.phi,U.theta)}setFromSphericalCoords(U,Y,ie){const ne=Math.sin(Y)*U;return this.x=ne*Math.sin(ie),this.y=Math.cos(Y)*U,this.z=ne*Math.cos(ie),this}setFromCylindrical(U){return this.setFromCylindricalCoords(U.radius,U.theta,U.y)}setFromCylindricalCoords(U,Y,ie){return this.x=U*Math.sin(Y),this.y=ie,this.z=U*Math.cos(Y),this}setFromMatrixPosition(U){const Y=U.elements;return this.x=Y[12],this.y=Y[13],this.z=Y[14],this}setFromMatrixScale(U){const Y=this.setFromMatrixColumn(U,0).length(),ie=this.setFromMatrixColumn(U,1).length(),ne=this.setFromMatrixColumn(U,2).length();return this.x=Y,this.y=ie,this.z=ne,this}setFromMatrixColumn(U,Y){return this.fromArray(U.elements,Y*4)}setFromMatrix3Column(U,Y){return this.fromArray(U.elements,Y*3)}setFromEuler(U){return this.x=U._x,this.y=U._y,this.z=U._z,this}setFromColor(U){return this.x=U.r,this.y=U.g,this.z=U.b,this}equals(U){return U.x===this.x&&U.y===this.y&&U.z===this.z}fromArray(U,Y=0){return this.x=U[Y],this.y=U[Y+1],this.z=U[Y+2],this}toArray(U=[],Y=0){return U[Y]=this.x,U[Y+1]=this.y,U[Y+2]=this.z,U}fromBufferAttribute(U,Y){return this.x=U.getX(Y),this.y=U.getY(Y),this.z=U.getZ(Y),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const U=Math.random()*Math.PI*2,Y=Math.random()*2-1,ie=Math.sqrt(1-Y*Y);return this.x=ie*Math.cos(U),this.y=Y,this.z=ie*Math.sin(U),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(U=new Vector3(1/0,1/0,1/0),Y=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=U,this.max=Y}set(U,Y){return this.min.copy(U),this.max.copy(Y),this}setFromArray(U){this.makeEmpty();for(let Y=0,ie=U.length;Y<ie;Y+=3)this.expandByPoint(_vector$b.fromArray(U,Y));return this}setFromBufferAttribute(U){this.makeEmpty();for(let Y=0,ie=U.count;Y<ie;Y++)this.expandByPoint(_vector$b.fromBufferAttribute(U,Y));return this}setFromPoints(U){this.makeEmpty();for(let Y=0,ie=U.length;Y<ie;Y++)this.expandByPoint(U[Y]);return this}setFromCenterAndSize(U,Y){const ie=_vector$b.copy(Y).multiplyScalar(.5);return this.min.copy(U).sub(ie),this.max.copy(U).add(ie),this}setFromObject(U,Y=!1){return this.makeEmpty(),this.expandByObject(U,Y)}clone(){return new this.constructor().copy(this)}copy(U){return this.min.copy(U.min),this.max.copy(U.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(U){return this.isEmpty()?U.set(0,0,0):U.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(U){return this.isEmpty()?U.set(0,0,0):U.subVectors(this.max,this.min)}expandByPoint(U){return this.min.min(U),this.max.max(U),this}expandByVector(U){return this.min.sub(U),this.max.add(U),this}expandByScalar(U){return this.min.addScalar(-U),this.max.addScalar(U),this}expandByObject(U,Y=!1){U.updateWorldMatrix(!1,!1);const ie=U.geometry;if(ie!==void 0){const F=ie.getAttribute("position");if(Y===!0&&F!==void 0&&U.isInstancedMesh!==!0)for(let fe=0,pe=F.count;fe<pe;fe++)U.isMesh===!0?U.getVertexPosition(fe,_vector$b):_vector$b.fromBufferAttribute(F,fe),_vector$b.applyMatrix4(U.matrixWorld),this.expandByPoint(_vector$b);else U.boundingBox!==void 0?(U.boundingBox===null&&U.computeBoundingBox(),_box$4.copy(U.boundingBox)):(ie.boundingBox===null&&ie.computeBoundingBox(),_box$4.copy(ie.boundingBox)),_box$4.applyMatrix4(U.matrixWorld),this.union(_box$4)}const ne=U.children;for(let F=0,fe=ne.length;F<fe;F++)this.expandByObject(ne[F],Y);return this}containsPoint(U){return U.x>=this.min.x&&U.x<=this.max.x&&U.y>=this.min.y&&U.y<=this.max.y&&U.z>=this.min.z&&U.z<=this.max.z}containsBox(U){return this.min.x<=U.min.x&&U.max.x<=this.max.x&&this.min.y<=U.min.y&&U.max.y<=this.max.y&&this.min.z<=U.min.z&&U.max.z<=this.max.z}getParameter(U,Y){return Y.set((U.x-this.min.x)/(this.max.x-this.min.x),(U.y-this.min.y)/(this.max.y-this.min.y),(U.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(U){return U.max.x>=this.min.x&&U.min.x<=this.max.x&&U.max.y>=this.min.y&&U.min.y<=this.max.y&&U.max.z>=this.min.z&&U.min.z<=this.max.z}intersectsSphere(U){return this.clampPoint(U.center,_vector$b),_vector$b.distanceToSquared(U.center)<=U.radius*U.radius}intersectsPlane(U){let Y,ie;return U.normal.x>0?(Y=U.normal.x*this.min.x,ie=U.normal.x*this.max.x):(Y=U.normal.x*this.max.x,ie=U.normal.x*this.min.x),U.normal.y>0?(Y+=U.normal.y*this.min.y,ie+=U.normal.y*this.max.y):(Y+=U.normal.y*this.max.y,ie+=U.normal.y*this.min.y),U.normal.z>0?(Y+=U.normal.z*this.min.z,ie+=U.normal.z*this.max.z):(Y+=U.normal.z*this.max.z,ie+=U.normal.z*this.min.z),Y<=-U.constant&&ie>=-U.constant}intersectsTriangle(U){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$3.subVectors(U.a,_center),_v1$7.subVectors(U.b,_center),_v2$4.subVectors(U.c,_center),_f0.subVectors(_v1$7,_v0$3),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$3,_v2$4);let Y=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(Y,_v0$3,_v1$7,_v2$4,_extents)||(Y=[1,0,0,0,1,0,0,0,1],!satForAxes(Y,_v0$3,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),Y=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(Y,_v0$3,_v1$7,_v2$4,_extents))}clampPoint(U,Y){return Y.copy(U).clamp(this.min,this.max)}distanceToPoint(U){return this.clampPoint(U,_vector$b).distanceTo(U)}getBoundingSphere(U){return this.isEmpty()?U.makeEmpty():(this.getCenter(U.center),U.radius=this.getSize(_vector$b).length()*.5),U}intersect(U){return this.min.max(U.min),this.max.min(U.max),this.isEmpty()&&this.makeEmpty(),this}union(U){return this.min.min(U.min),this.max.max(U.max),this}applyMatrix4(U){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(U),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(U),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(U),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(U),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(U),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(U),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(U),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(U),this.setFromPoints(_points),this)}translate(U){return this.min.add(U),this.max.add(U),this}equals(U){return U.min.equals(this.min)&&U.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$3=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(re,U,Y,ie,ne){for(let F=0,fe=re.length-3;F<=fe;F+=3){_testAxis.fromArray(re,F);const pe=ne.x*Math.abs(_testAxis.x)+ne.y*Math.abs(_testAxis.y)+ne.z*Math.abs(_testAxis.z),Me=U.dot(_testAxis),ve=Y.dot(_testAxis),se=ie.dot(_testAxis);if(Math.max(-Math.max(Me,ve,se),Math.min(Me,ve,se))>pe)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(U=new Vector3,Y=-1){this.isSphere=!0,this.center=U,this.radius=Y}set(U,Y){return this.center.copy(U),this.radius=Y,this}setFromPoints(U,Y){const ie=this.center;Y!==void 0?ie.copy(Y):_box$3.setFromPoints(U).getCenter(ie);let ne=0;for(let F=0,fe=U.length;F<fe;F++)ne=Math.max(ne,ie.distanceToSquared(U[F]));return this.radius=Math.sqrt(ne),this}copy(U){return this.center.copy(U.center),this.radius=U.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(U){return U.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(U){return U.distanceTo(this.center)-this.radius}intersectsSphere(U){const Y=this.radius+U.radius;return U.center.distanceToSquared(this.center)<=Y*Y}intersectsBox(U){return U.intersectsSphere(this)}intersectsPlane(U){return Math.abs(U.distanceToPoint(this.center))<=this.radius}clampPoint(U,Y){const ie=this.center.distanceToSquared(U);return Y.copy(U),ie>this.radius*this.radius&&(Y.sub(this.center).normalize(),Y.multiplyScalar(this.radius).add(this.center)),Y}getBoundingBox(U){return this.isEmpty()?(U.makeEmpty(),U):(U.set(this.center,this.center),U.expandByScalar(this.radius),U)}applyMatrix4(U){return this.center.applyMatrix4(U),this.radius=this.radius*U.getMaxScaleOnAxis(),this}translate(U){return this.center.add(U),this}expandByPoint(U){if(this.isEmpty())return this.center.copy(U),this.radius=0,this;_v1$6.subVectors(U,this.center);const Y=_v1$6.lengthSq();if(Y>this.radius*this.radius){const ie=Math.sqrt(Y),ne=(ie-this.radius)*.5;this.center.addScaledVector(_v1$6,ne/ie),this.radius+=ne}return this}union(U){return U.isEmpty()?this:this.isEmpty()?(this.copy(U),this):(this.center.equals(U.center)===!0?this.radius=Math.max(this.radius,U.radius):(_v2$3.subVectors(U.center,this.center).setLength(U.radius),this.expandByPoint(_v1$6.copy(U.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(U.center).sub(_v2$3))),this)}equals(U){return U.center.equals(this.center)&&U.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(U=new Vector3,Y=new Vector3(0,0,-1)){this.origin=U,this.direction=Y}set(U,Y){return this.origin.copy(U),this.direction.copy(Y),this}copy(U){return this.origin.copy(U.origin),this.direction.copy(U.direction),this}at(U,Y){return Y.copy(this.origin).addScaledVector(this.direction,U)}lookAt(U){return this.direction.copy(U).sub(this.origin).normalize(),this}recast(U){return this.origin.copy(this.at(U,_vector$a)),this}closestPointToPoint(U,Y){Y.subVectors(U,this.origin);const ie=Y.dot(this.direction);return ie<0?Y.copy(this.origin):Y.copy(this.origin).addScaledVector(this.direction,ie)}distanceToPoint(U){return Math.sqrt(this.distanceSqToPoint(U))}distanceSqToPoint(U){const Y=_vector$a.subVectors(U,this.origin).dot(this.direction);return Y<0?this.origin.distanceToSquared(U):(_vector$a.copy(this.origin).addScaledVector(this.direction,Y),_vector$a.distanceToSquared(U))}distanceSqToSegment(U,Y,ie,ne){_segCenter.copy(U).add(Y).multiplyScalar(.5),_segDir.copy(Y).sub(U).normalize(),_diff.copy(this.origin).sub(_segCenter);const F=U.distanceTo(Y)*.5,fe=-this.direction.dot(_segDir),pe=_diff.dot(this.direction),Me=-_diff.dot(_segDir),ve=_diff.lengthSq(),se=Math.abs(1-fe*fe);let me,Te,Re,be;if(se>0)if(me=fe*Me-pe,Te=fe*pe-Me,be=F*se,me>=0)if(Te>=-be)if(Te<=be){const Pe=1/se;me*=Pe,Te*=Pe,Re=me*(me+fe*Te+2*pe)+Te*(fe*me+Te+2*Me)+ve}else Te=F,me=Math.max(0,-(fe*Te+pe)),Re=-me*me+Te*(Te+2*Me)+ve;else Te=-F,me=Math.max(0,-(fe*Te+pe)),Re=-me*me+Te*(Te+2*Me)+ve;else Te<=-be?(me=Math.max(0,-(-fe*F+pe)),Te=me>0?-F:Math.min(Math.max(-F,-Me),F),Re=-me*me+Te*(Te+2*Me)+ve):Te<=be?(me=0,Te=Math.min(Math.max(-F,-Me),F),Re=Te*(Te+2*Me)+ve):(me=Math.max(0,-(fe*F+pe)),Te=me>0?F:Math.min(Math.max(-F,-Me),F),Re=-me*me+Te*(Te+2*Me)+ve);else Te=fe>0?-F:F,me=Math.max(0,-(fe*Te+pe)),Re=-me*me+Te*(Te+2*Me)+ve;return ie&&ie.copy(this.origin).addScaledVector(this.direction,me),ne&&ne.copy(_segCenter).addScaledVector(_segDir,Te),Re}intersectSphere(U,Y){_vector$a.subVectors(U.center,this.origin);const ie=_vector$a.dot(this.direction),ne=_vector$a.dot(_vector$a)-ie*ie,F=U.radius*U.radius;if(ne>F)return null;const fe=Math.sqrt(F-ne),pe=ie-fe,Me=ie+fe;return Me<0?null:pe<0?this.at(Me,Y):this.at(pe,Y)}intersectsSphere(U){return this.distanceSqToPoint(U.center)<=U.radius*U.radius}distanceToPlane(U){const Y=U.normal.dot(this.direction);if(Y===0)return U.distanceToPoint(this.origin)===0?0:null;const ie=-(this.origin.dot(U.normal)+U.constant)/Y;return ie>=0?ie:null}intersectPlane(U,Y){const ie=this.distanceToPlane(U);return ie===null?null:this.at(ie,Y)}intersectsPlane(U){const Y=U.distanceToPoint(this.origin);return Y===0||U.normal.dot(this.direction)*Y<0}intersectBox(U,Y){let ie,ne,F,fe,pe,Me;const ve=1/this.direction.x,se=1/this.direction.y,me=1/this.direction.z,Te=this.origin;return ve>=0?(ie=(U.min.x-Te.x)*ve,ne=(U.max.x-Te.x)*ve):(ie=(U.max.x-Te.x)*ve,ne=(U.min.x-Te.x)*ve),se>=0?(F=(U.min.y-Te.y)*se,fe=(U.max.y-Te.y)*se):(F=(U.max.y-Te.y)*se,fe=(U.min.y-Te.y)*se),ie>fe||F>ne||((F>ie||isNaN(ie))&&(ie=F),(fe<ne||isNaN(ne))&&(ne=fe),me>=0?(pe=(U.min.z-Te.z)*me,Me=(U.max.z-Te.z)*me):(pe=(U.max.z-Te.z)*me,Me=(U.min.z-Te.z)*me),ie>Me||pe>ne)||((pe>ie||ie!==ie)&&(ie=pe),(Me<ne||ne!==ne)&&(ne=Me),ne<0)?null:this.at(ie>=0?ie:ne,Y)}intersectsBox(U){return this.intersectBox(U,_vector$a)!==null}intersectTriangle(U,Y,ie,ne,F){_edge1.subVectors(Y,U),_edge2.subVectors(ie,U),_normal$1.crossVectors(_edge1,_edge2);let fe=this.direction.dot(_normal$1),pe;if(fe>0){if(ne)return null;pe=1}else if(fe<0)pe=-1,fe=-fe;else return null;_diff.subVectors(this.origin,U);const Me=pe*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(Me<0)return null;const ve=pe*this.direction.dot(_edge1.cross(_diff));if(ve<0||Me+ve>fe)return null;const se=-pe*_diff.dot(_normal$1);return se<0?null:this.at(se/fe,F)}applyMatrix4(U){return this.origin.applyMatrix4(U),this.direction.transformDirection(U),this}equals(U){return U.origin.equals(this.origin)&&U.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],U!==void 0&&this.set(U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le)}set(U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le){const xe=this.elements;return xe[0]=U,xe[4]=Y,xe[8]=ie,xe[12]=ne,xe[1]=F,xe[5]=fe,xe[9]=pe,xe[13]=Me,xe[2]=ve,xe[6]=se,xe[10]=me,xe[14]=Te,xe[3]=Re,xe[7]=be,xe[11]=Pe,xe[15]=Le,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(U){const Y=this.elements,ie=U.elements;return Y[0]=ie[0],Y[1]=ie[1],Y[2]=ie[2],Y[3]=ie[3],Y[4]=ie[4],Y[5]=ie[5],Y[6]=ie[6],Y[7]=ie[7],Y[8]=ie[8],Y[9]=ie[9],Y[10]=ie[10],Y[11]=ie[11],Y[12]=ie[12],Y[13]=ie[13],Y[14]=ie[14],Y[15]=ie[15],this}copyPosition(U){const Y=this.elements,ie=U.elements;return Y[12]=ie[12],Y[13]=ie[13],Y[14]=ie[14],this}setFromMatrix3(U){const Y=U.elements;return this.set(Y[0],Y[3],Y[6],0,Y[1],Y[4],Y[7],0,Y[2],Y[5],Y[8],0,0,0,0,1),this}extractBasis(U,Y,ie){return U.setFromMatrixColumn(this,0),Y.setFromMatrixColumn(this,1),ie.setFromMatrixColumn(this,2),this}makeBasis(U,Y,ie){return this.set(U.x,Y.x,ie.x,0,U.y,Y.y,ie.y,0,U.z,Y.z,ie.z,0,0,0,0,1),this}extractRotation(U){const Y=this.elements,ie=U.elements,ne=1/_v1$5.setFromMatrixColumn(U,0).length(),F=1/_v1$5.setFromMatrixColumn(U,1).length(),fe=1/_v1$5.setFromMatrixColumn(U,2).length();return Y[0]=ie[0]*ne,Y[1]=ie[1]*ne,Y[2]=ie[2]*ne,Y[3]=0,Y[4]=ie[4]*F,Y[5]=ie[5]*F,Y[6]=ie[6]*F,Y[7]=0,Y[8]=ie[8]*fe,Y[9]=ie[9]*fe,Y[10]=ie[10]*fe,Y[11]=0,Y[12]=0,Y[13]=0,Y[14]=0,Y[15]=1,this}makeRotationFromEuler(U){const Y=this.elements,ie=U.x,ne=U.y,F=U.z,fe=Math.cos(ie),pe=Math.sin(ie),Me=Math.cos(ne),ve=Math.sin(ne),se=Math.cos(F),me=Math.sin(F);if(U.order==="XYZ"){const Te=fe*se,Re=fe*me,be=pe*se,Pe=pe*me;Y[0]=Me*se,Y[4]=-Me*me,Y[8]=ve,Y[1]=Re+be*ve,Y[5]=Te-Pe*ve,Y[9]=-pe*Me,Y[2]=Pe-Te*ve,Y[6]=be+Re*ve,Y[10]=fe*Me}else if(U.order==="YXZ"){const Te=Me*se,Re=Me*me,be=ve*se,Pe=ve*me;Y[0]=Te+Pe*pe,Y[4]=be*pe-Re,Y[8]=fe*ve,Y[1]=fe*me,Y[5]=fe*se,Y[9]=-pe,Y[2]=Re*pe-be,Y[6]=Pe+Te*pe,Y[10]=fe*Me}else if(U.order==="ZXY"){const Te=Me*se,Re=Me*me,be=ve*se,Pe=ve*me;Y[0]=Te-Pe*pe,Y[4]=-fe*me,Y[8]=be+Re*pe,Y[1]=Re+be*pe,Y[5]=fe*se,Y[9]=Pe-Te*pe,Y[2]=-fe*ve,Y[6]=pe,Y[10]=fe*Me}else if(U.order==="ZYX"){const Te=fe*se,Re=fe*me,be=pe*se,Pe=pe*me;Y[0]=Me*se,Y[4]=be*ve-Re,Y[8]=Te*ve+Pe,Y[1]=Me*me,Y[5]=Pe*ve+Te,Y[9]=Re*ve-be,Y[2]=-ve,Y[6]=pe*Me,Y[10]=fe*Me}else if(U.order==="YZX"){const Te=fe*Me,Re=fe*ve,be=pe*Me,Pe=pe*ve;Y[0]=Me*se,Y[4]=Pe-Te*me,Y[8]=be*me+Re,Y[1]=me,Y[5]=fe*se,Y[9]=-pe*se,Y[2]=-ve*se,Y[6]=Re*me+be,Y[10]=Te-Pe*me}else if(U.order==="XZY"){const Te=fe*Me,Re=fe*ve,be=pe*Me,Pe=pe*ve;Y[0]=Me*se,Y[4]=-me,Y[8]=ve*se,Y[1]=Te*me+Pe,Y[5]=fe*se,Y[9]=Re*me-be,Y[2]=be*me-Re,Y[6]=pe*se,Y[10]=Pe*me+Te}return Y[3]=0,Y[7]=0,Y[11]=0,Y[12]=0,Y[13]=0,Y[14]=0,Y[15]=1,this}makeRotationFromQuaternion(U){return this.compose(_zero,U,_one)}lookAt(U,Y,ie){const ne=this.elements;return _z.subVectors(U,Y),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(ie,_z),_x.lengthSq()===0&&(Math.abs(ie.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(ie,_z)),_x.normalize(),_y.crossVectors(_z,_x),ne[0]=_x.x,ne[4]=_y.x,ne[8]=_z.x,ne[1]=_x.y,ne[5]=_y.y,ne[9]=_z.y,ne[2]=_x.z,ne[6]=_y.z,ne[10]=_z.z,this}multiply(U){return this.multiplyMatrices(this,U)}premultiply(U){return this.multiplyMatrices(U,this)}multiplyMatrices(U,Y){const ie=U.elements,ne=Y.elements,F=this.elements,fe=ie[0],pe=ie[4],Me=ie[8],ve=ie[12],se=ie[1],me=ie[5],Te=ie[9],Re=ie[13],be=ie[2],Pe=ie[6],Le=ie[10],xe=ie[14],Fe=ie[3],Oe=ie[7],Ne=ie[11],ke=ie[15],Ve=ne[0],Xe=ne[4],$e=ne[8],st=ne[12],ze=ne[1],tt=ne[5],ft=ne[9],Rt=ne[13],Mt=ne[2],Gt=ne[6],_t=ne[10],Bt=ne[14],dt=ne[3],ut=ne[7],Ut=ne[11],Tt=ne[15];return F[0]=fe*Ve+pe*ze+Me*Mt+ve*dt,F[4]=fe*Xe+pe*tt+Me*Gt+ve*ut,F[8]=fe*$e+pe*ft+Me*_t+ve*Ut,F[12]=fe*st+pe*Rt+Me*Bt+ve*Tt,F[1]=se*Ve+me*ze+Te*Mt+Re*dt,F[5]=se*Xe+me*tt+Te*Gt+Re*ut,F[9]=se*$e+me*ft+Te*_t+Re*Ut,F[13]=se*st+me*Rt+Te*Bt+Re*Tt,F[2]=be*Ve+Pe*ze+Le*Mt+xe*dt,F[6]=be*Xe+Pe*tt+Le*Gt+xe*ut,F[10]=be*$e+Pe*ft+Le*_t+xe*Ut,F[14]=be*st+Pe*Rt+Le*Bt+xe*Tt,F[3]=Fe*Ve+Oe*ze+Ne*Mt+ke*dt,F[7]=Fe*Xe+Oe*tt+Ne*Gt+ke*ut,F[11]=Fe*$e+Oe*ft+Ne*_t+ke*Ut,F[15]=Fe*st+Oe*Rt+Ne*Bt+ke*Tt,this}multiplyScalar(U){const Y=this.elements;return Y[0]*=U,Y[4]*=U,Y[8]*=U,Y[12]*=U,Y[1]*=U,Y[5]*=U,Y[9]*=U,Y[13]*=U,Y[2]*=U,Y[6]*=U,Y[10]*=U,Y[14]*=U,Y[3]*=U,Y[7]*=U,Y[11]*=U,Y[15]*=U,this}determinant(){const U=this.elements,Y=U[0],ie=U[4],ne=U[8],F=U[12],fe=U[1],pe=U[5],Me=U[9],ve=U[13],se=U[2],me=U[6],Te=U[10],Re=U[14],be=U[3],Pe=U[7],Le=U[11],xe=U[15];return be*(+F*Me*me-ne*ve*me-F*pe*Te+ie*ve*Te+ne*pe*Re-ie*Me*Re)+Pe*(+Y*Me*Re-Y*ve*Te+F*fe*Te-ne*fe*Re+ne*ve*se-F*Me*se)+Le*(+Y*ve*me-Y*pe*Re-F*fe*me+ie*fe*Re+F*pe*se-ie*ve*se)+xe*(-ne*pe*se-Y*Me*me+Y*pe*Te+ne*fe*me-ie*fe*Te+ie*Me*se)}transpose(){const U=this.elements;let Y;return Y=U[1],U[1]=U[4],U[4]=Y,Y=U[2],U[2]=U[8],U[8]=Y,Y=U[6],U[6]=U[9],U[9]=Y,Y=U[3],U[3]=U[12],U[12]=Y,Y=U[7],U[7]=U[13],U[13]=Y,Y=U[11],U[11]=U[14],U[14]=Y,this}setPosition(U,Y,ie){const ne=this.elements;return U.isVector3?(ne[12]=U.x,ne[13]=U.y,ne[14]=U.z):(ne[12]=U,ne[13]=Y,ne[14]=ie),this}invert(){const U=this.elements,Y=U[0],ie=U[1],ne=U[2],F=U[3],fe=U[4],pe=U[5],Me=U[6],ve=U[7],se=U[8],me=U[9],Te=U[10],Re=U[11],be=U[12],Pe=U[13],Le=U[14],xe=U[15],Fe=me*Le*ve-Pe*Te*ve+Pe*Me*Re-pe*Le*Re-me*Me*xe+pe*Te*xe,Oe=be*Te*ve-se*Le*ve-be*Me*Re+fe*Le*Re+se*Me*xe-fe*Te*xe,Ne=se*Pe*ve-be*me*ve+be*pe*Re-fe*Pe*Re-se*pe*xe+fe*me*xe,ke=be*me*Me-se*Pe*Me-be*pe*Te+fe*Pe*Te+se*pe*Le-fe*me*Le,Ve=Y*Fe+ie*Oe+ne*Ne+F*ke;if(Ve===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Xe=1/Ve;return U[0]=Fe*Xe,U[1]=(Pe*Te*F-me*Le*F-Pe*ne*Re+ie*Le*Re+me*ne*xe-ie*Te*xe)*Xe,U[2]=(pe*Le*F-Pe*Me*F+Pe*ne*ve-ie*Le*ve-pe*ne*xe+ie*Me*xe)*Xe,U[3]=(me*Me*F-pe*Te*F-me*ne*ve+ie*Te*ve+pe*ne*Re-ie*Me*Re)*Xe,U[4]=Oe*Xe,U[5]=(se*Le*F-be*Te*F+be*ne*Re-Y*Le*Re-se*ne*xe+Y*Te*xe)*Xe,U[6]=(be*Me*F-fe*Le*F-be*ne*ve+Y*Le*ve+fe*ne*xe-Y*Me*xe)*Xe,U[7]=(fe*Te*F-se*Me*F+se*ne*ve-Y*Te*ve-fe*ne*Re+Y*Me*Re)*Xe,U[8]=Ne*Xe,U[9]=(be*me*F-se*Pe*F-be*ie*Re+Y*Pe*Re+se*ie*xe-Y*me*xe)*Xe,U[10]=(fe*Pe*F-be*pe*F+be*ie*ve-Y*Pe*ve-fe*ie*xe+Y*pe*xe)*Xe,U[11]=(se*pe*F-fe*me*F-se*ie*ve+Y*me*ve+fe*ie*Re-Y*pe*Re)*Xe,U[12]=ke*Xe,U[13]=(se*Pe*ne-be*me*ne+be*ie*Te-Y*Pe*Te-se*ie*Le+Y*me*Le)*Xe,U[14]=(be*pe*ne-fe*Pe*ne-be*ie*Me+Y*Pe*Me+fe*ie*Le-Y*pe*Le)*Xe,U[15]=(fe*me*ne-se*pe*ne+se*ie*Me-Y*me*Me-fe*ie*Te+Y*pe*Te)*Xe,this}scale(U){const Y=this.elements,ie=U.x,ne=U.y,F=U.z;return Y[0]*=ie,Y[4]*=ne,Y[8]*=F,Y[1]*=ie,Y[5]*=ne,Y[9]*=F,Y[2]*=ie,Y[6]*=ne,Y[10]*=F,Y[3]*=ie,Y[7]*=ne,Y[11]*=F,this}getMaxScaleOnAxis(){const U=this.elements,Y=U[0]*U[0]+U[1]*U[1]+U[2]*U[2],ie=U[4]*U[4]+U[5]*U[5]+U[6]*U[6],ne=U[8]*U[8]+U[9]*U[9]+U[10]*U[10];return Math.sqrt(Math.max(Y,ie,ne))}makeTranslation(U,Y,ie){return U.isVector3?this.set(1,0,0,U.x,0,1,0,U.y,0,0,1,U.z,0,0,0,1):this.set(1,0,0,U,0,1,0,Y,0,0,1,ie,0,0,0,1),this}makeRotationX(U){const Y=Math.cos(U),ie=Math.sin(U);return this.set(1,0,0,0,0,Y,-ie,0,0,ie,Y,0,0,0,0,1),this}makeRotationY(U){const Y=Math.cos(U),ie=Math.sin(U);return this.set(Y,0,ie,0,0,1,0,0,-ie,0,Y,0,0,0,0,1),this}makeRotationZ(U){const Y=Math.cos(U),ie=Math.sin(U);return this.set(Y,-ie,0,0,ie,Y,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(U,Y){const ie=Math.cos(Y),ne=Math.sin(Y),F=1-ie,fe=U.x,pe=U.y,Me=U.z,ve=F*fe,se=F*pe;return this.set(ve*fe+ie,ve*pe-ne*Me,ve*Me+ne*pe,0,ve*pe+ne*Me,se*pe+ie,se*Me-ne*fe,0,ve*Me-ne*pe,se*Me+ne*fe,F*Me*Me+ie,0,0,0,0,1),this}makeScale(U,Y,ie){return this.set(U,0,0,0,0,Y,0,0,0,0,ie,0,0,0,0,1),this}makeShear(U,Y,ie,ne,F,fe){return this.set(1,ie,F,0,U,1,fe,0,Y,ne,1,0,0,0,0,1),this}compose(U,Y,ie){const ne=this.elements,F=Y._x,fe=Y._y,pe=Y._z,Me=Y._w,ve=F+F,se=fe+fe,me=pe+pe,Te=F*ve,Re=F*se,be=F*me,Pe=fe*se,Le=fe*me,xe=pe*me,Fe=Me*ve,Oe=Me*se,Ne=Me*me,ke=ie.x,Ve=ie.y,Xe=ie.z;return ne[0]=(1-(Pe+xe))*ke,ne[1]=(Re+Ne)*ke,ne[2]=(be-Oe)*ke,ne[3]=0,ne[4]=(Re-Ne)*Ve,ne[5]=(1-(Te+xe))*Ve,ne[6]=(Le+Fe)*Ve,ne[7]=0,ne[8]=(be+Oe)*Xe,ne[9]=(Le-Fe)*Xe,ne[10]=(1-(Te+Pe))*Xe,ne[11]=0,ne[12]=U.x,ne[13]=U.y,ne[14]=U.z,ne[15]=1,this}decompose(U,Y,ie){const ne=this.elements;let F=_v1$5.set(ne[0],ne[1],ne[2]).length();const fe=_v1$5.set(ne[4],ne[5],ne[6]).length(),pe=_v1$5.set(ne[8],ne[9],ne[10]).length();this.determinant()<0&&(F=-F),U.x=ne[12],U.y=ne[13],U.z=ne[14],_m1$4.copy(this);const ve=1/F,se=1/fe,me=1/pe;return _m1$4.elements[0]*=ve,_m1$4.elements[1]*=ve,_m1$4.elements[2]*=ve,_m1$4.elements[4]*=se,_m1$4.elements[5]*=se,_m1$4.elements[6]*=se,_m1$4.elements[8]*=me,_m1$4.elements[9]*=me,_m1$4.elements[10]*=me,Y.setFromRotationMatrix(_m1$4),ie.x=F,ie.y=fe,ie.z=pe,this}makePerspective(U,Y,ie,ne,F,fe,pe=WebGLCoordinateSystem){const Me=this.elements,ve=2*F/(Y-U),se=2*F/(ie-ne),me=(Y+U)/(Y-U),Te=(ie+ne)/(ie-ne);let Re,be;if(pe===WebGLCoordinateSystem)Re=-(fe+F)/(fe-F),be=-2*fe*F/(fe-F);else if(pe===WebGPUCoordinateSystem)Re=-fe/(fe-F),be=-fe*F/(fe-F);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+pe);return Me[0]=ve,Me[4]=0,Me[8]=me,Me[12]=0,Me[1]=0,Me[5]=se,Me[9]=Te,Me[13]=0,Me[2]=0,Me[6]=0,Me[10]=Re,Me[14]=be,Me[3]=0,Me[7]=0,Me[11]=-1,Me[15]=0,this}makeOrthographic(U,Y,ie,ne,F,fe,pe=WebGLCoordinateSystem){const Me=this.elements,ve=1/(Y-U),se=1/(ie-ne),me=1/(fe-F),Te=(Y+U)*ve,Re=(ie+ne)*se;let be,Pe;if(pe===WebGLCoordinateSystem)be=(fe+F)*me,Pe=-2*me;else if(pe===WebGPUCoordinateSystem)be=F*me,Pe=-1*me;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+pe);return Me[0]=2*ve,Me[4]=0,Me[8]=0,Me[12]=-Te,Me[1]=0,Me[5]=2*se,Me[9]=0,Me[13]=-Re,Me[2]=0,Me[6]=0,Me[10]=Pe,Me[14]=-be,Me[3]=0,Me[7]=0,Me[11]=0,Me[15]=1,this}equals(U){const Y=this.elements,ie=U.elements;for(let ne=0;ne<16;ne++)if(Y[ne]!==ie[ne])return!1;return!0}fromArray(U,Y=0){for(let ie=0;ie<16;ie++)this.elements[ie]=U[ie+Y];return this}toArray(U=[],Y=0){const ie=this.elements;return U[Y]=ie[0],U[Y+1]=ie[1],U[Y+2]=ie[2],U[Y+3]=ie[3],U[Y+4]=ie[4],U[Y+5]=ie[5],U[Y+6]=ie[6],U[Y+7]=ie[7],U[Y+8]=ie[8],U[Y+9]=ie[9],U[Y+10]=ie[10],U[Y+11]=ie[11],U[Y+12]=ie[12],U[Y+13]=ie[13],U[Y+14]=ie[14],U[Y+15]=ie[15],U}}const _v1$5=new Vector3,_m1$4=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(U=0,Y=0,ie=0,ne=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=U,this._y=Y,this._z=ie,this._order=ne}get x(){return this._x}set x(U){this._x=U,this._onChangeCallback()}get y(){return this._y}set y(U){this._y=U,this._onChangeCallback()}get z(){return this._z}set z(U){this._z=U,this._onChangeCallback()}get order(){return this._order}set order(U){this._order=U,this._onChangeCallback()}set(U,Y,ie,ne=this._order){return this._x=U,this._y=Y,this._z=ie,this._order=ne,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(U){return this._x=U._x,this._y=U._y,this._z=U._z,this._order=U._order,this._onChangeCallback(),this}setFromRotationMatrix(U,Y=this._order,ie=!0){const ne=U.elements,F=ne[0],fe=ne[4],pe=ne[8],Me=ne[1],ve=ne[5],se=ne[9],me=ne[2],Te=ne[6],Re=ne[10];switch(Y){case"XYZ":this._y=Math.asin(clamp$1(pe,-1,1)),Math.abs(pe)<.9999999?(this._x=Math.atan2(-se,Re),this._z=Math.atan2(-fe,F)):(this._x=Math.atan2(Te,ve),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$1(se,-1,1)),Math.abs(se)<.9999999?(this._y=Math.atan2(pe,Re),this._z=Math.atan2(Me,ve)):(this._y=Math.atan2(-me,F),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$1(Te,-1,1)),Math.abs(Te)<.9999999?(this._y=Math.atan2(-me,Re),this._z=Math.atan2(-fe,ve)):(this._y=0,this._z=Math.atan2(Me,F));break;case"ZYX":this._y=Math.asin(-clamp$1(me,-1,1)),Math.abs(me)<.9999999?(this._x=Math.atan2(Te,Re),this._z=Math.atan2(Me,F)):(this._x=0,this._z=Math.atan2(-fe,ve));break;case"YZX":this._z=Math.asin(clamp$1(Me,-1,1)),Math.abs(Me)<.9999999?(this._x=Math.atan2(-se,ve),this._y=Math.atan2(-me,F)):(this._x=0,this._y=Math.atan2(pe,Re));break;case"XZY":this._z=Math.asin(-clamp$1(fe,-1,1)),Math.abs(fe)<.9999999?(this._x=Math.atan2(Te,ve),this._y=Math.atan2(pe,F)):(this._x=Math.atan2(-se,Re),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+Y)}return this._order=Y,ie===!0&&this._onChangeCallback(),this}setFromQuaternion(U,Y,ie){return _matrix$2.makeRotationFromQuaternion(U),this.setFromRotationMatrix(_matrix$2,Y,ie)}setFromVector3(U,Y=this._order){return this.set(U.x,U.y,U.z,Y)}reorder(U){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,U)}equals(U){return U._x===this._x&&U._y===this._y&&U._z===this._z&&U._order===this._order}fromArray(U){return this._x=U[0],this._y=U[1],this._z=U[2],U[3]!==void 0&&(this._order=U[3]),this._onChangeCallback(),this}toArray(U=[],Y=0){return U[Y]=this._x,U[Y+1]=this._y,U[Y+2]=this._z,U[Y+3]=this._order,U}_onChange(U){return this._onChangeCallback=U,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(U){this.mask=(1<<U|0)>>>0}enable(U){this.mask|=1<<U|0}enableAll(){this.mask=-1}toggle(U){this.mask^=1<<U|0}disable(U){this.mask&=~(1<<U|0)}disableAll(){this.mask=0}test(U){return(this.mask&U.mask)!==0}isEnabled(U){return(this.mask&(1<<U|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$3=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const U=new Vector3,Y=new Euler,ie=new Quaternion,ne=new Vector3(1,1,1);function F(){ie.setFromEuler(Y,!1)}function fe(){Y.setFromQuaternion(ie,void 0,!1)}Y._onChange(F),ie._onChange(fe),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:U},rotation:{configurable:!0,enumerable:!0,value:Y},quaternion:{configurable:!0,enumerable:!0,value:ie},scale:{configurable:!0,enumerable:!0,value:ne},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(U){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(U),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(U){return this.quaternion.premultiply(U),this}setRotationFromAxisAngle(U,Y){this.quaternion.setFromAxisAngle(U,Y)}setRotationFromEuler(U){this.quaternion.setFromEuler(U,!0)}setRotationFromMatrix(U){this.quaternion.setFromRotationMatrix(U)}setRotationFromQuaternion(U){this.quaternion.copy(U)}rotateOnAxis(U,Y){return _q1.setFromAxisAngle(U,Y),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(U,Y){return _q1.setFromAxisAngle(U,Y),this.quaternion.premultiply(_q1),this}rotateX(U){return this.rotateOnAxis(_xAxis,U)}rotateY(U){return this.rotateOnAxis(_yAxis,U)}rotateZ(U){return this.rotateOnAxis(_zAxis,U)}translateOnAxis(U,Y){return _v1$4.copy(U).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(Y)),this}translateX(U){return this.translateOnAxis(_xAxis,U)}translateY(U){return this.translateOnAxis(_yAxis,U)}translateZ(U){return this.translateOnAxis(_zAxis,U)}localToWorld(U){return this.updateWorldMatrix(!0,!1),U.applyMatrix4(this.matrixWorld)}worldToLocal(U){return this.updateWorldMatrix(!0,!1),U.applyMatrix4(_m1$3.copy(this.matrixWorld).invert())}lookAt(U,Y,ie){U.isVector3?_target.copy(U):_target.set(U,Y,ie);const ne=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$3.lookAt(_position$3,_target,this.up):_m1$3.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$3),ne&&(_m1$3.extractRotation(ne.matrixWorld),_q1.setFromRotationMatrix(_m1$3),this.quaternion.premultiply(_q1.invert()))}add(U){if(arguments.length>1){for(let Y=0;Y<arguments.length;Y++)this.add(arguments[Y]);return this}return U===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",U),this):(U&&U.isObject3D?(U.removeFromParent(),U.parent=this,this.children.push(U),U.dispatchEvent(_addedEvent),_childaddedEvent.child=U,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",U),this)}remove(U){if(arguments.length>1){for(let ie=0;ie<arguments.length;ie++)this.remove(arguments[ie]);return this}const Y=this.children.indexOf(U);return Y!==-1&&(U.parent=null,this.children.splice(Y,1),U.dispatchEvent(_removedEvent),_childremovedEvent.child=U,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const U=this.parent;return U!==null&&U.remove(this),this}clear(){return this.remove(...this.children)}attach(U){return this.updateWorldMatrix(!0,!1),_m1$3.copy(this.matrixWorld).invert(),U.parent!==null&&(U.parent.updateWorldMatrix(!0,!1),_m1$3.multiply(U.parent.matrixWorld)),U.applyMatrix4(_m1$3),U.removeFromParent(),U.parent=this,this.children.push(U),U.updateWorldMatrix(!1,!0),U.dispatchEvent(_addedEvent),_childaddedEvent.child=U,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(U){return this.getObjectByProperty("id",U)}getObjectByName(U){return this.getObjectByProperty("name",U)}getObjectByProperty(U,Y){if(this[U]===Y)return this;for(let ie=0,ne=this.children.length;ie<ne;ie++){const fe=this.children[ie].getObjectByProperty(U,Y);if(fe!==void 0)return fe}}getObjectsByProperty(U,Y,ie=[]){this[U]===Y&&ie.push(this);const ne=this.children;for(let F=0,fe=ne.length;F<fe;F++)ne[F].getObjectsByProperty(U,Y,ie);return ie}getWorldPosition(U){return this.updateWorldMatrix(!0,!1),U.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(U){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,U,_scale$2),U}getWorldScale(U){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,U),U}getWorldDirection(U){this.updateWorldMatrix(!0,!1);const Y=this.matrixWorld.elements;return U.set(Y[8],Y[9],Y[10]).normalize()}raycast(){}traverse(U){U(this);const Y=this.children;for(let ie=0,ne=Y.length;ie<ne;ie++)Y[ie].traverse(U)}traverseVisible(U){if(this.visible===!1)return;U(this);const Y=this.children;for(let ie=0,ne=Y.length;ie<ne;ie++)Y[ie].traverseVisible(U)}traverseAncestors(U){const Y=this.parent;Y!==null&&(U(Y),Y.traverseAncestors(U))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(U){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||U)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,U=!0);const Y=this.children;for(let ie=0,ne=Y.length;ie<ne;ie++)Y[ie].updateMatrixWorld(U)}updateWorldMatrix(U,Y){const ie=this.parent;if(U===!0&&ie!==null&&ie.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),Y===!0){const ne=this.children;for(let F=0,fe=ne.length;F<fe;F++)ne[F].updateWorldMatrix(!1,!0)}}toJSON(U){const Y=U===void 0||typeof U=="string",ie={};Y&&(U={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},ie.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const ne={};ne.uuid=this.uuid,ne.type=this.type,this.name!==""&&(ne.name=this.name),this.castShadow===!0&&(ne.castShadow=!0),this.receiveShadow===!0&&(ne.receiveShadow=!0),this.visible===!1&&(ne.visible=!1),this.frustumCulled===!1&&(ne.frustumCulled=!1),this.renderOrder!==0&&(ne.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(ne.userData=this.userData),ne.layers=this.layers.mask,ne.matrix=this.matrix.toArray(),ne.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(ne.matrixAutoUpdate=!1),this.isInstancedMesh&&(ne.type="InstancedMesh",ne.count=this.count,ne.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(ne.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(ne.type="BatchedMesh",ne.perObjectFrustumCulled=this.perObjectFrustumCulled,ne.sortObjects=this.sortObjects,ne.drawRanges=this._drawRanges,ne.reservedRanges=this._reservedRanges,ne.visibility=this._visibility,ne.active=this._active,ne.bounds=this._bounds.map(pe=>({boxInitialized:pe.boxInitialized,boxMin:pe.box.min.toArray(),boxMax:pe.box.max.toArray(),sphereInitialized:pe.sphereInitialized,sphereRadius:pe.sphere.radius,sphereCenter:pe.sphere.center.toArray()})),ne.maxInstanceCount=this._maxInstanceCount,ne.maxVertexCount=this._maxVertexCount,ne.maxIndexCount=this._maxIndexCount,ne.geometryInitialized=this._geometryInitialized,ne.geometryCount=this._geometryCount,ne.matricesTexture=this._matricesTexture.toJSON(U),this._colorsTexture!==null&&(ne.colorsTexture=this._colorsTexture.toJSON(U)),this.boundingSphere!==null&&(ne.boundingSphere={center:ne.boundingSphere.center.toArray(),radius:ne.boundingSphere.radius}),this.boundingBox!==null&&(ne.boundingBox={min:ne.boundingBox.min.toArray(),max:ne.boundingBox.max.toArray()}));function F(pe,Me){return pe[Me.uuid]===void 0&&(pe[Me.uuid]=Me.toJSON(U)),Me.uuid}if(this.isScene)this.background&&(this.background.isColor?ne.background=this.background.toJSON():this.background.isTexture&&(ne.background=this.background.toJSON(U).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(ne.environment=this.environment.toJSON(U).uuid);else if(this.isMesh||this.isLine||this.isPoints){ne.geometry=F(U.geometries,this.geometry);const pe=this.geometry.parameters;if(pe!==void 0&&pe.shapes!==void 0){const Me=pe.shapes;if(Array.isArray(Me))for(let ve=0,se=Me.length;ve<se;ve++){const me=Me[ve];F(U.shapes,me)}else F(U.shapes,Me)}}if(this.isSkinnedMesh&&(ne.bindMode=this.bindMode,ne.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(F(U.skeletons,this.skeleton),ne.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const pe=[];for(let Me=0,ve=this.material.length;Me<ve;Me++)pe.push(F(U.materials,this.material[Me]));ne.material=pe}else ne.material=F(U.materials,this.material);if(this.children.length>0){ne.children=[];for(let pe=0;pe<this.children.length;pe++)ne.children.push(this.children[pe].toJSON(U).object)}if(this.animations.length>0){ne.animations=[];for(let pe=0;pe<this.animations.length;pe++){const Me=this.animations[pe];ne.animations.push(F(U.animations,Me))}}if(Y){const pe=fe(U.geometries),Me=fe(U.materials),ve=fe(U.textures),se=fe(U.images),me=fe(U.shapes),Te=fe(U.skeletons),Re=fe(U.animations),be=fe(U.nodes);pe.length>0&&(ie.geometries=pe),Me.length>0&&(ie.materials=Me),ve.length>0&&(ie.textures=ve),se.length>0&&(ie.images=se),me.length>0&&(ie.shapes=me),Te.length>0&&(ie.skeletons=Te),Re.length>0&&(ie.animations=Re),be.length>0&&(ie.nodes=be)}return ie.object=ne,ie;function fe(pe){const Me=[];for(const ve in pe){const se=pe[ve];delete se.metadata,Me.push(se)}return Me}}clone(U){return new this.constructor().copy(this,U)}copy(U,Y=!0){if(this.name=U.name,this.up.copy(U.up),this.position.copy(U.position),this.rotation.order=U.rotation.order,this.quaternion.copy(U.quaternion),this.scale.copy(U.scale),this.matrix.copy(U.matrix),this.matrixWorld.copy(U.matrixWorld),this.matrixAutoUpdate=U.matrixAutoUpdate,this.matrixWorldAutoUpdate=U.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=U.matrixWorldNeedsUpdate,this.layers.mask=U.layers.mask,this.visible=U.visible,this.castShadow=U.castShadow,this.receiveShadow=U.receiveShadow,this.frustumCulled=U.frustumCulled,this.renderOrder=U.renderOrder,this.animations=U.animations.slice(),this.userData=JSON.parse(JSON.stringify(U.userData)),Y===!0)for(let ie=0;ie<U.children.length;ie++){const ne=U.children[ie];this.add(ne.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$2=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3,_v40=new Vector4,_v41=new Vector4,_v42=new Vector4;class Triangle{constructor(U=new Vector3,Y=new Vector3,ie=new Vector3){this.a=U,this.b=Y,this.c=ie}static getNormal(U,Y,ie,ne){ne.subVectors(ie,Y),_v0$2.subVectors(U,Y),ne.cross(_v0$2);const F=ne.lengthSq();return F>0?ne.multiplyScalar(1/Math.sqrt(F)):ne.set(0,0,0)}static getBarycoord(U,Y,ie,ne,F){_v0$2.subVectors(ne,Y),_v1$3.subVectors(ie,Y),_v2$2.subVectors(U,Y);const fe=_v0$2.dot(_v0$2),pe=_v0$2.dot(_v1$3),Me=_v0$2.dot(_v2$2),ve=_v1$3.dot(_v1$3),se=_v1$3.dot(_v2$2),me=fe*ve-pe*pe;if(me===0)return F.set(0,0,0),null;const Te=1/me,Re=(ve*Me-pe*se)*Te,be=(fe*se-pe*Me)*Te;return F.set(1-Re-be,be,Re)}static containsPoint(U,Y,ie,ne){return this.getBarycoord(U,Y,ie,ne,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(U,Y,ie,ne,F,fe,pe,Me){return this.getBarycoord(U,Y,ie,ne,_v3$2)===null?(Me.x=0,Me.y=0,"z"in Me&&(Me.z=0),"w"in Me&&(Me.w=0),null):(Me.setScalar(0),Me.addScaledVector(F,_v3$2.x),Me.addScaledVector(fe,_v3$2.y),Me.addScaledVector(pe,_v3$2.z),Me)}static getInterpolatedAttribute(U,Y,ie,ne,F,fe){return _v40.setScalar(0),_v41.setScalar(0),_v42.setScalar(0),_v40.fromBufferAttribute(U,Y),_v41.fromBufferAttribute(U,ie),_v42.fromBufferAttribute(U,ne),fe.setScalar(0),fe.addScaledVector(_v40,F.x),fe.addScaledVector(_v41,F.y),fe.addScaledVector(_v42,F.z),fe}static isFrontFacing(U,Y,ie,ne){return _v0$2.subVectors(ie,Y),_v1$3.subVectors(U,Y),_v0$2.cross(_v1$3).dot(ne)<0}set(U,Y,ie){return this.a.copy(U),this.b.copy(Y),this.c.copy(ie),this}setFromPointsAndIndices(U,Y,ie,ne){return this.a.copy(U[Y]),this.b.copy(U[ie]),this.c.copy(U[ne]),this}setFromAttributeAndIndices(U,Y,ie,ne){return this.a.fromBufferAttribute(U,Y),this.b.fromBufferAttribute(U,ie),this.c.fromBufferAttribute(U,ne),this}clone(){return new this.constructor().copy(this)}copy(U){return this.a.copy(U.a),this.b.copy(U.b),this.c.copy(U.c),this}getArea(){return _v0$2.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$2.cross(_v1$3).length()*.5}getMidpoint(U){return U.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(U){return Triangle.getNormal(this.a,this.b,this.c,U)}getPlane(U){return U.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(U,Y){return Triangle.getBarycoord(U,this.a,this.b,this.c,Y)}getInterpolation(U,Y,ie,ne,F){return Triangle.getInterpolation(U,this.a,this.b,this.c,Y,ie,ne,F)}containsPoint(U){return Triangle.containsPoint(U,this.a,this.b,this.c)}isFrontFacing(U){return Triangle.isFrontFacing(this.a,this.b,this.c,U)}intersectsBox(U){return U.intersectsTriangle(this)}closestPointToPoint(U,Y){const ie=this.a,ne=this.b,F=this.c;let fe,pe;_vab.subVectors(ne,ie),_vac.subVectors(F,ie),_vap.subVectors(U,ie);const Me=_vab.dot(_vap),ve=_vac.dot(_vap);if(Me<=0&&ve<=0)return Y.copy(ie);_vbp.subVectors(U,ne);const se=_vab.dot(_vbp),me=_vac.dot(_vbp);if(se>=0&&me<=se)return Y.copy(ne);const Te=Me*me-se*ve;if(Te<=0&&Me>=0&&se<=0)return fe=Me/(Me-se),Y.copy(ie).addScaledVector(_vab,fe);_vcp.subVectors(U,F);const Re=_vab.dot(_vcp),be=_vac.dot(_vcp);if(be>=0&&Re<=be)return Y.copy(F);const Pe=Re*ve-Me*be;if(Pe<=0&&ve>=0&&be<=0)return pe=ve/(ve-be),Y.copy(ie).addScaledVector(_vac,pe);const Le=se*be-Re*me;if(Le<=0&&me-se>=0&&Re-be>=0)return _vbc.subVectors(F,ne),pe=(me-se)/(me-se+(Re-be)),Y.copy(ne).addScaledVector(_vbc,pe);const xe=1/(Le+Pe+Te);return fe=Pe*xe,pe=Te*xe,Y.copy(ie).addScaledVector(_vab,fe).addScaledVector(_vac,pe)}equals(U){return U.a.equals(this.a)&&U.b.equals(this.b)&&U.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(re,U,Y){return Y<0&&(Y+=1),Y>1&&(Y-=1),Y<1/6?re+(U-re)*6*Y:Y<1/2?U:Y<2/3?re+(U-re)*6*(2/3-Y):re}class Color{constructor(U,Y,ie){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(U,Y,ie)}set(U,Y,ie){if(Y===void 0&&ie===void 0){const ne=U;ne&&ne.isColor?this.copy(ne):typeof ne=="number"?this.setHex(ne):typeof ne=="string"&&this.setStyle(ne)}else this.setRGB(U,Y,ie);return this}setScalar(U){return this.r=U,this.g=U,this.b=U,this}setHex(U,Y=SRGBColorSpace){return U=Math.floor(U),this.r=(U>>16&255)/255,this.g=(U>>8&255)/255,this.b=(U&255)/255,ColorManagement.toWorkingColorSpace(this,Y),this}setRGB(U,Y,ie,ne=ColorManagement.workingColorSpace){return this.r=U,this.g=Y,this.b=ie,ColorManagement.toWorkingColorSpace(this,ne),this}setHSL(U,Y,ie,ne=ColorManagement.workingColorSpace){if(U=euclideanModulo(U,1),Y=clamp$1(Y,0,1),ie=clamp$1(ie,0,1),Y===0)this.r=this.g=this.b=ie;else{const F=ie<=.5?ie*(1+Y):ie+Y-ie*Y,fe=2*ie-F;this.r=hue2rgb(fe,F,U+1/3),this.g=hue2rgb(fe,F,U),this.b=hue2rgb(fe,F,U-1/3)}return ColorManagement.toWorkingColorSpace(this,ne),this}setStyle(U,Y=SRGBColorSpace){function ie(F){F!==void 0&&parseFloat(F)<1&&console.warn("THREE.Color: Alpha component of "+U+" will be ignored.")}let ne;if(ne=/^(\w+)\(([^\)]*)\)/.exec(U)){let F;const fe=ne[1],pe=ne[2];switch(fe){case"rgb":case"rgba":if(F=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(pe))return ie(F[4]),this.setRGB(Math.min(255,parseInt(F[1],10))/255,Math.min(255,parseInt(F[2],10))/255,Math.min(255,parseInt(F[3],10))/255,Y);if(F=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(pe))return ie(F[4]),this.setRGB(Math.min(100,parseInt(F[1],10))/100,Math.min(100,parseInt(F[2],10))/100,Math.min(100,parseInt(F[3],10))/100,Y);break;case"hsl":case"hsla":if(F=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(pe))return ie(F[4]),this.setHSL(parseFloat(F[1])/360,parseFloat(F[2])/100,parseFloat(F[3])/100,Y);break;default:console.warn("THREE.Color: Unknown color model "+U)}}else if(ne=/^\#([A-Fa-f\d]+)$/.exec(U)){const F=ne[1],fe=F.length;if(fe===3)return this.setRGB(parseInt(F.charAt(0),16)/15,parseInt(F.charAt(1),16)/15,parseInt(F.charAt(2),16)/15,Y);if(fe===6)return this.setHex(parseInt(F,16),Y);console.warn("THREE.Color: Invalid hex color "+U)}else if(U&&U.length>0)return this.setColorName(U,Y);return this}setColorName(U,Y=SRGBColorSpace){const ie=_colorKeywords[U.toLowerCase()];return ie!==void 0?this.setHex(ie,Y):console.warn("THREE.Color: Unknown color "+U),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(U){return this.r=U.r,this.g=U.g,this.b=U.b,this}copySRGBToLinear(U){return this.r=SRGBToLinear(U.r),this.g=SRGBToLinear(U.g),this.b=SRGBToLinear(U.b),this}copyLinearToSRGB(U){return this.r=LinearToSRGB(U.r),this.g=LinearToSRGB(U.g),this.b=LinearToSRGB(U.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(U=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),U),Math.round(clamp$1(_color.r*255,0,255))*65536+Math.round(clamp$1(_color.g*255,0,255))*256+Math.round(clamp$1(_color.b*255,0,255))}getHexString(U=SRGBColorSpace){return("000000"+this.getHex(U).toString(16)).slice(-6)}getHSL(U,Y=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),Y);const ie=_color.r,ne=_color.g,F=_color.b,fe=Math.max(ie,ne,F),pe=Math.min(ie,ne,F);let Me,ve;const se=(pe+fe)/2;if(pe===fe)Me=0,ve=0;else{const me=fe-pe;switch(ve=se<=.5?me/(fe+pe):me/(2-fe-pe),fe){case ie:Me=(ne-F)/me+(ne<F?6:0);break;case ne:Me=(F-ie)/me+2;break;case F:Me=(ie-ne)/me+4;break}Me/=6}return U.h=Me,U.s=ve,U.l=se,U}getRGB(U,Y=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),Y),U.r=_color.r,U.g=_color.g,U.b=_color.b,U}getStyle(U=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),U);const Y=_color.r,ie=_color.g,ne=_color.b;return U!==SRGBColorSpace?`color(${U} ${Y.toFixed(3)} ${ie.toFixed(3)} ${ne.toFixed(3)})`:`rgb(${Math.round(Y*255)},${Math.round(ie*255)},${Math.round(ne*255)})`}offsetHSL(U,Y,ie){return this.getHSL(_hslA),this.setHSL(_hslA.h+U,_hslA.s+Y,_hslA.l+ie)}add(U){return this.r+=U.r,this.g+=U.g,this.b+=U.b,this}addColors(U,Y){return this.r=U.r+Y.r,this.g=U.g+Y.g,this.b=U.b+Y.b,this}addScalar(U){return this.r+=U,this.g+=U,this.b+=U,this}sub(U){return this.r=Math.max(0,this.r-U.r),this.g=Math.max(0,this.g-U.g),this.b=Math.max(0,this.b-U.b),this}multiply(U){return this.r*=U.r,this.g*=U.g,this.b*=U.b,this}multiplyScalar(U){return this.r*=U,this.g*=U,this.b*=U,this}lerp(U,Y){return this.r+=(U.r-this.r)*Y,this.g+=(U.g-this.g)*Y,this.b+=(U.b-this.b)*Y,this}lerpColors(U,Y,ie){return this.r=U.r+(Y.r-U.r)*ie,this.g=U.g+(Y.g-U.g)*ie,this.b=U.b+(Y.b-U.b)*ie,this}lerpHSL(U,Y){this.getHSL(_hslA),U.getHSL(_hslB);const ie=lerp$1(_hslA.h,_hslB.h,Y),ne=lerp$1(_hslA.s,_hslB.s,Y),F=lerp$1(_hslA.l,_hslB.l,Y);return this.setHSL(ie,ne,F),this}setFromVector3(U){return this.r=U.x,this.g=U.y,this.b=U.z,this}applyMatrix3(U){const Y=this.r,ie=this.g,ne=this.b,F=U.elements;return this.r=F[0]*Y+F[3]*ie+F[6]*ne,this.g=F[1]*Y+F[4]*ie+F[7]*ne,this.b=F[2]*Y+F[5]*ie+F[8]*ne,this}equals(U){return U.r===this.r&&U.g===this.g&&U.b===this.b}fromArray(U,Y=0){return this.r=U[Y],this.g=U[Y+1],this.b=U[Y+2],this}toArray(U=[],Y=0){return U[Y]=this.r,U[Y+1]=this.g,U[Y+2]=this.b,U}fromBufferAttribute(U,Y){return this.r=U.getX(Y),this.g=U.getY(Y),this.b=U.getZ(Y),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0,Material$1=class extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(U){this._alphaTest>0!=U>0&&this.version++,this._alphaTest=U}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(U){if(U!==void 0)for(const Y in U){const ie=U[Y];if(ie===void 0){console.warn(`THREE.Material: parameter '${Y}' has value of undefined.`);continue}const ne=this[Y];if(ne===void 0){console.warn(`THREE.Material: '${Y}' is not a property of THREE.${this.type}.`);continue}ne&&ne.isColor?ne.set(ie):ne&&ne.isVector3&&ie&&ie.isVector3?ne.copy(ie):this[Y]=ie}}toJSON(U){const Y=U===void 0||typeof U=="string";Y&&(U={textures:{},images:{}});const ie={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};ie.uuid=this.uuid,ie.type=this.type,this.name!==""&&(ie.name=this.name),this.color&&this.color.isColor&&(ie.color=this.color.getHex()),this.roughness!==void 0&&(ie.roughness=this.roughness),this.metalness!==void 0&&(ie.metalness=this.metalness),this.sheen!==void 0&&(ie.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(ie.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(ie.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(ie.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(ie.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(ie.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(ie.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(ie.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(ie.shininess=this.shininess),this.clearcoat!==void 0&&(ie.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(ie.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(ie.clearcoatMap=this.clearcoatMap.toJSON(U).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(ie.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(U).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(ie.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(U).uuid,ie.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(ie.dispersion=this.dispersion),this.iridescence!==void 0&&(ie.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(ie.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(ie.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(ie.iridescenceMap=this.iridescenceMap.toJSON(U).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(ie.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(U).uuid),this.anisotropy!==void 0&&(ie.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(ie.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(ie.anisotropyMap=this.anisotropyMap.toJSON(U).uuid),this.map&&this.map.isTexture&&(ie.map=this.map.toJSON(U).uuid),this.matcap&&this.matcap.isTexture&&(ie.matcap=this.matcap.toJSON(U).uuid),this.alphaMap&&this.alphaMap.isTexture&&(ie.alphaMap=this.alphaMap.toJSON(U).uuid),this.lightMap&&this.lightMap.isTexture&&(ie.lightMap=this.lightMap.toJSON(U).uuid,ie.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(ie.aoMap=this.aoMap.toJSON(U).uuid,ie.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(ie.bumpMap=this.bumpMap.toJSON(U).uuid,ie.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(ie.normalMap=this.normalMap.toJSON(U).uuid,ie.normalMapType=this.normalMapType,ie.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(ie.displacementMap=this.displacementMap.toJSON(U).uuid,ie.displacementScale=this.displacementScale,ie.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(ie.roughnessMap=this.roughnessMap.toJSON(U).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(ie.metalnessMap=this.metalnessMap.toJSON(U).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(ie.emissiveMap=this.emissiveMap.toJSON(U).uuid),this.specularMap&&this.specularMap.isTexture&&(ie.specularMap=this.specularMap.toJSON(U).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(ie.specularIntensityMap=this.specularIntensityMap.toJSON(U).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(ie.specularColorMap=this.specularColorMap.toJSON(U).uuid),this.envMap&&this.envMap.isTexture&&(ie.envMap=this.envMap.toJSON(U).uuid,this.combine!==void 0&&(ie.combine=this.combine)),this.envMapRotation!==void 0&&(ie.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(ie.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(ie.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(ie.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(ie.gradientMap=this.gradientMap.toJSON(U).uuid),this.transmission!==void 0&&(ie.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(ie.transmissionMap=this.transmissionMap.toJSON(U).uuid),this.thickness!==void 0&&(ie.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(ie.thicknessMap=this.thicknessMap.toJSON(U).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(ie.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(ie.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(ie.size=this.size),this.shadowSide!==null&&(ie.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(ie.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(ie.blending=this.blending),this.side!==FrontSide&&(ie.side=this.side),this.vertexColors===!0&&(ie.vertexColors=!0),this.opacity<1&&(ie.opacity=this.opacity),this.transparent===!0&&(ie.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(ie.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(ie.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(ie.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(ie.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(ie.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(ie.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(ie.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(ie.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(ie.depthFunc=this.depthFunc),this.depthTest===!1&&(ie.depthTest=this.depthTest),this.depthWrite===!1&&(ie.depthWrite=this.depthWrite),this.colorWrite===!1&&(ie.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(ie.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(ie.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(ie.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(ie.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(ie.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(ie.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(ie.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(ie.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(ie.rotation=this.rotation),this.polygonOffset===!0&&(ie.polygonOffset=!0),this.polygonOffsetFactor!==0&&(ie.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(ie.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(ie.linewidth=this.linewidth),this.dashSize!==void 0&&(ie.dashSize=this.dashSize),this.gapSize!==void 0&&(ie.gapSize=this.gapSize),this.scale!==void 0&&(ie.scale=this.scale),this.dithering===!0&&(ie.dithering=!0),this.alphaTest>0&&(ie.alphaTest=this.alphaTest),this.alphaHash===!0&&(ie.alphaHash=!0),this.alphaToCoverage===!0&&(ie.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(ie.premultipliedAlpha=!0),this.forceSinglePass===!0&&(ie.forceSinglePass=!0),this.wireframe===!0&&(ie.wireframe=!0),this.wireframeLinewidth>1&&(ie.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(ie.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(ie.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(ie.flatShading=!0),this.visible===!1&&(ie.visible=!1),this.toneMapped===!1&&(ie.toneMapped=!1),this.fog===!1&&(ie.fog=!1),Object.keys(this.userData).length>0&&(ie.userData=this.userData);function ne(F){const fe=[];for(const pe in F){const Me=F[pe];delete Me.metadata,fe.push(Me)}return fe}if(Y){const F=ne(U.textures),fe=ne(U.images);F.length>0&&(ie.textures=F),fe.length>0&&(ie.images=fe)}return ie}clone(){return new this.constructor().copy(this)}copy(U){this.name=U.name,this.blending=U.blending,this.side=U.side,this.vertexColors=U.vertexColors,this.opacity=U.opacity,this.transparent=U.transparent,this.blendSrc=U.blendSrc,this.blendDst=U.blendDst,this.blendEquation=U.blendEquation,this.blendSrcAlpha=U.blendSrcAlpha,this.blendDstAlpha=U.blendDstAlpha,this.blendEquationAlpha=U.blendEquationAlpha,this.blendColor.copy(U.blendColor),this.blendAlpha=U.blendAlpha,this.depthFunc=U.depthFunc,this.depthTest=U.depthTest,this.depthWrite=U.depthWrite,this.stencilWriteMask=U.stencilWriteMask,this.stencilFunc=U.stencilFunc,this.stencilRef=U.stencilRef,this.stencilFuncMask=U.stencilFuncMask,this.stencilFail=U.stencilFail,this.stencilZFail=U.stencilZFail,this.stencilZPass=U.stencilZPass,this.stencilWrite=U.stencilWrite;const Y=U.clippingPlanes;let ie=null;if(Y!==null){const ne=Y.length;ie=new Array(ne);for(let F=0;F!==ne;++F)ie[F]=Y[F].clone()}return this.clippingPlanes=ie,this.clipIntersection=U.clipIntersection,this.clipShadows=U.clipShadows,this.shadowSide=U.shadowSide,this.colorWrite=U.colorWrite,this.precision=U.precision,this.polygonOffset=U.polygonOffset,this.polygonOffsetFactor=U.polygonOffsetFactor,this.polygonOffsetUnits=U.polygonOffsetUnits,this.dithering=U.dithering,this.alphaTest=U.alphaTest,this.alphaHash=U.alphaHash,this.alphaToCoverage=U.alphaToCoverage,this.premultipliedAlpha=U.premultipliedAlpha,this.forceSinglePass=U.forceSinglePass,this.visible=U.visible,this.toneMapped=U.toneMapped,this.userData=JSON.parse(JSON.stringify(U.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(U){U===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}};class MeshBasicMaterial extends Material$1{constructor(U){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(U)}copy(U){return super.copy(U),this.color.copy(U.color),this.map=U.map,this.lightMap=U.lightMap,this.lightMapIntensity=U.lightMapIntensity,this.aoMap=U.aoMap,this.aoMapIntensity=U.aoMapIntensity,this.specularMap=U.specularMap,this.alphaMap=U.alphaMap,this.envMap=U.envMap,this.envMapRotation.copy(U.envMapRotation),this.combine=U.combine,this.reflectivity=U.reflectivity,this.refractionRatio=U.refractionRatio,this.wireframe=U.wireframe,this.wireframeLinewidth=U.wireframeLinewidth,this.wireframeLinecap=U.wireframeLinecap,this.wireframeLinejoin=U.wireframeLinejoin,this.fog=U.fog,this}}const _tables=_generateTables();function _generateTables(){const re=new ArrayBuffer(4),U=new Float32Array(re),Y=new Uint32Array(re),ie=new Uint32Array(512),ne=new Uint32Array(512);for(let Me=0;Me<256;++Me){const ve=Me-127;ve<-27?(ie[Me]=0,ie[Me|256]=32768,ne[Me]=24,ne[Me|256]=24):ve<-14?(ie[Me]=1024>>-ve-14,ie[Me|256]=1024>>-ve-14|32768,ne[Me]=-ve-1,ne[Me|256]=-ve-1):ve<=15?(ie[Me]=ve+15<<10,ie[Me|256]=ve+15<<10|32768,ne[Me]=13,ne[Me|256]=13):ve<128?(ie[Me]=31744,ie[Me|256]=64512,ne[Me]=24,ne[Me|256]=24):(ie[Me]=31744,ie[Me|256]=64512,ne[Me]=13,ne[Me|256]=13)}const F=new Uint32Array(2048),fe=new Uint32Array(64),pe=new Uint32Array(64);for(let Me=1;Me<1024;++Me){let ve=Me<<13,se=0;for(;!(ve&8388608);)ve<<=1,se-=8388608;ve&=-8388609,se+=947912704,F[Me]=ve|se}for(let Me=1024;Me<2048;++Me)F[Me]=939524096+(Me-1024<<13);for(let Me=1;Me<31;++Me)fe[Me]=Me<<23;fe[31]=1199570944,fe[32]=2147483648;for(let Me=33;Me<63;++Me)fe[Me]=2147483648+(Me-32<<23);fe[63]=3347054592;for(let Me=1;Me<64;++Me)Me!==32&&(pe[Me]=1024);return{floatView:U,uint32View:Y,baseTable:ie,shiftTable:ne,mantissaTable:F,exponentTable:fe,offsetTable:pe}}function toHalfFloat(re){Math.abs(re)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),re=clamp$1(re,-65504,65504),_tables.floatView[0]=re;const U=_tables.uint32View[0],Y=U>>23&511;return _tables.baseTable[Y]+((U&8388607)>>_tables.shiftTable[Y])}function fromHalfFloat(re){const U=re>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[U]+(re&1023)]+_tables.exponentTable[U],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(U,Y,ie=!1){if(Array.isArray(U))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=U,this.itemSize=Y,this.count=U!==void 0?U.length/Y:0,this.normalized=ie,this.usage=StaticDrawUsage,this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(U){U===!0&&this.version++}setUsage(U){return this.usage=U,this}addUpdateRange(U,Y){this.updateRanges.push({start:U,count:Y})}clearUpdateRanges(){this.updateRanges.length=0}copy(U){return this.name=U.name,this.array=new U.array.constructor(U.array),this.itemSize=U.itemSize,this.count=U.count,this.normalized=U.normalized,this.usage=U.usage,this.gpuType=U.gpuType,this}copyAt(U,Y,ie){U*=this.itemSize,ie*=Y.itemSize;for(let ne=0,F=this.itemSize;ne<F;ne++)this.array[U+ne]=Y.array[ie+ne];return this}copyArray(U){return this.array.set(U),this}applyMatrix3(U){if(this.itemSize===2)for(let Y=0,ie=this.count;Y<ie;Y++)_vector2$1.fromBufferAttribute(this,Y),_vector2$1.applyMatrix3(U),this.setXY(Y,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let Y=0,ie=this.count;Y<ie;Y++)_vector$9.fromBufferAttribute(this,Y),_vector$9.applyMatrix3(U),this.setXYZ(Y,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(U){for(let Y=0,ie=this.count;Y<ie;Y++)_vector$9.fromBufferAttribute(this,Y),_vector$9.applyMatrix4(U),this.setXYZ(Y,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(U){for(let Y=0,ie=this.count;Y<ie;Y++)_vector$9.fromBufferAttribute(this,Y),_vector$9.applyNormalMatrix(U),this.setXYZ(Y,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(U){for(let Y=0,ie=this.count;Y<ie;Y++)_vector$9.fromBufferAttribute(this,Y),_vector$9.transformDirection(U),this.setXYZ(Y,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(U,Y=0){return this.array.set(U,Y),this}getComponent(U,Y){let ie=this.array[U*this.itemSize+Y];return this.normalized&&(ie=denormalize(ie,this.array)),ie}setComponent(U,Y,ie){return this.normalized&&(ie=normalize(ie,this.array)),this.array[U*this.itemSize+Y]=ie,this}getX(U){let Y=this.array[U*this.itemSize];return this.normalized&&(Y=denormalize(Y,this.array)),Y}setX(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.array[U*this.itemSize]=Y,this}getY(U){let Y=this.array[U*this.itemSize+1];return this.normalized&&(Y=denormalize(Y,this.array)),Y}setY(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.array[U*this.itemSize+1]=Y,this}getZ(U){let Y=this.array[U*this.itemSize+2];return this.normalized&&(Y=denormalize(Y,this.array)),Y}setZ(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.array[U*this.itemSize+2]=Y,this}getW(U){let Y=this.array[U*this.itemSize+3];return this.normalized&&(Y=denormalize(Y,this.array)),Y}setW(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.array[U*this.itemSize+3]=Y,this}setXY(U,Y,ie){return U*=this.itemSize,this.normalized&&(Y=normalize(Y,this.array),ie=normalize(ie,this.array)),this.array[U+0]=Y,this.array[U+1]=ie,this}setXYZ(U,Y,ie,ne){return U*=this.itemSize,this.normalized&&(Y=normalize(Y,this.array),ie=normalize(ie,this.array),ne=normalize(ne,this.array)),this.array[U+0]=Y,this.array[U+1]=ie,this.array[U+2]=ne,this}setXYZW(U,Y,ie,ne,F){return U*=this.itemSize,this.normalized&&(Y=normalize(Y,this.array),ie=normalize(ie,this.array),ne=normalize(ne,this.array),F=normalize(F,this.array)),this.array[U+0]=Y,this.array[U+1]=ie,this.array[U+2]=ne,this.array[U+3]=F,this}onUpload(U){return this.onUploadCallback=U,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const U={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(U.name=this.name),this.usage!==StaticDrawUsage&&(U.usage=this.usage),U}}class Uint16BufferAttribute extends BufferAttribute{constructor(U,Y,ie){super(new Uint16Array(U),Y,ie)}}class Uint32BufferAttribute extends BufferAttribute{constructor(U,Y,ie){super(new Uint32Array(U),Y,ie)}}class Float32BufferAttribute extends BufferAttribute{constructor(U,Y,ie){super(new Float32Array(U),Y,ie)}}let _id$2=0;const _m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(U){return Array.isArray(U)?this.index=new(arrayNeedsUint32(U)?Uint32BufferAttribute:Uint16BufferAttribute)(U,1):this.index=U,this}getAttribute(U){return this.attributes[U]}setAttribute(U,Y){return this.attributes[U]=Y,this}deleteAttribute(U){return delete this.attributes[U],this}hasAttribute(U){return this.attributes[U]!==void 0}addGroup(U,Y,ie=0){this.groups.push({start:U,count:Y,materialIndex:ie})}clearGroups(){this.groups=[]}setDrawRange(U,Y){this.drawRange.start=U,this.drawRange.count=Y}applyMatrix4(U){const Y=this.attributes.position;Y!==void 0&&(Y.applyMatrix4(U),Y.needsUpdate=!0);const ie=this.attributes.normal;if(ie!==void 0){const F=new Matrix3().getNormalMatrix(U);ie.applyNormalMatrix(F),ie.needsUpdate=!0}const ne=this.attributes.tangent;return ne!==void 0&&(ne.transformDirection(U),ne.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(U){return _m1$2.makeRotationFromQuaternion(U),this.applyMatrix4(_m1$2),this}rotateX(U){return _m1$2.makeRotationX(U),this.applyMatrix4(_m1$2),this}rotateY(U){return _m1$2.makeRotationY(U),this.applyMatrix4(_m1$2),this}rotateZ(U){return _m1$2.makeRotationZ(U),this.applyMatrix4(_m1$2),this}translate(U,Y,ie){return _m1$2.makeTranslation(U,Y,ie),this.applyMatrix4(_m1$2),this}scale(U,Y,ie){return _m1$2.makeScale(U,Y,ie),this.applyMatrix4(_m1$2),this}lookAt(U){return _obj.lookAt(U),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(U){const Y=[];for(let ie=0,ne=U.length;ie<ne;ie++){const F=U[ie];Y.push(F.x,F.y,F.z||0)}return this.setAttribute("position",new Float32BufferAttribute(Y,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const U=this.attributes.position,Y=this.morphAttributes.position;if(U&&U.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(U!==void 0){if(this.boundingBox.setFromBufferAttribute(U),Y)for(let ie=0,ne=Y.length;ie<ne;ie++){const F=Y[ie];_box$2.setFromBufferAttribute(F),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const U=this.attributes.position,Y=this.morphAttributes.position;if(U&&U.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(U){const ie=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(U),Y)for(let F=0,fe=Y.length;F<fe;F++){const pe=Y[F];_boxMorphTargets.setFromBufferAttribute(pe),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(ie);let ne=0;for(let F=0,fe=U.count;F<fe;F++)_vector$8.fromBufferAttribute(U,F),ne=Math.max(ne,ie.distanceToSquared(_vector$8));if(Y)for(let F=0,fe=Y.length;F<fe;F++){const pe=Y[F],Me=this.morphTargetsRelative;for(let ve=0,se=pe.count;ve<se;ve++)_vector$8.fromBufferAttribute(pe,ve),Me&&(_offset.fromBufferAttribute(U,ve),_vector$8.add(_offset)),ne=Math.max(ne,ie.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(ne),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const U=this.index,Y=this.attributes;if(U===null||Y.position===void 0||Y.normal===void 0||Y.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const ie=Y.position,ne=Y.normal,F=Y.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*ie.count),4));const fe=this.getAttribute("tangent"),pe=[],Me=[];for(let $e=0;$e<ie.count;$e++)pe[$e]=new Vector3,Me[$e]=new Vector3;const ve=new Vector3,se=new Vector3,me=new Vector3,Te=new Vector2,Re=new Vector2,be=new Vector2,Pe=new Vector3,Le=new Vector3;function xe($e,st,ze){ve.fromBufferAttribute(ie,$e),se.fromBufferAttribute(ie,st),me.fromBufferAttribute(ie,ze),Te.fromBufferAttribute(F,$e),Re.fromBufferAttribute(F,st),be.fromBufferAttribute(F,ze),se.sub(ve),me.sub(ve),Re.sub(Te),be.sub(Te);const tt=1/(Re.x*be.y-be.x*Re.y);isFinite(tt)&&(Pe.copy(se).multiplyScalar(be.y).addScaledVector(me,-Re.y).multiplyScalar(tt),Le.copy(me).multiplyScalar(Re.x).addScaledVector(se,-be.x).multiplyScalar(tt),pe[$e].add(Pe),pe[st].add(Pe),pe[ze].add(Pe),Me[$e].add(Le),Me[st].add(Le),Me[ze].add(Le))}let Fe=this.groups;Fe.length===0&&(Fe=[{start:0,count:U.count}]);for(let $e=0,st=Fe.length;$e<st;++$e){const ze=Fe[$e],tt=ze.start,ft=ze.count;for(let Rt=tt,Mt=tt+ft;Rt<Mt;Rt+=3)xe(U.getX(Rt+0),U.getX(Rt+1),U.getX(Rt+2))}const Oe=new Vector3,Ne=new Vector3,ke=new Vector3,Ve=new Vector3;function Xe($e){ke.fromBufferAttribute(ne,$e),Ve.copy(ke);const st=pe[$e];Oe.copy(st),Oe.sub(ke.multiplyScalar(ke.dot(st))).normalize(),Ne.crossVectors(Ve,st);const tt=Ne.dot(Me[$e])<0?-1:1;fe.setXYZW($e,Oe.x,Oe.y,Oe.z,tt)}for(let $e=0,st=Fe.length;$e<st;++$e){const ze=Fe[$e],tt=ze.start,ft=ze.count;for(let Rt=tt,Mt=tt+ft;Rt<Mt;Rt+=3)Xe(U.getX(Rt+0)),Xe(U.getX(Rt+1)),Xe(U.getX(Rt+2))}}computeVertexNormals(){const U=this.index,Y=this.getAttribute("position");if(Y!==void 0){let ie=this.getAttribute("normal");if(ie===void 0)ie=new BufferAttribute(new Float32Array(Y.count*3),3),this.setAttribute("normal",ie);else for(let Te=0,Re=ie.count;Te<Re;Te++)ie.setXYZ(Te,0,0,0);const ne=new Vector3,F=new Vector3,fe=new Vector3,pe=new Vector3,Me=new Vector3,ve=new Vector3,se=new Vector3,me=new Vector3;if(U)for(let Te=0,Re=U.count;Te<Re;Te+=3){const be=U.getX(Te+0),Pe=U.getX(Te+1),Le=U.getX(Te+2);ne.fromBufferAttribute(Y,be),F.fromBufferAttribute(Y,Pe),fe.fromBufferAttribute(Y,Le),se.subVectors(fe,F),me.subVectors(ne,F),se.cross(me),pe.fromBufferAttribute(ie,be),Me.fromBufferAttribute(ie,Pe),ve.fromBufferAttribute(ie,Le),pe.add(se),Me.add(se),ve.add(se),ie.setXYZ(be,pe.x,pe.y,pe.z),ie.setXYZ(Pe,Me.x,Me.y,Me.z),ie.setXYZ(Le,ve.x,ve.y,ve.z)}else for(let Te=0,Re=Y.count;Te<Re;Te+=3)ne.fromBufferAttribute(Y,Te+0),F.fromBufferAttribute(Y,Te+1),fe.fromBufferAttribute(Y,Te+2),se.subVectors(fe,F),me.subVectors(ne,F),se.cross(me),ie.setXYZ(Te+0,se.x,se.y,se.z),ie.setXYZ(Te+1,se.x,se.y,se.z),ie.setXYZ(Te+2,se.x,se.y,se.z);this.normalizeNormals(),ie.needsUpdate=!0}}normalizeNormals(){const U=this.attributes.normal;for(let Y=0,ie=U.count;Y<ie;Y++)_vector$8.fromBufferAttribute(U,Y),_vector$8.normalize(),U.setXYZ(Y,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function U(pe,Me){const ve=pe.array,se=pe.itemSize,me=pe.normalized,Te=new ve.constructor(Me.length*se);let Re=0,be=0;for(let Pe=0,Le=Me.length;Pe<Le;Pe++){pe.isInterleavedBufferAttribute?Re=Me[Pe]*pe.data.stride+pe.offset:Re=Me[Pe]*se;for(let xe=0;xe<se;xe++)Te[be++]=ve[Re++]}return new BufferAttribute(Te,se,me)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const Y=new BufferGeometry,ie=this.index.array,ne=this.attributes;for(const pe in ne){const Me=ne[pe],ve=U(Me,ie);Y.setAttribute(pe,ve)}const F=this.morphAttributes;for(const pe in F){const Me=[],ve=F[pe];for(let se=0,me=ve.length;se<me;se++){const Te=ve[se],Re=U(Te,ie);Me.push(Re)}Y.morphAttributes[pe]=Me}Y.morphTargetsRelative=this.morphTargetsRelative;const fe=this.groups;for(let pe=0,Me=fe.length;pe<Me;pe++){const ve=fe[pe];Y.addGroup(ve.start,ve.count,ve.materialIndex)}return Y}toJSON(){const U={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(U.uuid=this.uuid,U.type=this.type,this.name!==""&&(U.name=this.name),Object.keys(this.userData).length>0&&(U.userData=this.userData),this.parameters!==void 0){const Me=this.parameters;for(const ve in Me)Me[ve]!==void 0&&(U[ve]=Me[ve]);return U}U.data={attributes:{}};const Y=this.index;Y!==null&&(U.data.index={type:Y.array.constructor.name,array:Array.prototype.slice.call(Y.array)});const ie=this.attributes;for(const Me in ie){const ve=ie[Me];U.data.attributes[Me]=ve.toJSON(U.data)}const ne={};let F=!1;for(const Me in this.morphAttributes){const ve=this.morphAttributes[Me],se=[];for(let me=0,Te=ve.length;me<Te;me++){const Re=ve[me];se.push(Re.toJSON(U.data))}se.length>0&&(ne[Me]=se,F=!0)}F&&(U.data.morphAttributes=ne,U.data.morphTargetsRelative=this.morphTargetsRelative);const fe=this.groups;fe.length>0&&(U.data.groups=JSON.parse(JSON.stringify(fe)));const pe=this.boundingSphere;return pe!==null&&(U.data.boundingSphere={center:pe.center.toArray(),radius:pe.radius}),U}clone(){return new this.constructor().copy(this)}copy(U){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const Y={};this.name=U.name;const ie=U.index;ie!==null&&this.setIndex(ie.clone(Y));const ne=U.attributes;for(const ve in ne){const se=ne[ve];this.setAttribute(ve,se.clone(Y))}const F=U.morphAttributes;for(const ve in F){const se=[],me=F[ve];for(let Te=0,Re=me.length;Te<Re;Te++)se.push(me[Te].clone(Y));this.morphAttributes[ve]=se}this.morphTargetsRelative=U.morphTargetsRelative;const fe=U.groups;for(let ve=0,se=fe.length;ve<se;ve++){const me=fe[ve];this.addGroup(me.start,me.count,me.materialIndex)}const pe=U.boundingBox;pe!==null&&(this.boundingBox=pe.clone());const Me=U.boundingSphere;return Me!==null&&(this.boundingSphere=Me.clone()),this.drawRange.start=U.drawRange.start,this.drawRange.count=U.drawRange.count,this.userData=U.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(U=new BufferGeometry,Y=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=U,this.material=Y,this.updateMorphTargets()}copy(U,Y){return super.copy(U,Y),U.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=U.morphTargetInfluences.slice()),U.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},U.morphTargetDictionary)),this.material=Array.isArray(U.material)?U.material.slice():U.material,this.geometry=U.geometry,this}updateMorphTargets(){const Y=this.geometry.morphAttributes,ie=Object.keys(Y);if(ie.length>0){const ne=Y[ie[0]];if(ne!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let F=0,fe=ne.length;F<fe;F++){const pe=ne[F].name||String(F);this.morphTargetInfluences.push(0),this.morphTargetDictionary[pe]=F}}}}getVertexPosition(U,Y){const ie=this.geometry,ne=ie.attributes.position,F=ie.morphAttributes.position,fe=ie.morphTargetsRelative;Y.fromBufferAttribute(ne,U);const pe=this.morphTargetInfluences;if(F&&pe){_morphA.set(0,0,0);for(let Me=0,ve=F.length;Me<ve;Me++){const se=pe[Me],me=F[Me];se!==0&&(_tempA.fromBufferAttribute(me,U),fe?_morphA.addScaledVector(_tempA,se):_morphA.addScaledVector(_tempA.sub(Y),se))}Y.add(_morphA)}return Y}raycast(U,Y){const ie=this.geometry,ne=this.material,F=this.matrixWorld;ne!==void 0&&(ie.boundingSphere===null&&ie.computeBoundingSphere(),_sphere$6.copy(ie.boundingSphere),_sphere$6.applyMatrix4(F),_ray$3.copy(U.ray).recast(U.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(U.far-U.near)**2))&&(_inverseMatrix$3.copy(F).invert(),_ray$3.copy(U.ray).applyMatrix4(_inverseMatrix$3),!(ie.boundingBox!==null&&_ray$3.intersectsBox(ie.boundingBox)===!1)&&this._computeIntersections(U,Y,_ray$3)))}_computeIntersections(U,Y,ie){let ne;const F=this.geometry,fe=this.material,pe=F.index,Me=F.attributes.position,ve=F.attributes.uv,se=F.attributes.uv1,me=F.attributes.normal,Te=F.groups,Re=F.drawRange;if(pe!==null)if(Array.isArray(fe))for(let be=0,Pe=Te.length;be<Pe;be++){const Le=Te[be],xe=fe[Le.materialIndex],Fe=Math.max(Le.start,Re.start),Oe=Math.min(pe.count,Math.min(Le.start+Le.count,Re.start+Re.count));for(let Ne=Fe,ke=Oe;Ne<ke;Ne+=3){const Ve=pe.getX(Ne),Xe=pe.getX(Ne+1),$e=pe.getX(Ne+2);ne=checkGeometryIntersection(this,xe,U,ie,ve,se,me,Ve,Xe,$e),ne&&(ne.faceIndex=Math.floor(Ne/3),ne.face.materialIndex=Le.materialIndex,Y.push(ne))}}else{const be=Math.max(0,Re.start),Pe=Math.min(pe.count,Re.start+Re.count);for(let Le=be,xe=Pe;Le<xe;Le+=3){const Fe=pe.getX(Le),Oe=pe.getX(Le+1),Ne=pe.getX(Le+2);ne=checkGeometryIntersection(this,fe,U,ie,ve,se,me,Fe,Oe,Ne),ne&&(ne.faceIndex=Math.floor(Le/3),Y.push(ne))}}else if(Me!==void 0)if(Array.isArray(fe))for(let be=0,Pe=Te.length;be<Pe;be++){const Le=Te[be],xe=fe[Le.materialIndex],Fe=Math.max(Le.start,Re.start),Oe=Math.min(Me.count,Math.min(Le.start+Le.count,Re.start+Re.count));for(let Ne=Fe,ke=Oe;Ne<ke;Ne+=3){const Ve=Ne,Xe=Ne+1,$e=Ne+2;ne=checkGeometryIntersection(this,xe,U,ie,ve,se,me,Ve,Xe,$e),ne&&(ne.faceIndex=Math.floor(Ne/3),ne.face.materialIndex=Le.materialIndex,Y.push(ne))}}else{const be=Math.max(0,Re.start),Pe=Math.min(Me.count,Re.start+Re.count);for(let Le=be,xe=Pe;Le<xe;Le+=3){const Fe=Le,Oe=Le+1,Ne=Le+2;ne=checkGeometryIntersection(this,fe,U,ie,ve,se,me,Fe,Oe,Ne),ne&&(ne.faceIndex=Math.floor(Le/3),Y.push(ne))}}}}function checkIntersection$1(re,U,Y,ie,ne,F,fe,pe){let Me;if(U.side===BackSide?Me=ie.intersectTriangle(fe,F,ne,!0,pe):Me=ie.intersectTriangle(ne,F,fe,U.side===FrontSide,pe),Me===null)return null;_intersectionPointWorld.copy(pe),_intersectionPointWorld.applyMatrix4(re.matrixWorld);const ve=Y.ray.origin.distanceTo(_intersectionPointWorld);return ve<Y.near||ve>Y.far?null:{distance:ve,point:_intersectionPointWorld.clone(),object:re}}function checkGeometryIntersection(re,U,Y,ie,ne,F,fe,pe,Me,ve){re.getVertexPosition(pe,_vA$1),re.getVertexPosition(Me,_vB$1),re.getVertexPosition(ve,_vC$1);const se=checkIntersection$1(re,U,Y,ie,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(se){const me=new Vector3;Triangle.getBarycoord(_intersectionPoint,_vA$1,_vB$1,_vC$1,me),ne&&(se.uv=Triangle.getInterpolatedAttribute(ne,pe,Me,ve,me,new Vector2)),F&&(se.uv1=Triangle.getInterpolatedAttribute(F,pe,Me,ve,me,new Vector2)),fe&&(se.normal=Triangle.getInterpolatedAttribute(fe,pe,Me,ve,me,new Vector3),se.normal.dot(ie.direction)>0&&se.normal.multiplyScalar(-1));const Te={a:pe,b:Me,c:ve,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,Te.normal),se.face=Te,se.barycoord=me}return se}class BoxGeometry extends BufferGeometry{constructor(U=1,Y=1,ie=1,ne=1,F=1,fe=1){super(),this.type="BoxGeometry",this.parameters={width:U,height:Y,depth:ie,widthSegments:ne,heightSegments:F,depthSegments:fe};const pe=this;ne=Math.floor(ne),F=Math.floor(F),fe=Math.floor(fe);const Me=[],ve=[],se=[],me=[];let Te=0,Re=0;be("z","y","x",-1,-1,ie,Y,U,fe,F,0),be("z","y","x",1,-1,ie,Y,-U,fe,F,1),be("x","z","y",1,1,U,ie,Y,ne,fe,2),be("x","z","y",1,-1,U,ie,-Y,ne,fe,3),be("x","y","z",1,-1,U,Y,ie,ne,F,4),be("x","y","z",-1,-1,U,Y,-ie,ne,F,5),this.setIndex(Me),this.setAttribute("position",new Float32BufferAttribute(ve,3)),this.setAttribute("normal",new Float32BufferAttribute(se,3)),this.setAttribute("uv",new Float32BufferAttribute(me,2));function be(Pe,Le,xe,Fe,Oe,Ne,ke,Ve,Xe,$e,st){const ze=Ne/Xe,tt=ke/$e,ft=Ne/2,Rt=ke/2,Mt=Ve/2,Gt=Xe+1,_t=$e+1;let Bt=0,dt=0;const ut=new Vector3;for(let Ut=0;Ut<_t;Ut++){const Tt=Ut*tt-Rt;for(let Xt=0;Xt<Gt;Xt++){const hn=Xt*ze-ft;ut[Pe]=hn*Fe,ut[Le]=Tt*Oe,ut[xe]=Mt,ve.push(ut.x,ut.y,ut.z),ut[Pe]=0,ut[Le]=0,ut[xe]=Ve>0?1:-1,se.push(ut.x,ut.y,ut.z),me.push(Xt/Xe),me.push(1-Ut/$e),Bt+=1}}for(let Ut=0;Ut<$e;Ut++)for(let Tt=0;Tt<Xe;Tt++){const Xt=Te+Tt+Gt*Ut,hn=Te+Tt+Gt*(Ut+1),nn=Te+(Tt+1)+Gt*(Ut+1),An=Te+(Tt+1)+Gt*Ut;Me.push(Xt,hn,An),Me.push(hn,nn,An),dt+=6}pe.addGroup(Re,dt,st),Re+=dt,Te+=Bt}}copy(U){return super.copy(U),this.parameters=Object.assign({},U.parameters),this}static fromJSON(U){return new BoxGeometry(U.width,U.height,U.depth,U.widthSegments,U.heightSegments,U.depthSegments)}}function cloneUniforms(re){const U={};for(const Y in re){U[Y]={};for(const ie in re[Y]){const ne=re[Y][ie];ne&&(ne.isColor||ne.isMatrix3||ne.isMatrix4||ne.isVector2||ne.isVector3||ne.isVector4||ne.isTexture||ne.isQuaternion)?ne.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),U[Y][ie]=null):U[Y][ie]=ne.clone():Array.isArray(ne)?U[Y][ie]=ne.slice():U[Y][ie]=ne}}return U}function mergeUniforms(re){const U={};for(let Y=0;Y<re.length;Y++){const ie=cloneUniforms(re[Y]);for(const ne in ie)U[ne]=ie[ne]}return U}function cloneUniformsGroups(re){const U=[];for(let Y=0;Y<re.length;Y++)U.push(re[Y].clone());return U}function getUnlitUniformColorSpace(re){const U=re.getRenderTarget();return U===null?re.outputColorSpace:U.isXRRenderTarget===!0?U.texture.colorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material$1{constructor(U){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,U!==void 0&&this.setValues(U)}copy(U){return super.copy(U),this.fragmentShader=U.fragmentShader,this.vertexShader=U.vertexShader,this.uniforms=cloneUniforms(U.uniforms),this.uniformsGroups=cloneUniformsGroups(U.uniformsGroups),this.defines=Object.assign({},U.defines),this.wireframe=U.wireframe,this.wireframeLinewidth=U.wireframeLinewidth,this.fog=U.fog,this.lights=U.lights,this.clipping=U.clipping,this.extensions=Object.assign({},U.extensions),this.glslVersion=U.glslVersion,this}toJSON(U){const Y=super.toJSON(U);Y.glslVersion=this.glslVersion,Y.uniforms={};for(const ne in this.uniforms){const fe=this.uniforms[ne].value;fe&&fe.isTexture?Y.uniforms[ne]={type:"t",value:fe.toJSON(U).uuid}:fe&&fe.isColor?Y.uniforms[ne]={type:"c",value:fe.getHex()}:fe&&fe.isVector2?Y.uniforms[ne]={type:"v2",value:fe.toArray()}:fe&&fe.isVector3?Y.uniforms[ne]={type:"v3",value:fe.toArray()}:fe&&fe.isVector4?Y.uniforms[ne]={type:"v4",value:fe.toArray()}:fe&&fe.isMatrix3?Y.uniforms[ne]={type:"m3",value:fe.toArray()}:fe&&fe.isMatrix4?Y.uniforms[ne]={type:"m4",value:fe.toArray()}:Y.uniforms[ne]={value:fe}}Object.keys(this.defines).length>0&&(Y.defines=this.defines),Y.vertexShader=this.vertexShader,Y.fragmentShader=this.fragmentShader,Y.lights=this.lights,Y.clipping=this.clipping;const ie={};for(const ne in this.extensions)this.extensions[ne]===!0&&(ie[ne]=!0);return Object.keys(ie).length>0&&(Y.extensions=ie),Y}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(U,Y){return super.copy(U,Y),this.matrixWorldInverse.copy(U.matrixWorldInverse),this.projectionMatrix.copy(U.projectionMatrix),this.projectionMatrixInverse.copy(U.projectionMatrixInverse),this.coordinateSystem=U.coordinateSystem,this}getWorldDirection(U){return super.getWorldDirection(U).negate()}updateMatrixWorld(U){super.updateMatrixWorld(U),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(U,Y){super.updateWorldMatrix(U,Y),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;class PerspectiveCamera extends Camera{constructor(U=50,Y=1,ie=.1,ne=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=U,this.zoom=1,this.near=ie,this.far=ne,this.focus=10,this.aspect=Y,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(U,Y){return super.copy(U,Y),this.fov=U.fov,this.zoom=U.zoom,this.near=U.near,this.far=U.far,this.focus=U.focus,this.aspect=U.aspect,this.view=U.view===null?null:Object.assign({},U.view),this.filmGauge=U.filmGauge,this.filmOffset=U.filmOffset,this}setFocalLength(U){const Y=.5*this.getFilmHeight()/U;this.fov=RAD2DEG*2*Math.atan(Y),this.updateProjectionMatrix()}getFocalLength(){const U=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/U}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(U,Y,ie){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),Y.set(_v3$1.x,_v3$1.y).multiplyScalar(-U/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),ie.set(_v3$1.x,_v3$1.y).multiplyScalar(-U/_v3$1.z)}getViewSize(U,Y){return this.getViewBounds(U,_minTarget,_maxTarget),Y.subVectors(_maxTarget,_minTarget)}setViewOffset(U,Y,ie,ne,F,fe){this.aspect=U/Y,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=U,this.view.fullHeight=Y,this.view.offsetX=ie,this.view.offsetY=ne,this.view.width=F,this.view.height=fe,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const U=this.near;let Y=U*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,ie=2*Y,ne=this.aspect*ie,F=-.5*ne;const fe=this.view;if(this.view!==null&&this.view.enabled){const Me=fe.fullWidth,ve=fe.fullHeight;F+=fe.offsetX*ne/Me,Y-=fe.offsetY*ie/ve,ne*=fe.width/Me,ie*=fe.height/ve}const pe=this.filmOffset;pe!==0&&(F+=U*pe/this.getFilmWidth()),this.projectionMatrix.makePerspective(F,F+ne,Y,Y-ie,U,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(U){const Y=super.toJSON(U);return Y.object.fov=this.fov,Y.object.zoom=this.zoom,Y.object.near=this.near,Y.object.far=this.far,Y.object.focus=this.focus,Y.object.aspect=this.aspect,this.view!==null&&(Y.object.view=Object.assign({},this.view)),Y.object.filmGauge=this.filmGauge,Y.object.filmOffset=this.filmOffset,Y}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(U,Y,ie){super(),this.type="CubeCamera",this.renderTarget=ie,this.coordinateSystem=null,this.activeMipmapLevel=0;const ne=new PerspectiveCamera(fov,aspect,U,Y);ne.layers=this.layers,this.add(ne);const F=new PerspectiveCamera(fov,aspect,U,Y);F.layers=this.layers,this.add(F);const fe=new PerspectiveCamera(fov,aspect,U,Y);fe.layers=this.layers,this.add(fe);const pe=new PerspectiveCamera(fov,aspect,U,Y);pe.layers=this.layers,this.add(pe);const Me=new PerspectiveCamera(fov,aspect,U,Y);Me.layers=this.layers,this.add(Me);const ve=new PerspectiveCamera(fov,aspect,U,Y);ve.layers=this.layers,this.add(ve)}updateCoordinateSystem(){const U=this.coordinateSystem,Y=this.children.concat(),[ie,ne,F,fe,pe,Me]=Y;for(const ve of Y)this.remove(ve);if(U===WebGLCoordinateSystem)ie.up.set(0,1,0),ie.lookAt(1,0,0),ne.up.set(0,1,0),ne.lookAt(-1,0,0),F.up.set(0,0,-1),F.lookAt(0,1,0),fe.up.set(0,0,1),fe.lookAt(0,-1,0),pe.up.set(0,1,0),pe.lookAt(0,0,1),Me.up.set(0,1,0),Me.lookAt(0,0,-1);else if(U===WebGPUCoordinateSystem)ie.up.set(0,-1,0),ie.lookAt(-1,0,0),ne.up.set(0,-1,0),ne.lookAt(1,0,0),F.up.set(0,0,1),F.lookAt(0,1,0),fe.up.set(0,0,-1),fe.lookAt(0,-1,0),pe.up.set(0,-1,0),pe.lookAt(0,0,1),Me.up.set(0,-1,0),Me.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+U);for(const ve of Y)this.add(ve),ve.updateMatrixWorld()}update(U,Y){this.parent===null&&this.updateMatrixWorld();const{renderTarget:ie,activeMipmapLevel:ne}=this;this.coordinateSystem!==U.coordinateSystem&&(this.coordinateSystem=U.coordinateSystem,this.updateCoordinateSystem());const[F,fe,pe,Me,ve,se]=this.children,me=U.getRenderTarget(),Te=U.getActiveCubeFace(),Re=U.getActiveMipmapLevel(),be=U.xr.enabled;U.xr.enabled=!1;const Pe=ie.texture.generateMipmaps;ie.texture.generateMipmaps=!1,U.setRenderTarget(ie,0,ne),U.render(Y,F),U.setRenderTarget(ie,1,ne),U.render(Y,fe),U.setRenderTarget(ie,2,ne),U.render(Y,pe),U.setRenderTarget(ie,3,ne),U.render(Y,Me),U.setRenderTarget(ie,4,ne),U.render(Y,ve),ie.texture.generateMipmaps=Pe,U.setRenderTarget(ie,5,ne),U.render(Y,se),U.setRenderTarget(me,Te,Re),U.xr.enabled=be,ie.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture$1{constructor(U,Y,ie,ne,F,fe,pe,Me,ve,se){U=U!==void 0?U:[],Y=Y!==void 0?Y:CubeReflectionMapping,super(U,Y,ie,ne,F,fe,pe,Me,ve,se),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(U){this.image=U}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(U=1,Y={}){super(U,U,Y),this.isWebGLCubeRenderTarget=!0;const ie={width:U,height:U,depth:1},ne=[ie,ie,ie,ie,ie,ie];this.texture=new CubeTexture(ne,Y.mapping,Y.wrapS,Y.wrapT,Y.magFilter,Y.minFilter,Y.format,Y.type,Y.anisotropy,Y.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=Y.generateMipmaps!==void 0?Y.generateMipmaps:!1,this.texture.minFilter=Y.minFilter!==void 0?Y.minFilter:LinearFilter}fromEquirectangularTexture(U,Y){this.texture.type=Y.type,this.texture.colorSpace=Y.colorSpace,this.texture.generateMipmaps=Y.generateMipmaps,this.texture.minFilter=Y.minFilter,this.texture.magFilter=Y.magFilter;const ie={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},ne=new BoxGeometry(5,5,5),F=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(ie.uniforms),vertexShader:ie.vertexShader,fragmentShader:ie.fragmentShader,side:BackSide,blending:NoBlending});F.uniforms.tEquirect.value=Y;const fe=new Mesh(ne,F),pe=Y.minFilter;return Y.minFilter===LinearMipmapLinearFilter&&(Y.minFilter=LinearFilter),new CubeCamera(1,10,this).update(U,fe),Y.minFilter=pe,fe.geometry.dispose(),fe.material.dispose(),this}clear(U,Y,ie,ne){const F=U.getRenderTarget();for(let fe=0;fe<6;fe++)U.setRenderTarget(this,fe),U.clear(Y,ie,ne);U.setRenderTarget(F)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(U=new Vector3(1,0,0),Y=0){this.isPlane=!0,this.normal=U,this.constant=Y}set(U,Y){return this.normal.copy(U),this.constant=Y,this}setComponents(U,Y,ie,ne){return this.normal.set(U,Y,ie),this.constant=ne,this}setFromNormalAndCoplanarPoint(U,Y){return this.normal.copy(U),this.constant=-Y.dot(this.normal),this}setFromCoplanarPoints(U,Y,ie){const ne=_vector1.subVectors(ie,Y).cross(_vector2.subVectors(U,Y)).normalize();return this.setFromNormalAndCoplanarPoint(ne,U),this}copy(U){return this.normal.copy(U.normal),this.constant=U.constant,this}normalize(){const U=1/this.normal.length();return this.normal.multiplyScalar(U),this.constant*=U,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(U){return this.normal.dot(U)+this.constant}distanceToSphere(U){return this.distanceToPoint(U.center)-U.radius}projectPoint(U,Y){return Y.copy(U).addScaledVector(this.normal,-this.distanceToPoint(U))}intersectLine(U,Y){const ie=U.delta(_vector1),ne=this.normal.dot(ie);if(ne===0)return this.distanceToPoint(U.start)===0?Y.copy(U.start):null;const F=-(U.start.dot(this.normal)+this.constant)/ne;return F<0||F>1?null:Y.copy(U.start).addScaledVector(ie,F)}intersectsLine(U){const Y=this.distanceToPoint(U.start),ie=this.distanceToPoint(U.end);return Y<0&&ie>0||ie<0&&Y>0}intersectsBox(U){return U.intersectsPlane(this)}intersectsSphere(U){return U.intersectsPlane(this)}coplanarPoint(U){return U.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(U,Y){const ie=Y||_normalMatrix.getNormalMatrix(U),ne=this.coplanarPoint(_vector1).applyMatrix4(U),F=this.normal.applyMatrix3(ie).normalize();return this.constant=-ne.dot(F),this}translate(U){return this.constant-=U.dot(this.normal),this}equals(U){return U.normal.equals(this.normal)&&U.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(U=new Plane,Y=new Plane,ie=new Plane,ne=new Plane,F=new Plane,fe=new Plane){this.planes=[U,Y,ie,ne,F,fe]}set(U,Y,ie,ne,F,fe){const pe=this.planes;return pe[0].copy(U),pe[1].copy(Y),pe[2].copy(ie),pe[3].copy(ne),pe[4].copy(F),pe[5].copy(fe),this}copy(U){const Y=this.planes;for(let ie=0;ie<6;ie++)Y[ie].copy(U.planes[ie]);return this}setFromProjectionMatrix(U,Y=WebGLCoordinateSystem){const ie=this.planes,ne=U.elements,F=ne[0],fe=ne[1],pe=ne[2],Me=ne[3],ve=ne[4],se=ne[5],me=ne[6],Te=ne[7],Re=ne[8],be=ne[9],Pe=ne[10],Le=ne[11],xe=ne[12],Fe=ne[13],Oe=ne[14],Ne=ne[15];if(ie[0].setComponents(Me-F,Te-ve,Le-Re,Ne-xe).normalize(),ie[1].setComponents(Me+F,Te+ve,Le+Re,Ne+xe).normalize(),ie[2].setComponents(Me+fe,Te+se,Le+be,Ne+Fe).normalize(),ie[3].setComponents(Me-fe,Te-se,Le-be,Ne-Fe).normalize(),ie[4].setComponents(Me-pe,Te-me,Le-Pe,Ne-Oe).normalize(),Y===WebGLCoordinateSystem)ie[5].setComponents(Me+pe,Te+me,Le+Pe,Ne+Oe).normalize();else if(Y===WebGPUCoordinateSystem)ie[5].setComponents(pe,me,Pe,Oe).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+Y);return this}intersectsObject(U){if(U.boundingSphere!==void 0)U.boundingSphere===null&&U.computeBoundingSphere(),_sphere$5.copy(U.boundingSphere).applyMatrix4(U.matrixWorld);else{const Y=U.geometry;Y.boundingSphere===null&&Y.computeBoundingSphere(),_sphere$5.copy(Y.boundingSphere).applyMatrix4(U.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(U){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(U.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(U){const Y=this.planes,ie=U.center,ne=-U.radius;for(let F=0;F<6;F++)if(Y[F].distanceToPoint(ie)<ne)return!1;return!0}intersectsBox(U){const Y=this.planes;for(let ie=0;ie<6;ie++){const ne=Y[ie];if(_vector$7.x=ne.normal.x>0?U.max.x:U.min.x,_vector$7.y=ne.normal.y>0?U.max.y:U.min.y,_vector$7.z=ne.normal.z>0?U.max.z:U.min.z,ne.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(U){const Y=this.planes;for(let ie=0;ie<6;ie++)if(Y[ie].distanceToPoint(U)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let re=null,U=!1,Y=null,ie=null;function ne(F,fe){Y(F,fe),ie=re.requestAnimationFrame(ne)}return{start:function(){U!==!0&&Y!==null&&(ie=re.requestAnimationFrame(ne),U=!0)},stop:function(){re.cancelAnimationFrame(ie),U=!1},setAnimationLoop:function(F){Y=F},setContext:function(F){re=F}}}function WebGLAttributes(re){const U=new WeakMap;function Y(pe,Me){const ve=pe.array,se=pe.usage,me=ve.byteLength,Te=re.createBuffer();re.bindBuffer(Me,Te),re.bufferData(Me,ve,se),pe.onUploadCallback();let Re;if(ve instanceof Float32Array)Re=re.FLOAT;else if(ve instanceof Uint16Array)pe.isFloat16BufferAttribute?Re=re.HALF_FLOAT:Re=re.UNSIGNED_SHORT;else if(ve instanceof Int16Array)Re=re.SHORT;else if(ve instanceof Uint32Array)Re=re.UNSIGNED_INT;else if(ve instanceof Int32Array)Re=re.INT;else if(ve instanceof Int8Array)Re=re.BYTE;else if(ve instanceof Uint8Array)Re=re.UNSIGNED_BYTE;else if(ve instanceof Uint8ClampedArray)Re=re.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+ve);return{buffer:Te,type:Re,bytesPerElement:ve.BYTES_PER_ELEMENT,version:pe.version,size:me}}function ie(pe,Me,ve){const se=Me.array,me=Me.updateRanges;if(re.bindBuffer(ve,pe),me.length===0)re.bufferSubData(ve,0,se);else{me.sort((Re,be)=>Re.start-be.start);let Te=0;for(let Re=1;Re<me.length;Re++){const be=me[Te],Pe=me[Re];Pe.start<=be.start+be.count+1?be.count=Math.max(be.count,Pe.start+Pe.count-be.start):(++Te,me[Te]=Pe)}me.length=Te+1;for(let Re=0,be=me.length;Re<be;Re++){const Pe=me[Re];re.bufferSubData(ve,Pe.start*se.BYTES_PER_ELEMENT,se,Pe.start,Pe.count)}Me.clearUpdateRanges()}Me.onUploadCallback()}function ne(pe){return pe.isInterleavedBufferAttribute&&(pe=pe.data),U.get(pe)}function F(pe){pe.isInterleavedBufferAttribute&&(pe=pe.data);const Me=U.get(pe);Me&&(re.deleteBuffer(Me.buffer),U.delete(pe))}function fe(pe,Me){if(pe.isInterleavedBufferAttribute&&(pe=pe.data),pe.isGLBufferAttribute){const se=U.get(pe);(!se||se.version<pe.version)&&U.set(pe,{buffer:pe.buffer,type:pe.type,bytesPerElement:pe.elementSize,version:pe.version});return}const ve=U.get(pe);if(ve===void 0)U.set(pe,Y(pe,Me));else if(ve.version<pe.version){if(ve.size!==pe.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");ie(ve.buffer,pe,Me),ve.version=pe.version}}return{get:ne,remove:F,update:fe}}class PlaneGeometry extends BufferGeometry{constructor(U=1,Y=1,ie=1,ne=1){super(),this.type="PlaneGeometry",this.parameters={width:U,height:Y,widthSegments:ie,heightSegments:ne};const F=U/2,fe=Y/2,pe=Math.floor(ie),Me=Math.floor(ne),ve=pe+1,se=Me+1,me=U/pe,Te=Y/Me,Re=[],be=[],Pe=[],Le=[];for(let xe=0;xe<se;xe++){const Fe=xe*Te-fe;for(let Oe=0;Oe<ve;Oe++){const Ne=Oe*me-F;be.push(Ne,-Fe,0),Pe.push(0,0,1),Le.push(Oe/pe),Le.push(1-xe/Me)}}for(let xe=0;xe<Me;xe++)for(let Fe=0;Fe<pe;Fe++){const Oe=Fe+ve*xe,Ne=Fe+ve*(xe+1),ke=Fe+1+ve*(xe+1),Ve=Fe+1+ve*xe;Re.push(Oe,Ne,Ve),Re.push(Ne,ke,Ve)}this.setIndex(Re),this.setAttribute("position",new Float32BufferAttribute(be,3)),this.setAttribute("normal",new Float32BufferAttribute(Pe,3)),this.setAttribute("uv",new Float32BufferAttribute(Le,2))}copy(U){return super.copy(U),this.parameters=Object.assign({},U.parameters),this}static fromJSON(U){return new PlaneGeometry(U.width,U.height,U.widthSegments,U.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphinstance_vertex=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler,_m1$1=new Matrix4;function WebGLBackground(re,U,Y,ie,ne,F,fe){const pe=new Color(0);let Me=F===!0?0:1,ve,se,me=null,Te=0,Re=null;function be(Fe){let Oe=Fe.isScene===!0?Fe.background:null;return Oe&&Oe.isTexture&&(Oe=(Fe.backgroundBlurriness>0?Y:U).get(Oe)),Oe}function Pe(Fe){let Oe=!1;const Ne=be(Fe);Ne===null?xe(pe,Me):Ne&&Ne.isColor&&(xe(Ne,1),Oe=!0);const ke=re.xr.getEnvironmentBlendMode();ke==="additive"?ie.buffers.color.setClear(0,0,0,1,fe):ke==="alpha-blend"&&ie.buffers.color.setClear(0,0,0,0,fe),(re.autoClear||Oe)&&(ie.buffers.depth.setTest(!0),ie.buffers.depth.setMask(!0),ie.buffers.color.setMask(!0),re.clear(re.autoClearColor,re.autoClearDepth,re.autoClearStencil))}function Le(Fe,Oe){const Ne=be(Oe);Ne&&(Ne.isCubeTexture||Ne.mapping===CubeUVReflectionMapping)?(se===void 0&&(se=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),se.geometry.deleteAttribute("normal"),se.geometry.deleteAttribute("uv"),se.onBeforeRender=function(ke,Ve,Xe){this.matrixWorld.copyPosition(Xe.matrixWorld)},Object.defineProperty(se.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),ne.update(se)),_e1$1.copy(Oe.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,Ne.isCubeTexture&&Ne.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),se.material.uniforms.envMap.value=Ne,se.material.uniforms.flipEnvMap.value=Ne.isCubeTexture&&Ne.isRenderTargetTexture===!1?-1:1,se.material.uniforms.backgroundBlurriness.value=Oe.backgroundBlurriness,se.material.uniforms.backgroundIntensity.value=Oe.backgroundIntensity,se.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1.makeRotationFromEuler(_e1$1)),se.material.toneMapped=ColorManagement.getTransfer(Ne.colorSpace)!==SRGBTransfer,(me!==Ne||Te!==Ne.version||Re!==re.toneMapping)&&(se.material.needsUpdate=!0,me=Ne,Te=Ne.version,Re=re.toneMapping),se.layers.enableAll(),Fe.unshift(se,se.geometry,se.material,0,0,null)):Ne&&Ne.isTexture&&(ve===void 0&&(ve=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),ve.geometry.deleteAttribute("normal"),Object.defineProperty(ve.material,"map",{get:function(){return this.uniforms.t2D.value}}),ne.update(ve)),ve.material.uniforms.t2D.value=Ne,ve.material.uniforms.backgroundIntensity.value=Oe.backgroundIntensity,ve.material.toneMapped=ColorManagement.getTransfer(Ne.colorSpace)!==SRGBTransfer,Ne.matrixAutoUpdate===!0&&Ne.updateMatrix(),ve.material.uniforms.uvTransform.value.copy(Ne.matrix),(me!==Ne||Te!==Ne.version||Re!==re.toneMapping)&&(ve.material.needsUpdate=!0,me=Ne,Te=Ne.version,Re=re.toneMapping),ve.layers.enableAll(),Fe.unshift(ve,ve.geometry,ve.material,0,0,null))}function xe(Fe,Oe){Fe.getRGB(_rgb,getUnlitUniformColorSpace(re)),ie.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,Oe,fe)}return{getClearColor:function(){return pe},setClearColor:function(Fe,Oe=1){pe.set(Fe),Me=Oe,xe(pe,Me)},getClearAlpha:function(){return Me},setClearAlpha:function(Fe){Me=Fe,xe(pe,Me)},render:Pe,addToRenderList:Le}}function WebGLBindingStates(re,U){const Y=re.getParameter(re.MAX_VERTEX_ATTRIBS),ie={},ne=Te(null);let F=ne,fe=!1;function pe(ze,tt,ft,Rt,Mt){let Gt=!1;const _t=me(Rt,ft,tt);F!==_t&&(F=_t,ve(F.object)),Gt=Re(ze,Rt,ft,Mt),Gt&&be(ze,Rt,ft,Mt),Mt!==null&&U.update(Mt,re.ELEMENT_ARRAY_BUFFER),(Gt||fe)&&(fe=!1,Ne(ze,tt,ft,Rt),Mt!==null&&re.bindBuffer(re.ELEMENT_ARRAY_BUFFER,U.get(Mt).buffer))}function Me(){return re.createVertexArray()}function ve(ze){return re.bindVertexArray(ze)}function se(ze){return re.deleteVertexArray(ze)}function me(ze,tt,ft){const Rt=ft.wireframe===!0;let Mt=ie[ze.id];Mt===void 0&&(Mt={},ie[ze.id]=Mt);let Gt=Mt[tt.id];Gt===void 0&&(Gt={},Mt[tt.id]=Gt);let _t=Gt[Rt];return _t===void 0&&(_t=Te(Me()),Gt[Rt]=_t),_t}function Te(ze){const tt=[],ft=[],Rt=[];for(let Mt=0;Mt<Y;Mt++)tt[Mt]=0,ft[Mt]=0,Rt[Mt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:tt,enabledAttributes:ft,attributeDivisors:Rt,object:ze,attributes:{},index:null}}function Re(ze,tt,ft,Rt){const Mt=F.attributes,Gt=tt.attributes;let _t=0;const Bt=ft.getAttributes();for(const dt in Bt)if(Bt[dt].location>=0){const Ut=Mt[dt];let Tt=Gt[dt];if(Tt===void 0&&(dt==="instanceMatrix"&&ze.instanceMatrix&&(Tt=ze.instanceMatrix),dt==="instanceColor"&&ze.instanceColor&&(Tt=ze.instanceColor)),Ut===void 0||Ut.attribute!==Tt||Tt&&Ut.data!==Tt.data)return!0;_t++}return F.attributesNum!==_t||F.index!==Rt}function be(ze,tt,ft,Rt){const Mt={},Gt=tt.attributes;let _t=0;const Bt=ft.getAttributes();for(const dt in Bt)if(Bt[dt].location>=0){let Ut=Gt[dt];Ut===void 0&&(dt==="instanceMatrix"&&ze.instanceMatrix&&(Ut=ze.instanceMatrix),dt==="instanceColor"&&ze.instanceColor&&(Ut=ze.instanceColor));const Tt={};Tt.attribute=Ut,Ut&&Ut.data&&(Tt.data=Ut.data),Mt[dt]=Tt,_t++}F.attributes=Mt,F.attributesNum=_t,F.index=Rt}function Pe(){const ze=F.newAttributes;for(let tt=0,ft=ze.length;tt<ft;tt++)ze[tt]=0}function Le(ze){xe(ze,0)}function xe(ze,tt){const ft=F.newAttributes,Rt=F.enabledAttributes,Mt=F.attributeDivisors;ft[ze]=1,Rt[ze]===0&&(re.enableVertexAttribArray(ze),Rt[ze]=1),Mt[ze]!==tt&&(re.vertexAttribDivisor(ze,tt),Mt[ze]=tt)}function Fe(){const ze=F.newAttributes,tt=F.enabledAttributes;for(let ft=0,Rt=tt.length;ft<Rt;ft++)tt[ft]!==ze[ft]&&(re.disableVertexAttribArray(ft),tt[ft]=0)}function Oe(ze,tt,ft,Rt,Mt,Gt,_t){_t===!0?re.vertexAttribIPointer(ze,tt,ft,Mt,Gt):re.vertexAttribPointer(ze,tt,ft,Rt,Mt,Gt)}function Ne(ze,tt,ft,Rt){Pe();const Mt=Rt.attributes,Gt=ft.getAttributes(),_t=tt.defaultAttributeValues;for(const Bt in Gt){const dt=Gt[Bt];if(dt.location>=0){let ut=Mt[Bt];if(ut===void 0&&(Bt==="instanceMatrix"&&ze.instanceMatrix&&(ut=ze.instanceMatrix),Bt==="instanceColor"&&ze.instanceColor&&(ut=ze.instanceColor)),ut!==void 0){const Ut=ut.normalized,Tt=ut.itemSize,Xt=U.get(ut);if(Xt===void 0)continue;const hn=Xt.buffer,nn=Xt.type,An=Xt.bytesPerElement,Cn=nn===re.INT||nn===re.UNSIGNED_INT||ut.gpuType===IntType;if(ut.isInterleavedBufferAttribute){const Nn=ut.data,Qn=Nn.stride,fi=ut.offset;if(Nn.isInstancedInterleavedBuffer){for(let hi=0;hi<dt.locationSize;hi++)xe(dt.location+hi,Nn.meshPerAttribute);ze.isInstancedMesh!==!0&&Rt._maxInstanceCount===void 0&&(Rt._maxInstanceCount=Nn.meshPerAttribute*Nn.count)}else for(let hi=0;hi<dt.locationSize;hi++)Le(dt.location+hi);re.bindBuffer(re.ARRAY_BUFFER,hn);for(let hi=0;hi<dt.locationSize;hi++)Oe(dt.location+hi,Tt/dt.locationSize,nn,Ut,Qn*An,(fi+Tt/dt.locationSize*hi)*An,Cn)}else{if(ut.isInstancedBufferAttribute){for(let Nn=0;Nn<dt.locationSize;Nn++)xe(dt.location+Nn,ut.meshPerAttribute);ze.isInstancedMesh!==!0&&Rt._maxInstanceCount===void 0&&(Rt._maxInstanceCount=ut.meshPerAttribute*ut.count)}else for(let Nn=0;Nn<dt.locationSize;Nn++)Le(dt.location+Nn);re.bindBuffer(re.ARRAY_BUFFER,hn);for(let Nn=0;Nn<dt.locationSize;Nn++)Oe(dt.location+Nn,Tt/dt.locationSize,nn,Ut,Tt*An,Tt/dt.locationSize*Nn*An,Cn)}}else if(_t!==void 0){const Ut=_t[Bt];if(Ut!==void 0)switch(Ut.length){case 2:re.vertexAttrib2fv(dt.location,Ut);break;case 3:re.vertexAttrib3fv(dt.location,Ut);break;case 4:re.vertexAttrib4fv(dt.location,Ut);break;default:re.vertexAttrib1fv(dt.location,Ut)}}}}Fe()}function ke(){$e();for(const ze in ie){const tt=ie[ze];for(const ft in tt){const Rt=tt[ft];for(const Mt in Rt)se(Rt[Mt].object),delete Rt[Mt];delete tt[ft]}delete ie[ze]}}function Ve(ze){if(ie[ze.id]===void 0)return;const tt=ie[ze.id];for(const ft in tt){const Rt=tt[ft];for(const Mt in Rt)se(Rt[Mt].object),delete Rt[Mt];delete tt[ft]}delete ie[ze.id]}function Xe(ze){for(const tt in ie){const ft=ie[tt];if(ft[ze.id]===void 0)continue;const Rt=ft[ze.id];for(const Mt in Rt)se(Rt[Mt].object),delete Rt[Mt];delete ft[ze.id]}}function $e(){st(),fe=!0,F!==ne&&(F=ne,ve(F.object))}function st(){ne.geometry=null,ne.program=null,ne.wireframe=!1}return{setup:pe,reset:$e,resetDefaultState:st,dispose:ke,releaseStatesOfGeometry:Ve,releaseStatesOfProgram:Xe,initAttributes:Pe,enableAttribute:Le,disableUnusedAttributes:Fe}}function WebGLBufferRenderer(re,U,Y){let ie;function ne(ve){ie=ve}function F(ve,se){re.drawArrays(ie,ve,se),Y.update(se,ie,1)}function fe(ve,se,me){me!==0&&(re.drawArraysInstanced(ie,ve,se,me),Y.update(se,ie,me))}function pe(ve,se,me){if(me===0)return;U.get("WEBGL_multi_draw").multiDrawArraysWEBGL(ie,ve,0,se,0,me);let Re=0;for(let be=0;be<me;be++)Re+=se[be];Y.update(Re,ie,1)}function Me(ve,se,me,Te){if(me===0)return;const Re=U.get("WEBGL_multi_draw");if(Re===null)for(let be=0;be<ve.length;be++)fe(ve[be],se[be],Te[be]);else{Re.multiDrawArraysInstancedWEBGL(ie,ve,0,se,0,Te,0,me);let be=0;for(let Pe=0;Pe<me;Pe++)be+=se[Pe];for(let Pe=0;Pe<Te.length;Pe++)Y.update(be,ie,Te[Pe])}}this.setMode=ne,this.render=F,this.renderInstances=fe,this.renderMultiDraw=pe,this.renderMultiDrawInstances=Me}function WebGLCapabilities(re,U,Y,ie){let ne;function F(){if(ne!==void 0)return ne;if(U.has("EXT_texture_filter_anisotropic")===!0){const Xe=U.get("EXT_texture_filter_anisotropic");ne=re.getParameter(Xe.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else ne=0;return ne}function fe(Xe){return!(Xe!==RGBAFormat&&ie.convert(Xe)!==re.getParameter(re.IMPLEMENTATION_COLOR_READ_FORMAT))}function pe(Xe){const $e=Xe===HalfFloatType&&(U.has("EXT_color_buffer_half_float")||U.has("EXT_color_buffer_float"));return!(Xe!==UnsignedByteType&&ie.convert(Xe)!==re.getParameter(re.IMPLEMENTATION_COLOR_READ_TYPE)&&Xe!==FloatType&&!$e)}function Me(Xe){if(Xe==="highp"){if(re.getShaderPrecisionFormat(re.VERTEX_SHADER,re.HIGH_FLOAT).precision>0&&re.getShaderPrecisionFormat(re.FRAGMENT_SHADER,re.HIGH_FLOAT).precision>0)return"highp";Xe="mediump"}return Xe==="mediump"&&re.getShaderPrecisionFormat(re.VERTEX_SHADER,re.MEDIUM_FLOAT).precision>0&&re.getShaderPrecisionFormat(re.FRAGMENT_SHADER,re.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let ve=Y.precision!==void 0?Y.precision:"highp";const se=Me(ve);se!==ve&&(console.warn("THREE.WebGLRenderer:",ve,"not supported, using",se,"instead."),ve=se);const me=Y.logarithmicDepthBuffer===!0,Te=Y.reverseDepthBuffer===!0&&U.has("EXT_clip_control");if(Te===!0){const Xe=U.get("EXT_clip_control");Xe.clipControlEXT(Xe.LOWER_LEFT_EXT,Xe.ZERO_TO_ONE_EXT)}const Re=re.getParameter(re.MAX_TEXTURE_IMAGE_UNITS),be=re.getParameter(re.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Pe=re.getParameter(re.MAX_TEXTURE_SIZE),Le=re.getParameter(re.MAX_CUBE_MAP_TEXTURE_SIZE),xe=re.getParameter(re.MAX_VERTEX_ATTRIBS),Fe=re.getParameter(re.MAX_VERTEX_UNIFORM_VECTORS),Oe=re.getParameter(re.MAX_VARYING_VECTORS),Ne=re.getParameter(re.MAX_FRAGMENT_UNIFORM_VECTORS),ke=be>0,Ve=re.getParameter(re.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:F,getMaxPrecision:Me,textureFormatReadable:fe,textureTypeReadable:pe,precision:ve,logarithmicDepthBuffer:me,reverseDepthBuffer:Te,maxTextures:Re,maxVertexTextures:be,maxTextureSize:Pe,maxCubemapSize:Le,maxAttributes:xe,maxVertexUniforms:Fe,maxVaryings:Oe,maxFragmentUniforms:Ne,vertexTextures:ke,maxSamples:Ve}}function WebGLClipping(re){const U=this;let Y=null,ie=0,ne=!1,F=!1;const fe=new Plane,pe=new Matrix3,Me={value:null,needsUpdate:!1};this.uniform=Me,this.numPlanes=0,this.numIntersection=0,this.init=function(me,Te){const Re=me.length!==0||Te||ie!==0||ne;return ne=Te,ie=me.length,Re},this.beginShadows=function(){F=!0,se(null)},this.endShadows=function(){F=!1},this.setGlobalState=function(me,Te){Y=se(me,Te,0)},this.setState=function(me,Te,Re){const be=me.clippingPlanes,Pe=me.clipIntersection,Le=me.clipShadows,xe=re.get(me);if(!ne||be===null||be.length===0||F&&!Le)F?se(null):ve();else{const Fe=F?0:ie,Oe=Fe*4;let Ne=xe.clippingState||null;Me.value=Ne,Ne=se(be,Te,Oe,Re);for(let ke=0;ke!==Oe;++ke)Ne[ke]=Y[ke];xe.clippingState=Ne,this.numIntersection=Pe?this.numPlanes:0,this.numPlanes+=Fe}};function ve(){Me.value!==Y&&(Me.value=Y,Me.needsUpdate=ie>0),U.numPlanes=ie,U.numIntersection=0}function se(me,Te,Re,be){const Pe=me!==null?me.length:0;let Le=null;if(Pe!==0){if(Le=Me.value,be!==!0||Le===null){const xe=Re+Pe*4,Fe=Te.matrixWorldInverse;pe.getNormalMatrix(Fe),(Le===null||Le.length<xe)&&(Le=new Float32Array(xe));for(let Oe=0,Ne=Re;Oe!==Pe;++Oe,Ne+=4)fe.copy(me[Oe]).applyMatrix4(Fe,pe),fe.normal.toArray(Le,Ne),Le[Ne+3]=fe.constant}Me.value=Le,Me.needsUpdate=!0}return U.numPlanes=Pe,U.numIntersection=0,Le}}function WebGLCubeMaps(re){let U=new WeakMap;function Y(fe,pe){return pe===EquirectangularReflectionMapping?fe.mapping=CubeReflectionMapping:pe===EquirectangularRefractionMapping&&(fe.mapping=CubeRefractionMapping),fe}function ie(fe){if(fe&&fe.isTexture){const pe=fe.mapping;if(pe===EquirectangularReflectionMapping||pe===EquirectangularRefractionMapping)if(U.has(fe)){const Me=U.get(fe).texture;return Y(Me,fe.mapping)}else{const Me=fe.image;if(Me&&Me.height>0){const ve=new WebGLCubeRenderTarget(Me.height);return ve.fromEquirectangularTexture(re,fe),U.set(fe,ve),fe.addEventListener("dispose",ne),Y(ve.texture,fe.mapping)}else return null}}return fe}function ne(fe){const pe=fe.target;pe.removeEventListener("dispose",ne);const Me=U.get(pe);Me!==void 0&&(U.delete(pe),Me.dispose())}function F(){U=new WeakMap}return{get:ie,dispose:F}}class OrthographicCamera extends Camera{constructor(U=-1,Y=1,ie=1,ne=-1,F=.1,fe=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=U,this.right=Y,this.top=ie,this.bottom=ne,this.near=F,this.far=fe,this.updateProjectionMatrix()}copy(U,Y){return super.copy(U,Y),this.left=U.left,this.right=U.right,this.top=U.top,this.bottom=U.bottom,this.near=U.near,this.far=U.far,this.zoom=U.zoom,this.view=U.view===null?null:Object.assign({},U.view),this}setViewOffset(U,Y,ie,ne,F,fe){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=U,this.view.fullHeight=Y,this.view.offsetX=ie,this.view.offsetY=ne,this.view.width=F,this.view.height=fe,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const U=(this.right-this.left)/(2*this.zoom),Y=(this.top-this.bottom)/(2*this.zoom),ie=(this.right+this.left)/2,ne=(this.top+this.bottom)/2;let F=ie-U,fe=ie+U,pe=ne+Y,Me=ne-Y;if(this.view!==null&&this.view.enabled){const ve=(this.right-this.left)/this.view.fullWidth/this.zoom,se=(this.top-this.bottom)/this.view.fullHeight/this.zoom;F+=ve*this.view.offsetX,fe=F+ve*this.view.width,pe-=se*this.view.offsetY,Me=pe-se*this.view.height}this.projectionMatrix.makeOrthographic(F,fe,pe,Me,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(U){const Y=super.toJSON(U);return Y.object.zoom=this.zoom,Y.object.left=this.left,Y.object.right=this.right,Y.object.top=this.top,Y.object.bottom=this.bottom,Y.object.near=this.near,Y.object.far=this.far,this.view!==null&&(Y.object.view=Object.assign({},this.view)),Y}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES$1=20,_flatCamera=new OrthographicCamera,_clearColor=new Color;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0,_oldXrEnabled=!1;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(-PHI,INV_PHI,0),new Vector3(PHI,INV_PHI,0),new Vector3(-INV_PHI,0,PHI),new Vector3(INV_PHI,0,PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(0,PHI,INV_PHI),new Vector3(-1,1,-1),new Vector3(1,1,-1),new Vector3(-1,1,1),new Vector3(1,1,1)];class PMREMGenerator{constructor(U){this._renderer=U,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(U,Y=0,ie=.1,ne=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const F=this._allocateTargets();return F.depthBuffer=!0,this._sceneToCubeUV(U,ie,ne,F),Y>0&&this._blur(F,0,0,Y),this._applyPMREM(F),this._cleanup(F),F}fromEquirectangular(U,Y=null){return this._fromTexture(U,Y)}fromCubemap(U,Y=null){return this._fromTexture(U,Y)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(U){this._lodMax=Math.floor(Math.log2(U)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let U=0;U<this._lodPlanes.length;U++)this._lodPlanes[U].dispose()}_cleanup(U){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),this._renderer.xr.enabled=_oldXrEnabled,U.scissorTest=!1,_setViewport(U,0,0,U.width,U.height)}_fromTexture(U,Y){U.mapping===CubeReflectionMapping||U.mapping===CubeRefractionMapping?this._setSize(U.image.length===0?16:U.image[0].width||U.image[0].image.width):this._setSize(U.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const ie=Y||this._allocateTargets();return this._textureToCubeUV(U,ie),this._applyPMREM(ie),this._cleanup(ie),ie}_allocateTargets(){const U=3*Math.max(this._cubeSize,112),Y=4*this._cubeSize,ie={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},ne=_createRenderTarget(U,Y,ie);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==U||this._pingPongRenderTarget.height!==Y){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(U,Y,ie);const{_lodMax:F}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(F)),this._blurMaterial=_getBlurShader(F,U,Y)}return ne}_compileMaterial(U){const Y=new Mesh(this._lodPlanes[0],U);this._renderer.compile(Y,_flatCamera)}_sceneToCubeUV(U,Y,ie,ne){const pe=new PerspectiveCamera(90,1,Y,ie),Me=[1,-1,1,1,1,1],ve=[1,1,1,-1,-1,-1],se=this._renderer,me=se.autoClear,Te=se.toneMapping;se.getClearColor(_clearColor),se.toneMapping=NoToneMapping,se.autoClear=!1;const Re=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),be=new Mesh(new BoxGeometry,Re);let Pe=!1;const Le=U.background;Le?Le.isColor&&(Re.color.copy(Le),U.background=null,Pe=!0):(Re.color.copy(_clearColor),Pe=!0);for(let xe=0;xe<6;xe++){const Fe=xe%3;Fe===0?(pe.up.set(0,Me[xe],0),pe.lookAt(ve[xe],0,0)):Fe===1?(pe.up.set(0,0,Me[xe]),pe.lookAt(0,ve[xe],0)):(pe.up.set(0,Me[xe],0),pe.lookAt(0,0,ve[xe]));const Oe=this._cubeSize;_setViewport(ne,Fe*Oe,xe>2?Oe:0,Oe,Oe),se.setRenderTarget(ne),Pe&&se.render(be,pe),se.render(U,pe)}be.geometry.dispose(),be.material.dispose(),se.toneMapping=Te,se.autoClear=me,U.background=Le}_textureToCubeUV(U,Y){const ie=this._renderer,ne=U.mapping===CubeReflectionMapping||U.mapping===CubeRefractionMapping;ne?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=U.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const F=ne?this._cubemapMaterial:this._equirectMaterial,fe=new Mesh(this._lodPlanes[0],F),pe=F.uniforms;pe.envMap.value=U;const Me=this._cubeSize;_setViewport(Y,0,0,3*Me,2*Me),ie.setRenderTarget(Y),ie.render(fe,_flatCamera)}_applyPMREM(U){const Y=this._renderer,ie=Y.autoClear;Y.autoClear=!1;const ne=this._lodPlanes.length;for(let F=1;F<ne;F++){const fe=Math.sqrt(this._sigmas[F]*this._sigmas[F]-this._sigmas[F-1]*this._sigmas[F-1]),pe=_axisDirections[(ne-F-1)%_axisDirections.length];this._blur(U,F-1,F,fe,pe)}Y.autoClear=ie}_blur(U,Y,ie,ne,F){const fe=this._pingPongRenderTarget;this._halfBlur(U,fe,Y,ie,ne,"latitudinal",F),this._halfBlur(fe,U,ie,ie,ne,"longitudinal",F)}_halfBlur(U,Y,ie,ne,F,fe,pe){const Me=this._renderer,ve=this._blurMaterial;fe!=="latitudinal"&&fe!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const se=3,me=new Mesh(this._lodPlanes[ne],ve),Te=ve.uniforms,Re=this._sizeLods[ie]-1,be=isFinite(F)?Math.PI/(2*Re):2*Math.PI/(2*MAX_SAMPLES$1-1),Pe=F/be,Le=isFinite(F)?1+Math.floor(se*Pe):MAX_SAMPLES$1;Le>MAX_SAMPLES$1&&console.warn(`sigmaRadians, ${F}, is too large and will clip, as it requested ${Le} samples when the maximum is set to ${MAX_SAMPLES$1}`);const xe=[];let Fe=0;for(let Xe=0;Xe<MAX_SAMPLES$1;++Xe){const $e=Xe/Pe,st=Math.exp(-$e*$e/2);xe.push(st),Xe===0?Fe+=st:Xe<Le&&(Fe+=2*st)}for(let Xe=0;Xe<xe.length;Xe++)xe[Xe]=xe[Xe]/Fe;Te.envMap.value=U.texture,Te.samples.value=Le,Te.weights.value=xe,Te.latitudinal.value=fe==="latitudinal",pe&&(Te.poleAxis.value=pe);const{_lodMax:Oe}=this;Te.dTheta.value=be,Te.mipInt.value=Oe-ie;const Ne=this._sizeLods[ne],ke=3*Ne*(ne>Oe-LOD_MIN?ne-Oe+LOD_MIN:0),Ve=4*(this._cubeSize-Ne);_setViewport(Y,ke,Ve,3*Ne,2*Ne),Me.setRenderTarget(Y),Me.render(me,_flatCamera)}}function _createPlanes(re){const U=[],Y=[],ie=[];let ne=re;const F=re-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let fe=0;fe<F;fe++){const pe=Math.pow(2,ne);Y.push(pe);let Me=1/pe;fe>re-LOD_MIN?Me=EXTRA_LOD_SIGMA[fe-re+LOD_MIN-1]:fe===0&&(Me=0),ie.push(Me);const ve=1/(pe-2),se=-ve,me=1+ve,Te=[se,se,me,se,me,me,se,se,me,me,se,me],Re=6,be=6,Pe=3,Le=2,xe=1,Fe=new Float32Array(Pe*be*Re),Oe=new Float32Array(Le*be*Re),Ne=new Float32Array(xe*be*Re);for(let Ve=0;Ve<Re;Ve++){const Xe=Ve%3*2/3-1,$e=Ve>2?0:-1,st=[Xe,$e,0,Xe+2/3,$e,0,Xe+2/3,$e+1,0,Xe,$e,0,Xe+2/3,$e+1,0,Xe,$e+1,0];Fe.set(st,Pe*be*Ve),Oe.set(Te,Le*be*Ve);const ze=[Ve,Ve,Ve,Ve,Ve,Ve];Ne.set(ze,xe*be*Ve)}const ke=new BufferGeometry;ke.setAttribute("position",new BufferAttribute(Fe,Pe)),ke.setAttribute("uv",new BufferAttribute(Oe,Le)),ke.setAttribute("faceIndex",new BufferAttribute(Ne,xe)),U.push(ke),ne>LOD_MIN&&ne--}return{lodPlanes:U,sizeLods:Y,sigmas:ie}}function _createRenderTarget(re,U,Y){const ie=new WebGLRenderTarget(re,U,Y);return ie.texture.mapping=CubeUVReflectionMapping,ie.texture.name="PMREM.cubeUv",ie.scissorTest=!0,ie}function _setViewport(re,U,Y,ie,ne){re.viewport.set(U,Y,ie,ne),re.scissor.set(U,Y,ie,ne)}function _getBlurShader(re,U,Y){const ie=new Float32Array(MAX_SAMPLES$1),ne=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES$1,CUBEUV_TEXEL_WIDTH:1/U,CUBEUV_TEXEL_HEIGHT:1/Y,CUBEUV_MAX_MIP:`${re}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:ie},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:ne}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(re){let U=new WeakMap,Y=null;function ie(pe){if(pe&&pe.isTexture){const Me=pe.mapping,ve=Me===EquirectangularReflectionMapping||Me===EquirectangularRefractionMapping,se=Me===CubeReflectionMapping||Me===CubeRefractionMapping;if(ve||se){let me=U.get(pe);const Te=me!==void 0?me.texture.pmremVersion:0;if(pe.isRenderTargetTexture&&pe.pmremVersion!==Te)return Y===null&&(Y=new PMREMGenerator(re)),me=ve?Y.fromEquirectangular(pe,me):Y.fromCubemap(pe,me),me.texture.pmremVersion=pe.pmremVersion,U.set(pe,me),me.texture;if(me!==void 0)return me.texture;{const Re=pe.image;return ve&&Re&&Re.height>0||se&&Re&&ne(Re)?(Y===null&&(Y=new PMREMGenerator(re)),me=ve?Y.fromEquirectangular(pe):Y.fromCubemap(pe),me.texture.pmremVersion=pe.pmremVersion,U.set(pe,me),pe.addEventListener("dispose",F),me.texture):null}}}return pe}function ne(pe){let Me=0;const ve=6;for(let se=0;se<ve;se++)pe[se]!==void 0&&Me++;return Me===ve}function F(pe){const Me=pe.target;Me.removeEventListener("dispose",F);const ve=U.get(Me);ve!==void 0&&(U.delete(Me),ve.dispose())}function fe(){U=new WeakMap,Y!==null&&(Y.dispose(),Y=null)}return{get:ie,dispose:fe}}function WebGLExtensions(re){const U={};function Y(ie){if(U[ie]!==void 0)return U[ie];let ne;switch(ie){case"WEBGL_depth_texture":ne=re.getExtension("WEBGL_depth_texture")||re.getExtension("MOZ_WEBGL_depth_texture")||re.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":ne=re.getExtension("EXT_texture_filter_anisotropic")||re.getExtension("MOZ_EXT_texture_filter_anisotropic")||re.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":ne=re.getExtension("WEBGL_compressed_texture_s3tc")||re.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||re.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":ne=re.getExtension("WEBGL_compressed_texture_pvrtc")||re.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:ne=re.getExtension(ie)}return U[ie]=ne,ne}return{has:function(ie){return Y(ie)!==null},init:function(){Y("EXT_color_buffer_float"),Y("WEBGL_clip_cull_distance"),Y("OES_texture_float_linear"),Y("EXT_color_buffer_half_float"),Y("WEBGL_multisampled_render_to_texture"),Y("WEBGL_render_shared_exponent")},get:function(ie){const ne=Y(ie);return ne===null&&warnOnce("THREE.WebGLRenderer: "+ie+" extension not supported."),ne}}}function WebGLGeometries(re,U,Y,ie){const ne={},F=new WeakMap;function fe(me){const Te=me.target;Te.index!==null&&U.remove(Te.index);for(const be in Te.attributes)U.remove(Te.attributes[be]);for(const be in Te.morphAttributes){const Pe=Te.morphAttributes[be];for(let Le=0,xe=Pe.length;Le<xe;Le++)U.remove(Pe[Le])}Te.removeEventListener("dispose",fe),delete ne[Te.id];const Re=F.get(Te);Re&&(U.remove(Re),F.delete(Te)),ie.releaseStatesOfGeometry(Te),Te.isInstancedBufferGeometry===!0&&delete Te._maxInstanceCount,Y.memory.geometries--}function pe(me,Te){return ne[Te.id]===!0||(Te.addEventListener("dispose",fe),ne[Te.id]=!0,Y.memory.geometries++),Te}function Me(me){const Te=me.attributes;for(const be in Te)U.update(Te[be],re.ARRAY_BUFFER);const Re=me.morphAttributes;for(const be in Re){const Pe=Re[be];for(let Le=0,xe=Pe.length;Le<xe;Le++)U.update(Pe[Le],re.ARRAY_BUFFER)}}function ve(me){const Te=[],Re=me.index,be=me.attributes.position;let Pe=0;if(Re!==null){const Fe=Re.array;Pe=Re.version;for(let Oe=0,Ne=Fe.length;Oe<Ne;Oe+=3){const ke=Fe[Oe+0],Ve=Fe[Oe+1],Xe=Fe[Oe+2];Te.push(ke,Ve,Ve,Xe,Xe,ke)}}else if(be!==void 0){const Fe=be.array;Pe=be.version;for(let Oe=0,Ne=Fe.length/3-1;Oe<Ne;Oe+=3){const ke=Oe+0,Ve=Oe+1,Xe=Oe+2;Te.push(ke,Ve,Ve,Xe,Xe,ke)}}else return;const Le=new(arrayNeedsUint32(Te)?Uint32BufferAttribute:Uint16BufferAttribute)(Te,1);Le.version=Pe;const xe=F.get(me);xe&&U.remove(xe),F.set(me,Le)}function se(me){const Te=F.get(me);if(Te){const Re=me.index;Re!==null&&Te.version<Re.version&&ve(me)}else ve(me);return F.get(me)}return{get:pe,update:Me,getWireframeAttribute:se}}function WebGLIndexedBufferRenderer(re,U,Y){let ie;function ne(Te){ie=Te}let F,fe;function pe(Te){F=Te.type,fe=Te.bytesPerElement}function Me(Te,Re){re.drawElements(ie,Re,F,Te*fe),Y.update(Re,ie,1)}function ve(Te,Re,be){be!==0&&(re.drawElementsInstanced(ie,Re,F,Te*fe,be),Y.update(Re,ie,be))}function se(Te,Re,be){if(be===0)return;U.get("WEBGL_multi_draw").multiDrawElementsWEBGL(ie,Re,0,F,Te,0,be);let Le=0;for(let xe=0;xe<be;xe++)Le+=Re[xe];Y.update(Le,ie,1)}function me(Te,Re,be,Pe){if(be===0)return;const Le=U.get("WEBGL_multi_draw");if(Le===null)for(let xe=0;xe<Te.length;xe++)ve(Te[xe]/fe,Re[xe],Pe[xe]);else{Le.multiDrawElementsInstancedWEBGL(ie,Re,0,F,Te,0,Pe,0,be);let xe=0;for(let Fe=0;Fe<be;Fe++)xe+=Re[Fe];for(let Fe=0;Fe<Pe.length;Fe++)Y.update(xe,ie,Pe[Fe])}}this.setMode=ne,this.setIndex=pe,this.render=Me,this.renderInstances=ve,this.renderMultiDraw=se,this.renderMultiDrawInstances=me}function WebGLInfo(re){const U={geometries:0,textures:0},Y={frame:0,calls:0,triangles:0,points:0,lines:0};function ie(F,fe,pe){switch(Y.calls++,fe){case re.TRIANGLES:Y.triangles+=pe*(F/3);break;case re.LINES:Y.lines+=pe*(F/2);break;case re.LINE_STRIP:Y.lines+=pe*(F-1);break;case re.LINE_LOOP:Y.lines+=pe*F;break;case re.POINTS:Y.points+=pe*F;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",fe);break}}function ne(){Y.calls=0,Y.triangles=0,Y.points=0,Y.lines=0}return{memory:U,render:Y,programs:null,autoReset:!0,reset:ne,update:ie}}function WebGLMorphtargets(re,U,Y){const ie=new WeakMap,ne=new Vector4;function F(fe,pe,Me){const ve=fe.morphTargetInfluences,se=pe.morphAttributes.position||pe.morphAttributes.normal||pe.morphAttributes.color,me=se!==void 0?se.length:0;let Te=ie.get(pe);if(Te===void 0||Te.count!==me){let ze=function(){$e.dispose(),ie.delete(pe),pe.removeEventListener("dispose",ze)};var Re=ze;Te!==void 0&&Te.texture.dispose();const be=pe.morphAttributes.position!==void 0,Pe=pe.morphAttributes.normal!==void 0,Le=pe.morphAttributes.color!==void 0,xe=pe.morphAttributes.position||[],Fe=pe.morphAttributes.normal||[],Oe=pe.morphAttributes.color||[];let Ne=0;be===!0&&(Ne=1),Pe===!0&&(Ne=2),Le===!0&&(Ne=3);let ke=pe.attributes.position.count*Ne,Ve=1;ke>U.maxTextureSize&&(Ve=Math.ceil(ke/U.maxTextureSize),ke=U.maxTextureSize);const Xe=new Float32Array(ke*Ve*4*me),$e=new DataArrayTexture(Xe,ke,Ve,me);$e.type=FloatType,$e.needsUpdate=!0;const st=Ne*4;for(let tt=0;tt<me;tt++){const ft=xe[tt],Rt=Fe[tt],Mt=Oe[tt],Gt=ke*Ve*4*tt;for(let _t=0;_t<ft.count;_t++){const Bt=_t*st;be===!0&&(ne.fromBufferAttribute(ft,_t),Xe[Gt+Bt+0]=ne.x,Xe[Gt+Bt+1]=ne.y,Xe[Gt+Bt+2]=ne.z,Xe[Gt+Bt+3]=0),Pe===!0&&(ne.fromBufferAttribute(Rt,_t),Xe[Gt+Bt+4]=ne.x,Xe[Gt+Bt+5]=ne.y,Xe[Gt+Bt+6]=ne.z,Xe[Gt+Bt+7]=0),Le===!0&&(ne.fromBufferAttribute(Mt,_t),Xe[Gt+Bt+8]=ne.x,Xe[Gt+Bt+9]=ne.y,Xe[Gt+Bt+10]=ne.z,Xe[Gt+Bt+11]=Mt.itemSize===4?ne.w:1)}}Te={count:me,texture:$e,size:new Vector2(ke,Ve)},ie.set(pe,Te),pe.addEventListener("dispose",ze)}if(fe.isInstancedMesh===!0&&fe.morphTexture!==null)Me.getUniforms().setValue(re,"morphTexture",fe.morphTexture,Y);else{let be=0;for(let Le=0;Le<ve.length;Le++)be+=ve[Le];const Pe=pe.morphTargetsRelative?1:1-be;Me.getUniforms().setValue(re,"morphTargetBaseInfluence",Pe),Me.getUniforms().setValue(re,"morphTargetInfluences",ve)}Me.getUniforms().setValue(re,"morphTargetsTexture",Te.texture,Y),Me.getUniforms().setValue(re,"morphTargetsTextureSize",Te.size)}return{update:F}}function WebGLObjects(re,U,Y,ie){let ne=new WeakMap;function F(Me){const ve=ie.render.frame,se=Me.geometry,me=U.get(Me,se);if(ne.get(me)!==ve&&(U.update(me),ne.set(me,ve)),Me.isInstancedMesh&&(Me.hasEventListener("dispose",pe)===!1&&Me.addEventListener("dispose",pe),ne.get(Me)!==ve&&(Y.update(Me.instanceMatrix,re.ARRAY_BUFFER),Me.instanceColor!==null&&Y.update(Me.instanceColor,re.ARRAY_BUFFER),ne.set(Me,ve))),Me.isSkinnedMesh){const Te=Me.skeleton;ne.get(Te)!==ve&&(Te.update(),ne.set(Te,ve))}return me}function fe(){ne=new WeakMap}function pe(Me){const ve=Me.target;ve.removeEventListener("dispose",pe),Y.remove(ve.instanceMatrix),ve.instanceColor!==null&&Y.remove(ve.instanceColor)}return{update:F,dispose:fe}}class DepthTexture extends Texture$1{constructor(U,Y,ie,ne,F,fe,pe,Me,ve,se=DepthFormat){if(se!==DepthFormat&&se!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");ie===void 0&&se===DepthFormat&&(ie=UnsignedIntType),ie===void 0&&se===DepthStencilFormat&&(ie=UnsignedInt248Type),super(null,ne,F,fe,pe,Me,se,ie,ve),this.isDepthTexture=!0,this.image={width:U,height:Y},this.magFilter=pe!==void 0?pe:NearestFilter,this.minFilter=Me!==void 0?Me:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(U){return super.copy(U),this.compareFunction=U.compareFunction,this}toJSON(U){const Y=super.toJSON(U);return this.compareFunction!==null&&(Y.compareFunction=this.compareFunction),Y}}const emptyTexture=new Texture$1,emptyShadowTexture=new DepthTexture(1,1),emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(re,U,Y){const ie=re[0];if(ie<=0||ie>0)return re;const ne=U*Y;let F=arrayCacheF32[ne];if(F===void 0&&(F=new Float32Array(ne),arrayCacheF32[ne]=F),U!==0){ie.toArray(F,0);for(let fe=1,pe=0;fe!==U;++fe)pe+=Y,re[fe].toArray(F,pe)}return F}function arraysEqual(re,U){if(re.length!==U.length)return!1;for(let Y=0,ie=re.length;Y<ie;Y++)if(re[Y]!==U[Y])return!1;return!0}function copyArray(re,U){for(let Y=0,ie=U.length;Y<ie;Y++)re[Y]=U[Y]}function allocTexUnits(re,U){let Y=arrayCacheI32[U];Y===void 0&&(Y=new Int32Array(U),arrayCacheI32[U]=Y);for(let ie=0;ie!==U;++ie)Y[ie]=re.allocateTextureUnit();return Y}function setValueV1f(re,U){const Y=this.cache;Y[0]!==U&&(re.uniform1f(this.addr,U),Y[0]=U)}function setValueV2f(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y)&&(re.uniform2f(this.addr,U.x,U.y),Y[0]=U.x,Y[1]=U.y);else{if(arraysEqual(Y,U))return;re.uniform2fv(this.addr,U),copyArray(Y,U)}}function setValueV3f(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y||Y[2]!==U.z)&&(re.uniform3f(this.addr,U.x,U.y,U.z),Y[0]=U.x,Y[1]=U.y,Y[2]=U.z);else if(U.r!==void 0)(Y[0]!==U.r||Y[1]!==U.g||Y[2]!==U.b)&&(re.uniform3f(this.addr,U.r,U.g,U.b),Y[0]=U.r,Y[1]=U.g,Y[2]=U.b);else{if(arraysEqual(Y,U))return;re.uniform3fv(this.addr,U),copyArray(Y,U)}}function setValueV4f(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y||Y[2]!==U.z||Y[3]!==U.w)&&(re.uniform4f(this.addr,U.x,U.y,U.z,U.w),Y[0]=U.x,Y[1]=U.y,Y[2]=U.z,Y[3]=U.w);else{if(arraysEqual(Y,U))return;re.uniform4fv(this.addr,U),copyArray(Y,U)}}function setValueM2(re,U){const Y=this.cache,ie=U.elements;if(ie===void 0){if(arraysEqual(Y,U))return;re.uniformMatrix2fv(this.addr,!1,U),copyArray(Y,U)}else{if(arraysEqual(Y,ie))return;mat2array.set(ie),re.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(Y,ie)}}function setValueM3(re,U){const Y=this.cache,ie=U.elements;if(ie===void 0){if(arraysEqual(Y,U))return;re.uniformMatrix3fv(this.addr,!1,U),copyArray(Y,U)}else{if(arraysEqual(Y,ie))return;mat3array.set(ie),re.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(Y,ie)}}function setValueM4(re,U){const Y=this.cache,ie=U.elements;if(ie===void 0){if(arraysEqual(Y,U))return;re.uniformMatrix4fv(this.addr,!1,U),copyArray(Y,U)}else{if(arraysEqual(Y,ie))return;mat4array.set(ie),re.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(Y,ie)}}function setValueV1i(re,U){const Y=this.cache;Y[0]!==U&&(re.uniform1i(this.addr,U),Y[0]=U)}function setValueV2i(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y)&&(re.uniform2i(this.addr,U.x,U.y),Y[0]=U.x,Y[1]=U.y);else{if(arraysEqual(Y,U))return;re.uniform2iv(this.addr,U),copyArray(Y,U)}}function setValueV3i(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y||Y[2]!==U.z)&&(re.uniform3i(this.addr,U.x,U.y,U.z),Y[0]=U.x,Y[1]=U.y,Y[2]=U.z);else{if(arraysEqual(Y,U))return;re.uniform3iv(this.addr,U),copyArray(Y,U)}}function setValueV4i(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y||Y[2]!==U.z||Y[3]!==U.w)&&(re.uniform4i(this.addr,U.x,U.y,U.z,U.w),Y[0]=U.x,Y[1]=U.y,Y[2]=U.z,Y[3]=U.w);else{if(arraysEqual(Y,U))return;re.uniform4iv(this.addr,U),copyArray(Y,U)}}function setValueV1ui(re,U){const Y=this.cache;Y[0]!==U&&(re.uniform1ui(this.addr,U),Y[0]=U)}function setValueV2ui(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y)&&(re.uniform2ui(this.addr,U.x,U.y),Y[0]=U.x,Y[1]=U.y);else{if(arraysEqual(Y,U))return;re.uniform2uiv(this.addr,U),copyArray(Y,U)}}function setValueV3ui(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y||Y[2]!==U.z)&&(re.uniform3ui(this.addr,U.x,U.y,U.z),Y[0]=U.x,Y[1]=U.y,Y[2]=U.z);else{if(arraysEqual(Y,U))return;re.uniform3uiv(this.addr,U),copyArray(Y,U)}}function setValueV4ui(re,U){const Y=this.cache;if(U.x!==void 0)(Y[0]!==U.x||Y[1]!==U.y||Y[2]!==U.z||Y[3]!==U.w)&&(re.uniform4ui(this.addr,U.x,U.y,U.z,U.w),Y[0]=U.x,Y[1]=U.y,Y[2]=U.z,Y[3]=U.w);else{if(arraysEqual(Y,U))return;re.uniform4uiv(this.addr,U),copyArray(Y,U)}}function setValueT1(re,U,Y){const ie=this.cache,ne=Y.allocateTextureUnit();ie[0]!==ne&&(re.uniform1i(this.addr,ne),ie[0]=ne);let F;this.type===re.SAMPLER_2D_SHADOW?(emptyShadowTexture.compareFunction=LessEqualCompare,F=emptyShadowTexture):F=emptyTexture,Y.setTexture2D(U||F,ne)}function setValueT3D1(re,U,Y){const ie=this.cache,ne=Y.allocateTextureUnit();ie[0]!==ne&&(re.uniform1i(this.addr,ne),ie[0]=ne),Y.setTexture3D(U||empty3dTexture,ne)}function setValueT6(re,U,Y){const ie=this.cache,ne=Y.allocateTextureUnit();ie[0]!==ne&&(re.uniform1i(this.addr,ne),ie[0]=ne),Y.setTextureCube(U||emptyCubeTexture,ne)}function setValueT2DArray1(re,U,Y){const ie=this.cache,ne=Y.allocateTextureUnit();ie[0]!==ne&&(re.uniform1i(this.addr,ne),ie[0]=ne),Y.setTexture2DArray(U||emptyArrayTexture,ne)}function getSingularSetter(re){switch(re){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(re,U){re.uniform1fv(this.addr,U)}function setValueV2fArray(re,U){const Y=flatten(U,this.size,2);re.uniform2fv(this.addr,Y)}function setValueV3fArray(re,U){const Y=flatten(U,this.size,3);re.uniform3fv(this.addr,Y)}function setValueV4fArray(re,U){const Y=flatten(U,this.size,4);re.uniform4fv(this.addr,Y)}function setValueM2Array(re,U){const Y=flatten(U,this.size,4);re.uniformMatrix2fv(this.addr,!1,Y)}function setValueM3Array(re,U){const Y=flatten(U,this.size,9);re.uniformMatrix3fv(this.addr,!1,Y)}function setValueM4Array(re,U){const Y=flatten(U,this.size,16);re.uniformMatrix4fv(this.addr,!1,Y)}function setValueV1iArray(re,U){re.uniform1iv(this.addr,U)}function setValueV2iArray(re,U){re.uniform2iv(this.addr,U)}function setValueV3iArray(re,U){re.uniform3iv(this.addr,U)}function setValueV4iArray(re,U){re.uniform4iv(this.addr,U)}function setValueV1uiArray(re,U){re.uniform1uiv(this.addr,U)}function setValueV2uiArray(re,U){re.uniform2uiv(this.addr,U)}function setValueV3uiArray(re,U){re.uniform3uiv(this.addr,U)}function setValueV4uiArray(re,U){re.uniform4uiv(this.addr,U)}function setValueT1Array(re,U,Y){const ie=this.cache,ne=U.length,F=allocTexUnits(Y,ne);arraysEqual(ie,F)||(re.uniform1iv(this.addr,F),copyArray(ie,F));for(let fe=0;fe!==ne;++fe)Y.setTexture2D(U[fe]||emptyTexture,F[fe])}function setValueT3DArray(re,U,Y){const ie=this.cache,ne=U.length,F=allocTexUnits(Y,ne);arraysEqual(ie,F)||(re.uniform1iv(this.addr,F),copyArray(ie,F));for(let fe=0;fe!==ne;++fe)Y.setTexture3D(U[fe]||empty3dTexture,F[fe])}function setValueT6Array(re,U,Y){const ie=this.cache,ne=U.length,F=allocTexUnits(Y,ne);arraysEqual(ie,F)||(re.uniform1iv(this.addr,F),copyArray(ie,F));for(let fe=0;fe!==ne;++fe)Y.setTextureCube(U[fe]||emptyCubeTexture,F[fe])}function setValueT2DArrayArray(re,U,Y){const ie=this.cache,ne=U.length,F=allocTexUnits(Y,ne);arraysEqual(ie,F)||(re.uniform1iv(this.addr,F),copyArray(ie,F));for(let fe=0;fe!==ne;++fe)Y.setTexture2DArray(U[fe]||emptyArrayTexture,F[fe])}function getPureArraySetter(re){switch(re){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(U,Y,ie){this.id=U,this.addr=ie,this.cache=[],this.type=Y.type,this.setValue=getSingularSetter(Y.type)}}class PureArrayUniform{constructor(U,Y,ie){this.id=U,this.addr=ie,this.cache=[],this.type=Y.type,this.size=Y.size,this.setValue=getPureArraySetter(Y.type)}}class StructuredUniform{constructor(U){this.id=U,this.seq=[],this.map={}}setValue(U,Y,ie){const ne=this.seq;for(let F=0,fe=ne.length;F!==fe;++F){const pe=ne[F];pe.setValue(U,Y[pe.id],ie)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(re,U){re.seq.push(U),re.map[U.id]=U}function parseUniform(re,U,Y){const ie=re.name,ne=ie.length;for(RePathPart.lastIndex=0;;){const F=RePathPart.exec(ie),fe=RePathPart.lastIndex;let pe=F[1];const Me=F[2]==="]",ve=F[3];if(Me&&(pe=pe|0),ve===void 0||ve==="["&&fe+2===ne){addUniform(Y,ve===void 0?new SingleUniform(pe,re,U):new PureArrayUniform(pe,re,U));break}else{let me=Y.map[pe];me===void 0&&(me=new StructuredUniform(pe),addUniform(Y,me)),Y=me}}}class WebGLUniforms{constructor(U,Y){this.seq=[],this.map={};const ie=U.getProgramParameter(Y,U.ACTIVE_UNIFORMS);for(let ne=0;ne<ie;++ne){const F=U.getActiveUniform(Y,ne),fe=U.getUniformLocation(Y,F.name);parseUniform(F,fe,this)}}setValue(U,Y,ie,ne){const F=this.map[Y];F!==void 0&&F.setValue(U,ie,ne)}setOptional(U,Y,ie){const ne=Y[ie];ne!==void 0&&this.setValue(U,ie,ne)}static upload(U,Y,ie,ne){for(let F=0,fe=Y.length;F!==fe;++F){const pe=Y[F],Me=ie[pe.id];Me.needsUpdate!==!1&&pe.setValue(U,Me.value,ne)}}static seqWithValue(U,Y){const ie=[];for(let ne=0,F=U.length;ne!==F;++ne){const fe=U[ne];fe.id in Y&&ie.push(fe)}return ie}}function WebGLShader(re,U,Y){const ie=re.createShader(U);return re.shaderSource(ie,Y),re.compileShader(ie),ie}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(re,U){const Y=re.split(`
`),ie=[],ne=Math.max(U-6,0),F=Math.min(U+6,Y.length);for(let fe=ne;fe<F;fe++){const pe=fe+1;ie.push(`${pe===U?">":" "} ${pe}: ${Y[fe]}`)}return ie.join(`
`)}function getEncodingComponents(re){const U=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Y=ColorManagement.getPrimaries(re);let ie;switch(U===Y?ie="":U===P3Primaries&&Y===Rec709Primaries?ie="LinearDisplayP3ToLinearSRGB":U===Rec709Primaries&&Y===P3Primaries&&(ie="LinearSRGBToLinearDisplayP3"),re){case LinearSRGBColorSpace:case LinearDisplayP3ColorSpace:return[ie,"LinearTransferOETF"];case SRGBColorSpace:case DisplayP3ColorSpace:return[ie,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",re),[ie,"LinearTransferOETF"]}}function getShaderErrors(re,U,Y){const ie=re.getShaderParameter(U,re.COMPILE_STATUS),ne=re.getShaderInfoLog(U).trim();if(ie&&ne==="")return"";const F=/ERROR: 0:(\d+)/.exec(ne);if(F){const fe=parseInt(F[1]);return Y.toUpperCase()+`

`+ne+`

`+handleSource(re.getShaderSource(U),fe)}else return ne}function getTexelEncodingFunction(re,U){const Y=getEncodingComponents(U);return`vec4 ${re}( vec4 value ) { return ${Y[0]}( ${Y[1]}( value ) ); }`}function getToneMappingFunction(re,U){let Y;switch(U){case LinearToneMapping:Y="Linear";break;case ReinhardToneMapping:Y="Reinhard";break;case CineonToneMapping:Y="Cineon";break;case ACESFilmicToneMapping:Y="ACESFilmic";break;case AgXToneMapping:Y="AgX";break;case NeutralToneMapping:Y="Neutral";break;case CustomToneMapping:Y="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",U),Y="Linear"}return"vec3 "+re+"( vec3 color ) { return "+Y+"ToneMapping( color ); }"}const _v0$1=new Vector3;function getLuminanceFunction(){ColorManagement.getLuminanceCoefficients(_v0$1);const re=_v0$1.x.toFixed(4),U=_v0$1.y.toFixed(4),Y=_v0$1.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${re}, ${U}, ${Y} );`,"	return dot( weights, rgb );","}"].join(`
`)}function generateVertexExtensions(re){return[re.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",re.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(re){const U=[];for(const Y in re){const ie=re[Y];ie!==!1&&U.push("#define "+Y+" "+ie)}return U.join(`
`)}function fetchAttributeLocations(re,U){const Y={},ie=re.getProgramParameter(U,re.ACTIVE_ATTRIBUTES);for(let ne=0;ne<ie;ne++){const F=re.getActiveAttrib(U,ne),fe=F.name;let pe=1;F.type===re.FLOAT_MAT2&&(pe=2),F.type===re.FLOAT_MAT3&&(pe=3),F.type===re.FLOAT_MAT4&&(pe=4),Y[fe]={type:F.type,location:re.getAttribLocation(U,fe),locationSize:pe}}return Y}function filterEmptyLine(re){return re!==""}function replaceLightNums(re,U){const Y=U.numSpotLightShadows+U.numSpotLightMaps-U.numSpotLightShadowsWithMaps;return re.replace(/NUM_DIR_LIGHTS/g,U.numDirLights).replace(/NUM_SPOT_LIGHTS/g,U.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,U.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,Y).replace(/NUM_RECT_AREA_LIGHTS/g,U.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,U.numPointLights).replace(/NUM_HEMI_LIGHTS/g,U.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,U.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,U.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,U.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,U.numPointLightShadows)}function replaceClippingPlaneNums(re,U){return re.replace(/NUM_CLIPPING_PLANES/g,U.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,U.numClippingPlanes-U.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(re){return re.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(re,U){let Y=ShaderChunk[U];if(Y===void 0){const ie=shaderChunkMap.get(U);if(ie!==void 0)Y=ShaderChunk[ie],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',U,ie);else throw new Error("Can not resolve #include <"+U+">")}return resolveIncludes(Y)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(re){return re.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(re,U,Y,ie){let ne="";for(let F=parseInt(U);F<parseInt(Y);F++)ne+=ie.replace(/\[\s*i\s*\]/g,"[ "+F+" ]").replace(/UNROLLED_LOOP_INDEX/g,F);return ne}function generatePrecision(re){let U=`precision ${re.precision} float;
	precision ${re.precision} int;
	precision ${re.precision} sampler2D;
	precision ${re.precision} samplerCube;
	precision ${re.precision} sampler3D;
	precision ${re.precision} sampler2DArray;
	precision ${re.precision} sampler2DShadow;
	precision ${re.precision} samplerCubeShadow;
	precision ${re.precision} sampler2DArrayShadow;
	precision ${re.precision} isampler2D;
	precision ${re.precision} isampler3D;
	precision ${re.precision} isamplerCube;
	precision ${re.precision} isampler2DArray;
	precision ${re.precision} usampler2D;
	precision ${re.precision} usampler3D;
	precision ${re.precision} usamplerCube;
	precision ${re.precision} usampler2DArray;
	`;return re.precision==="highp"?U+=`
#define HIGH_PRECISION`:re.precision==="mediump"?U+=`
#define MEDIUM_PRECISION`:re.precision==="lowp"&&(U+=`
#define LOW_PRECISION`),U}function generateShadowMapTypeDefine(re){let U="SHADOWMAP_TYPE_BASIC";return re.shadowMapType===PCFShadowMap?U="SHADOWMAP_TYPE_PCF":re.shadowMapType===PCFSoftShadowMap?U="SHADOWMAP_TYPE_PCF_SOFT":re.shadowMapType===VSMShadowMap&&(U="SHADOWMAP_TYPE_VSM"),U}function generateEnvMapTypeDefine(re){let U="ENVMAP_TYPE_CUBE";if(re.envMap)switch(re.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:U="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:U="ENVMAP_TYPE_CUBE_UV";break}return U}function generateEnvMapModeDefine(re){let U="ENVMAP_MODE_REFLECTION";if(re.envMap)switch(re.envMapMode){case CubeRefractionMapping:U="ENVMAP_MODE_REFRACTION";break}return U}function generateEnvMapBlendingDefine(re){let U="ENVMAP_BLENDING_NONE";if(re.envMap)switch(re.combine){case MultiplyOperation:U="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:U="ENVMAP_BLENDING_MIX";break;case AddOperation:U="ENVMAP_BLENDING_ADD";break}return U}function generateCubeUVSize(re){const U=re.envMapCubeUVHeight;if(U===null)return null;const Y=Math.log2(U)-2,ie=1/U;return{texelWidth:1/(3*Math.max(Math.pow(2,Y),7*16)),texelHeight:ie,maxMip:Y}}function WebGLProgram(re,U,Y,ie){const ne=re.getContext(),F=Y.defines;let fe=Y.vertexShader,pe=Y.fragmentShader;const Me=generateShadowMapTypeDefine(Y),ve=generateEnvMapTypeDefine(Y),se=generateEnvMapModeDefine(Y),me=generateEnvMapBlendingDefine(Y),Te=generateCubeUVSize(Y),Re=generateVertexExtensions(Y),be=generateDefines(F),Pe=ne.createProgram();let Le,xe,Fe=Y.glslVersion?"#version "+Y.glslVersion+`
`:"";Y.isRawShaderMaterial?(Le=["#define SHADER_TYPE "+Y.shaderType,"#define SHADER_NAME "+Y.shaderName,be].filter(filterEmptyLine).join(`
`),Le.length>0&&(Le+=`
`),xe=["#define SHADER_TYPE "+Y.shaderType,"#define SHADER_NAME "+Y.shaderName,be].filter(filterEmptyLine).join(`
`),xe.length>0&&(xe+=`
`)):(Le=[generatePrecision(Y),"#define SHADER_TYPE "+Y.shaderType,"#define SHADER_NAME "+Y.shaderName,be,Y.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",Y.batching?"#define USE_BATCHING":"",Y.batchingColor?"#define USE_BATCHING_COLOR":"",Y.instancing?"#define USE_INSTANCING":"",Y.instancingColor?"#define USE_INSTANCING_COLOR":"",Y.instancingMorph?"#define USE_INSTANCING_MORPH":"",Y.useFog&&Y.fog?"#define USE_FOG":"",Y.useFog&&Y.fogExp2?"#define FOG_EXP2":"",Y.map?"#define USE_MAP":"",Y.envMap?"#define USE_ENVMAP":"",Y.envMap?"#define "+se:"",Y.lightMap?"#define USE_LIGHTMAP":"",Y.aoMap?"#define USE_AOMAP":"",Y.bumpMap?"#define USE_BUMPMAP":"",Y.normalMap?"#define USE_NORMALMAP":"",Y.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",Y.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",Y.displacementMap?"#define USE_DISPLACEMENTMAP":"",Y.emissiveMap?"#define USE_EMISSIVEMAP":"",Y.anisotropy?"#define USE_ANISOTROPY":"",Y.anisotropyMap?"#define USE_ANISOTROPYMAP":"",Y.clearcoatMap?"#define USE_CLEARCOATMAP":"",Y.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",Y.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",Y.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",Y.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",Y.specularMap?"#define USE_SPECULARMAP":"",Y.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",Y.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",Y.roughnessMap?"#define USE_ROUGHNESSMAP":"",Y.metalnessMap?"#define USE_METALNESSMAP":"",Y.alphaMap?"#define USE_ALPHAMAP":"",Y.alphaHash?"#define USE_ALPHAHASH":"",Y.transmission?"#define USE_TRANSMISSION":"",Y.transmissionMap?"#define USE_TRANSMISSIONMAP":"",Y.thicknessMap?"#define USE_THICKNESSMAP":"",Y.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",Y.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",Y.mapUv?"#define MAP_UV "+Y.mapUv:"",Y.alphaMapUv?"#define ALPHAMAP_UV "+Y.alphaMapUv:"",Y.lightMapUv?"#define LIGHTMAP_UV "+Y.lightMapUv:"",Y.aoMapUv?"#define AOMAP_UV "+Y.aoMapUv:"",Y.emissiveMapUv?"#define EMISSIVEMAP_UV "+Y.emissiveMapUv:"",Y.bumpMapUv?"#define BUMPMAP_UV "+Y.bumpMapUv:"",Y.normalMapUv?"#define NORMALMAP_UV "+Y.normalMapUv:"",Y.displacementMapUv?"#define DISPLACEMENTMAP_UV "+Y.displacementMapUv:"",Y.metalnessMapUv?"#define METALNESSMAP_UV "+Y.metalnessMapUv:"",Y.roughnessMapUv?"#define ROUGHNESSMAP_UV "+Y.roughnessMapUv:"",Y.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+Y.anisotropyMapUv:"",Y.clearcoatMapUv?"#define CLEARCOATMAP_UV "+Y.clearcoatMapUv:"",Y.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+Y.clearcoatNormalMapUv:"",Y.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+Y.clearcoatRoughnessMapUv:"",Y.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+Y.iridescenceMapUv:"",Y.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+Y.iridescenceThicknessMapUv:"",Y.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+Y.sheenColorMapUv:"",Y.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+Y.sheenRoughnessMapUv:"",Y.specularMapUv?"#define SPECULARMAP_UV "+Y.specularMapUv:"",Y.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+Y.specularColorMapUv:"",Y.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+Y.specularIntensityMapUv:"",Y.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+Y.transmissionMapUv:"",Y.thicknessMapUv?"#define THICKNESSMAP_UV "+Y.thicknessMapUv:"",Y.vertexTangents&&Y.flatShading===!1?"#define USE_TANGENT":"",Y.vertexColors?"#define USE_COLOR":"",Y.vertexAlphas?"#define USE_COLOR_ALPHA":"",Y.vertexUv1s?"#define USE_UV1":"",Y.vertexUv2s?"#define USE_UV2":"",Y.vertexUv3s?"#define USE_UV3":"",Y.pointsUvs?"#define USE_POINTS_UV":"",Y.flatShading?"#define FLAT_SHADED":"",Y.skinning?"#define USE_SKINNING":"",Y.morphTargets?"#define USE_MORPHTARGETS":"",Y.morphNormals&&Y.flatShading===!1?"#define USE_MORPHNORMALS":"",Y.morphColors?"#define USE_MORPHCOLORS":"",Y.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+Y.morphTextureStride:"",Y.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+Y.morphTargetsCount:"",Y.doubleSided?"#define DOUBLE_SIDED":"",Y.flipSided?"#define FLIP_SIDED":"",Y.shadowMapEnabled?"#define USE_SHADOWMAP":"",Y.shadowMapEnabled?"#define "+Me:"",Y.sizeAttenuation?"#define USE_SIZEATTENUATION":"",Y.numLightProbes>0?"#define USE_LIGHT_PROBES":"",Y.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Y.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),xe=[generatePrecision(Y),"#define SHADER_TYPE "+Y.shaderType,"#define SHADER_NAME "+Y.shaderName,be,Y.useFog&&Y.fog?"#define USE_FOG":"",Y.useFog&&Y.fogExp2?"#define FOG_EXP2":"",Y.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",Y.map?"#define USE_MAP":"",Y.matcap?"#define USE_MATCAP":"",Y.envMap?"#define USE_ENVMAP":"",Y.envMap?"#define "+ve:"",Y.envMap?"#define "+se:"",Y.envMap?"#define "+me:"",Te?"#define CUBEUV_TEXEL_WIDTH "+Te.texelWidth:"",Te?"#define CUBEUV_TEXEL_HEIGHT "+Te.texelHeight:"",Te?"#define CUBEUV_MAX_MIP "+Te.maxMip+".0":"",Y.lightMap?"#define USE_LIGHTMAP":"",Y.aoMap?"#define USE_AOMAP":"",Y.bumpMap?"#define USE_BUMPMAP":"",Y.normalMap?"#define USE_NORMALMAP":"",Y.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",Y.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",Y.emissiveMap?"#define USE_EMISSIVEMAP":"",Y.anisotropy?"#define USE_ANISOTROPY":"",Y.anisotropyMap?"#define USE_ANISOTROPYMAP":"",Y.clearcoat?"#define USE_CLEARCOAT":"",Y.clearcoatMap?"#define USE_CLEARCOATMAP":"",Y.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",Y.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",Y.dispersion?"#define USE_DISPERSION":"",Y.iridescence?"#define USE_IRIDESCENCE":"",Y.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",Y.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",Y.specularMap?"#define USE_SPECULARMAP":"",Y.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",Y.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",Y.roughnessMap?"#define USE_ROUGHNESSMAP":"",Y.metalnessMap?"#define USE_METALNESSMAP":"",Y.alphaMap?"#define USE_ALPHAMAP":"",Y.alphaTest?"#define USE_ALPHATEST":"",Y.alphaHash?"#define USE_ALPHAHASH":"",Y.sheen?"#define USE_SHEEN":"",Y.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",Y.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",Y.transmission?"#define USE_TRANSMISSION":"",Y.transmissionMap?"#define USE_TRANSMISSIONMAP":"",Y.thicknessMap?"#define USE_THICKNESSMAP":"",Y.vertexTangents&&Y.flatShading===!1?"#define USE_TANGENT":"",Y.vertexColors||Y.instancingColor||Y.batchingColor?"#define USE_COLOR":"",Y.vertexAlphas?"#define USE_COLOR_ALPHA":"",Y.vertexUv1s?"#define USE_UV1":"",Y.vertexUv2s?"#define USE_UV2":"",Y.vertexUv3s?"#define USE_UV3":"",Y.pointsUvs?"#define USE_POINTS_UV":"",Y.gradientMap?"#define USE_GRADIENTMAP":"",Y.flatShading?"#define FLAT_SHADED":"",Y.doubleSided?"#define DOUBLE_SIDED":"",Y.flipSided?"#define FLIP_SIDED":"",Y.shadowMapEnabled?"#define USE_SHADOWMAP":"",Y.shadowMapEnabled?"#define "+Me:"",Y.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",Y.numLightProbes>0?"#define USE_LIGHT_PROBES":"",Y.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",Y.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Y.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",Y.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",Y.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",Y.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",Y.toneMapping):"",Y.dithering?"#define DITHERING":"",Y.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",Y.outputColorSpace),getLuminanceFunction(),Y.useDepthPacking?"#define DEPTH_PACKING "+Y.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),fe=resolveIncludes(fe),fe=replaceLightNums(fe,Y),fe=replaceClippingPlaneNums(fe,Y),pe=resolveIncludes(pe),pe=replaceLightNums(pe,Y),pe=replaceClippingPlaneNums(pe,Y),fe=unrollLoops(fe),pe=unrollLoops(pe),Y.isRawShaderMaterial!==!0&&(Fe=`#version 300 es
`,Le=[Re,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Le,xe=["#define varying in",Y.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",Y.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+xe);const Oe=Fe+Le+fe,Ne=Fe+xe+pe,ke=WebGLShader(ne,ne.VERTEX_SHADER,Oe),Ve=WebGLShader(ne,ne.FRAGMENT_SHADER,Ne);ne.attachShader(Pe,ke),ne.attachShader(Pe,Ve),Y.index0AttributeName!==void 0?ne.bindAttribLocation(Pe,0,Y.index0AttributeName):Y.morphTargets===!0&&ne.bindAttribLocation(Pe,0,"position"),ne.linkProgram(Pe);function Xe(tt){if(re.debug.checkShaderErrors){const ft=ne.getProgramInfoLog(Pe).trim(),Rt=ne.getShaderInfoLog(ke).trim(),Mt=ne.getShaderInfoLog(Ve).trim();let Gt=!0,_t=!0;if(ne.getProgramParameter(Pe,ne.LINK_STATUS)===!1)if(Gt=!1,typeof re.debug.onShaderError=="function")re.debug.onShaderError(ne,Pe,ke,Ve);else{const Bt=getShaderErrors(ne,ke,"vertex"),dt=getShaderErrors(ne,Ve,"fragment");console.error("THREE.WebGLProgram: Shader Error "+ne.getError()+" - VALIDATE_STATUS "+ne.getProgramParameter(Pe,ne.VALIDATE_STATUS)+`

Material Name: `+tt.name+`
Material Type: `+tt.type+`

Program Info Log: `+ft+`
`+Bt+`
`+dt)}else ft!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ft):(Rt===""||Mt==="")&&(_t=!1);_t&&(tt.diagnostics={runnable:Gt,programLog:ft,vertexShader:{log:Rt,prefix:Le},fragmentShader:{log:Mt,prefix:xe}})}ne.deleteShader(ke),ne.deleteShader(Ve),$e=new WebGLUniforms(ne,Pe),st=fetchAttributeLocations(ne,Pe)}let $e;this.getUniforms=function(){return $e===void 0&&Xe(this),$e};let st;this.getAttributes=function(){return st===void 0&&Xe(this),st};let ze=Y.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return ze===!1&&(ze=ne.getProgramParameter(Pe,COMPLETION_STATUS_KHR)),ze},this.destroy=function(){ie.releaseStatesOfProgram(this),ne.deleteProgram(Pe),this.program=void 0},this.type=Y.shaderType,this.name=Y.shaderName,this.id=programIdCount++,this.cacheKey=U,this.usedTimes=1,this.program=Pe,this.vertexShader=ke,this.fragmentShader=Ve,this}let _id$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(U){const Y=U.vertexShader,ie=U.fragmentShader,ne=this._getShaderStage(Y),F=this._getShaderStage(ie),fe=this._getShaderCacheForMaterial(U);return fe.has(ne)===!1&&(fe.add(ne),ne.usedTimes++),fe.has(F)===!1&&(fe.add(F),F.usedTimes++),this}remove(U){const Y=this.materialCache.get(U);for(const ie of Y)ie.usedTimes--,ie.usedTimes===0&&this.shaderCache.delete(ie.code);return this.materialCache.delete(U),this}getVertexShaderID(U){return this._getShaderStage(U.vertexShader).id}getFragmentShaderID(U){return this._getShaderStage(U.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(U){const Y=this.materialCache;let ie=Y.get(U);return ie===void 0&&(ie=new Set,Y.set(U,ie)),ie}_getShaderStage(U){const Y=this.shaderCache;let ie=Y.get(U);return ie===void 0&&(ie=new WebGLShaderStage(U),Y.set(U,ie)),ie}}class WebGLShaderStage{constructor(U){this.id=_id$1++,this.code=U,this.usedTimes=0}}function WebGLPrograms(re,U,Y,ie,ne,F,fe){const pe=new Layers,Me=new WebGLShaderCache,ve=new Set,se=[],me=ne.logarithmicDepthBuffer,Te=ne.reverseDepthBuffer,Re=ne.vertexTextures;let be=ne.precision;const Pe={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Le(ze){return ve.add(ze),ze===0?"uv":`uv${ze}`}function xe(ze,tt,ft,Rt,Mt){const Gt=Rt.fog,_t=Mt.geometry,Bt=ze.isMeshStandardMaterial?Rt.environment:null,dt=(ze.isMeshStandardMaterial?Y:U).get(ze.envMap||Bt),ut=dt&&dt.mapping===CubeUVReflectionMapping?dt.image.height:null,Ut=Pe[ze.type];ze.precision!==null&&(be=ne.getMaxPrecision(ze.precision),be!==ze.precision&&console.warn("THREE.WebGLProgram.getParameters:",ze.precision,"not supported, using",be,"instead."));const Tt=_t.morphAttributes.position||_t.morphAttributes.normal||_t.morphAttributes.color,Xt=Tt!==void 0?Tt.length:0;let hn=0;_t.morphAttributes.position!==void 0&&(hn=1),_t.morphAttributes.normal!==void 0&&(hn=2),_t.morphAttributes.color!==void 0&&(hn=3);let nn,An,Cn,Nn;if(Ut){const Ws=ShaderLib[Ut];nn=Ws.vertexShader,An=Ws.fragmentShader}else nn=ze.vertexShader,An=ze.fragmentShader,Me.update(ze),Cn=Me.getVertexShaderID(ze),Nn=Me.getFragmentShaderID(ze);const Qn=re.getRenderTarget(),fi=Mt.isInstancedMesh===!0,hi=Mt.isBatchedMesh===!0,Qi=!!ze.map,Zi=!!ze.matcap,Mn=!!dt,Vr=!!ze.aoMap,Ir=!!ze.lightMap,Rr=!!ze.bumpMap,ir=!!ze.normalMap,zr=!!ze.displacementMap,Br=!!ze.emissiveMap,kt=!!ze.metalnessMap,rn=!!ze.roughnessMap,Kn=ze.anisotropy>0,ai=ze.clearcoat>0,Ui=ze.dispersion>0,yi=ze.iridescence>0,Nr=ze.sheen>0,Ar=ze.transmission>0,fr=Kn&&!!ze.anisotropyMap,Bi=ai&&!!ze.clearcoatMap,Kt=ai&&!!ze.clearcoatNormalMap,Yt=ai&&!!ze.clearcoatRoughnessMap,fn=yi&&!!ze.iridescenceMap,on=yi&&!!ze.iridescenceThicknessMap,an=Nr&&!!ze.sheenColorMap,gn=Nr&&!!ze.sheenRoughnessMap,Nt=!!ze.specularMap,ht=!!ze.specularColorMap,ot=!!ze.specularIntensityMap,Vt=Ar&&!!ze.transmissionMap,Wt=Ar&&!!ze.thicknessMap,sn=!!ze.gradientMap,yn=!!ze.alphaMap,ni=ze.alphaTest>0,ki=!!ze.alphaHash,Hi=!!ze.extensions;let ji=NoToneMapping;ze.toneMapped&&(Qn===null||Qn.isXRRenderTarget===!0)&&(ji=re.toneMapping);const Xi={shaderID:Ut,shaderType:ze.type,shaderName:ze.name,vertexShader:nn,fragmentShader:An,defines:ze.defines,customVertexShaderID:Cn,customFragmentShaderID:Nn,isRawShaderMaterial:ze.isRawShaderMaterial===!0,glslVersion:ze.glslVersion,precision:be,batching:hi,batchingColor:hi&&Mt._colorsTexture!==null,instancing:fi,instancingColor:fi&&Mt.instanceColor!==null,instancingMorph:fi&&Mt.morphTexture!==null,supportsVertexTextures:Re,outputColorSpace:Qn===null?re.outputColorSpace:Qn.isXRRenderTarget===!0?Qn.texture.colorSpace:LinearSRGBColorSpace,alphaToCoverage:!!ze.alphaToCoverage,map:Qi,matcap:Zi,envMap:Mn,envMapMode:Mn&&dt.mapping,envMapCubeUVHeight:ut,aoMap:Vr,lightMap:Ir,bumpMap:Rr,normalMap:ir,displacementMap:Re&&zr,emissiveMap:Br,normalMapObjectSpace:ir&&ze.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:ir&&ze.normalMapType===TangentSpaceNormalMap,metalnessMap:kt,roughnessMap:rn,anisotropy:Kn,anisotropyMap:fr,clearcoat:ai,clearcoatMap:Bi,clearcoatNormalMap:Kt,clearcoatRoughnessMap:Yt,dispersion:Ui,iridescence:yi,iridescenceMap:fn,iridescenceThicknessMap:on,sheen:Nr,sheenColorMap:an,sheenRoughnessMap:gn,specularMap:Nt,specularColorMap:ht,specularIntensityMap:ot,transmission:Ar,transmissionMap:Vt,thicknessMap:Wt,gradientMap:sn,opaque:ze.transparent===!1&&ze.blending===NormalBlending&&ze.alphaToCoverage===!1,alphaMap:yn,alphaTest:ni,alphaHash:ki,combine:ze.combine,mapUv:Qi&&Le(ze.map.channel),aoMapUv:Vr&&Le(ze.aoMap.channel),lightMapUv:Ir&&Le(ze.lightMap.channel),bumpMapUv:Rr&&Le(ze.bumpMap.channel),normalMapUv:ir&&Le(ze.normalMap.channel),displacementMapUv:zr&&Le(ze.displacementMap.channel),emissiveMapUv:Br&&Le(ze.emissiveMap.channel),metalnessMapUv:kt&&Le(ze.metalnessMap.channel),roughnessMapUv:rn&&Le(ze.roughnessMap.channel),anisotropyMapUv:fr&&Le(ze.anisotropyMap.channel),clearcoatMapUv:Bi&&Le(ze.clearcoatMap.channel),clearcoatNormalMapUv:Kt&&Le(ze.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Yt&&Le(ze.clearcoatRoughnessMap.channel),iridescenceMapUv:fn&&Le(ze.iridescenceMap.channel),iridescenceThicknessMapUv:on&&Le(ze.iridescenceThicknessMap.channel),sheenColorMapUv:an&&Le(ze.sheenColorMap.channel),sheenRoughnessMapUv:gn&&Le(ze.sheenRoughnessMap.channel),specularMapUv:Nt&&Le(ze.specularMap.channel),specularColorMapUv:ht&&Le(ze.specularColorMap.channel),specularIntensityMapUv:ot&&Le(ze.specularIntensityMap.channel),transmissionMapUv:Vt&&Le(ze.transmissionMap.channel),thicknessMapUv:Wt&&Le(ze.thicknessMap.channel),alphaMapUv:yn&&Le(ze.alphaMap.channel),vertexTangents:!!_t.attributes.tangent&&(ir||Kn),vertexColors:ze.vertexColors,vertexAlphas:ze.vertexColors===!0&&!!_t.attributes.color&&_t.attributes.color.itemSize===4,pointsUvs:Mt.isPoints===!0&&!!_t.attributes.uv&&(Qi||yn),fog:!!Gt,useFog:ze.fog===!0,fogExp2:!!Gt&&Gt.isFogExp2,flatShading:ze.flatShading===!0,sizeAttenuation:ze.sizeAttenuation===!0,logarithmicDepthBuffer:me,reverseDepthBuffer:Te,skinning:Mt.isSkinnedMesh===!0,morphTargets:_t.morphAttributes.position!==void 0,morphNormals:_t.morphAttributes.normal!==void 0,morphColors:_t.morphAttributes.color!==void 0,morphTargetsCount:Xt,morphTextureStride:hn,numDirLights:tt.directional.length,numPointLights:tt.point.length,numSpotLights:tt.spot.length,numSpotLightMaps:tt.spotLightMap.length,numRectAreaLights:tt.rectArea.length,numHemiLights:tt.hemi.length,numDirLightShadows:tt.directionalShadowMap.length,numPointLightShadows:tt.pointShadowMap.length,numSpotLightShadows:tt.spotShadowMap.length,numSpotLightShadowsWithMaps:tt.numSpotLightShadowsWithMaps,numLightProbes:tt.numLightProbes,numClippingPlanes:fe.numPlanes,numClipIntersection:fe.numIntersection,dithering:ze.dithering,shadowMapEnabled:re.shadowMap.enabled&&ft.length>0,shadowMapType:re.shadowMap.type,toneMapping:ji,decodeVideoTexture:Qi&&ze.map.isVideoTexture===!0&&ColorManagement.getTransfer(ze.map.colorSpace)===SRGBTransfer,premultipliedAlpha:ze.premultipliedAlpha,doubleSided:ze.side===DoubleSide,flipSided:ze.side===BackSide,useDepthPacking:ze.depthPacking>=0,depthPacking:ze.depthPacking||0,index0AttributeName:ze.index0AttributeName,extensionClipCullDistance:Hi&&ze.extensions.clipCullDistance===!0&&ie.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Hi&&ze.extensions.multiDraw===!0||hi)&&ie.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:ie.has("KHR_parallel_shader_compile"),customProgramCacheKey:ze.customProgramCacheKey()};return Xi.vertexUv1s=ve.has(1),Xi.vertexUv2s=ve.has(2),Xi.vertexUv3s=ve.has(3),ve.clear(),Xi}function Fe(ze){const tt=[];if(ze.shaderID?tt.push(ze.shaderID):(tt.push(ze.customVertexShaderID),tt.push(ze.customFragmentShaderID)),ze.defines!==void 0)for(const ft in ze.defines)tt.push(ft),tt.push(ze.defines[ft]);return ze.isRawShaderMaterial===!1&&(Oe(tt,ze),Ne(tt,ze),tt.push(re.outputColorSpace)),tt.push(ze.customProgramCacheKey),tt.join()}function Oe(ze,tt){ze.push(tt.precision),ze.push(tt.outputColorSpace),ze.push(tt.envMapMode),ze.push(tt.envMapCubeUVHeight),ze.push(tt.mapUv),ze.push(tt.alphaMapUv),ze.push(tt.lightMapUv),ze.push(tt.aoMapUv),ze.push(tt.bumpMapUv),ze.push(tt.normalMapUv),ze.push(tt.displacementMapUv),ze.push(tt.emissiveMapUv),ze.push(tt.metalnessMapUv),ze.push(tt.roughnessMapUv),ze.push(tt.anisotropyMapUv),ze.push(tt.clearcoatMapUv),ze.push(tt.clearcoatNormalMapUv),ze.push(tt.clearcoatRoughnessMapUv),ze.push(tt.iridescenceMapUv),ze.push(tt.iridescenceThicknessMapUv),ze.push(tt.sheenColorMapUv),ze.push(tt.sheenRoughnessMapUv),ze.push(tt.specularMapUv),ze.push(tt.specularColorMapUv),ze.push(tt.specularIntensityMapUv),ze.push(tt.transmissionMapUv),ze.push(tt.thicknessMapUv),ze.push(tt.combine),ze.push(tt.fogExp2),ze.push(tt.sizeAttenuation),ze.push(tt.morphTargetsCount),ze.push(tt.morphAttributeCount),ze.push(tt.numDirLights),ze.push(tt.numPointLights),ze.push(tt.numSpotLights),ze.push(tt.numSpotLightMaps),ze.push(tt.numHemiLights),ze.push(tt.numRectAreaLights),ze.push(tt.numDirLightShadows),ze.push(tt.numPointLightShadows),ze.push(tt.numSpotLightShadows),ze.push(tt.numSpotLightShadowsWithMaps),ze.push(tt.numLightProbes),ze.push(tt.shadowMapType),ze.push(tt.toneMapping),ze.push(tt.numClippingPlanes),ze.push(tt.numClipIntersection),ze.push(tt.depthPacking)}function Ne(ze,tt){pe.disableAll(),tt.supportsVertexTextures&&pe.enable(0),tt.instancing&&pe.enable(1),tt.instancingColor&&pe.enable(2),tt.instancingMorph&&pe.enable(3),tt.matcap&&pe.enable(4),tt.envMap&&pe.enable(5),tt.normalMapObjectSpace&&pe.enable(6),tt.normalMapTangentSpace&&pe.enable(7),tt.clearcoat&&pe.enable(8),tt.iridescence&&pe.enable(9),tt.alphaTest&&pe.enable(10),tt.vertexColors&&pe.enable(11),tt.vertexAlphas&&pe.enable(12),tt.vertexUv1s&&pe.enable(13),tt.vertexUv2s&&pe.enable(14),tt.vertexUv3s&&pe.enable(15),tt.vertexTangents&&pe.enable(16),tt.anisotropy&&pe.enable(17),tt.alphaHash&&pe.enable(18),tt.batching&&pe.enable(19),tt.dispersion&&pe.enable(20),tt.batchingColor&&pe.enable(21),ze.push(pe.mask),pe.disableAll(),tt.fog&&pe.enable(0),tt.useFog&&pe.enable(1),tt.flatShading&&pe.enable(2),tt.logarithmicDepthBuffer&&pe.enable(3),tt.reverseDepthBuffer&&pe.enable(4),tt.skinning&&pe.enable(5),tt.morphTargets&&pe.enable(6),tt.morphNormals&&pe.enable(7),tt.morphColors&&pe.enable(8),tt.premultipliedAlpha&&pe.enable(9),tt.shadowMapEnabled&&pe.enable(10),tt.doubleSided&&pe.enable(11),tt.flipSided&&pe.enable(12),tt.useDepthPacking&&pe.enable(13),tt.dithering&&pe.enable(14),tt.transmission&&pe.enable(15),tt.sheen&&pe.enable(16),tt.opaque&&pe.enable(17),tt.pointsUvs&&pe.enable(18),tt.decodeVideoTexture&&pe.enable(19),tt.alphaToCoverage&&pe.enable(20),ze.push(pe.mask)}function ke(ze){const tt=Pe[ze.type];let ft;if(tt){const Rt=ShaderLib[tt];ft=UniformsUtils.clone(Rt.uniforms)}else ft=ze.uniforms;return ft}function Ve(ze,tt){let ft;for(let Rt=0,Mt=se.length;Rt<Mt;Rt++){const Gt=se[Rt];if(Gt.cacheKey===tt){ft=Gt,++ft.usedTimes;break}}return ft===void 0&&(ft=new WebGLProgram(re,tt,ze,F),se.push(ft)),ft}function Xe(ze){if(--ze.usedTimes===0){const tt=se.indexOf(ze);se[tt]=se[se.length-1],se.pop(),ze.destroy()}}function $e(ze){Me.remove(ze)}function st(){Me.dispose()}return{getParameters:xe,getProgramCacheKey:Fe,getUniforms:ke,acquireProgram:Ve,releaseProgram:Xe,releaseShaderCache:$e,programs:se,dispose:st}}function WebGLProperties(){let re=new WeakMap;function U(fe){return re.has(fe)}function Y(fe){let pe=re.get(fe);return pe===void 0&&(pe={},re.set(fe,pe)),pe}function ie(fe){re.delete(fe)}function ne(fe,pe,Me){re.get(fe)[pe]=Me}function F(){re=new WeakMap}return{has:U,get:Y,remove:ie,update:ne,dispose:F}}function painterSortStable(re,U){return re.groupOrder!==U.groupOrder?re.groupOrder-U.groupOrder:re.renderOrder!==U.renderOrder?re.renderOrder-U.renderOrder:re.material.id!==U.material.id?re.material.id-U.material.id:re.z!==U.z?re.z-U.z:re.id-U.id}function reversePainterSortStable(re,U){return re.groupOrder!==U.groupOrder?re.groupOrder-U.groupOrder:re.renderOrder!==U.renderOrder?re.renderOrder-U.renderOrder:re.z!==U.z?U.z-re.z:re.id-U.id}function WebGLRenderList(){const re=[];let U=0;const Y=[],ie=[],ne=[];function F(){U=0,Y.length=0,ie.length=0,ne.length=0}function fe(me,Te,Re,be,Pe,Le){let xe=re[U];return xe===void 0?(xe={id:me.id,object:me,geometry:Te,material:Re,groupOrder:be,renderOrder:me.renderOrder,z:Pe,group:Le},re[U]=xe):(xe.id=me.id,xe.object=me,xe.geometry=Te,xe.material=Re,xe.groupOrder=be,xe.renderOrder=me.renderOrder,xe.z=Pe,xe.group=Le),U++,xe}function pe(me,Te,Re,be,Pe,Le){const xe=fe(me,Te,Re,be,Pe,Le);Re.transmission>0?ie.push(xe):Re.transparent===!0?ne.push(xe):Y.push(xe)}function Me(me,Te,Re,be,Pe,Le){const xe=fe(me,Te,Re,be,Pe,Le);Re.transmission>0?ie.unshift(xe):Re.transparent===!0?ne.unshift(xe):Y.unshift(xe)}function ve(me,Te){Y.length>1&&Y.sort(me||painterSortStable),ie.length>1&&ie.sort(Te||reversePainterSortStable),ne.length>1&&ne.sort(Te||reversePainterSortStable)}function se(){for(let me=U,Te=re.length;me<Te;me++){const Re=re[me];if(Re.id===null)break;Re.id=null,Re.object=null,Re.geometry=null,Re.material=null,Re.group=null}}return{opaque:Y,transmissive:ie,transparent:ne,init:F,push:pe,unshift:Me,finish:se,sort:ve}}function WebGLRenderLists(){let re=new WeakMap;function U(ie,ne){const F=re.get(ie);let fe;return F===void 0?(fe=new WebGLRenderList,re.set(ie,[fe])):ne>=F.length?(fe=new WebGLRenderList,F.push(fe)):fe=F[ne],fe}function Y(){re=new WeakMap}return{get:U,dispose:Y}}function UniformsCache(){const re={};return{get:function(U){if(re[U.id]!==void 0)return re[U.id];let Y;switch(U.type){case"DirectionalLight":Y={direction:new Vector3,color:new Color};break;case"SpotLight":Y={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":Y={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":Y={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":Y={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return re[U.id]=Y,Y}}}function ShadowUniformsCache(){const re={};return{get:function(U){if(re[U.id]!==void 0)return re[U.id];let Y;switch(U.type){case"DirectionalLight":Y={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":Y={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":Y={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return re[U.id]=Y,Y}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(re,U){return(U.castShadow?2:0)-(re.castShadow?2:0)+(U.map?1:0)-(re.map?1:0)}function WebGLLights(re){const U=new UniformsCache,Y=ShadowUniformsCache(),ie={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let ve=0;ve<9;ve++)ie.probe.push(new Vector3);const ne=new Vector3,F=new Matrix4,fe=new Matrix4;function pe(ve){let se=0,me=0,Te=0;for(let st=0;st<9;st++)ie.probe[st].set(0,0,0);let Re=0,be=0,Pe=0,Le=0,xe=0,Fe=0,Oe=0,Ne=0,ke=0,Ve=0,Xe=0;ve.sort(shadowCastingAndTexturingLightsFirst);for(let st=0,ze=ve.length;st<ze;st++){const tt=ve[st],ft=tt.color,Rt=tt.intensity,Mt=tt.distance,Gt=tt.shadow&&tt.shadow.map?tt.shadow.map.texture:null;if(tt.isAmbientLight)se+=ft.r*Rt,me+=ft.g*Rt,Te+=ft.b*Rt;else if(tt.isLightProbe){for(let _t=0;_t<9;_t++)ie.probe[_t].addScaledVector(tt.sh.coefficients[_t],Rt);Xe++}else if(tt.isDirectionalLight){const _t=U.get(tt);if(_t.color.copy(tt.color).multiplyScalar(tt.intensity),tt.castShadow){const Bt=tt.shadow,dt=Y.get(tt);dt.shadowIntensity=Bt.intensity,dt.shadowBias=Bt.bias,dt.shadowNormalBias=Bt.normalBias,dt.shadowRadius=Bt.radius,dt.shadowMapSize=Bt.mapSize,ie.directionalShadow[Re]=dt,ie.directionalShadowMap[Re]=Gt,ie.directionalShadowMatrix[Re]=tt.shadow.matrix,Fe++}ie.directional[Re]=_t,Re++}else if(tt.isSpotLight){const _t=U.get(tt);_t.position.setFromMatrixPosition(tt.matrixWorld),_t.color.copy(ft).multiplyScalar(Rt),_t.distance=Mt,_t.coneCos=Math.cos(tt.angle),_t.penumbraCos=Math.cos(tt.angle*(1-tt.penumbra)),_t.decay=tt.decay,ie.spot[Pe]=_t;const Bt=tt.shadow;if(tt.map&&(ie.spotLightMap[ke]=tt.map,ke++,Bt.updateMatrices(tt),tt.castShadow&&Ve++),ie.spotLightMatrix[Pe]=Bt.matrix,tt.castShadow){const dt=Y.get(tt);dt.shadowIntensity=Bt.intensity,dt.shadowBias=Bt.bias,dt.shadowNormalBias=Bt.normalBias,dt.shadowRadius=Bt.radius,dt.shadowMapSize=Bt.mapSize,ie.spotShadow[Pe]=dt,ie.spotShadowMap[Pe]=Gt,Ne++}Pe++}else if(tt.isRectAreaLight){const _t=U.get(tt);_t.color.copy(ft).multiplyScalar(Rt),_t.halfWidth.set(tt.width*.5,0,0),_t.halfHeight.set(0,tt.height*.5,0),ie.rectArea[Le]=_t,Le++}else if(tt.isPointLight){const _t=U.get(tt);if(_t.color.copy(tt.color).multiplyScalar(tt.intensity),_t.distance=tt.distance,_t.decay=tt.decay,tt.castShadow){const Bt=tt.shadow,dt=Y.get(tt);dt.shadowIntensity=Bt.intensity,dt.shadowBias=Bt.bias,dt.shadowNormalBias=Bt.normalBias,dt.shadowRadius=Bt.radius,dt.shadowMapSize=Bt.mapSize,dt.shadowCameraNear=Bt.camera.near,dt.shadowCameraFar=Bt.camera.far,ie.pointShadow[be]=dt,ie.pointShadowMap[be]=Gt,ie.pointShadowMatrix[be]=tt.shadow.matrix,Oe++}ie.point[be]=_t,be++}else if(tt.isHemisphereLight){const _t=U.get(tt);_t.skyColor.copy(tt.color).multiplyScalar(Rt),_t.groundColor.copy(tt.groundColor).multiplyScalar(Rt),ie.hemi[xe]=_t,xe++}}Le>0&&(re.has("OES_texture_float_linear")===!0?(ie.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,ie.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(ie.rectAreaLTC1=UniformsLib.LTC_HALF_1,ie.rectAreaLTC2=UniformsLib.LTC_HALF_2)),ie.ambient[0]=se,ie.ambient[1]=me,ie.ambient[2]=Te;const $e=ie.hash;($e.directionalLength!==Re||$e.pointLength!==be||$e.spotLength!==Pe||$e.rectAreaLength!==Le||$e.hemiLength!==xe||$e.numDirectionalShadows!==Fe||$e.numPointShadows!==Oe||$e.numSpotShadows!==Ne||$e.numSpotMaps!==ke||$e.numLightProbes!==Xe)&&(ie.directional.length=Re,ie.spot.length=Pe,ie.rectArea.length=Le,ie.point.length=be,ie.hemi.length=xe,ie.directionalShadow.length=Fe,ie.directionalShadowMap.length=Fe,ie.pointShadow.length=Oe,ie.pointShadowMap.length=Oe,ie.spotShadow.length=Ne,ie.spotShadowMap.length=Ne,ie.directionalShadowMatrix.length=Fe,ie.pointShadowMatrix.length=Oe,ie.spotLightMatrix.length=Ne+ke-Ve,ie.spotLightMap.length=ke,ie.numSpotLightShadowsWithMaps=Ve,ie.numLightProbes=Xe,$e.directionalLength=Re,$e.pointLength=be,$e.spotLength=Pe,$e.rectAreaLength=Le,$e.hemiLength=xe,$e.numDirectionalShadows=Fe,$e.numPointShadows=Oe,$e.numSpotShadows=Ne,$e.numSpotMaps=ke,$e.numLightProbes=Xe,ie.version=nextVersion++)}function Me(ve,se){let me=0,Te=0,Re=0,be=0,Pe=0;const Le=se.matrixWorldInverse;for(let xe=0,Fe=ve.length;xe<Fe;xe++){const Oe=ve[xe];if(Oe.isDirectionalLight){const Ne=ie.directional[me];Ne.direction.setFromMatrixPosition(Oe.matrixWorld),ne.setFromMatrixPosition(Oe.target.matrixWorld),Ne.direction.sub(ne),Ne.direction.transformDirection(Le),me++}else if(Oe.isSpotLight){const Ne=ie.spot[Re];Ne.position.setFromMatrixPosition(Oe.matrixWorld),Ne.position.applyMatrix4(Le),Ne.direction.setFromMatrixPosition(Oe.matrixWorld),ne.setFromMatrixPosition(Oe.target.matrixWorld),Ne.direction.sub(ne),Ne.direction.transformDirection(Le),Re++}else if(Oe.isRectAreaLight){const Ne=ie.rectArea[be];Ne.position.setFromMatrixPosition(Oe.matrixWorld),Ne.position.applyMatrix4(Le),fe.identity(),F.copy(Oe.matrixWorld),F.premultiply(Le),fe.extractRotation(F),Ne.halfWidth.set(Oe.width*.5,0,0),Ne.halfHeight.set(0,Oe.height*.5,0),Ne.halfWidth.applyMatrix4(fe),Ne.halfHeight.applyMatrix4(fe),be++}else if(Oe.isPointLight){const Ne=ie.point[Te];Ne.position.setFromMatrixPosition(Oe.matrixWorld),Ne.position.applyMatrix4(Le),Te++}else if(Oe.isHemisphereLight){const Ne=ie.hemi[Pe];Ne.direction.setFromMatrixPosition(Oe.matrixWorld),Ne.direction.transformDirection(Le),Pe++}}}return{setup:pe,setupView:Me,state:ie}}function WebGLRenderState(re){const U=new WebGLLights(re),Y=[],ie=[];function ne(se){ve.camera=se,Y.length=0,ie.length=0}function F(se){Y.push(se)}function fe(se){ie.push(se)}function pe(){U.setup(Y)}function Me(se){U.setupView(Y,se)}const ve={lightsArray:Y,shadowsArray:ie,camera:null,lights:U,transmissionRenderTarget:{}};return{init:ne,state:ve,setupLights:pe,setupLightsView:Me,pushLight:F,pushShadow:fe}}function WebGLRenderStates(re){let U=new WeakMap;function Y(ne,F=0){const fe=U.get(ne);let pe;return fe===void 0?(pe=new WebGLRenderState(re),U.set(ne,[pe])):F>=fe.length?(pe=new WebGLRenderState(re),fe.push(pe)):pe=fe[F],pe}function ie(){U=new WeakMap}return{get:Y,dispose:ie}}class MeshDepthMaterial extends Material$1{constructor(U){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(U)}copy(U){return super.copy(U),this.depthPacking=U.depthPacking,this.map=U.map,this.alphaMap=U.alphaMap,this.displacementMap=U.displacementMap,this.displacementScale=U.displacementScale,this.displacementBias=U.displacementBias,this.wireframe=U.wireframe,this.wireframeLinewidth=U.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material$1{constructor(U){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(U)}copy(U){return super.copy(U),this.map=U.map,this.alphaMap=U.alphaMap,this.displacementMap=U.displacementMap,this.displacementScale=U.displacementScale,this.displacementBias=U.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(re,U,Y){let ie=new Frustum;const ne=new Vector2,F=new Vector2,fe=new Vector4,pe=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),Me=new MeshDistanceMaterial,ve={},se=Y.maxTextureSize,me={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},Te=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),Re=Te.clone();Re.defines.HORIZONTAL_PASS=1;const be=new BufferGeometry;be.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Pe=new Mesh(be,Te),Le=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let xe=this.type;this.render=function(Ve,Xe,$e){if(Le.enabled===!1||Le.autoUpdate===!1&&Le.needsUpdate===!1||Ve.length===0)return;const st=re.getRenderTarget(),ze=re.getActiveCubeFace(),tt=re.getActiveMipmapLevel(),ft=re.state;ft.setBlending(NoBlending),ft.buffers.color.setClear(1,1,1,1),ft.buffers.depth.setTest(!0),ft.setScissorTest(!1);const Rt=xe!==VSMShadowMap&&this.type===VSMShadowMap,Mt=xe===VSMShadowMap&&this.type!==VSMShadowMap;for(let Gt=0,_t=Ve.length;Gt<_t;Gt++){const Bt=Ve[Gt],dt=Bt.shadow;if(dt===void 0){console.warn("THREE.WebGLShadowMap:",Bt,"has no shadow.");continue}if(dt.autoUpdate===!1&&dt.needsUpdate===!1)continue;ne.copy(dt.mapSize);const ut=dt.getFrameExtents();if(ne.multiply(ut),F.copy(dt.mapSize),(ne.x>se||ne.y>se)&&(ne.x>se&&(F.x=Math.floor(se/ut.x),ne.x=F.x*ut.x,dt.mapSize.x=F.x),ne.y>se&&(F.y=Math.floor(se/ut.y),ne.y=F.y*ut.y,dt.mapSize.y=F.y)),dt.map===null||Rt===!0||Mt===!0){const Tt=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};dt.map!==null&&dt.map.dispose(),dt.map=new WebGLRenderTarget(ne.x,ne.y,Tt),dt.map.texture.name=Bt.name+".shadowMap",dt.camera.updateProjectionMatrix()}re.setRenderTarget(dt.map),re.clear();const Ut=dt.getViewportCount();for(let Tt=0;Tt<Ut;Tt++){const Xt=dt.getViewport(Tt);fe.set(F.x*Xt.x,F.y*Xt.y,F.x*Xt.z,F.y*Xt.w),ft.viewport(fe),dt.updateMatrices(Bt,Tt),ie=dt.getFrustum(),Ne(Xe,$e,dt.camera,Bt,this.type)}dt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&Fe(dt,$e),dt.needsUpdate=!1}xe=this.type,Le.needsUpdate=!1,re.setRenderTarget(st,ze,tt)};function Fe(Ve,Xe){const $e=U.update(Pe);Te.defines.VSM_SAMPLES!==Ve.blurSamples&&(Te.defines.VSM_SAMPLES=Ve.blurSamples,Re.defines.VSM_SAMPLES=Ve.blurSamples,Te.needsUpdate=!0,Re.needsUpdate=!0),Ve.mapPass===null&&(Ve.mapPass=new WebGLRenderTarget(ne.x,ne.y)),Te.uniforms.shadow_pass.value=Ve.map.texture,Te.uniforms.resolution.value=Ve.mapSize,Te.uniforms.radius.value=Ve.radius,re.setRenderTarget(Ve.mapPass),re.clear(),re.renderBufferDirect(Xe,null,$e,Te,Pe,null),Re.uniforms.shadow_pass.value=Ve.mapPass.texture,Re.uniforms.resolution.value=Ve.mapSize,Re.uniforms.radius.value=Ve.radius,re.setRenderTarget(Ve.map),re.clear(),re.renderBufferDirect(Xe,null,$e,Re,Pe,null)}function Oe(Ve,Xe,$e,st){let ze=null;const tt=$e.isPointLight===!0?Ve.customDistanceMaterial:Ve.customDepthMaterial;if(tt!==void 0)ze=tt;else if(ze=$e.isPointLight===!0?Me:pe,re.localClippingEnabled&&Xe.clipShadows===!0&&Array.isArray(Xe.clippingPlanes)&&Xe.clippingPlanes.length!==0||Xe.displacementMap&&Xe.displacementScale!==0||Xe.alphaMap&&Xe.alphaTest>0||Xe.map&&Xe.alphaTest>0){const ft=ze.uuid,Rt=Xe.uuid;let Mt=ve[ft];Mt===void 0&&(Mt={},ve[ft]=Mt);let Gt=Mt[Rt];Gt===void 0&&(Gt=ze.clone(),Mt[Rt]=Gt,Xe.addEventListener("dispose",ke)),ze=Gt}if(ze.visible=Xe.visible,ze.wireframe=Xe.wireframe,st===VSMShadowMap?ze.side=Xe.shadowSide!==null?Xe.shadowSide:Xe.side:ze.side=Xe.shadowSide!==null?Xe.shadowSide:me[Xe.side],ze.alphaMap=Xe.alphaMap,ze.alphaTest=Xe.alphaTest,ze.map=Xe.map,ze.clipShadows=Xe.clipShadows,ze.clippingPlanes=Xe.clippingPlanes,ze.clipIntersection=Xe.clipIntersection,ze.displacementMap=Xe.displacementMap,ze.displacementScale=Xe.displacementScale,ze.displacementBias=Xe.displacementBias,ze.wireframeLinewidth=Xe.wireframeLinewidth,ze.linewidth=Xe.linewidth,$e.isPointLight===!0&&ze.isMeshDistanceMaterial===!0){const ft=re.properties.get(ze);ft.light=$e}return ze}function Ne(Ve,Xe,$e,st,ze){if(Ve.visible===!1)return;if(Ve.layers.test(Xe.layers)&&(Ve.isMesh||Ve.isLine||Ve.isPoints)&&(Ve.castShadow||Ve.receiveShadow&&ze===VSMShadowMap)&&(!Ve.frustumCulled||ie.intersectsObject(Ve))){Ve.modelViewMatrix.multiplyMatrices($e.matrixWorldInverse,Ve.matrixWorld);const Rt=U.update(Ve),Mt=Ve.material;if(Array.isArray(Mt)){const Gt=Rt.groups;for(let _t=0,Bt=Gt.length;_t<Bt;_t++){const dt=Gt[_t],ut=Mt[dt.materialIndex];if(ut&&ut.visible){const Ut=Oe(Ve,ut,st,ze);Ve.onBeforeShadow(re,Ve,Xe,$e,Rt,Ut,dt),re.renderBufferDirect($e,null,Rt,Ut,Ve,dt),Ve.onAfterShadow(re,Ve,Xe,$e,Rt,Ut,dt)}}}else if(Mt.visible){const Gt=Oe(Ve,Mt,st,ze);Ve.onBeforeShadow(re,Ve,Xe,$e,Rt,Gt,null),re.renderBufferDirect($e,null,Rt,Gt,Ve,null),Ve.onAfterShadow(re,Ve,Xe,$e,Rt,Gt,null)}}const ft=Ve.children;for(let Rt=0,Mt=ft.length;Rt<Mt;Rt++)Ne(ft[Rt],Xe,$e,st,ze)}function ke(Ve){Ve.target.removeEventListener("dispose",ke);for(const $e in ve){const st=ve[$e],ze=Ve.target.uuid;ze in st&&(st[ze].dispose(),delete st[ze])}}}const reversedFuncs={[NeverDepth]:AlwaysDepth,[LessDepth]:GreaterDepth,[EqualDepth]:NotEqualDepth,[LessEqualDepth]:GreaterEqualDepth,[AlwaysDepth]:NeverDepth,[GreaterDepth]:LessDepth,[NotEqualDepth]:EqualDepth,[GreaterEqualDepth]:LessEqualDepth};function WebGLState(re){function U(){let ot=!1;const Vt=new Vector4;let Wt=null;const sn=new Vector4(0,0,0,0);return{setMask:function(yn){Wt!==yn&&!ot&&(re.colorMask(yn,yn,yn,yn),Wt=yn)},setLocked:function(yn){ot=yn},setClear:function(yn,ni,ki,Hi,ji){ji===!0&&(yn*=Hi,ni*=Hi,ki*=Hi),Vt.set(yn,ni,ki,Hi),sn.equals(Vt)===!1&&(re.clearColor(yn,ni,ki,Hi),sn.copy(Vt))},reset:function(){ot=!1,Wt=null,sn.set(-1,0,0,0)}}}function Y(){let ot=!1,Vt=!1,Wt=null,sn=null,yn=null;return{setReversed:function(ni){Vt=ni},setTest:function(ni){ni?Cn(re.DEPTH_TEST):Nn(re.DEPTH_TEST)},setMask:function(ni){Wt!==ni&&!ot&&(re.depthMask(ni),Wt=ni)},setFunc:function(ni){if(Vt&&(ni=reversedFuncs[ni]),sn!==ni){switch(ni){case NeverDepth:re.depthFunc(re.NEVER);break;case AlwaysDepth:re.depthFunc(re.ALWAYS);break;case LessDepth:re.depthFunc(re.LESS);break;case LessEqualDepth:re.depthFunc(re.LEQUAL);break;case EqualDepth:re.depthFunc(re.EQUAL);break;case GreaterEqualDepth:re.depthFunc(re.GEQUAL);break;case GreaterDepth:re.depthFunc(re.GREATER);break;case NotEqualDepth:re.depthFunc(re.NOTEQUAL);break;default:re.depthFunc(re.LEQUAL)}sn=ni}},setLocked:function(ni){ot=ni},setClear:function(ni){yn!==ni&&(re.clearDepth(ni),yn=ni)},reset:function(){ot=!1,Wt=null,sn=null,yn=null}}}function ie(){let ot=!1,Vt=null,Wt=null,sn=null,yn=null,ni=null,ki=null,Hi=null,ji=null;return{setTest:function(Xi){ot||(Xi?Cn(re.STENCIL_TEST):Nn(re.STENCIL_TEST))},setMask:function(Xi){Vt!==Xi&&!ot&&(re.stencilMask(Xi),Vt=Xi)},setFunc:function(Xi,Ws,Jr){(Wt!==Xi||sn!==Ws||yn!==Jr)&&(re.stencilFunc(Xi,Ws,Jr),Wt=Xi,sn=Ws,yn=Jr)},setOp:function(Xi,Ws,Jr){(ni!==Xi||ki!==Ws||Hi!==Jr)&&(re.stencilOp(Xi,Ws,Jr),ni=Xi,ki=Ws,Hi=Jr)},setLocked:function(Xi){ot=Xi},setClear:function(Xi){ji!==Xi&&(re.clearStencil(Xi),ji=Xi)},reset:function(){ot=!1,Vt=null,Wt=null,sn=null,yn=null,ni=null,ki=null,Hi=null,ji=null}}}const ne=new U,F=new Y,fe=new ie,pe=new WeakMap,Me=new WeakMap;let ve={},se={},me=new WeakMap,Te=[],Re=null,be=!1,Pe=null,Le=null,xe=null,Fe=null,Oe=null,Ne=null,ke=null,Ve=new Color(0,0,0),Xe=0,$e=!1,st=null,ze=null,tt=null,ft=null,Rt=null;const Mt=re.getParameter(re.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Gt=!1,_t=0;const Bt=re.getParameter(re.VERSION);Bt.indexOf("WebGL")!==-1?(_t=parseFloat(/^WebGL (\d)/.exec(Bt)[1]),Gt=_t>=1):Bt.indexOf("OpenGL ES")!==-1&&(_t=parseFloat(/^OpenGL ES (\d)/.exec(Bt)[1]),Gt=_t>=2);let dt=null,ut={};const Ut=re.getParameter(re.SCISSOR_BOX),Tt=re.getParameter(re.VIEWPORT),Xt=new Vector4().fromArray(Ut),hn=new Vector4().fromArray(Tt);function nn(ot,Vt,Wt,sn){const yn=new Uint8Array(4),ni=re.createTexture();re.bindTexture(ot,ni),re.texParameteri(ot,re.TEXTURE_MIN_FILTER,re.NEAREST),re.texParameteri(ot,re.TEXTURE_MAG_FILTER,re.NEAREST);for(let ki=0;ki<Wt;ki++)ot===re.TEXTURE_3D||ot===re.TEXTURE_2D_ARRAY?re.texImage3D(Vt,0,re.RGBA,1,1,sn,0,re.RGBA,re.UNSIGNED_BYTE,yn):re.texImage2D(Vt+ki,0,re.RGBA,1,1,0,re.RGBA,re.UNSIGNED_BYTE,yn);return ni}const An={};An[re.TEXTURE_2D]=nn(re.TEXTURE_2D,re.TEXTURE_2D,1),An[re.TEXTURE_CUBE_MAP]=nn(re.TEXTURE_CUBE_MAP,re.TEXTURE_CUBE_MAP_POSITIVE_X,6),An[re.TEXTURE_2D_ARRAY]=nn(re.TEXTURE_2D_ARRAY,re.TEXTURE_2D_ARRAY,1,1),An[re.TEXTURE_3D]=nn(re.TEXTURE_3D,re.TEXTURE_3D,1,1),ne.setClear(0,0,0,1),F.setClear(1),fe.setClear(0),Cn(re.DEPTH_TEST),F.setFunc(LessEqualDepth),Ir(!1),Rr(CullFaceBack),Cn(re.CULL_FACE),Mn(NoBlending);function Cn(ot){ve[ot]!==!0&&(re.enable(ot),ve[ot]=!0)}function Nn(ot){ve[ot]!==!1&&(re.disable(ot),ve[ot]=!1)}function Qn(ot,Vt){return se[ot]!==Vt?(re.bindFramebuffer(ot,Vt),se[ot]=Vt,ot===re.DRAW_FRAMEBUFFER&&(se[re.FRAMEBUFFER]=Vt),ot===re.FRAMEBUFFER&&(se[re.DRAW_FRAMEBUFFER]=Vt),!0):!1}function fi(ot,Vt){let Wt=Te,sn=!1;if(ot){Wt=me.get(Vt),Wt===void 0&&(Wt=[],me.set(Vt,Wt));const yn=ot.textures;if(Wt.length!==yn.length||Wt[0]!==re.COLOR_ATTACHMENT0){for(let ni=0,ki=yn.length;ni<ki;ni++)Wt[ni]=re.COLOR_ATTACHMENT0+ni;Wt.length=yn.length,sn=!0}}else Wt[0]!==re.BACK&&(Wt[0]=re.BACK,sn=!0);sn&&re.drawBuffers(Wt)}function hi(ot){return Re!==ot?(re.useProgram(ot),Re=ot,!0):!1}const Qi={[AddEquation]:re.FUNC_ADD,[SubtractEquation]:re.FUNC_SUBTRACT,[ReverseSubtractEquation]:re.FUNC_REVERSE_SUBTRACT};Qi[MinEquation]=re.MIN,Qi[MaxEquation]=re.MAX;const Zi={[ZeroFactor]:re.ZERO,[OneFactor]:re.ONE,[SrcColorFactor]:re.SRC_COLOR,[SrcAlphaFactor]:re.SRC_ALPHA,[SrcAlphaSaturateFactor]:re.SRC_ALPHA_SATURATE,[DstColorFactor]:re.DST_COLOR,[DstAlphaFactor]:re.DST_ALPHA,[OneMinusSrcColorFactor]:re.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:re.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:re.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:re.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:re.CONSTANT_COLOR,[OneMinusConstantColorFactor]:re.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:re.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:re.ONE_MINUS_CONSTANT_ALPHA};function Mn(ot,Vt,Wt,sn,yn,ni,ki,Hi,ji,Xi){if(ot===NoBlending){be===!0&&(Nn(re.BLEND),be=!1);return}if(be===!1&&(Cn(re.BLEND),be=!0),ot!==CustomBlending){if(ot!==Pe||Xi!==$e){if((Le!==AddEquation||Oe!==AddEquation)&&(re.blendEquation(re.FUNC_ADD),Le=AddEquation,Oe=AddEquation),Xi)switch(ot){case NormalBlending:re.blendFuncSeparate(re.ONE,re.ONE_MINUS_SRC_ALPHA,re.ONE,re.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:re.blendFunc(re.ONE,re.ONE);break;case SubtractiveBlending:re.blendFuncSeparate(re.ZERO,re.ONE_MINUS_SRC_COLOR,re.ZERO,re.ONE);break;case MultiplyBlending:re.blendFuncSeparate(re.ZERO,re.SRC_COLOR,re.ZERO,re.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ot);break}else switch(ot){case NormalBlending:re.blendFuncSeparate(re.SRC_ALPHA,re.ONE_MINUS_SRC_ALPHA,re.ONE,re.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:re.blendFunc(re.SRC_ALPHA,re.ONE);break;case SubtractiveBlending:re.blendFuncSeparate(re.ZERO,re.ONE_MINUS_SRC_COLOR,re.ZERO,re.ONE);break;case MultiplyBlending:re.blendFunc(re.ZERO,re.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ot);break}xe=null,Fe=null,Ne=null,ke=null,Ve.set(0,0,0),Xe=0,Pe=ot,$e=Xi}return}yn=yn||Vt,ni=ni||Wt,ki=ki||sn,(Vt!==Le||yn!==Oe)&&(re.blendEquationSeparate(Qi[Vt],Qi[yn]),Le=Vt,Oe=yn),(Wt!==xe||sn!==Fe||ni!==Ne||ki!==ke)&&(re.blendFuncSeparate(Zi[Wt],Zi[sn],Zi[ni],Zi[ki]),xe=Wt,Fe=sn,Ne=ni,ke=ki),(Hi.equals(Ve)===!1||ji!==Xe)&&(re.blendColor(Hi.r,Hi.g,Hi.b,ji),Ve.copy(Hi),Xe=ji),Pe=ot,$e=!1}function Vr(ot,Vt){ot.side===DoubleSide?Nn(re.CULL_FACE):Cn(re.CULL_FACE);let Wt=ot.side===BackSide;Vt&&(Wt=!Wt),Ir(Wt),ot.blending===NormalBlending&&ot.transparent===!1?Mn(NoBlending):Mn(ot.blending,ot.blendEquation,ot.blendSrc,ot.blendDst,ot.blendEquationAlpha,ot.blendSrcAlpha,ot.blendDstAlpha,ot.blendColor,ot.blendAlpha,ot.premultipliedAlpha),F.setFunc(ot.depthFunc),F.setTest(ot.depthTest),F.setMask(ot.depthWrite),ne.setMask(ot.colorWrite);const sn=ot.stencilWrite;fe.setTest(sn),sn&&(fe.setMask(ot.stencilWriteMask),fe.setFunc(ot.stencilFunc,ot.stencilRef,ot.stencilFuncMask),fe.setOp(ot.stencilFail,ot.stencilZFail,ot.stencilZPass)),zr(ot.polygonOffset,ot.polygonOffsetFactor,ot.polygonOffsetUnits),ot.alphaToCoverage===!0?Cn(re.SAMPLE_ALPHA_TO_COVERAGE):Nn(re.SAMPLE_ALPHA_TO_COVERAGE)}function Ir(ot){st!==ot&&(ot?re.frontFace(re.CW):re.frontFace(re.CCW),st=ot)}function Rr(ot){ot!==CullFaceNone?(Cn(re.CULL_FACE),ot!==ze&&(ot===CullFaceBack?re.cullFace(re.BACK):ot===CullFaceFront?re.cullFace(re.FRONT):re.cullFace(re.FRONT_AND_BACK))):Nn(re.CULL_FACE),ze=ot}function ir(ot){ot!==tt&&(Gt&&re.lineWidth(ot),tt=ot)}function zr(ot,Vt,Wt){ot?(Cn(re.POLYGON_OFFSET_FILL),(ft!==Vt||Rt!==Wt)&&(re.polygonOffset(Vt,Wt),ft=Vt,Rt=Wt)):Nn(re.POLYGON_OFFSET_FILL)}function Br(ot){ot?Cn(re.SCISSOR_TEST):Nn(re.SCISSOR_TEST)}function kt(ot){ot===void 0&&(ot=re.TEXTURE0+Mt-1),dt!==ot&&(re.activeTexture(ot),dt=ot)}function rn(ot,Vt,Wt){Wt===void 0&&(dt===null?Wt=re.TEXTURE0+Mt-1:Wt=dt);let sn=ut[Wt];sn===void 0&&(sn={type:void 0,texture:void 0},ut[Wt]=sn),(sn.type!==ot||sn.texture!==Vt)&&(dt!==Wt&&(re.activeTexture(Wt),dt=Wt),re.bindTexture(ot,Vt||An[ot]),sn.type=ot,sn.texture=Vt)}function Kn(){const ot=ut[dt];ot!==void 0&&ot.type!==void 0&&(re.bindTexture(ot.type,null),ot.type=void 0,ot.texture=void 0)}function ai(){try{re.compressedTexImage2D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Ui(){try{re.compressedTexImage3D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function yi(){try{re.texSubImage2D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Nr(){try{re.texSubImage3D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Ar(){try{re.compressedTexSubImage2D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function fr(){try{re.compressedTexSubImage3D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Bi(){try{re.texStorage2D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Kt(){try{re.texStorage3D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Yt(){try{re.texImage2D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function fn(){try{re.texImage3D.apply(re,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function on(ot){Xt.equals(ot)===!1&&(re.scissor(ot.x,ot.y,ot.z,ot.w),Xt.copy(ot))}function an(ot){hn.equals(ot)===!1&&(re.viewport(ot.x,ot.y,ot.z,ot.w),hn.copy(ot))}function gn(ot,Vt){let Wt=Me.get(Vt);Wt===void 0&&(Wt=new WeakMap,Me.set(Vt,Wt));let sn=Wt.get(ot);sn===void 0&&(sn=re.getUniformBlockIndex(Vt,ot.name),Wt.set(ot,sn))}function Nt(ot,Vt){const sn=Me.get(Vt).get(ot);pe.get(Vt)!==sn&&(re.uniformBlockBinding(Vt,sn,ot.__bindingPointIndex),pe.set(Vt,sn))}function ht(){re.disable(re.BLEND),re.disable(re.CULL_FACE),re.disable(re.DEPTH_TEST),re.disable(re.POLYGON_OFFSET_FILL),re.disable(re.SCISSOR_TEST),re.disable(re.STENCIL_TEST),re.disable(re.SAMPLE_ALPHA_TO_COVERAGE),re.blendEquation(re.FUNC_ADD),re.blendFunc(re.ONE,re.ZERO),re.blendFuncSeparate(re.ONE,re.ZERO,re.ONE,re.ZERO),re.blendColor(0,0,0,0),re.colorMask(!0,!0,!0,!0),re.clearColor(0,0,0,0),re.depthMask(!0),re.depthFunc(re.LESS),re.clearDepth(1),re.stencilMask(4294967295),re.stencilFunc(re.ALWAYS,0,4294967295),re.stencilOp(re.KEEP,re.KEEP,re.KEEP),re.clearStencil(0),re.cullFace(re.BACK),re.frontFace(re.CCW),re.polygonOffset(0,0),re.activeTexture(re.TEXTURE0),re.bindFramebuffer(re.FRAMEBUFFER,null),re.bindFramebuffer(re.DRAW_FRAMEBUFFER,null),re.bindFramebuffer(re.READ_FRAMEBUFFER,null),re.useProgram(null),re.lineWidth(1),re.scissor(0,0,re.canvas.width,re.canvas.height),re.viewport(0,0,re.canvas.width,re.canvas.height),ve={},dt=null,ut={},se={},me=new WeakMap,Te=[],Re=null,be=!1,Pe=null,Le=null,xe=null,Fe=null,Oe=null,Ne=null,ke=null,Ve=new Color(0,0,0),Xe=0,$e=!1,st=null,ze=null,tt=null,ft=null,Rt=null,Xt.set(0,0,re.canvas.width,re.canvas.height),hn.set(0,0,re.canvas.width,re.canvas.height),ne.reset(),F.reset(),fe.reset()}return{buffers:{color:ne,depth:F,stencil:fe},enable:Cn,disable:Nn,bindFramebuffer:Qn,drawBuffers:fi,useProgram:hi,setBlending:Mn,setMaterial:Vr,setFlipSided:Ir,setCullFace:Rr,setLineWidth:ir,setPolygonOffset:zr,setScissorTest:Br,activeTexture:kt,bindTexture:rn,unbindTexture:Kn,compressedTexImage2D:ai,compressedTexImage3D:Ui,texImage2D:Yt,texImage3D:fn,updateUBOMapping:gn,uniformBlockBinding:Nt,texStorage2D:Bi,texStorage3D:Kt,texSubImage2D:yi,texSubImage3D:Nr,compressedTexSubImage2D:Ar,compressedTexSubImage3D:fr,scissor:on,viewport:an,reset:ht}}function getByteLength(re,U,Y,ie){const ne=getTextureTypeByteLength(ie);switch(Y){case AlphaFormat:return re*U;case LuminanceFormat:return re*U;case LuminanceAlphaFormat:return re*U*2;case RedFormat:return re*U/ne.components*ne.byteLength;case RedIntegerFormat:return re*U/ne.components*ne.byteLength;case RGFormat:return re*U*2/ne.components*ne.byteLength;case RGIntegerFormat:return re*U*2/ne.components*ne.byteLength;case RGBFormat:return re*U*3/ne.components*ne.byteLength;case RGBAFormat:return re*U*4/ne.components*ne.byteLength;case RGBAIntegerFormat:return re*U*4/ne.components*ne.byteLength;case RGB_S3TC_DXT1_Format:case RGBA_S3TC_DXT1_Format:return Math.floor((re+3)/4)*Math.floor((U+3)/4)*8;case RGBA_S3TC_DXT3_Format:case RGBA_S3TC_DXT5_Format:return Math.floor((re+3)/4)*Math.floor((U+3)/4)*16;case RGB_PVRTC_2BPPV1_Format:case RGBA_PVRTC_2BPPV1_Format:return Math.max(re,16)*Math.max(U,8)/4;case RGB_PVRTC_4BPPV1_Format:case RGBA_PVRTC_4BPPV1_Format:return Math.max(re,8)*Math.max(U,8)/2;case RGB_ETC1_Format:case RGB_ETC2_Format:return Math.floor((re+3)/4)*Math.floor((U+3)/4)*8;case RGBA_ETC2_EAC_Format:return Math.floor((re+3)/4)*Math.floor((U+3)/4)*16;case RGBA_ASTC_4x4_Format:return Math.floor((re+3)/4)*Math.floor((U+3)/4)*16;case RGBA_ASTC_5x4_Format:return Math.floor((re+4)/5)*Math.floor((U+3)/4)*16;case RGBA_ASTC_5x5_Format:return Math.floor((re+4)/5)*Math.floor((U+4)/5)*16;case RGBA_ASTC_6x5_Format:return Math.floor((re+5)/6)*Math.floor((U+4)/5)*16;case RGBA_ASTC_6x6_Format:return Math.floor((re+5)/6)*Math.floor((U+5)/6)*16;case RGBA_ASTC_8x5_Format:return Math.floor((re+7)/8)*Math.floor((U+4)/5)*16;case RGBA_ASTC_8x6_Format:return Math.floor((re+7)/8)*Math.floor((U+5)/6)*16;case RGBA_ASTC_8x8_Format:return Math.floor((re+7)/8)*Math.floor((U+7)/8)*16;case RGBA_ASTC_10x5_Format:return Math.floor((re+9)/10)*Math.floor((U+4)/5)*16;case RGBA_ASTC_10x6_Format:return Math.floor((re+9)/10)*Math.floor((U+5)/6)*16;case RGBA_ASTC_10x8_Format:return Math.floor((re+9)/10)*Math.floor((U+7)/8)*16;case RGBA_ASTC_10x10_Format:return Math.floor((re+9)/10)*Math.floor((U+9)/10)*16;case RGBA_ASTC_12x10_Format:return Math.floor((re+11)/12)*Math.floor((U+9)/10)*16;case RGBA_ASTC_12x12_Format:return Math.floor((re+11)/12)*Math.floor((U+11)/12)*16;case RGBA_BPTC_Format:case RGB_BPTC_SIGNED_Format:case RGB_BPTC_UNSIGNED_Format:return Math.ceil(re/4)*Math.ceil(U/4)*16;case RED_RGTC1_Format:case SIGNED_RED_RGTC1_Format:return Math.ceil(re/4)*Math.ceil(U/4)*8;case RED_GREEN_RGTC2_Format:case SIGNED_RED_GREEN_RGTC2_Format:return Math.ceil(re/4)*Math.ceil(U/4)*16}throw new Error(`Unable to determine texture byte length for ${Y} format.`)}function getTextureTypeByteLength(re){switch(re){case UnsignedByteType:case ByteType:return{byteLength:1,components:1};case UnsignedShortType:case ShortType:case HalfFloatType:return{byteLength:2,components:1};case UnsignedShort4444Type:case UnsignedShort5551Type:return{byteLength:2,components:4};case UnsignedIntType:case IntType:case FloatType:return{byteLength:4,components:1};case UnsignedInt5999Type:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${re}.`)}function WebGLTextures(re,U,Y,ie,ne,F,fe){const pe=U.has("WEBGL_multisampled_render_to_texture")?U.get("WEBGL_multisampled_render_to_texture"):null,Me=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ve=new Vector2,se=new WeakMap;let me;const Te=new WeakMap;let Re=!1;try{Re=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function be(kt,rn){return Re?new OffscreenCanvas(kt,rn):createElementNS("canvas")}function Pe(kt,rn,Kn){let ai=1;const Ui=Br(kt);if((Ui.width>Kn||Ui.height>Kn)&&(ai=Kn/Math.max(Ui.width,Ui.height)),ai<1)if(typeof HTMLImageElement<"u"&&kt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&kt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&kt instanceof ImageBitmap||typeof VideoFrame<"u"&&kt instanceof VideoFrame){const yi=Math.floor(ai*Ui.width),Nr=Math.floor(ai*Ui.height);me===void 0&&(me=be(yi,Nr));const Ar=rn?be(yi,Nr):me;return Ar.width=yi,Ar.height=Nr,Ar.getContext("2d").drawImage(kt,0,0,yi,Nr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ui.width+"x"+Ui.height+") to ("+yi+"x"+Nr+")."),Ar}else return"data"in kt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ui.width+"x"+Ui.height+")."),kt;return kt}function Le(kt){return kt.generateMipmaps&&kt.minFilter!==NearestFilter&&kt.minFilter!==LinearFilter}function xe(kt){re.generateMipmap(kt)}function Fe(kt,rn,Kn,ai,Ui=!1){if(kt!==null){if(re[kt]!==void 0)return re[kt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+kt+"'")}let yi=rn;if(rn===re.RED&&(Kn===re.FLOAT&&(yi=re.R32F),Kn===re.HALF_FLOAT&&(yi=re.R16F),Kn===re.UNSIGNED_BYTE&&(yi=re.R8)),rn===re.RED_INTEGER&&(Kn===re.UNSIGNED_BYTE&&(yi=re.R8UI),Kn===re.UNSIGNED_SHORT&&(yi=re.R16UI),Kn===re.UNSIGNED_INT&&(yi=re.R32UI),Kn===re.BYTE&&(yi=re.R8I),Kn===re.SHORT&&(yi=re.R16I),Kn===re.INT&&(yi=re.R32I)),rn===re.RG&&(Kn===re.FLOAT&&(yi=re.RG32F),Kn===re.HALF_FLOAT&&(yi=re.RG16F),Kn===re.UNSIGNED_BYTE&&(yi=re.RG8)),rn===re.RG_INTEGER&&(Kn===re.UNSIGNED_BYTE&&(yi=re.RG8UI),Kn===re.UNSIGNED_SHORT&&(yi=re.RG16UI),Kn===re.UNSIGNED_INT&&(yi=re.RG32UI),Kn===re.BYTE&&(yi=re.RG8I),Kn===re.SHORT&&(yi=re.RG16I),Kn===re.INT&&(yi=re.RG32I)),rn===re.RGB_INTEGER&&(Kn===re.UNSIGNED_BYTE&&(yi=re.RGB8UI),Kn===re.UNSIGNED_SHORT&&(yi=re.RGB16UI),Kn===re.UNSIGNED_INT&&(yi=re.RGB32UI),Kn===re.BYTE&&(yi=re.RGB8I),Kn===re.SHORT&&(yi=re.RGB16I),Kn===re.INT&&(yi=re.RGB32I)),rn===re.RGBA_INTEGER&&(Kn===re.UNSIGNED_BYTE&&(yi=re.RGBA8UI),Kn===re.UNSIGNED_SHORT&&(yi=re.RGBA16UI),Kn===re.UNSIGNED_INT&&(yi=re.RGBA32UI),Kn===re.BYTE&&(yi=re.RGBA8I),Kn===re.SHORT&&(yi=re.RGBA16I),Kn===re.INT&&(yi=re.RGBA32I)),rn===re.RGB&&Kn===re.UNSIGNED_INT_5_9_9_9_REV&&(yi=re.RGB9_E5),rn===re.RGBA){const Nr=Ui?LinearTransfer:ColorManagement.getTransfer(ai);Kn===re.FLOAT&&(yi=re.RGBA32F),Kn===re.HALF_FLOAT&&(yi=re.RGBA16F),Kn===re.UNSIGNED_BYTE&&(yi=Nr===SRGBTransfer?re.SRGB8_ALPHA8:re.RGBA8),Kn===re.UNSIGNED_SHORT_4_4_4_4&&(yi=re.RGBA4),Kn===re.UNSIGNED_SHORT_5_5_5_1&&(yi=re.RGB5_A1)}return(yi===re.R16F||yi===re.R32F||yi===re.RG16F||yi===re.RG32F||yi===re.RGBA16F||yi===re.RGBA32F)&&U.get("EXT_color_buffer_float"),yi}function Oe(kt,rn){let Kn;return kt?rn===null||rn===UnsignedIntType||rn===UnsignedInt248Type?Kn=re.DEPTH24_STENCIL8:rn===FloatType?Kn=re.DEPTH32F_STENCIL8:rn===UnsignedShortType&&(Kn=re.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):rn===null||rn===UnsignedIntType||rn===UnsignedInt248Type?Kn=re.DEPTH_COMPONENT24:rn===FloatType?Kn=re.DEPTH_COMPONENT32F:rn===UnsignedShortType&&(Kn=re.DEPTH_COMPONENT16),Kn}function Ne(kt,rn){return Le(kt)===!0||kt.isFramebufferTexture&&kt.minFilter!==NearestFilter&&kt.minFilter!==LinearFilter?Math.log2(Math.max(rn.width,rn.height))+1:kt.mipmaps!==void 0&&kt.mipmaps.length>0?kt.mipmaps.length:kt.isCompressedTexture&&Array.isArray(kt.image)?rn.mipmaps.length:1}function ke(kt){const rn=kt.target;rn.removeEventListener("dispose",ke),Xe(rn),rn.isVideoTexture&&se.delete(rn)}function Ve(kt){const rn=kt.target;rn.removeEventListener("dispose",Ve),st(rn)}function Xe(kt){const rn=ie.get(kt);if(rn.__webglInit===void 0)return;const Kn=kt.source,ai=Te.get(Kn);if(ai){const Ui=ai[rn.__cacheKey];Ui.usedTimes--,Ui.usedTimes===0&&$e(kt),Object.keys(ai).length===0&&Te.delete(Kn)}ie.remove(kt)}function $e(kt){const rn=ie.get(kt);re.deleteTexture(rn.__webglTexture);const Kn=kt.source,ai=Te.get(Kn);delete ai[rn.__cacheKey],fe.memory.textures--}function st(kt){const rn=ie.get(kt);if(kt.depthTexture&&kt.depthTexture.dispose(),kt.isWebGLCubeRenderTarget)for(let ai=0;ai<6;ai++){if(Array.isArray(rn.__webglFramebuffer[ai]))for(let Ui=0;Ui<rn.__webglFramebuffer[ai].length;Ui++)re.deleteFramebuffer(rn.__webglFramebuffer[ai][Ui]);else re.deleteFramebuffer(rn.__webglFramebuffer[ai]);rn.__webglDepthbuffer&&re.deleteRenderbuffer(rn.__webglDepthbuffer[ai])}else{if(Array.isArray(rn.__webglFramebuffer))for(let ai=0;ai<rn.__webglFramebuffer.length;ai++)re.deleteFramebuffer(rn.__webglFramebuffer[ai]);else re.deleteFramebuffer(rn.__webglFramebuffer);if(rn.__webglDepthbuffer&&re.deleteRenderbuffer(rn.__webglDepthbuffer),rn.__webglMultisampledFramebuffer&&re.deleteFramebuffer(rn.__webglMultisampledFramebuffer),rn.__webglColorRenderbuffer)for(let ai=0;ai<rn.__webglColorRenderbuffer.length;ai++)rn.__webglColorRenderbuffer[ai]&&re.deleteRenderbuffer(rn.__webglColorRenderbuffer[ai]);rn.__webglDepthRenderbuffer&&re.deleteRenderbuffer(rn.__webglDepthRenderbuffer)}const Kn=kt.textures;for(let ai=0,Ui=Kn.length;ai<Ui;ai++){const yi=ie.get(Kn[ai]);yi.__webglTexture&&(re.deleteTexture(yi.__webglTexture),fe.memory.textures--),ie.remove(Kn[ai])}ie.remove(kt)}let ze=0;function tt(){ze=0}function ft(){const kt=ze;return kt>=ne.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+kt+" texture units while this GPU supports only "+ne.maxTextures),ze+=1,kt}function Rt(kt){const rn=[];return rn.push(kt.wrapS),rn.push(kt.wrapT),rn.push(kt.wrapR||0),rn.push(kt.magFilter),rn.push(kt.minFilter),rn.push(kt.anisotropy),rn.push(kt.internalFormat),rn.push(kt.format),rn.push(kt.type),rn.push(kt.generateMipmaps),rn.push(kt.premultiplyAlpha),rn.push(kt.flipY),rn.push(kt.unpackAlignment),rn.push(kt.colorSpace),rn.join()}function Mt(kt,rn){const Kn=ie.get(kt);if(kt.isVideoTexture&&ir(kt),kt.isRenderTargetTexture===!1&&kt.version>0&&Kn.__version!==kt.version){const ai=kt.image;if(ai===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ai.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{hn(Kn,kt,rn);return}}Y.bindTexture(re.TEXTURE_2D,Kn.__webglTexture,re.TEXTURE0+rn)}function Gt(kt,rn){const Kn=ie.get(kt);if(kt.version>0&&Kn.__version!==kt.version){hn(Kn,kt,rn);return}Y.bindTexture(re.TEXTURE_2D_ARRAY,Kn.__webglTexture,re.TEXTURE0+rn)}function _t(kt,rn){const Kn=ie.get(kt);if(kt.version>0&&Kn.__version!==kt.version){hn(Kn,kt,rn);return}Y.bindTexture(re.TEXTURE_3D,Kn.__webglTexture,re.TEXTURE0+rn)}function Bt(kt,rn){const Kn=ie.get(kt);if(kt.version>0&&Kn.__version!==kt.version){nn(Kn,kt,rn);return}Y.bindTexture(re.TEXTURE_CUBE_MAP,Kn.__webglTexture,re.TEXTURE0+rn)}const dt={[RepeatWrapping]:re.REPEAT,[ClampToEdgeWrapping]:re.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:re.MIRRORED_REPEAT},ut={[NearestFilter]:re.NEAREST,[NearestMipmapNearestFilter]:re.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:re.NEAREST_MIPMAP_LINEAR,[LinearFilter]:re.LINEAR,[LinearMipmapNearestFilter]:re.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:re.LINEAR_MIPMAP_LINEAR},Ut={[NeverCompare]:re.NEVER,[AlwaysCompare]:re.ALWAYS,[LessCompare]:re.LESS,[LessEqualCompare]:re.LEQUAL,[EqualCompare]:re.EQUAL,[GreaterEqualCompare]:re.GEQUAL,[GreaterCompare]:re.GREATER,[NotEqualCompare]:re.NOTEQUAL};function Tt(kt,rn){if(rn.type===FloatType&&U.has("OES_texture_float_linear")===!1&&(rn.magFilter===LinearFilter||rn.magFilter===LinearMipmapNearestFilter||rn.magFilter===NearestMipmapLinearFilter||rn.magFilter===LinearMipmapLinearFilter||rn.minFilter===LinearFilter||rn.minFilter===LinearMipmapNearestFilter||rn.minFilter===NearestMipmapLinearFilter||rn.minFilter===LinearMipmapLinearFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),re.texParameteri(kt,re.TEXTURE_WRAP_S,dt[rn.wrapS]),re.texParameteri(kt,re.TEXTURE_WRAP_T,dt[rn.wrapT]),(kt===re.TEXTURE_3D||kt===re.TEXTURE_2D_ARRAY)&&re.texParameteri(kt,re.TEXTURE_WRAP_R,dt[rn.wrapR]),re.texParameteri(kt,re.TEXTURE_MAG_FILTER,ut[rn.magFilter]),re.texParameteri(kt,re.TEXTURE_MIN_FILTER,ut[rn.minFilter]),rn.compareFunction&&(re.texParameteri(kt,re.TEXTURE_COMPARE_MODE,re.COMPARE_REF_TO_TEXTURE),re.texParameteri(kt,re.TEXTURE_COMPARE_FUNC,Ut[rn.compareFunction])),U.has("EXT_texture_filter_anisotropic")===!0){if(rn.magFilter===NearestFilter||rn.minFilter!==NearestMipmapLinearFilter&&rn.minFilter!==LinearMipmapLinearFilter||rn.type===FloatType&&U.has("OES_texture_float_linear")===!1)return;if(rn.anisotropy>1||ie.get(rn).__currentAnisotropy){const Kn=U.get("EXT_texture_filter_anisotropic");re.texParameterf(kt,Kn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(rn.anisotropy,ne.getMaxAnisotropy())),ie.get(rn).__currentAnisotropy=rn.anisotropy}}}function Xt(kt,rn){let Kn=!1;kt.__webglInit===void 0&&(kt.__webglInit=!0,rn.addEventListener("dispose",ke));const ai=rn.source;let Ui=Te.get(ai);Ui===void 0&&(Ui={},Te.set(ai,Ui));const yi=Rt(rn);if(yi!==kt.__cacheKey){Ui[yi]===void 0&&(Ui[yi]={texture:re.createTexture(),usedTimes:0},fe.memory.textures++,Kn=!0),Ui[yi].usedTimes++;const Nr=Ui[kt.__cacheKey];Nr!==void 0&&(Ui[kt.__cacheKey].usedTimes--,Nr.usedTimes===0&&$e(rn)),kt.__cacheKey=yi,kt.__webglTexture=Ui[yi].texture}return Kn}function hn(kt,rn,Kn){let ai=re.TEXTURE_2D;(rn.isDataArrayTexture||rn.isCompressedArrayTexture)&&(ai=re.TEXTURE_2D_ARRAY),rn.isData3DTexture&&(ai=re.TEXTURE_3D);const Ui=Xt(kt,rn),yi=rn.source;Y.bindTexture(ai,kt.__webglTexture,re.TEXTURE0+Kn);const Nr=ie.get(yi);if(yi.version!==Nr.__version||Ui===!0){Y.activeTexture(re.TEXTURE0+Kn);const Ar=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),fr=rn.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(rn.colorSpace),Bi=rn.colorSpace===NoColorSpace||Ar===fr?re.NONE:re.BROWSER_DEFAULT_WEBGL;re.pixelStorei(re.UNPACK_FLIP_Y_WEBGL,rn.flipY),re.pixelStorei(re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,rn.premultiplyAlpha),re.pixelStorei(re.UNPACK_ALIGNMENT,rn.unpackAlignment),re.pixelStorei(re.UNPACK_COLORSPACE_CONVERSION_WEBGL,Bi);let Kt=Pe(rn.image,!1,ne.maxTextureSize);Kt=zr(rn,Kt);const Yt=F.convert(rn.format,rn.colorSpace),fn=F.convert(rn.type);let on=Fe(rn.internalFormat,Yt,fn,rn.colorSpace,rn.isVideoTexture);Tt(ai,rn);let an;const gn=rn.mipmaps,Nt=rn.isVideoTexture!==!0,ht=Nr.__version===void 0||Ui===!0,ot=yi.dataReady,Vt=Ne(rn,Kt);if(rn.isDepthTexture)on=Oe(rn.format===DepthStencilFormat,rn.type),ht&&(Nt?Y.texStorage2D(re.TEXTURE_2D,1,on,Kt.width,Kt.height):Y.texImage2D(re.TEXTURE_2D,0,on,Kt.width,Kt.height,0,Yt,fn,null));else if(rn.isDataTexture)if(gn.length>0){Nt&&ht&&Y.texStorage2D(re.TEXTURE_2D,Vt,on,gn[0].width,gn[0].height);for(let Wt=0,sn=gn.length;Wt<sn;Wt++)an=gn[Wt],Nt?ot&&Y.texSubImage2D(re.TEXTURE_2D,Wt,0,0,an.width,an.height,Yt,fn,an.data):Y.texImage2D(re.TEXTURE_2D,Wt,on,an.width,an.height,0,Yt,fn,an.data);rn.generateMipmaps=!1}else Nt?(ht&&Y.texStorage2D(re.TEXTURE_2D,Vt,on,Kt.width,Kt.height),ot&&Y.texSubImage2D(re.TEXTURE_2D,0,0,0,Kt.width,Kt.height,Yt,fn,Kt.data)):Y.texImage2D(re.TEXTURE_2D,0,on,Kt.width,Kt.height,0,Yt,fn,Kt.data);else if(rn.isCompressedTexture)if(rn.isCompressedArrayTexture){Nt&&ht&&Y.texStorage3D(re.TEXTURE_2D_ARRAY,Vt,on,gn[0].width,gn[0].height,Kt.depth);for(let Wt=0,sn=gn.length;Wt<sn;Wt++)if(an=gn[Wt],rn.format!==RGBAFormat)if(Yt!==null)if(Nt){if(ot)if(rn.layerUpdates.size>0){const yn=getByteLength(an.width,an.height,rn.format,rn.type);for(const ni of rn.layerUpdates){const ki=an.data.subarray(ni*yn/an.data.BYTES_PER_ELEMENT,(ni+1)*yn/an.data.BYTES_PER_ELEMENT);Y.compressedTexSubImage3D(re.TEXTURE_2D_ARRAY,Wt,0,0,ni,an.width,an.height,1,Yt,ki,0,0)}rn.clearLayerUpdates()}else Y.compressedTexSubImage3D(re.TEXTURE_2D_ARRAY,Wt,0,0,0,an.width,an.height,Kt.depth,Yt,an.data,0,0)}else Y.compressedTexImage3D(re.TEXTURE_2D_ARRAY,Wt,on,an.width,an.height,Kt.depth,0,an.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Nt?ot&&Y.texSubImage3D(re.TEXTURE_2D_ARRAY,Wt,0,0,0,an.width,an.height,Kt.depth,Yt,fn,an.data):Y.texImage3D(re.TEXTURE_2D_ARRAY,Wt,on,an.width,an.height,Kt.depth,0,Yt,fn,an.data)}else{Nt&&ht&&Y.texStorage2D(re.TEXTURE_2D,Vt,on,gn[0].width,gn[0].height);for(let Wt=0,sn=gn.length;Wt<sn;Wt++)an=gn[Wt],rn.format!==RGBAFormat?Yt!==null?Nt?ot&&Y.compressedTexSubImage2D(re.TEXTURE_2D,Wt,0,0,an.width,an.height,Yt,an.data):Y.compressedTexImage2D(re.TEXTURE_2D,Wt,on,an.width,an.height,0,an.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Nt?ot&&Y.texSubImage2D(re.TEXTURE_2D,Wt,0,0,an.width,an.height,Yt,fn,an.data):Y.texImage2D(re.TEXTURE_2D,Wt,on,an.width,an.height,0,Yt,fn,an.data)}else if(rn.isDataArrayTexture)if(Nt){if(ht&&Y.texStorage3D(re.TEXTURE_2D_ARRAY,Vt,on,Kt.width,Kt.height,Kt.depth),ot)if(rn.layerUpdates.size>0){const Wt=getByteLength(Kt.width,Kt.height,rn.format,rn.type);for(const sn of rn.layerUpdates){const yn=Kt.data.subarray(sn*Wt/Kt.data.BYTES_PER_ELEMENT,(sn+1)*Wt/Kt.data.BYTES_PER_ELEMENT);Y.texSubImage3D(re.TEXTURE_2D_ARRAY,0,0,0,sn,Kt.width,Kt.height,1,Yt,fn,yn)}rn.clearLayerUpdates()}else Y.texSubImage3D(re.TEXTURE_2D_ARRAY,0,0,0,0,Kt.width,Kt.height,Kt.depth,Yt,fn,Kt.data)}else Y.texImage3D(re.TEXTURE_2D_ARRAY,0,on,Kt.width,Kt.height,Kt.depth,0,Yt,fn,Kt.data);else if(rn.isData3DTexture)Nt?(ht&&Y.texStorage3D(re.TEXTURE_3D,Vt,on,Kt.width,Kt.height,Kt.depth),ot&&Y.texSubImage3D(re.TEXTURE_3D,0,0,0,0,Kt.width,Kt.height,Kt.depth,Yt,fn,Kt.data)):Y.texImage3D(re.TEXTURE_3D,0,on,Kt.width,Kt.height,Kt.depth,0,Yt,fn,Kt.data);else if(rn.isFramebufferTexture){if(ht)if(Nt)Y.texStorage2D(re.TEXTURE_2D,Vt,on,Kt.width,Kt.height);else{let Wt=Kt.width,sn=Kt.height;for(let yn=0;yn<Vt;yn++)Y.texImage2D(re.TEXTURE_2D,yn,on,Wt,sn,0,Yt,fn,null),Wt>>=1,sn>>=1}}else if(gn.length>0){if(Nt&&ht){const Wt=Br(gn[0]);Y.texStorage2D(re.TEXTURE_2D,Vt,on,Wt.width,Wt.height)}for(let Wt=0,sn=gn.length;Wt<sn;Wt++)an=gn[Wt],Nt?ot&&Y.texSubImage2D(re.TEXTURE_2D,Wt,0,0,Yt,fn,an):Y.texImage2D(re.TEXTURE_2D,Wt,on,Yt,fn,an);rn.generateMipmaps=!1}else if(Nt){if(ht){const Wt=Br(Kt);Y.texStorage2D(re.TEXTURE_2D,Vt,on,Wt.width,Wt.height)}ot&&Y.texSubImage2D(re.TEXTURE_2D,0,0,0,Yt,fn,Kt)}else Y.texImage2D(re.TEXTURE_2D,0,on,Yt,fn,Kt);Le(rn)&&xe(ai),Nr.__version=yi.version,rn.onUpdate&&rn.onUpdate(rn)}kt.__version=rn.version}function nn(kt,rn,Kn){if(rn.image.length!==6)return;const ai=Xt(kt,rn),Ui=rn.source;Y.bindTexture(re.TEXTURE_CUBE_MAP,kt.__webglTexture,re.TEXTURE0+Kn);const yi=ie.get(Ui);if(Ui.version!==yi.__version||ai===!0){Y.activeTexture(re.TEXTURE0+Kn);const Nr=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Ar=rn.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(rn.colorSpace),fr=rn.colorSpace===NoColorSpace||Nr===Ar?re.NONE:re.BROWSER_DEFAULT_WEBGL;re.pixelStorei(re.UNPACK_FLIP_Y_WEBGL,rn.flipY),re.pixelStorei(re.UNPACK_PREMULTIPLY_ALPHA_WEBGL,rn.premultiplyAlpha),re.pixelStorei(re.UNPACK_ALIGNMENT,rn.unpackAlignment),re.pixelStorei(re.UNPACK_COLORSPACE_CONVERSION_WEBGL,fr);const Bi=rn.isCompressedTexture||rn.image[0].isCompressedTexture,Kt=rn.image[0]&&rn.image[0].isDataTexture,Yt=[];for(let sn=0;sn<6;sn++)!Bi&&!Kt?Yt[sn]=Pe(rn.image[sn],!0,ne.maxCubemapSize):Yt[sn]=Kt?rn.image[sn].image:rn.image[sn],Yt[sn]=zr(rn,Yt[sn]);const fn=Yt[0],on=F.convert(rn.format,rn.colorSpace),an=F.convert(rn.type),gn=Fe(rn.internalFormat,on,an,rn.colorSpace),Nt=rn.isVideoTexture!==!0,ht=yi.__version===void 0||ai===!0,ot=Ui.dataReady;let Vt=Ne(rn,fn);Tt(re.TEXTURE_CUBE_MAP,rn);let Wt;if(Bi){Nt&&ht&&Y.texStorage2D(re.TEXTURE_CUBE_MAP,Vt,gn,fn.width,fn.height);for(let sn=0;sn<6;sn++){Wt=Yt[sn].mipmaps;for(let yn=0;yn<Wt.length;yn++){const ni=Wt[yn];rn.format!==RGBAFormat?on!==null?Nt?ot&&Y.compressedTexSubImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn,0,0,ni.width,ni.height,on,ni.data):Y.compressedTexImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn,gn,ni.width,ni.height,0,ni.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Nt?ot&&Y.texSubImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn,0,0,ni.width,ni.height,on,an,ni.data):Y.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn,gn,ni.width,ni.height,0,on,an,ni.data)}}}else{if(Wt=rn.mipmaps,Nt&&ht){Wt.length>0&&Vt++;const sn=Br(Yt[0]);Y.texStorage2D(re.TEXTURE_CUBE_MAP,Vt,gn,sn.width,sn.height)}for(let sn=0;sn<6;sn++)if(Kt){Nt?ot&&Y.texSubImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,0,0,0,Yt[sn].width,Yt[sn].height,on,an,Yt[sn].data):Y.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,0,gn,Yt[sn].width,Yt[sn].height,0,on,an,Yt[sn].data);for(let yn=0;yn<Wt.length;yn++){const ki=Wt[yn].image[sn].image;Nt?ot&&Y.texSubImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn+1,0,0,ki.width,ki.height,on,an,ki.data):Y.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn+1,gn,ki.width,ki.height,0,on,an,ki.data)}}else{Nt?ot&&Y.texSubImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,0,0,0,on,an,Yt[sn]):Y.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,0,gn,on,an,Yt[sn]);for(let yn=0;yn<Wt.length;yn++){const ni=Wt[yn];Nt?ot&&Y.texSubImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn+1,0,0,on,an,ni.image[sn]):Y.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+sn,yn+1,gn,on,an,ni.image[sn])}}}Le(rn)&&xe(re.TEXTURE_CUBE_MAP),yi.__version=Ui.version,rn.onUpdate&&rn.onUpdate(rn)}kt.__version=rn.version}function An(kt,rn,Kn,ai,Ui,yi){const Nr=F.convert(Kn.format,Kn.colorSpace),Ar=F.convert(Kn.type),fr=Fe(Kn.internalFormat,Nr,Ar,Kn.colorSpace);if(!ie.get(rn).__hasExternalTextures){const Kt=Math.max(1,rn.width>>yi),Yt=Math.max(1,rn.height>>yi);Ui===re.TEXTURE_3D||Ui===re.TEXTURE_2D_ARRAY?Y.texImage3D(Ui,yi,fr,Kt,Yt,rn.depth,0,Nr,Ar,null):Y.texImage2D(Ui,yi,fr,Kt,Yt,0,Nr,Ar,null)}Y.bindFramebuffer(re.FRAMEBUFFER,kt),Rr(rn)?pe.framebufferTexture2DMultisampleEXT(re.FRAMEBUFFER,ai,Ui,ie.get(Kn).__webglTexture,0,Ir(rn)):(Ui===re.TEXTURE_2D||Ui>=re.TEXTURE_CUBE_MAP_POSITIVE_X&&Ui<=re.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&re.framebufferTexture2D(re.FRAMEBUFFER,ai,Ui,ie.get(Kn).__webglTexture,yi),Y.bindFramebuffer(re.FRAMEBUFFER,null)}function Cn(kt,rn,Kn){if(re.bindRenderbuffer(re.RENDERBUFFER,kt),rn.depthBuffer){const ai=rn.depthTexture,Ui=ai&&ai.isDepthTexture?ai.type:null,yi=Oe(rn.stencilBuffer,Ui),Nr=rn.stencilBuffer?re.DEPTH_STENCIL_ATTACHMENT:re.DEPTH_ATTACHMENT,Ar=Ir(rn);Rr(rn)?pe.renderbufferStorageMultisampleEXT(re.RENDERBUFFER,Ar,yi,rn.width,rn.height):Kn?re.renderbufferStorageMultisample(re.RENDERBUFFER,Ar,yi,rn.width,rn.height):re.renderbufferStorage(re.RENDERBUFFER,yi,rn.width,rn.height),re.framebufferRenderbuffer(re.FRAMEBUFFER,Nr,re.RENDERBUFFER,kt)}else{const ai=rn.textures;for(let Ui=0;Ui<ai.length;Ui++){const yi=ai[Ui],Nr=F.convert(yi.format,yi.colorSpace),Ar=F.convert(yi.type),fr=Fe(yi.internalFormat,Nr,Ar,yi.colorSpace),Bi=Ir(rn);Kn&&Rr(rn)===!1?re.renderbufferStorageMultisample(re.RENDERBUFFER,Bi,fr,rn.width,rn.height):Rr(rn)?pe.renderbufferStorageMultisampleEXT(re.RENDERBUFFER,Bi,fr,rn.width,rn.height):re.renderbufferStorage(re.RENDERBUFFER,fr,rn.width,rn.height)}}re.bindRenderbuffer(re.RENDERBUFFER,null)}function Nn(kt,rn){if(rn&&rn.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(Y.bindFramebuffer(re.FRAMEBUFFER,kt),!(rn.depthTexture&&rn.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!ie.get(rn.depthTexture).__webglTexture||rn.depthTexture.image.width!==rn.width||rn.depthTexture.image.height!==rn.height)&&(rn.depthTexture.image.width=rn.width,rn.depthTexture.image.height=rn.height,rn.depthTexture.needsUpdate=!0),Mt(rn.depthTexture,0);const ai=ie.get(rn.depthTexture).__webglTexture,Ui=Ir(rn);if(rn.depthTexture.format===DepthFormat)Rr(rn)?pe.framebufferTexture2DMultisampleEXT(re.FRAMEBUFFER,re.DEPTH_ATTACHMENT,re.TEXTURE_2D,ai,0,Ui):re.framebufferTexture2D(re.FRAMEBUFFER,re.DEPTH_ATTACHMENT,re.TEXTURE_2D,ai,0);else if(rn.depthTexture.format===DepthStencilFormat)Rr(rn)?pe.framebufferTexture2DMultisampleEXT(re.FRAMEBUFFER,re.DEPTH_STENCIL_ATTACHMENT,re.TEXTURE_2D,ai,0,Ui):re.framebufferTexture2D(re.FRAMEBUFFER,re.DEPTH_STENCIL_ATTACHMENT,re.TEXTURE_2D,ai,0);else throw new Error("Unknown depthTexture format")}function Qn(kt){const rn=ie.get(kt),Kn=kt.isWebGLCubeRenderTarget===!0;if(rn.__boundDepthTexture!==kt.depthTexture){const ai=kt.depthTexture;if(rn.__depthDisposeCallback&&rn.__depthDisposeCallback(),ai){const Ui=()=>{delete rn.__boundDepthTexture,delete rn.__depthDisposeCallback,ai.removeEventListener("dispose",Ui)};ai.addEventListener("dispose",Ui),rn.__depthDisposeCallback=Ui}rn.__boundDepthTexture=ai}if(kt.depthTexture&&!rn.__autoAllocateDepthBuffer){if(Kn)throw new Error("target.depthTexture not supported in Cube render targets");Nn(rn.__webglFramebuffer,kt)}else if(Kn){rn.__webglDepthbuffer=[];for(let ai=0;ai<6;ai++)if(Y.bindFramebuffer(re.FRAMEBUFFER,rn.__webglFramebuffer[ai]),rn.__webglDepthbuffer[ai]===void 0)rn.__webglDepthbuffer[ai]=re.createRenderbuffer(),Cn(rn.__webglDepthbuffer[ai],kt,!1);else{const Ui=kt.stencilBuffer?re.DEPTH_STENCIL_ATTACHMENT:re.DEPTH_ATTACHMENT,yi=rn.__webglDepthbuffer[ai];re.bindRenderbuffer(re.RENDERBUFFER,yi),re.framebufferRenderbuffer(re.FRAMEBUFFER,Ui,re.RENDERBUFFER,yi)}}else if(Y.bindFramebuffer(re.FRAMEBUFFER,rn.__webglFramebuffer),rn.__webglDepthbuffer===void 0)rn.__webglDepthbuffer=re.createRenderbuffer(),Cn(rn.__webglDepthbuffer,kt,!1);else{const ai=kt.stencilBuffer?re.DEPTH_STENCIL_ATTACHMENT:re.DEPTH_ATTACHMENT,Ui=rn.__webglDepthbuffer;re.bindRenderbuffer(re.RENDERBUFFER,Ui),re.framebufferRenderbuffer(re.FRAMEBUFFER,ai,re.RENDERBUFFER,Ui)}Y.bindFramebuffer(re.FRAMEBUFFER,null)}function fi(kt,rn,Kn){const ai=ie.get(kt);rn!==void 0&&An(ai.__webglFramebuffer,kt,kt.texture,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,0),Kn!==void 0&&Qn(kt)}function hi(kt){const rn=kt.texture,Kn=ie.get(kt),ai=ie.get(rn);kt.addEventListener("dispose",Ve);const Ui=kt.textures,yi=kt.isWebGLCubeRenderTarget===!0,Nr=Ui.length>1;if(Nr||(ai.__webglTexture===void 0&&(ai.__webglTexture=re.createTexture()),ai.__version=rn.version,fe.memory.textures++),yi){Kn.__webglFramebuffer=[];for(let Ar=0;Ar<6;Ar++)if(rn.mipmaps&&rn.mipmaps.length>0){Kn.__webglFramebuffer[Ar]=[];for(let fr=0;fr<rn.mipmaps.length;fr++)Kn.__webglFramebuffer[Ar][fr]=re.createFramebuffer()}else Kn.__webglFramebuffer[Ar]=re.createFramebuffer()}else{if(rn.mipmaps&&rn.mipmaps.length>0){Kn.__webglFramebuffer=[];for(let Ar=0;Ar<rn.mipmaps.length;Ar++)Kn.__webglFramebuffer[Ar]=re.createFramebuffer()}else Kn.__webglFramebuffer=re.createFramebuffer();if(Nr)for(let Ar=0,fr=Ui.length;Ar<fr;Ar++){const Bi=ie.get(Ui[Ar]);Bi.__webglTexture===void 0&&(Bi.__webglTexture=re.createTexture(),fe.memory.textures++)}if(kt.samples>0&&Rr(kt)===!1){Kn.__webglMultisampledFramebuffer=re.createFramebuffer(),Kn.__webglColorRenderbuffer=[],Y.bindFramebuffer(re.FRAMEBUFFER,Kn.__webglMultisampledFramebuffer);for(let Ar=0;Ar<Ui.length;Ar++){const fr=Ui[Ar];Kn.__webglColorRenderbuffer[Ar]=re.createRenderbuffer(),re.bindRenderbuffer(re.RENDERBUFFER,Kn.__webglColorRenderbuffer[Ar]);const Bi=F.convert(fr.format,fr.colorSpace),Kt=F.convert(fr.type),Yt=Fe(fr.internalFormat,Bi,Kt,fr.colorSpace,kt.isXRRenderTarget===!0),fn=Ir(kt);re.renderbufferStorageMultisample(re.RENDERBUFFER,fn,Yt,kt.width,kt.height),re.framebufferRenderbuffer(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0+Ar,re.RENDERBUFFER,Kn.__webglColorRenderbuffer[Ar])}re.bindRenderbuffer(re.RENDERBUFFER,null),kt.depthBuffer&&(Kn.__webglDepthRenderbuffer=re.createRenderbuffer(),Cn(Kn.__webglDepthRenderbuffer,kt,!0)),Y.bindFramebuffer(re.FRAMEBUFFER,null)}}if(yi){Y.bindTexture(re.TEXTURE_CUBE_MAP,ai.__webglTexture),Tt(re.TEXTURE_CUBE_MAP,rn);for(let Ar=0;Ar<6;Ar++)if(rn.mipmaps&&rn.mipmaps.length>0)for(let fr=0;fr<rn.mipmaps.length;fr++)An(Kn.__webglFramebuffer[Ar][fr],kt,rn,re.COLOR_ATTACHMENT0,re.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,fr);else An(Kn.__webglFramebuffer[Ar],kt,rn,re.COLOR_ATTACHMENT0,re.TEXTURE_CUBE_MAP_POSITIVE_X+Ar,0);Le(rn)&&xe(re.TEXTURE_CUBE_MAP),Y.unbindTexture()}else if(Nr){for(let Ar=0,fr=Ui.length;Ar<fr;Ar++){const Bi=Ui[Ar],Kt=ie.get(Bi);Y.bindTexture(re.TEXTURE_2D,Kt.__webglTexture),Tt(re.TEXTURE_2D,Bi),An(Kn.__webglFramebuffer,kt,Bi,re.COLOR_ATTACHMENT0+Ar,re.TEXTURE_2D,0),Le(Bi)&&xe(re.TEXTURE_2D)}Y.unbindTexture()}else{let Ar=re.TEXTURE_2D;if((kt.isWebGL3DRenderTarget||kt.isWebGLArrayRenderTarget)&&(Ar=kt.isWebGL3DRenderTarget?re.TEXTURE_3D:re.TEXTURE_2D_ARRAY),Y.bindTexture(Ar,ai.__webglTexture),Tt(Ar,rn),rn.mipmaps&&rn.mipmaps.length>0)for(let fr=0;fr<rn.mipmaps.length;fr++)An(Kn.__webglFramebuffer[fr],kt,rn,re.COLOR_ATTACHMENT0,Ar,fr);else An(Kn.__webglFramebuffer,kt,rn,re.COLOR_ATTACHMENT0,Ar,0);Le(rn)&&xe(Ar),Y.unbindTexture()}kt.depthBuffer&&Qn(kt)}function Qi(kt){const rn=kt.textures;for(let Kn=0,ai=rn.length;Kn<ai;Kn++){const Ui=rn[Kn];if(Le(Ui)){const yi=kt.isWebGLCubeRenderTarget?re.TEXTURE_CUBE_MAP:re.TEXTURE_2D,Nr=ie.get(Ui).__webglTexture;Y.bindTexture(yi,Nr),xe(yi),Y.unbindTexture()}}}const Zi=[],Mn=[];function Vr(kt){if(kt.samples>0){if(Rr(kt)===!1){const rn=kt.textures,Kn=kt.width,ai=kt.height;let Ui=re.COLOR_BUFFER_BIT;const yi=kt.stencilBuffer?re.DEPTH_STENCIL_ATTACHMENT:re.DEPTH_ATTACHMENT,Nr=ie.get(kt),Ar=rn.length>1;if(Ar)for(let fr=0;fr<rn.length;fr++)Y.bindFramebuffer(re.FRAMEBUFFER,Nr.__webglMultisampledFramebuffer),re.framebufferRenderbuffer(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0+fr,re.RENDERBUFFER,null),Y.bindFramebuffer(re.FRAMEBUFFER,Nr.__webglFramebuffer),re.framebufferTexture2D(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0+fr,re.TEXTURE_2D,null,0);Y.bindFramebuffer(re.READ_FRAMEBUFFER,Nr.__webglMultisampledFramebuffer),Y.bindFramebuffer(re.DRAW_FRAMEBUFFER,Nr.__webglFramebuffer);for(let fr=0;fr<rn.length;fr++){if(kt.resolveDepthBuffer&&(kt.depthBuffer&&(Ui|=re.DEPTH_BUFFER_BIT),kt.stencilBuffer&&kt.resolveStencilBuffer&&(Ui|=re.STENCIL_BUFFER_BIT)),Ar){re.framebufferRenderbuffer(re.READ_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.RENDERBUFFER,Nr.__webglColorRenderbuffer[fr]);const Bi=ie.get(rn[fr]).__webglTexture;re.framebufferTexture2D(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,Bi,0)}re.blitFramebuffer(0,0,Kn,ai,0,0,Kn,ai,Ui,re.NEAREST),Me===!0&&(Zi.length=0,Mn.length=0,Zi.push(re.COLOR_ATTACHMENT0+fr),kt.depthBuffer&&kt.resolveDepthBuffer===!1&&(Zi.push(yi),Mn.push(yi),re.invalidateFramebuffer(re.DRAW_FRAMEBUFFER,Mn)),re.invalidateFramebuffer(re.READ_FRAMEBUFFER,Zi))}if(Y.bindFramebuffer(re.READ_FRAMEBUFFER,null),Y.bindFramebuffer(re.DRAW_FRAMEBUFFER,null),Ar)for(let fr=0;fr<rn.length;fr++){Y.bindFramebuffer(re.FRAMEBUFFER,Nr.__webglMultisampledFramebuffer),re.framebufferRenderbuffer(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0+fr,re.RENDERBUFFER,Nr.__webglColorRenderbuffer[fr]);const Bi=ie.get(rn[fr]).__webglTexture;Y.bindFramebuffer(re.FRAMEBUFFER,Nr.__webglFramebuffer),re.framebufferTexture2D(re.DRAW_FRAMEBUFFER,re.COLOR_ATTACHMENT0+fr,re.TEXTURE_2D,Bi,0)}Y.bindFramebuffer(re.DRAW_FRAMEBUFFER,Nr.__webglMultisampledFramebuffer)}else if(kt.depthBuffer&&kt.resolveDepthBuffer===!1&&Me){const rn=kt.stencilBuffer?re.DEPTH_STENCIL_ATTACHMENT:re.DEPTH_ATTACHMENT;re.invalidateFramebuffer(re.DRAW_FRAMEBUFFER,[rn])}}}function Ir(kt){return Math.min(ne.maxSamples,kt.samples)}function Rr(kt){const rn=ie.get(kt);return kt.samples>0&&U.has("WEBGL_multisampled_render_to_texture")===!0&&rn.__useRenderToTexture!==!1}function ir(kt){const rn=fe.render.frame;se.get(kt)!==rn&&(se.set(kt,rn),kt.update())}function zr(kt,rn){const Kn=kt.colorSpace,ai=kt.format,Ui=kt.type;return kt.isCompressedTexture===!0||kt.isVideoTexture===!0||Kn!==LinearSRGBColorSpace&&Kn!==NoColorSpace&&(ColorManagement.getTransfer(Kn)===SRGBTransfer?(ai!==RGBAFormat||Ui!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Kn)),rn}function Br(kt){return typeof HTMLImageElement<"u"&&kt instanceof HTMLImageElement?(ve.width=kt.naturalWidth||kt.width,ve.height=kt.naturalHeight||kt.height):typeof VideoFrame<"u"&&kt instanceof VideoFrame?(ve.width=kt.displayWidth,ve.height=kt.displayHeight):(ve.width=kt.width,ve.height=kt.height),ve}this.allocateTextureUnit=ft,this.resetTextureUnits=tt,this.setTexture2D=Mt,this.setTexture2DArray=Gt,this.setTexture3D=_t,this.setTextureCube=Bt,this.rebindTextures=fi,this.setupRenderTarget=hi,this.updateRenderTargetMipmap=Qi,this.updateMultisampleRenderTarget=Vr,this.setupDepthRenderbuffer=Qn,this.setupFrameBufferTexture=An,this.useMultisampledRTT=Rr}function WebGLUtils(re,U){function Y(ie,ne=NoColorSpace){let F;const fe=ColorManagement.getTransfer(ne);if(ie===UnsignedByteType)return re.UNSIGNED_BYTE;if(ie===UnsignedShort4444Type)return re.UNSIGNED_SHORT_4_4_4_4;if(ie===UnsignedShort5551Type)return re.UNSIGNED_SHORT_5_5_5_1;if(ie===UnsignedInt5999Type)return re.UNSIGNED_INT_5_9_9_9_REV;if(ie===ByteType)return re.BYTE;if(ie===ShortType)return re.SHORT;if(ie===UnsignedShortType)return re.UNSIGNED_SHORT;if(ie===IntType)return re.INT;if(ie===UnsignedIntType)return re.UNSIGNED_INT;if(ie===FloatType)return re.FLOAT;if(ie===HalfFloatType)return re.HALF_FLOAT;if(ie===AlphaFormat)return re.ALPHA;if(ie===RGBFormat)return re.RGB;if(ie===RGBAFormat)return re.RGBA;if(ie===LuminanceFormat)return re.LUMINANCE;if(ie===LuminanceAlphaFormat)return re.LUMINANCE_ALPHA;if(ie===DepthFormat)return re.DEPTH_COMPONENT;if(ie===DepthStencilFormat)return re.DEPTH_STENCIL;if(ie===RedFormat)return re.RED;if(ie===RedIntegerFormat)return re.RED_INTEGER;if(ie===RGFormat)return re.RG;if(ie===RGIntegerFormat)return re.RG_INTEGER;if(ie===RGBAIntegerFormat)return re.RGBA_INTEGER;if(ie===RGB_S3TC_DXT1_Format||ie===RGBA_S3TC_DXT1_Format||ie===RGBA_S3TC_DXT3_Format||ie===RGBA_S3TC_DXT5_Format)if(fe===SRGBTransfer)if(F=U.get("WEBGL_compressed_texture_s3tc_srgb"),F!==null){if(ie===RGB_S3TC_DXT1_Format)return F.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(ie===RGBA_S3TC_DXT1_Format)return F.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(ie===RGBA_S3TC_DXT3_Format)return F.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(ie===RGBA_S3TC_DXT5_Format)return F.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(F=U.get("WEBGL_compressed_texture_s3tc"),F!==null){if(ie===RGB_S3TC_DXT1_Format)return F.COMPRESSED_RGB_S3TC_DXT1_EXT;if(ie===RGBA_S3TC_DXT1_Format)return F.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(ie===RGBA_S3TC_DXT3_Format)return F.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(ie===RGBA_S3TC_DXT5_Format)return F.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(ie===RGB_PVRTC_4BPPV1_Format||ie===RGB_PVRTC_2BPPV1_Format||ie===RGBA_PVRTC_4BPPV1_Format||ie===RGBA_PVRTC_2BPPV1_Format)if(F=U.get("WEBGL_compressed_texture_pvrtc"),F!==null){if(ie===RGB_PVRTC_4BPPV1_Format)return F.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(ie===RGB_PVRTC_2BPPV1_Format)return F.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(ie===RGBA_PVRTC_4BPPV1_Format)return F.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(ie===RGBA_PVRTC_2BPPV1_Format)return F.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(ie===RGB_ETC1_Format||ie===RGB_ETC2_Format||ie===RGBA_ETC2_EAC_Format)if(F=U.get("WEBGL_compressed_texture_etc"),F!==null){if(ie===RGB_ETC1_Format||ie===RGB_ETC2_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ETC2:F.COMPRESSED_RGB8_ETC2;if(ie===RGBA_ETC2_EAC_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:F.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(ie===RGBA_ASTC_4x4_Format||ie===RGBA_ASTC_5x4_Format||ie===RGBA_ASTC_5x5_Format||ie===RGBA_ASTC_6x5_Format||ie===RGBA_ASTC_6x6_Format||ie===RGBA_ASTC_8x5_Format||ie===RGBA_ASTC_8x6_Format||ie===RGBA_ASTC_8x8_Format||ie===RGBA_ASTC_10x5_Format||ie===RGBA_ASTC_10x6_Format||ie===RGBA_ASTC_10x8_Format||ie===RGBA_ASTC_10x10_Format||ie===RGBA_ASTC_12x10_Format||ie===RGBA_ASTC_12x12_Format)if(F=U.get("WEBGL_compressed_texture_astc"),F!==null){if(ie===RGBA_ASTC_4x4_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:F.COMPRESSED_RGBA_ASTC_4x4_KHR;if(ie===RGBA_ASTC_5x4_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:F.COMPRESSED_RGBA_ASTC_5x4_KHR;if(ie===RGBA_ASTC_5x5_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:F.COMPRESSED_RGBA_ASTC_5x5_KHR;if(ie===RGBA_ASTC_6x5_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:F.COMPRESSED_RGBA_ASTC_6x5_KHR;if(ie===RGBA_ASTC_6x6_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:F.COMPRESSED_RGBA_ASTC_6x6_KHR;if(ie===RGBA_ASTC_8x5_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:F.COMPRESSED_RGBA_ASTC_8x5_KHR;if(ie===RGBA_ASTC_8x6_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:F.COMPRESSED_RGBA_ASTC_8x6_KHR;if(ie===RGBA_ASTC_8x8_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:F.COMPRESSED_RGBA_ASTC_8x8_KHR;if(ie===RGBA_ASTC_10x5_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:F.COMPRESSED_RGBA_ASTC_10x5_KHR;if(ie===RGBA_ASTC_10x6_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:F.COMPRESSED_RGBA_ASTC_10x6_KHR;if(ie===RGBA_ASTC_10x8_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:F.COMPRESSED_RGBA_ASTC_10x8_KHR;if(ie===RGBA_ASTC_10x10_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:F.COMPRESSED_RGBA_ASTC_10x10_KHR;if(ie===RGBA_ASTC_12x10_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:F.COMPRESSED_RGBA_ASTC_12x10_KHR;if(ie===RGBA_ASTC_12x12_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:F.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(ie===RGBA_BPTC_Format||ie===RGB_BPTC_SIGNED_Format||ie===RGB_BPTC_UNSIGNED_Format)if(F=U.get("EXT_texture_compression_bptc"),F!==null){if(ie===RGBA_BPTC_Format)return fe===SRGBTransfer?F.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:F.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(ie===RGB_BPTC_SIGNED_Format)return F.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(ie===RGB_BPTC_UNSIGNED_Format)return F.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(ie===RED_RGTC1_Format||ie===SIGNED_RED_RGTC1_Format||ie===RED_GREEN_RGTC2_Format||ie===SIGNED_RED_GREEN_RGTC2_Format)if(F=U.get("EXT_texture_compression_rgtc"),F!==null){if(ie===RGBA_BPTC_Format)return F.COMPRESSED_RED_RGTC1_EXT;if(ie===SIGNED_RED_RGTC1_Format)return F.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(ie===RED_GREEN_RGTC2_Format)return F.COMPRESSED_RED_GREEN_RGTC2_EXT;if(ie===SIGNED_RED_GREEN_RGTC2_Format)return F.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return ie===UnsignedInt248Type?re.UNSIGNED_INT_24_8:re[ie]!==void 0?re[ie]:null}return{convert:Y}}class ArrayCamera extends PerspectiveCamera{constructor(U=[]){super(),this.isArrayCamera=!0,this.cameras=U}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(U){return this._targetRay!==null&&this._targetRay.dispatchEvent(U),this._grip!==null&&this._grip.dispatchEvent(U),this._hand!==null&&this._hand.dispatchEvent(U),this}connect(U){if(U&&U.hand){const Y=this._hand;if(Y)for(const ie of U.hand.values())this._getHandJoint(Y,ie)}return this.dispatchEvent({type:"connected",data:U}),this}disconnect(U){return this.dispatchEvent({type:"disconnected",data:U}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(U,Y,ie){let ne=null,F=null,fe=null;const pe=this._targetRay,Me=this._grip,ve=this._hand;if(U&&Y.session.visibilityState!=="visible-blurred"){if(ve&&U.hand){fe=!0;for(const Pe of U.hand.values()){const Le=Y.getJointPose(Pe,ie),xe=this._getHandJoint(ve,Pe);Le!==null&&(xe.matrix.fromArray(Le.transform.matrix),xe.matrix.decompose(xe.position,xe.rotation,xe.scale),xe.matrixWorldNeedsUpdate=!0,xe.jointRadius=Le.radius),xe.visible=Le!==null}const se=ve.joints["index-finger-tip"],me=ve.joints["thumb-tip"],Te=se.position.distanceTo(me.position),Re=.02,be=.005;ve.inputState.pinching&&Te>Re+be?(ve.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:U.handedness,target:this})):!ve.inputState.pinching&&Te<=Re-be&&(ve.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:U.handedness,target:this}))}else Me!==null&&U.gripSpace&&(F=Y.getPose(U.gripSpace,ie),F!==null&&(Me.matrix.fromArray(F.transform.matrix),Me.matrix.decompose(Me.position,Me.rotation,Me.scale),Me.matrixWorldNeedsUpdate=!0,F.linearVelocity?(Me.hasLinearVelocity=!0,Me.linearVelocity.copy(F.linearVelocity)):Me.hasLinearVelocity=!1,F.angularVelocity?(Me.hasAngularVelocity=!0,Me.angularVelocity.copy(F.angularVelocity)):Me.hasAngularVelocity=!1));pe!==null&&(ne=Y.getPose(U.targetRaySpace,ie),ne===null&&F!==null&&(ne=F),ne!==null&&(pe.matrix.fromArray(ne.transform.matrix),pe.matrix.decompose(pe.position,pe.rotation,pe.scale),pe.matrixWorldNeedsUpdate=!0,ne.linearVelocity?(pe.hasLinearVelocity=!0,pe.linearVelocity.copy(ne.linearVelocity)):pe.hasLinearVelocity=!1,ne.angularVelocity?(pe.hasAngularVelocity=!0,pe.angularVelocity.copy(ne.angularVelocity)):pe.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return pe!==null&&(pe.visible=ne!==null),Me!==null&&(Me.visible=F!==null),ve!==null&&(ve.visible=fe!==null),this}_getHandJoint(U,Y){if(U.joints[Y.jointName]===void 0){const ie=new Group;ie.matrixAutoUpdate=!1,ie.visible=!1,U.joints[Y.jointName]=ie,U.add(ie)}return U.joints[Y.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(U,Y,ie){if(this.texture===null){const ne=new Texture$1,F=U.properties.get(ne);F.__webglTexture=Y.texture,(Y.depthNear!=ie.depthNear||Y.depthFar!=ie.depthFar)&&(this.depthNear=Y.depthNear,this.depthFar=Y.depthFar),this.texture=ne}}getMesh(U){if(this.texture!==null&&this.mesh===null){const Y=U.cameras[0].viewport,ie=new ShaderMaterial({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:Y.z},depthHeight:{value:Y.w}}});this.mesh=new Mesh(new PlaneGeometry(20,20),ie)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends EventDispatcher{constructor(U,Y){super();const ie=this;let ne=null,F=1,fe=null,pe="local-floor",Me=1,ve=null,se=null,me=null,Te=null,Re=null,be=null;const Pe=new WebXRDepthSensing,Le=Y.getContextAttributes();let xe=null,Fe=null;const Oe=[],Ne=[],ke=new Vector2;let Ve=null;const Xe=new PerspectiveCamera;Xe.layers.enable(1),Xe.viewport=new Vector4;const $e=new PerspectiveCamera;$e.layers.enable(2),$e.viewport=new Vector4;const st=[Xe,$e],ze=new ArrayCamera;ze.layers.enable(1),ze.layers.enable(2);let tt=null,ft=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(nn){let An=Oe[nn];return An===void 0&&(An=new WebXRController,Oe[nn]=An),An.getTargetRaySpace()},this.getControllerGrip=function(nn){let An=Oe[nn];return An===void 0&&(An=new WebXRController,Oe[nn]=An),An.getGripSpace()},this.getHand=function(nn){let An=Oe[nn];return An===void 0&&(An=new WebXRController,Oe[nn]=An),An.getHandSpace()};function Rt(nn){const An=Ne.indexOf(nn.inputSource);if(An===-1)return;const Cn=Oe[An];Cn!==void 0&&(Cn.update(nn.inputSource,nn.frame,ve||fe),Cn.dispatchEvent({type:nn.type,data:nn.inputSource}))}function Mt(){ne.removeEventListener("select",Rt),ne.removeEventListener("selectstart",Rt),ne.removeEventListener("selectend",Rt),ne.removeEventListener("squeeze",Rt),ne.removeEventListener("squeezestart",Rt),ne.removeEventListener("squeezeend",Rt),ne.removeEventListener("end",Mt),ne.removeEventListener("inputsourceschange",Gt);for(let nn=0;nn<Oe.length;nn++){const An=Ne[nn];An!==null&&(Ne[nn]=null,Oe[nn].disconnect(An))}tt=null,ft=null,Pe.reset(),U.setRenderTarget(xe),Re=null,Te=null,me=null,ne=null,Fe=null,hn.stop(),ie.isPresenting=!1,U.setPixelRatio(Ve),U.setSize(ke.width,ke.height,!1),ie.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(nn){F=nn,ie.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(nn){pe=nn,ie.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return ve||fe},this.setReferenceSpace=function(nn){ve=nn},this.getBaseLayer=function(){return Te!==null?Te:Re},this.getBinding=function(){return me},this.getFrame=function(){return be},this.getSession=function(){return ne},this.setSession=async function(nn){if(ne=nn,ne!==null){if(xe=U.getRenderTarget(),ne.addEventListener("select",Rt),ne.addEventListener("selectstart",Rt),ne.addEventListener("selectend",Rt),ne.addEventListener("squeeze",Rt),ne.addEventListener("squeezestart",Rt),ne.addEventListener("squeezeend",Rt),ne.addEventListener("end",Mt),ne.addEventListener("inputsourceschange",Gt),Le.xrCompatible!==!0&&await Y.makeXRCompatible(),Ve=U.getPixelRatio(),U.getSize(ke),ne.renderState.layers===void 0){const An={antialias:Le.antialias,alpha:!0,depth:Le.depth,stencil:Le.stencil,framebufferScaleFactor:F};Re=new XRWebGLLayer(ne,Y,An),ne.updateRenderState({baseLayer:Re}),U.setPixelRatio(1),U.setSize(Re.framebufferWidth,Re.framebufferHeight,!1),Fe=new WebGLRenderTarget(Re.framebufferWidth,Re.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:U.outputColorSpace,stencilBuffer:Le.stencil})}else{let An=null,Cn=null,Nn=null;Le.depth&&(Nn=Le.stencil?Y.DEPTH24_STENCIL8:Y.DEPTH_COMPONENT24,An=Le.stencil?DepthStencilFormat:DepthFormat,Cn=Le.stencil?UnsignedInt248Type:UnsignedIntType);const Qn={colorFormat:Y.RGBA8,depthFormat:Nn,scaleFactor:F};me=new XRWebGLBinding(ne,Y),Te=me.createProjectionLayer(Qn),ne.updateRenderState({layers:[Te]}),U.setPixelRatio(1),U.setSize(Te.textureWidth,Te.textureHeight,!1),Fe=new WebGLRenderTarget(Te.textureWidth,Te.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(Te.textureWidth,Te.textureHeight,Cn,void 0,void 0,void 0,void 0,void 0,void 0,An),stencilBuffer:Le.stencil,colorSpace:U.outputColorSpace,samples:Le.antialias?4:0,resolveDepthBuffer:Te.ignoreDepthValues===!1})}Fe.isXRRenderTarget=!0,this.setFoveation(Me),ve=null,fe=await ne.requestReferenceSpace(pe),hn.setContext(ne),hn.start(),ie.isPresenting=!0,ie.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(ne!==null)return ne.environmentBlendMode},this.getDepthTexture=function(){return Pe.getDepthTexture()};function Gt(nn){for(let An=0;An<nn.removed.length;An++){const Cn=nn.removed[An],Nn=Ne.indexOf(Cn);Nn>=0&&(Ne[Nn]=null,Oe[Nn].disconnect(Cn))}for(let An=0;An<nn.added.length;An++){const Cn=nn.added[An];let Nn=Ne.indexOf(Cn);if(Nn===-1){for(let fi=0;fi<Oe.length;fi++)if(fi>=Ne.length){Ne.push(Cn),Nn=fi;break}else if(Ne[fi]===null){Ne[fi]=Cn,Nn=fi;break}if(Nn===-1)break}const Qn=Oe[Nn];Qn&&Qn.connect(Cn)}}const _t=new Vector3,Bt=new Vector3;function dt(nn,An,Cn){_t.setFromMatrixPosition(An.matrixWorld),Bt.setFromMatrixPosition(Cn.matrixWorld);const Nn=_t.distanceTo(Bt),Qn=An.projectionMatrix.elements,fi=Cn.projectionMatrix.elements,hi=Qn[14]/(Qn[10]-1),Qi=Qn[14]/(Qn[10]+1),Zi=(Qn[9]+1)/Qn[5],Mn=(Qn[9]-1)/Qn[5],Vr=(Qn[8]-1)/Qn[0],Ir=(fi[8]+1)/fi[0],Rr=hi*Vr,ir=hi*Ir,zr=Nn/(-Vr+Ir),Br=zr*-Vr;if(An.matrixWorld.decompose(nn.position,nn.quaternion,nn.scale),nn.translateX(Br),nn.translateZ(zr),nn.matrixWorld.compose(nn.position,nn.quaternion,nn.scale),nn.matrixWorldInverse.copy(nn.matrixWorld).invert(),Qn[10]===-1)nn.projectionMatrix.copy(An.projectionMatrix),nn.projectionMatrixInverse.copy(An.projectionMatrixInverse);else{const kt=hi+zr,rn=Qi+zr,Kn=Rr-Br,ai=ir+(Nn-Br),Ui=Zi*Qi/rn*kt,yi=Mn*Qi/rn*kt;nn.projectionMatrix.makePerspective(Kn,ai,Ui,yi,kt,rn),nn.projectionMatrixInverse.copy(nn.projectionMatrix).invert()}}function ut(nn,An){An===null?nn.matrixWorld.copy(nn.matrix):nn.matrixWorld.multiplyMatrices(An.matrixWorld,nn.matrix),nn.matrixWorldInverse.copy(nn.matrixWorld).invert()}this.updateCamera=function(nn){if(ne===null)return;let An=nn.near,Cn=nn.far;Pe.texture!==null&&(Pe.depthNear>0&&(An=Pe.depthNear),Pe.depthFar>0&&(Cn=Pe.depthFar)),ze.near=$e.near=Xe.near=An,ze.far=$e.far=Xe.far=Cn,(tt!==ze.near||ft!==ze.far)&&(ne.updateRenderState({depthNear:ze.near,depthFar:ze.far}),tt=ze.near,ft=ze.far);const Nn=nn.parent,Qn=ze.cameras;ut(ze,Nn);for(let fi=0;fi<Qn.length;fi++)ut(Qn[fi],Nn);Qn.length===2?dt(ze,Xe,$e):ze.projectionMatrix.copy(Xe.projectionMatrix),Ut(nn,ze,Nn)};function Ut(nn,An,Cn){Cn===null?nn.matrix.copy(An.matrixWorld):(nn.matrix.copy(Cn.matrixWorld),nn.matrix.invert(),nn.matrix.multiply(An.matrixWorld)),nn.matrix.decompose(nn.position,nn.quaternion,nn.scale),nn.updateMatrixWorld(!0),nn.projectionMatrix.copy(An.projectionMatrix),nn.projectionMatrixInverse.copy(An.projectionMatrixInverse),nn.isPerspectiveCamera&&(nn.fov=RAD2DEG*2*Math.atan(1/nn.projectionMatrix.elements[5]),nn.zoom=1)}this.getCamera=function(){return ze},this.getFoveation=function(){if(!(Te===null&&Re===null))return Me},this.setFoveation=function(nn){Me=nn,Te!==null&&(Te.fixedFoveation=nn),Re!==null&&Re.fixedFoveation!==void 0&&(Re.fixedFoveation=nn)},this.hasDepthSensing=function(){return Pe.texture!==null},this.getDepthSensingMesh=function(){return Pe.getMesh(ze)};let Tt=null;function Xt(nn,An){if(se=An.getViewerPose(ve||fe),be=An,se!==null){const Cn=se.views;Re!==null&&(U.setRenderTargetFramebuffer(Fe,Re.framebuffer),U.setRenderTarget(Fe));let Nn=!1;Cn.length!==ze.cameras.length&&(ze.cameras.length=0,Nn=!0);for(let fi=0;fi<Cn.length;fi++){const hi=Cn[fi];let Qi=null;if(Re!==null)Qi=Re.getViewport(hi);else{const Mn=me.getViewSubImage(Te,hi);Qi=Mn.viewport,fi===0&&(U.setRenderTargetTextures(Fe,Mn.colorTexture,Te.ignoreDepthValues?void 0:Mn.depthStencilTexture),U.setRenderTarget(Fe))}let Zi=st[fi];Zi===void 0&&(Zi=new PerspectiveCamera,Zi.layers.enable(fi),Zi.viewport=new Vector4,st[fi]=Zi),Zi.matrix.fromArray(hi.transform.matrix),Zi.matrix.decompose(Zi.position,Zi.quaternion,Zi.scale),Zi.projectionMatrix.fromArray(hi.projectionMatrix),Zi.projectionMatrixInverse.copy(Zi.projectionMatrix).invert(),Zi.viewport.set(Qi.x,Qi.y,Qi.width,Qi.height),fi===0&&(ze.matrix.copy(Zi.matrix),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale)),Nn===!0&&ze.cameras.push(Zi)}const Qn=ne.enabledFeatures;if(Qn&&Qn.includes("depth-sensing")){const fi=me.getDepthInformation(Cn[0]);fi&&fi.isValid&&fi.texture&&Pe.init(U,fi,ne.renderState)}}for(let Cn=0;Cn<Oe.length;Cn++){const Nn=Ne[Cn],Qn=Oe[Cn];Nn!==null&&Qn!==void 0&&Qn.update(Nn,An,ve||fe)}Tt&&Tt(nn,An),An.detectedPlanes&&ie.dispatchEvent({type:"planesdetected",data:An}),be=null}const hn=new WebGLAnimation;hn.setAnimationLoop(Xt),this.setAnimationLoop=function(nn){Tt=nn},this.dispose=function(){}}}const _e1=new Euler,_m1=new Matrix4;function WebGLMaterials(re,U){function Y(Le,xe){Le.matrixAutoUpdate===!0&&Le.updateMatrix(),xe.value.copy(Le.matrix)}function ie(Le,xe){xe.color.getRGB(Le.fogColor.value,getUnlitUniformColorSpace(re)),xe.isFog?(Le.fogNear.value=xe.near,Le.fogFar.value=xe.far):xe.isFogExp2&&(Le.fogDensity.value=xe.density)}function ne(Le,xe,Fe,Oe,Ne){xe.isMeshBasicMaterial||xe.isMeshLambertMaterial?F(Le,xe):xe.isMeshToonMaterial?(F(Le,xe),me(Le,xe)):xe.isMeshPhongMaterial?(F(Le,xe),se(Le,xe)):xe.isMeshStandardMaterial?(F(Le,xe),Te(Le,xe),xe.isMeshPhysicalMaterial&&Re(Le,xe,Ne)):xe.isMeshMatcapMaterial?(F(Le,xe),be(Le,xe)):xe.isMeshDepthMaterial?F(Le,xe):xe.isMeshDistanceMaterial?(F(Le,xe),Pe(Le,xe)):xe.isMeshNormalMaterial?F(Le,xe):xe.isLineBasicMaterial?(fe(Le,xe),xe.isLineDashedMaterial&&pe(Le,xe)):xe.isPointsMaterial?Me(Le,xe,Fe,Oe):xe.isSpriteMaterial?ve(Le,xe):xe.isShadowMaterial?(Le.color.value.copy(xe.color),Le.opacity.value=xe.opacity):xe.isShaderMaterial&&(xe.uniformsNeedUpdate=!1)}function F(Le,xe){Le.opacity.value=xe.opacity,xe.color&&Le.diffuse.value.copy(xe.color),xe.emissive&&Le.emissive.value.copy(xe.emissive).multiplyScalar(xe.emissiveIntensity),xe.map&&(Le.map.value=xe.map,Y(xe.map,Le.mapTransform)),xe.alphaMap&&(Le.alphaMap.value=xe.alphaMap,Y(xe.alphaMap,Le.alphaMapTransform)),xe.bumpMap&&(Le.bumpMap.value=xe.bumpMap,Y(xe.bumpMap,Le.bumpMapTransform),Le.bumpScale.value=xe.bumpScale,xe.side===BackSide&&(Le.bumpScale.value*=-1)),xe.normalMap&&(Le.normalMap.value=xe.normalMap,Y(xe.normalMap,Le.normalMapTransform),Le.normalScale.value.copy(xe.normalScale),xe.side===BackSide&&Le.normalScale.value.negate()),xe.displacementMap&&(Le.displacementMap.value=xe.displacementMap,Y(xe.displacementMap,Le.displacementMapTransform),Le.displacementScale.value=xe.displacementScale,Le.displacementBias.value=xe.displacementBias),xe.emissiveMap&&(Le.emissiveMap.value=xe.emissiveMap,Y(xe.emissiveMap,Le.emissiveMapTransform)),xe.specularMap&&(Le.specularMap.value=xe.specularMap,Y(xe.specularMap,Le.specularMapTransform)),xe.alphaTest>0&&(Le.alphaTest.value=xe.alphaTest);const Fe=U.get(xe),Oe=Fe.envMap,Ne=Fe.envMapRotation;Oe&&(Le.envMap.value=Oe,_e1.copy(Ne),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,Oe.isCubeTexture&&Oe.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),Le.envMapRotation.value.setFromMatrix4(_m1.makeRotationFromEuler(_e1)),Le.flipEnvMap.value=Oe.isCubeTexture&&Oe.isRenderTargetTexture===!1?-1:1,Le.reflectivity.value=xe.reflectivity,Le.ior.value=xe.ior,Le.refractionRatio.value=xe.refractionRatio),xe.lightMap&&(Le.lightMap.value=xe.lightMap,Le.lightMapIntensity.value=xe.lightMapIntensity,Y(xe.lightMap,Le.lightMapTransform)),xe.aoMap&&(Le.aoMap.value=xe.aoMap,Le.aoMapIntensity.value=xe.aoMapIntensity,Y(xe.aoMap,Le.aoMapTransform))}function fe(Le,xe){Le.diffuse.value.copy(xe.color),Le.opacity.value=xe.opacity,xe.map&&(Le.map.value=xe.map,Y(xe.map,Le.mapTransform))}function pe(Le,xe){Le.dashSize.value=xe.dashSize,Le.totalSize.value=xe.dashSize+xe.gapSize,Le.scale.value=xe.scale}function Me(Le,xe,Fe,Oe){Le.diffuse.value.copy(xe.color),Le.opacity.value=xe.opacity,Le.size.value=xe.size*Fe,Le.scale.value=Oe*.5,xe.map&&(Le.map.value=xe.map,Y(xe.map,Le.uvTransform)),xe.alphaMap&&(Le.alphaMap.value=xe.alphaMap,Y(xe.alphaMap,Le.alphaMapTransform)),xe.alphaTest>0&&(Le.alphaTest.value=xe.alphaTest)}function ve(Le,xe){Le.diffuse.value.copy(xe.color),Le.opacity.value=xe.opacity,Le.rotation.value=xe.rotation,xe.map&&(Le.map.value=xe.map,Y(xe.map,Le.mapTransform)),xe.alphaMap&&(Le.alphaMap.value=xe.alphaMap,Y(xe.alphaMap,Le.alphaMapTransform)),xe.alphaTest>0&&(Le.alphaTest.value=xe.alphaTest)}function se(Le,xe){Le.specular.value.copy(xe.specular),Le.shininess.value=Math.max(xe.shininess,1e-4)}function me(Le,xe){xe.gradientMap&&(Le.gradientMap.value=xe.gradientMap)}function Te(Le,xe){Le.metalness.value=xe.metalness,xe.metalnessMap&&(Le.metalnessMap.value=xe.metalnessMap,Y(xe.metalnessMap,Le.metalnessMapTransform)),Le.roughness.value=xe.roughness,xe.roughnessMap&&(Le.roughnessMap.value=xe.roughnessMap,Y(xe.roughnessMap,Le.roughnessMapTransform)),xe.envMap&&(Le.envMapIntensity.value=xe.envMapIntensity)}function Re(Le,xe,Fe){Le.ior.value=xe.ior,xe.sheen>0&&(Le.sheenColor.value.copy(xe.sheenColor).multiplyScalar(xe.sheen),Le.sheenRoughness.value=xe.sheenRoughness,xe.sheenColorMap&&(Le.sheenColorMap.value=xe.sheenColorMap,Y(xe.sheenColorMap,Le.sheenColorMapTransform)),xe.sheenRoughnessMap&&(Le.sheenRoughnessMap.value=xe.sheenRoughnessMap,Y(xe.sheenRoughnessMap,Le.sheenRoughnessMapTransform))),xe.clearcoat>0&&(Le.clearcoat.value=xe.clearcoat,Le.clearcoatRoughness.value=xe.clearcoatRoughness,xe.clearcoatMap&&(Le.clearcoatMap.value=xe.clearcoatMap,Y(xe.clearcoatMap,Le.clearcoatMapTransform)),xe.clearcoatRoughnessMap&&(Le.clearcoatRoughnessMap.value=xe.clearcoatRoughnessMap,Y(xe.clearcoatRoughnessMap,Le.clearcoatRoughnessMapTransform)),xe.clearcoatNormalMap&&(Le.clearcoatNormalMap.value=xe.clearcoatNormalMap,Y(xe.clearcoatNormalMap,Le.clearcoatNormalMapTransform),Le.clearcoatNormalScale.value.copy(xe.clearcoatNormalScale),xe.side===BackSide&&Le.clearcoatNormalScale.value.negate())),xe.dispersion>0&&(Le.dispersion.value=xe.dispersion),xe.iridescence>0&&(Le.iridescence.value=xe.iridescence,Le.iridescenceIOR.value=xe.iridescenceIOR,Le.iridescenceThicknessMinimum.value=xe.iridescenceThicknessRange[0],Le.iridescenceThicknessMaximum.value=xe.iridescenceThicknessRange[1],xe.iridescenceMap&&(Le.iridescenceMap.value=xe.iridescenceMap,Y(xe.iridescenceMap,Le.iridescenceMapTransform)),xe.iridescenceThicknessMap&&(Le.iridescenceThicknessMap.value=xe.iridescenceThicknessMap,Y(xe.iridescenceThicknessMap,Le.iridescenceThicknessMapTransform))),xe.transmission>0&&(Le.transmission.value=xe.transmission,Le.transmissionSamplerMap.value=Fe.texture,Le.transmissionSamplerSize.value.set(Fe.width,Fe.height),xe.transmissionMap&&(Le.transmissionMap.value=xe.transmissionMap,Y(xe.transmissionMap,Le.transmissionMapTransform)),Le.thickness.value=xe.thickness,xe.thicknessMap&&(Le.thicknessMap.value=xe.thicknessMap,Y(xe.thicknessMap,Le.thicknessMapTransform)),Le.attenuationDistance.value=xe.attenuationDistance,Le.attenuationColor.value.copy(xe.attenuationColor)),xe.anisotropy>0&&(Le.anisotropyVector.value.set(xe.anisotropy*Math.cos(xe.anisotropyRotation),xe.anisotropy*Math.sin(xe.anisotropyRotation)),xe.anisotropyMap&&(Le.anisotropyMap.value=xe.anisotropyMap,Y(xe.anisotropyMap,Le.anisotropyMapTransform))),Le.specularIntensity.value=xe.specularIntensity,Le.specularColor.value.copy(xe.specularColor),xe.specularColorMap&&(Le.specularColorMap.value=xe.specularColorMap,Y(xe.specularColorMap,Le.specularColorMapTransform)),xe.specularIntensityMap&&(Le.specularIntensityMap.value=xe.specularIntensityMap,Y(xe.specularIntensityMap,Le.specularIntensityMapTransform))}function be(Le,xe){xe.matcap&&(Le.matcap.value=xe.matcap)}function Pe(Le,xe){const Fe=U.get(xe).light;Le.referencePosition.value.setFromMatrixPosition(Fe.matrixWorld),Le.nearDistance.value=Fe.shadow.camera.near,Le.farDistance.value=Fe.shadow.camera.far}return{refreshFogUniforms:ie,refreshMaterialUniforms:ne}}function WebGLUniformsGroups(re,U,Y,ie){let ne={},F={},fe=[];const pe=re.getParameter(re.MAX_UNIFORM_BUFFER_BINDINGS);function Me(Fe,Oe){const Ne=Oe.program;ie.uniformBlockBinding(Fe,Ne)}function ve(Fe,Oe){let Ne=ne[Fe.id];Ne===void 0&&(be(Fe),Ne=se(Fe),ne[Fe.id]=Ne,Fe.addEventListener("dispose",Le));const ke=Oe.program;ie.updateUBOMapping(Fe,ke);const Ve=U.render.frame;F[Fe.id]!==Ve&&(Te(Fe),F[Fe.id]=Ve)}function se(Fe){const Oe=me();Fe.__bindingPointIndex=Oe;const Ne=re.createBuffer(),ke=Fe.__size,Ve=Fe.usage;return re.bindBuffer(re.UNIFORM_BUFFER,Ne),re.bufferData(re.UNIFORM_BUFFER,ke,Ve),re.bindBuffer(re.UNIFORM_BUFFER,null),re.bindBufferBase(re.UNIFORM_BUFFER,Oe,Ne),Ne}function me(){for(let Fe=0;Fe<pe;Fe++)if(fe.indexOf(Fe)===-1)return fe.push(Fe),Fe;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function Te(Fe){const Oe=ne[Fe.id],Ne=Fe.uniforms,ke=Fe.__cache;re.bindBuffer(re.UNIFORM_BUFFER,Oe);for(let Ve=0,Xe=Ne.length;Ve<Xe;Ve++){const $e=Array.isArray(Ne[Ve])?Ne[Ve]:[Ne[Ve]];for(let st=0,ze=$e.length;st<ze;st++){const tt=$e[st];if(Re(tt,Ve,st,ke)===!0){const ft=tt.__offset,Rt=Array.isArray(tt.value)?tt.value:[tt.value];let Mt=0;for(let Gt=0;Gt<Rt.length;Gt++){const _t=Rt[Gt],Bt=Pe(_t);typeof _t=="number"||typeof _t=="boolean"?(tt.__data[0]=_t,re.bufferSubData(re.UNIFORM_BUFFER,ft+Mt,tt.__data)):_t.isMatrix3?(tt.__data[0]=_t.elements[0],tt.__data[1]=_t.elements[1],tt.__data[2]=_t.elements[2],tt.__data[3]=0,tt.__data[4]=_t.elements[3],tt.__data[5]=_t.elements[4],tt.__data[6]=_t.elements[5],tt.__data[7]=0,tt.__data[8]=_t.elements[6],tt.__data[9]=_t.elements[7],tt.__data[10]=_t.elements[8],tt.__data[11]=0):(_t.toArray(tt.__data,Mt),Mt+=Bt.storage/Float32Array.BYTES_PER_ELEMENT)}re.bufferSubData(re.UNIFORM_BUFFER,ft,tt.__data)}}}re.bindBuffer(re.UNIFORM_BUFFER,null)}function Re(Fe,Oe,Ne,ke){const Ve=Fe.value,Xe=Oe+"_"+Ne;if(ke[Xe]===void 0)return typeof Ve=="number"||typeof Ve=="boolean"?ke[Xe]=Ve:ke[Xe]=Ve.clone(),!0;{const $e=ke[Xe];if(typeof Ve=="number"||typeof Ve=="boolean"){if($e!==Ve)return ke[Xe]=Ve,!0}else if($e.equals(Ve)===!1)return $e.copy(Ve),!0}return!1}function be(Fe){const Oe=Fe.uniforms;let Ne=0;const ke=16;for(let Xe=0,$e=Oe.length;Xe<$e;Xe++){const st=Array.isArray(Oe[Xe])?Oe[Xe]:[Oe[Xe]];for(let ze=0,tt=st.length;ze<tt;ze++){const ft=st[ze],Rt=Array.isArray(ft.value)?ft.value:[ft.value];for(let Mt=0,Gt=Rt.length;Mt<Gt;Mt++){const _t=Rt[Mt],Bt=Pe(_t),dt=Ne%ke,ut=dt%Bt.boundary,Ut=dt+ut;Ne+=ut,Ut!==0&&ke-Ut<Bt.storage&&(Ne+=ke-Ut),ft.__data=new Float32Array(Bt.storage/Float32Array.BYTES_PER_ELEMENT),ft.__offset=Ne,Ne+=Bt.storage}}}const Ve=Ne%ke;return Ve>0&&(Ne+=ke-Ve),Fe.__size=Ne,Fe.__cache={},this}function Pe(Fe){const Oe={boundary:0,storage:0};return typeof Fe=="number"||typeof Fe=="boolean"?(Oe.boundary=4,Oe.storage=4):Fe.isVector2?(Oe.boundary=8,Oe.storage=8):Fe.isVector3||Fe.isColor?(Oe.boundary=16,Oe.storage=12):Fe.isVector4?(Oe.boundary=16,Oe.storage=16):Fe.isMatrix3?(Oe.boundary=48,Oe.storage=48):Fe.isMatrix4?(Oe.boundary=64,Oe.storage=64):Fe.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Fe),Oe}function Le(Fe){const Oe=Fe.target;Oe.removeEventListener("dispose",Le);const Ne=fe.indexOf(Oe.__bindingPointIndex);fe.splice(Ne,1),re.deleteBuffer(ne[Oe.id]),delete ne[Oe.id],delete F[Oe.id]}function xe(){for(const Fe in ne)re.deleteBuffer(ne[Fe]);fe=[],ne={},F={}}return{bind:Me,update:ve,dispose:xe}}class WebGLRenderer{constructor(U={}){const{canvas:Y=createCanvasElement(),context:ie=null,depth:ne=!0,stencil:F=!1,alpha:fe=!1,antialias:pe=!1,premultipliedAlpha:Me=!0,preserveDrawingBuffer:ve=!1,powerPreference:se="default",failIfMajorPerformanceCaveat:me=!1}=U;this.isWebGLRenderer=!0;let Te;if(ie!==null){if(typeof WebGLRenderingContext<"u"&&ie instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");Te=ie.getContextAttributes().alpha}else Te=fe;const Re=new Uint32Array(4),be=new Int32Array(4);let Pe=null,Le=null;const xe=[],Fe=[];this.domElement=Y,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const Oe=this;let Ne=!1,ke=0,Ve=0,Xe=null,$e=-1,st=null;const ze=new Vector4,tt=new Vector4;let ft=null;const Rt=new Color(0);let Mt=0,Gt=Y.width,_t=Y.height,Bt=1,dt=null,ut=null;const Ut=new Vector4(0,0,Gt,_t),Tt=new Vector4(0,0,Gt,_t);let Xt=!1;const hn=new Frustum;let nn=!1,An=!1;const Cn=new Matrix4,Nn=new Matrix4,Qn=new Vector3,fi=new Vector4,hi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Qi=!1;function Zi(){return Xe===null?Bt:1}let Mn=ie;function Vr(dn,qn){return Y.getContext(dn,qn)}try{const dn={alpha:!0,depth:ne,stencil:F,antialias:pe,premultipliedAlpha:Me,preserveDrawingBuffer:ve,powerPreference:se,failIfMajorPerformanceCaveat:me};if("setAttribute"in Y&&Y.setAttribute("data-engine",`three.js r${REVISION}`),Y.addEventListener("webglcontextlost",sn,!1),Y.addEventListener("webglcontextrestored",yn,!1),Y.addEventListener("webglcontextcreationerror",ni,!1),Mn===null){const qn="webgl2";if(Mn=Vr(qn,dn),Mn===null)throw Vr(qn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(dn){throw console.error("THREE.WebGLRenderer: "+dn.message),dn}let Ir,Rr,ir,zr,Br,kt,rn,Kn,ai,Ui,yi,Nr,Ar,fr,Bi,Kt,Yt,fn,on,an,gn,Nt,ht,ot;function Vt(){Ir=new WebGLExtensions(Mn),Ir.init(),Nt=new WebGLUtils(Mn,Ir),Rr=new WebGLCapabilities(Mn,Ir,U,Nt),ir=new WebGLState(Mn),Rr.reverseDepthBuffer&&ir.buffers.depth.setReversed(!0),zr=new WebGLInfo(Mn),Br=new WebGLProperties,kt=new WebGLTextures(Mn,Ir,ir,Br,Rr,Nt,zr),rn=new WebGLCubeMaps(Oe),Kn=new WebGLCubeUVMaps(Oe),ai=new WebGLAttributes(Mn),ht=new WebGLBindingStates(Mn,ai),Ui=new WebGLGeometries(Mn,ai,zr,ht),yi=new WebGLObjects(Mn,Ui,ai,zr),on=new WebGLMorphtargets(Mn,Rr,kt),Kt=new WebGLClipping(Br),Nr=new WebGLPrograms(Oe,rn,Kn,Ir,Rr,ht,Kt),Ar=new WebGLMaterials(Oe,Br),fr=new WebGLRenderLists,Bi=new WebGLRenderStates(Ir),fn=new WebGLBackground(Oe,rn,Kn,ir,yi,Te,Me),Yt=new WebGLShadowMap(Oe,yi,Rr),ot=new WebGLUniformsGroups(Mn,zr,Rr,ir),an=new WebGLBufferRenderer(Mn,Ir,zr),gn=new WebGLIndexedBufferRenderer(Mn,Ir,zr),zr.programs=Nr.programs,Oe.capabilities=Rr,Oe.extensions=Ir,Oe.properties=Br,Oe.renderLists=fr,Oe.shadowMap=Yt,Oe.state=ir,Oe.info=zr}Vt();const Wt=new WebXRManager(Oe,Mn);this.xr=Wt,this.getContext=function(){return Mn},this.getContextAttributes=function(){return Mn.getContextAttributes()},this.forceContextLoss=function(){const dn=Ir.get("WEBGL_lose_context");dn&&dn.loseContext()},this.forceContextRestore=function(){const dn=Ir.get("WEBGL_lose_context");dn&&dn.restoreContext()},this.getPixelRatio=function(){return Bt},this.setPixelRatio=function(dn){dn!==void 0&&(Bt=dn,this.setSize(Gt,_t,!1))},this.getSize=function(dn){return dn.set(Gt,_t)},this.setSize=function(dn,qn,di=!0){if(Wt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Gt=dn,_t=qn,Y.width=Math.floor(dn*Bt),Y.height=Math.floor(qn*Bt),di===!0&&(Y.style.width=dn+"px",Y.style.height=qn+"px"),this.setViewport(0,0,dn,qn)},this.getDrawingBufferSize=function(dn){return dn.set(Gt*Bt,_t*Bt).floor()},this.setDrawingBufferSize=function(dn,qn,di){Gt=dn,_t=qn,Bt=di,Y.width=Math.floor(dn*di),Y.height=Math.floor(qn*di),this.setViewport(0,0,dn,qn)},this.getCurrentViewport=function(dn){return dn.copy(ze)},this.getViewport=function(dn){return dn.copy(Ut)},this.setViewport=function(dn,qn,di,$t){dn.isVector4?Ut.set(dn.x,dn.y,dn.z,dn.w):Ut.set(dn,qn,di,$t),ir.viewport(ze.copy(Ut).multiplyScalar(Bt).round())},this.getScissor=function(dn){return dn.copy(Tt)},this.setScissor=function(dn,qn,di,$t){dn.isVector4?Tt.set(dn.x,dn.y,dn.z,dn.w):Tt.set(dn,qn,di,$t),ir.scissor(tt.copy(Tt).multiplyScalar(Bt).round())},this.getScissorTest=function(){return Xt},this.setScissorTest=function(dn){ir.setScissorTest(Xt=dn)},this.setOpaqueSort=function(dn){dt=dn},this.setTransparentSort=function(dn){ut=dn},this.getClearColor=function(dn){return dn.copy(fn.getClearColor())},this.setClearColor=function(){fn.setClearColor.apply(fn,arguments)},this.getClearAlpha=function(){return fn.getClearAlpha()},this.setClearAlpha=function(){fn.setClearAlpha.apply(fn,arguments)},this.clear=function(dn=!0,qn=!0,di=!0){let $t=0;if(dn){let Jt=!1;if(Xe!==null){const xn=Xe.texture.format;Jt=xn===RGBAIntegerFormat||xn===RGIntegerFormat||xn===RedIntegerFormat}if(Jt){const xn=Xe.texture.type,Vn=xn===UnsignedByteType||xn===UnsignedIntType||xn===UnsignedShortType||xn===UnsignedInt248Type||xn===UnsignedShort4444Type||xn===UnsignedShort5551Type,Dn=fn.getClearColor(),jn=fn.getClearAlpha(),gi=Dn.r,Wi=Dn.g,Li=Dn.b;Vn?(Re[0]=gi,Re[1]=Wi,Re[2]=Li,Re[3]=jn,Mn.clearBufferuiv(Mn.COLOR,0,Re)):(be[0]=gi,be[1]=Wi,be[2]=Li,be[3]=jn,Mn.clearBufferiv(Mn.COLOR,0,be))}else $t|=Mn.COLOR_BUFFER_BIT}qn&&($t|=Mn.DEPTH_BUFFER_BIT,Mn.clearDepth(this.capabilities.reverseDepthBuffer?0:1)),di&&($t|=Mn.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Mn.clear($t)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){Y.removeEventListener("webglcontextlost",sn,!1),Y.removeEventListener("webglcontextrestored",yn,!1),Y.removeEventListener("webglcontextcreationerror",ni,!1),fr.dispose(),Bi.dispose(),Br.dispose(),rn.dispose(),Kn.dispose(),yi.dispose(),ht.dispose(),ot.dispose(),Nr.dispose(),Wt.dispose(),Wt.removeEventListener("sessionstart",Ai),Wt.removeEventListener("sessionend",js),Qs.stop()};function sn(dn){dn.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ne=!0}function yn(){console.log("THREE.WebGLRenderer: Context Restored."),Ne=!1;const dn=zr.autoReset,qn=Yt.enabled,di=Yt.autoUpdate,$t=Yt.needsUpdate,Jt=Yt.type;Vt(),zr.autoReset=dn,Yt.enabled=qn,Yt.autoUpdate=di,Yt.needsUpdate=$t,Yt.type=Jt}function ni(dn){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",dn.statusMessage)}function ki(dn){const qn=dn.target;qn.removeEventListener("dispose",ki),Hi(qn)}function Hi(dn){ji(dn),Br.remove(dn)}function ji(dn){const qn=Br.get(dn).programs;qn!==void 0&&(qn.forEach(function(di){Nr.releaseProgram(di)}),dn.isShaderMaterial&&Nr.releaseShaderCache(dn))}this.renderBufferDirect=function(dn,qn,di,$t,Jt,xn){qn===null&&(qn=hi);const Vn=Jt.isMesh&&Jt.matrixWorld.determinant()<0,Dn=Ts(dn,qn,di,$t,Jt);ir.setMaterial($t,Vn);let jn=di.index,gi=1;if($t.wireframe===!0){if(jn=Ui.getWireframeAttribute(di),jn===void 0)return;gi=2}const Wi=di.drawRange,Li=di.attributes.position;let vi=Wi.start*gi,yr=(Wi.start+Wi.count)*gi;xn!==null&&(vi=Math.max(vi,xn.start*gi),yr=Math.min(yr,(xn.start+xn.count)*gi)),jn!==null?(vi=Math.max(vi,0),yr=Math.min(yr,jn.count)):Li!=null&&(vi=Math.max(vi,0),yr=Math.min(yr,Li.count));const Sr=yr-vi;if(Sr<0||Sr===1/0)return;ht.setup(Jt,$t,Dn,di,jn);let Ur,hs=an;if(jn!==null&&(Ur=ai.get(jn),hs=gn,hs.setIndex(Ur)),Jt.isMesh)$t.wireframe===!0?(ir.setLineWidth($t.wireframeLinewidth*Zi()),hs.setMode(Mn.LINES)):hs.setMode(Mn.TRIANGLES);else if(Jt.isLine){let er=$t.linewidth;er===void 0&&(er=1),ir.setLineWidth(er*Zi()),Jt.isLineSegments?hs.setMode(Mn.LINES):Jt.isLineLoop?hs.setMode(Mn.LINE_LOOP):hs.setMode(Mn.LINE_STRIP)}else Jt.isPoints?hs.setMode(Mn.POINTS):Jt.isSprite&&hs.setMode(Mn.TRIANGLES);if(Jt.isBatchedMesh)if(Jt._multiDrawInstances!==null)hs.renderMultiDrawInstances(Jt._multiDrawStarts,Jt._multiDrawCounts,Jt._multiDrawCount,Jt._multiDrawInstances);else if(Ir.get("WEBGL_multi_draw"))hs.renderMultiDraw(Jt._multiDrawStarts,Jt._multiDrawCounts,Jt._multiDrawCount);else{const er=Jt._multiDrawStarts,as=Jt._multiDrawCounts,Yr=Jt._multiDrawCount,eo=jn?ai.get(jn).bytesPerElement:1,wo=Br.get($t).currentProgram.getUniforms();for(let Er=0;Er<Yr;Er++)wo.setValue(Mn,"_gl_DrawID",Er),hs.render(er[Er]/eo,as[Er])}else if(Jt.isInstancedMesh)hs.renderInstances(vi,Sr,Jt.count);else if(di.isInstancedBufferGeometry){const er=di._maxInstanceCount!==void 0?di._maxInstanceCount:1/0,as=Math.min(di.instanceCount,er);hs.renderInstances(vi,Sr,as)}else hs.render(vi,Sr)};function Xi(dn,qn,di){dn.transparent===!0&&dn.side===DoubleSide&&dn.forceSinglePass===!1?(dn.side=BackSide,dn.needsUpdate=!0,l0(dn,qn,di),dn.side=FrontSide,dn.needsUpdate=!0,l0(dn,qn,di),dn.side=DoubleSide):l0(dn,qn,di)}this.compile=function(dn,qn,di=null){di===null&&(di=dn),Le=Bi.get(di),Le.init(qn),Fe.push(Le),di.traverseVisible(function(Jt){Jt.isLight&&Jt.layers.test(qn.layers)&&(Le.pushLight(Jt),Jt.castShadow&&Le.pushShadow(Jt))}),dn!==di&&dn.traverseVisible(function(Jt){Jt.isLight&&Jt.layers.test(qn.layers)&&(Le.pushLight(Jt),Jt.castShadow&&Le.pushShadow(Jt))}),Le.setupLights();const $t=new Set;return dn.traverse(function(Jt){if(!(Jt.isMesh||Jt.isPoints||Jt.isLine||Jt.isSprite))return;const xn=Jt.material;if(xn)if(Array.isArray(xn))for(let Vn=0;Vn<xn.length;Vn++){const Dn=xn[Vn];Xi(Dn,di,Jt),$t.add(Dn)}else Xi(xn,di,Jt),$t.add(xn)}),Fe.pop(),Le=null,$t},this.compileAsync=function(dn,qn,di=null){const $t=this.compile(dn,qn,di);return new Promise(Jt=>{function xn(){if($t.forEach(function(Vn){Br.get(Vn).currentProgram.isReady()&&$t.delete(Vn)}),$t.size===0){Jt(dn);return}setTimeout(xn,10)}Ir.get("KHR_parallel_shader_compile")!==null?xn():setTimeout(xn,10)})};let Ws=null;function Jr(dn){Ws&&Ws(dn)}function Ai(){Qs.stop()}function js(){Qs.start()}const Qs=new WebGLAnimation;Qs.setAnimationLoop(Jr),typeof self<"u"&&Qs.setContext(self),this.setAnimationLoop=function(dn){Ws=dn,Wt.setAnimationLoop(dn),dn===null?Qs.stop():Qs.start()},Wt.addEventListener("sessionstart",Ai),Wt.addEventListener("sessionend",js),this.render=function(dn,qn){if(qn!==void 0&&qn.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Ne===!0)return;if(dn.matrixWorldAutoUpdate===!0&&dn.updateMatrixWorld(),qn.parent===null&&qn.matrixWorldAutoUpdate===!0&&qn.updateMatrixWorld(),Wt.enabled===!0&&Wt.isPresenting===!0&&(Wt.cameraAutoUpdate===!0&&Wt.updateCamera(qn),qn=Wt.getCamera()),dn.isScene===!0&&dn.onBeforeRender(Oe,dn,qn,Xe),Le=Bi.get(dn,Fe.length),Le.init(qn),Fe.push(Le),Nn.multiplyMatrices(qn.projectionMatrix,qn.matrixWorldInverse),hn.setFromProjectionMatrix(Nn),An=this.localClippingEnabled,nn=Kt.init(this.clippingPlanes,An),Pe=fr.get(dn,xe.length),Pe.init(),xe.push(Pe),Wt.enabled===!0&&Wt.isPresenting===!0){const xn=Oe.xr.getDepthSensingMesh();xn!==null&&Vo(xn,qn,-1/0,Oe.sortObjects)}Vo(dn,qn,0,Oe.sortObjects),Pe.finish(),Oe.sortObjects===!0&&Pe.sort(dt,ut),Qi=Wt.enabled===!1||Wt.isPresenting===!1||Wt.hasDepthSensing()===!1,Qi&&fn.addToRenderList(Pe,dn),this.info.render.frame++,nn===!0&&Kt.beginShadows();const di=Le.state.shadowsArray;Yt.render(di,dn,qn),nn===!0&&Kt.endShadows(),this.info.autoReset===!0&&this.info.reset();const $t=Pe.opaque,Jt=Pe.transmissive;if(Le.setupLights(),qn.isArrayCamera){const xn=qn.cameras;if(Jt.length>0)for(let Vn=0,Dn=xn.length;Vn<Dn;Vn++){const jn=xn[Vn];Ia($t,Jt,dn,jn)}Qi&&fn.render(dn);for(let Vn=0,Dn=xn.length;Vn<Dn;Vn++){const jn=xn[Vn];Mo(Pe,dn,jn,jn.viewport)}}else Jt.length>0&&Ia($t,Jt,dn,qn),Qi&&fn.render(dn),Mo(Pe,dn,qn);Xe!==null&&(kt.updateMultisampleRenderTarget(Xe),kt.updateRenderTargetMipmap(Xe)),dn.isScene===!0&&dn.onAfterRender(Oe,dn,qn),ht.resetDefaultState(),$e=-1,st=null,Fe.pop(),Fe.length>0?(Le=Fe[Fe.length-1],nn===!0&&Kt.setGlobalState(Oe.clippingPlanes,Le.state.camera)):Le=null,xe.pop(),xe.length>0?Pe=xe[xe.length-1]:Pe=null};function Vo(dn,qn,di,$t){if(dn.visible===!1)return;if(dn.layers.test(qn.layers)){if(dn.isGroup)di=dn.renderOrder;else if(dn.isLOD)dn.autoUpdate===!0&&dn.update(qn);else if(dn.isLight)Le.pushLight(dn),dn.castShadow&&Le.pushShadow(dn);else if(dn.isSprite){if(!dn.frustumCulled||hn.intersectsSprite(dn)){$t&&fi.setFromMatrixPosition(dn.matrixWorld).applyMatrix4(Nn);const Vn=yi.update(dn),Dn=dn.material;Dn.visible&&Pe.push(dn,Vn,Dn,di,fi.z,null)}}else if((dn.isMesh||dn.isLine||dn.isPoints)&&(!dn.frustumCulled||hn.intersectsObject(dn))){const Vn=yi.update(dn),Dn=dn.material;if($t&&(dn.boundingSphere!==void 0?(dn.boundingSphere===null&&dn.computeBoundingSphere(),fi.copy(dn.boundingSphere.center)):(Vn.boundingSphere===null&&Vn.computeBoundingSphere(),fi.copy(Vn.boundingSphere.center)),fi.applyMatrix4(dn.matrixWorld).applyMatrix4(Nn)),Array.isArray(Dn)){const jn=Vn.groups;for(let gi=0,Wi=jn.length;gi<Wi;gi++){const Li=jn[gi],vi=Dn[Li.materialIndex];vi&&vi.visible&&Pe.push(dn,Vn,vi,di,fi.z,Li)}}else Dn.visible&&Pe.push(dn,Vn,Dn,di,fi.z,null)}}const xn=dn.children;for(let Vn=0,Dn=xn.length;Vn<Dn;Vn++)Vo(xn[Vn],qn,di,$t)}function Mo(dn,qn,di,$t){const Jt=dn.opaque,xn=dn.transmissive,Vn=dn.transparent;Le.setupLightsView(di),nn===!0&&Kt.setGlobalState(Oe.clippingPlanes,di),$t&&ir.viewport(ze.copy($t)),Jt.length>0&&Do(Jt,qn,di),xn.length>0&&Do(xn,qn,di),Vn.length>0&&Do(Vn,qn,di),ir.buffers.depth.setTest(!0),ir.buffers.depth.setMask(!0),ir.buffers.color.setMask(!0),ir.setPolygonOffset(!1)}function Ia(dn,qn,di,$t){if((di.isScene===!0?di.overrideMaterial:null)!==null)return;Le.state.transmissionRenderTarget[$t.id]===void 0&&(Le.state.transmissionRenderTarget[$t.id]=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:Ir.has("EXT_color_buffer_half_float")||Ir.has("EXT_color_buffer_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:4,stencilBuffer:F,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ColorManagement.workingColorSpace}));const xn=Le.state.transmissionRenderTarget[$t.id],Vn=$t.viewport||ze;xn.setSize(Vn.z,Vn.w);const Dn=Oe.getRenderTarget();Oe.setRenderTarget(xn),Oe.getClearColor(Rt),Mt=Oe.getClearAlpha(),Mt<1&&Oe.setClearColor(16777215,.5),Oe.clear(),Qi&&fn.render(di);const jn=Oe.toneMapping;Oe.toneMapping=NoToneMapping;const gi=$t.viewport;if($t.viewport!==void 0&&($t.viewport=void 0),Le.setupLightsView($t),nn===!0&&Kt.setGlobalState(Oe.clippingPlanes,$t),Do(dn,di,$t),kt.updateMultisampleRenderTarget(xn),kt.updateRenderTargetMipmap(xn),Ir.has("WEBGL_multisampled_render_to_texture")===!1){let Wi=!1;for(let Li=0,vi=qn.length;Li<vi;Li++){const yr=qn[Li],Sr=yr.object,Ur=yr.geometry,hs=yr.material,er=yr.group;if(hs.side===DoubleSide&&Sr.layers.test($t.layers)){const as=hs.side;hs.side=BackSide,hs.needsUpdate=!0,Ca(Sr,di,$t,Ur,hs,er),hs.side=as,hs.needsUpdate=!0,Wi=!0}}Wi===!0&&(kt.updateMultisampleRenderTarget(xn),kt.updateRenderTargetMipmap(xn))}Oe.setRenderTarget(Dn),Oe.setClearColor(Rt,Mt),gi!==void 0&&($t.viewport=gi),Oe.toneMapping=jn}function Do(dn,qn,di){const $t=qn.isScene===!0?qn.overrideMaterial:null;for(let Jt=0,xn=dn.length;Jt<xn;Jt++){const Vn=dn[Jt],Dn=Vn.object,jn=Vn.geometry,gi=$t===null?Vn.material:$t,Wi=Vn.group;Dn.layers.test(di.layers)&&Ca(Dn,qn,di,jn,gi,Wi)}}function Ca(dn,qn,di,$t,Jt,xn){dn.onBeforeRender(Oe,qn,di,$t,Jt,xn),dn.modelViewMatrix.multiplyMatrices(di.matrixWorldInverse,dn.matrixWorld),dn.normalMatrix.getNormalMatrix(dn.modelViewMatrix),Jt.onBeforeRender(Oe,qn,di,$t,dn,xn),Jt.transparent===!0&&Jt.side===DoubleSide&&Jt.forceSinglePass===!1?(Jt.side=BackSide,Jt.needsUpdate=!0,Oe.renderBufferDirect(di,qn,$t,Jt,dn,xn),Jt.side=FrontSide,Jt.needsUpdate=!0,Oe.renderBufferDirect(di,qn,$t,Jt,dn,xn),Jt.side=DoubleSide):Oe.renderBufferDirect(di,qn,$t,Jt,dn,xn),dn.onAfterRender(Oe,qn,di,$t,Jt,xn)}function l0(dn,qn,di){qn.isScene!==!0&&(qn=hi);const $t=Br.get(dn),Jt=Le.state.lights,xn=Le.state.shadowsArray,Vn=Jt.state.version,Dn=Nr.getParameters(dn,Jt.state,xn,qn,di),jn=Nr.getProgramCacheKey(Dn);let gi=$t.programs;$t.environment=dn.isMeshStandardMaterial?qn.environment:null,$t.fog=qn.fog,$t.envMap=(dn.isMeshStandardMaterial?Kn:rn).get(dn.envMap||$t.environment),$t.envMapRotation=$t.environment!==null&&dn.envMap===null?qn.environmentRotation:dn.envMapRotation,gi===void 0&&(dn.addEventListener("dispose",ki),gi=new Map,$t.programs=gi);let Wi=gi.get(jn);if(Wi!==void 0){if($t.currentProgram===Wi&&$t.lightsStateVersion===Vn)return ko(dn,Dn),Wi}else Dn.uniforms=Nr.getUniforms(dn),dn.onBeforeCompile(Dn,Oe),Wi=Nr.acquireProgram(Dn,jn),gi.set(jn,Wi),$t.uniforms=Dn.uniforms;const Li=$t.uniforms;return(!dn.isShaderMaterial&&!dn.isRawShaderMaterial||dn.clipping===!0)&&(Li.clippingPlanes=Kt.uniform),ko(dn,Dn),$t.needsLights=q0(dn),$t.lightsStateVersion=Vn,$t.needsLights&&(Li.ambientLightColor.value=Jt.state.ambient,Li.lightProbe.value=Jt.state.probe,Li.directionalLights.value=Jt.state.directional,Li.directionalLightShadows.value=Jt.state.directionalShadow,Li.spotLights.value=Jt.state.spot,Li.spotLightShadows.value=Jt.state.spotShadow,Li.rectAreaLights.value=Jt.state.rectArea,Li.ltc_1.value=Jt.state.rectAreaLTC1,Li.ltc_2.value=Jt.state.rectAreaLTC2,Li.pointLights.value=Jt.state.point,Li.pointLightShadows.value=Jt.state.pointShadow,Li.hemisphereLights.value=Jt.state.hemi,Li.directionalShadowMap.value=Jt.state.directionalShadowMap,Li.directionalShadowMatrix.value=Jt.state.directionalShadowMatrix,Li.spotShadowMap.value=Jt.state.spotShadowMap,Li.spotLightMatrix.value=Jt.state.spotLightMatrix,Li.spotLightMap.value=Jt.state.spotLightMap,Li.pointShadowMap.value=Jt.state.pointShadowMap,Li.pointShadowMatrix.value=Jt.state.pointShadowMatrix),$t.currentProgram=Wi,$t.uniformsList=null,Wi}function Ra(dn){if(dn.uniformsList===null){const qn=dn.currentProgram.getUniforms();dn.uniformsList=WebGLUniforms.seqWithValue(qn.seq,dn.uniforms)}return dn.uniformsList}function ko(dn,qn){const di=Br.get(dn);di.outputColorSpace=qn.outputColorSpace,di.batching=qn.batching,di.batchingColor=qn.batchingColor,di.instancing=qn.instancing,di.instancingColor=qn.instancingColor,di.instancingMorph=qn.instancingMorph,di.skinning=qn.skinning,di.morphTargets=qn.morphTargets,di.morphNormals=qn.morphNormals,di.morphColors=qn.morphColors,di.morphTargetsCount=qn.morphTargetsCount,di.numClippingPlanes=qn.numClippingPlanes,di.numIntersection=qn.numClipIntersection,di.vertexAlphas=qn.vertexAlphas,di.vertexTangents=qn.vertexTangents,di.toneMapping=qn.toneMapping}function Ts(dn,qn,di,$t,Jt){qn.isScene!==!0&&(qn=hi),kt.resetTextureUnits();const xn=qn.fog,Vn=$t.isMeshStandardMaterial?qn.environment:null,Dn=Xe===null?Oe.outputColorSpace:Xe.isXRRenderTarget===!0?Xe.texture.colorSpace:LinearSRGBColorSpace,jn=($t.isMeshStandardMaterial?Kn:rn).get($t.envMap||Vn),gi=$t.vertexColors===!0&&!!di.attributes.color&&di.attributes.color.itemSize===4,Wi=!!di.attributes.tangent&&(!!$t.normalMap||$t.anisotropy>0),Li=!!di.morphAttributes.position,vi=!!di.morphAttributes.normal,yr=!!di.morphAttributes.color;let Sr=NoToneMapping;$t.toneMapped&&(Xe===null||Xe.isXRRenderTarget===!0)&&(Sr=Oe.toneMapping);const Ur=di.morphAttributes.position||di.morphAttributes.normal||di.morphAttributes.color,hs=Ur!==void 0?Ur.length:0,er=Br.get($t),as=Le.state.lights;if(nn===!0&&(An===!0||dn!==st)){const Ot=dn===st&&$t.id===$e;Kt.setState($t,dn,Ot)}let Yr=!1;$t.version===er.__version?(er.needsLights&&er.lightsStateVersion!==as.state.version||er.outputColorSpace!==Dn||Jt.isBatchedMesh&&er.batching===!1||!Jt.isBatchedMesh&&er.batching===!0||Jt.isBatchedMesh&&er.batchingColor===!0&&Jt.colorTexture===null||Jt.isBatchedMesh&&er.batchingColor===!1&&Jt.colorTexture!==null||Jt.isInstancedMesh&&er.instancing===!1||!Jt.isInstancedMesh&&er.instancing===!0||Jt.isSkinnedMesh&&er.skinning===!1||!Jt.isSkinnedMesh&&er.skinning===!0||Jt.isInstancedMesh&&er.instancingColor===!0&&Jt.instanceColor===null||Jt.isInstancedMesh&&er.instancingColor===!1&&Jt.instanceColor!==null||Jt.isInstancedMesh&&er.instancingMorph===!0&&Jt.morphTexture===null||Jt.isInstancedMesh&&er.instancingMorph===!1&&Jt.morphTexture!==null||er.envMap!==jn||$t.fog===!0&&er.fog!==xn||er.numClippingPlanes!==void 0&&(er.numClippingPlanes!==Kt.numPlanes||er.numIntersection!==Kt.numIntersection)||er.vertexAlphas!==gi||er.vertexTangents!==Wi||er.morphTargets!==Li||er.morphNormals!==vi||er.morphColors!==yr||er.toneMapping!==Sr||er.morphTargetsCount!==hs)&&(Yr=!0):(Yr=!0,er.__version=$t.version);let eo=er.currentProgram;Yr===!0&&(eo=l0($t,qn,Jt));let wo=!1,Er=!1,Ss=!1;const bs=eo.getUniforms(),Ns=er.uniforms;if(ir.useProgram(eo.program)&&(wo=!0,Er=!0,Ss=!0),$t.id!==$e&&($e=$t.id,Er=!0),wo||st!==dn){Rr.reverseDepthBuffer?(Cn.copy(dn.projectionMatrix),toNormalizedProjectionMatrix(Cn),toReversedProjectionMatrix(Cn),bs.setValue(Mn,"projectionMatrix",Cn)):bs.setValue(Mn,"projectionMatrix",dn.projectionMatrix),bs.setValue(Mn,"viewMatrix",dn.matrixWorldInverse);const Ot=bs.map.cameraPosition;Ot!==void 0&&Ot.setValue(Mn,Qn.setFromMatrixPosition(dn.matrixWorld)),Rr.logarithmicDepthBuffer&&bs.setValue(Mn,"logDepthBufFC",2/(Math.log(dn.far+1)/Math.LN2)),($t.isMeshPhongMaterial||$t.isMeshToonMaterial||$t.isMeshLambertMaterial||$t.isMeshBasicMaterial||$t.isMeshStandardMaterial||$t.isShaderMaterial)&&bs.setValue(Mn,"isOrthographic",dn.isOrthographicCamera===!0),st!==dn&&(st=dn,Er=!0,Ss=!0)}if(Jt.isSkinnedMesh){bs.setOptional(Mn,Jt,"bindMatrix"),bs.setOptional(Mn,Jt,"bindMatrixInverse");const Ot=Jt.skeleton;Ot&&(Ot.boneTexture===null&&Ot.computeBoneTexture(),bs.setValue(Mn,"boneTexture",Ot.boneTexture,kt))}Jt.isBatchedMesh&&(bs.setOptional(Mn,Jt,"batchingTexture"),bs.setValue(Mn,"batchingTexture",Jt._matricesTexture,kt),bs.setOptional(Mn,Jt,"batchingIdTexture"),bs.setValue(Mn,"batchingIdTexture",Jt._indirectTexture,kt),bs.setOptional(Mn,Jt,"batchingColorTexture"),Jt._colorsTexture!==null&&bs.setValue(Mn,"batchingColorTexture",Jt._colorsTexture,kt));const It=di.morphAttributes;if((It.position!==void 0||It.normal!==void 0||It.color!==void 0)&&on.update(Jt,di,eo),(Er||er.receiveShadow!==Jt.receiveShadow)&&(er.receiveShadow=Jt.receiveShadow,bs.setValue(Mn,"receiveShadow",Jt.receiveShadow)),$t.isMeshGouraudMaterial&&$t.envMap!==null&&(Ns.envMap.value=jn,Ns.flipEnvMap.value=jn.isCubeTexture&&jn.isRenderTargetTexture===!1?-1:1),$t.isMeshStandardMaterial&&$t.envMap===null&&qn.environment!==null&&(Ns.envMapIntensity.value=qn.environmentIntensity),Er&&(bs.setValue(Mn,"toneMappingExposure",Oe.toneMappingExposure),er.needsLights&&ta(Ns,Ss),xn&&$t.fog===!0&&Ar.refreshFogUniforms(Ns,xn),Ar.refreshMaterialUniforms(Ns,$t,Bt,_t,Le.state.transmissionRenderTarget[dn.id]),WebGLUniforms.upload(Mn,Ra(er),Ns,kt)),$t.isShaderMaterial&&$t.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Mn,Ra(er),Ns,kt),$t.uniformsNeedUpdate=!1),$t.isSpriteMaterial&&bs.setValue(Mn,"center",Jt.center),bs.setValue(Mn,"modelViewMatrix",Jt.modelViewMatrix),bs.setValue(Mn,"normalMatrix",Jt.normalMatrix),bs.setValue(Mn,"modelMatrix",Jt.matrixWorld),$t.isShaderMaterial||$t.isRawShaderMaterial){const Ot=$t.uniformsGroups;for(let zt=0,jt=Ot.length;zt<jt;zt++){const mn=Ot[zt];ot.update(mn,eo),ot.bind(mn,eo)}}return eo}function ta(dn,qn){dn.ambientLightColor.needsUpdate=qn,dn.lightProbe.needsUpdate=qn,dn.directionalLights.needsUpdate=qn,dn.directionalLightShadows.needsUpdate=qn,dn.pointLights.needsUpdate=qn,dn.pointLightShadows.needsUpdate=qn,dn.spotLights.needsUpdate=qn,dn.spotLightShadows.needsUpdate=qn,dn.rectAreaLights.needsUpdate=qn,dn.hemisphereLights.needsUpdate=qn}function q0(dn){return dn.isMeshLambertMaterial||dn.isMeshToonMaterial||dn.isMeshPhongMaterial||dn.isMeshStandardMaterial||dn.isShadowMaterial||dn.isShaderMaterial&&dn.lights===!0}this.getActiveCubeFace=function(){return ke},this.getActiveMipmapLevel=function(){return Ve},this.getRenderTarget=function(){return Xe},this.setRenderTargetTextures=function(dn,qn,di){Br.get(dn.texture).__webglTexture=qn,Br.get(dn.depthTexture).__webglTexture=di;const $t=Br.get(dn);$t.__hasExternalTextures=!0,$t.__autoAllocateDepthBuffer=di===void 0,$t.__autoAllocateDepthBuffer||Ir.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$t.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(dn,qn){const di=Br.get(dn);di.__webglFramebuffer=qn,di.__useDefaultFramebuffer=qn===void 0},this.setRenderTarget=function(dn,qn=0,di=0){Xe=dn,ke=qn,Ve=di;let $t=!0,Jt=null,xn=!1,Vn=!1;if(dn){const jn=Br.get(dn);if(jn.__useDefaultFramebuffer!==void 0)ir.bindFramebuffer(Mn.FRAMEBUFFER,null),$t=!1;else if(jn.__webglFramebuffer===void 0)kt.setupRenderTarget(dn);else if(jn.__hasExternalTextures)kt.rebindTextures(dn,Br.get(dn.texture).__webglTexture,Br.get(dn.depthTexture).__webglTexture);else if(dn.depthBuffer){const Li=dn.depthTexture;if(jn.__boundDepthTexture!==Li){if(Li!==null&&Br.has(Li)&&(dn.width!==Li.image.width||dn.height!==Li.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");kt.setupDepthRenderbuffer(dn)}}const gi=dn.texture;(gi.isData3DTexture||gi.isDataArrayTexture||gi.isCompressedArrayTexture)&&(Vn=!0);const Wi=Br.get(dn).__webglFramebuffer;dn.isWebGLCubeRenderTarget?(Array.isArray(Wi[qn])?Jt=Wi[qn][di]:Jt=Wi[qn],xn=!0):dn.samples>0&&kt.useMultisampledRTT(dn)===!1?Jt=Br.get(dn).__webglMultisampledFramebuffer:Array.isArray(Wi)?Jt=Wi[di]:Jt=Wi,ze.copy(dn.viewport),tt.copy(dn.scissor),ft=dn.scissorTest}else ze.copy(Ut).multiplyScalar(Bt).floor(),tt.copy(Tt).multiplyScalar(Bt).floor(),ft=Xt;if(ir.bindFramebuffer(Mn.FRAMEBUFFER,Jt)&&$t&&ir.drawBuffers(dn,Jt),ir.viewport(ze),ir.scissor(tt),ir.setScissorTest(ft),xn){const jn=Br.get(dn.texture);Mn.framebufferTexture2D(Mn.FRAMEBUFFER,Mn.COLOR_ATTACHMENT0,Mn.TEXTURE_CUBE_MAP_POSITIVE_X+qn,jn.__webglTexture,di)}else if(Vn){const jn=Br.get(dn.texture),gi=qn||0;Mn.framebufferTextureLayer(Mn.FRAMEBUFFER,Mn.COLOR_ATTACHMENT0,jn.__webglTexture,di||0,gi)}$e=-1},this.readRenderTargetPixels=function(dn,qn,di,$t,Jt,xn,Vn){if(!(dn&&dn.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Dn=Br.get(dn).__webglFramebuffer;if(dn.isWebGLCubeRenderTarget&&Vn!==void 0&&(Dn=Dn[Vn]),Dn){ir.bindFramebuffer(Mn.FRAMEBUFFER,Dn);try{const jn=dn.texture,gi=jn.format,Wi=jn.type;if(!Rr.textureFormatReadable(gi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Rr.textureTypeReadable(Wi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}qn>=0&&qn<=dn.width-$t&&di>=0&&di<=dn.height-Jt&&Mn.readPixels(qn,di,$t,Jt,Nt.convert(gi),Nt.convert(Wi),xn)}finally{const jn=Xe!==null?Br.get(Xe).__webglFramebuffer:null;ir.bindFramebuffer(Mn.FRAMEBUFFER,jn)}}},this.readRenderTargetPixelsAsync=async function(dn,qn,di,$t,Jt,xn,Vn){if(!(dn&&dn.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Dn=Br.get(dn).__webglFramebuffer;if(dn.isWebGLCubeRenderTarget&&Vn!==void 0&&(Dn=Dn[Vn]),Dn){const jn=dn.texture,gi=jn.format,Wi=jn.type;if(!Rr.textureFormatReadable(gi))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Rr.textureTypeReadable(Wi))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(qn>=0&&qn<=dn.width-$t&&di>=0&&di<=dn.height-Jt){ir.bindFramebuffer(Mn.FRAMEBUFFER,Dn);const Li=Mn.createBuffer();Mn.bindBuffer(Mn.PIXEL_PACK_BUFFER,Li),Mn.bufferData(Mn.PIXEL_PACK_BUFFER,xn.byteLength,Mn.STREAM_READ),Mn.readPixels(qn,di,$t,Jt,Nt.convert(gi),Nt.convert(Wi),0);const vi=Xe!==null?Br.get(Xe).__webglFramebuffer:null;ir.bindFramebuffer(Mn.FRAMEBUFFER,vi);const yr=Mn.fenceSync(Mn.SYNC_GPU_COMMANDS_COMPLETE,0);return Mn.flush(),await probeAsync(Mn,yr,4),Mn.bindBuffer(Mn.PIXEL_PACK_BUFFER,Li),Mn.getBufferSubData(Mn.PIXEL_PACK_BUFFER,0,xn),Mn.deleteBuffer(Li),Mn.deleteSync(yr),xn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(dn,qn=null,di=0){dn.isTexture!==!0&&(warnOnce("WebGLRenderer: copyFramebufferToTexture function signature has changed."),qn=arguments[0]||null,dn=arguments[1]);const $t=Math.pow(2,-di),Jt=Math.floor(dn.image.width*$t),xn=Math.floor(dn.image.height*$t),Vn=qn!==null?qn.x:0,Dn=qn!==null?qn.y:0;kt.setTexture2D(dn,0),Mn.copyTexSubImage2D(Mn.TEXTURE_2D,di,0,0,Vn,Dn,Jt,xn),ir.unbindTexture()},this.copyTextureToTexture=function(dn,qn,di=null,$t=null,Jt=0){dn.isTexture!==!0&&(warnOnce("WebGLRenderer: copyTextureToTexture function signature has changed."),$t=arguments[0]||null,dn=arguments[1],qn=arguments[2],Jt=arguments[3]||0,di=null);let xn,Vn,Dn,jn,gi,Wi;di!==null?(xn=di.max.x-di.min.x,Vn=di.max.y-di.min.y,Dn=di.min.x,jn=di.min.y):(xn=dn.image.width,Vn=dn.image.height,Dn=0,jn=0),$t!==null?(gi=$t.x,Wi=$t.y):(gi=0,Wi=0);const Li=Nt.convert(qn.format),vi=Nt.convert(qn.type);kt.setTexture2D(qn,0),Mn.pixelStorei(Mn.UNPACK_FLIP_Y_WEBGL,qn.flipY),Mn.pixelStorei(Mn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qn.premultiplyAlpha),Mn.pixelStorei(Mn.UNPACK_ALIGNMENT,qn.unpackAlignment);const yr=Mn.getParameter(Mn.UNPACK_ROW_LENGTH),Sr=Mn.getParameter(Mn.UNPACK_IMAGE_HEIGHT),Ur=Mn.getParameter(Mn.UNPACK_SKIP_PIXELS),hs=Mn.getParameter(Mn.UNPACK_SKIP_ROWS),er=Mn.getParameter(Mn.UNPACK_SKIP_IMAGES),as=dn.isCompressedTexture?dn.mipmaps[Jt]:dn.image;Mn.pixelStorei(Mn.UNPACK_ROW_LENGTH,as.width),Mn.pixelStorei(Mn.UNPACK_IMAGE_HEIGHT,as.height),Mn.pixelStorei(Mn.UNPACK_SKIP_PIXELS,Dn),Mn.pixelStorei(Mn.UNPACK_SKIP_ROWS,jn),dn.isDataTexture?Mn.texSubImage2D(Mn.TEXTURE_2D,Jt,gi,Wi,xn,Vn,Li,vi,as.data):dn.isCompressedTexture?Mn.compressedTexSubImage2D(Mn.TEXTURE_2D,Jt,gi,Wi,as.width,as.height,Li,as.data):Mn.texSubImage2D(Mn.TEXTURE_2D,Jt,gi,Wi,xn,Vn,Li,vi,as),Mn.pixelStorei(Mn.UNPACK_ROW_LENGTH,yr),Mn.pixelStorei(Mn.UNPACK_IMAGE_HEIGHT,Sr),Mn.pixelStorei(Mn.UNPACK_SKIP_PIXELS,Ur),Mn.pixelStorei(Mn.UNPACK_SKIP_ROWS,hs),Mn.pixelStorei(Mn.UNPACK_SKIP_IMAGES,er),Jt===0&&qn.generateMipmaps&&Mn.generateMipmap(Mn.TEXTURE_2D),ir.unbindTexture()},this.copyTextureToTexture3D=function(dn,qn,di=null,$t=null,Jt=0){dn.isTexture!==!0&&(warnOnce("WebGLRenderer: copyTextureToTexture3D function signature has changed."),di=arguments[0]||null,$t=arguments[1]||null,dn=arguments[2],qn=arguments[3],Jt=arguments[4]||0);let xn,Vn,Dn,jn,gi,Wi,Li,vi,yr;const Sr=dn.isCompressedTexture?dn.mipmaps[Jt]:dn.image;di!==null?(xn=di.max.x-di.min.x,Vn=di.max.y-di.min.y,Dn=di.max.z-di.min.z,jn=di.min.x,gi=di.min.y,Wi=di.min.z):(xn=Sr.width,Vn=Sr.height,Dn=Sr.depth,jn=0,gi=0,Wi=0),$t!==null?(Li=$t.x,vi=$t.y,yr=$t.z):(Li=0,vi=0,yr=0);const Ur=Nt.convert(qn.format),hs=Nt.convert(qn.type);let er;if(qn.isData3DTexture)kt.setTexture3D(qn,0),er=Mn.TEXTURE_3D;else if(qn.isDataArrayTexture||qn.isCompressedArrayTexture)kt.setTexture2DArray(qn,0),er=Mn.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Mn.pixelStorei(Mn.UNPACK_FLIP_Y_WEBGL,qn.flipY),Mn.pixelStorei(Mn.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qn.premultiplyAlpha),Mn.pixelStorei(Mn.UNPACK_ALIGNMENT,qn.unpackAlignment);const as=Mn.getParameter(Mn.UNPACK_ROW_LENGTH),Yr=Mn.getParameter(Mn.UNPACK_IMAGE_HEIGHT),eo=Mn.getParameter(Mn.UNPACK_SKIP_PIXELS),wo=Mn.getParameter(Mn.UNPACK_SKIP_ROWS),Er=Mn.getParameter(Mn.UNPACK_SKIP_IMAGES);Mn.pixelStorei(Mn.UNPACK_ROW_LENGTH,Sr.width),Mn.pixelStorei(Mn.UNPACK_IMAGE_HEIGHT,Sr.height),Mn.pixelStorei(Mn.UNPACK_SKIP_PIXELS,jn),Mn.pixelStorei(Mn.UNPACK_SKIP_ROWS,gi),Mn.pixelStorei(Mn.UNPACK_SKIP_IMAGES,Wi),dn.isDataTexture||dn.isData3DTexture?Mn.texSubImage3D(er,Jt,Li,vi,yr,xn,Vn,Dn,Ur,hs,Sr.data):qn.isCompressedArrayTexture?Mn.compressedTexSubImage3D(er,Jt,Li,vi,yr,xn,Vn,Dn,Ur,Sr.data):Mn.texSubImage3D(er,Jt,Li,vi,yr,xn,Vn,Dn,Ur,hs,Sr),Mn.pixelStorei(Mn.UNPACK_ROW_LENGTH,as),Mn.pixelStorei(Mn.UNPACK_IMAGE_HEIGHT,Yr),Mn.pixelStorei(Mn.UNPACK_SKIP_PIXELS,eo),Mn.pixelStorei(Mn.UNPACK_SKIP_ROWS,wo),Mn.pixelStorei(Mn.UNPACK_SKIP_IMAGES,Er),Jt===0&&qn.generateMipmaps&&Mn.generateMipmap(er),ir.unbindTexture()},this.initRenderTarget=function(dn){Br.get(dn).__webglFramebuffer===void 0&&kt.setupRenderTarget(dn)},this.initTexture=function(dn){dn.isCubeTexture?kt.setTextureCube(dn,0):dn.isData3DTexture?kt.setTexture3D(dn,0):dn.isDataArrayTexture||dn.isCompressedArrayTexture?kt.setTexture2DArray(dn,0):kt.setTexture2D(dn,0),ir.unbindTexture()},this.resetState=function(){ke=0,Ve=0,Xe=null,ir.reset(),ht.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(U){this._outputColorSpace=U;const Y=this.getContext();Y.drawingBufferColorSpace=U===DisplayP3ColorSpace?"display-p3":"srgb",Y.unpackColorSpace=ColorManagement.workingColorSpace===LinearDisplayP3ColorSpace?"display-p3":"srgb"}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler,this.environmentIntensity=1,this.environmentRotation=new Euler,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(U,Y){return super.copy(U,Y),U.background!==null&&(this.background=U.background.clone()),U.environment!==null&&(this.environment=U.environment.clone()),U.fog!==null&&(this.fog=U.fog.clone()),this.backgroundBlurriness=U.backgroundBlurriness,this.backgroundIntensity=U.backgroundIntensity,this.backgroundRotation.copy(U.backgroundRotation),this.environmentIntensity=U.environmentIntensity,this.environmentRotation.copy(U.environmentRotation),U.overrideMaterial!==null&&(this.overrideMaterial=U.overrideMaterial.clone()),this.matrixAutoUpdate=U.matrixAutoUpdate,this}toJSON(U){const Y=super.toJSON(U);return this.fog!==null&&(Y.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(Y.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(Y.object.backgroundIntensity=this.backgroundIntensity),Y.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(Y.object.environmentIntensity=this.environmentIntensity),Y.object.environmentRotation=this.environmentRotation.toArray(),Y}}class InterleavedBuffer{constructor(U,Y){this.isInterleavedBuffer=!0,this.array=U,this.stride=Y,this.count=U!==void 0?U.length/Y:0,this.usage=StaticDrawUsage,this.updateRanges=[],this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(U){U===!0&&this.version++}setUsage(U){return this.usage=U,this}addUpdateRange(U,Y){this.updateRanges.push({start:U,count:Y})}clearUpdateRanges(){this.updateRanges.length=0}copy(U){return this.array=new U.array.constructor(U.array),this.count=U.count,this.stride=U.stride,this.usage=U.usage,this}copyAt(U,Y,ie){U*=this.stride,ie*=Y.stride;for(let ne=0,F=this.stride;ne<F;ne++)this.array[U+ne]=Y.array[ie+ne];return this}set(U,Y=0){return this.array.set(U,Y),this}clone(U){U.arrayBuffers===void 0&&(U.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),U.arrayBuffers[this.array.buffer._uuid]===void 0&&(U.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const Y=new this.array.constructor(U.arrayBuffers[this.array.buffer._uuid]),ie=new this.constructor(Y,this.stride);return ie.setUsage(this.usage),ie}onUpload(U){return this.onUploadCallback=U,this}toJSON(U){return U.arrayBuffers===void 0&&(U.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),U.arrayBuffers[this.array.buffer._uuid]===void 0&&(U.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(U,Y,ie,ne=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=U,this.itemSize=Y,this.offset=ie,this.normalized=ne}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(U){this.data.needsUpdate=U}applyMatrix4(U){for(let Y=0,ie=this.data.count;Y<ie;Y++)_vector$6.fromBufferAttribute(this,Y),_vector$6.applyMatrix4(U),this.setXYZ(Y,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(U){for(let Y=0,ie=this.count;Y<ie;Y++)_vector$6.fromBufferAttribute(this,Y),_vector$6.applyNormalMatrix(U),this.setXYZ(Y,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(U){for(let Y=0,ie=this.count;Y<ie;Y++)_vector$6.fromBufferAttribute(this,Y),_vector$6.transformDirection(U),this.setXYZ(Y,_vector$6.x,_vector$6.y,_vector$6.z);return this}getComponent(U,Y){let ie=this.array[U*this.data.stride+this.offset+Y];return this.normalized&&(ie=denormalize(ie,this.array)),ie}setComponent(U,Y,ie){return this.normalized&&(ie=normalize(ie,this.array)),this.data.array[U*this.data.stride+this.offset+Y]=ie,this}setX(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.data.array[U*this.data.stride+this.offset]=Y,this}setY(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.data.array[U*this.data.stride+this.offset+1]=Y,this}setZ(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.data.array[U*this.data.stride+this.offset+2]=Y,this}setW(U,Y){return this.normalized&&(Y=normalize(Y,this.array)),this.data.array[U*this.data.stride+this.offset+3]=Y,this}getX(U){let Y=this.data.array[U*this.data.stride+this.offset];return this.normalized&&(Y=denormalize(Y,this.array)),Y}getY(U){let Y=this.data.array[U*this.data.stride+this.offset+1];return this.normalized&&(Y=denormalize(Y,this.array)),Y}getZ(U){let Y=this.data.array[U*this.data.stride+this.offset+2];return this.normalized&&(Y=denormalize(Y,this.array)),Y}getW(U){let Y=this.data.array[U*this.data.stride+this.offset+3];return this.normalized&&(Y=denormalize(Y,this.array)),Y}setXY(U,Y,ie){return U=U*this.data.stride+this.offset,this.normalized&&(Y=normalize(Y,this.array),ie=normalize(ie,this.array)),this.data.array[U+0]=Y,this.data.array[U+1]=ie,this}setXYZ(U,Y,ie,ne){return U=U*this.data.stride+this.offset,this.normalized&&(Y=normalize(Y,this.array),ie=normalize(ie,this.array),ne=normalize(ne,this.array)),this.data.array[U+0]=Y,this.data.array[U+1]=ie,this.data.array[U+2]=ne,this}setXYZW(U,Y,ie,ne,F){return U=U*this.data.stride+this.offset,this.normalized&&(Y=normalize(Y,this.array),ie=normalize(ie,this.array),ne=normalize(ne,this.array),F=normalize(F,this.array)),this.data.array[U+0]=Y,this.data.array[U+1]=ie,this.data.array[U+2]=ne,this.data.array[U+3]=F,this}clone(U){if(U===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const Y=[];for(let ie=0;ie<this.count;ie++){const ne=ie*this.data.stride+this.offset;for(let F=0;F<this.itemSize;F++)Y.push(this.data.array[ne+F])}return new BufferAttribute(new this.array.constructor(Y),this.itemSize,this.normalized)}else return U.interleavedBuffers===void 0&&(U.interleavedBuffers={}),U.interleavedBuffers[this.data.uuid]===void 0&&(U.interleavedBuffers[this.data.uuid]=this.data.clone(U)),new InterleavedBufferAttribute(U.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(U){if(U===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const Y=[];for(let ie=0;ie<this.count;ie++){const ne=ie*this.data.stride+this.offset;for(let F=0;F<this.itemSize;F++)Y.push(this.data.array[ne+F])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:Y,normalized:this.normalized}}else return U.interleavedBuffers===void 0&&(U.interleavedBuffers={}),U.interleavedBuffers[this.data.uuid]===void 0&&(U.interleavedBuffers[this.data.uuid]=this.data.toJSON(U)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(U,Y){super(U,Y),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const U=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const Y=U.getAttribute("position");for(let ie=0;ie<Y.count;ie++)this.getVertexPosition(ie,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const U=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const Y=U.getAttribute("position");for(let ie=0;ie<Y.count;ie++)this.getVertexPosition(ie,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(U,Y){return super.copy(U,Y),this.bindMode=U.bindMode,this.bindMatrix.copy(U.bindMatrix),this.bindMatrixInverse.copy(U.bindMatrixInverse),this.skeleton=U.skeleton,U.boundingBox!==null&&(this.boundingBox=U.boundingBox.clone()),U.boundingSphere!==null&&(this.boundingSphere=U.boundingSphere.clone()),this}raycast(U,Y){const ie=this.material,ne=this.matrixWorld;ie!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(ne),U.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(ne).invert(),_ray$2.copy(U.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(U,Y,_ray$2)))}getVertexPosition(U,Y){return super.getVertexPosition(U,Y),this.applyBoneTransform(U,Y),Y}bind(U,Y){this.skeleton=U,Y===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),Y=this.matrixWorld),this.bindMatrix.copy(Y),this.bindMatrixInverse.copy(Y).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const U=new Vector4,Y=this.geometry.attributes.skinWeight;for(let ie=0,ne=Y.count;ie<ne;ie++){U.fromBufferAttribute(Y,ie);const F=1/U.manhattanLength();F!==1/0?U.multiplyScalar(F):U.set(1,0,0,0),Y.setXYZW(ie,U.x,U.y,U.z,U.w)}}updateMatrixWorld(U){super.updateMatrixWorld(U),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(U,Y){const ie=this.skeleton,ne=this.geometry;_skinIndex.fromBufferAttribute(ne.attributes.skinIndex,U),_skinWeight.fromBufferAttribute(ne.attributes.skinWeight,U),_basePosition.copy(Y).applyMatrix4(this.bindMatrix),Y.set(0,0,0);for(let F=0;F<4;F++){const fe=_skinWeight.getComponent(F);if(fe!==0){const pe=_skinIndex.getComponent(F);_matrix4.multiplyMatrices(ie.bones[pe].matrixWorld,ie.boneInverses[pe]),Y.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),fe)}}return Y.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture$1{constructor(U=null,Y=1,ie=1,ne,F,fe,pe,Me,ve=NearestFilter,se=NearestFilter,me,Te){super(null,fe,pe,Me,ve,se,ne,F,me,Te),this.isDataTexture=!0,this.image={data:U,width:Y,height:ie},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(U=[],Y=[]){this.uuid=generateUUID(),this.bones=U.slice(0),this.boneInverses=Y,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const U=this.bones,Y=this.boneInverses;if(this.boneMatrices=new Float32Array(U.length*16),Y.length===0)this.calculateInverses();else if(U.length!==Y.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let ie=0,ne=this.bones.length;ie<ne;ie++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let U=0,Y=this.bones.length;U<Y;U++){const ie=new Matrix4;this.bones[U]&&ie.copy(this.bones[U].matrixWorld).invert(),this.boneInverses.push(ie)}}pose(){for(let U=0,Y=this.bones.length;U<Y;U++){const ie=this.bones[U];ie&&ie.matrixWorld.copy(this.boneInverses[U]).invert()}for(let U=0,Y=this.bones.length;U<Y;U++){const ie=this.bones[U];ie&&(ie.parent&&ie.parent.isBone?(ie.matrix.copy(ie.parent.matrixWorld).invert(),ie.matrix.multiply(ie.matrixWorld)):ie.matrix.copy(ie.matrixWorld),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale))}}update(){const U=this.bones,Y=this.boneInverses,ie=this.boneMatrices,ne=this.boneTexture;for(let F=0,fe=U.length;F<fe;F++){const pe=U[F]?U[F].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(pe,Y[F]),_offsetMatrix.toArray(ie,F*16)}ne!==null&&(ne.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let U=Math.sqrt(this.bones.length*4);U=Math.ceil(U/4)*4,U=Math.max(U,4);const Y=new Float32Array(U*U*4);Y.set(this.boneMatrices);const ie=new DataTexture(Y,U,U,RGBAFormat,FloatType);return ie.needsUpdate=!0,this.boneMatrices=Y,this.boneTexture=ie,this}getBoneByName(U){for(let Y=0,ie=this.bones.length;Y<ie;Y++){const ne=this.bones[Y];if(ne.name===U)return ne}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(U,Y){this.uuid=U.uuid;for(let ie=0,ne=U.bones.length;ie<ne;ie++){const F=U.bones[ie];let fe=Y[F];fe===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",F),fe=new Bone),this.bones.push(fe),this.boneInverses.push(new Matrix4().fromArray(U.boneInverses[ie]))}return this.init(),this}toJSON(){const U={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};U.uuid=this.uuid;const Y=this.bones,ie=this.boneInverses;for(let ne=0,F=Y.length;ne<F;ne++){const fe=Y[ne];U.bones.push(fe.uuid);const pe=ie[ne];U.boneInverses.push(pe.toArray())}return U}}class InstancedBufferAttribute extends BufferAttribute{constructor(U,Y,ie,ne=1){super(U,Y,ie),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=ne}copy(U){return super.copy(U),this.meshPerAttribute=U.meshPerAttribute,this}toJSON(){const U=super.toJSON();return U.meshPerAttribute=this.meshPerAttribute,U.isInstancedBufferAttribute=!0,U}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh$1=new Mesh,_sphere$3=new Sphere;class InstancedMesh extends Mesh{constructor(U,Y,ie){super(U,Y),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ie*16),16),this.instanceColor=null,this.morphTexture=null,this.count=ie,this.boundingBox=null,this.boundingSphere=null;for(let ne=0;ne<ie;ne++)this.setMatrixAt(ne,_identity)}computeBoundingBox(){const U=this.geometry,Y=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),U.boundingBox===null&&U.computeBoundingBox(),this.boundingBox.makeEmpty();for(let ie=0;ie<Y;ie++)this.getMatrixAt(ie,_instanceLocalMatrix),_box3.copy(U.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const U=this.geometry,Y=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),U.boundingSphere===null&&U.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let ie=0;ie<Y;ie++)this.getMatrixAt(ie,_instanceLocalMatrix),_sphere$3.copy(U.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$3)}copy(U,Y){return super.copy(U,Y),this.instanceMatrix.copy(U.instanceMatrix),U.morphTexture!==null&&(this.morphTexture=U.morphTexture.clone()),U.instanceColor!==null&&(this.instanceColor=U.instanceColor.clone()),this.count=U.count,U.boundingBox!==null&&(this.boundingBox=U.boundingBox.clone()),U.boundingSphere!==null&&(this.boundingSphere=U.boundingSphere.clone()),this}getColorAt(U,Y){Y.fromArray(this.instanceColor.array,U*3)}getMatrixAt(U,Y){Y.fromArray(this.instanceMatrix.array,U*16)}getMorphAt(U,Y){const ie=Y.morphTargetInfluences,ne=this.morphTexture.source.data.data,F=ie.length+1,fe=U*F+1;for(let pe=0;pe<ie.length;pe++)ie[pe]=ne[fe+pe]}raycast(U,Y){const ie=this.matrixWorld,ne=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(ie),U.ray.intersectsSphere(_sphere$3)!==!1))for(let F=0;F<ne;F++){this.getMatrixAt(F,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(ie,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,_mesh$1.raycast(U,_instanceIntersects);for(let fe=0,pe=_instanceIntersects.length;fe<pe;fe++){const Me=_instanceIntersects[fe];Me.instanceId=F,Me.object=this,Y.push(Me)}_instanceIntersects.length=0}}setColorAt(U,Y){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),Y.toArray(this.instanceColor.array,U*3)}setMatrixAt(U,Y){Y.toArray(this.instanceMatrix.array,U*16)}setMorphAt(U,Y){const ie=Y.morphTargetInfluences,ne=ie.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(ne*this.count),ne,this.count,RedFormat,FloatType));const F=this.morphTexture.source.data.data;let fe=0;for(let ve=0;ve<ie.length;ve++)fe+=ie[ve];const pe=this.geometry.morphTargetsRelative?1:1-fe,Me=ne*U;F[Me]=pe,F.set(ie,Me+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}class LineBasicMaterial extends Material$1{constructor(U){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(U)}copy(U){return super.copy(U),this.color.copy(U.color),this.map=U.map,this.linewidth=U.linewidth,this.linecap=U.linecap,this.linejoin=U.linejoin,this.fog=U.fog,this}}const _vStart=new Vector3,_vEnd=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere,_intersectPointOnRay=new Vector3,_intersectPointOnSegment=new Vector3;class Line extends Object3D{constructor(U=new BufferGeometry,Y=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=U,this.material=Y,this.updateMorphTargets()}copy(U,Y){return super.copy(U,Y),this.material=Array.isArray(U.material)?U.material.slice():U.material,this.geometry=U.geometry,this}computeLineDistances(){const U=this.geometry;if(U.index===null){const Y=U.attributes.position,ie=[0];for(let ne=1,F=Y.count;ne<F;ne++)_vStart.fromBufferAttribute(Y,ne-1),_vEnd.fromBufferAttribute(Y,ne),ie[ne]=ie[ne-1],ie[ne]+=_vStart.distanceTo(_vEnd);U.setAttribute("lineDistance",new Float32BufferAttribute(ie,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(U,Y){const ie=this.geometry,ne=this.matrixWorld,F=U.params.Line.threshold,fe=ie.drawRange;if(ie.boundingSphere===null&&ie.computeBoundingSphere(),_sphere$1.copy(ie.boundingSphere),_sphere$1.applyMatrix4(ne),_sphere$1.radius+=F,U.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(ne).invert(),_ray$1.copy(U.ray).applyMatrix4(_inverseMatrix$1);const pe=F/((this.scale.x+this.scale.y+this.scale.z)/3),Me=pe*pe,ve=this.isLineSegments?2:1,se=ie.index,Te=ie.attributes.position;if(se!==null){const Re=Math.max(0,fe.start),be=Math.min(se.count,fe.start+fe.count);for(let Pe=Re,Le=be-1;Pe<Le;Pe+=ve){const xe=se.getX(Pe),Fe=se.getX(Pe+1),Oe=checkIntersection(this,U,_ray$1,Me,xe,Fe);Oe&&Y.push(Oe)}if(this.isLineLoop){const Pe=se.getX(be-1),Le=se.getX(Re),xe=checkIntersection(this,U,_ray$1,Me,Pe,Le);xe&&Y.push(xe)}}else{const Re=Math.max(0,fe.start),be=Math.min(Te.count,fe.start+fe.count);for(let Pe=Re,Le=be-1;Pe<Le;Pe+=ve){const xe=checkIntersection(this,U,_ray$1,Me,Pe,Pe+1);xe&&Y.push(xe)}if(this.isLineLoop){const Pe=checkIntersection(this,U,_ray$1,Me,be-1,Re);Pe&&Y.push(Pe)}}}updateMorphTargets(){const Y=this.geometry.morphAttributes,ie=Object.keys(Y);if(ie.length>0){const ne=Y[ie[0]];if(ne!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let F=0,fe=ne.length;F<fe;F++){const pe=ne[F].name||String(F);this.morphTargetInfluences.push(0),this.morphTargetDictionary[pe]=F}}}}}function checkIntersection(re,U,Y,ie,ne,F){const fe=re.geometry.attributes.position;if(_vStart.fromBufferAttribute(fe,ne),_vEnd.fromBufferAttribute(fe,F),Y.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>ie)return;_intersectPointOnRay.applyMatrix4(re.matrixWorld);const Me=U.ray.origin.distanceTo(_intersectPointOnRay);if(!(Me<U.near||Me>U.far))return{distance:Me,point:_intersectPointOnSegment.clone().applyMatrix4(re.matrixWorld),index:ne,face:null,faceIndex:null,barycoord:null,object:re}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(U,Y){super(U,Y),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const U=this.geometry;if(U.index===null){const Y=U.attributes.position,ie=[];for(let ne=0,F=Y.count;ne<F;ne+=2)_start.fromBufferAttribute(Y,ne),_end.fromBufferAttribute(Y,ne+1),ie[ne]=ne===0?0:ie[ne-1],ie[ne+1]=ie[ne]+_start.distanceTo(_end);U.setAttribute("lineDistance",new Float32BufferAttribute(ie,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(U,Y){super(U,Y),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material$1{constructor(U){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(U)}copy(U){return super.copy(U),this.color.copy(U.color),this.map=U.map,this.alphaMap=U.alphaMap,this.size=U.size,this.sizeAttenuation=U.sizeAttenuation,this.fog=U.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(U=new BufferGeometry,Y=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=U,this.material=Y,this.updateMorphTargets()}copy(U,Y){return super.copy(U,Y),this.material=Array.isArray(U.material)?U.material.slice():U.material,this.geometry=U.geometry,this}raycast(U,Y){const ie=this.geometry,ne=this.matrixWorld,F=U.params.Points.threshold,fe=ie.drawRange;if(ie.boundingSphere===null&&ie.computeBoundingSphere(),_sphere.copy(ie.boundingSphere),_sphere.applyMatrix4(ne),_sphere.radius+=F,U.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(ne).invert(),_ray.copy(U.ray).applyMatrix4(_inverseMatrix);const pe=F/((this.scale.x+this.scale.y+this.scale.z)/3),Me=pe*pe,ve=ie.index,me=ie.attributes.position;if(ve!==null){const Te=Math.max(0,fe.start),Re=Math.min(ve.count,fe.start+fe.count);for(let be=Te,Pe=Re;be<Pe;be++){const Le=ve.getX(be);_position$2.fromBufferAttribute(me,Le),testPoint(_position$2,Le,Me,ne,U,Y,this)}}else{const Te=Math.max(0,fe.start),Re=Math.min(me.count,fe.start+fe.count);for(let be=Te,Pe=Re;be<Pe;be++)_position$2.fromBufferAttribute(me,be),testPoint(_position$2,be,Me,ne,U,Y,this)}}updateMorphTargets(){const Y=this.geometry.morphAttributes,ie=Object.keys(Y);if(ie.length>0){const ne=Y[ie[0]];if(ne!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let F=0,fe=ne.length;F<fe;F++){const pe=ne[F].name||String(F);this.morphTargetInfluences.push(0),this.morphTargetDictionary[pe]=F}}}}}function testPoint(re,U,Y,ie,ne,F,fe){const pe=_ray.distanceSqToPoint(re);if(pe<Y){const Me=new Vector3;_ray.closestPointToPoint(re,Me),Me.applyMatrix4(ie);const ve=ne.ray.origin.distanceTo(Me);if(ve<ne.near||ve>ne.far)return;F.push({distance:ve,distanceToRay:Math.sqrt(pe),point:Me,index:U,face:null,faceIndex:null,barycoord:null,object:fe})}}class VideoTexture extends Texture$1{constructor(U,Y,ie,ne,F,fe,pe,Me,ve){super(U,Y,ie,ne,F,fe,pe,Me,ve),this.isVideoTexture=!0,this.minFilter=fe!==void 0?fe:LinearFilter,this.magFilter=F!==void 0?F:LinearFilter,this.generateMipmaps=!1;const se=this;function me(){se.needsUpdate=!0,U.requestVideoFrameCallback(me)}"requestVideoFrameCallback"in U&&U.requestVideoFrameCallback(me)}clone(){return new this.constructor(this.image).copy(this)}update(){const U=this.image;"requestVideoFrameCallback"in U===!1&&U.readyState>=U.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class CompressedTexture extends Texture$1{constructor(U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te){super(null,fe,pe,Me,ve,se,ne,F,me,Te),this.isCompressedTexture=!0,this.image={width:Y,height:ie},this.mipmaps=U,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(U,Y,ie,ne,F,fe){super(U,Y,ie,F,fe),this.isCompressedArrayTexture=!0,this.image.depth=ne,this.wrapR=ClampToEdgeWrapping,this.layerUpdates=new Set}addLayerUpdate(U){this.layerUpdates.add(U)}clearLayerUpdates(){this.layerUpdates.clear()}}class CompressedCubeTexture extends CompressedTexture{constructor(U,Y,ie){super(void 0,U[0].width,U[0].height,Y,ie,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=U}}class CanvasTexture extends Texture$1{constructor(U,Y,ie,ne,F,fe,pe,Me,ve){super(U,Y,ie,ne,F,fe,pe,Me,ve),this.isCanvasTexture=!0,this.needsUpdate=!0}}class SphereGeometry extends BufferGeometry{constructor(U=1,Y=32,ie=16,ne=0,F=Math.PI*2,fe=0,pe=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:U,widthSegments:Y,heightSegments:ie,phiStart:ne,phiLength:F,thetaStart:fe,thetaLength:pe},Y=Math.max(3,Math.floor(Y)),ie=Math.max(2,Math.floor(ie));const Me=Math.min(fe+pe,Math.PI);let ve=0;const se=[],me=new Vector3,Te=new Vector3,Re=[],be=[],Pe=[],Le=[];for(let xe=0;xe<=ie;xe++){const Fe=[],Oe=xe/ie;let Ne=0;xe===0&&fe===0?Ne=.5/Y:xe===ie&&Me===Math.PI&&(Ne=-.5/Y);for(let ke=0;ke<=Y;ke++){const Ve=ke/Y;me.x=-U*Math.cos(ne+Ve*F)*Math.sin(fe+Oe*pe),me.y=U*Math.cos(fe+Oe*pe),me.z=U*Math.sin(ne+Ve*F)*Math.sin(fe+Oe*pe),be.push(me.x,me.y,me.z),Te.copy(me).normalize(),Pe.push(Te.x,Te.y,Te.z),Le.push(Ve+Ne,1-Oe),Fe.push(ve++)}se.push(Fe)}for(let xe=0;xe<ie;xe++)for(let Fe=0;Fe<Y;Fe++){const Oe=se[xe][Fe+1],Ne=se[xe][Fe],ke=se[xe+1][Fe],Ve=se[xe+1][Fe+1];(xe!==0||fe>0)&&Re.push(Oe,Ne,Ve),(xe!==ie-1||Me<Math.PI)&&Re.push(Ne,ke,Ve)}this.setIndex(Re),this.setAttribute("position",new Float32BufferAttribute(be,3)),this.setAttribute("normal",new Float32BufferAttribute(Pe,3)),this.setAttribute("uv",new Float32BufferAttribute(Le,2))}copy(U){return super.copy(U),this.parameters=Object.assign({},U.parameters),this}static fromJSON(U){return new SphereGeometry(U.radius,U.widthSegments,U.heightSegments,U.phiStart,U.phiLength,U.thetaStart,U.thetaLength)}}class MeshStandardMaterial extends Material$1{constructor(U){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(U)}copy(U){return super.copy(U),this.defines={STANDARD:""},this.color.copy(U.color),this.roughness=U.roughness,this.metalness=U.metalness,this.map=U.map,this.lightMap=U.lightMap,this.lightMapIntensity=U.lightMapIntensity,this.aoMap=U.aoMap,this.aoMapIntensity=U.aoMapIntensity,this.emissive.copy(U.emissive),this.emissiveMap=U.emissiveMap,this.emissiveIntensity=U.emissiveIntensity,this.bumpMap=U.bumpMap,this.bumpScale=U.bumpScale,this.normalMap=U.normalMap,this.normalMapType=U.normalMapType,this.normalScale.copy(U.normalScale),this.displacementMap=U.displacementMap,this.displacementScale=U.displacementScale,this.displacementBias=U.displacementBias,this.roughnessMap=U.roughnessMap,this.metalnessMap=U.metalnessMap,this.alphaMap=U.alphaMap,this.envMap=U.envMap,this.envMapRotation.copy(U.envMapRotation),this.envMapIntensity=U.envMapIntensity,this.wireframe=U.wireframe,this.wireframeLinewidth=U.wireframeLinewidth,this.wireframeLinecap=U.wireframeLinecap,this.wireframeLinejoin=U.wireframeLinejoin,this.flatShading=U.flatShading,this.fog=U.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(U){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$1(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(Y){this.ior=(1+.4*Y)/(1-.4*Y)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(U)}get anisotropy(){return this._anisotropy}set anisotropy(U){this._anisotropy>0!=U>0&&this.version++,this._anisotropy=U}get clearcoat(){return this._clearcoat}set clearcoat(U){this._clearcoat>0!=U>0&&this.version++,this._clearcoat=U}get iridescence(){return this._iridescence}set iridescence(U){this._iridescence>0!=U>0&&this.version++,this._iridescence=U}get dispersion(){return this._dispersion}set dispersion(U){this._dispersion>0!=U>0&&this.version++,this._dispersion=U}get sheen(){return this._sheen}set sheen(U){this._sheen>0!=U>0&&this.version++,this._sheen=U}get transmission(){return this._transmission}set transmission(U){this._transmission>0!=U>0&&this.version++,this._transmission=U}copy(U){return super.copy(U),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=U.anisotropy,this.anisotropyRotation=U.anisotropyRotation,this.anisotropyMap=U.anisotropyMap,this.clearcoat=U.clearcoat,this.clearcoatMap=U.clearcoatMap,this.clearcoatRoughness=U.clearcoatRoughness,this.clearcoatRoughnessMap=U.clearcoatRoughnessMap,this.clearcoatNormalMap=U.clearcoatNormalMap,this.clearcoatNormalScale.copy(U.clearcoatNormalScale),this.dispersion=U.dispersion,this.ior=U.ior,this.iridescence=U.iridescence,this.iridescenceMap=U.iridescenceMap,this.iridescenceIOR=U.iridescenceIOR,this.iridescenceThicknessRange=[...U.iridescenceThicknessRange],this.iridescenceThicknessMap=U.iridescenceThicknessMap,this.sheen=U.sheen,this.sheenColor.copy(U.sheenColor),this.sheenColorMap=U.sheenColorMap,this.sheenRoughness=U.sheenRoughness,this.sheenRoughnessMap=U.sheenRoughnessMap,this.transmission=U.transmission,this.transmissionMap=U.transmissionMap,this.thickness=U.thickness,this.thicknessMap=U.thicknessMap,this.attenuationDistance=U.attenuationDistance,this.attenuationColor.copy(U.attenuationColor),this.specularIntensity=U.specularIntensity,this.specularIntensityMap=U.specularIntensityMap,this.specularColor.copy(U.specularColor),this.specularColorMap=U.specularColorMap,this}}function convertArray(re,U,Y){return!re||!Y&&re.constructor===U?re:typeof U.BYTES_PER_ELEMENT=="number"?new U(re):Array.prototype.slice.call(re)}function isTypedArray(re){return ArrayBuffer.isView(re)&&!(re instanceof DataView)}function getKeyframeOrder(re){function U(ne,F){return re[ne]-re[F]}const Y=re.length,ie=new Array(Y);for(let ne=0;ne!==Y;++ne)ie[ne]=ne;return ie.sort(U),ie}function sortedArray(re,U,Y){const ie=re.length,ne=new re.constructor(ie);for(let F=0,fe=0;fe!==ie;++F){const pe=Y[F]*U;for(let Me=0;Me!==U;++Me)ne[fe++]=re[pe+Me]}return ne}function flattenJSON(re,U,Y,ie){let ne=1,F=re[0];for(;F!==void 0&&F[ie]===void 0;)F=re[ne++];if(F===void 0)return;let fe=F[ie];if(fe!==void 0)if(Array.isArray(fe))do fe=F[ie],fe!==void 0&&(U.push(F.time),Y.push.apply(Y,fe)),F=re[ne++];while(F!==void 0);else if(fe.toArray!==void 0)do fe=F[ie],fe!==void 0&&(U.push(F.time),fe.toArray(Y,Y.length)),F=re[ne++];while(F!==void 0);else do fe=F[ie],fe!==void 0&&(U.push(F.time),Y.push(fe)),F=re[ne++];while(F!==void 0)}class Interpolant{constructor(U,Y,ie,ne){this.parameterPositions=U,this._cachedIndex=0,this.resultBuffer=ne!==void 0?ne:new Y.constructor(ie),this.sampleValues=Y,this.valueSize=ie,this.settings=null,this.DefaultSettings_={}}evaluate(U){const Y=this.parameterPositions;let ie=this._cachedIndex,ne=Y[ie],F=Y[ie-1];e:{t:{let fe;n:{r:if(!(U<ne)){for(let pe=ie+2;;){if(ne===void 0){if(U<F)break r;return ie=Y.length,this._cachedIndex=ie,this.copySampleValue_(ie-1)}if(ie===pe)break;if(F=ne,ne=Y[++ie],U<ne)break t}fe=Y.length;break n}if(!(U>=F)){const pe=Y[1];U<pe&&(ie=2,F=pe);for(let Me=ie-2;;){if(F===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(ie===Me)break;if(ne=F,F=Y[--ie-1],U>=F)break t}fe=ie,ie=0;break n}break e}for(;ie<fe;){const pe=ie+fe>>>1;U<Y[pe]?fe=pe:ie=pe+1}if(ne=Y[ie],F=Y[ie-1],F===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(ne===void 0)return ie=Y.length,this._cachedIndex=ie,this.copySampleValue_(ie-1)}this._cachedIndex=ie,this.intervalChanged_(ie,F,ne)}return this.interpolate_(ie,F,U,ne)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(U){const Y=this.resultBuffer,ie=this.sampleValues,ne=this.valueSize,F=U*ne;for(let fe=0;fe!==ne;++fe)Y[fe]=ie[F+fe];return Y}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(U,Y,ie,ne){super(U,Y,ie,ne),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(U,Y,ie){const ne=this.parameterPositions;let F=U-2,fe=U+1,pe=ne[F],Me=ne[fe];if(pe===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:F=U,pe=2*Y-ie;break;case WrapAroundEnding:F=ne.length-2,pe=Y+ne[F]-ne[F+1];break;default:F=U,pe=ie}if(Me===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:fe=U,Me=2*ie-Y;break;case WrapAroundEnding:fe=1,Me=ie+ne[1]-ne[0];break;default:fe=U-1,Me=Y}const ve=(ie-Y)*.5,se=this.valueSize;this._weightPrev=ve/(Y-pe),this._weightNext=ve/(Me-ie),this._offsetPrev=F*se,this._offsetNext=fe*se}interpolate_(U,Y,ie,ne){const F=this.resultBuffer,fe=this.sampleValues,pe=this.valueSize,Me=U*pe,ve=Me-pe,se=this._offsetPrev,me=this._offsetNext,Te=this._weightPrev,Re=this._weightNext,be=(ie-Y)/(ne-Y),Pe=be*be,Le=Pe*be,xe=-Te*Le+2*Te*Pe-Te*be,Fe=(1+Te)*Le+(-1.5-2*Te)*Pe+(-.5+Te)*be+1,Oe=(-1-Re)*Le+(1.5+Re)*Pe+.5*be,Ne=Re*Le-Re*Pe;for(let ke=0;ke!==pe;++ke)F[ke]=xe*fe[se+ke]+Fe*fe[ve+ke]+Oe*fe[Me+ke]+Ne*fe[me+ke];return F}}class LinearInterpolant extends Interpolant{constructor(U,Y,ie,ne){super(U,Y,ie,ne)}interpolate_(U,Y,ie,ne){const F=this.resultBuffer,fe=this.sampleValues,pe=this.valueSize,Me=U*pe,ve=Me-pe,se=(ie-Y)/(ne-Y),me=1-se;for(let Te=0;Te!==pe;++Te)F[Te]=fe[ve+Te]*me+fe[Me+Te]*se;return F}}class DiscreteInterpolant extends Interpolant{constructor(U,Y,ie,ne){super(U,Y,ie,ne)}interpolate_(U){return this.copySampleValue_(U-1)}}class KeyframeTrack{constructor(U,Y,ie,ne){if(U===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(Y===void 0||Y.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+U);this.name=U,this.times=convertArray(Y,this.TimeBufferType),this.values=convertArray(ie,this.ValueBufferType),this.setInterpolation(ne||this.DefaultInterpolation)}static toJSON(U){const Y=U.constructor;let ie;if(Y.toJSON!==this.toJSON)ie=Y.toJSON(U);else{ie={name:U.name,times:convertArray(U.times,Array),values:convertArray(U.values,Array)};const ne=U.getInterpolation();ne!==U.DefaultInterpolation&&(ie.interpolation=ne)}return ie.type=U.ValueTypeName,ie}InterpolantFactoryMethodDiscrete(U){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),U)}InterpolantFactoryMethodLinear(U){return new LinearInterpolant(this.times,this.values,this.getValueSize(),U)}InterpolantFactoryMethodSmooth(U){return new CubicInterpolant(this.times,this.values,this.getValueSize(),U)}setInterpolation(U){let Y;switch(U){case InterpolateDiscrete:Y=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:Y=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:Y=this.InterpolantFactoryMethodSmooth;break}if(Y===void 0){const ie="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(U!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(ie);return console.warn("THREE.KeyframeTrack:",ie),this}return this.createInterpolant=Y,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(U){if(U!==0){const Y=this.times;for(let ie=0,ne=Y.length;ie!==ne;++ie)Y[ie]+=U}return this}scale(U){if(U!==1){const Y=this.times;for(let ie=0,ne=Y.length;ie!==ne;++ie)Y[ie]*=U}return this}trim(U,Y){const ie=this.times,ne=ie.length;let F=0,fe=ne-1;for(;F!==ne&&ie[F]<U;)++F;for(;fe!==-1&&ie[fe]>Y;)--fe;if(++fe,F!==0||fe!==ne){F>=fe&&(fe=Math.max(fe,1),F=fe-1);const pe=this.getValueSize();this.times=ie.slice(F,fe),this.values=this.values.slice(F*pe,fe*pe)}return this}validate(){let U=!0;const Y=this.getValueSize();Y-Math.floor(Y)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),U=!1);const ie=this.times,ne=this.values,F=ie.length;F===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),U=!1);let fe=null;for(let pe=0;pe!==F;pe++){const Me=ie[pe];if(typeof Me=="number"&&isNaN(Me)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,pe,Me),U=!1;break}if(fe!==null&&fe>Me){console.error("THREE.KeyframeTrack: Out of order keys.",this,pe,Me,fe),U=!1;break}fe=Me}if(ne!==void 0&&isTypedArray(ne))for(let pe=0,Me=ne.length;pe!==Me;++pe){const ve=ne[pe];if(isNaN(ve)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,pe,ve),U=!1;break}}return U}optimize(){const U=this.times.slice(),Y=this.values.slice(),ie=this.getValueSize(),ne=this.getInterpolation()===InterpolateSmooth,F=U.length-1;let fe=1;for(let pe=1;pe<F;++pe){let Me=!1;const ve=U[pe],se=U[pe+1];if(ve!==se&&(pe!==1||ve!==U[0]))if(ne)Me=!0;else{const me=pe*ie,Te=me-ie,Re=me+ie;for(let be=0;be!==ie;++be){const Pe=Y[me+be];if(Pe!==Y[Te+be]||Pe!==Y[Re+be]){Me=!0;break}}}if(Me){if(pe!==fe){U[fe]=U[pe];const me=pe*ie,Te=fe*ie;for(let Re=0;Re!==ie;++Re)Y[Te+Re]=Y[me+Re]}++fe}}if(F>0){U[fe]=U[F];for(let pe=F*ie,Me=fe*ie,ve=0;ve!==ie;++ve)Y[Me+ve]=Y[pe+ve];++fe}return fe!==U.length?(this.times=U.slice(0,fe),this.values=Y.slice(0,fe*ie)):(this.times=U,this.values=Y),this}clone(){const U=this.times.slice(),Y=this.values.slice(),ie=this.constructor,ne=new ie(this.name,U,Y);return ne.createInterpolant=this.createInterpolant,ne}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{constructor(U,Y,ie){super(U,Y,ie)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(U,Y,ie,ne){super(U,Y,ie,ne)}interpolate_(U,Y,ie,ne){const F=this.resultBuffer,fe=this.sampleValues,pe=this.valueSize,Me=(ie-Y)/(ne-Y);let ve=U*pe;for(let se=ve+pe;ve!==se;ve+=4)Quaternion.slerpFlat(F,0,fe,ve-pe,fe,ve,Me);return F}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(U){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),U)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(U,Y,ie){super(U,Y,ie)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(U="",Y=-1,ie=[],ne=NormalAnimationBlendMode){this.name=U,this.tracks=ie,this.duration=Y,this.blendMode=ne,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(U){const Y=[],ie=U.tracks,ne=1/(U.fps||1);for(let fe=0,pe=ie.length;fe!==pe;++fe)Y.push(parseKeyframeTrack(ie[fe]).scale(ne));const F=new this(U.name,U.duration,Y,U.blendMode);return F.uuid=U.uuid,F}static toJSON(U){const Y=[],ie=U.tracks,ne={name:U.name,duration:U.duration,tracks:Y,uuid:U.uuid,blendMode:U.blendMode};for(let F=0,fe=ie.length;F!==fe;++F)Y.push(KeyframeTrack.toJSON(ie[F]));return ne}static CreateFromMorphTargetSequence(U,Y,ie,ne){const F=Y.length,fe=[];for(let pe=0;pe<F;pe++){let Me=[],ve=[];Me.push((pe+F-1)%F,pe,(pe+1)%F),ve.push(0,1,0);const se=getKeyframeOrder(Me);Me=sortedArray(Me,1,se),ve=sortedArray(ve,1,se),!ne&&Me[0]===0&&(Me.push(F),ve.push(ve[0])),fe.push(new NumberKeyframeTrack(".morphTargetInfluences["+Y[pe].name+"]",Me,ve).scale(1/ie))}return new this(U,-1,fe)}static findByName(U,Y){let ie=U;if(!Array.isArray(U)){const ne=U;ie=ne.geometry&&ne.geometry.animations||ne.animations}for(let ne=0;ne<ie.length;ne++)if(ie[ne].name===Y)return ie[ne];return null}static CreateClipsFromMorphTargetSequences(U,Y,ie){const ne={},F=/^([\w-]*?)([\d]+)$/;for(let pe=0,Me=U.length;pe<Me;pe++){const ve=U[pe],se=ve.name.match(F);if(se&&se.length>1){const me=se[1];let Te=ne[me];Te||(ne[me]=Te=[]),Te.push(ve)}}const fe=[];for(const pe in ne)fe.push(this.CreateFromMorphTargetSequence(pe,ne[pe],Y,ie));return fe}static parseAnimation(U,Y){if(!U)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const ie=function(me,Te,Re,be,Pe){if(Re.length!==0){const Le=[],xe=[];flattenJSON(Re,Le,xe,be),Le.length!==0&&Pe.push(new me(Te,Le,xe))}},ne=[],F=U.name||"default",fe=U.fps||30,pe=U.blendMode;let Me=U.length||-1;const ve=U.hierarchy||[];for(let me=0;me<ve.length;me++){const Te=ve[me].keys;if(!(!Te||Te.length===0))if(Te[0].morphTargets){const Re={};let be;for(be=0;be<Te.length;be++)if(Te[be].morphTargets)for(let Pe=0;Pe<Te[be].morphTargets.length;Pe++)Re[Te[be].morphTargets[Pe]]=-1;for(const Pe in Re){const Le=[],xe=[];for(let Fe=0;Fe!==Te[be].morphTargets.length;++Fe){const Oe=Te[be];Le.push(Oe.time),xe.push(Oe.morphTarget===Pe?1:0)}ne.push(new NumberKeyframeTrack(".morphTargetInfluence["+Pe+"]",Le,xe))}Me=Re.length*fe}else{const Re=".bones["+Y[me].name+"]";ie(VectorKeyframeTrack,Re+".position",Te,"pos",ne),ie(QuaternionKeyframeTrack,Re+".quaternion",Te,"rot",ne),ie(VectorKeyframeTrack,Re+".scale",Te,"scl",ne)}}return ne.length===0?null:new this(F,Me,ne,pe)}resetDuration(){const U=this.tracks;let Y=0;for(let ie=0,ne=U.length;ie!==ne;++ie){const F=this.tracks[ie];Y=Math.max(Y,F.times[F.times.length-1])}return this.duration=Y,this}trim(){for(let U=0;U<this.tracks.length;U++)this.tracks[U].trim(0,this.duration);return this}validate(){let U=!0;for(let Y=0;Y<this.tracks.length;Y++)U=U&&this.tracks[Y].validate();return U}optimize(){for(let U=0;U<this.tracks.length;U++)this.tracks[U].optimize();return this}clone(){const U=[];for(let Y=0;Y<this.tracks.length;Y++)U.push(this.tracks[Y].clone());return new this.constructor(this.name,this.duration,U,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(re){switch(re.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+re)}function parseKeyframeTrack(re){if(re.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const U=getTrackTypeForValueTypeName(re.type);if(re.times===void 0){const Y=[],ie=[];flattenJSON(re.keys,Y,ie,"value"),re.times=Y,re.values=ie}return U.parse!==void 0?U.parse(re):new U(re.name,re.times,re.values,re.interpolation)}const Cache={enabled:!1,files:{},add:function(re,U){this.enabled!==!1&&(this.files[re]=U)},get:function(re){if(this.enabled!==!1)return this.files[re]},remove:function(re){delete this.files[re]},clear:function(){this.files={}}};class LoadingManager{constructor(U,Y,ie){const ne=this;let F=!1,fe=0,pe=0,Me;const ve=[];this.onStart=void 0,this.onLoad=U,this.onProgress=Y,this.onError=ie,this.itemStart=function(se){pe++,F===!1&&ne.onStart!==void 0&&ne.onStart(se,fe,pe),F=!0},this.itemEnd=function(se){fe++,ne.onProgress!==void 0&&ne.onProgress(se,fe,pe),fe===pe&&(F=!1,ne.onLoad!==void 0&&ne.onLoad())},this.itemError=function(se){ne.onError!==void 0&&ne.onError(se)},this.resolveURL=function(se){return Me?Me(se):se},this.setURLModifier=function(se){return Me=se,this},this.addHandler=function(se,me){return ve.push(se,me),this},this.removeHandler=function(se){const me=ve.indexOf(se);return me!==-1&&ve.splice(me,2),this},this.getHandler=function(se){for(let me=0,Te=ve.length;me<Te;me+=2){const Re=ve[me],be=ve[me+1];if(Re.global&&(Re.lastIndex=0),Re.test(se))return be}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(U){this.manager=U!==void 0?U:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(U,Y){const ie=this;return new Promise(function(ne,F){ie.load(U,ne,Y,F)})}parse(){}setCrossOrigin(U){return this.crossOrigin=U,this}setWithCredentials(U){return this.withCredentials=U,this}setPath(U){return this.path=U,this}setResourcePath(U){return this.resourcePath=U,this}setRequestHeader(U){return this.requestHeader=U,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(U,Y){super(U),this.response=Y}}class FileLoader extends Loader{constructor(U){super(U)}load(U,Y,ie,ne){U===void 0&&(U=""),this.path!==void 0&&(U=this.path+U),U=this.manager.resolveURL(U);const F=Cache.get(U);if(F!==void 0)return this.manager.itemStart(U),setTimeout(()=>{Y&&Y(F),this.manager.itemEnd(U)},0),F;if(loading[U]!==void 0){loading[U].push({onLoad:Y,onProgress:ie,onError:ne});return}loading[U]=[],loading[U].push({onLoad:Y,onProgress:ie,onError:ne});const fe=new Request(U,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),pe=this.mimeType,Me=this.responseType;fetch(fe).then(ve=>{if(ve.status===200||ve.status===0){if(ve.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||ve.body===void 0||ve.body.getReader===void 0)return ve;const se=loading[U],me=ve.body.getReader(),Te=ve.headers.get("X-File-Size")||ve.headers.get("Content-Length"),Re=Te?parseInt(Te):0,be=Re!==0;let Pe=0;const Le=new ReadableStream({start(xe){Fe();function Fe(){me.read().then(({done:Oe,value:Ne})=>{if(Oe)xe.close();else{Pe+=Ne.byteLength;const ke=new ProgressEvent("progress",{lengthComputable:be,loaded:Pe,total:Re});for(let Ve=0,Xe=se.length;Ve<Xe;Ve++){const $e=se[Ve];$e.onProgress&&$e.onProgress(ke)}xe.enqueue(Ne),Fe()}},Oe=>{xe.error(Oe)})}}});return new Response(Le)}else throw new HttpError(`fetch for "${ve.url}" responded with ${ve.status}: ${ve.statusText}`,ve)}).then(ve=>{switch(Me){case"arraybuffer":return ve.arrayBuffer();case"blob":return ve.blob();case"document":return ve.text().then(se=>new DOMParser().parseFromString(se,pe));case"json":return ve.json();default:if(pe===void 0)return ve.text();{const me=/charset="?([^;"\s]*)"?/i.exec(pe),Te=me&&me[1]?me[1].toLowerCase():void 0,Re=new TextDecoder(Te);return ve.arrayBuffer().then(be=>Re.decode(be))}}}).then(ve=>{Cache.add(U,ve);const se=loading[U];delete loading[U];for(let me=0,Te=se.length;me<Te;me++){const Re=se[me];Re.onLoad&&Re.onLoad(ve)}}).catch(ve=>{const se=loading[U];if(se===void 0)throw this.manager.itemError(U),ve;delete loading[U];for(let me=0,Te=se.length;me<Te;me++){const Re=se[me];Re.onError&&Re.onError(ve)}this.manager.itemError(U)}).finally(()=>{this.manager.itemEnd(U)}),this.manager.itemStart(U)}setResponseType(U){return this.responseType=U,this}setMimeType(U){return this.mimeType=U,this}}class ImageLoader extends Loader{constructor(U){super(U)}load(U,Y,ie,ne){this.path!==void 0&&(U=this.path+U),U=this.manager.resolveURL(U);const F=this,fe=Cache.get(U);if(fe!==void 0)return F.manager.itemStart(U),setTimeout(function(){Y&&Y(fe),F.manager.itemEnd(U)},0),fe;const pe=createElementNS("img");function Me(){se(),Cache.add(U,this),Y&&Y(this),F.manager.itemEnd(U)}function ve(me){se(),ne&&ne(me),F.manager.itemError(U),F.manager.itemEnd(U)}function se(){pe.removeEventListener("load",Me,!1),pe.removeEventListener("error",ve,!1)}return pe.addEventListener("load",Me,!1),pe.addEventListener("error",ve,!1),U.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(pe.crossOrigin=this.crossOrigin),F.manager.itemStart(U),pe.src=U,pe}}class DataTextureLoader extends Loader{constructor(U){super(U)}load(U,Y,ie,ne){const F=this,fe=new DataTexture,pe=new FileLoader(this.manager);return pe.setResponseType("arraybuffer"),pe.setRequestHeader(this.requestHeader),pe.setPath(this.path),pe.setWithCredentials(F.withCredentials),pe.load(U,function(Me){let ve;try{ve=F.parse(Me)}catch(se){if(ne!==void 0)ne(se);else{console.error(se);return}}ve.image!==void 0?fe.image=ve.image:ve.data!==void 0&&(fe.image.width=ve.width,fe.image.height=ve.height,fe.image.data=ve.data),fe.wrapS=ve.wrapS!==void 0?ve.wrapS:ClampToEdgeWrapping,fe.wrapT=ve.wrapT!==void 0?ve.wrapT:ClampToEdgeWrapping,fe.magFilter=ve.magFilter!==void 0?ve.magFilter:LinearFilter,fe.minFilter=ve.minFilter!==void 0?ve.minFilter:LinearFilter,fe.anisotropy=ve.anisotropy!==void 0?ve.anisotropy:1,ve.colorSpace!==void 0&&(fe.colorSpace=ve.colorSpace),ve.flipY!==void 0&&(fe.flipY=ve.flipY),ve.format!==void 0&&(fe.format=ve.format),ve.type!==void 0&&(fe.type=ve.type),ve.mipmaps!==void 0&&(fe.mipmaps=ve.mipmaps,fe.minFilter=LinearMipmapLinearFilter),ve.mipmapCount===1&&(fe.minFilter=LinearFilter),ve.generateMipmaps!==void 0&&(fe.generateMipmaps=ve.generateMipmaps),fe.needsUpdate=!0,Y&&Y(fe,ve)},ie,ne),fe}}class TextureLoader extends Loader{constructor(U){super(U)}load(U,Y,ie,ne){const F=new Texture$1,fe=new ImageLoader(this.manager);return fe.setCrossOrigin(this.crossOrigin),fe.setPath(this.path),fe.load(U,function(pe){F.image=pe,F.needsUpdate=!0,Y!==void 0&&Y(F)},ie,ne),F}}class Light extends Object3D{constructor(U,Y=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(U),this.intensity=Y}dispose(){}copy(U,Y){return super.copy(U,Y),this.color.copy(U.color),this.intensity=U.intensity,this}toJSON(U){const Y=super.toJSON(U);return Y.object.color=this.color.getHex(),Y.object.intensity=this.intensity,this.groundColor!==void 0&&(Y.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(Y.object.distance=this.distance),this.angle!==void 0&&(Y.object.angle=this.angle),this.decay!==void 0&&(Y.object.decay=this.decay),this.penumbra!==void 0&&(Y.object.penumbra=this.penumbra),this.shadow!==void 0&&(Y.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(Y.object.target=this.target.uuid),Y}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(U){this.camera=U,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(U){const Y=this.camera,ie=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(U.matrixWorld),Y.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(U.target.matrixWorld),Y.lookAt(_lookTarget$1),Y.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(Y.projectionMatrix,Y.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),ie.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ie.multiply(_projScreenMatrix$1)}getViewport(U){return this._viewports[U]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(U){return this.camera=U.camera.clone(),this.intensity=U.intensity,this.bias=U.bias,this.radius=U.radius,this.mapSize.copy(U.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const U={};return this.intensity!==1&&(U.intensity=this.intensity),this.bias!==0&&(U.bias=this.bias),this.normalBias!==0&&(U.normalBias=this.normalBias),this.radius!==1&&(U.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(U.mapSize=this.mapSize.toArray()),U.camera=this.camera.toJSON(!1).object,delete U.camera.matrix,U}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(U){const Y=this.camera,ie=RAD2DEG*2*U.angle*this.focus,ne=this.mapSize.width/this.mapSize.height,F=U.distance||Y.far;(ie!==Y.fov||ne!==Y.aspect||F!==Y.far)&&(Y.fov=ie,Y.aspect=ne,Y.far=F,Y.updateProjectionMatrix()),super.updateMatrices(U)}copy(U){return super.copy(U),this.focus=U.focus,this}}class SpotLight extends Light{constructor(U,Y,ie=0,ne=Math.PI/3,F=0,fe=2){super(U,Y),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=ie,this.angle=ne,this.penumbra=F,this.decay=fe,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(U){this.intensity=U/Math.PI}dispose(){this.shadow.dispose()}copy(U,Y){return super.copy(U,Y),this.distance=U.distance,this.angle=U.angle,this.penumbra=U.penumbra,this.decay=U.decay,this.target=U.target.clone(),this.shadow=U.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(U,Y=0){const ie=this.camera,ne=this.matrix,F=U.distance||ie.far;F!==ie.far&&(ie.far=F,ie.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(U.matrixWorld),ie.position.copy(_lightPositionWorld),_lookTarget.copy(ie.position),_lookTarget.add(this._cubeDirections[Y]),ie.up.copy(this._cubeUps[Y]),ie.lookAt(_lookTarget),ie.updateMatrixWorld(),ne.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(ie.projectionMatrix,ie.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(U,Y,ie=0,ne=2){super(U,Y),this.isPointLight=!0,this.type="PointLight",this.distance=ie,this.decay=ne,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(U){this.intensity=U/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(U,Y){return super.copy(U,Y),this.distance=U.distance,this.decay=U.decay,this.shadow=U.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(U,Y){super(U,Y),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(U){return super.copy(U),this.target=U.target.clone(),this.shadow=U.shadow.clone(),this}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let U=0;U<9;U++)this.coefficients.push(new Vector3)}set(U){for(let Y=0;Y<9;Y++)this.coefficients[Y].copy(U[Y]);return this}zero(){for(let U=0;U<9;U++)this.coefficients[U].set(0,0,0);return this}getAt(U,Y){const ie=U.x,ne=U.y,F=U.z,fe=this.coefficients;return Y.copy(fe[0]).multiplyScalar(.282095),Y.addScaledVector(fe[1],.488603*ne),Y.addScaledVector(fe[2],.488603*F),Y.addScaledVector(fe[3],.488603*ie),Y.addScaledVector(fe[4],1.092548*(ie*ne)),Y.addScaledVector(fe[5],1.092548*(ne*F)),Y.addScaledVector(fe[6],.315392*(3*F*F-1)),Y.addScaledVector(fe[7],1.092548*(ie*F)),Y.addScaledVector(fe[8],.546274*(ie*ie-ne*ne)),Y}getIrradianceAt(U,Y){const ie=U.x,ne=U.y,F=U.z,fe=this.coefficients;return Y.copy(fe[0]).multiplyScalar(.886227),Y.addScaledVector(fe[1],2*.511664*ne),Y.addScaledVector(fe[2],2*.511664*F),Y.addScaledVector(fe[3],2*.511664*ie),Y.addScaledVector(fe[4],2*.429043*ie*ne),Y.addScaledVector(fe[5],2*.429043*ne*F),Y.addScaledVector(fe[6],.743125*F*F-.247708),Y.addScaledVector(fe[7],2*.429043*ie*F),Y.addScaledVector(fe[8],.429043*(ie*ie-ne*ne)),Y}add(U){for(let Y=0;Y<9;Y++)this.coefficients[Y].add(U.coefficients[Y]);return this}addScaledSH(U,Y){for(let ie=0;ie<9;ie++)this.coefficients[ie].addScaledVector(U.coefficients[ie],Y);return this}scale(U){for(let Y=0;Y<9;Y++)this.coefficients[Y].multiplyScalar(U);return this}lerp(U,Y){for(let ie=0;ie<9;ie++)this.coefficients[ie].lerp(U.coefficients[ie],Y);return this}equals(U){for(let Y=0;Y<9;Y++)if(!this.coefficients[Y].equals(U.coefficients[Y]))return!1;return!0}copy(U){return this.set(U.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(U,Y=0){const ie=this.coefficients;for(let ne=0;ne<9;ne++)ie[ne].fromArray(U,Y+ne*3);return this}toArray(U=[],Y=0){const ie=this.coefficients;for(let ne=0;ne<9;ne++)ie[ne].toArray(U,Y+ne*3);return U}static getBasisAt(U,Y){const ie=U.x,ne=U.y,F=U.z;Y[0]=.282095,Y[1]=.488603*ne,Y[2]=.488603*F,Y[3]=.488603*ie,Y[4]=1.092548*ie*ne,Y[5]=1.092548*ne*F,Y[6]=.315392*(3*F*F-1),Y[7]=1.092548*ie*F,Y[8]=.546274*(ie*ie-ne*ne)}}class LightProbe extends Light{constructor(U=new SphericalHarmonics3,Y=1){super(void 0,Y),this.isLightProbe=!0,this.sh=U}copy(U){return super.copy(U),this.sh.copy(U.sh),this}fromJSON(U){return this.intensity=U.intensity,this.sh.fromArray(U.sh),this}toJSON(U){const Y=super.toJSON(U);return Y.object.sh=this.sh.toArray(),Y}}class LoaderUtils{static decodeText(U){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(U);let Y="";for(let ie=0,ne=U.length;ie<ne;ie++)Y+=String.fromCharCode(U[ie]);try{return decodeURIComponent(escape(Y))}catch{return Y}}static extractUrlBase(U){const Y=U.lastIndexOf("/");return Y===-1?"./":U.slice(0,Y+1)}static resolveURL(U,Y){return typeof U!="string"||U===""?"":(/^https?:\/\//i.test(Y)&&/^\//.test(U)&&(Y=Y.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(U)||/^data:.*,.*$/i.test(U)||/^blob:.*$/i.test(U)?U:Y+U)}}class ImageBitmapLoader extends Loader{constructor(U){super(U),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(U){return this.options=U,this}load(U,Y,ie,ne){U===void 0&&(U=""),this.path!==void 0&&(U=this.path+U),U=this.manager.resolveURL(U);const F=this,fe=Cache.get(U);if(fe!==void 0){if(F.manager.itemStart(U),fe.then){fe.then(ve=>{Y&&Y(ve),F.manager.itemEnd(U)}).catch(ve=>{ne&&ne(ve)});return}return setTimeout(function(){Y&&Y(fe),F.manager.itemEnd(U)},0),fe}const pe={};pe.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",pe.headers=this.requestHeader;const Me=fetch(U,pe).then(function(ve){return ve.blob()}).then(function(ve){return createImageBitmap(ve,Object.assign(F.options,{colorSpaceConversion:"none"}))}).then(function(ve){return Cache.add(U,ve),Y&&Y(ve),F.manager.itemEnd(U),ve}).catch(function(ve){ne&&ne(ve),Cache.remove(U),F.manager.itemError(U),F.manager.itemEnd(U)});Cache.add(U,Me),F.manager.itemStart(U)}}class PropertyMixer{constructor(U,Y,ie){this.binding=U,this.valueSize=ie;let ne,F,fe;switch(Y){case"quaternion":ne=this._slerp,F=this._slerpAdditive,fe=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(ie*6),this._workIndex=5;break;case"string":case"bool":ne=this._select,F=this._select,fe=this._setAdditiveIdentityOther,this.buffer=new Array(ie*5);break;default:ne=this._lerp,F=this._lerpAdditive,fe=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(ie*5)}this._mixBufferRegion=ne,this._mixBufferRegionAdditive=F,this._setIdentity=fe,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(U,Y){const ie=this.buffer,ne=this.valueSize,F=U*ne+ne;let fe=this.cumulativeWeight;if(fe===0){for(let pe=0;pe!==ne;++pe)ie[F+pe]=ie[pe];fe=Y}else{fe+=Y;const pe=Y/fe;this._mixBufferRegion(ie,F,0,pe,ne)}this.cumulativeWeight=fe}accumulateAdditive(U){const Y=this.buffer,ie=this.valueSize,ne=ie*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(Y,ne,0,U,ie),this.cumulativeWeightAdditive+=U}apply(U){const Y=this.valueSize,ie=this.buffer,ne=U*Y+Y,F=this.cumulativeWeight,fe=this.cumulativeWeightAdditive,pe=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,F<1){const Me=Y*this._origIndex;this._mixBufferRegion(ie,ne,Me,1-F,Y)}fe>0&&this._mixBufferRegionAdditive(ie,ne,this._addIndex*Y,1,Y);for(let Me=Y,ve=Y+Y;Me!==ve;++Me)if(ie[Me]!==ie[Me+Y]){pe.setValue(ie,ne);break}}saveOriginalState(){const U=this.binding,Y=this.buffer,ie=this.valueSize,ne=ie*this._origIndex;U.getValue(Y,ne);for(let F=ie,fe=ne;F!==fe;++F)Y[F]=Y[ne+F%ie];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const U=this.valueSize*3;this.binding.setValue(this.buffer,U)}_setAdditiveIdentityNumeric(){const U=this._addIndex*this.valueSize,Y=U+this.valueSize;for(let ie=U;ie<Y;ie++)this.buffer[ie]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const U=this._origIndex*this.valueSize,Y=this._addIndex*this.valueSize;for(let ie=0;ie<this.valueSize;ie++)this.buffer[Y+ie]=this.buffer[U+ie]}_select(U,Y,ie,ne,F){if(ne>=.5)for(let fe=0;fe!==F;++fe)U[Y+fe]=U[ie+fe]}_slerp(U,Y,ie,ne){Quaternion.slerpFlat(U,Y,U,Y,U,ie,ne)}_slerpAdditive(U,Y,ie,ne,F){const fe=this._workIndex*F;Quaternion.multiplyQuaternionsFlat(U,fe,U,Y,U,ie),Quaternion.slerpFlat(U,Y,U,Y,U,fe,ne)}_lerp(U,Y,ie,ne,F){const fe=1-ne;for(let pe=0;pe!==F;++pe){const Me=Y+pe;U[Me]=U[Me]*fe+U[ie+pe]*ne}}_lerpAdditive(U,Y,ie,ne,F){for(let fe=0;fe!==F;++fe){const pe=Y+fe;U[pe]=U[pe]+U[ie+fe]*ne}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(U,Y,ie){const ne=ie||PropertyBinding.parseTrackName(Y);this._targetGroup=U,this._bindings=U.subscribe_(Y,ne)}getValue(U,Y){this.bind();const ie=this._targetGroup.nCachedObjects_,ne=this._bindings[ie];ne!==void 0&&ne.getValue(U,Y)}setValue(U,Y){const ie=this._bindings;for(let ne=this._targetGroup.nCachedObjects_,F=ie.length;ne!==F;++ne)ie[ne].setValue(U,Y)}bind(){const U=this._bindings;for(let Y=this._targetGroup.nCachedObjects_,ie=U.length;Y!==ie;++Y)U[Y].bind()}unbind(){const U=this._bindings;for(let Y=this._targetGroup.nCachedObjects_,ie=U.length;Y!==ie;++Y)U[Y].unbind()}}class PropertyBinding{constructor(U,Y,ie){this.path=Y,this.parsedPath=ie||PropertyBinding.parseTrackName(Y),this.node=PropertyBinding.findNode(U,this.parsedPath.nodeName),this.rootNode=U,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(U,Y,ie){return U&&U.isAnimationObjectGroup?new PropertyBinding.Composite(U,Y,ie):new PropertyBinding(U,Y,ie)}static sanitizeNodeName(U){return U.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(U){const Y=_trackRe.exec(U);if(Y===null)throw new Error("PropertyBinding: Cannot parse trackName: "+U);const ie={nodeName:Y[2],objectName:Y[3],objectIndex:Y[4],propertyName:Y[5],propertyIndex:Y[6]},ne=ie.nodeName&&ie.nodeName.lastIndexOf(".");if(ne!==void 0&&ne!==-1){const F=ie.nodeName.substring(ne+1);_supportedObjectNames.indexOf(F)!==-1&&(ie.nodeName=ie.nodeName.substring(0,ne),ie.objectName=F)}if(ie.propertyName===null||ie.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+U);return ie}static findNode(U,Y){if(Y===void 0||Y===""||Y==="."||Y===-1||Y===U.name||Y===U.uuid)return U;if(U.skeleton){const ie=U.skeleton.getBoneByName(Y);if(ie!==void 0)return ie}if(U.children){const ie=function(F){for(let fe=0;fe<F.length;fe++){const pe=F[fe];if(pe.name===Y||pe.uuid===Y)return pe;const Me=ie(pe.children);if(Me)return Me}return null},ne=ie(U.children);if(ne)return ne}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(U,Y){U[Y]=this.targetObject[this.propertyName]}_getValue_array(U,Y){const ie=this.resolvedProperty;for(let ne=0,F=ie.length;ne!==F;++ne)U[Y++]=ie[ne]}_getValue_arrayElement(U,Y){U[Y]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(U,Y){this.resolvedProperty.toArray(U,Y)}_setValue_direct(U,Y){this.targetObject[this.propertyName]=U[Y]}_setValue_direct_setNeedsUpdate(U,Y){this.targetObject[this.propertyName]=U[Y],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(U,Y){this.targetObject[this.propertyName]=U[Y],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(U,Y){const ie=this.resolvedProperty;for(let ne=0,F=ie.length;ne!==F;++ne)ie[ne]=U[Y++]}_setValue_array_setNeedsUpdate(U,Y){const ie=this.resolvedProperty;for(let ne=0,F=ie.length;ne!==F;++ne)ie[ne]=U[Y++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(U,Y){const ie=this.resolvedProperty;for(let ne=0,F=ie.length;ne!==F;++ne)ie[ne]=U[Y++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(U,Y){this.resolvedProperty[this.propertyIndex]=U[Y]}_setValue_arrayElement_setNeedsUpdate(U,Y){this.resolvedProperty[this.propertyIndex]=U[Y],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(U,Y){this.resolvedProperty[this.propertyIndex]=U[Y],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(U,Y){this.resolvedProperty.fromArray(U,Y)}_setValue_fromArray_setNeedsUpdate(U,Y){this.resolvedProperty.fromArray(U,Y),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(U,Y){this.resolvedProperty.fromArray(U,Y),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(U,Y){this.bind(),this.getValue(U,Y)}_setValue_unbound(U,Y){this.bind(),this.setValue(U,Y)}bind(){let U=this.node;const Y=this.parsedPath,ie=Y.objectName,ne=Y.propertyName;let F=Y.propertyIndex;if(U||(U=PropertyBinding.findNode(this.rootNode,Y.nodeName),this.node=U),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!U){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(ie){let ve=Y.objectIndex;switch(ie){case"materials":if(!U.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!U.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}U=U.material.materials;break;case"bones":if(!U.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}U=U.skeleton.bones;for(let se=0;se<U.length;se++)if(U[se].name===ve){ve=se;break}break;case"map":if("map"in U){U=U.map;break}if(!U.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!U.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}U=U.material.map;break;default:if(U[ie]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}U=U[ie]}if(ve!==void 0){if(U[ve]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,U);return}U=U[ve]}}const fe=U[ne];if(fe===void 0){const ve=Y.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+ve+"."+ne+" but it wasn't found.",U);return}let pe=this.Versioning.None;this.targetObject=U,U.needsUpdate!==void 0?pe=this.Versioning.NeedsUpdate:U.matrixWorldNeedsUpdate!==void 0&&(pe=this.Versioning.MatrixWorldNeedsUpdate);let Me=this.BindingType.Direct;if(F!==void 0){if(ne==="morphTargetInfluences"){if(!U.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!U.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}U.morphTargetDictionary[F]!==void 0&&(F=U.morphTargetDictionary[F])}Me=this.BindingType.ArrayElement,this.resolvedProperty=fe,this.propertyIndex=F}else fe.fromArray!==void 0&&fe.toArray!==void 0?(Me=this.BindingType.HasFromToArray,this.resolvedProperty=fe):Array.isArray(fe)?(Me=this.BindingType.EntireArray,this.resolvedProperty=fe):this.propertyName=ne;this.getValue=this.GetterByBindingType[Me],this.setValue=this.SetterByBindingTypeAndVersioning[Me][pe]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationAction{constructor(U,Y,ie=null,ne=Y.blendMode){this._mixer=U,this._clip=Y,this._localRoot=ie,this.blendMode=ne;const F=Y.tracks,fe=F.length,pe=new Array(fe),Me={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let ve=0;ve!==fe;++ve){const se=F[ve].createInterpolant(null);pe[ve]=se,se.settings=Me}this._interpolantSettings=Me,this._interpolants=pe,this._propertyBindings=new Array(fe),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(U){return this._startTime=U,this}setLoop(U,Y){return this.loop=U,this.repetitions=Y,this}setEffectiveWeight(U){return this.weight=U,this._effectiveWeight=this.enabled?U:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(U){return this._scheduleFading(U,0,1)}fadeOut(U){return this._scheduleFading(U,1,0)}crossFadeFrom(U,Y,ie){if(U.fadeOut(Y),this.fadeIn(Y),ie){const ne=this._clip.duration,F=U._clip.duration,fe=F/ne,pe=ne/F;U.warp(1,fe,Y),this.warp(pe,1,Y)}return this}crossFadeTo(U,Y,ie){return U.crossFadeFrom(this,Y,ie)}stopFading(){const U=this._weightInterpolant;return U!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(U)),this}setEffectiveTimeScale(U){return this.timeScale=U,this._effectiveTimeScale=this.paused?0:U,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(U){return this.timeScale=this._clip.duration/U,this.stopWarping()}syncWith(U){return this.time=U.time,this.timeScale=U.timeScale,this.stopWarping()}halt(U){return this.warp(this._effectiveTimeScale,0,U)}warp(U,Y,ie){const ne=this._mixer,F=ne.time,fe=this.timeScale;let pe=this._timeScaleInterpolant;pe===null&&(pe=ne._lendControlInterpolant(),this._timeScaleInterpolant=pe);const Me=pe.parameterPositions,ve=pe.sampleValues;return Me[0]=F,Me[1]=F+ie,ve[0]=U/fe,ve[1]=Y/fe,this}stopWarping(){const U=this._timeScaleInterpolant;return U!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(U)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(U,Y,ie,ne){if(!this.enabled){this._updateWeight(U);return}const F=this._startTime;if(F!==null){const Me=(U-F)*ie;Me<0||ie===0?Y=0:(this._startTime=null,Y=ie*Me)}Y*=this._updateTimeScale(U);const fe=this._updateTime(Y),pe=this._updateWeight(U);if(pe>0){const Me=this._interpolants,ve=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let se=0,me=Me.length;se!==me;++se)Me[se].evaluate(fe),ve[se].accumulateAdditive(pe);break;case NormalAnimationBlendMode:default:for(let se=0,me=Me.length;se!==me;++se)Me[se].evaluate(fe),ve[se].accumulate(ne,pe)}}}_updateWeight(U){let Y=0;if(this.enabled){Y=this.weight;const ie=this._weightInterpolant;if(ie!==null){const ne=ie.evaluate(U)[0];Y*=ne,U>ie.parameterPositions[1]&&(this.stopFading(),ne===0&&(this.enabled=!1))}}return this._effectiveWeight=Y,Y}_updateTimeScale(U){let Y=0;if(!this.paused){Y=this.timeScale;const ie=this._timeScaleInterpolant;if(ie!==null){const ne=ie.evaluate(U)[0];Y*=ne,U>ie.parameterPositions[1]&&(this.stopWarping(),Y===0?this.paused=!0:this.timeScale=Y)}}return this._effectiveTimeScale=Y,Y}_updateTime(U){const Y=this._clip.duration,ie=this.loop;let ne=this.time+U,F=this._loopCount;const fe=ie===LoopPingPong;if(U===0)return F===-1?ne:fe&&(F&1)===1?Y-ne:ne;if(ie===LoopOnce){F===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(ne>=Y)ne=Y;else if(ne<0)ne=0;else{this.time=ne;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=ne,this._mixer.dispatchEvent({type:"finished",action:this,direction:U<0?-1:1})}}else{if(F===-1&&(U>=0?(F=0,this._setEndings(!0,this.repetitions===0,fe)):this._setEndings(this.repetitions===0,!0,fe)),ne>=Y||ne<0){const pe=Math.floor(ne/Y);ne-=Y*pe,F+=Math.abs(pe);const Me=this.repetitions-F;if(Me<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,ne=U>0?Y:0,this.time=ne,this._mixer.dispatchEvent({type:"finished",action:this,direction:U>0?1:-1});else{if(Me===1){const ve=U<0;this._setEndings(ve,!ve,fe)}else this._setEndings(!1,!1,fe);this._loopCount=F,this.time=ne,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:pe})}}else this.time=ne;if(fe&&(F&1)===1)return Y-ne}return ne}_setEndings(U,Y,ie){const ne=this._interpolantSettings;ie?(ne.endingStart=ZeroSlopeEnding,ne.endingEnd=ZeroSlopeEnding):(U?ne.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:ne.endingStart=WrapAroundEnding,Y?ne.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:ne.endingEnd=WrapAroundEnding)}_scheduleFading(U,Y,ie){const ne=this._mixer,F=ne.time;let fe=this._weightInterpolant;fe===null&&(fe=ne._lendControlInterpolant(),this._weightInterpolant=fe);const pe=fe.parameterPositions,Me=fe.sampleValues;return pe[0]=F,Me[0]=Y,pe[1]=F+U,Me[1]=ie,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(U){super(),this._root=U,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(U,Y){const ie=U._localRoot||this._root,ne=U._clip.tracks,F=ne.length,fe=U._propertyBindings,pe=U._interpolants,Me=ie.uuid,ve=this._bindingsByRootAndName;let se=ve[Me];se===void 0&&(se={},ve[Me]=se);for(let me=0;me!==F;++me){const Te=ne[me],Re=Te.name;let be=se[Re];if(be!==void 0)++be.referenceCount,fe[me]=be;else{if(be=fe[me],be!==void 0){be._cacheIndex===null&&(++be.referenceCount,this._addInactiveBinding(be,Me,Re));continue}const Pe=Y&&Y._propertyBindings[me].binding.parsedPath;be=new PropertyMixer(PropertyBinding.create(ie,Re,Pe),Te.ValueTypeName,Te.getValueSize()),++be.referenceCount,this._addInactiveBinding(be,Me,Re),fe[me]=be}pe[me].resultBuffer=be.buffer}}_activateAction(U){if(!this._isActiveAction(U)){if(U._cacheIndex===null){const ie=(U._localRoot||this._root).uuid,ne=U._clip.uuid,F=this._actionsByClip[ne];this._bindAction(U,F&&F.knownActions[0]),this._addInactiveAction(U,ne,ie)}const Y=U._propertyBindings;for(let ie=0,ne=Y.length;ie!==ne;++ie){const F=Y[ie];F.useCount++===0&&(this._lendBinding(F),F.saveOriginalState())}this._lendAction(U)}}_deactivateAction(U){if(this._isActiveAction(U)){const Y=U._propertyBindings;for(let ie=0,ne=Y.length;ie!==ne;++ie){const F=Y[ie];--F.useCount===0&&(F.restoreOriginalState(),this._takeBackBinding(F))}this._takeBackAction(U)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const U=this;this.stats={actions:{get total(){return U._actions.length},get inUse(){return U._nActiveActions}},bindings:{get total(){return U._bindings.length},get inUse(){return U._nActiveBindings}},controlInterpolants:{get total(){return U._controlInterpolants.length},get inUse(){return U._nActiveControlInterpolants}}}}_isActiveAction(U){const Y=U._cacheIndex;return Y!==null&&Y<this._nActiveActions}_addInactiveAction(U,Y,ie){const ne=this._actions,F=this._actionsByClip;let fe=F[Y];if(fe===void 0)fe={knownActions:[U],actionByRoot:{}},U._byClipCacheIndex=0,F[Y]=fe;else{const pe=fe.knownActions;U._byClipCacheIndex=pe.length,pe.push(U)}U._cacheIndex=ne.length,ne.push(U),fe.actionByRoot[ie]=U}_removeInactiveAction(U){const Y=this._actions,ie=Y[Y.length-1],ne=U._cacheIndex;ie._cacheIndex=ne,Y[ne]=ie,Y.pop(),U._cacheIndex=null;const F=U._clip.uuid,fe=this._actionsByClip,pe=fe[F],Me=pe.knownActions,ve=Me[Me.length-1],se=U._byClipCacheIndex;ve._byClipCacheIndex=se,Me[se]=ve,Me.pop(),U._byClipCacheIndex=null;const me=pe.actionByRoot,Te=(U._localRoot||this._root).uuid;delete me[Te],Me.length===0&&delete fe[F],this._removeInactiveBindingsForAction(U)}_removeInactiveBindingsForAction(U){const Y=U._propertyBindings;for(let ie=0,ne=Y.length;ie!==ne;++ie){const F=Y[ie];--F.referenceCount===0&&this._removeInactiveBinding(F)}}_lendAction(U){const Y=this._actions,ie=U._cacheIndex,ne=this._nActiveActions++,F=Y[ne];U._cacheIndex=ne,Y[ne]=U,F._cacheIndex=ie,Y[ie]=F}_takeBackAction(U){const Y=this._actions,ie=U._cacheIndex,ne=--this._nActiveActions,F=Y[ne];U._cacheIndex=ne,Y[ne]=U,F._cacheIndex=ie,Y[ie]=F}_addInactiveBinding(U,Y,ie){const ne=this._bindingsByRootAndName,F=this._bindings;let fe=ne[Y];fe===void 0&&(fe={},ne[Y]=fe),fe[ie]=U,U._cacheIndex=F.length,F.push(U)}_removeInactiveBinding(U){const Y=this._bindings,ie=U.binding,ne=ie.rootNode.uuid,F=ie.path,fe=this._bindingsByRootAndName,pe=fe[ne],Me=Y[Y.length-1],ve=U._cacheIndex;Me._cacheIndex=ve,Y[ve]=Me,Y.pop(),delete pe[F],Object.keys(pe).length===0&&delete fe[ne]}_lendBinding(U){const Y=this._bindings,ie=U._cacheIndex,ne=this._nActiveBindings++,F=Y[ne];U._cacheIndex=ne,Y[ne]=U,F._cacheIndex=ie,Y[ie]=F}_takeBackBinding(U){const Y=this._bindings,ie=U._cacheIndex,ne=--this._nActiveBindings,F=Y[ne];U._cacheIndex=ne,Y[ne]=U,F._cacheIndex=ie,Y[ie]=F}_lendControlInterpolant(){const U=this._controlInterpolants,Y=this._nActiveControlInterpolants++;let ie=U[Y];return ie===void 0&&(ie=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),ie.__cacheIndex=Y,U[Y]=ie),ie}_takeBackControlInterpolant(U){const Y=this._controlInterpolants,ie=U.__cacheIndex,ne=--this._nActiveControlInterpolants,F=Y[ne];U.__cacheIndex=ne,Y[ne]=U,F.__cacheIndex=ie,Y[ie]=F}clipAction(U,Y,ie){const ne=Y||this._root,F=ne.uuid;let fe=typeof U=="string"?AnimationClip.findByName(ne,U):U;const pe=fe!==null?fe.uuid:U,Me=this._actionsByClip[pe];let ve=null;if(ie===void 0&&(fe!==null?ie=fe.blendMode:ie=NormalAnimationBlendMode),Me!==void 0){const me=Me.actionByRoot[F];if(me!==void 0&&me.blendMode===ie)return me;ve=Me.knownActions[0],fe===null&&(fe=ve._clip)}if(fe===null)return null;const se=new AnimationAction(this,fe,Y,ie);return this._bindAction(se,ve),this._addInactiveAction(se,pe,F),se}existingAction(U,Y){const ie=Y||this._root,ne=ie.uuid,F=typeof U=="string"?AnimationClip.findByName(ie,U):U,fe=F?F.uuid:U,pe=this._actionsByClip[fe];return pe!==void 0&&pe.actionByRoot[ne]||null}stopAllAction(){const U=this._actions,Y=this._nActiveActions;for(let ie=Y-1;ie>=0;--ie)U[ie].stop();return this}update(U){U*=this.timeScale;const Y=this._actions,ie=this._nActiveActions,ne=this.time+=U,F=Math.sign(U),fe=this._accuIndex^=1;for(let ve=0;ve!==ie;++ve)Y[ve]._update(ne,U,F,fe);const pe=this._bindings,Me=this._nActiveBindings;for(let ve=0;ve!==Me;++ve)pe[ve].apply(fe);return this}setTime(U){this.time=0;for(let Y=0;Y<this._actions.length;Y++)this._actions[Y].time=0;return this.update(U)}getRoot(){return this._root}uncacheClip(U){const Y=this._actions,ie=U.uuid,ne=this._actionsByClip,F=ne[ie];if(F!==void 0){const fe=F.knownActions;for(let pe=0,Me=fe.length;pe!==Me;++pe){const ve=fe[pe];this._deactivateAction(ve);const se=ve._cacheIndex,me=Y[Y.length-1];ve._cacheIndex=null,ve._byClipCacheIndex=null,me._cacheIndex=se,Y[se]=me,Y.pop(),this._removeInactiveBindingsForAction(ve)}delete ne[ie]}}uncacheRoot(U){const Y=U.uuid,ie=this._actionsByClip;for(const fe in ie){const pe=ie[fe].actionByRoot,Me=pe[Y];Me!==void 0&&(this._deactivateAction(Me),this._removeInactiveAction(Me))}const ne=this._bindingsByRootAndName,F=ne[Y];if(F!==void 0)for(const fe in F){const pe=F[fe];pe.restoreOriginalState(),this._removeInactiveBinding(pe)}}uncacheAction(U,Y){const ie=this.existingAction(U,Y);ie!==null&&(this._deactivateAction(ie),this._removeInactiveAction(ie))}}class Uniform{constructor(U){this.value=U}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}const _matrix=new Matrix4;class Raycaster{constructor(U,Y,ie=0,ne=1/0){this.ray=new Ray(U,Y),this.near=ie,this.far=ne,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(U,Y){this.ray.set(U,Y)}setFromCamera(U,Y){Y.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(Y.matrixWorld),this.ray.direction.set(U.x,U.y,.5).unproject(Y).sub(this.ray.origin).normalize(),this.camera=Y):Y.isOrthographicCamera?(this.ray.origin.set(U.x,U.y,(Y.near+Y.far)/(Y.near-Y.far)).unproject(Y),this.ray.direction.set(0,0,-1).transformDirection(Y.matrixWorld),this.camera=Y):console.error("THREE.Raycaster: Unsupported camera type: "+Y.type)}setFromXRController(U){return _matrix.identity().extractRotation(U.matrixWorld),this.ray.origin.setFromMatrixPosition(U.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_matrix),this}intersectObject(U,Y=!0,ie=[]){return intersect(U,this,ie,Y),ie.sort(ascSort),ie}intersectObjects(U,Y=!0,ie=[]){for(let ne=0,F=U.length;ne<F;ne++)intersect(U[ne],this,ie,Y);return ie.sort(ascSort),ie}}function ascSort(re,U){return re.distance-U.distance}function intersect(re,U,Y,ie){let ne=!0;if(re.layers.test(U.layers)&&re.raycast(U,Y)===!1&&(ne=!1),ne===!0&&ie===!0){const F=re.children;for(let fe=0,pe=F.length;fe<pe;fe++)intersect(F[fe],U,Y,!0)}}class Spherical{constructor(U=1,Y=0,ie=0){return this.radius=U,this.phi=Y,this.theta=ie,this}set(U,Y,ie){return this.radius=U,this.phi=Y,this.theta=ie,this}copy(U){return this.radius=U.radius,this.phi=U.phi,this.theta=U.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(U){return this.setFromCartesianCoords(U.x,U.y,U.z)}setFromCartesianCoords(U,Y,ie){return this.radius=Math.sqrt(U*U+Y*Y+ie*ie),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(U,ie),this.phi=Math.acos(clamp$1(Y/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$2=window,e$2=t$2.ShadowRoot&&(t$2.ShadyCSS===void 0||t$2.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$3=Symbol(),n$4=new WeakMap;let o$3=class{constructor(U,Y,ie){if(this._$cssResult$=!0,ie!==s$3)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=U,this.t=Y}get styleSheet(){let U=this.o;const Y=this.t;if(e$2&&U===void 0){const ie=Y!==void 0&&Y.length===1;ie&&(U=n$4.get(Y)),U===void 0&&((this.o=U=new CSSStyleSheet).replaceSync(this.cssText),ie&&n$4.set(Y,U))}return U}toString(){return this.cssText}};const r$2=re=>new o$3(typeof re=="string"?re:re+"",void 0,s$3),S$1=(re,U)=>{e$2?re.adoptedStyleSheets=U.map(Y=>Y instanceof CSSStyleSheet?Y:Y.styleSheet):U.forEach(Y=>{const ie=document.createElement("style"),ne=t$2.litNonce;ne!==void 0&&ie.setAttribute("nonce",ne),ie.textContent=Y.cssText,re.appendChild(ie)})},c$2=e$2?re=>re:re=>re instanceof CSSStyleSheet?(U=>{let Y="";for(const ie of U.cssRules)Y+=ie.cssText;return r$2(Y)})(re):re;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var s$2;const e$1=window,r$1=e$1.trustedTypes,h$1=r$1?r$1.emptyScript:"",o$2=e$1.reactiveElementPolyfillSupport,n$3={toAttribute(re,U){switch(U){case Boolean:re=re?h$1:null;break;case Object:case Array:re=re==null?re:JSON.stringify(re)}return re},fromAttribute(re,U){let Y=re;switch(U){case Boolean:Y=re!==null;break;case Number:Y=re===null?null:Number(re);break;case Object:case Array:try{Y=JSON.parse(re)}catch{Y=null}}return Y}},a$2=(re,U)=>U!==re&&(U==U||re==re),l$2={attribute:!0,type:String,converter:n$3,reflect:!1,hasChanged:a$2},d$1="finalized";let u$2=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(U){var Y;this.finalize(),((Y=this.h)!==null&&Y!==void 0?Y:this.h=[]).push(U)}static get observedAttributes(){this.finalize();const U=[];return this.elementProperties.forEach((Y,ie)=>{const ne=this._$Ep(ie,Y);ne!==void 0&&(this._$Ev.set(ne,ie),U.push(ne))}),U}static createProperty(U,Y=l$2){if(Y.state&&(Y.attribute=!1),this.finalize(),this.elementProperties.set(U,Y),!Y.noAccessor&&!this.prototype.hasOwnProperty(U)){const ie=typeof U=="symbol"?Symbol():"__"+U,ne=this.getPropertyDescriptor(U,ie,Y);ne!==void 0&&Object.defineProperty(this.prototype,U,ne)}}static getPropertyDescriptor(U,Y,ie){return{get(){return this[Y]},set(ne){const F=this[U];this[Y]=ne,this.requestUpdate(U,F,ie)},configurable:!0,enumerable:!0}}static getPropertyOptions(U){return this.elementProperties.get(U)||l$2}static finalize(){if(this.hasOwnProperty(d$1))return!1;this[d$1]=!0;const U=Object.getPrototypeOf(this);if(U.finalize(),U.h!==void 0&&(this.h=[...U.h]),this.elementProperties=new Map(U.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const Y=this.properties,ie=[...Object.getOwnPropertyNames(Y),...Object.getOwnPropertySymbols(Y)];for(const ne of ie)this.createProperty(ne,Y[ne])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(U){const Y=[];if(Array.isArray(U)){const ie=new Set(U.flat(1/0).reverse());for(const ne of ie)Y.unshift(c$2(ne))}else U!==void 0&&Y.push(c$2(U));return Y}static _$Ep(U,Y){const ie=Y.attribute;return ie===!1?void 0:typeof ie=="string"?ie:typeof U=="string"?U.toLowerCase():void 0}_$Eu(){var U;this._$E_=new Promise(Y=>this.enableUpdating=Y),this._$AL=new Map,this._$Eg(),this.requestUpdate(),(U=this.constructor.h)===null||U===void 0||U.forEach(Y=>Y(this))}addController(U){var Y,ie;((Y=this._$ES)!==null&&Y!==void 0?Y:this._$ES=[]).push(U),this.renderRoot!==void 0&&this.isConnected&&((ie=U.hostConnected)===null||ie===void 0||ie.call(U))}removeController(U){var Y;(Y=this._$ES)===null||Y===void 0||Y.splice(this._$ES.indexOf(U)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach((U,Y)=>{this.hasOwnProperty(Y)&&(this._$Ei.set(Y,this[Y]),delete this[Y])})}createRenderRoot(){var U;const Y=(U=this.shadowRoot)!==null&&U!==void 0?U:this.attachShadow(this.constructor.shadowRootOptions);return S$1(Y,this.constructor.elementStyles),Y}connectedCallback(){var U;this.renderRoot===void 0&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(U=this._$ES)===null||U===void 0||U.forEach(Y=>{var ie;return(ie=Y.hostConnected)===null||ie===void 0?void 0:ie.call(Y)})}enableUpdating(U){}disconnectedCallback(){var U;(U=this._$ES)===null||U===void 0||U.forEach(Y=>{var ie;return(ie=Y.hostDisconnected)===null||ie===void 0?void 0:ie.call(Y)})}attributeChangedCallback(U,Y,ie){this._$AK(U,ie)}_$EO(U,Y,ie=l$2){var ne;const F=this.constructor._$Ep(U,ie);if(F!==void 0&&ie.reflect===!0){const fe=(((ne=ie.converter)===null||ne===void 0?void 0:ne.toAttribute)!==void 0?ie.converter:n$3).toAttribute(Y,ie.type);this._$El=U,fe==null?this.removeAttribute(F):this.setAttribute(F,fe),this._$El=null}}_$AK(U,Y){var ie;const ne=this.constructor,F=ne._$Ev.get(U);if(F!==void 0&&this._$El!==F){const fe=ne.getPropertyOptions(F),pe=typeof fe.converter=="function"?{fromAttribute:fe.converter}:((ie=fe.converter)===null||ie===void 0?void 0:ie.fromAttribute)!==void 0?fe.converter:n$3;this._$El=F,this[F]=pe.fromAttribute(Y,fe.type),this._$El=null}}requestUpdate(U,Y,ie){let ne=!0;U!==void 0&&(((ie=ie||this.constructor.getPropertyOptions(U)).hasChanged||a$2)(this[U],Y)?(this._$AL.has(U)||this._$AL.set(U,Y),ie.reflect===!0&&this._$El!==U&&(this._$EC===void 0&&(this._$EC=new Map),this._$EC.set(U,ie))):ne=!1),!this.isUpdatePending&&ne&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(Y){Promise.reject(Y)}const U=this.scheduleUpdate();return U!=null&&await U,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var U;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach((ne,F)=>this[F]=ne),this._$Ei=void 0);let Y=!1;const ie=this._$AL;try{Y=this.shouldUpdate(ie),Y?(this.willUpdate(ie),(U=this._$ES)===null||U===void 0||U.forEach(ne=>{var F;return(F=ne.hostUpdate)===null||F===void 0?void 0:F.call(ne)}),this.update(ie)):this._$Ek()}catch(ne){throw Y=!1,this._$Ek(),ne}Y&&this._$AE(ie)}willUpdate(U){}_$AE(U){var Y;(Y=this._$ES)===null||Y===void 0||Y.forEach(ie=>{var ne;return(ne=ie.hostUpdated)===null||ne===void 0?void 0:ne.call(ie)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(U)),this.updated(U)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(U){return!0}update(U){this._$EC!==void 0&&(this._$EC.forEach((Y,ie)=>this._$EO(ie,this[ie],Y)),this._$EC=void 0),this._$Ek()}updated(U){}firstUpdated(U){}};u$2[d$1]=!0,u$2.elementProperties=new Map,u$2.elementStyles=[],u$2.shadowRootOptions={mode:"open"},o$2==null||o$2({ReactiveElement:u$2}),((s$2=e$1.reactiveElementVersions)!==null&&s$2!==void 0?s$2:e$1.reactiveElementVersions=[]).push("1.6.3");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var t$1;const i$1=window,s$1=i$1.trustedTypes,e=s$1?s$1.createPolicy("lit-html",{createHTML:re=>re}):void 0,o$1="$lit$",n$2=`lit$${(Math.random()+"").slice(9)}$`,l$1="?"+n$2,h=`<${l$1}>`,r=document,u$1=()=>r.createComment(""),d=re=>re===null||typeof re!="object"&&typeof re!="function",c$1=Array.isArray,v=re=>c$1(re)||typeof(re==null?void 0:re[Symbol.iterator])=="function",a$1=`[ 	
\f\r]`,f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,_=/-->/g,m=/>/g,p=RegExp(`>|${a$1}(?:([^\\s"'>=/]+)(${a$1}*=${a$1}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),g$2=/'/g,$=/"/g,y=/^(?:script|style|textarea|title)$/i,w=re=>(U,...Y)=>({_$litType$:re,strings:U,values:Y}),x$1=w(1),T$1=Symbol.for("lit-noChange"),A$1=Symbol.for("lit-nothing"),E=new WeakMap,C$2=r.createTreeWalker(r,129,null,!1);function P(re,U){if(!Array.isArray(re)||!re.hasOwnProperty("raw"))throw Error("invalid template strings array");return e!==void 0?e.createHTML(U):U}const V=(re,U)=>{const Y=re.length-1,ie=[];let ne,F=U===2?"<svg>":"",fe=f;for(let pe=0;pe<Y;pe++){const Me=re[pe];let ve,se,me=-1,Te=0;for(;Te<Me.length&&(fe.lastIndex=Te,se=fe.exec(Me),se!==null);)Te=fe.lastIndex,fe===f?se[1]==="!--"?fe=_:se[1]!==void 0?fe=m:se[2]!==void 0?(y.test(se[2])&&(ne=RegExp("</"+se[2],"g")),fe=p):se[3]!==void 0&&(fe=p):fe===p?se[0]===">"?(fe=ne??f,me=-1):se[1]===void 0?me=-2:(me=fe.lastIndex-se[2].length,ve=se[1],fe=se[3]===void 0?p:se[3]==='"'?$:g$2):fe===$||fe===g$2?fe=p:fe===_||fe===m?fe=f:(fe=p,ne=void 0);const Re=fe===p&&re[pe+1].startsWith("/>")?" ":"";F+=fe===f?Me+h:me>=0?(ie.push(ve),Me.slice(0,me)+o$1+Me.slice(me)+n$2+Re):Me+n$2+(me===-2?(ie.push(void 0),pe):Re)}return[P(re,F+(re[Y]||"<?>")+(U===2?"</svg>":"")),ie]};class N{constructor({strings:U,_$litType$:Y},ie){let ne;this.parts=[];let F=0,fe=0;const pe=U.length-1,Me=this.parts,[ve,se]=V(U,Y);if(this.el=N.createElement(ve,ie),C$2.currentNode=this.el.content,Y===2){const me=this.el.content,Te=me.firstChild;Te.remove(),me.append(...Te.childNodes)}for(;(ne=C$2.nextNode())!==null&&Me.length<pe;){if(ne.nodeType===1){if(ne.hasAttributes()){const me=[];for(const Te of ne.getAttributeNames())if(Te.endsWith(o$1)||Te.startsWith(n$2)){const Re=se[fe++];if(me.push(Te),Re!==void 0){const be=ne.getAttribute(Re.toLowerCase()+o$1).split(n$2),Pe=/([.?@])?(.*)/.exec(Re);Me.push({type:1,index:F,name:Pe[2],strings:be,ctor:Pe[1]==="."?H:Pe[1]==="?"?L:Pe[1]==="@"?z:k})}else Me.push({type:6,index:F})}for(const Te of me)ne.removeAttribute(Te)}if(y.test(ne.tagName)){const me=ne.textContent.split(n$2),Te=me.length-1;if(Te>0){ne.textContent=s$1?s$1.emptyScript:"";for(let Re=0;Re<Te;Re++)ne.append(me[Re],u$1()),C$2.nextNode(),Me.push({type:2,index:++F});ne.append(me[Te],u$1())}}}else if(ne.nodeType===8)if(ne.data===l$1)Me.push({type:2,index:F});else{let me=-1;for(;(me=ne.data.indexOf(n$2,me+1))!==-1;)Me.push({type:7,index:F}),me+=n$2.length-1}F++}}static createElement(U,Y){const ie=r.createElement("template");return ie.innerHTML=U,ie}}function S(re,U,Y=re,ie){var ne,F,fe,pe;if(U===T$1)return U;let Me=ie!==void 0?(ne=Y._$Co)===null||ne===void 0?void 0:ne[ie]:Y._$Cl;const ve=d(U)?void 0:U._$litDirective$;return(Me==null?void 0:Me.constructor)!==ve&&((F=Me==null?void 0:Me._$AO)===null||F===void 0||F.call(Me,!1),ve===void 0?Me=void 0:(Me=new ve(re),Me._$AT(re,Y,ie)),ie!==void 0?((fe=(pe=Y)._$Co)!==null&&fe!==void 0?fe:pe._$Co=[])[ie]=Me:Y._$Cl=Me),Me!==void 0&&(U=S(re,Me._$AS(re,U.values),Me,ie)),U}class M{constructor(U,Y){this._$AV=[],this._$AN=void 0,this._$AD=U,this._$AM=Y}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(U){var Y;const{el:{content:ie},parts:ne}=this._$AD,F=((Y=U==null?void 0:U.creationScope)!==null&&Y!==void 0?Y:r).importNode(ie,!0);C$2.currentNode=F;let fe=C$2.nextNode(),pe=0,Me=0,ve=ne[0];for(;ve!==void 0;){if(pe===ve.index){let se;ve.type===2?se=new R$1(fe,fe.nextSibling,this,U):ve.type===1?se=new ve.ctor(fe,ve.name,ve.strings,this,U):ve.type===6&&(se=new Z(fe,this,U)),this._$AV.push(se),ve=ne[++Me]}pe!==(ve==null?void 0:ve.index)&&(fe=C$2.nextNode(),pe++)}return C$2.currentNode=r,F}v(U){let Y=0;for(const ie of this._$AV)ie!==void 0&&(ie.strings!==void 0?(ie._$AI(U,ie,Y),Y+=ie.strings.length-2):ie._$AI(U[Y])),Y++}}let R$1=class Og{constructor(U,Y,ie,ne){var F;this.type=2,this._$AH=A$1,this._$AN=void 0,this._$AA=U,this._$AB=Y,this._$AM=ie,this.options=ne,this._$Cp=(F=ne==null?void 0:ne.isConnected)===null||F===void 0||F}get _$AU(){var U,Y;return(Y=(U=this._$AM)===null||U===void 0?void 0:U._$AU)!==null&&Y!==void 0?Y:this._$Cp}get parentNode(){let U=this._$AA.parentNode;const Y=this._$AM;return Y!==void 0&&(U==null?void 0:U.nodeType)===11&&(U=Y.parentNode),U}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(U,Y=this){U=S(this,U,Y),d(U)?U===A$1||U==null||U===""?(this._$AH!==A$1&&this._$AR(),this._$AH=A$1):U!==this._$AH&&U!==T$1&&this._(U):U._$litType$!==void 0?this.g(U):U.nodeType!==void 0?this.$(U):v(U)?this.T(U):this._(U)}k(U){return this._$AA.parentNode.insertBefore(U,this._$AB)}$(U){this._$AH!==U&&(this._$AR(),this._$AH=this.k(U))}_(U){this._$AH!==A$1&&d(this._$AH)?this._$AA.nextSibling.data=U:this.$(r.createTextNode(U)),this._$AH=U}g(U){var Y;const{values:ie,_$litType$:ne}=U,F=typeof ne=="number"?this._$AC(U):(ne.el===void 0&&(ne.el=N.createElement(P(ne.h,ne.h[0]),this.options)),ne);if(((Y=this._$AH)===null||Y===void 0?void 0:Y._$AD)===F)this._$AH.v(ie);else{const fe=new M(F,this),pe=fe.u(this.options);fe.v(ie),this.$(pe),this._$AH=fe}}_$AC(U){let Y=E.get(U.strings);return Y===void 0&&E.set(U.strings,Y=new N(U)),Y}T(U){c$1(this._$AH)||(this._$AH=[],this._$AR());const Y=this._$AH;let ie,ne=0;for(const F of U)ne===Y.length?Y.push(ie=new Og(this.k(u$1()),this.k(u$1()),this,this.options)):ie=Y[ne],ie._$AI(F),ne++;ne<Y.length&&(this._$AR(ie&&ie._$AB.nextSibling,ne),Y.length=ne)}_$AR(U=this._$AA.nextSibling,Y){var ie;for((ie=this._$AP)===null||ie===void 0||ie.call(this,!1,!0,Y);U&&U!==this._$AB;){const ne=U.nextSibling;U.remove(),U=ne}}setConnected(U){var Y;this._$AM===void 0&&(this._$Cp=U,(Y=this._$AP)===null||Y===void 0||Y.call(this,U))}};class k{constructor(U,Y,ie,ne,F){this.type=1,this._$AH=A$1,this._$AN=void 0,this.element=U,this.name=Y,this._$AM=ne,this.options=F,ie.length>2||ie[0]!==""||ie[1]!==""?(this._$AH=Array(ie.length-1).fill(new String),this.strings=ie):this._$AH=A$1}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(U,Y=this,ie,ne){const F=this.strings;let fe=!1;if(F===void 0)U=S(this,U,Y,0),fe=!d(U)||U!==this._$AH&&U!==T$1,fe&&(this._$AH=U);else{const pe=U;let Me,ve;for(U=F[0],Me=0;Me<F.length-1;Me++)ve=S(this,pe[ie+Me],Y,Me),ve===T$1&&(ve=this._$AH[Me]),fe||(fe=!d(ve)||ve!==this._$AH[Me]),ve===A$1?U=A$1:U!==A$1&&(U+=(ve??"")+F[Me+1]),this._$AH[Me]=ve}fe&&!ne&&this.j(U)}j(U){U===A$1?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,U??"")}}class H extends k{constructor(){super(...arguments),this.type=3}j(U){this.element[this.name]=U===A$1?void 0:U}}const I$1=s$1?s$1.emptyScript:"";class L extends k{constructor(){super(...arguments),this.type=4}j(U){U&&U!==A$1?this.element.setAttribute(this.name,I$1):this.element.removeAttribute(this.name)}}class z extends k{constructor(U,Y,ie,ne,F){super(U,Y,ie,ne,F),this.type=5}_$AI(U,Y=this){var ie;if((U=(ie=S(this,U,Y,0))!==null&&ie!==void 0?ie:A$1)===T$1)return;const ne=this._$AH,F=U===A$1&&ne!==A$1||U.capture!==ne.capture||U.once!==ne.once||U.passive!==ne.passive,fe=U!==A$1&&(ne===A$1||F);F&&this.element.removeEventListener(this.name,this,ne),fe&&this.element.addEventListener(this.name,this,U),this._$AH=U}handleEvent(U){var Y,ie;typeof this._$AH=="function"?this._$AH.call((ie=(Y=this.options)===null||Y===void 0?void 0:Y.host)!==null&&ie!==void 0?ie:this.element,U):this._$AH.handleEvent(U)}}class Z{constructor(U,Y,ie){this.element=U,this.type=6,this._$AN=void 0,this._$AM=Y,this.options=ie}get _$AU(){return this._$AM._$AU}_$AI(U){S(this,U)}}const B$1=i$1.litHtmlPolyfillSupport;B$1==null||B$1(N,R$1),((t$1=i$1.litHtmlVersions)!==null&&t$1!==void 0?t$1:i$1.litHtmlVersions=[]).push("2.8.0");const D=(re,U,Y)=>{var ie,ne;const F=(ie=Y==null?void 0:Y.renderBefore)!==null&&ie!==void 0?ie:U;let fe=F._$litPart$;if(fe===void 0){const pe=(ne=Y==null?void 0:Y.renderBefore)!==null&&ne!==void 0?ne:null;F._$litPart$=fe=new R$1(U.insertBefore(u$1(),pe),pe,void 0,Y??{})}return fe._$AI(re),fe};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var l,o;class s extends u$2{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var U,Y;const ie=super.createRenderRoot();return(U=(Y=this.renderOptions).renderBefore)!==null&&U!==void 0||(Y.renderBefore=ie.firstChild),ie}update(U){const Y=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(U),this._$Do=D(Y,this.renderRoot,this.renderOptions)}connectedCallback(){var U;super.connectedCallback(),(U=this._$Do)===null||U===void 0||U.setConnected(!0)}disconnectedCallback(){var U;super.disconnectedCallback(),(U=this._$Do)===null||U===void 0||U.setConnected(!1)}render(){return T$1}}s.finalized=!0,s._$litElement$=!0,(l=globalThis.litElementHydrateSupport)===null||l===void 0||l.call(globalThis,{LitElement:s});const n$1=globalThis.litElementPolyfillSupport;n$1==null||n$1({LitElement:s});((o=globalThis.litElementVersions)!==null&&o!==void 0?o:globalThis.litElementVersions=[]).push("3.3.3");/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HAS_WEBXR_DEVICE_API=navigator.xr!=null&&self.XRSession!=null&&navigator.xr.isSessionSupported!=null,HAS_WEBXR_HIT_TEST_API=HAS_WEBXR_DEVICE_API&&self.XRSession.prototype.requestHitTestSource!=null,HAS_RESIZE_OBSERVER=self.ResizeObserver!=null,HAS_INTERSECTION_OBSERVER=self.IntersectionObserver!=null,IS_WEBXR_AR_CANDIDATE=HAS_WEBXR_HIT_TEST_API;(()=>{const re=navigator.userAgent||navigator.vendor||self.opera;let U=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(re)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(re.substr(0,4)))&&(U=!0),U})();const IS_ANDROID=/android/i.test(navigator.userAgent),IS_IOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!self.MSStream||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,IS_FIREFOX=/firefox/i.test(navigator.userAgent),IS_OCULUS=/OculusBrowser/.test(navigator.userAgent),IS_SCENEVIEWER_CANDIDATE=IS_ANDROID&&!IS_FIREFOX&&!IS_OCULUS,IS_WKWEBVIEW=!!(window.webkit&&window.webkit.messageHandlers),IS_AR_QUICKLOOK_CANDIDATE=(()=>{if(IS_IOS){if(IS_WKWEBVIEW)return!!/CriOS\/|EdgiOS\/|FxiOS\/|GSA\/|DuckDuckGo\//.test(navigator.userAgent);{const re=document.createElement("a");return!!(re.relList&&re.relList.supports&&re.relList.supports("ar"))}}else return!1})();/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const deserializeUrl=re=>re&&re!=="null"?toFullUrl(re):null,assertIsArCandidate=()=>{if(IS_WEBXR_AR_CANDIDATE)return;const re=[];throw HAS_WEBXR_DEVICE_API||re.push("WebXR Device API"),HAS_WEBXR_HIT_TEST_API||re.push("WebXR Hit Test API"),new Error(`The following APIs are required for AR, but are missing in this browser: ${re.join(", ")}`)},toFullUrl=re=>new URL(re,window.location.toString()).toString(),throttle=(re,U)=>{let Y=null;const ie=(...ne)=>{Y==null&&(re(...ne),Y=self.setTimeout(()=>Y=null,U))};return ie.flush=()=>{Y!=null&&(self.clearTimeout(Y),Y=null)},ie},debounce=(re,U)=>{let Y=null;return(...ie)=>{Y!=null&&self.clearTimeout(Y),Y=self.setTimeout(()=>{Y=null,re(...ie)},U)}},clamp=(re,U,Y)=>Math.max(U,Math.min(Y,re)),isDebugMode=(()=>{const re="model-viewer-debug-mode",U=new RegExp(`[?&]${re}(&|$)`);return()=>self.ModelViewerElement&&self.ModelViewerElement.debugMode||self.location&&self.location.search&&self.location.search.match(U)})(),timePasses=(re=0)=>new Promise(U=>setTimeout(U,re)),waitForEvent=(re,U,Y=null)=>new Promise(ie=>{function ne(F){(!Y||Y(F))&&(ie(F),re.removeEventListener(U,ne))}re.addEventListener(U,ne)});/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$7=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};const BASE_OPACITY=.5,DEFAULT_SHADOW_INTENSITY=0,DEFAULT_SHADOW_SOFTNESS=1,DEFAULT_EXPOSURE=1,$currentEnvironmentMap=Symbol("currentEnvironmentMap"),$currentBackground=Symbol("currentBackground"),$updateEnvironment=Symbol("updateEnvironment"),$cancelEnvironmentUpdate=Symbol("cancelEnvironmentUpdate"),EnvironmentMixin=re=>{var U,Y,ie;class ne extends re{constructor(){super(...arguments),this.environmentImage=null,this.skyboxImage=null,this.shadowIntensity=DEFAULT_SHADOW_INTENSITY,this.shadowSoftness=DEFAULT_SHADOW_SOFTNESS,this.exposure=DEFAULT_EXPOSURE,this.toneMapping="auto",this.skyboxHeight="0",this[U]=null,this[Y]=null,this[ie]=null}updated(fe){super.updated(fe),fe.has("shadowIntensity")&&(this[$scene].setShadowIntensity(this.shadowIntensity*BASE_OPACITY),this[$needsRender]()),fe.has("shadowSoftness")&&(this[$scene].setShadowSoftness(this.shadowSoftness),this[$needsRender]()),fe.has("exposure")&&(this[$scene].exposure=this.exposure,this[$needsRender]()),fe.has("toneMapping")&&(this[$scene].toneMapping=this.toneMapping==="aces"?ACESFilmicToneMapping:this.toneMapping==="agx"?AgXToneMapping:NeutralToneMapping,this[$needsRender]()),(fe.has("environmentImage")||fe.has("skyboxImage"))&&this[$shouldAttemptPreload]()&&this[$updateEnvironment](),fe.has("skyboxHeight")&&(this[$scene].setGroundedSkybox(),this[$needsRender]())}hasBakedShadow(){return this[$scene].bakedShadows.size>0}async[(U=$currentEnvironmentMap,Y=$currentBackground,ie=$cancelEnvironmentUpdate,$updateEnvironment)](){const{skyboxImage:fe,environmentImage:pe}=this;this[$cancelEnvironmentUpdate]!=null&&(this[$cancelEnvironmentUpdate](),this[$cancelEnvironmentUpdate]=null);const{textureUtils:Me}=this[$renderer];if(Me==null)return;const ve=this[$progressTracker].beginActivity("environment-update");try{const{environmentMap:se,skybox:me}=await Me.generateEnvironmentMapAndSkybox(deserializeUrl(fe),pe,Te=>ve(clamp(Te,0,1)),this.withCredentials);this[$currentEnvironmentMap]!==se&&(this[$currentEnvironmentMap]=se,this.dispatchEvent(new CustomEvent("environment-change"))),me!=null?this[$currentBackground]=me.name===se.name?se:me:this[$currentBackground]=null,this[$scene].setEnvironmentAndSkybox(this[$currentEnvironmentMap],this[$currentBackground])}catch(se){if(se instanceof Error)throw this[$scene].setEnvironmentAndSkybox(null,null),se}finally{ve(1)}}}return __decorate$7([n$6({type:String,attribute:"environment-image"})],ne.prototype,"environmentImage",void 0),__decorate$7([n$6({type:String,attribute:"skybox-image"})],ne.prototype,"skyboxImage",void 0),__decorate$7([n$6({type:Number,attribute:"shadow-intensity"})],ne.prototype,"shadowIntensity",void 0),__decorate$7([n$6({type:Number,attribute:"shadow-softness"})],ne.prototype,"shadowSoftness",void 0),__decorate$7([n$6({type:Number})],ne.prototype,"exposure",void 0),__decorate$7([n$6({type:String,attribute:"tone-mapping"})],ne.prototype,"toneMapping",void 0),__decorate$7([n$6({type:String,attribute:"skybox-height"})],ne.prototype,"skyboxHeight",void 0),ne};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CloseIcon=x$1`
<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000">
    <!-- NOTE(cdata): This SVG filter is a stop-gap until we can implement
         support for dynamic re-coloring of UI components -->
    <defs>
      <filter id="drop-shadow" x="-100%" y="-100%" width="300%" height="300%">
        <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
        <feOffset dx="0" dy="0" result="offsetblur"/>
        <feFlood flood-color="#000000"/>
        <feComposite in2="offsetblur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    <path filter="url(#drop-shadow)" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ControlsPrompt=x$1`
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="36">
    <defs>
        <path id="A" d="M.001.232h24.997V36H.001z" />
    </defs>
    <g transform="translate(-11 -4)" fill="none" fill-rule="evenodd">
        <path fill-opacity="0" fill="#fff" d="M0 0h44v44H0z" />
        <g transform="translate(11 3)">
            <path d="M8.733 11.165c.04-1.108.766-2.027 1.743-2.307a2.54 2.54 0 0 1 .628-.089c.16 0 .314.017.463.044 1.088.2 1.9 1.092 1.9 2.16v8.88h1.26c2.943-1.39 5-4.45 5-8.025a9.01 9.01 0 0 0-1.9-5.56l-.43-.5c-.765-.838-1.683-1.522-2.712-2-1.057-.49-2.226-.77-3.46-.77s-2.4.278-3.46.77c-1.03.478-1.947 1.162-2.71 2l-.43.5a9.01 9.01 0 0 0-1.9 5.56 9.04 9.04 0 0 0 .094 1.305c.03.21.088.41.13.617l.136.624c.083.286.196.56.305.832l.124.333a8.78 8.78 0 0 0 .509.953l.065.122a8.69 8.69 0 0 0 3.521 3.191l1.11.537v-9.178z" fill-opacity=".5" fill="#e4e4e4" />
            <path d="M22.94 26.218l-2.76 7.74c-.172.485-.676.8-1.253.8H12.24c-1.606 0-3.092-.68-3.98-1.82-1.592-2.048-3.647-3.822-6.11-5.27-.095-.055-.15-.137-.152-.23-.004-.1.046-.196.193-.297.56-.393 1.234-.6 1.926-.6a3.43 3.43 0 0 1 .691.069l4.922.994V10.972c0-.663.615-1.203 1.37-1.203s1.373.54 1.373 1.203v9.882h2.953c.273 0 .533.073.757.21l6.257 3.874c.027.017.045.042.07.06.41.296.586.77.426 1.22M4.1 16.614c-.024-.04-.042-.083-.065-.122a8.69 8.69 0 0 1-.509-.953c-.048-.107-.08-.223-.124-.333l-.305-.832c-.058-.202-.09-.416-.136-.624l-.13-.617a9.03 9.03 0 0 1-.094-1.305c0-2.107.714-4.04 1.9-5.56l.43-.5c.764-.84 1.682-1.523 2.71-2 1.058-.49 2.226-.77 3.46-.77s2.402.28 3.46.77c1.03.477 1.947 1.16 2.712 2l.428.5a9 9 0 0 1 1.901 5.559c0 3.577-2.056 6.636-5 8.026h-1.26v-8.882c0-1.067-.822-1.96-1.9-2.16-.15-.028-.304-.044-.463-.044-.22 0-.427.037-.628.09-.977.28-1.703 1.198-1.743 2.306v9.178l-1.11-.537C6.18 19.098 4.96 18 4.1 16.614M22.97 24.09l-6.256-3.874c-.102-.063-.218-.098-.33-.144 2.683-1.8 4.354-4.855 4.354-8.243 0-.486-.037-.964-.104-1.43a9.97 9.97 0 0 0-1.57-4.128l-.295-.408-.066-.092a10.05 10.05 0 0 0-.949-1.078c-.342-.334-.708-.643-1.094-.922-1.155-.834-2.492-1.412-3.94-1.65l-.732-.088-.748-.03a9.29 9.29 0 0 0-1.482.119c-1.447.238-2.786.816-3.94 1.65a9.33 9.33 0 0 0-.813.686 9.59 9.59 0 0 0-.845.877l-.385.437-.36.5-.288.468-.418.778-.04.09c-.593 1.28-.93 2.71-.93 4.222 0 3.832 2.182 7.342 5.56 8.938l1.437.68v4.946L5 25.64a4.44 4.44 0 0 0-.888-.086c-.017 0-.034.003-.05.003-.252.004-.503.033-.75.08a5.08 5.08 0 0 0-.237.056c-.193.046-.382.107-.568.18-.075.03-.15.057-.225.1-.25.114-.494.244-.723.405a1.31 1.31 0 0 0-.566 1.122 1.28 1.28 0 0 0 .645 1.051C4 29.925 5.96 31.614 7.473 33.563a5.06 5.06 0 0 0 .434.491c1.086 1.082 2.656 1.713 4.326 1.715h6.697c.748-.001 1.43-.333 1.858-.872.142-.18.256-.38.336-.602l2.757-7.74c.094-.26.13-.53.112-.794s-.088-.52-.203-.76a2.19 2.19 0 0 0-.821-.91" fill-opacity=".6" fill="#000" />
            <path d="M22.444 24.94l-6.257-3.874a1.45 1.45 0 0 0-.757-.211h-2.953v-9.88c0-.663-.616-1.203-1.373-1.203s-1.37.54-1.37 1.203v16.643l-4.922-.994a3.44 3.44 0 0 0-.692-.069 3.35 3.35 0 0 0-1.925.598c-.147.102-.198.198-.194.298.004.094.058.176.153.23 2.462 1.448 4.517 3.22 6.11 5.27.887 1.14 2.373 1.82 3.98 1.82h6.686c.577 0 1.08-.326 1.253-.8l2.76-7.74c.16-.448-.017-.923-.426-1.22-.025-.02-.043-.043-.07-.06z" fill="#fff" />
            <g transform="translate(0 .769)">
                <mask id="B" fill="#fff">
                    <use xlink:href="#A" />
                </mask>
                <path d="M23.993 24.992a1.96 1.96 0 0 1-.111.794l-2.758 7.74c-.08.22-.194.423-.336.602-.427.54-1.11.87-1.857.872h-6.698c-1.67-.002-3.24-.633-4.326-1.715-.154-.154-.3-.318-.434-.49C5.96 30.846 4 29.157 1.646 27.773c-.385-.225-.626-.618-.645-1.05a1.31 1.31 0 0 1 .566-1.122 4.56 4.56 0 0 1 .723-.405l.225-.1a4.3 4.3 0 0 1 .568-.18l.237-.056c.248-.046.5-.075.75-.08.018 0 .034-.003.05-.003.303-.001.597.027.89.086l3.722.752V20.68l-1.436-.68c-3.377-1.596-5.56-5.106-5.56-8.938 0-1.51.336-2.94.93-4.222.015-.03.025-.06.04-.09.127-.267.268-.525.418-.778.093-.16.186-.316.288-.468.063-.095.133-.186.2-.277L3.773 5c.118-.155.26-.29.385-.437.266-.3.544-.604.845-.877a9.33 9.33 0 0 1 .813-.686C6.97 2.167 8.31 1.59 9.757 1.35a9.27 9.27 0 0 1 1.481-.119 8.82 8.82 0 0 1 .748.031c.247.02.49.05.733.088 1.448.238 2.786.816 3.94 1.65.387.28.752.588 1.094.922a9.94 9.94 0 0 1 .949 1.078l.066.092c.102.133.203.268.295.408a9.97 9.97 0 0 1 1.571 4.128c.066.467.103.945.103 1.43 0 3.388-1.67 6.453-4.353 8.243.11.046.227.08.33.144l6.256 3.874c.37.23.645.55.82.9.115.24.185.498.203.76m.697-1.195c-.265-.55-.677-1.007-1.194-1.326l-5.323-3.297c2.255-2.037 3.564-4.97 3.564-8.114 0-2.19-.637-4.304-1.84-6.114-.126-.188-.26-.37-.4-.552-.645-.848-1.402-1.6-2.252-2.204C15.472.91 13.393.232 11.238.232A10.21 10.21 0 0 0 5.23 2.19c-.848.614-1.606 1.356-2.253 2.205-.136.18-.272.363-.398.55C1.374 6.756.737 8.87.737 11.06c0 4.218 2.407 8.08 6.133 9.842l.863.41v3.092l-2.525-.51c-.356-.07-.717-.106-1.076-.106a5.45 5.45 0 0 0-3.14.996c-.653.46-1.022 1.202-.99 1.983a2.28 2.28 0 0 0 1.138 1.872c2.24 1.318 4.106 2.923 5.543 4.772 1.26 1.62 3.333 2.59 5.55 2.592h6.698c1.42-.001 2.68-.86 3.134-2.138l2.76-7.74c.272-.757.224-1.584-.134-2.325" fill-opacity=".05" fill="#000" mask="url(#B)" />
            </g>
        </g>
    </g>
</svg>`;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ARGlyph=x$1`
<svg version="1.1" id="view_x5F_in_x5F_AR_x5F_icon"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px"
	 viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<rect id="Bounding_Box" x="0" y="0" fill="none" width="24" height="24"/>
<g id="Art_layer">
	<path d="M3,4c0-0.55,0.45-1,1-1h2V1H4C2.35,1,1,2.35,1,4v2h2V4z"/>
	<path d="M20,3c0.55,0,1,0.45,1,1v2h2V4c0-1.65-1.35-3-3-3h-2v2H20z"/>
	<path d="M4,21c-0.55,0-1-0.45-1-1v-2H1v2c0,1.65,1.35,3,3,3h2v-2H4z"/>
	<path d="M20,21c0.55,0,1-0.45,1-1v-2h2v2c0,1.65-1.35,3-3,3h-2v-2H20z"/>
	<g>
		<path d="M18.25,7.6l-5.5-3.18c-0.46-0.27-1.04-0.27-1.5,0L5.75,7.6C5.29,7.87,5,8.36,5,8.9v6.35c0,0.54,0.29,1.03,0.75,1.3
			l5.5,3.18c0.46,0.27,1.04,0.27,1.5,0l5.5-3.18c0.46-0.27,0.75-0.76,0.75-1.3V8.9C19,8.36,18.71,7.87,18.25,7.6z M7,14.96v-4.62
			l4,2.32v4.61L7,14.96z M12,10.93L8,8.61l4-2.31l4,2.31L12,10.93z M13,17.27v-4.61l4-2.32v4.62L13,17.27z"/>
	</g>
</g>
</svg>`;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const templateResult=x$1`
<style>
:host {
  display: block;
  position: relative;
  contain: strict;
  width: 300px;
  height: 150px;
}

.container {
  position: relative;
  overflow: hidden;
}

.userInput {
  width: 100%;
  height: 100%;
  display: none;
  position: relative;
  outline-offset: -1px;
  outline-width: 1px;
}

canvas {
  position: absolute;
  display: none;
  pointer-events: none;
  /* NOTE(cdata): Chrome 76 and below apparently have a bug
   * that causes our canvas not to display pixels unless it is
   * on its own render layer
   * @see https://github.com/google/model-viewer/pull/755#issuecomment-536597893
   */
  transform: translateZ(0);
}

.show {
  display: block;
}

/* Adapted from HTML5 Boilerplate
 *
 * @see https://github.com/h5bp/html5-boilerplate/blob/ceb4620c78fc82e13534fc44202a3f168754873f/dist/css/main.css#L122-L133 */
.screen-reader-only {
  border: 0;
  left: 0;
  top: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
  pointer-events: none;
}

.slot {
  position: absolute;
  pointer-events: none;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.slot > * {
  pointer-events: initial;
}

.annotation-wrapper ::slotted(*) {
  opacity: var(--max-hotspot-opacity, 1);
  transition: opacity 0.3s;
}

.pointer-tumbling .annotation-wrapper ::slotted(*) {
  pointer-events: none;
}

.annotation-wrapper ::slotted(*) {
  pointer-events: initial;
}

.annotation-wrapper.hide ::slotted(*) {
  opacity: var(--min-hotspot-opacity, 0.25);
}

.slot.poster {
  display: none;
  background-color: inherit;
}

.slot.poster.show {
  display: inherit;
}

.slot.poster > * {
  pointer-events: initial;
}

.slot.poster:not(.show) > * {
  pointer-events: none;
}

#default-poster {
  width: 100%;
  height: 100%;
  /* The default poster is a <button> so we need to set display
   * to prevent it from being affected by text-align: */
  display: block;
  position: absolute;
  border: none;
  padding: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: #fff0;
}

#default-progress-bar {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

#default-progress-bar > .bar {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--progress-bar-height, 5px);
  background-color: var(--progress-bar-color, rgba(0, 0, 0, 0.4));
  transition: transform 0.09s;
  transform-origin: top left;
  transform: scaleX(0);
  overflow: hidden;
}

#default-progress-bar > .bar.hide {
  transition: opacity 0.3s 1s;
  opacity: 0;
}

.centered {
  align-items: center;
  justify-content: center;
}

.cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.slot.interaction-prompt {
  display: var(--interaction-prompt-display, flex);
  overflow: hidden;
  opacity: 0;
  will-change: opacity;
  transition: opacity 0.3s;
}

.slot.interaction-prompt.visible {
  opacity: 1;
}

.animated-container {
  will-change: transform, opacity;
  opacity: 0;
  transition: opacity 0.3s;
}

.slot.interaction-prompt > * {
  pointer-events: none;
}

.slot.ar-button {
  -moz-user-select: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;

  display: var(--ar-button-display, block);
}

.slot.ar-button:not(.enabled) {
  display: none;
}

.fab {
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  width: 40px;
  height: 40px;
  cursor: pointer;
  background-color: #fff;
  box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.15);
  border-radius: 100px;
}

.fab > * {
  opacity: 0.87;
}

#default-ar-button {
  position: absolute;
  bottom: 16px;
  right: 16px;
  transform: scale(var(--ar-button-scale, 1));
  transform-origin: bottom right;
}

.slot.pan-target {
  display: block;
  position: absolute;
  width: 0;
  height: 0;
  left: 50%;
  top: 50%;
  transform: translate3d(-50%, -50%, 0);
  background-color: transparent;
  opacity: 0;
  transition: opacity 0.3s;
}

#default-pan-target {
  width: 6px;
  height: 6px;
  border-radius: 6px;
  border: 1px solid white;
  box-shadow: 0px 0px 2px 1px rgba(0, 0, 0, 0.8);
}

.slot.default {
  pointer-events: none;
}

.slot.progress-bar {
  pointer-events: none;
}

.slot.exit-webxr-ar-button {
  pointer-events: none;
}

.slot.exit-webxr-ar-button:not(.enabled) {
  display: none;
}

#default-exit-webxr-ar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: env(safe-area-inset-top, 16px);
  right: 16px;
  width: 40px;
  height: 40px;
  box-sizing: border-box;
}

#default-exit-webxr-ar-button > svg {
  fill: #fff;
}
</style>
<div class="container">
  <div class="userInput" tabindex="0" role="img"
      aria-label="3D model">
      <div class="slot canvas">
        <slot name="canvas">
          <canvas></canvas>
        </slot>
      </div>

  </div>

  <!-- NOTE(cdata): We need to wrap slots because browsers without ShadowDOM
        will have their <slot> elements removed by ShadyCSS -->
  <div class="slot poster">
    <slot name="poster">
      <button type="button" id="default-poster" aria-hidden="true" aria-label="Loading 3D model"></button>
    </slot>
  </div>

  <div class="slot ar-button">
    <slot name="ar-button">
      <a id="default-ar-button" part="default-ar-button" class="fab"
          tabindex="2"
          role="button"
          href="javascript:void(0);"
          aria-label="View in your space">
        ${ARGlyph}
      </a>
    </slot>
  </div>

  <div class="slot pan-target">
    <slot name="pan-target">
      <div id="default-pan-target">
      </div>
    </slot>
  </div>

  <div class="slot interaction-prompt cover centered">
    <div id="prompt" class="animated-container">
      <slot name="interaction-prompt" aria-hidden="true">
        ${ControlsPrompt}
      </slot>
    </div>
  </div>

  <div id="finger0" class="animated-container cover">
    <slot name="finger0" aria-hidden="true">
    </slot>
  </div>
  <div id="finger1" class="animated-container cover">
    <slot name="finger1" aria-hidden="true">
    </slot>
  </div>

  <div class="slot default">
    <slot></slot>

    <div class="slot progress-bar">
      <slot name="progress-bar">
        <div id="default-progress-bar" aria-hidden="true">
          <div class="bar" part="default-progress-bar"></div>
        </div>
      </slot>
    </div>

    <div class="slot exit-webxr-ar-button">
      <slot name="exit-webxr-ar-button">
        <a id="default-exit-webxr-ar-button" part="default-exit-webxr-ar-button"
            tabindex="3"
            aria-label="Exit AR"
            aria-hidden="true">
          ${CloseIcon}
        </a>
      </slot>
    </div>
  </div>
</div>
<div class="screen-reader-only" role="region" aria-label="Live announcements">
  <span id="status" role="status"></span>
</div>`,makeTemplate=re=>{D(templateResult,re)},_taskCache$1=new WeakMap;class DRACOLoader extends Loader{constructor(U){super(U),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(U){return this.decoderPath=U,this}setDecoderConfig(U){return this.decoderConfig=U,this}setWorkerLimit(U){return this.workerLimit=U,this}load(U,Y,ie,ne){const F=new FileLoader(this.manager);F.setPath(this.path),F.setResponseType("arraybuffer"),F.setRequestHeader(this.requestHeader),F.setWithCredentials(this.withCredentials),F.load(U,fe=>{this.parse(fe,Y,ne)},ie,ne)}parse(U,Y,ie=()=>{}){this.decodeDracoFile(U,Y,null,null,SRGBColorSpace,ie).catch(ie)}decodeDracoFile(U,Y,ie,ne,F=LinearSRGBColorSpace,fe=()=>{}){const pe={attributeIDs:ie||this.defaultAttributeIDs,attributeTypes:ne||this.defaultAttributeTypes,useUniqueIDs:!!ie,vertexColorSpace:F};return this.decodeGeometry(U,pe).then(Y).catch(fe)}decodeGeometry(U,Y){const ie=JSON.stringify(Y);if(_taskCache$1.has(U)){const Me=_taskCache$1.get(U);if(Me.key===ie)return Me.promise;if(U.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let ne;const F=this.workerNextTaskID++,fe=U.byteLength,pe=this._getWorker(F,fe).then(Me=>(ne=Me,new Promise((ve,se)=>{ne._callbacks[F]={resolve:ve,reject:se},ne.postMessage({type:"decode",id:F,taskConfig:Y,buffer:U},[U])}))).then(Me=>this._createGeometry(Me.geometry));return pe.catch(()=>!0).then(()=>{ne&&F&&this._releaseTask(ne,F)}),_taskCache$1.set(U,{key:ie,promise:pe}),pe}_createGeometry(U){const Y=new BufferGeometry;U.index&&Y.setIndex(new BufferAttribute(U.index.array,1));for(let ie=0;ie<U.attributes.length;ie++){const ne=U.attributes[ie],F=ne.name,fe=ne.array,pe=ne.itemSize,Me=new BufferAttribute(fe,pe);F==="color"&&(this._assignVertexColorSpace(Me,ne.vertexColorSpace),Me.normalized=!(fe instanceof Float32Array)),Y.setAttribute(F,Me)}return Y}_assignVertexColorSpace(U,Y){if(Y!==SRGBColorSpace)return;const ie=new Color;for(let ne=0,F=U.count;ne<F;ne++)ie.fromBufferAttribute(U,ne),ColorManagement.toWorkingColorSpace(ie,SRGBColorSpace),U.setXYZ(ne,ie.r,ie.g,ie.b)}_loadLibrary(U,Y){const ie=new FileLoader(this.manager);return ie.setPath(this.decoderPath),ie.setResponseType(Y),ie.setWithCredentials(this.withCredentials),new Promise((ne,F)=>{ie.load(U,ne,void 0,F)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const U=typeof WebAssembly!="object"||this.decoderConfig.type==="js",Y=[];return U?Y.push(this._loadLibrary("draco_decoder.js","text")):(Y.push(this._loadLibrary("draco_wasm_wrapper.js","text")),Y.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(Y).then(ie=>{const ne=ie[0];U||(this.decoderConfig.wasmBinary=ie[1]);const F=DRACOWorker.toString(),fe=["/* draco decoder */",ne,"","/* worker */",F.substring(F.indexOf("{")+1,F.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([fe]))}),this.decoderPending}_getWorker(U,Y){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const ne=new Worker(this.workerSourceURL);ne._callbacks={},ne._taskCosts={},ne._taskLoad=0,ne.postMessage({type:"init",decoderConfig:this.decoderConfig}),ne.onmessage=function(F){const fe=F.data;switch(fe.type){case"decode":ne._callbacks[fe.id].resolve(fe);break;case"error":ne._callbacks[fe.id].reject(fe);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+fe.type+'"')}},this.workerPool.push(ne)}else this.workerPool.sort(function(ne,F){return ne._taskLoad>F._taskLoad?-1:1});const ie=this.workerPool[this.workerPool.length-1];return ie._taskCosts[U]=Y,ie._taskLoad+=Y,ie})}_releaseTask(U,Y){U._taskLoad-=U._taskCosts[Y],delete U._callbacks[Y],delete U._taskCosts[Y]}debug(){console.log("Task load: ",this.workerPool.map(U=>U._taskLoad))}dispose(){for(let U=0;U<this.workerPool.length;++U)this.workerPool[U].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function DRACOWorker(){let re,U;onmessage=function(fe){const pe=fe.data;switch(pe.type){case"init":re=pe.decoderConfig,U=new Promise(function(se){re.onModuleLoaded=function(me){se({draco:me})},DracoDecoderModule(re)});break;case"decode":const Me=pe.buffer,ve=pe.taskConfig;U.then(se=>{const me=se.draco,Te=new me.Decoder;try{const Re=Y(me,Te,new Int8Array(Me),ve),be=Re.attributes.map(Pe=>Pe.array.buffer);Re.index&&be.push(Re.index.array.buffer),self.postMessage({type:"decode",id:pe.id,geometry:Re},be)}catch(Re){console.error(Re),self.postMessage({type:"error",id:pe.id,error:Re.message})}finally{me.destroy(Te)}});break}};function Y(fe,pe,Me,ve){const se=ve.attributeIDs,me=ve.attributeTypes;let Te,Re;const be=pe.GetEncodedGeometryType(Me);if(be===fe.TRIANGULAR_MESH)Te=new fe.Mesh,Re=pe.DecodeArrayToMesh(Me,Me.byteLength,Te);else if(be===fe.POINT_CLOUD)Te=new fe.PointCloud,Re=pe.DecodeArrayToPointCloud(Me,Me.byteLength,Te);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!Re.ok()||Te.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+Re.error_msg());const Pe={index:null,attributes:[]};for(const Le in se){const xe=self[me[Le]];let Fe,Oe;if(ve.useUniqueIDs)Oe=se[Le],Fe=pe.GetAttributeByUniqueId(Te,Oe);else{if(Oe=pe.GetAttributeId(Te,fe[se[Le]]),Oe===-1)continue;Fe=pe.GetAttribute(Te,Oe)}const Ne=ne(fe,pe,Te,Le,xe,Fe);Le==="color"&&(Ne.vertexColorSpace=ve.vertexColorSpace),Pe.attributes.push(Ne)}return be===fe.TRIANGULAR_MESH&&(Pe.index=ie(fe,pe,Te)),fe.destroy(Te),Pe}function ie(fe,pe,Me){const se=Me.num_faces()*3,me=se*4,Te=fe._malloc(me);pe.GetTrianglesUInt32Array(Me,me,Te);const Re=new Uint32Array(fe.HEAPF32.buffer,Te,se).slice();return fe._free(Te),{array:Re,itemSize:1}}function ne(fe,pe,Me,ve,se,me){const Te=me.num_components(),be=Me.num_points()*Te,Pe=be*se.BYTES_PER_ELEMENT,Le=F(fe,se),xe=fe._malloc(Pe);pe.GetAttributeDataArrayForAllPoints(Me,me,Le,Pe,xe);const Fe=new se(fe.HEAPF32.buffer,xe,be).slice();return fe._free(xe),{name:ve,array:Fe,itemSize:Te}}function F(fe,pe){switch(pe){case Float32Array:return fe.DT_FLOAT32;case Int8Array:return fe.DT_INT8;case Int16Array:return fe.DT_INT16;case Int32Array:return fe.DT_INT32;case Uint8Array:return fe.DT_UINT8;case Uint16Array:return fe.DT_UINT16;case Uint32Array:return fe.DT_UINT32}}}function toTrianglesDrawMode(re,U){if(U===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),re;if(U===TriangleFanDrawMode||U===TriangleStripDrawMode){let Y=re.getIndex();if(Y===null){const fe=[],pe=re.getAttribute("position");if(pe!==void 0){for(let Me=0;Me<pe.count;Me++)fe.push(Me);re.setIndex(fe),Y=re.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),re}const ie=Y.count-2,ne=[];if(U===TriangleFanDrawMode)for(let fe=1;fe<=ie;fe++)ne.push(Y.getX(0)),ne.push(Y.getX(fe)),ne.push(Y.getX(fe+1));else for(let fe=0;fe<ie;fe++)fe%2===0?(ne.push(Y.getX(fe)),ne.push(Y.getX(fe+1)),ne.push(Y.getX(fe+2))):(ne.push(Y.getX(fe+2)),ne.push(Y.getX(fe+1)),ne.push(Y.getX(fe)));ne.length/3!==ie&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const F=re.clone();return F.setIndex(ne),F.clearGroups(),F}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",U),re}class GLTFLoader extends Loader{constructor(U){super(U),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(Y){return new GLTFMaterialsClearcoatExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsDispersionExtension$1(Y)}),this.register(function(Y){return new GLTFTextureBasisUExtension(Y)}),this.register(function(Y){return new GLTFTextureWebPExtension(Y)}),this.register(function(Y){return new GLTFTextureAVIFExtension(Y)}),this.register(function(Y){return new GLTFMaterialsSheenExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsTransmissionExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsVolumeExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsIorExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsEmissiveStrengthExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsSpecularExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsIridescenceExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsAnisotropyExtension$1(Y)}),this.register(function(Y){return new GLTFMaterialsBumpExtension$1(Y)}),this.register(function(Y){return new GLTFLightsExtension(Y)}),this.register(function(Y){return new GLTFMeshoptCompression(Y)}),this.register(function(Y){return new GLTFMeshGpuInstancing$1(Y)})}load(U,Y,ie,ne){const F=this;let fe;if(this.resourcePath!=="")fe=this.resourcePath;else if(this.path!==""){const ve=LoaderUtils.extractUrlBase(U);fe=LoaderUtils.resolveURL(ve,this.path)}else fe=LoaderUtils.extractUrlBase(U);this.manager.itemStart(U);const pe=function(ve){ne?ne(ve):console.error(ve),F.manager.itemError(U),F.manager.itemEnd(U)},Me=new FileLoader(this.manager);Me.setPath(this.path),Me.setResponseType("arraybuffer"),Me.setRequestHeader(this.requestHeader),Me.setWithCredentials(this.withCredentials),Me.load(U,function(ve){try{F.parse(ve,fe,function(se){Y(se),F.manager.itemEnd(U)},pe)}catch(se){pe(se)}},ie,pe)}setDRACOLoader(U){return this.dracoLoader=U,this}setKTX2Loader(U){return this.ktx2Loader=U,this}setMeshoptDecoder(U){return this.meshoptDecoder=U,this}register(U){return this.pluginCallbacks.indexOf(U)===-1&&this.pluginCallbacks.push(U),this}unregister(U){return this.pluginCallbacks.indexOf(U)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(U),1),this}parse(U,Y,ie,ne){let F;const fe={},pe={},Me=new TextDecoder;if(typeof U=="string")F=JSON.parse(U);else if(U instanceof ArrayBuffer)if(Me.decode(new Uint8Array(U,0,4))===BINARY_EXTENSION_HEADER_MAGIC){try{fe[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(U)}catch(me){ne&&ne(me);return}F=JSON.parse(fe[EXTENSIONS.KHR_BINARY_GLTF].content)}else F=JSON.parse(Me.decode(U));else F=U;if(F.asset===void 0||F.asset.version[0]<2){ne&&ne(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ve=new GLTFParser(F,{path:Y||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ve.fileLoader.setRequestHeader(this.requestHeader);for(let se=0;se<this.pluginCallbacks.length;se++){const me=this.pluginCallbacks[se](ve);me.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),pe[me.name]=me,fe[me.name]=!0}if(F.extensionsUsed)for(let se=0;se<F.extensionsUsed.length;++se){const me=F.extensionsUsed[se],Te=F.extensionsRequired||[];switch(me){case EXTENSIONS.KHR_MATERIALS_UNLIT:fe[me]=new GLTFMaterialsUnlitExtension$1;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:fe[me]=new GLTFDracoMeshCompressionExtension(F,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:fe[me]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:fe[me]=new GLTFMeshQuantizationExtension;break;default:Te.indexOf(me)>=0&&pe[me]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+me+'".')}}ve.setExtensions(fe),ve.setPlugins(pe),ve.parse(ie,ne)}parseAsync(U,Y){const ie=this;return new Promise(function(ne,F){ie.parse(U,Y,ne,F)})}}function GLTFRegistry(){let re={};return{get:function(U){return re[U]},add:function(U,Y){re[U]=Y},remove:function(U){delete re[U]},removeAll:function(){re={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const U=this.parser,Y=this.parser.json.nodes||[];for(let ie=0,ne=Y.length;ie<ne;ie++){const F=Y[ie];F.extensions&&F.extensions[this.name]&&F.extensions[this.name].light!==void 0&&U._addNodeRef(this.cache,F.extensions[this.name].light)}}_loadLight(U){const Y=this.parser,ie="light:"+U;let ne=Y.cache.get(ie);if(ne)return ne;const F=Y.json,Me=((F.extensions&&F.extensions[this.name]||{}).lights||[])[U];let ve;const se=new Color(16777215);Me.color!==void 0&&se.setRGB(Me.color[0],Me.color[1],Me.color[2],LinearSRGBColorSpace);const me=Me.range!==void 0?Me.range:0;switch(Me.type){case"directional":ve=new DirectionalLight(se),ve.target.position.set(0,0,-1),ve.add(ve.target);break;case"point":ve=new PointLight(se),ve.distance=me;break;case"spot":ve=new SpotLight(se),ve.distance=me,Me.spot=Me.spot||{},Me.spot.innerConeAngle=Me.spot.innerConeAngle!==void 0?Me.spot.innerConeAngle:0,Me.spot.outerConeAngle=Me.spot.outerConeAngle!==void 0?Me.spot.outerConeAngle:Math.PI/4,ve.angle=Me.spot.outerConeAngle,ve.penumbra=1-Me.spot.innerConeAngle/Me.spot.outerConeAngle,ve.target.position.set(0,0,-1),ve.add(ve.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Me.type)}return ve.position.set(0,0,0),ve.decay=2,assignExtrasToUserData(ve,Me),Me.intensity!==void 0&&(ve.intensity=Me.intensity),ve.name=Y.createUniqueName(Me.name||"light_"+U),ne=Promise.resolve(ve),Y.cache.add(ie,ne),ne}getDependency(U,Y){if(U==="light")return this._loadLight(Y)}createNodeAttachment(U){const Y=this,ie=this.parser,F=ie.json.nodes[U],pe=(F.extensions&&F.extensions[this.name]||{}).light;return pe===void 0?null:this._loadLight(pe).then(function(Me){return ie._getNodeRef(Y.cache,pe,Me)})}}let GLTFMaterialsUnlitExtension$1=class{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(U,Y,ie){const ne=[];U.color=new Color(1,1,1),U.opacity=1;const F=Y.pbrMetallicRoughness;if(F){if(Array.isArray(F.baseColorFactor)){const fe=F.baseColorFactor;U.color.setRGB(fe[0],fe[1],fe[2],LinearSRGBColorSpace),U.opacity=fe[3]}F.baseColorTexture!==void 0&&ne.push(ie.assignTexture(U,"map",F.baseColorTexture,SRGBColorSpace))}return Promise.all(ne)}},GLTFMaterialsEmissiveStrengthExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(U,Y){const ne=this.parser.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=ne.extensions[this.name].emissiveStrength;return F!==void 0&&(Y.emissiveIntensity=F),Promise.resolve()}},GLTFMaterialsClearcoatExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];if(fe.clearcoatFactor!==void 0&&(Y.clearcoat=fe.clearcoatFactor),fe.clearcoatTexture!==void 0&&F.push(ie.assignTexture(Y,"clearcoatMap",fe.clearcoatTexture)),fe.clearcoatRoughnessFactor!==void 0&&(Y.clearcoatRoughness=fe.clearcoatRoughnessFactor),fe.clearcoatRoughnessTexture!==void 0&&F.push(ie.assignTexture(Y,"clearcoatRoughnessMap",fe.clearcoatRoughnessTexture)),fe.clearcoatNormalTexture!==void 0&&(F.push(ie.assignTexture(Y,"clearcoatNormalMap",fe.clearcoatNormalTexture)),fe.clearcoatNormalTexture.scale!==void 0)){const pe=fe.clearcoatNormalTexture.scale;Y.clearcoatNormalScale=new Vector2(pe,pe)}return Promise.all(F)}},GLTFMaterialsDispersionExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_DISPERSION}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ne=this.parser.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=ne.extensions[this.name];return Y.dispersion=F.dispersion!==void 0?F.dispersion:0,Promise.resolve()}},GLTFMaterialsIridescenceExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];return fe.iridescenceFactor!==void 0&&(Y.iridescence=fe.iridescenceFactor),fe.iridescenceTexture!==void 0&&F.push(ie.assignTexture(Y,"iridescenceMap",fe.iridescenceTexture)),fe.iridescenceIor!==void 0&&(Y.iridescenceIOR=fe.iridescenceIor),Y.iridescenceThicknessRange===void 0&&(Y.iridescenceThicknessRange=[100,400]),fe.iridescenceThicknessMinimum!==void 0&&(Y.iridescenceThicknessRange[0]=fe.iridescenceThicknessMinimum),fe.iridescenceThicknessMaximum!==void 0&&(Y.iridescenceThicknessRange[1]=fe.iridescenceThicknessMaximum),fe.iridescenceThicknessTexture!==void 0&&F.push(ie.assignTexture(Y,"iridescenceThicknessMap",fe.iridescenceThicknessTexture)),Promise.all(F)}},GLTFMaterialsSheenExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[];Y.sheenColor=new Color(0,0,0),Y.sheenRoughness=0,Y.sheen=1;const fe=ne.extensions[this.name];if(fe.sheenColorFactor!==void 0){const pe=fe.sheenColorFactor;Y.sheenColor.setRGB(pe[0],pe[1],pe[2],LinearSRGBColorSpace)}return fe.sheenRoughnessFactor!==void 0&&(Y.sheenRoughness=fe.sheenRoughnessFactor),fe.sheenColorTexture!==void 0&&F.push(ie.assignTexture(Y,"sheenColorMap",fe.sheenColorTexture,SRGBColorSpace)),fe.sheenRoughnessTexture!==void 0&&F.push(ie.assignTexture(Y,"sheenRoughnessMap",fe.sheenRoughnessTexture)),Promise.all(F)}},GLTFMaterialsTransmissionExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];return fe.transmissionFactor!==void 0&&(Y.transmission=fe.transmissionFactor),fe.transmissionTexture!==void 0&&F.push(ie.assignTexture(Y,"transmissionMap",fe.transmissionTexture)),Promise.all(F)}},GLTFMaterialsVolumeExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];Y.thickness=fe.thicknessFactor!==void 0?fe.thicknessFactor:0,fe.thicknessTexture!==void 0&&F.push(ie.assignTexture(Y,"thicknessMap",fe.thicknessTexture)),Y.attenuationDistance=fe.attenuationDistance||1/0;const pe=fe.attenuationColor||[1,1,1];return Y.attenuationColor=new Color().setRGB(pe[0],pe[1],pe[2],LinearSRGBColorSpace),Promise.all(F)}},GLTFMaterialsIorExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ne=this.parser.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=ne.extensions[this.name];return Y.ior=F.ior!==void 0?F.ior:1.5,Promise.resolve()}},GLTFMaterialsSpecularExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];Y.specularIntensity=fe.specularFactor!==void 0?fe.specularFactor:1,fe.specularTexture!==void 0&&F.push(ie.assignTexture(Y,"specularIntensityMap",fe.specularTexture));const pe=fe.specularColorFactor||[1,1,1];return Y.specularColor=new Color().setRGB(pe[0],pe[1],pe[2],LinearSRGBColorSpace),fe.specularColorTexture!==void 0&&F.push(ie.assignTexture(Y,"specularColorMap",fe.specularColorTexture,SRGBColorSpace)),Promise.all(F)}},GLTFMaterialsBumpExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.EXT_MATERIALS_BUMP}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];return Y.bumpScale=fe.bumpFactor!==void 0?fe.bumpFactor:1,fe.bumpTexture!==void 0&&F.push(ie.assignTexture(Y,"bumpMap",fe.bumpTexture)),Promise.all(F)}},GLTFMaterialsAnisotropyExtension$1=class{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(U){const ie=this.parser.json.materials[U];return!ie.extensions||!ie.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(U,Y){const ie=this.parser,ne=ie.json.materials[U];if(!ne.extensions||!ne.extensions[this.name])return Promise.resolve();const F=[],fe=ne.extensions[this.name];return fe.anisotropyStrength!==void 0&&(Y.anisotropy=fe.anisotropyStrength),fe.anisotropyRotation!==void 0&&(Y.anisotropyRotation=fe.anisotropyRotation),fe.anisotropyTexture!==void 0&&F.push(ie.assignTexture(Y,"anisotropyMap",fe.anisotropyTexture)),Promise.all(F)}};class GLTFTextureBasisUExtension{constructor(U){this.parser=U,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(U){const Y=this.parser,ie=Y.json,ne=ie.textures[U];if(!ne.extensions||!ne.extensions[this.name])return null;const F=ne.extensions[this.name],fe=Y.options.ktx2Loader;if(!fe){if(ie.extensionsRequired&&ie.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return Y.loadTextureImage(U,F.source,fe)}}class GLTFTextureWebPExtension{constructor(U){this.parser=U,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(U){const Y=this.name,ie=this.parser,ne=ie.json,F=ne.textures[U];if(!F.extensions||!F.extensions[Y])return null;const fe=F.extensions[Y],pe=ne.images[fe.source];let Me=ie.textureLoader;if(pe.uri){const ve=ie.options.manager.getHandler(pe.uri);ve!==null&&(Me=ve)}return this.detectSupport().then(function(ve){if(ve)return ie.loadTextureImage(U,fe.source,Me);if(ne.extensionsRequired&&ne.extensionsRequired.indexOf(Y)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return ie.loadTexture(U)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(U){const Y=new Image;Y.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",Y.onload=Y.onerror=function(){U(Y.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(U){this.parser=U,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(U){const Y=this.name,ie=this.parser,ne=ie.json,F=ne.textures[U];if(!F.extensions||!F.extensions[Y])return null;const fe=F.extensions[Y],pe=ne.images[fe.source];let Me=ie.textureLoader;if(pe.uri){const ve=ie.options.manager.getHandler(pe.uri);ve!==null&&(Me=ve)}return this.detectSupport().then(function(ve){if(ve)return ie.loadTextureImage(U,fe.source,Me);if(ne.extensionsRequired&&ne.extensionsRequired.indexOf(Y)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return ie.loadTexture(U)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(U){const Y=new Image;Y.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",Y.onload=Y.onerror=function(){U(Y.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(U){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=U}loadBufferView(U){const Y=this.parser.json,ie=Y.bufferViews[U];if(ie.extensions&&ie.extensions[this.name]){const ne=ie.extensions[this.name],F=this.parser.getDependency("buffer",ne.buffer),fe=this.parser.options.meshoptDecoder;if(!fe||!fe.supported){if(Y.extensionsRequired&&Y.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return F.then(function(pe){const Me=ne.byteOffset||0,ve=ne.byteLength||0,se=ne.count,me=ne.byteStride,Te=new Uint8Array(pe,Me,ve);return fe.decodeGltfBufferAsync?fe.decodeGltfBufferAsync(se,me,Te,ne.mode,ne.filter).then(function(Re){return Re.buffer}):fe.ready.then(function(){const Re=new ArrayBuffer(se*me);return fe.decodeGltfBuffer(new Uint8Array(Re),se,me,Te,ne.mode,ne.filter),Re})})}else return null}}let GLTFMeshGpuInstancing$1=class{constructor(U){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=U}createNodeMesh(U){const Y=this.parser.json,ie=Y.nodes[U];if(!ie.extensions||!ie.extensions[this.name]||ie.mesh===void 0)return null;const ne=Y.meshes[ie.mesh];for(const ve of ne.primitives)if(ve.mode!==WEBGL_CONSTANTS$1.TRIANGLES&&ve.mode!==WEBGL_CONSTANTS$1.TRIANGLE_STRIP&&ve.mode!==WEBGL_CONSTANTS$1.TRIANGLE_FAN&&ve.mode!==void 0)return null;const fe=ie.extensions[this.name].attributes,pe=[],Me={};for(const ve in fe)pe.push(this.parser.getDependency("accessor",fe[ve]).then(se=>(Me[ve]=se,Me[ve])));return pe.length<1?null:(pe.push(this.parser.createNodeMesh(U)),Promise.all(pe).then(ve=>{const se=ve.pop(),me=se.isGroup?se.children:[se],Te=ve[0].count,Re=[];for(const be of me){const Pe=new Matrix4,Le=new Vector3,xe=new Quaternion,Fe=new Vector3(1,1,1),Oe=new InstancedMesh(be.geometry,be.material,Te);for(let Ne=0;Ne<Te;Ne++)Me.TRANSLATION&&Le.fromBufferAttribute(Me.TRANSLATION,Ne),Me.ROTATION&&xe.fromBufferAttribute(Me.ROTATION,Ne),Me.SCALE&&Fe.fromBufferAttribute(Me.SCALE,Ne),Oe.setMatrixAt(Ne,Pe.compose(Le,xe,Fe));for(const Ne in Me)if(Ne==="_COLOR_0"){const ke=Me[Ne];Oe.instanceColor=new InstancedBufferAttribute(ke.array,ke.itemSize,ke.normalized)}else Ne!=="TRANSLATION"&&Ne!=="ROTATION"&&Ne!=="SCALE"&&be.geometry.setAttribute(Ne,Me[Ne]);Object3D.prototype.copy.call(Oe,be),this.parser.assignFinalMaterial(Oe),Re.push(Oe)}return se.isGroup?(se.clear(),se.add(...Re),se):Re[0]}))}};const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(U){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const Y=new DataView(U,0,BINARY_EXTENSION_HEADER_LENGTH),ie=new TextDecoder;if(this.header={magic:ie.decode(new Uint8Array(U.slice(0,4))),version:Y.getUint32(4,!0),length:Y.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const ne=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,F=new DataView(U,BINARY_EXTENSION_HEADER_LENGTH);let fe=0;for(;fe<ne;){const pe=F.getUint32(fe,!0);fe+=4;const Me=F.getUint32(fe,!0);if(fe+=4,Me===BINARY_EXTENSION_CHUNK_TYPES.JSON){const ve=new Uint8Array(U,BINARY_EXTENSION_HEADER_LENGTH+fe,pe);this.content=ie.decode(ve)}else if(Me===BINARY_EXTENSION_CHUNK_TYPES.BIN){const ve=BINARY_EXTENSION_HEADER_LENGTH+fe;this.body=U.slice(ve,ve+pe)}fe+=pe}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(U,Y){if(!Y)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=U,this.dracoLoader=Y,this.dracoLoader.preload()}decodePrimitive(U,Y){const ie=this.json,ne=this.dracoLoader,F=U.extensions[this.name].bufferView,fe=U.extensions[this.name].attributes,pe={},Me={},ve={};for(const se in fe){const me=ATTRIBUTES[se]||se.toLowerCase();pe[me]=fe[se]}for(const se in U.attributes){const me=ATTRIBUTES[se]||se.toLowerCase();if(fe[se]!==void 0){const Te=ie.accessors[U.attributes[se]],Re=WEBGL_COMPONENT_TYPES[Te.componentType];ve[me]=Re.name,Me[me]=Te.normalized===!0}}return Y.getDependency("bufferView",F).then(function(se){return new Promise(function(me,Te){ne.decodeDracoFile(se,function(Re){for(const be in Re.attributes){const Pe=Re.attributes[be],Le=Me[be];Le!==void 0&&(Pe.normalized=Le)}me(Re)},pe,ve,LinearSRGBColorSpace,Te)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(U,Y){return(Y.texCoord===void 0||Y.texCoord===U.channel)&&Y.offset===void 0&&Y.rotation===void 0&&Y.scale===void 0||(U=U.clone(),Y.texCoord!==void 0&&(U.channel=Y.texCoord),Y.offset!==void 0&&U.offset.fromArray(Y.offset),Y.rotation!==void 0&&(U.rotation=Y.rotation),Y.scale!==void 0&&U.repeat.fromArray(Y.scale),U.needsUpdate=!0),U}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(U,Y,ie,ne){super(U,Y,ie,ne)}copySampleValue_(U){const Y=this.resultBuffer,ie=this.sampleValues,ne=this.valueSize,F=U*ne*3+ne;for(let fe=0;fe!==ne;fe++)Y[fe]=ie[F+fe];return Y}interpolate_(U,Y,ie,ne){const F=this.resultBuffer,fe=this.sampleValues,pe=this.valueSize,Me=pe*2,ve=pe*3,se=ne-Y,me=(ie-Y)/se,Te=me*me,Re=Te*me,be=U*ve,Pe=be-ve,Le=-2*Re+3*Te,xe=Re-Te,Fe=1-Le,Oe=xe-Te+me;for(let Ne=0;Ne!==pe;Ne++){const ke=fe[Pe+Ne+pe],Ve=fe[Pe+Ne+Me]*se,Xe=fe[be+Ne+pe],$e=fe[be+Ne]*se;F[Ne]=Fe*ke+Oe*Ve+Le*Xe+xe*$e}return F}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(U,Y,ie,ne){const F=super.interpolate_(U,Y,ie,ne);return _q.fromArray(F).normalize().toArray(F),F}}const WEBGL_CONSTANTS$1={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES$1={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(re){return re.DefaultMaterial===void 0&&(re.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),re.DefaultMaterial}function addUnknownExtensionsToUserData(re,U,Y){for(const ie in Y.extensions)re[ie]===void 0&&(U.userData.gltfExtensions=U.userData.gltfExtensions||{},U.userData.gltfExtensions[ie]=Y.extensions[ie])}function assignExtrasToUserData(re,U){U.extras!==void 0&&(typeof U.extras=="object"?Object.assign(re.userData,U.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+U.extras))}function addMorphTargets(re,U,Y){let ie=!1,ne=!1,F=!1;for(let ve=0,se=U.length;ve<se;ve++){const me=U[ve];if(me.POSITION!==void 0&&(ie=!0),me.NORMAL!==void 0&&(ne=!0),me.COLOR_0!==void 0&&(F=!0),ie&&ne&&F)break}if(!ie&&!ne&&!F)return Promise.resolve(re);const fe=[],pe=[],Me=[];for(let ve=0,se=U.length;ve<se;ve++){const me=U[ve];if(ie){const Te=me.POSITION!==void 0?Y.getDependency("accessor",me.POSITION):re.attributes.position;fe.push(Te)}if(ne){const Te=me.NORMAL!==void 0?Y.getDependency("accessor",me.NORMAL):re.attributes.normal;pe.push(Te)}if(F){const Te=me.COLOR_0!==void 0?Y.getDependency("accessor",me.COLOR_0):re.attributes.color;Me.push(Te)}}return Promise.all([Promise.all(fe),Promise.all(pe),Promise.all(Me)]).then(function(ve){const se=ve[0],me=ve[1],Te=ve[2];return ie&&(re.morphAttributes.position=se),ne&&(re.morphAttributes.normal=me),F&&(re.morphAttributes.color=Te),re.morphTargetsRelative=!0,re})}function updateMorphTargets(re,U){if(re.updateMorphTargets(),U.weights!==void 0)for(let Y=0,ie=U.weights.length;Y<ie;Y++)re.morphTargetInfluences[Y]=U.weights[Y];if(U.extras&&Array.isArray(U.extras.targetNames)){const Y=U.extras.targetNames;if(re.morphTargetInfluences.length===Y.length){re.morphTargetDictionary={};for(let ie=0,ne=Y.length;ie<ne;ie++)re.morphTargetDictionary[Y[ie]]=ie}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(re){let U;const Y=re.extensions&&re.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(Y?U="draco:"+Y.bufferView+":"+Y.indices+":"+createAttributesKey(Y.attributes):U=re.indices+":"+createAttributesKey(re.attributes)+":"+re.mode,re.targets!==void 0)for(let ie=0,ne=re.targets.length;ie<ne;ie++)U+=":"+createAttributesKey(re.targets[ie]);return U}function createAttributesKey(re){let U="";const Y=Object.keys(re).sort();for(let ie=0,ne=Y.length;ie<ne;ie++)U+=Y[ie]+":"+re[Y[ie]]+";";return U}function getNormalizedComponentScale(re){switch(re){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(re){return re.search(/\.jpe?g($|\?)/i)>0||re.search(/^data\:image\/jpeg/)===0?"image/jpeg":re.search(/\.webp($|\?)/i)>0||re.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(U={},Y={}){this.json=U,this.extensions={},this.plugins={},this.options=Y,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let ie=!1,ne=-1,F=!1,fe=-1;if(typeof navigator<"u"){const pe=navigator.userAgent;ie=/^((?!chrome|android).)*safari/i.test(pe)===!0;const Me=pe.match(/Version\/(\d+)/);ne=ie&&Me?parseInt(Me[1],10):-1,F=pe.indexOf("Firefox")>-1,fe=F?pe.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||ie&&ne<17||F&&fe<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(U){this.extensions=U}setPlugins(U){this.plugins=U}parse(U,Y){const ie=this,ne=this.json,F=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(fe){return fe._markDefs&&fe._markDefs()}),Promise.all(this._invokeAll(function(fe){return fe.beforeRoot&&fe.beforeRoot()})).then(function(){return Promise.all([ie.getDependencies("scene"),ie.getDependencies("animation"),ie.getDependencies("camera")])}).then(function(fe){const pe={scene:fe[0][ne.scene||0],scenes:fe[0],animations:fe[1],cameras:fe[2],asset:ne.asset,parser:ie,userData:{}};return addUnknownExtensionsToUserData(F,pe,ne),assignExtrasToUserData(pe,ne),Promise.all(ie._invokeAll(function(Me){return Me.afterRoot&&Me.afterRoot(pe)})).then(function(){for(const Me of pe.scenes)Me.updateMatrixWorld();U(pe)})}).catch(Y)}_markDefs(){const U=this.json.nodes||[],Y=this.json.skins||[],ie=this.json.meshes||[];for(let ne=0,F=Y.length;ne<F;ne++){const fe=Y[ne].joints;for(let pe=0,Me=fe.length;pe<Me;pe++)U[fe[pe]].isBone=!0}for(let ne=0,F=U.length;ne<F;ne++){const fe=U[ne];fe.mesh!==void 0&&(this._addNodeRef(this.meshCache,fe.mesh),fe.skin!==void 0&&(ie[fe.mesh].isSkinnedMesh=!0)),fe.camera!==void 0&&this._addNodeRef(this.cameraCache,fe.camera)}}_addNodeRef(U,Y){Y!==void 0&&(U.refs[Y]===void 0&&(U.refs[Y]=U.uses[Y]=0),U.refs[Y]++)}_getNodeRef(U,Y,ie){if(U.refs[Y]<=1)return ie;const ne=ie.clone(),F=(fe,pe)=>{const Me=this.associations.get(fe);Me!=null&&this.associations.set(pe,Me);for(const[ve,se]of fe.children.entries())F(se,pe.children[ve])};return F(ie,ne),ne.name+="_instance_"+U.uses[Y]++,ne}_invokeOne(U){const Y=Object.values(this.plugins);Y.push(this);for(let ie=0;ie<Y.length;ie++){const ne=U(Y[ie]);if(ne)return ne}return null}_invokeAll(U){const Y=Object.values(this.plugins);Y.unshift(this);const ie=[];for(let ne=0;ne<Y.length;ne++){const F=U(Y[ne]);F&&ie.push(F)}return ie}getDependency(U,Y){const ie=U+":"+Y;let ne=this.cache.get(ie);if(!ne){switch(U){case"scene":ne=this.loadScene(Y);break;case"node":ne=this._invokeOne(function(F){return F.loadNode&&F.loadNode(Y)});break;case"mesh":ne=this._invokeOne(function(F){return F.loadMesh&&F.loadMesh(Y)});break;case"accessor":ne=this.loadAccessor(Y);break;case"bufferView":ne=this._invokeOne(function(F){return F.loadBufferView&&F.loadBufferView(Y)});break;case"buffer":ne=this.loadBuffer(Y);break;case"material":ne=this._invokeOne(function(F){return F.loadMaterial&&F.loadMaterial(Y)});break;case"texture":ne=this._invokeOne(function(F){return F.loadTexture&&F.loadTexture(Y)});break;case"skin":ne=this.loadSkin(Y);break;case"animation":ne=this._invokeOne(function(F){return F.loadAnimation&&F.loadAnimation(Y)});break;case"camera":ne=this.loadCamera(Y);break;default:if(ne=this._invokeOne(function(F){return F!=this&&F.getDependency&&F.getDependency(U,Y)}),!ne)throw new Error("Unknown type: "+U);break}this.cache.add(ie,ne)}return ne}getDependencies(U){let Y=this.cache.get(U);if(!Y){const ie=this,ne=this.json[U+(U==="mesh"?"es":"s")]||[];Y=Promise.all(ne.map(function(F,fe){return ie.getDependency(U,fe)})),this.cache.add(U,Y)}return Y}loadBuffer(U){const Y=this.json.buffers[U],ie=this.fileLoader;if(Y.type&&Y.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+Y.type+" buffer type is not supported.");if(Y.uri===void 0&&U===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const ne=this.options;return new Promise(function(F,fe){ie.load(LoaderUtils.resolveURL(Y.uri,ne.path),F,void 0,function(){fe(new Error('THREE.GLTFLoader: Failed to load buffer "'+Y.uri+'".'))})})}loadBufferView(U){const Y=this.json.bufferViews[U];return this.getDependency("buffer",Y.buffer).then(function(ie){const ne=Y.byteLength||0,F=Y.byteOffset||0;return ie.slice(F,F+ne)})}loadAccessor(U){const Y=this,ie=this.json,ne=this.json.accessors[U];if(ne.bufferView===void 0&&ne.sparse===void 0){const fe=WEBGL_TYPE_SIZES[ne.type],pe=WEBGL_COMPONENT_TYPES[ne.componentType],Me=ne.normalized===!0,ve=new pe(ne.count*fe);return Promise.resolve(new BufferAttribute(ve,fe,Me))}const F=[];return ne.bufferView!==void 0?F.push(this.getDependency("bufferView",ne.bufferView)):F.push(null),ne.sparse!==void 0&&(F.push(this.getDependency("bufferView",ne.sparse.indices.bufferView)),F.push(this.getDependency("bufferView",ne.sparse.values.bufferView))),Promise.all(F).then(function(fe){const pe=fe[0],Me=WEBGL_TYPE_SIZES[ne.type],ve=WEBGL_COMPONENT_TYPES[ne.componentType],se=ve.BYTES_PER_ELEMENT,me=se*Me,Te=ne.byteOffset||0,Re=ne.bufferView!==void 0?ie.bufferViews[ne.bufferView].byteStride:void 0,be=ne.normalized===!0;let Pe,Le;if(Re&&Re!==me){const xe=Math.floor(Te/Re),Fe="InterleavedBuffer:"+ne.bufferView+":"+ne.componentType+":"+xe+":"+ne.count;let Oe=Y.cache.get(Fe);Oe||(Pe=new ve(pe,xe*Re,ne.count*Re/se),Oe=new InterleavedBuffer(Pe,Re/se),Y.cache.add(Fe,Oe)),Le=new InterleavedBufferAttribute(Oe,Me,Te%Re/se,be)}else pe===null?Pe=new ve(ne.count*Me):Pe=new ve(pe,Te,ne.count*Me),Le=new BufferAttribute(Pe,Me,be);if(ne.sparse!==void 0){const xe=WEBGL_TYPE_SIZES.SCALAR,Fe=WEBGL_COMPONENT_TYPES[ne.sparse.indices.componentType],Oe=ne.sparse.indices.byteOffset||0,Ne=ne.sparse.values.byteOffset||0,ke=new Fe(fe[1],Oe,ne.sparse.count*xe),Ve=new ve(fe[2],Ne,ne.sparse.count*Me);pe!==null&&(Le=new BufferAttribute(Le.array.slice(),Le.itemSize,Le.normalized)),Le.normalized=!1;for(let Xe=0,$e=ke.length;Xe<$e;Xe++){const st=ke[Xe];if(Le.setX(st,Ve[Xe*Me]),Me>=2&&Le.setY(st,Ve[Xe*Me+1]),Me>=3&&Le.setZ(st,Ve[Xe*Me+2]),Me>=4&&Le.setW(st,Ve[Xe*Me+3]),Me>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}Le.normalized=be}return Le})}loadTexture(U){const Y=this.json,ie=this.options,F=Y.textures[U].source,fe=Y.images[F];let pe=this.textureLoader;if(fe.uri){const Me=ie.manager.getHandler(fe.uri);Me!==null&&(pe=Me)}return this.loadTextureImage(U,F,pe)}loadTextureImage(U,Y,ie){const ne=this,F=this.json,fe=F.textures[U],pe=F.images[Y],Me=(pe.uri||pe.bufferView)+":"+fe.sampler;if(this.textureCache[Me])return this.textureCache[Me];const ve=this.loadImageSource(Y,ie).then(function(se){se.flipY=!1,se.name=fe.name||pe.name||"",se.name===""&&typeof pe.uri=="string"&&pe.uri.startsWith("data:image/")===!1&&(se.name=pe.uri);const Te=(F.samplers||{})[fe.sampler]||{};return se.magFilter=WEBGL_FILTERS[Te.magFilter]||LinearFilter,se.minFilter=WEBGL_FILTERS[Te.minFilter]||LinearMipmapLinearFilter,se.wrapS=WEBGL_WRAPPINGS[Te.wrapS]||RepeatWrapping,se.wrapT=WEBGL_WRAPPINGS[Te.wrapT]||RepeatWrapping,ne.associations.set(se,{textures:U}),se}).catch(function(){return null});return this.textureCache[Me]=ve,ve}loadImageSource(U,Y){const ie=this,ne=this.json,F=this.options;if(this.sourceCache[U]!==void 0)return this.sourceCache[U].then(me=>me.clone());const fe=ne.images[U],pe=self.URL||self.webkitURL;let Me=fe.uri||"",ve=!1;if(fe.bufferView!==void 0)Me=ie.getDependency("bufferView",fe.bufferView).then(function(me){ve=!0;const Te=new Blob([me],{type:fe.mimeType});return Me=pe.createObjectURL(Te),Me});else if(fe.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+U+" is missing URI and bufferView");const se=Promise.resolve(Me).then(function(me){return new Promise(function(Te,Re){let be=Te;Y.isImageBitmapLoader===!0&&(be=function(Pe){const Le=new Texture$1(Pe);Le.needsUpdate=!0,Te(Le)}),Y.load(LoaderUtils.resolveURL(me,F.path),be,void 0,Re)})}).then(function(me){return ve===!0&&pe.revokeObjectURL(Me),assignExtrasToUserData(me,fe),me.userData.mimeType=fe.mimeType||getImageURIMimeType(fe.uri),me}).catch(function(me){throw console.error("THREE.GLTFLoader: Couldn't load texture",Me),me});return this.sourceCache[U]=se,se}assignTexture(U,Y,ie,ne){const F=this;return this.getDependency("texture",ie.index).then(function(fe){if(!fe)return null;if(ie.texCoord!==void 0&&ie.texCoord>0&&(fe=fe.clone(),fe.channel=ie.texCoord),F.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const pe=ie.extensions!==void 0?ie.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(pe){const Me=F.associations.get(fe);fe=F.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(fe,pe),F.associations.set(fe,Me)}}return ne!==void 0&&(fe.colorSpace=ne),U[Y]=fe,fe})}assignFinalMaterial(U){const Y=U.geometry;let ie=U.material;const ne=Y.attributes.tangent===void 0,F=Y.attributes.color!==void 0,fe=Y.attributes.normal===void 0;if(U.isPoints){const pe="PointsMaterial:"+ie.uuid;let Me=this.cache.get(pe);Me||(Me=new PointsMaterial,Material$1.prototype.copy.call(Me,ie),Me.color.copy(ie.color),Me.map=ie.map,Me.sizeAttenuation=!1,this.cache.add(pe,Me)),ie=Me}else if(U.isLine){const pe="LineBasicMaterial:"+ie.uuid;let Me=this.cache.get(pe);Me||(Me=new LineBasicMaterial,Material$1.prototype.copy.call(Me,ie),Me.color.copy(ie.color),Me.map=ie.map,this.cache.add(pe,Me)),ie=Me}if(ne||F||fe){let pe="ClonedMaterial:"+ie.uuid+":";ne&&(pe+="derivative-tangents:"),F&&(pe+="vertex-colors:"),fe&&(pe+="flat-shading:");let Me=this.cache.get(pe);Me||(Me=ie.clone(),F&&(Me.vertexColors=!0),fe&&(Me.flatShading=!0),ne&&(Me.normalScale&&(Me.normalScale.y*=-1),Me.clearcoatNormalScale&&(Me.clearcoatNormalScale.y*=-1)),this.cache.add(pe,Me),this.associations.set(Me,this.associations.get(ie))),ie=Me}U.material=ie}getMaterialType(){return MeshStandardMaterial}loadMaterial(U){const Y=this,ie=this.json,ne=this.extensions,F=ie.materials[U];let fe;const pe={},Me=F.extensions||{},ve=[];if(Me[EXTENSIONS.KHR_MATERIALS_UNLIT]){const me=ne[EXTENSIONS.KHR_MATERIALS_UNLIT];fe=me.getMaterialType(),ve.push(me.extendParams(pe,F,Y))}else{const me=F.pbrMetallicRoughness||{};if(pe.color=new Color(1,1,1),pe.opacity=1,Array.isArray(me.baseColorFactor)){const Te=me.baseColorFactor;pe.color.setRGB(Te[0],Te[1],Te[2],LinearSRGBColorSpace),pe.opacity=Te[3]}me.baseColorTexture!==void 0&&ve.push(Y.assignTexture(pe,"map",me.baseColorTexture,SRGBColorSpace)),pe.metalness=me.metallicFactor!==void 0?me.metallicFactor:1,pe.roughness=me.roughnessFactor!==void 0?me.roughnessFactor:1,me.metallicRoughnessTexture!==void 0&&(ve.push(Y.assignTexture(pe,"metalnessMap",me.metallicRoughnessTexture)),ve.push(Y.assignTexture(pe,"roughnessMap",me.metallicRoughnessTexture))),fe=this._invokeOne(function(Te){return Te.getMaterialType&&Te.getMaterialType(U)}),ve.push(Promise.all(this._invokeAll(function(Te){return Te.extendMaterialParams&&Te.extendMaterialParams(U,pe)})))}F.doubleSided===!0&&(pe.side=DoubleSide);const se=F.alphaMode||ALPHA_MODES.OPAQUE;if(se===ALPHA_MODES.BLEND?(pe.transparent=!0,pe.depthWrite=!1):(pe.transparent=!1,se===ALPHA_MODES.MASK&&(pe.alphaTest=F.alphaCutoff!==void 0?F.alphaCutoff:.5)),F.normalTexture!==void 0&&fe!==MeshBasicMaterial&&(ve.push(Y.assignTexture(pe,"normalMap",F.normalTexture)),pe.normalScale=new Vector2(1,1),F.normalTexture.scale!==void 0)){const me=F.normalTexture.scale;pe.normalScale.set(me,me)}if(F.occlusionTexture!==void 0&&fe!==MeshBasicMaterial&&(ve.push(Y.assignTexture(pe,"aoMap",F.occlusionTexture)),F.occlusionTexture.strength!==void 0&&(pe.aoMapIntensity=F.occlusionTexture.strength)),F.emissiveFactor!==void 0&&fe!==MeshBasicMaterial){const me=F.emissiveFactor;pe.emissive=new Color().setRGB(me[0],me[1],me[2],LinearSRGBColorSpace)}return F.emissiveTexture!==void 0&&fe!==MeshBasicMaterial&&ve.push(Y.assignTexture(pe,"emissiveMap",F.emissiveTexture,SRGBColorSpace)),Promise.all(ve).then(function(){const me=new fe(pe);return F.name&&(me.name=F.name),assignExtrasToUserData(me,F),Y.associations.set(me,{materials:U}),F.extensions&&addUnknownExtensionsToUserData(ne,me,F),me})}createUniqueName(U){const Y=PropertyBinding.sanitizeNodeName(U||"");return Y in this.nodeNamesUsed?Y+"_"+ ++this.nodeNamesUsed[Y]:(this.nodeNamesUsed[Y]=0,Y)}loadGeometries(U){const Y=this,ie=this.extensions,ne=this.primitiveCache;function F(pe){return ie[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(pe,Y).then(function(Me){return addPrimitiveAttributes(Me,pe,Y)})}const fe=[];for(let pe=0,Me=U.length;pe<Me;pe++){const ve=U[pe],se=createPrimitiveKey(ve),me=ne[se];if(me)fe.push(me.promise);else{let Te;ve.extensions&&ve.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?Te=F(ve):Te=addPrimitiveAttributes(new BufferGeometry,ve,Y),ne[se]={primitive:ve,promise:Te},fe.push(Te)}}return Promise.all(fe)}loadMesh(U){const Y=this,ie=this.json,ne=this.extensions,F=ie.meshes[U],fe=F.primitives,pe=[];for(let Me=0,ve=fe.length;Me<ve;Me++){const se=fe[Me].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",fe[Me].material);pe.push(se)}return pe.push(Y.loadGeometries(fe)),Promise.all(pe).then(function(Me){const ve=Me.slice(0,Me.length-1),se=Me[Me.length-1],me=[];for(let Re=0,be=se.length;Re<be;Re++){const Pe=se[Re],Le=fe[Re];let xe;const Fe=ve[Re];if(Le.mode===WEBGL_CONSTANTS$1.TRIANGLES||Le.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP||Le.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN||Le.mode===void 0)xe=F.isSkinnedMesh===!0?new SkinnedMesh(Pe,Fe):new Mesh(Pe,Fe),xe.isSkinnedMesh===!0&&xe.normalizeSkinWeights(),Le.mode===WEBGL_CONSTANTS$1.TRIANGLE_STRIP?xe.geometry=toTrianglesDrawMode(xe.geometry,TriangleStripDrawMode):Le.mode===WEBGL_CONSTANTS$1.TRIANGLE_FAN&&(xe.geometry=toTrianglesDrawMode(xe.geometry,TriangleFanDrawMode));else if(Le.mode===WEBGL_CONSTANTS$1.LINES)xe=new LineSegments(Pe,Fe);else if(Le.mode===WEBGL_CONSTANTS$1.LINE_STRIP)xe=new Line(Pe,Fe);else if(Le.mode===WEBGL_CONSTANTS$1.LINE_LOOP)xe=new LineLoop(Pe,Fe);else if(Le.mode===WEBGL_CONSTANTS$1.POINTS)xe=new Points(Pe,Fe);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Le.mode);Object.keys(xe.geometry.morphAttributes).length>0&&updateMorphTargets(xe,F),xe.name=Y.createUniqueName(F.name||"mesh_"+U),assignExtrasToUserData(xe,F),Le.extensions&&addUnknownExtensionsToUserData(ne,xe,Le),Y.assignFinalMaterial(xe),me.push(xe)}for(let Re=0,be=me.length;Re<be;Re++)Y.associations.set(me[Re],{meshes:U,primitives:Re});if(me.length===1)return F.extensions&&addUnknownExtensionsToUserData(ne,me[0],F),me[0];const Te=new Group;F.extensions&&addUnknownExtensionsToUserData(ne,Te,F),Y.associations.set(Te,{meshes:U});for(let Re=0,be=me.length;Re<be;Re++)Te.add(me[Re]);return Te})}loadCamera(U){let Y;const ie=this.json.cameras[U],ne=ie[ie.type];if(!ne){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ie.type==="perspective"?Y=new PerspectiveCamera(MathUtils.radToDeg(ne.yfov),ne.aspectRatio||1,ne.znear||1,ne.zfar||2e6):ie.type==="orthographic"&&(Y=new OrthographicCamera(-ne.xmag,ne.xmag,ne.ymag,-ne.ymag,ne.znear,ne.zfar)),ie.name&&(Y.name=this.createUniqueName(ie.name)),assignExtrasToUserData(Y,ie),Promise.resolve(Y)}loadSkin(U){const Y=this.json.skins[U],ie=[];for(let ne=0,F=Y.joints.length;ne<F;ne++)ie.push(this._loadNodeShallow(Y.joints[ne]));return Y.inverseBindMatrices!==void 0?ie.push(this.getDependency("accessor",Y.inverseBindMatrices)):ie.push(null),Promise.all(ie).then(function(ne){const F=ne.pop(),fe=ne,pe=[],Me=[];for(let ve=0,se=fe.length;ve<se;ve++){const me=fe[ve];if(me){pe.push(me);const Te=new Matrix4;F!==null&&Te.fromArray(F.array,ve*16),Me.push(Te)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Y.joints[ve])}return new Skeleton(pe,Me)})}loadAnimation(U){const Y=this.json,ie=this,ne=Y.animations[U],F=ne.name?ne.name:"animation_"+U,fe=[],pe=[],Me=[],ve=[],se=[];for(let me=0,Te=ne.channels.length;me<Te;me++){const Re=ne.channels[me],be=ne.samplers[Re.sampler],Pe=Re.target,Le=Pe.node,xe=ne.parameters!==void 0?ne.parameters[be.input]:be.input,Fe=ne.parameters!==void 0?ne.parameters[be.output]:be.output;Pe.node!==void 0&&(fe.push(this.getDependency("node",Le)),pe.push(this.getDependency("accessor",xe)),Me.push(this.getDependency("accessor",Fe)),ve.push(be),se.push(Pe))}return Promise.all([Promise.all(fe),Promise.all(pe),Promise.all(Me),Promise.all(ve),Promise.all(se)]).then(function(me){const Te=me[0],Re=me[1],be=me[2],Pe=me[3],Le=me[4],xe=[];for(let Fe=0,Oe=Te.length;Fe<Oe;Fe++){const Ne=Te[Fe],ke=Re[Fe],Ve=be[Fe],Xe=Pe[Fe],$e=Le[Fe];if(Ne===void 0)continue;Ne.updateMatrix&&Ne.updateMatrix();const st=ie._createAnimationTracks(Ne,ke,Ve,Xe,$e);if(st)for(let ze=0;ze<st.length;ze++)xe.push(st[ze])}return new AnimationClip(F,void 0,xe)})}createNodeMesh(U){const Y=this.json,ie=this,ne=Y.nodes[U];return ne.mesh===void 0?null:ie.getDependency("mesh",ne.mesh).then(function(F){const fe=ie._getNodeRef(ie.meshCache,ne.mesh,F);return ne.weights!==void 0&&fe.traverse(function(pe){if(pe.isMesh)for(let Me=0,ve=ne.weights.length;Me<ve;Me++)pe.morphTargetInfluences[Me]=ne.weights[Me]}),fe})}loadNode(U){const Y=this.json,ie=this,ne=Y.nodes[U],F=ie._loadNodeShallow(U),fe=[],pe=ne.children||[];for(let ve=0,se=pe.length;ve<se;ve++)fe.push(ie.getDependency("node",pe[ve]));const Me=ne.skin===void 0?Promise.resolve(null):ie.getDependency("skin",ne.skin);return Promise.all([F,Promise.all(fe),Me]).then(function(ve){const se=ve[0],me=ve[1],Te=ve[2];Te!==null&&se.traverse(function(Re){Re.isSkinnedMesh&&Re.bind(Te,_identityMatrix)});for(let Re=0,be=me.length;Re<be;Re++)se.add(me[Re]);return se})}_loadNodeShallow(U){const Y=this.json,ie=this.extensions,ne=this;if(this.nodeCache[U]!==void 0)return this.nodeCache[U];const F=Y.nodes[U],fe=F.name?ne.createUniqueName(F.name):"",pe=[],Me=ne._invokeOne(function(ve){return ve.createNodeMesh&&ve.createNodeMesh(U)});return Me&&pe.push(Me),F.camera!==void 0&&pe.push(ne.getDependency("camera",F.camera).then(function(ve){return ne._getNodeRef(ne.cameraCache,F.camera,ve)})),ne._invokeAll(function(ve){return ve.createNodeAttachment&&ve.createNodeAttachment(U)}).forEach(function(ve){pe.push(ve)}),this.nodeCache[U]=Promise.all(pe).then(function(ve){let se;if(F.isBone===!0?se=new Bone:ve.length>1?se=new Group:ve.length===1?se=ve[0]:se=new Object3D,se!==ve[0])for(let me=0,Te=ve.length;me<Te;me++)se.add(ve[me]);if(F.name&&(se.userData.name=F.name,se.name=fe),assignExtrasToUserData(se,F),F.extensions&&addUnknownExtensionsToUserData(ie,se,F),F.matrix!==void 0){const me=new Matrix4;me.fromArray(F.matrix),se.applyMatrix4(me)}else F.translation!==void 0&&se.position.fromArray(F.translation),F.rotation!==void 0&&se.quaternion.fromArray(F.rotation),F.scale!==void 0&&se.scale.fromArray(F.scale);return ne.associations.has(se)||ne.associations.set(se,{}),ne.associations.get(se).nodes=U,se}),this.nodeCache[U]}loadScene(U){const Y=this.extensions,ie=this.json.scenes[U],ne=this,F=new Group;ie.name&&(F.name=ne.createUniqueName(ie.name)),assignExtrasToUserData(F,ie),ie.extensions&&addUnknownExtensionsToUserData(Y,F,ie);const fe=ie.nodes||[],pe=[];for(let Me=0,ve=fe.length;Me<ve;Me++)pe.push(ne.getDependency("node",fe[Me]));return Promise.all(pe).then(function(Me){for(let se=0,me=Me.length;se<me;se++)F.add(Me[se]);const ve=se=>{const me=new Map;for(const[Te,Re]of ne.associations)(Te instanceof Material$1||Te instanceof Texture$1)&&me.set(Te,Re);return se.traverse(Te=>{const Re=ne.associations.get(Te);Re!=null&&me.set(Te,Re)}),me};return ne.associations=ve(F),F})}_createAnimationTracks(U,Y,ie,ne,F){const fe=[],pe=U.name?U.name:U.uuid,Me=[];PATH_PROPERTIES$1[F.path]===PATH_PROPERTIES$1.weights?U.traverse(function(Te){Te.morphTargetInfluences&&Me.push(Te.name?Te.name:Te.uuid)}):Me.push(pe);let ve;switch(PATH_PROPERTIES$1[F.path]){case PATH_PROPERTIES$1.weights:ve=NumberKeyframeTrack;break;case PATH_PROPERTIES$1.rotation:ve=QuaternionKeyframeTrack;break;case PATH_PROPERTIES$1.position:case PATH_PROPERTIES$1.scale:ve=VectorKeyframeTrack;break;default:switch(ie.itemSize){case 1:ve=NumberKeyframeTrack;break;case 2:case 3:default:ve=VectorKeyframeTrack;break}break}const se=ne.interpolation!==void 0?INTERPOLATION[ne.interpolation]:InterpolateLinear,me=this._getArrayFromAccessor(ie);for(let Te=0,Re=Me.length;Te<Re;Te++){const be=new ve(Me[Te]+"."+PATH_PROPERTIES$1[F.path],Y.array,me,se);ne.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(be),fe.push(be)}return fe}_getArrayFromAccessor(U){let Y=U.array;if(U.normalized){const ie=getNormalizedComponentScale(Y.constructor),ne=new Float32Array(Y.length);for(let F=0,fe=Y.length;F<fe;F++)ne[F]=Y[F]*ie;Y=ne}return Y}_createCubicSplineTrackInterpolant(U){U.createInterpolant=function(ie){const ne=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new ne(this.times,this.values,this.getValueSize()/3,ie)},U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(re,U,Y){const ie=U.attributes,ne=new Box3;if(ie.POSITION!==void 0){const pe=Y.json.accessors[ie.POSITION],Me=pe.min,ve=pe.max;if(Me!==void 0&&ve!==void 0){if(ne.set(new Vector3(Me[0],Me[1],Me[2]),new Vector3(ve[0],ve[1],ve[2])),pe.normalized){const se=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[pe.componentType]);ne.min.multiplyScalar(se),ne.max.multiplyScalar(se)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const F=U.targets;if(F!==void 0){const pe=new Vector3,Me=new Vector3;for(let ve=0,se=F.length;ve<se;ve++){const me=F[ve];if(me.POSITION!==void 0){const Te=Y.json.accessors[me.POSITION],Re=Te.min,be=Te.max;if(Re!==void 0&&be!==void 0){if(Me.setX(Math.max(Math.abs(Re[0]),Math.abs(be[0]))),Me.setY(Math.max(Math.abs(Re[1]),Math.abs(be[1]))),Me.setZ(Math.max(Math.abs(Re[2]),Math.abs(be[2]))),Te.normalized){const Pe=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[Te.componentType]);Me.multiplyScalar(Pe)}pe.max(Me)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ne.expandByVector(pe)}re.boundingBox=ne;const fe=new Sphere;ne.getCenter(fe.center),fe.radius=ne.min.distanceTo(ne.max)/2,re.boundingSphere=fe}function addPrimitiveAttributes(re,U,Y){const ie=U.attributes,ne=[];function F(fe,pe){return Y.getDependency("accessor",fe).then(function(Me){re.setAttribute(pe,Me)})}for(const fe in ie){const pe=ATTRIBUTES[fe]||fe.toLowerCase();pe in re.attributes||ne.push(F(ie[fe],pe))}if(U.indices!==void 0&&!re.index){const fe=Y.getDependency("accessor",U.indices).then(function(pe){re.setIndex(pe)});ne.push(fe)}return ColorManagement.workingColorSpace!==LinearSRGBColorSpace&&"COLOR_0"in ie&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${ColorManagement.workingColorSpace}" not supported.`),assignExtrasToUserData(re,U),computeBounds(re,U,Y),Promise.all(ne).then(function(){return U.targets!==void 0?addMorphTargets(re,U.targets,Y):re})}class WorkerPool{constructor(U=4){this.pool=U,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(U){if(!this.workers[U]){const Y=this.workerCreator();Y.addEventListener("message",this._onMessage.bind(this,U)),this.workers[U]=Y}}_getIdleWorker(){for(let U=0;U<this.pool;U++)if(!(this.workerStatus&1<<U))return U;return-1}_onMessage(U,Y){const ie=this.workersResolve[U];if(ie&&ie(Y),this.queue.length){const{resolve:ne,msg:F,transfer:fe}=this.queue.shift();this.workersResolve[U]=ne,this.workers[U].postMessage(F,fe)}else this.workerStatus^=1<<U}setWorkerCreator(U){this.workerCreator=U}setWorkerLimit(U){this.pool=U}postMessage(U,Y){return new Promise(ie=>{const ne=this._getIdleWorker();ne!==-1?(this._initWorker(ne),this.workerStatus|=1<<ne,this.workersResolve[ne]=ie,this.workers[ne].postMessage(U,Y)):this.queue.push({resolve:ie,msg:U,transfer:Y})})}dispose(){this.workers.forEach(U=>U.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const t=0,n=2,g$1=1,u=2,T=0,C$1=1,R=10,it=0,ct=9,yt=15,xt=16,wt=22,Ft=37,Ct=43,te$1=76,ae=83,ge=97,ue=100,we=103,Ae=109,In=165,Sn=166,pi=1000066e3;class Ii{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Si{constructor(U,Y,ie,ne){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(U.buffer,U.byteOffset+Y,ie),this._littleEndian=ne,this._offset=0}_nextUint8(){const U=this._dataView.getUint8(this._offset);return this._offset+=1,U}_nextUint16(){const U=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,U}_nextUint32(){const U=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,U}_nextUint64(){const U=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,U}_nextInt32(){const U=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,U}_nextUint8Array(U){const Y=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,U);return this._offset+=U,Y}_skip(U){return this._offset+=U,this}_scan(U,Y){Y===void 0&&(Y=0);const ie=this._offset;let ne=0;for(;this._dataView.getUint8(this._offset)!==Y&&ne<U;)ne++,this._offset++;return ne<U&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+ie,ne)}}const Oi=[171,75,84,88,32,50,48,187,13,10,26,10];function Ti(re){return new TextDecoder().decode(re)}function Pi(re){const U=new Uint8Array(re.buffer,re.byteOffset,Oi.length);if(U[0]!==Oi[0]||U[1]!==Oi[1]||U[2]!==Oi[2]||U[3]!==Oi[3]||U[4]!==Oi[4]||U[5]!==Oi[5]||U[6]!==Oi[6]||U[7]!==Oi[7]||U[8]!==Oi[8]||U[9]!==Oi[9]||U[10]!==Oi[10]||U[11]!==Oi[11])throw new Error("Missing KTX 2.0 identifier.");const Y=new Ii,ie=17*Uint32Array.BYTES_PER_ELEMENT,ne=new Si(re,Oi.length,ie,!0);Y.vkFormat=ne._nextUint32(),Y.typeSize=ne._nextUint32(),Y.pixelWidth=ne._nextUint32(),Y.pixelHeight=ne._nextUint32(),Y.pixelDepth=ne._nextUint32(),Y.layerCount=ne._nextUint32(),Y.faceCount=ne._nextUint32();const F=ne._nextUint32();Y.supercompressionScheme=ne._nextUint32();const fe=ne._nextUint32(),pe=ne._nextUint32(),Me=ne._nextUint32(),ve=ne._nextUint32(),se=ne._nextUint64(),me=ne._nextUint64(),Te=new Si(re,Oi.length+ie,3*F*8,!0);for(let Bt=0;Bt<F;Bt++)Y.levels.push({levelData:new Uint8Array(re.buffer,re.byteOffset+Te._nextUint64(),Te._nextUint64()),uncompressedByteLength:Te._nextUint64()});const Re=new Si(re,fe,pe,!0),be={vendorId:Re._skip(4)._nextUint16(),descriptorType:Re._nextUint16(),versionNumber:Re._nextUint16(),descriptorBlockSize:Re._nextUint16(),colorModel:Re._nextUint8(),colorPrimaries:Re._nextUint8(),transferFunction:Re._nextUint8(),flags:Re._nextUint8(),texelBlockDimension:[Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8()],bytesPlane:[Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8()],samples:[]},Pe=(be.descriptorBlockSize/4-6)/4;for(let Bt=0;Bt<Pe;Bt++){const dt={bitOffset:Re._nextUint16(),bitLength:Re._nextUint8(),channelType:Re._nextUint8(),samplePosition:[Re._nextUint8(),Re._nextUint8(),Re._nextUint8(),Re._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&dt.channelType?(dt.sampleLower=Re._nextInt32(),dt.sampleUpper=Re._nextInt32()):(dt.sampleLower=Re._nextUint32(),dt.sampleUpper=Re._nextUint32()),be.samples[Bt]=dt}Y.dataFormatDescriptor.length=0,Y.dataFormatDescriptor.push(be);const Le=new Si(re,Me,ve,!0);for(;Le._offset<ve;){const Bt=Le._nextUint32(),dt=Le._scan(Bt),ut=Ti(dt);if(Y.keyValue[ut]=Le._nextUint8Array(Bt-dt.byteLength-1),ut.match(/^ktx/i)){const Ut=Ti(Y.keyValue[ut]);Y.keyValue[ut]=Ut.substring(0,Ut.lastIndexOf("\0"))}Le._skip(Bt%4?4-Bt%4:0)}if(me<=0)return Y;const xe=new Si(re,se,me,!0),Fe=xe._nextUint16(),Oe=xe._nextUint16(),Ne=xe._nextUint32(),ke=xe._nextUint32(),Ve=xe._nextUint32(),Xe=xe._nextUint32(),$e=[];for(let Bt=0;Bt<F;Bt++)$e.push({imageFlags:xe._nextUint32(),rgbSliceByteOffset:xe._nextUint32(),rgbSliceByteLength:xe._nextUint32(),alphaSliceByteOffset:xe._nextUint32(),alphaSliceByteLength:xe._nextUint32()});const st=se+xe._offset,ze=st+Ne,tt=ze+ke,ft=tt+Ve,Rt=new Uint8Array(re.buffer,re.byteOffset+st,Ne),Mt=new Uint8Array(re.buffer,re.byteOffset+ze,ke),Gt=new Uint8Array(re.buffer,re.byteOffset+tt,Ve),_t=new Uint8Array(re.buffer,re.byteOffset+ft,Xe);return Y.globalData={endpointCount:Fe,selectorCount:Oe,imageDescs:$e,endpointsData:Rt,selectorsData:Mt,tablesData:Gt,extendedData:_t},Y}let A,I,B;const g={env:{emscripten_notify_memory_growth:function(re){B=new Uint8Array(I.exports.memory.buffer)}}};class Q{init(){return A||(A=typeof fetch<"u"?fetch("data:application/wasm;base64,"+C).then(U=>U.arrayBuffer()).then(U=>WebAssembly.instantiate(U,g)).then(this._init):WebAssembly.instantiate(Buffer.from(C,"base64"),g).then(this._init),A)}_init(U){I=U.instance,g.env.emscripten_notify_memory_growth(0)}decode(U,Y=0){if(!I)throw new Error("ZSTDDecoder: Await .init() before decoding.");const ie=U.byteLength,ne=I.exports.malloc(ie);B.set(U,ne),Y=Y||Number(I.exports.ZSTD_findDecompressedSize(ne,ie));const F=I.exports.malloc(Y),fe=I.exports.ZSTD_decompress(F,Y,ne,ie),pe=B.slice(F,F+fe);return I.exports.free(ne),I.exports.free(F),pe}}const C="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",_taskCache=new WeakMap;let _activeLoaders=0,_zstd;class KTX2Loader extends Loader{constructor(U){super(U),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(U){return this.transcoderPath=U,this}setWorkerLimit(U){return this.workerPool.setWorkerLimit(U),this}async detectSupportAsync(U){return this.workerConfig={astcSupported:await U.hasFeatureAsync("texture-compression-astc"),etc1Supported:await U.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await U.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await U.hasFeatureAsync("texture-compression-bc"),bptcSupported:await U.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await U.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(U){return U.isWebGPURenderer===!0?this.workerConfig={astcSupported:U.hasFeature("texture-compression-astc"),etc1Supported:U.hasFeature("texture-compression-etc1"),etc2Supported:U.hasFeature("texture-compression-etc2"),dxtSupported:U.hasFeature("texture-compression-bc"),bptcSupported:U.hasFeature("texture-compression-bptc"),pvrtcSupported:U.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:U.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:U.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:U.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:U.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:U.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:U.extensions.has("WEBGL_compressed_texture_pvrtc")||U.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const U=new FileLoader(this.manager);U.setPath(this.transcoderPath),U.setWithCredentials(this.withCredentials);const Y=U.loadAsync("basis_transcoder.js"),ie=new FileLoader(this.manager);ie.setPath(this.transcoderPath),ie.setResponseType("arraybuffer"),ie.setWithCredentials(this.withCredentials);const ne=ie.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([Y,ne]).then(([F,fe])=>{const pe=KTX2Loader.BasisWorker.toString(),Me=["/* constants */","let _EngineFormat = "+JSON.stringify(KTX2Loader.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(KTX2Loader.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(KTX2Loader.BasisFormat),"/* basis_transcoder.js */",F,"/* worker */",pe.substring(pe.indexOf("{")+1,pe.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Me])),this.transcoderBinary=fe,this.workerPool.setWorkerCreator(()=>{const ve=new Worker(this.workerSourceURL),se=this.transcoderBinary.slice(0);return ve.postMessage({type:"init",config:this.workerConfig,transcoderBinary:se},[se]),ve})}),_activeLoaders>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),_activeLoaders++}return this.transcoderPending}load(U,Y,ie,ne){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const F=new FileLoader(this.manager);F.setResponseType("arraybuffer"),F.setWithCredentials(this.withCredentials),F.load(U,fe=>{this.parse(fe,Y,ne)},ie,ne)}parse(U,Y,ie){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(_taskCache.has(U))return _taskCache.get(U).promise.then(Y).catch(ie);this._createTexture(U).then(ne=>Y?Y(ne):null).catch(ie)}_createTextureFrom(U,Y){const{faces:ie,width:ne,height:F,format:fe,type:pe,error:Me,dfdFlags:ve}=U;if(pe==="error")return Promise.reject(Me);let se;if(Y.faceCount===6)se=new CompressedCubeTexture(ie,fe,UnsignedByteType);else{const me=ie[0].mipmaps;se=Y.layerCount>1?new CompressedArrayTexture(me,ne,F,Y.layerCount,fe,UnsignedByteType):new CompressedTexture(me,ne,F,fe,UnsignedByteType)}return se.minFilter=ie[0].mipmaps.length===1?LinearFilter:LinearMipmapLinearFilter,se.magFilter=LinearFilter,se.generateMipmaps=!1,se.needsUpdate=!0,se.colorSpace=parseColorSpace(Y),se.premultiplyAlpha=!!(ve&g$1),se}async _createTexture(U,Y={}){const ie=Pi(new Uint8Array(U));if(ie.vkFormat!==it)return createRawTexture(ie);const ne=Y,F=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:U,taskConfig:ne},[U])).then(fe=>this._createTextureFrom(fe.data,ie));return _taskCache.set(U,{promise:F}),F}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),_activeLoaders--,this}}KTX2Loader.BasisFormat={ETC1S:0,UASTC_4x4:1};KTX2Loader.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16};KTX2Loader.EngineFormat={RGBAFormat,RGBA_ASTC_4x4_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format};KTX2Loader.BasisWorker=function(){let re,U,Y;const ie=_EngineFormat,ne=_TranscoderFormat,F=_BasisFormat;self.addEventListener("message",function(be){const Pe=be.data;switch(Pe.type){case"init":re=Pe.config,fe(Pe.transcoderBinary);break;case"transcode":U.then(()=>{try{const{faces:Le,buffers:xe,width:Fe,height:Oe,hasAlpha:Ne,format:ke,dfdFlags:Ve}=pe(Pe.buffer);self.postMessage({type:"transcode",id:Pe.id,faces:Le,width:Fe,height:Oe,hasAlpha:Ne,format:ke,dfdFlags:Ve},xe)}catch(Le){console.error(Le),self.postMessage({type:"error",id:Pe.id,error:Le.message})}});break}});function fe(be){U=new Promise(Pe=>{Y={wasmBinary:be,onRuntimeInitialized:Pe},BASIS(Y)}).then(()=>{Y.initializeBasis(),Y.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function pe(be){const Pe=new Y.KTX2File(new Uint8Array(be));function Le(){Pe.close(),Pe.delete()}if(!Pe.isValid())throw Le(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const xe=Pe.isUASTC()?F.UASTC_4x4:F.ETC1S,Fe=Pe.getWidth(),Oe=Pe.getHeight(),Ne=Pe.getLayers()||1,ke=Pe.getLevels(),Ve=Pe.getFaces(),Xe=Pe.getHasAlpha(),$e=Pe.getDFDFlags(),{transcoderFormat:st,engineFormat:ze}=me(xe,Fe,Oe,Xe);if(!Fe||!Oe||!ke)throw Le(),new Error("THREE.KTX2Loader:	Invalid texture");if(!Pe.startTranscoding())throw Le(),new Error("THREE.KTX2Loader: .startTranscoding failed");const tt=[],ft=[];for(let Rt=0;Rt<Ve;Rt++){const Mt=[];for(let Gt=0;Gt<ke;Gt++){const _t=[];let Bt,dt;for(let Ut=0;Ut<Ne;Ut++){const Tt=Pe.getImageLevelInfo(Gt,Ut,Rt);Rt===0&&Gt===0&&Ut===0&&(Tt.origWidth%4!==0||Tt.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),ke>1?(Bt=Tt.origWidth,dt=Tt.origHeight):(Bt=Tt.width,dt=Tt.height);const Xt=new Uint8Array(Pe.getImageTranscodedSizeInBytes(Gt,Ut,0,st));if(!Pe.transcodeImage(Xt,Gt,Ut,Rt,st,0,-1,-1))throw Le(),new Error("THREE.KTX2Loader: .transcodeImage failed.");_t.push(Xt)}const ut=Re(_t);Mt.push({data:ut,width:Bt,height:dt}),ft.push(ut.buffer)}tt.push({mipmaps:Mt,width:Fe,height:Oe,format:ze})}return Le(),{faces:tt,buffers:ft,width:Fe,height:Oe,hasAlpha:Xe,format:ze,dfdFlags:$e}}const Me=[{if:"astcSupported",basisFormat:[F.UASTC_4x4],transcoderFormat:[ne.ASTC_4x4,ne.ASTC_4x4],engineFormat:[ie.RGBA_ASTC_4x4_Format,ie.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[ne.BC7_M5,ne.BC7_M5],engineFormat:[ie.RGBA_BPTC_Format,ie.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[ne.BC1,ne.BC3],engineFormat:[ie.RGBA_S3TC_DXT1_Format,ie.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[ne.ETC1,ne.ETC2],engineFormat:[ie.RGB_ETC2_Format,ie.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[ne.ETC1],engineFormat:[ie.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[F.ETC1S,F.UASTC_4x4],transcoderFormat:[ne.PVRTC1_4_RGB,ne.PVRTC1_4_RGBA],engineFormat:[ie.RGB_PVRTC_4BPPV1_Format,ie.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],ve=Me.sort(function(be,Pe){return be.priorityETC1S-Pe.priorityETC1S}),se=Me.sort(function(be,Pe){return be.priorityUASTC-Pe.priorityUASTC});function me(be,Pe,Le,xe){let Fe,Oe;const Ne=be===F.ETC1S?ve:se;for(let ke=0;ke<Ne.length;ke++){const Ve=Ne[ke];if(re[Ve.if]&&Ve.basisFormat.includes(be)&&!(xe&&Ve.transcoderFormat.length<2)&&!(Ve.needsPowerOfTwo&&!(Te(Pe)&&Te(Le))))return Fe=Ve.transcoderFormat[xe?1:0],Oe=Ve.engineFormat[xe?1:0],{transcoderFormat:Fe,engineFormat:Oe}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),Fe=ne.RGBA32,Oe=ie.RGBAFormat,{transcoderFormat:Fe,engineFormat:Oe}}function Te(be){return be<=2?!0:(be&be-1)===0&&be!==0}function Re(be){if(be.length===1)return be[0];let Pe=0;for(let Fe=0;Fe<be.length;Fe++){const Oe=be[Fe];Pe+=Oe.byteLength}const Le=new Uint8Array(Pe);let xe=0;for(let Fe=0;Fe<be.length;Fe++){const Oe=be[Fe];Le.set(Oe,xe),xe+=Oe.byteLength}return Le}};const UNCOMPRESSED_FORMATS=new Set([RGBAFormat,RGFormat,RedFormat]),FORMAT_MAP={[Ae]:RGBAFormat,[ge]:RGBAFormat,[Ft]:RGBAFormat,[Ct]:RGBAFormat,[we]:RGFormat,[ae]:RGFormat,[xt]:RGFormat,[wt]:RGFormat,[ue]:RedFormat,[te$1]:RedFormat,[yt]:RedFormat,[ct]:RedFormat,[pi]:RGBA_ASTC_4x4_Format,[Sn]:RGBA_ASTC_6x6_Format,[In]:RGBA_ASTC_6x6_Format},TYPE_MAP={[Ae]:FloatType,[ge]:HalfFloatType,[Ft]:UnsignedByteType,[Ct]:UnsignedByteType,[we]:FloatType,[ae]:HalfFloatType,[xt]:UnsignedByteType,[wt]:UnsignedByteType,[ue]:FloatType,[te$1]:HalfFloatType,[yt]:UnsignedByteType,[ct]:UnsignedByteType,[pi]:HalfFloatType,[Sn]:UnsignedByteType,[In]:UnsignedByteType};async function createRawTexture(re){const{vkFormat:U}=re;if(FORMAT_MAP[U]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let Y;re.supercompressionScheme===n&&(_zstd||(_zstd=new Promise(async F=>{const fe=new Q;await fe.init(),F(fe)})),Y=await _zstd);const ie=[];for(let F=0;F<re.levels.length;F++){const fe=Math.max(1,re.pixelWidth>>F),pe=Math.max(1,re.pixelHeight>>F),Me=re.pixelDepth?Math.max(1,re.pixelDepth>>F):0,ve=re.levels[F];let se;if(re.supercompressionScheme===t)se=ve.levelData;else if(re.supercompressionScheme===n)se=Y.decode(ve.levelData,ve.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let me;TYPE_MAP[U]===FloatType?me=new Float32Array(se.buffer,se.byteOffset,se.byteLength/Float32Array.BYTES_PER_ELEMENT):TYPE_MAP[U]===HalfFloatType?me=new Uint16Array(se.buffer,se.byteOffset,se.byteLength/Uint16Array.BYTES_PER_ELEMENT):me=se,ie.push({data:me,width:fe,height:pe,depth:Me})}let ne;if(UNCOMPRESSED_FORMATS.has(FORMAT_MAP[U]))ne=re.pixelDepth===0?new DataTexture(ie[0].data,re.pixelWidth,re.pixelHeight):new Data3DTexture(ie[0].data,re.pixelWidth,re.pixelHeight,re.pixelDepth);else{if(re.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");ne=new CompressedTexture(ie,re.pixelWidth,re.pixelHeight)}return ne.mipmaps=ie,ne.type=TYPE_MAP[U],ne.format=FORMAT_MAP[U],ne.colorSpace=parseColorSpace(re),ne.needsUpdate=!0,Promise.resolve(ne)}function parseColorSpace(re){const U=re.dataFormatDescriptor[0];return U.colorPrimaries===C$1?U.transferFunction===u?SRGBColorSpace:LinearSRGBColorSpace:U.colorPrimaries===R?U.transferFunction===u?DisplayP3ColorSpace:LinearDisplayP3ColorSpace:(U.colorPrimaries===T||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${U.colorPrimaries}"`),NoColorSpace)}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$9,_b$9;const $retainerCount=Symbol("retainerCount"),$recentlyUsed=Symbol("recentlyUsed"),$evict=Symbol("evict"),$evictionThreshold=Symbol("evictionThreshold"),$cache=Symbol("cache");class CacheEvictionPolicy{constructor(U,Y=5){this[_a$9]=new Map,this[_b$9]=[],this[$cache]=U,this[$evictionThreshold]=Y}set evictionThreshold(U){this[$evictionThreshold]=U,this[$evict]()}get evictionThreshold(){return this[$evictionThreshold]}get cache(){return this[$cache]}retainerCount(U){return this[$retainerCount].get(U)||0}reset(){this[$retainerCount].clear(),this[$recentlyUsed]=[]}retain(U){this[$retainerCount].has(U)||this[$retainerCount].set(U,0),this[$retainerCount].set(U,this[$retainerCount].get(U)+1);const Y=this[$recentlyUsed].indexOf(U);Y!==-1&&this[$recentlyUsed].splice(Y,1),this[$recentlyUsed].unshift(U),this[$evict]()}release(U){this[$retainerCount].has(U)&&this[$retainerCount].set(U,Math.max(this[$retainerCount].get(U)-1,0)),this[$evict]()}[(_a$9=$retainerCount,_b$9=$recentlyUsed,$evict)](){if(!(this[$recentlyUsed].length<this[$evictionThreshold]))for(let U=this[$recentlyUsed].length-1;U>=this[$evictionThreshold];--U){const Y=this[$recentlyUsed][U];this[$retainerCount].get(Y)===0&&(this[$cache].delete(Y),this[$recentlyUsed].splice(U,1))}}}/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ensureUniqueNames=re=>{const U=[],Y=new Set;for(const ie of re){let ne=ie,F=0;for(;Y.has(ne);)ne=ie+"."+ ++F;Y.add(ne),U.push(ne)}return U},mappingsArrayToTable=re=>{const U=new Map;for(const Y of re.mappings)for(const ie of Y.variants)U.set(ie,{material:null,gltfMaterialIndex:Y.material});return U};class GLTFMaterialsVariantsExtension{constructor(U){this.parser=U,this.name="KHR_materials_variants"}afterRoot(U){const Y=this.parser,ie=Y.json;if(ie.extensions===void 0||ie.extensions[this.name]===void 0)return null;const F=ie.extensions[this.name].variants||[],fe=ensureUniqueNames(F.map(pe=>pe.name));for(const pe of U.scenes)pe.traverse(Me=>{const ve=Me;if(!ve.material)return;const se=Y.associations.get(ve);if(se==null||se.meshes==null||se.primitives==null)return;const be=ie.meshes[se.meshes].primitives[se.primitives].extensions;!be||!be[this.name]||(ve.userData.variantMaterials=mappingsArrayToTable(be[this.name]))});return U.userData.variants=fe,Promise.resolve()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$8,_b$8;Texture$1.DEFAULT_ANISOTROPY=4;const loadWithLoader=(re,U,Y=()=>{})=>{const ie=ne=>{const F=ne.loaded/ne.total;Y(Math.max(0,Math.min(1,isFinite(F)?F:1)))};return new Promise((ne,F)=>{U.load(re,ne,ie,F)})},fetchScript=re=>new Promise((U,Y)=>{const ie=document.createElement("script");document.body.appendChild(ie),ie.onload=U,ie.onerror=Y,ie.async=!0,ie.src=re}),cache=new Map,preloaded=new Map;let dracoDecoderLocation;const dracoLoader=new DRACOLoader;let ktx2TranscoderLocation;const ktx2Loader=new KTX2Loader;let meshoptDecoderLocation,meshoptDecoder;const $loader=Symbol("loader"),$evictionPolicy=Symbol("evictionPolicy"),$GLTFInstance=Symbol("GLTFInstance");class CachingGLTFLoader extends EventDispatcher{constructor(U){super(),this[_b$8]=new GLTFLoader().register(Y=>new GLTFMaterialsVariantsExtension(Y)),this[$GLTFInstance]=U,this[$loader].setDRACOLoader(dracoLoader),this[$loader].setKTX2Loader(ktx2Loader)}static setDRACODecoderLocation(U){dracoDecoderLocation=U,dracoLoader.setDecoderPath(U)}static getDRACODecoderLocation(){return dracoDecoderLocation}static setKTX2TranscoderLocation(U){ktx2TranscoderLocation=U,ktx2Loader.setTranscoderPath(U)}static getKTX2TranscoderLocation(){return ktx2TranscoderLocation}static setMeshoptDecoderLocation(U){meshoptDecoderLocation!==U&&(meshoptDecoderLocation=U,meshoptDecoder=fetchScript(U).then(()=>MeshoptDecoder.ready).then(()=>MeshoptDecoder))}static getMeshoptDecoderLocation(){return meshoptDecoderLocation}static initializeKTX2Loader(U){ktx2Loader.detectSupport(U)}static get cache(){return cache}static clearCache(){cache.forEach((U,Y)=>{this.delete(Y)}),this[$evictionPolicy].reset()}static has(U){return cache.has(U)}static async delete(U){if(!this.has(U))return;const Y=cache.get(U);preloaded.delete(U),cache.delete(U),(await Y).dispose()}static hasFinishedLoading(U){return!!preloaded.get(U)}get[(_a$8=$evictionPolicy,_b$8=$loader,$evictionPolicy)](){return this.constructor[$evictionPolicy]}async preload(U,Y,ie=()=>{}){if(this[$loader].setWithCredentials(Y.withCredentials),this.dispatchEvent({type:"preload",element:Y,src:U}),!cache.has(U)){meshoptDecoder!=null&&this[$loader].setMeshoptDecoder(await meshoptDecoder);const ne=loadWithLoader(U,this[$loader],pe=>{ie(pe*.8)}),F=this[$GLTFInstance],fe=ne.then(pe=>F.prepare(pe)).then(pe=>(ie(.9),new F(pe))).catch(pe=>(console.error(pe),new F));cache.set(U,fe)}await cache.get(U),preloaded.set(U,!0),ie&&ie(1)}async load(U,Y,ie=()=>{}){await this.preload(U,Y,ie);const F=await(await cache.get(U)).clone();return this[$evictionPolicy].retain(U),F.dispose=()=>{this[$evictionPolicy].release(U)},F}}CachingGLTFLoader[_a$8]=new CacheEvictionPolicy(CachingGLTFLoader);class CSS2DObject extends Object3D{constructor(U=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=U,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new Vector2(.5,.5),this.addEventListener("removed",function(){this.traverse(function(Y){Y.element instanceof Element&&Y.element.parentNode!==null&&Y.element.parentNode.removeChild(Y.element)})})}copy(U,Y){return super.copy(U,Y),this.element=U.element.cloneNode(!0),this.center=U.center,this}}const _vector=new Vector3,_viewMatrix=new Matrix4,_viewProjectionMatrix=new Matrix4,_a$7=new Vector3,_b$7=new Vector3;class CSS2DRenderer{constructor(U={}){const Y=this;let ie,ne,F,fe;const pe={objects:new WeakMap},Me=U.element!==void 0?U.element:document.createElement("div");Me.style.overflow="hidden",this.domElement=Me,this.getSize=function(){return{width:ie,height:ne}},this.render=function(be,Pe){be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),Pe.parent===null&&Pe.matrixWorldAutoUpdate===!0&&Pe.updateMatrixWorld(),_viewMatrix.copy(Pe.matrixWorldInverse),_viewProjectionMatrix.multiplyMatrices(Pe.projectionMatrix,_viewMatrix),se(be,be,Pe),Re(be)},this.setSize=function(be,Pe){ie=be,ne=Pe,F=ie/2,fe=ne/2,Me.style.width=be+"px",Me.style.height=Pe+"px"};function ve(be){be.isCSS2DObject&&(be.element.style.display="none");for(let Pe=0,Le=be.children.length;Pe<Le;Pe++)ve(be.children[Pe])}function se(be,Pe,Le){if(be.visible===!1){ve(be);return}if(be.isCSS2DObject){_vector.setFromMatrixPosition(be.matrixWorld),_vector.applyMatrix4(_viewProjectionMatrix);const xe=_vector.z>=-1&&_vector.z<=1&&be.layers.test(Le.layers)===!0,Fe=be.element;Fe.style.display=xe===!0?"":"none",xe===!0&&(be.onBeforeRender(Y,Pe,Le),Fe.style.transform="translate("+-100*be.center.x+"%,"+-100*be.center.y+"%)translate("+(_vector.x*F+F)+"px,"+(-_vector.y*fe+fe)+"px)",Fe.parentNode!==Me&&Me.appendChild(Fe),be.onAfterRender(Y,Pe,Le));const Oe={distanceToCameraSquared:me(Le,be)};pe.objects.set(be,Oe)}for(let xe=0,Fe=be.children.length;xe<Fe;xe++)se(be.children[xe],Pe,Le)}function me(be,Pe){return _a$7.setFromMatrixPosition(be.matrixWorld),_b$7.setFromMatrixPosition(Pe.matrixWorld),_a$7.distanceToSquared(_b$7)}function Te(be){const Pe=[];return be.traverseVisible(function(Le){Le.isCSS2DObject&&Pe.push(Le)}),Pe}function Re(be){const Pe=Te(be).sort(function(xe,Fe){if(xe.renderOrder!==Fe.renderOrder)return Fe.renderOrder-xe.renderOrder;const Oe=pe.objects.get(xe).distanceToCameraSquared,Ne=pe.objects.get(Fe).distanceToCameraSquared;return Oe-Ne}),Le=Pe.length;for(let xe=0,Fe=Pe.length;xe<Fe;xe++)Pe[xe].element.style.zIndex=Le-xe}}}function reduceVertices(re,U,Y){let ie=Y;const ne=new Vector3;return re.updateWorldMatrix(!0,!0),re.traverseVisible(F=>{const{geometry:fe}=F;if(fe!==void 0){const{position:pe}=fe.attributes;if(pe!==void 0)for(let Me=0,ve=pe.count;Me<ve;Me++)F.isMesh?F.getVertexPosition(Me,ne):ne.fromBufferAttribute(pe,Me),F.isSkinnedMesh||ne.applyMatrix4(F.matrixWorld),ie=U(ie,ne)}}),ie}let _renderer,fullscreenQuadGeometry,fullscreenQuadMaterial,fullscreenQuad;function decompress(re,U=1/0,Y=null){fullscreenQuadGeometry||(fullscreenQuadGeometry=new PlaneGeometry(2,2,1,1)),fullscreenQuadMaterial||(fullscreenQuadMaterial=new ShaderMaterial({uniforms:{blitTexture:new Uniform(re)},vertexShader:`
			varying vec2 vUv;
			void main(){
				vUv = uv;
				gl_Position = vec4(position.xy * 1.0,0.,.999999);
			}`,fragmentShader:`
			uniform sampler2D blitTexture; 
			varying vec2 vUv;

			void main(){ 
				gl_FragColor = vec4(vUv.xy, 0, 1);
				
				#ifdef IS_SRGB
				gl_FragColor = sRGBTransferOETF( texture2D( blitTexture, vUv) );
				#else
				gl_FragColor = texture2D( blitTexture, vUv);
				#endif
			}`})),fullscreenQuadMaterial.uniforms.blitTexture.value=re,fullscreenQuadMaterial.defines.IS_SRGB=re.colorSpace==SRGBColorSpace,fullscreenQuadMaterial.needsUpdate=!0,fullscreenQuad||(fullscreenQuad=new Mesh(fullscreenQuadGeometry,fullscreenQuadMaterial),fullscreenQuad.frustumCulled=!1);const ie=new PerspectiveCamera,ne=new Scene;ne.add(fullscreenQuad),Y===null&&(Y=_renderer=new WebGLRenderer({antialias:!1}));const F=Math.min(re.image.width,U),fe=Math.min(re.image.height,U);Y.setSize(F,fe),Y.clear(),Y.render(ne,ie);const pe=document.createElement("canvas"),Me=pe.getContext("2d");pe.width=F,pe.height=fe,Me.drawImage(Y.domElement,0,0,F,fe);const ve=new CanvasTexture(pe);return ve.minFilter=re.minFilter,ve.magFilter=re.magFilter,ve.wrapS=re.wrapS,ve.wrapT=re.wrapT,ve.colorSpace=re.colorSpace,ve.name=re.name,_renderer&&(_renderer.forceContextLoss(),_renderer.dispose(),_renderer=null),ve}const KHR_mesh_quantization_ExtraAttrTypes={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class GLTFExporter{constructor(){this.pluginCallbacks=[],this.register(function(U){return new GLTFLightExtension(U)}),this.register(function(U){return new GLTFMaterialsUnlitExtension(U)}),this.register(function(U){return new GLTFMaterialsTransmissionExtension(U)}),this.register(function(U){return new GLTFMaterialsVolumeExtension(U)}),this.register(function(U){return new GLTFMaterialsIorExtension(U)}),this.register(function(U){return new GLTFMaterialsSpecularExtension(U)}),this.register(function(U){return new GLTFMaterialsClearcoatExtension(U)}),this.register(function(U){return new GLTFMaterialsDispersionExtension(U)}),this.register(function(U){return new GLTFMaterialsIridescenceExtension(U)}),this.register(function(U){return new GLTFMaterialsSheenExtension(U)}),this.register(function(U){return new GLTFMaterialsAnisotropyExtension(U)}),this.register(function(U){return new GLTFMaterialsEmissiveStrengthExtension(U)}),this.register(function(U){return new GLTFMaterialsBumpExtension(U)}),this.register(function(U){return new GLTFMeshGpuInstancing(U)})}register(U){return this.pluginCallbacks.indexOf(U)===-1&&this.pluginCallbacks.push(U),this}unregister(U){return this.pluginCallbacks.indexOf(U)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(U),1),this}parse(U,Y,ie,ne){const F=new GLTFWriter,fe=[];for(let pe=0,Me=this.pluginCallbacks.length;pe<Me;pe++)fe.push(this.pluginCallbacks[pe](F));F.setPlugins(fe),F.write(U,Y,ne).catch(ie)}parseAsync(U,Y){const ie=this;return new Promise(function(ne,F){ie.parse(U,ne,F,Y)})}}const WEBGL_CONSTANTS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},KHR_MESH_QUANTIZATION="KHR_mesh_quantization",THREE_TO_WEBGL={};THREE_TO_WEBGL[NearestFilter]=WEBGL_CONSTANTS.NEAREST;THREE_TO_WEBGL[NearestMipmapNearestFilter]=WEBGL_CONSTANTS.NEAREST_MIPMAP_NEAREST;THREE_TO_WEBGL[NearestMipmapLinearFilter]=WEBGL_CONSTANTS.NEAREST_MIPMAP_LINEAR;THREE_TO_WEBGL[LinearFilter]=WEBGL_CONSTANTS.LINEAR;THREE_TO_WEBGL[LinearMipmapNearestFilter]=WEBGL_CONSTANTS.LINEAR_MIPMAP_NEAREST;THREE_TO_WEBGL[LinearMipmapLinearFilter]=WEBGL_CONSTANTS.LINEAR_MIPMAP_LINEAR;THREE_TO_WEBGL[ClampToEdgeWrapping]=WEBGL_CONSTANTS.CLAMP_TO_EDGE;THREE_TO_WEBGL[RepeatWrapping]=WEBGL_CONSTANTS.REPEAT;THREE_TO_WEBGL[MirroredRepeatWrapping]=WEBGL_CONSTANTS.MIRRORED_REPEAT;const PATH_PROPERTIES={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},DEFAULT_SPECULAR_COLOR=new Color,GLB_HEADER_BYTES=12,GLB_HEADER_MAGIC=1179937895,GLB_VERSION=2,GLB_CHUNK_PREFIX_BYTES=8,GLB_CHUNK_TYPE_JSON=1313821514,GLB_CHUNK_TYPE_BIN=5130562;function equalArray(re,U){return re.length===U.length&&re.every(function(Y,ie){return Y===U[ie]})}function stringToArrayBuffer(re){return new TextEncoder().encode(re).buffer}function isIdentityMatrix(re){return equalArray(re.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function getMinMax(re,U,Y){const ie={min:new Array(re.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(re.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let ne=U;ne<U+Y;ne++)for(let F=0;F<re.itemSize;F++){let fe;re.itemSize>4?fe=re.array[ne*re.itemSize+F]:(F===0?fe=re.getX(ne):F===1?fe=re.getY(ne):F===2?fe=re.getZ(ne):F===3&&(fe=re.getW(ne)),re.normalized===!0&&(fe=MathUtils.normalize(fe,re.array))),ie.min[F]=Math.min(ie.min[F],fe),ie.max[F]=Math.max(ie.max[F],fe)}return ie}function getPaddedBufferSize(re){return Math.ceil(re/4)*4}function getPaddedArrayBuffer(re,U=0){const Y=getPaddedBufferSize(re.byteLength);if(Y!==re.byteLength){const ie=new Uint8Array(Y);if(ie.set(new Uint8Array(re)),U!==0)for(let ne=re.byteLength;ne<Y;ne++)ie[ne]=U;return ie.buffer}return re}function getCanvas(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function getToBlobPromise(re,U){if(re.toBlob!==void 0)return new Promise(ie=>re.toBlob(ie,U));let Y;return U==="image/jpeg"?Y=.92:U==="image/webp"&&(Y=.8),re.convertToBlob({type:U,quality:Y})}class GLTFWriter{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+REVISION}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(U){this.plugins=U}async write(U,Y,ie={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},ie),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(U),await Promise.all(this.pending);const ne=this,F=ne.buffers,fe=ne.json;ie=ne.options;const pe=ne.extensionsUsed,Me=ne.extensionsRequired,ve=new Blob(F,{type:"application/octet-stream"}),se=Object.keys(pe),me=Object.keys(Me);if(se.length>0&&(fe.extensionsUsed=se),me.length>0&&(fe.extensionsRequired=me),fe.buffers&&fe.buffers.length>0&&(fe.buffers[0].byteLength=ve.size),ie.binary===!0){const Te=new FileReader;Te.readAsArrayBuffer(ve),Te.onloadend=function(){const Re=getPaddedArrayBuffer(Te.result),be=new DataView(new ArrayBuffer(GLB_CHUNK_PREFIX_BYTES));be.setUint32(0,Re.byteLength,!0),be.setUint32(4,GLB_CHUNK_TYPE_BIN,!0);const Pe=getPaddedArrayBuffer(stringToArrayBuffer(JSON.stringify(fe)),32),Le=new DataView(new ArrayBuffer(GLB_CHUNK_PREFIX_BYTES));Le.setUint32(0,Pe.byteLength,!0),Le.setUint32(4,GLB_CHUNK_TYPE_JSON,!0);const xe=new ArrayBuffer(GLB_HEADER_BYTES),Fe=new DataView(xe);Fe.setUint32(0,GLB_HEADER_MAGIC,!0),Fe.setUint32(4,GLB_VERSION,!0);const Oe=GLB_HEADER_BYTES+Le.byteLength+Pe.byteLength+be.byteLength+Re.byteLength;Fe.setUint32(8,Oe,!0);const Ne=new Blob([xe,Le,Pe,be,Re],{type:"application/octet-stream"}),ke=new FileReader;ke.readAsArrayBuffer(Ne),ke.onloadend=function(){Y(ke.result)}}}else if(fe.buffers&&fe.buffers.length>0){const Te=new FileReader;Te.readAsDataURL(ve),Te.onloadend=function(){const Re=Te.result;fe.buffers[0].uri=Re,Y(fe)}}else Y(fe)}serializeUserData(U,Y){if(Object.keys(U.userData).length===0)return;const ie=this.options,ne=this.extensionsUsed;try{const F=JSON.parse(JSON.stringify(U.userData));if(ie.includeCustomExtensions&&F.gltfExtensions){Y.extensions===void 0&&(Y.extensions={});for(const fe in F.gltfExtensions)Y.extensions[fe]=F.gltfExtensions[fe],ne[fe]=!0;delete F.gltfExtensions}Object.keys(F).length>0&&(Y.extras=F)}catch(F){console.warn("THREE.GLTFExporter: userData of '"+U.name+"' won't be serialized because of JSON.stringify error - "+F.message)}}getUID(U,Y=!1){if(this.uids.has(U)===!1){const ne=new Map;ne.set(!0,this.uid++),ne.set(!1,this.uid++),this.uids.set(U,ne)}return this.uids.get(U).get(Y)}isNormalizedNormalAttribute(U){if(this.cache.attributesNormalized.has(U))return!1;const ie=new Vector3;for(let ne=0,F=U.count;ne<F;ne++)if(Math.abs(ie.fromBufferAttribute(U,ne).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(U){const Y=this.cache;if(Y.attributesNormalized.has(U))return Y.attributesNormalized.get(U);const ie=U.clone(),ne=new Vector3;for(let F=0,fe=ie.count;F<fe;F++)ne.fromBufferAttribute(ie,F),ne.x===0&&ne.y===0&&ne.z===0?ne.setX(1):ne.normalize(),ie.setXYZ(F,ne.x,ne.y,ne.z);return Y.attributesNormalized.set(U,ie),ie}applyTextureTransform(U,Y){let ie=!1;const ne={};(Y.offset.x!==0||Y.offset.y!==0)&&(ne.offset=Y.offset.toArray(),ie=!0),Y.rotation!==0&&(ne.rotation=Y.rotation,ie=!0),(Y.repeat.x!==1||Y.repeat.y!==1)&&(ne.scale=Y.repeat.toArray(),ie=!0),ie&&(U.extensions=U.extensions||{},U.extensions.KHR_texture_transform=ne,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(U,Y){if(U===Y)return U;function ie(Re){return Re.colorSpace===SRGBColorSpace?function(Pe){return Pe<.04045?Pe*.0773993808:Math.pow(Pe*.9478672986+.0521327014,2.4)}:function(Pe){return Pe}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),U instanceof CompressedTexture&&(U=decompress(U)),Y instanceof CompressedTexture&&(Y=decompress(Y));const ne=U?U.image:null,F=Y?Y.image:null,fe=Math.max(ne?ne.width:0,F?F.width:0),pe=Math.max(ne?ne.height:0,F?F.height:0),Me=getCanvas();Me.width=fe,Me.height=pe;const ve=Me.getContext("2d",{willReadFrequently:!0});ve.fillStyle="#00ffff",ve.fillRect(0,0,fe,pe);const se=ve.getImageData(0,0,fe,pe);if(ne){ve.drawImage(ne,0,0,fe,pe);const Re=ie(U),be=ve.getImageData(0,0,fe,pe).data;for(let Pe=2;Pe<be.length;Pe+=4)se.data[Pe]=Re(be[Pe]/256)*256}if(F){ve.drawImage(F,0,0,fe,pe);const Re=ie(Y),be=ve.getImageData(0,0,fe,pe).data;for(let Pe=1;Pe<be.length;Pe+=4)se.data[Pe]=Re(be[Pe]/256)*256}ve.putImageData(se,0,0);const Te=(U||Y).clone();return Te.source=new Source(Me),Te.colorSpace=NoColorSpace,Te.channel=(U||Y).channel,U&&Y&&U.channel!==Y.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),Te}processBuffer(U){const Y=this.json,ie=this.buffers;return Y.buffers||(Y.buffers=[{byteLength:0}]),ie.push(U),0}processBufferView(U,Y,ie,ne,F){const fe=this.json;fe.bufferViews||(fe.bufferViews=[]);let pe;switch(Y){case WEBGL_CONSTANTS.BYTE:case WEBGL_CONSTANTS.UNSIGNED_BYTE:pe=1;break;case WEBGL_CONSTANTS.SHORT:case WEBGL_CONSTANTS.UNSIGNED_SHORT:pe=2;break;default:pe=4}let Me=U.itemSize*pe;F===WEBGL_CONSTANTS.ARRAY_BUFFER&&(Me=Math.ceil(Me/4)*4);const ve=getPaddedBufferSize(ne*Me),se=new DataView(new ArrayBuffer(ve));let me=0;for(let be=ie;be<ie+ne;be++){for(let Pe=0;Pe<U.itemSize;Pe++){let Le;U.itemSize>4?Le=U.array[be*U.itemSize+Pe]:(Pe===0?Le=U.getX(be):Pe===1?Le=U.getY(be):Pe===2?Le=U.getZ(be):Pe===3&&(Le=U.getW(be)),U.normalized===!0&&(Le=MathUtils.normalize(Le,U.array))),Y===WEBGL_CONSTANTS.FLOAT?se.setFloat32(me,Le,!0):Y===WEBGL_CONSTANTS.INT?se.setInt32(me,Le,!0):Y===WEBGL_CONSTANTS.UNSIGNED_INT?se.setUint32(me,Le,!0):Y===WEBGL_CONSTANTS.SHORT?se.setInt16(me,Le,!0):Y===WEBGL_CONSTANTS.UNSIGNED_SHORT?se.setUint16(me,Le,!0):Y===WEBGL_CONSTANTS.BYTE?se.setInt8(me,Le):Y===WEBGL_CONSTANTS.UNSIGNED_BYTE&&se.setUint8(me,Le),me+=pe}me%Me!==0&&(me+=Me-me%Me)}const Te={buffer:this.processBuffer(se.buffer),byteOffset:this.byteOffset,byteLength:ve};return F!==void 0&&(Te.target=F),F===WEBGL_CONSTANTS.ARRAY_BUFFER&&(Te.byteStride=Me),this.byteOffset+=ve,fe.bufferViews.push(Te),{id:fe.bufferViews.length-1,byteLength:0}}processBufferViewImage(U){const Y=this,ie=Y.json;return ie.bufferViews||(ie.bufferViews=[]),new Promise(function(ne){const F=new FileReader;F.readAsArrayBuffer(U),F.onloadend=function(){const fe=getPaddedArrayBuffer(F.result),pe={buffer:Y.processBuffer(fe),byteOffset:Y.byteOffset,byteLength:fe.byteLength};Y.byteOffset+=fe.byteLength,ne(ie.bufferViews.push(pe)-1)}})}processAccessor(U,Y,ie,ne){const F=this.json,fe={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let pe;if(U.array.constructor===Float32Array)pe=WEBGL_CONSTANTS.FLOAT;else if(U.array.constructor===Int32Array)pe=WEBGL_CONSTANTS.INT;else if(U.array.constructor===Uint32Array)pe=WEBGL_CONSTANTS.UNSIGNED_INT;else if(U.array.constructor===Int16Array)pe=WEBGL_CONSTANTS.SHORT;else if(U.array.constructor===Uint16Array)pe=WEBGL_CONSTANTS.UNSIGNED_SHORT;else if(U.array.constructor===Int8Array)pe=WEBGL_CONSTANTS.BYTE;else if(U.array.constructor===Uint8Array)pe=WEBGL_CONSTANTS.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+U.array.constructor.name);if(ie===void 0&&(ie=0),(ne===void 0||ne===1/0)&&(ne=U.count),ne===0)return null;const Me=getMinMax(U,ie,ne);let ve;Y!==void 0&&(ve=U===Y.index?WEBGL_CONSTANTS.ELEMENT_ARRAY_BUFFER:WEBGL_CONSTANTS.ARRAY_BUFFER);const se=this.processBufferView(U,pe,ie,ne,ve),me={bufferView:se.id,byteOffset:se.byteOffset,componentType:pe,count:ne,max:Me.max,min:Me.min,type:fe[U.itemSize]};return U.normalized===!0&&(me.normalized=!0),F.accessors||(F.accessors=[]),F.accessors.push(me)-1}processImage(U,Y,ie,ne="image/png"){if(U!==null){const F=this,fe=F.cache,pe=F.json,Me=F.options,ve=F.pending;fe.images.has(U)||fe.images.set(U,{});const se=fe.images.get(U),me=ne+":flipY/"+ie.toString();if(se[me]!==void 0)return se[me];pe.images||(pe.images=[]);const Te={mimeType:ne},Re=getCanvas();Re.width=Math.min(U.width,Me.maxTextureSize),Re.height=Math.min(U.height,Me.maxTextureSize);const be=Re.getContext("2d",{willReadFrequently:!0});if(ie===!0&&(be.translate(0,Re.height),be.scale(1,-1)),U.data!==void 0){Y!==RGBAFormat&&console.error("GLTFExporter: Only RGBAFormat is supported.",Y),(U.width>Me.maxTextureSize||U.height>Me.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",U);const Le=new Uint8ClampedArray(U.height*U.width*4);for(let xe=0;xe<Le.length;xe+=4)Le[xe+0]=U.data[xe+0],Le[xe+1]=U.data[xe+1],Le[xe+2]=U.data[xe+2],Le[xe+3]=U.data[xe+3];be.putImageData(new ImageData(Le,U.width,U.height),0,0)}else if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&U instanceof OffscreenCanvas)be.drawImage(U,0,0,Re.width,Re.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");Me.binary===!0?ve.push(getToBlobPromise(Re,ne).then(Le=>F.processBufferViewImage(Le)).then(Le=>{Te.bufferView=Le})):Re.toDataURL!==void 0?Te.uri=Re.toDataURL(ne):ve.push(getToBlobPromise(Re,ne).then(Le=>new FileReader().readAsDataURL(Le)).then(Le=>{Te.uri=Le}));const Pe=pe.images.push(Te)-1;return se[me]=Pe,Pe}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(U){const Y=this.json;Y.samplers||(Y.samplers=[]);const ie={magFilter:THREE_TO_WEBGL[U.magFilter],minFilter:THREE_TO_WEBGL[U.minFilter],wrapS:THREE_TO_WEBGL[U.wrapS],wrapT:THREE_TO_WEBGL[U.wrapT]};return Y.samplers.push(ie)-1}processTexture(U){const ie=this.options,ne=this.cache,F=this.json;if(ne.textures.has(U))return ne.textures.get(U);F.textures||(F.textures=[]),U instanceof CompressedTexture&&(U=decompress(U,ie.maxTextureSize));let fe=U.userData.mimeType;fe==="image/webp"&&(fe="image/png");const pe={sampler:this.processSampler(U),source:this.processImage(U.image,U.format,U.flipY,fe)};U.name&&(pe.name=U.name),this._invokeAll(function(ve){ve.writeTexture&&ve.writeTexture(U,pe)});const Me=F.textures.push(pe)-1;return ne.textures.set(U,Me),Me}processMaterial(U){const Y=this.cache,ie=this.json;if(Y.materials.has(U))return Y.materials.get(U);if(U.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;ie.materials||(ie.materials=[]);const ne={pbrMetallicRoughness:{}};U.isMeshStandardMaterial!==!0&&U.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const F=U.color.toArray().concat([U.opacity]);if(equalArray(F,[1,1,1,1])||(ne.pbrMetallicRoughness.baseColorFactor=F),U.isMeshStandardMaterial?(ne.pbrMetallicRoughness.metallicFactor=U.metalness,ne.pbrMetallicRoughness.roughnessFactor=U.roughness):(ne.pbrMetallicRoughness.metallicFactor=.5,ne.pbrMetallicRoughness.roughnessFactor=.5),U.metalnessMap||U.roughnessMap){const pe=this.buildMetalRoughTexture(U.metalnessMap,U.roughnessMap),Me={index:this.processTexture(pe),channel:pe.channel};this.applyTextureTransform(Me,pe),ne.pbrMetallicRoughness.metallicRoughnessTexture=Me}if(U.map){const pe={index:this.processTexture(U.map),texCoord:U.map.channel};this.applyTextureTransform(pe,U.map),ne.pbrMetallicRoughness.baseColorTexture=pe}if(U.emissive){const pe=U.emissive;if(Math.max(pe.r,pe.g,pe.b)>0&&(ne.emissiveFactor=U.emissive.toArray()),U.emissiveMap){const ve={index:this.processTexture(U.emissiveMap),texCoord:U.emissiveMap.channel};this.applyTextureTransform(ve,U.emissiveMap),ne.emissiveTexture=ve}}if(U.normalMap){const pe={index:this.processTexture(U.normalMap),texCoord:U.normalMap.channel};U.normalScale&&U.normalScale.x!==1&&(pe.scale=U.normalScale.x),this.applyTextureTransform(pe,U.normalMap),ne.normalTexture=pe}if(U.aoMap){const pe={index:this.processTexture(U.aoMap),texCoord:U.aoMap.channel};U.aoMapIntensity!==1&&(pe.strength=U.aoMapIntensity),this.applyTextureTransform(pe,U.aoMap),ne.occlusionTexture=pe}U.transparent?ne.alphaMode="BLEND":U.alphaTest>0&&(ne.alphaMode="MASK",ne.alphaCutoff=U.alphaTest),U.side===DoubleSide&&(ne.doubleSided=!0),U.name!==""&&(ne.name=U.name),this.serializeUserData(U,ne),this._invokeAll(function(pe){pe.writeMaterial&&pe.writeMaterial(U,ne)});const fe=ie.materials.push(ne)-1;return Y.materials.set(U,fe),fe}processMesh(U){const Y=this.cache,ie=this.json,ne=[U.geometry.uuid];if(Array.isArray(U.material))for(let Ne=0,ke=U.material.length;Ne<ke;Ne++)ne.push(U.material[Ne].uuid);else ne.push(U.material.uuid);const F=ne.join(":");if(Y.meshes.has(F))return Y.meshes.get(F);const fe=U.geometry;let pe;U.isLineSegments?pe=WEBGL_CONSTANTS.LINES:U.isLineLoop?pe=WEBGL_CONSTANTS.LINE_LOOP:U.isLine?pe=WEBGL_CONSTANTS.LINE_STRIP:U.isPoints?pe=WEBGL_CONSTANTS.POINTS:pe=U.material.wireframe?WEBGL_CONSTANTS.LINES:WEBGL_CONSTANTS.TRIANGLES;const Me={},ve={},se=[],me=[],Te={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},Re=fe.getAttribute("normal");Re!==void 0&&!this.isNormalizedNormalAttribute(Re)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),fe.setAttribute("normal",this.createNormalizedNormalAttribute(Re)));let be=null;for(let Ne in fe.attributes){if(Ne.slice(0,5)==="morph")continue;const ke=fe.attributes[Ne];if(Ne=Te[Ne]||Ne.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(Ne)||(Ne="_"+Ne),Y.attributes.has(this.getUID(ke))){ve[Ne]=Y.attributes.get(this.getUID(ke));continue}be=null;const Xe=ke.array;Ne==="JOINTS_0"&&!(Xe instanceof Uint16Array)&&!(Xe instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),be=new BufferAttribute(new Uint16Array(Xe),ke.itemSize,ke.normalized));const $e=this.processAccessor(be||ke,fe);$e!==null&&(Ne.startsWith("_")||this.detectMeshQuantization(Ne,ke),ve[Ne]=$e,Y.attributes.set(this.getUID(ke),$e))}if(Re!==void 0&&fe.setAttribute("normal",Re),Object.keys(ve).length===0)return null;if(U.morphTargetInfluences!==void 0&&U.morphTargetInfluences.length>0){const Ne=[],ke=[],Ve={};if(U.morphTargetDictionary!==void 0)for(const Xe in U.morphTargetDictionary)Ve[U.morphTargetDictionary[Xe]]=Xe;for(let Xe=0;Xe<U.morphTargetInfluences.length;++Xe){const $e={};let st=!1;for(const ze in fe.morphAttributes){if(ze!=="position"&&ze!=="normal"){st||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),st=!0);continue}const tt=fe.morphAttributes[ze][Xe],ft=ze.toUpperCase(),Rt=fe.attributes[ze];if(Y.attributes.has(this.getUID(tt,!0))){$e[ft]=Y.attributes.get(this.getUID(tt,!0));continue}const Mt=tt.clone();if(!fe.morphTargetsRelative)for(let Gt=0,_t=tt.count;Gt<_t;Gt++)for(let Bt=0;Bt<tt.itemSize;Bt++)Bt===0&&Mt.setX(Gt,tt.getX(Gt)-Rt.getX(Gt)),Bt===1&&Mt.setY(Gt,tt.getY(Gt)-Rt.getY(Gt)),Bt===2&&Mt.setZ(Gt,tt.getZ(Gt)-Rt.getZ(Gt)),Bt===3&&Mt.setW(Gt,tt.getW(Gt)-Rt.getW(Gt));$e[ft]=this.processAccessor(Mt,fe),Y.attributes.set(this.getUID(Rt,!0),$e[ft])}me.push($e),Ne.push(U.morphTargetInfluences[Xe]),U.morphTargetDictionary!==void 0&&ke.push(Ve[Xe])}Me.weights=Ne,ke.length>0&&(Me.extras={},Me.extras.targetNames=ke)}const Pe=Array.isArray(U.material);if(Pe&&fe.groups.length===0)return null;let Le=!1;if(Pe&&fe.index===null){const Ne=[];for(let ke=0,Ve=fe.attributes.position.count;ke<Ve;ke++)Ne[ke]=ke;fe.setIndex(Ne),Le=!0}const xe=Pe?U.material:[U.material],Fe=Pe?fe.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let Ne=0,ke=Fe.length;Ne<ke;Ne++){const Ve={mode:pe,attributes:ve};if(this.serializeUserData(fe,Ve),me.length>0&&(Ve.targets=me),fe.index!==null){let $e=this.getUID(fe.index);(Fe[Ne].start!==void 0||Fe[Ne].count!==void 0)&&($e+=":"+Fe[Ne].start+":"+Fe[Ne].count),Y.attributes.has($e)?Ve.indices=Y.attributes.get($e):(Ve.indices=this.processAccessor(fe.index,fe,Fe[Ne].start,Fe[Ne].count),Y.attributes.set($e,Ve.indices)),Ve.indices===null&&delete Ve.indices}const Xe=this.processMaterial(xe[Fe[Ne].materialIndex]);Xe!==null&&(Ve.material=Xe),se.push(Ve)}Le===!0&&fe.setIndex(null),Me.primitives=se,ie.meshes||(ie.meshes=[]),this._invokeAll(function(Ne){Ne.writeMesh&&Ne.writeMesh(U,Me)});const Oe=ie.meshes.push(Me)-1;return Y.meshes.set(F,Oe),Oe}detectMeshQuantization(U,Y){if(this.extensionsUsed[KHR_MESH_QUANTIZATION])return;let ie;switch(Y.array.constructor){case Int8Array:ie="byte";break;case Uint8Array:ie="unsigned byte";break;case Int16Array:ie="short";break;case Uint16Array:ie="unsigned short";break;default:return}Y.normalized&&(ie+=" normalized");const ne=U.split("_",1)[0];KHR_mesh_quantization_ExtraAttrTypes[ne]&&KHR_mesh_quantization_ExtraAttrTypes[ne].includes(ie)&&(this.extensionsUsed[KHR_MESH_QUANTIZATION]=!0,this.extensionsRequired[KHR_MESH_QUANTIZATION]=!0)}processCamera(U){const Y=this.json;Y.cameras||(Y.cameras=[]);const ie=U.isOrthographicCamera,ne={type:ie?"orthographic":"perspective"};return ie?ne.orthographic={xmag:U.right*2,ymag:U.top*2,zfar:U.far<=0?.001:U.far,znear:U.near<0?0:U.near}:ne.perspective={aspectRatio:U.aspect,yfov:MathUtils.degToRad(U.fov),zfar:U.far<=0?.001:U.far,znear:U.near<0?0:U.near},U.name!==""&&(ne.name=U.type),Y.cameras.push(ne)-1}processAnimation(U,Y){const ie=this.json,ne=this.nodeMap;ie.animations||(ie.animations=[]),U=GLTFExporter.Utils.mergeMorphTargetTracks(U.clone(),Y);const F=U.tracks,fe=[],pe=[];for(let Me=0;Me<F.length;++Me){const ve=F[Me],se=PropertyBinding.parseTrackName(ve.name);let me=PropertyBinding.findNode(Y,se.nodeName);const Te=PATH_PROPERTIES[se.propertyName];if(se.objectName==="bones"&&(me.isSkinnedMesh===!0?me=me.skeleton.getBoneByName(se.objectIndex):me=void 0),!me||!Te){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',ve.name);continue}const Re=1;let be=ve.values.length/ve.times.length;Te===PATH_PROPERTIES.morphTargetInfluences&&(be/=me.morphTargetInfluences.length);let Pe;ve.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(Pe="CUBICSPLINE",be/=3):ve.getInterpolation()===InterpolateDiscrete?Pe="STEP":Pe="LINEAR",pe.push({input:this.processAccessor(new BufferAttribute(ve.times,Re)),output:this.processAccessor(new BufferAttribute(ve.values,be)),interpolation:Pe}),fe.push({sampler:pe.length-1,target:{node:ne.get(me),path:Te}})}return ie.animations.push({name:U.name||"clip_"+ie.animations.length,samplers:pe,channels:fe}),ie.animations.length-1}processSkin(U){const Y=this.json,ie=this.nodeMap,ne=Y.nodes[ie.get(U)],F=U.skeleton;if(F===void 0)return null;const fe=U.skeleton.bones[0];if(fe===void 0)return null;const pe=[],Me=new Float32Array(F.bones.length*16),ve=new Matrix4;for(let me=0;me<F.bones.length;++me)pe.push(ie.get(F.bones[me])),ve.copy(F.boneInverses[me]),ve.multiply(U.bindMatrix).toArray(Me,me*16);return Y.skins===void 0&&(Y.skins=[]),Y.skins.push({inverseBindMatrices:this.processAccessor(new BufferAttribute(Me,16)),joints:pe,skeleton:ie.get(fe)}),ne.skin=Y.skins.length-1}processNode(U){const Y=this.json,ie=this.options,ne=this.nodeMap;Y.nodes||(Y.nodes=[]);const F={};if(ie.trs){const pe=U.quaternion.toArray(),Me=U.position.toArray(),ve=U.scale.toArray();equalArray(pe,[0,0,0,1])||(F.rotation=pe),equalArray(Me,[0,0,0])||(F.translation=Me),equalArray(ve,[1,1,1])||(F.scale=ve)}else U.matrixAutoUpdate&&U.updateMatrix(),isIdentityMatrix(U.matrix)===!1&&(F.matrix=U.matrix.elements);if(U.name!==""&&(F.name=String(U.name)),this.serializeUserData(U,F),U.isMesh||U.isLine||U.isPoints){const pe=this.processMesh(U);pe!==null&&(F.mesh=pe)}else U.isCamera&&(F.camera=this.processCamera(U));if(U.isSkinnedMesh&&this.skins.push(U),U.children.length>0){const pe=[];for(let Me=0,ve=U.children.length;Me<ve;Me++){const se=U.children[Me];if(se.visible||ie.onlyVisible===!1){const me=this.processNode(se);me!==null&&pe.push(me)}}pe.length>0&&(F.children=pe)}this._invokeAll(function(pe){pe.writeNode&&pe.writeNode(U,F)});const fe=Y.nodes.push(F)-1;return ne.set(U,fe),fe}processScene(U){const Y=this.json,ie=this.options;Y.scenes||(Y.scenes=[],Y.scene=0);const ne={};U.name!==""&&(ne.name=U.name),Y.scenes.push(ne);const F=[];for(let fe=0,pe=U.children.length;fe<pe;fe++){const Me=U.children[fe];if(Me.visible||ie.onlyVisible===!1){const ve=this.processNode(Me);ve!==null&&F.push(ve)}}F.length>0&&(ne.nodes=F),this.serializeUserData(U,ne)}processObjects(U){const Y=new Scene;Y.name="AuxScene";for(let ie=0;ie<U.length;ie++)Y.children.push(U[ie]);this.processScene(Y)}processInput(U){const Y=this.options;U=U instanceof Array?U:[U],this._invokeAll(function(ne){ne.beforeParse&&ne.beforeParse(U)});const ie=[];for(let ne=0;ne<U.length;ne++)U[ne]instanceof Scene?this.processScene(U[ne]):ie.push(U[ne]);ie.length>0&&this.processObjects(ie);for(let ne=0;ne<this.skins.length;++ne)this.processSkin(this.skins[ne]);for(let ne=0;ne<Y.animations.length;++ne)this.processAnimation(Y.animations[ne],U[0]);this._invokeAll(function(ne){ne.afterParse&&ne.afterParse(U)})}_invokeAll(U){for(let Y=0,ie=this.plugins.length;Y<ie;Y++)U(this.plugins[Y])}}class GLTFLightExtension{constructor(U){this.writer=U,this.name="KHR_lights_punctual"}writeNode(U,Y){if(!U.isLight)return;if(!U.isDirectionalLight&&!U.isPointLight&&!U.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",U);return}const ie=this.writer,ne=ie.json,F=ie.extensionsUsed,fe={};U.name&&(fe.name=U.name),fe.color=U.color.toArray(),fe.intensity=U.intensity,U.isDirectionalLight?fe.type="directional":U.isPointLight?(fe.type="point",U.distance>0&&(fe.range=U.distance)):U.isSpotLight&&(fe.type="spot",U.distance>0&&(fe.range=U.distance),fe.spot={},fe.spot.innerConeAngle=(1-U.penumbra)*U.angle,fe.spot.outerConeAngle=U.angle),U.decay!==void 0&&U.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),U.target&&(U.target.parent!==U||U.target.position.x!==0||U.target.position.y!==0||U.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),F[this.name]||(ne.extensions=ne.extensions||{},ne.extensions[this.name]={lights:[]},F[this.name]=!0);const pe=ne.extensions[this.name].lights;pe.push(fe),Y.extensions=Y.extensions||{},Y.extensions[this.name]={light:pe.length-1}}}class GLTFMaterialsUnlitExtension{constructor(U){this.writer=U,this.name="KHR_materials_unlit"}writeMaterial(U,Y){if(!U.isMeshBasicMaterial)return;const ne=this.writer.extensionsUsed;Y.extensions=Y.extensions||{},Y.extensions[this.name]={},ne[this.name]=!0,Y.pbrMetallicRoughness.metallicFactor=0,Y.pbrMetallicRoughness.roughnessFactor=.9}}class GLTFMaterialsClearcoatExtension{constructor(U){this.writer=U,this.name="KHR_materials_clearcoat"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.clearcoat===0)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(F.clearcoatFactor=U.clearcoat,U.clearcoatMap){const fe={index:ie.processTexture(U.clearcoatMap),texCoord:U.clearcoatMap.channel};ie.applyTextureTransform(fe,U.clearcoatMap),F.clearcoatTexture=fe}if(F.clearcoatRoughnessFactor=U.clearcoatRoughness,U.clearcoatRoughnessMap){const fe={index:ie.processTexture(U.clearcoatRoughnessMap),texCoord:U.clearcoatRoughnessMap.channel};ie.applyTextureTransform(fe,U.clearcoatRoughnessMap),F.clearcoatRoughnessTexture=fe}if(U.clearcoatNormalMap){const fe={index:ie.processTexture(U.clearcoatNormalMap),texCoord:U.clearcoatNormalMap.channel};U.clearcoatNormalScale.x!==1&&(fe.scale=U.clearcoatNormalScale.x),ie.applyTextureTransform(fe,U.clearcoatNormalMap),F.clearcoatNormalTexture=fe}Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsDispersionExtension{constructor(U){this.writer=U,this.name="KHR_materials_dispersion"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.dispersion===0)return;const ne=this.writer.extensionsUsed,F={};F.dispersion=U.dispersion,Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsIridescenceExtension{constructor(U){this.writer=U,this.name="KHR_materials_iridescence"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.iridescence===0)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(F.iridescenceFactor=U.iridescence,U.iridescenceMap){const fe={index:ie.processTexture(U.iridescenceMap),texCoord:U.iridescenceMap.channel};ie.applyTextureTransform(fe,U.iridescenceMap),F.iridescenceTexture=fe}if(F.iridescenceIor=U.iridescenceIOR,F.iridescenceThicknessMinimum=U.iridescenceThicknessRange[0],F.iridescenceThicknessMaximum=U.iridescenceThicknessRange[1],U.iridescenceThicknessMap){const fe={index:ie.processTexture(U.iridescenceThicknessMap),texCoord:U.iridescenceThicknessMap.channel};ie.applyTextureTransform(fe,U.iridescenceThicknessMap),F.iridescenceThicknessTexture=fe}Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsTransmissionExtension{constructor(U){this.writer=U,this.name="KHR_materials_transmission"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.transmission===0)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(F.transmissionFactor=U.transmission,U.transmissionMap){const fe={index:ie.processTexture(U.transmissionMap),texCoord:U.transmissionMap.channel};ie.applyTextureTransform(fe,U.transmissionMap),F.transmissionTexture=fe}Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsVolumeExtension{constructor(U){this.writer=U,this.name="KHR_materials_volume"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.transmission===0)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(F.thicknessFactor=U.thickness,U.thicknessMap){const fe={index:ie.processTexture(U.thicknessMap),texCoord:U.thicknessMap.channel};ie.applyTextureTransform(fe,U.thicknessMap),F.thicknessTexture=fe}U.attenuationDistance!==1/0&&(F.attenuationDistance=U.attenuationDistance),F.attenuationColor=U.attenuationColor.toArray(),Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsIorExtension{constructor(U){this.writer=U,this.name="KHR_materials_ior"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.ior===1.5)return;const ne=this.writer.extensionsUsed,F={};F.ior=U.ior,Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsSpecularExtension{constructor(U){this.writer=U,this.name="KHR_materials_specular"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.specularIntensity===1&&U.specularColor.equals(DEFAULT_SPECULAR_COLOR)&&!U.specularIntensityMap&&!U.specularColorMap)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(U.specularIntensityMap){const fe={index:ie.processTexture(U.specularIntensityMap),texCoord:U.specularIntensityMap.channel};ie.applyTextureTransform(fe,U.specularIntensityMap),F.specularTexture=fe}if(U.specularColorMap){const fe={index:ie.processTexture(U.specularColorMap),texCoord:U.specularColorMap.channel};ie.applyTextureTransform(fe,U.specularColorMap),F.specularColorTexture=fe}F.specularFactor=U.specularIntensity,F.specularColorFactor=U.specularColor.toArray(),Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsSheenExtension{constructor(U){this.writer=U,this.name="KHR_materials_sheen"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.sheen==0)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(U.sheenRoughnessMap){const fe={index:ie.processTexture(U.sheenRoughnessMap),texCoord:U.sheenRoughnessMap.channel};ie.applyTextureTransform(fe,U.sheenRoughnessMap),F.sheenRoughnessTexture=fe}if(U.sheenColorMap){const fe={index:ie.processTexture(U.sheenColorMap),texCoord:U.sheenColorMap.channel};ie.applyTextureTransform(fe,U.sheenColorMap),F.sheenColorTexture=fe}F.sheenRoughnessFactor=U.sheenRoughness,F.sheenColorFactor=U.sheenColor.toArray(),Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsAnisotropyExtension{constructor(U){this.writer=U,this.name="KHR_materials_anisotropy"}writeMaterial(U,Y){if(!U.isMeshPhysicalMaterial||U.anisotropy==0)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(U.anisotropyMap){const fe={index:ie.processTexture(U.anisotropyMap)};ie.applyTextureTransform(fe,U.anisotropyMap),F.anisotropyTexture=fe}F.anisotropyStrength=U.anisotropy,F.anisotropyRotation=U.anisotropyRotation,Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsEmissiveStrengthExtension{constructor(U){this.writer=U,this.name="KHR_materials_emissive_strength"}writeMaterial(U,Y){if(!U.isMeshStandardMaterial||U.emissiveIntensity===1)return;const ne=this.writer.extensionsUsed,F={};F.emissiveStrength=U.emissiveIntensity,Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMaterialsBumpExtension{constructor(U){this.writer=U,this.name="EXT_materials_bump"}writeMaterial(U,Y){if(!U.isMeshStandardMaterial||U.bumpScale===1&&!U.bumpMap)return;const ie=this.writer,ne=ie.extensionsUsed,F={};if(U.bumpMap){const fe={index:ie.processTexture(U.bumpMap),texCoord:U.bumpMap.channel};ie.applyTextureTransform(fe,U.bumpMap),F.bumpTexture=fe}F.bumpFactor=U.bumpScale,Y.extensions=Y.extensions||{},Y.extensions[this.name]=F,ne[this.name]=!0}}class GLTFMeshGpuInstancing{constructor(U){this.writer=U,this.name="EXT_mesh_gpu_instancing"}writeNode(U,Y){if(!U.isInstancedMesh)return;const ie=this.writer,ne=U,F=new Float32Array(ne.count*3),fe=new Float32Array(ne.count*4),pe=new Float32Array(ne.count*3),Me=new Matrix4,ve=new Vector3,se=new Quaternion,me=new Vector3;for(let Re=0;Re<ne.count;Re++)ne.getMatrixAt(Re,Me),Me.decompose(ve,se,me),ve.toArray(F,Re*3),se.toArray(fe,Re*4),me.toArray(pe,Re*3);const Te={TRANSLATION:ie.processAccessor(new BufferAttribute(F,3)),ROTATION:ie.processAccessor(new BufferAttribute(fe,4)),SCALE:ie.processAccessor(new BufferAttribute(pe,3))};ne.instanceColor&&(Te._COLOR_0=ie.processAccessor(ne.instanceColor)),Y.extensions=Y.extensions||{},Y.extensions[this.name]={attributes:Te},ie.extensionsUsed[this.name]=!0,ie.extensionsRequired[this.name]=!0}}GLTFExporter.Utils={insertKeyframe:function(re,U){const ie=re.getValueSize(),ne=new re.TimeBufferType(re.times.length+1),F=new re.ValueBufferType(re.values.length+ie),fe=re.createInterpolant(new re.ValueBufferType(ie));let pe;if(re.times.length===0){ne[0]=U;for(let Me=0;Me<ie;Me++)F[Me]=0;pe=0}else if(U<re.times[0]){if(Math.abs(re.times[0]-U)<.001)return 0;ne[0]=U,ne.set(re.times,1),F.set(fe.evaluate(U),0),F.set(re.values,ie),pe=0}else if(U>re.times[re.times.length-1]){if(Math.abs(re.times[re.times.length-1]-U)<.001)return re.times.length-1;ne[ne.length-1]=U,ne.set(re.times,0),F.set(re.values,0),F.set(fe.evaluate(U),re.values.length),pe=ne.length-1}else for(let Me=0;Me<re.times.length;Me++){if(Math.abs(re.times[Me]-U)<.001)return Me;if(re.times[Me]<U&&re.times[Me+1]>U){ne.set(re.times.slice(0,Me+1),0),ne[Me+1]=U,ne.set(re.times.slice(Me+1),Me+2),F.set(re.values.slice(0,(Me+1)*ie),0),F.set(fe.evaluate(U),(Me+1)*ie),F.set(re.values.slice((Me+1)*ie),(Me+2)*ie),pe=Me+1;break}}return re.times=ne,re.values=F,pe},mergeMorphTargetTracks:function(re,U){const Y=[],ie={},ne=re.tracks;for(let F=0;F<ne.length;++F){let fe=ne[F];const pe=PropertyBinding.parseTrackName(fe.name),Me=PropertyBinding.findNode(U,pe.nodeName);if(pe.propertyName!=="morphTargetInfluences"||pe.propertyIndex===void 0){Y.push(fe);continue}if(fe.createInterpolant!==fe.InterpolantFactoryMethodDiscrete&&fe.createInterpolant!==fe.InterpolantFactoryMethodLinear){if(fe.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),fe=fe.clone(),fe.setInterpolation(InterpolateLinear)}const ve=Me.morphTargetInfluences.length,se=Me.morphTargetDictionary[pe.propertyIndex];if(se===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+pe.propertyIndex);let me;if(ie[Me.uuid]===void 0){me=fe.clone();const Re=new me.ValueBufferType(ve*me.times.length);for(let be=0;be<me.times.length;be++)Re[be*ve+se]=me.values[be];me.name=(pe.nodeName||"")+".morphTargetInfluences",me.values=Re,ie[Me.uuid]=me,Y.push(me);continue}const Te=fe.createInterpolant(new fe.ValueBufferType(1));me=ie[Me.uuid];for(let Re=0;Re<me.times.length;Re++)me.values[Re*ve+se]=Te.evaluate(me.times[Re]);for(let Re=0;Re<fe.times.length;Re++){const be=this.insertKeyframe(me,fe.times[Re]);me.values[be*ve+se]=fe.values[Re]}}return re.tracks=Y,re}};/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const compatibleObject=re=>re.material!==void 0&&re.userData&&re.userData.variantMaterials&&!!Array.from(re.userData.variantMaterials.values()).filter(U=>compatibleMaterial(U.material)),compatibleMaterial=re=>re&&re.isMaterial&&!Array.isArray(re);class GLTFExporterMaterialsVariantsExtension{constructor(U){this.writer=U,this.name="KHR_materials_variants",this.variantNames=[]}beforeParse(U){const Y=new Set;for(const ie of U)ie.traverse(ne=>{if(!compatibleObject(ne))return;const F=ne.userData.variantMaterials,fe=ne.userData.variantData;for(const[pe,Me]of fe){const ve=F.get(Me.index);ve&&compatibleMaterial(ve.material)&&Y.add(pe)}});Y.forEach(ie=>this.variantNames.push(ie))}writeMesh(U,Y){if(!compatibleObject(U))return;const ie=U.userData,ne=ie.variantMaterials,F=ie.variantData,fe=new Map,pe=new Map,Me=Array.from(F.values()).sort((me,Te)=>me.index-Te.index);for(const[me,Te]of Me.entries())pe.set(Te.index,me);for(const me of F.values()){const Te=ne.get(me.index);if(!Te||!compatibleMaterial(Te.material))continue;const Re=this.writer.processMaterial(Te.material);fe.has(Re)||fe.set(Re,{material:Re,variants:[]}),fe.get(Re).variants.push(pe.get(me.index))}const ve=Array.from(fe.values()).map(me=>me.variants.sort((Te,Re)=>Te-Re)&&me).sort((me,Te)=>me.material-Te.material);if(ve.length===0)return;const se=compatibleMaterial(ie.originalMaterial)?this.writer.processMaterial(ie.originalMaterial):-1;for(const me of Y.primitives)se>=0&&(me.material=se),me.extensions=me.extensions||{},me.extensions[this.name]={mappings:ve}}afterParse(){if(this.variantNames.length===0)return;const U=this.writer.json;U.extensions=U.extensions||{};const Y=this.variantNames.map(ie=>({name:ie}));U.extensions[this.name]={variants:Y},this.writer.extensionsUsed[this.name]=!0}}class SessionLightProbe{constructor(U,Y,ie,ne,F){this.xrLight=U,this.renderer=Y,this.lightProbe=ie,this.xrWebGLBinding=null,this.estimationStartCallback=F,this.frameCallback=this.onXRFrame.bind(this);const fe=Y.xr.getSession();if(ne&&"XRWebGLBinding"in window){const pe=new WebGLCubeRenderTarget(16);U.environment=pe.texture;const Me=Y.getContext();switch(fe.preferredReflectionFormat){case"srgba8":Me.getExtension("EXT_sRGB");break;case"rgba16f":Me.getExtension("OES_texture_half_float");break}this.xrWebGLBinding=new XRWebGLBinding(fe,Me),this.lightProbe.addEventListener("reflectionchange",()=>{this.updateReflection()})}fe.requestAnimationFrame(this.frameCallback)}updateReflection(){const U=this.renderer.properties.get(this.xrLight.environment);if(U){const Y=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);Y&&(U.__webglTexture=Y,this.xrLight.environment.needsPMREMUpdate=!0)}}onXRFrame(U,Y){if(!this.xrLight)return;Y.session.requestAnimationFrame(this.frameCallback);const ne=Y.getLightEstimate(this.lightProbe);if(ne){this.xrLight.lightProbe.sh.fromArray(ne.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;const F=Math.max(1,Math.max(ne.primaryLightIntensity.x,Math.max(ne.primaryLightIntensity.y,ne.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB(ne.primaryLightIntensity.x/F,ne.primaryLightIntensity.y/F,ne.primaryLightIntensity.z/F),this.xrLight.directionalLight.intensity=F,this.xrLight.directionalLight.position.copy(ne.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}dispose(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null}}class XREstimatedLight extends Group{constructor(U,Y=!0){super(),this.lightProbe=new LightProbe,this.lightProbe.intensity=0,this.add(this.lightProbe),this.directionalLight=new DirectionalLight,this.directionalLight.intensity=0,this.add(this.directionalLight),this.environment=null;let ie=null,ne=!1;U.xr.addEventListener("sessionstart",()=>{const F=U.xr.getSession();"requestLightProbe"in F&&F.requestLightProbe({reflectionFormat:F.preferredReflectionFormat}).then(fe=>{ie=new SessionLightProbe(this,U,fe,Y,()=>{ne=!0,this.dispatchEvent({type:"estimationstart"})})})}),U.xr.addEventListener("sessionend",()=>{ie&&(ie.dispose(),ie=null),ne&&this.dispatchEvent({type:"estimationend"})}),this.dispose=()=>{ie&&(ie.dispose(),ie=null),this.remove(this.lightProbe),this.lightProbe=null,this.remove(this.directionalLight),this.directionalLight=null,this.environment=null}}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SETTLING_TIME=1e4,MIN_DECAY_MILLISECONDS=.001,DECAY_MILLISECONDS=50;class Damper{constructor(U=DECAY_MILLISECONDS){this.velocity=0,this.naturalFrequency=0,this.setDecayTime(U)}setDecayTime(U){this.naturalFrequency=1/Math.max(MIN_DECAY_MILLISECONDS,U)}update(U,Y,ie,ne){const F=2e-4*this.naturalFrequency;if(U==null||ne===0||U===Y&&this.velocity===0)return Y;if(ie<0)return U;const fe=U-Y,pe=this.velocity+this.naturalFrequency*fe,Me=fe+ie*pe,ve=Math.exp(-this.naturalFrequency*ie),se=(pe-this.naturalFrequency*Me)*ve,me=-this.naturalFrequency*(se+pe*ve);return Math.abs(se)<F*Math.abs(ne)&&me*fe>=0?(this.velocity=0,Y):(this.velocity=se,Y+Me*ve)}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RADIUS=.2,LINE_WIDTH=.03,MAX_OPACITY=.75,SEGMENTS=12,DELTA_PHI=Math.PI/(2*SEGMENTS),vector2$1=new Vector2,addCorner=(re,U,Y)=>{let ie=U>0?Y>0?0:-Math.PI/2:Y>0?Math.PI/2:Math.PI;for(let ne=0;ne<=SEGMENTS;++ne)re.push(U+(RADIUS-LINE_WIDTH)*Math.cos(ie),Y+(RADIUS-LINE_WIDTH)*Math.sin(ie),0,U+RADIUS*Math.cos(ie),Y+RADIUS*Math.sin(ie),0),ie+=DELTA_PHI};class PlacementBox extends Mesh{constructor(U,Y){const ie=new BufferGeometry,ne=[],F=[],{size:fe,boundingBox:pe}=U,Me=fe.x/2,ve=(Y==="back"?fe.y:fe.z)/2;addCorner(F,Me,ve),addCorner(F,-Me,ve),addCorner(F,-Me,-ve),addCorner(F,Me,-ve);const se=F.length/3;for(let Re=0;Re<se-2;Re+=2)ne.push(Re,Re+1,Re+3,Re,Re+3,Re+2);const me=se-2;ne.push(me,me+1,1,me,1,0),ie.setAttribute("position",new Float32BufferAttribute(F,3)),ie.setIndex(ne),super(ie),this.side=Y;const Te=this.material;switch(Te.side=DoubleSide,Te.transparent=!0,Te.opacity=0,this.goalOpacity=0,this.opacityDamper=new Damper,this.hitPlane=new Mesh(new PlaneGeometry(2*(Me+RADIUS),2*(ve+RADIUS))),this.hitPlane.visible=!1,this.hitPlane.material.side=DoubleSide,this.add(this.hitPlane),this.hitBox=new Mesh(new BoxGeometry(fe.x+2*RADIUS,fe.y+RADIUS,fe.z+2*RADIUS)),this.hitBox.visible=!1,this.hitBox.material.side=DoubleSide,this.add(this.hitBox),pe.getCenter(this.position),Y){case"bottom":this.rotateX(-Math.PI/2),this.shadowHeight=pe.min.y,this.position.y=this.shadowHeight;break;case"back":this.shadowHeight=pe.min.z,this.position.z=this.shadowHeight}U.target.add(this),this.hitBox.position.y=(fe.y+RADIUS)/2+pe.min.y,U.target.add(this.hitBox),this.offsetHeight=0}getHit(U,Y,ie){vector2$1.set(Y,-ie),this.hitPlane.visible=!0;const ne=U.positionAndNormalFromPoint(vector2$1,this.hitPlane);return this.hitPlane.visible=!1,ne==null?null:ne.position}getExpandedHit(U,Y,ie){this.hitPlane.scale.set(1e3,1e3,1e3),this.hitPlane.updateMatrixWorld();const ne=this.getHit(U,Y,ie);return this.hitPlane.scale.set(1,1,1),ne}controllerIntersection(U,Y){this.hitBox.visible=!0;const ie=U.hitFromController(Y,this.hitBox);return this.hitBox.visible=!1,ie}set offsetHeight(U){U-=.001,this.side==="back"?this.position.z=this.shadowHeight+U:this.position.y=this.shadowHeight+U}get offsetHeight(){return this.side==="back"?this.position.z-this.shadowHeight:this.position.y-this.shadowHeight}set show(U){this.goalOpacity=U?MAX_OPACITY:0}updateOpacity(U){const Y=this.material;Y.opacity=this.opacityDamper.update(Y.opacity,this.goalOpacity,U,1),this.visible=Y.opacity>0}dispose(){const{geometry:U,material:Y}=this.hitPlane;U.dispose(),Y.dispose(),this.hitBox.geometry.dispose(),this.hitBox.material.dispose(),this.geometry.dispose(),this.material.dispose(),this.hitBox.removeFromParent(),this.removeFromParent()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const numberNode=(re,U)=>({type:"number",number:re,unit:U}),parseExpressions=(()=>{const re={};return Y=>{const ie=Y;if(ie in re)return re[ie];const ne=[];let F=0;for(;Y;){if(++F>1e3){Y="";break}const fe=parseExpression(Y),pe=fe.nodes[0];if(pe==null||pe.terms.length===0)break;ne.push(pe),Y=fe.remainingInput}return re[ie]=ne}})(),parseExpression=(()=>{const re=/^(\-\-|[a-z\u0240-\uffff])/i,U=/^([\*\+\/]|[\-]\s)/i,Y=/^[\),]/,ie="(",ne="#";return F=>{const fe=[];for(;F.length&&(F=F.trim(),!Y.test(F));)if(F[0]===ie){const{nodes:pe,remainingInput:Me}=parseFunctionArguments(F);F=Me,fe.push({type:"function",name:{type:"ident",value:"calc"},arguments:pe})}else if(re.test(F)){const pe=parseIdent(F),Me=pe.nodes[0];if(F=pe.remainingInput,F[0]===ie){const{nodes:ve,remainingInput:se}=parseFunctionArguments(F);fe.push({type:"function",name:Me,arguments:ve}),F=se}else fe.push(Me)}else if(U.test(F))fe.push({type:"operator",value:F[0]}),F=F.slice(1);else{const{nodes:pe,remainingInput:Me}=F[0]===ne?parseHex(F):parseNumber(F);if(pe.length===0)break;fe.push(pe[0]),F=Me}return{nodes:[{type:"expression",terms:fe}],remainingInput:F}}})(),parseIdent=(()=>{const re=/[^a-z0-9_\-\u0240-\uffff]/i;return U=>{const Y=U.match(re),ie=Y==null?U:U.substr(0,Y.index),ne=Y==null?"":U.substr(Y.index);return{nodes:[{type:"ident",value:ie}],remainingInput:ne}}})(),parseNumber=(()=>{const re=/[\+\-]?(\d+[\.]\d+|\d+|[\.]\d+)([eE][\+\-]?\d+)?/,U=/^[a-z%]+/i,Y=/^(m|mm|cm|rad|deg|[%])$/;return ie=>{const ne=ie.match(re),F=ne==null?"0":ne[0];ie=F==null?ie:ie.slice(F.length);const fe=ie.match(U);let pe=fe!=null&&fe[0]!==""?fe[0]:null;const Me=fe==null?ie:ie.slice(pe.length);return pe!=null&&!Y.test(pe)&&(pe=null),{nodes:[{type:"number",number:parseFloat(F)||0,unit:pe}],remainingInput:Me}}})(),parseHex=(()=>{const re=/^[a-f0-9]*/i;return U=>{U=U.slice(1).trim();const Y=U.match(re);return{nodes:Y==null?[]:[{type:"hex",value:Y[0]}],remainingInput:Y==null?U:U.slice(Y[0].length)}}})(),parseFunctionArguments=re=>{const U=[];for(re=re.slice(1).trim();re.length;){const Y=parseExpression(re);if(U.push(Y.nodes[0]),re=Y.remainingInput.trim(),re[0]===",")re=re.slice(1).trim();else if(re[0]===")"){re=re.slice(1);break}}return{nodes:U,remainingInput:re}},$visitedTypes=Symbol("visitedTypes");class ASTWalker{constructor(U){this[$visitedTypes]=U}walk(U,Y){const ie=U.slice();for(;ie.length;){const ne=ie.shift();switch(this[$visitedTypes].indexOf(ne.type)>-1&&Y(ne),ne.type){case"expression":ie.unshift(...ne.terms);break;case"function":ie.unshift(ne.name,...ne.arguments);break}}}}const ZERO=Object.freeze({type:"number",number:0,unit:null});/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const degreesToRadians=(re,U=0)=>{let{number:Y,unit:ie}=re;if(!isFinite(Y))Y=U,ie="rad";else if(re.unit==="rad"||re.unit==null)return re;return{type:"number",number:(ie==="deg"&&Y!=null?Y:0)*Math.PI/180,unit:"rad"}},lengthToBaseMeters=(re,U=0)=>{let{number:Y,unit:ie}=re;if(!isFinite(Y))Y=U,ie="m";else if(re.unit==="m")return re;let ne;switch(ie){default:ne=1;break;case"cm":ne=1/100;break;case"mm":ne=1/1e3;break}return{type:"number",number:ne*Y,unit:"m"}},normalizeUnit=(()=>{const re=Y=>Y,U={rad:re,deg:degreesToRadians,m:re,mm:lengthToBaseMeters,cm:lengthToBaseMeters};return(Y,ie=ZERO)=>{isFinite(Y.number)||(Y.number=ie.number,Y.unit=ie.unit);const{unit:ne}=Y;if(ne==null)return Y;const F=U[ne];return F==null?ie:F(Y)}})();/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$6,_b$6,_c$4;const $evaluate=Symbol("evaluate"),$lastValue=Symbol("lastValue");class Evaluator{constructor(){this[_a$6]=null}static evaluatableFor(U,Y=ZERO){if(U instanceof Evaluator)return U;if(U.type==="number")return U.unit==="%"?new PercentageEvaluator(U,Y):U;switch(U.name.value){case"calc":return new CalcEvaluator(U,Y);case"env":return new EnvEvaluator(U)}return ZERO}static evaluate(U){return U instanceof Evaluator?U.evaluate():U}static isConstant(U){return U instanceof Evaluator?U.isConstant:!0}static applyIntrinsics(U,Y){const{basis:ie,keywords:ne}=Y,{auto:F}=ne;return ie.map((fe,pe)=>{const Me=F[pe]==null?fe:F[pe];let ve=U[pe]?U[pe]:Me;if(ve.type==="ident"){const se=ve.value;se in ne&&(ve=ne[se][pe])}return(ve==null||ve.type==="ident")&&(ve=Me),ve.unit==="%"?numberNode(ve.number/100*fe.number,fe.unit):(ve=normalizeUnit(ve,fe),ve.unit!==fe.unit?fe:ve)})}get isConstant(){return!1}evaluate(){return(!this.isConstant||this[$lastValue]==null)&&(this[$lastValue]=this[$evaluate]()),this[$lastValue]}}_a$6=$lastValue;const $percentage=Symbol("percentage"),$basis=Symbol("basis");class PercentageEvaluator extends Evaluator{constructor(U,Y){super(),this[$percentage]=U,this[$basis]=Y}get isConstant(){return!0}[$evaluate](){return numberNode(this[$percentage].number/100*this[$basis].number,this[$basis].unit)}}const $identNode=Symbol("identNode");class EnvEvaluator extends Evaluator{constructor(U){super(),this[_b$6]=null;const Y=U.arguments.length?U.arguments[0].terms[0]:null;Y!=null&&Y.type==="ident"&&(this[$identNode]=Y)}get isConstant(){return!1}[(_b$6=$identNode,$evaluate)](){if(this[$identNode]!=null)switch(this[$identNode].value){case"window-scroll-y":const U=window.pageYOffset,Y=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);return{type:"number",number:U/(Y-window.innerHeight)||0,unit:null}}return ZERO}}const IS_MULTIPLICATION_RE=/[\*\/]/,$evaluator=Symbol("evaluator");class CalcEvaluator extends Evaluator{constructor(U,Y=ZERO){if(super(),this[_c$4]=null,U.arguments.length!==1)return;const ie=U.arguments[0].terms.slice(),ne=[];for(;ie.length;){const F=ie.shift();if(ne.length>0){const fe=ne[ne.length-1];if(fe.type==="operator"&&IS_MULTIPLICATION_RE.test(fe.value)){const pe=ne.pop(),Me=ne.pop();if(Me==null)return;ne.push(new OperatorEvaluator(pe,Evaluator.evaluatableFor(Me,Y),Evaluator.evaluatableFor(F,Y)));continue}}ne.push(F.type==="operator"?F:Evaluator.evaluatableFor(F,Y))}for(;ne.length>2;){const[F,fe,pe]=ne.splice(0,3);if(fe.type!=="operator")return;ne.unshift(new OperatorEvaluator(fe,Evaluator.evaluatableFor(F,Y),Evaluator.evaluatableFor(pe,Y)))}ne.length===1&&(this[$evaluator]=ne[0])}get isConstant(){return this[$evaluator]==null||Evaluator.isConstant(this[$evaluator])}[(_c$4=$evaluator,$evaluate)](){return this[$evaluator]!=null?Evaluator.evaluate(this[$evaluator]):ZERO}}const $operator=Symbol("operator"),$left=Symbol("left"),$right=Symbol("right");class OperatorEvaluator extends Evaluator{constructor(U,Y,ie){super(),this[$operator]=U,this[$left]=Y,this[$right]=ie}get isConstant(){return Evaluator.isConstant(this[$left])&&Evaluator.isConstant(this[$right])}[$evaluate](){const U=normalizeUnit(Evaluator.evaluate(this[$left])),Y=normalizeUnit(Evaluator.evaluate(this[$right])),{number:ie,unit:ne}=U,{number:F,unit:fe}=Y;if(fe!=null&&ne!=null&&fe!=ne)return ZERO;const pe=ne||fe;let Me;switch(this[$operator].value){case"+":Me=ie+F;break;case"-":Me=ie-F;break;case"/":Me=ie/F;break;case"*":Me=ie*F;break;default:return ZERO}return{type:"number",number:Me,unit:pe}}}const $evaluatables=Symbol("evaluatables"),$intrinsics=Symbol("intrinsics");class StyleEvaluator extends Evaluator{constructor(U,Y){super(),this[$intrinsics]=Y;const ie=U[0],ne=ie!=null?ie.terms:[];this[$evaluatables]=Y.basis.map((F,fe)=>{const pe=ne[fe];return pe==null?{type:"ident",value:"auto"}:pe.type==="ident"?pe:Evaluator.evaluatableFor(pe,F)})}get isConstant(){for(const U of this[$evaluatables])if(!Evaluator.isConstant(U))return!1;return!0}[$evaluate](){const U=this[$evaluatables].map(Y=>Evaluator.evaluate(Y));return Evaluator.applyIntrinsics(U,this[$intrinsics]).map(Y=>Y.number)}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$5,_b$5,_c$3,_d$2;const $instances=Symbol("instances"),$activateListener=Symbol("activateListener"),$deactivateListener=Symbol("deactivateListener"),$notifyInstances=Symbol("notifyInstances"),$notify=Symbol("notify"),$scrollCallback=Symbol("callback");class ScrollObserver{constructor(U){this[$scrollCallback]=U}static[$notifyInstances](){for(const U of ScrollObserver[$instances])U[$notify]()}static[(_a$5=$instances,$activateListener)](){window.addEventListener("scroll",this[$notifyInstances],{passive:!0})}static[$deactivateListener](){window.removeEventListener("scroll",this[$notifyInstances])}observe(){ScrollObserver[$instances].size===0&&ScrollObserver[$activateListener](),ScrollObserver[$instances].add(this)}disconnect(){ScrollObserver[$instances].delete(this),ScrollObserver[$instances].size===0&&ScrollObserver[$deactivateListener]()}[$notify](){this[$scrollCallback]()}}ScrollObserver[_a$5]=new Set;const $computeStyleCallback=Symbol("computeStyleCallback"),$astWalker=Symbol("astWalker"),$dependencies=Symbol("dependencies"),$onScroll=Symbol("onScroll");class StyleEffector{constructor(U){this[_b$5]={},this[_c$3]=new ASTWalker(["function"]),this[_d$2]=()=>{this[$computeStyleCallback]({relatedState:"window-scroll"})},this[$computeStyleCallback]=U}observeEffectsFor(U){const Y={},ie=this[$dependencies];this[$astWalker].walk(U,ne=>{const{name:F}=ne,pe=ne.arguments[0].terms[0];if(!(F.value!=="env"||pe==null||pe.type!=="ident"))switch(pe.value){case"window-scroll-y":if(Y["window-scroll"]==null){const Me="window-scroll"in ie?ie["window-scroll"]:new ScrollObserver(this[$onScroll]);Me.observe(),delete ie["window-scroll"],Y["window-scroll"]=Me}break}});for(const ne in ie)ie[ne].disconnect();this[$dependencies]=Y}dispose(){for(const U in this[$dependencies])this[$dependencies][U].disconnect()}}_b$5=$dependencies,_c$3=$astWalker,_d$2=$onScroll;/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const style=re=>{const U=re.observeEffects||!1,Y=re.intrinsics instanceof Function?re.intrinsics:()=>re.intrinsics;return(ie,ne)=>{const F=ie.updated,fe=ie.connectedCallback,pe=ie.disconnectedCallback,Me=Symbol(`${ne}StyleEffector`),ve=Symbol(`${ne}StyleEvaluator`),se=Symbol(`${ne}UpdateEvaluator`),me=Symbol(`${ne}EvaluateAndSync`);Object.defineProperties(ie,{[Me]:{value:null,writable:!0},[ve]:{value:null,writable:!0},[se]:{value:function(){const Te=parseExpressions(this[ne]);this[ve]=new StyleEvaluator(Te,Y(this)),this[Me]==null&&U&&(this[Me]=new StyleEffector(()=>this[me]())),this[Me]!=null&&this[Me].observeEffectsFor(Te)}},[me]:{value:function(){if(this[ve]==null)return;const Te=this[ve].evaluate();this[re.updateHandler](Te)}},updated:{value:function(Te){Te.has(ne)&&(this[se](),this[me]()),F.call(this,Te)}},connectedCallback:{value:function(){fe.call(this),this.requestUpdate(ne,this[ne])}},disconnectedCallback:{value:function(){pe.call(this),this[Me]!=null&&(this[Me].dispose(),this[Me]=null)}}})}};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const easeInOutQuad=re=>re<.5?2*re*re:-1+(4-2*re)*re,interpolate=(re,U,Y=easeInOutQuad)=>ie=>re+(U-re)*Y(ie),sequence=(re,U)=>{const Y=ne=>F=>ne+=F,ie=U.map(Y(0));return ne=>{ne=clamp(ne,0,1),ne*=ie[ie.length-1];const F=ie.findIndex(Me=>Me>=ne),fe=F<1?0:ie[F-1],pe=ie[F];return re[F]((ne-fe)/(pe-fe))}},timeline=re=>{const U=[],Y=[];let ie=re.initialValue;for(let ne=0;ne<re.keyframes.length;++ne){const F=re.keyframes[ne],{value:fe,frames:pe}=F,Me=F.ease||easeInOutQuad,ve=interpolate(ie,fe,Me);U.push(ve),Y.push(pe),ie=fe}return sequence(U,Y)};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$6=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};const PROMPT_ANIMATION_TIME=5e3,wiggle=timeline({initialValue:0,keyframes:[{frames:5,value:-1},{frames:1,value:-1},{frames:8,value:1},{frames:1,value:1},{frames:5,value:0},{frames:18,value:0}]}),fade=timeline({initialValue:0,keyframes:[{frames:1,value:1},{frames:5,value:1},{frames:1,value:0},{frames:6,value:0}]}),DEFAULT_FOV_DEG=30,DEFAULT_MIN_FOV_DEG=12,DEFAULT_CAMERA_ORBIT="0deg 75deg 105%",DEFAULT_CAMERA_TARGET="auto auto auto",DEFAULT_FIELD_OF_VIEW="auto",MINIMUM_RADIUS_RATIO=2.2,AZIMUTHAL_QUADRANT_LABELS=["front","right","back","left"],POLAR_TRIENT_LABELS=["upper-","","lower-"],DEFAULT_INTERACTION_PROMPT_THRESHOLD=3e3,INTERACTION_PROMPT=". Use mouse, touch or arrow keys to move.",InteractionPromptStrategy={AUTO:"auto",NONE:"none"},InteractionPromptStyle={BASIC:"basic",WIGGLE:"wiggle"},TouchAction={PAN_Y:"pan-y",PAN_X:"pan-x",NONE:"none"},fieldOfViewIntrinsics=()=>({basis:[degreesToRadians(numberNode(DEFAULT_FOV_DEG,"deg"))],keywords:{auto:[null]}}),minFieldOfViewIntrinsics=()=>({basis:[degreesToRadians(numberNode(DEFAULT_MIN_FOV_DEG,"deg"))],keywords:{auto:[null]}}),cameraOrbitIntrinsics=(()=>{const re=parseExpressions(DEFAULT_CAMERA_ORBIT)[0].terms,U=normalizeUnit(re[0]),Y=normalizeUnit(re[1]);return ie=>{const ne=ie[$scene].idealCameraDistance();return{basis:[U,Y,numberNode(ne,"m")],keywords:{auto:[null,null,numberNode(105,"%")]}}}})(),minCameraOrbitIntrinsics=re=>{const U=MINIMUM_RADIUS_RATIO*re[$scene].boundingSphere.radius;return{basis:[numberNode(-1/0,"rad"),numberNode(0,"rad"),numberNode(U,"m")],keywords:{auto:[null,null,null]}}},maxCameraOrbitIntrinsics=re=>{const U=cameraOrbitIntrinsics(re),ie=new StyleEvaluator([],U).evaluate()[2];return{basis:[numberNode(1/0,"rad"),numberNode(Math.PI,"rad"),numberNode(ie,"m")],keywords:{auto:[null,null,null]}}},cameraTargetIntrinsics=re=>{const U=re[$scene].boundingBox.getCenter(new Vector3);return{basis:[numberNode(U.x,"m"),numberNode(U.y,"m"),numberNode(U.z,"m")],keywords:{auto:[null,null,null]}}},HALF_PI=Math.PI/2,THIRD_PI=Math.PI/3,QUARTER_PI=HALF_PI/2,TAU=2*Math.PI,$controls=Symbol("controls"),$panElement=Symbol("panElement"),$promptElement=Symbol("promptElement"),$promptAnimatedContainer=Symbol("promptAnimatedContainer"),$fingerAnimatedContainers=Symbol("fingerAnimatedContainers"),$deferInteractionPrompt=Symbol("deferInteractionPrompt"),$updateAria=Symbol("updateAria"),$a11y=Symbol("a11y"),$updateA11y=Symbol("updateA11y"),$updateCameraForRadius=Symbol("updateCameraForRadius"),$cancelPrompts=Symbol("cancelPrompts"),$onChange=Symbol("onChange"),$onPointerChange=Symbol("onPointerChange"),$waitingToPromptUser=Symbol("waitingToPromptUser"),$userHasInteracted=Symbol("userHasInteracted"),$promptElementVisibleTime=Symbol("promptElementVisibleTime"),$lastPromptOffset=Symbol("lastPromptOffset"),$cancellationSource=Symbol("cancellationSource"),$lastSpherical=Symbol("lastSpherical"),$jumpCamera=Symbol("jumpCamera"),$initialized=Symbol("initialized"),$maintainThetaPhi=Symbol("maintainThetaPhi"),$syncCameraOrbit=Symbol("syncCameraOrbit"),$syncFieldOfView=Symbol("syncFieldOfView"),$syncCameraTarget=Symbol("syncCameraTarget"),$syncMinCameraOrbit=Symbol("syncMinCameraOrbit"),$syncMaxCameraOrbit=Symbol("syncMaxCameraOrbit"),$syncMinFieldOfView=Symbol("syncMinFieldOfView"),$syncMaxFieldOfView=Symbol("syncMaxFieldOfView"),ControlsMixin=re=>{var U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le,xe,Fe;class Oe extends re{constructor(){super(...arguments),this.cameraControls=!1,this.cameraOrbit=DEFAULT_CAMERA_ORBIT,this.cameraTarget=DEFAULT_CAMERA_TARGET,this.fieldOfView=DEFAULT_FIELD_OF_VIEW,this.minCameraOrbit="auto",this.maxCameraOrbit="auto",this.minFieldOfView="auto",this.maxFieldOfView="auto",this.interactionPromptThreshold=DEFAULT_INTERACTION_PROMPT_THRESHOLD,this.interactionPrompt=InteractionPromptStrategy.AUTO,this.interactionPromptStyle=InteractionPromptStyle.WIGGLE,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.touchAction=TouchAction.NONE,this.disableZoom=!1,this.disablePan=!1,this.disableTap=!1,this.interpolationDecay=DECAY_MILLISECONDS,this.a11y=null,this[U]=this.shadowRoot.querySelector(".interaction-prompt"),this[Y]=this.shadowRoot.querySelector("#prompt"),this[ie]=[this.shadowRoot.querySelector("#finger0"),this.shadowRoot.querySelector("#finger1")],this[ne]=this.shadowRoot.querySelector(".pan-target"),this[F]=0,this[fe]=1/0,this[pe]=!1,this[Me]=!1,this[ve]=ChangeSource.AUTOMATIC,this[se]=new SmoothControls(this[$scene].camera,this[$userInputElement],this[$scene]),this[me]=new Spherical,this[Te]=!1,this[Re]=!1,this[be]=!1,this[Pe]={},this[Le]=()=>{const ke=this[$controls].changeSource;this[$cancellationSource]=ke,ke===ChangeSource.USER_INTERACTION&&(this[$userHasInteracted]=!0,this[$deferInteractionPrompt]())},this[xe]=()=>{this[$updateAria](),this[$needsRender]();const ke=this[$controls].changeSource;this.dispatchEvent(new CustomEvent("camera-change",{detail:{source:ke}}))},this[Fe]=ke=>{this[$container].classList.toggle("pointer-tumbling",ke.type==="pointer-change-start")}}get inputSensitivity(){return this[$controls].inputSensitivity}set inputSensitivity(ke){this[$controls].inputSensitivity=ke}getCameraOrbit(){const{theta:ke,phi:Ve,radius:Xe}=this[$lastSpherical];return{theta:ke,phi:Ve,radius:Xe,toString(){return`${this.theta}rad ${this.phi}rad ${this.radius}m`}}}getCameraTarget(){return toVector3D(this[$renderer].isPresenting?this[$renderer].arRenderer.target:this[$scene].getDynamicTarget())}getFieldOfView(){return this[$controls].getFieldOfView()}getMinimumFieldOfView(){return this[$controls].options.minimumFieldOfView}getMaximumFieldOfView(){return this[$controls].options.maximumFieldOfView}getIdealAspect(){return this[$scene].idealAspect}jumpCameraToGoal(){this[$jumpCamera]=!0,this.requestUpdate($jumpCamera,!1)}resetInteractionPrompt(){this[$lastPromptOffset]=0,this[$promptElementVisibleTime]=1/0,this[$userHasInteracted]=!1,this[$waitingToPromptUser]=this.interactionPrompt===InteractionPromptStrategy.AUTO&&this.cameraControls}zoom(ke){const Ve=new WheelEvent("wheel",{deltaY:-30*ke});this[$userInputElement].dispatchEvent(Ve)}connectedCallback(){super.connectedCallback(),this[$controls].addEventListener("user-interaction",this[$cancelPrompts]),this[$controls].addEventListener("pointer-change-start",this[$onPointerChange]),this[$controls].addEventListener("pointer-change-end",this[$onPointerChange])}disconnectedCallback(){super.disconnectedCallback(),this[$controls].removeEventListener("user-interaction",this[$cancelPrompts]),this[$controls].removeEventListener("pointer-change-start",this[$onPointerChange]),this[$controls].removeEventListener("pointer-change-end",this[$onPointerChange])}updated(ke){super.updated(ke);const Ve=this[$controls],Xe=this[$scene];if(ke.has("cameraControls")&&(this.cameraControls?(Ve.enableInteraction(),this.interactionPrompt===InteractionPromptStrategy.AUTO&&(this[$waitingToPromptUser]=!0)):(Ve.disableInteraction(),this[$deferInteractionPrompt]()),this[$userInputElement].setAttribute("aria-label",this[$ariaLabel])),ke.has("disableZoom")&&(Ve.disableZoom=this.disableZoom),ke.has("disablePan")&&(Ve.enablePan=!this.disablePan),ke.has("disableTap")&&(Ve.enableTap=!this.disableTap),(ke.has("interactionPrompt")||ke.has("cameraControls")||ke.has("src"))&&(this.interactionPrompt===InteractionPromptStrategy.AUTO&&this.cameraControls&&!this[$userHasInteracted]?this[$waitingToPromptUser]=!0:this[$deferInteractionPrompt]()),ke.has("interactionPromptStyle")&&(this[$promptAnimatedContainer].style.opacity=this.interactionPromptStyle==InteractionPromptStyle.BASIC?"1":"0"),ke.has("touchAction")){const $e=this.touchAction;Ve.applyOptions({touchAction:$e}),Ve.updateTouchActionStyle()}ke.has("orbitSensitivity")&&(Ve.orbitSensitivity=this.orbitSensitivity),ke.has("zoomSensitivity")&&(Ve.zoomSensitivity=this.zoomSensitivity),ke.has("panSensitivity")&&(Ve.panSensitivity=this.panSensitivity),ke.has("interpolationDecay")&&(Ve.setDamperDecayTime(this.interpolationDecay),Xe.setTargetDamperDecayTime(this.interpolationDecay)),ke.has("a11y")&&this[$updateA11y](),this[$jumpCamera]===!0&&Promise.resolve().then(()=>{Ve.jumpToGoal(),Xe.jumpToGoal(),this[$onChange](),this[$jumpCamera]=!1})}async updateFraming(){const ke=this[$scene],Ve=ke.adjustedFoV(ke.framedFoVDeg);await ke.updateFraming();const Xe=ke.adjustedFoV(ke.framedFoVDeg),$e=this[$controls].getFieldOfView()/Ve;this[$controls].setFieldOfView(Xe*$e),this[$maintainThetaPhi]=!0,this.requestUpdate("maxFieldOfView"),this.requestUpdate("fieldOfView"),this.requestUpdate("minCameraOrbit"),this.requestUpdate("maxCameraOrbit"),this.requestUpdate("cameraOrbit"),await this.updateComplete}interact(ke,Ve,Xe){const $e=this[$userInputElement],st=this[$fingerAnimatedContainers];if(st[0].style.opacity==="1"){console.warn("interact() failed because an existing interaction is running.");return}const ze=new Array;ze.push({x:timeline(Ve.x),y:timeline(Ve.y)});const tt=[{x:ze[0].x(0),y:ze[0].y(0)}];Xe!=null&&(ze.push({x:timeline(Xe.x),y:timeline(Xe.y)}),tt.push({x:ze[1].x(0),y:ze[1].y(0)}));let ft=performance.now();const{width:Rt,height:Mt}=this[$scene],Gt=this.getBoundingClientRect(),_t=ut=>{for(const[Ut,Tt]of tt.entries()){const{style:Xt}=st[Ut];Xt.transform=`translateX(${Rt*Tt.x}px) translateY(${Mt*Tt.y}px)`,ut==="pointerdown"?Xt.opacity="1":ut==="pointerup"&&(Xt.opacity="0");const hn={pointerId:Ut-5678,pointerType:"touch",target:$e,clientX:Rt*Tt.x+Gt.x,clientY:Mt*Tt.y+Gt.y,altKey:!0};$e.dispatchEvent(new PointerEvent(ut,hn))}},Bt=()=>{const ut=this[$cancellationSource];if(ut!==ChangeSource.AUTOMATIC||!$e.isConnected){for(const Tt of this[$fingerAnimatedContainers])Tt.style.opacity="0";_t("pointercancel"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:ut}})),document.removeEventListener("visibilitychange",dt);return}const Ut=Math.min(1,(performance.now()-ft)/ke);for(const[Tt,Xt]of tt.entries())Xt.x=ze[Tt].x(Ut),Xt.y=ze[Tt].y(Ut);_t("pointermove"),Ut<1?requestAnimationFrame(Bt):(_t("pointerup"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:ChangeSource.AUTOMATIC}})),document.removeEventListener("visibilitychange",dt))},dt=()=>{let ut=0;document.visibilityState==="hidden"?ut=performance.now()-ft:ft=performance.now()-ut};document.addEventListener("visibilitychange",dt),_t("pointerdown"),this[$cancellationSource]=ChangeSource.AUTOMATIC,requestAnimationFrame(Bt)}[(U=$promptElement,Y=$promptAnimatedContainer,ie=$fingerAnimatedContainers,ne=$panElement,F=$lastPromptOffset,fe=$promptElementVisibleTime,pe=$userHasInteracted,Me=$waitingToPromptUser,ve=$cancellationSource,se=$controls,me=$lastSpherical,Te=$jumpCamera,Re=$initialized,be=$maintainThetaPhi,Pe=$a11y,$syncFieldOfView)](ke){const Ve=this[$controls],Xe=this[$scene];Xe.framedFoVDeg=ke[0]*180/Math.PI,Ve.changeSource=ChangeSource.NONE,Ve.setFieldOfView(Xe.adjustedFoV(Xe.framedFoVDeg)),this[$cancelPrompts]()}[$syncCameraOrbit](ke){const Ve=this[$controls];if(this[$maintainThetaPhi]){const{theta:Xe,phi:$e}=this.getCameraOrbit();ke[0]=Xe,ke[1]=$e,this[$maintainThetaPhi]=!1}Ve.changeSource=ChangeSource.NONE,Ve.setOrbit(ke[0],ke[1],ke[2]),this[$cancelPrompts]()}[$syncMinCameraOrbit](ke){this[$controls].applyOptions({minimumAzimuthalAngle:ke[0],minimumPolarAngle:ke[1],minimumRadius:ke[2]}),this.jumpCameraToGoal()}[$syncMaxCameraOrbit](ke){this[$controls].applyOptions({maximumAzimuthalAngle:ke[0],maximumPolarAngle:ke[1],maximumRadius:ke[2]}),this[$updateCameraForRadius](ke[2]),this.jumpCameraToGoal()}[$syncMinFieldOfView](ke){this[$controls].applyOptions({minimumFieldOfView:ke[0]*180/Math.PI}),this.jumpCameraToGoal()}[$syncMaxFieldOfView](ke){const Ve=this[$scene].adjustedFoV(ke[0]*180/Math.PI);this[$controls].applyOptions({maximumFieldOfView:Ve}),this.jumpCameraToGoal()}[$syncCameraTarget](ke){const[Ve,Xe,$e]=ke;this[$renderer].arRenderer.isPresenting||this[$scene].setTarget(Ve,Xe,$e),this[$controls].changeSource=ChangeSource.NONE,this[$renderer].arRenderer.updateTarget(),this[$cancelPrompts]()}[$tick](ke,Ve){if(super[$tick](ke,Ve),this[$renderer].isPresenting||!this[$getModelIsVisible]())return;const Xe=this[$controls],$e=this[$scene],st=performance.now();if(this[$waitingToPromptUser]&&this.loaded&&st>this[$loadedTime]+this.interactionPromptThreshold&&(this[$waitingToPromptUser]=!1,this[$promptElementVisibleTime]=st,this[$promptElement].classList.add("visible")),isFinite(this[$promptElementVisibleTime])&&this.interactionPromptStyle===InteractionPromptStyle.WIGGLE){const ft=(st-this[$promptElementVisibleTime])/PROMPT_ANIMATION_TIME%1,Rt=wiggle(ft),Mt=fade(ft);if(this[$promptAnimatedContainer].style.opacity=`${Mt}`,Rt!==this[$lastPromptOffset]){const Gt=Rt*$e.width*.05,_t=(Rt-this[$lastPromptOffset])*Math.PI/16;this[$promptAnimatedContainer].style.transform=`translateX(${Gt}px)`,Xe.changeSource=ChangeSource.AUTOMATIC,Xe.adjustOrbit(_t,0,0),this[$lastPromptOffset]=Rt}}const ze=Xe.update(ke,Ve),tt=$e.updateTarget(Ve);(ze||tt)&&this[$onChange]()}[$deferInteractionPrompt](){this[$waitingToPromptUser]=!1,this[$promptElement].classList.remove("visible"),this[$promptElementVisibleTime]=1/0}[$updateCameraForRadius](ke){const Ve=Math.max(this[$scene].farRadius(),ke),Xe=0,$e=Math.abs(2*Ve);this[$controls].updateNearFar(Xe,$e)}[$updateAria](){const{theta:ke,phi:Ve}=this[$controls].getCameraSpherical(this[$lastSpherical]),Xe=(4+Math.floor((ke%TAU+QUARTER_PI)/HALF_PI))%4,$e=Math.floor(Ve/THIRD_PI),st=AZIMUTHAL_QUADRANT_LABELS[Xe],tt=`${POLAR_TRIENT_LABELS[$e]}${st}`,ft=tt;ft in this[$a11y]?this[$updateStatus](this[$a11y][ft]):this[$updateStatus](`View from stage ${tt}`)}get[$ariaLabel](){let ke=INTERACTION_PROMPT;return"interaction-prompt"in this[$a11y]&&(ke=`. ${this[$a11y]["interaction-prompt"]}`),super[$ariaLabel].replace(/\.$/,"")+(this.cameraControls?ke:"")}async[$onResize](ke){const Ve=this[$controls],Xe=this[$scene],$e=Xe.adjustedFoV(Xe.framedFoVDeg);super[$onResize](ke);const st=Xe.adjustedFoV(Xe.framedFoVDeg)/$e,ze=Ve.getFieldOfView()*(isFinite(st)?st:1);Ve.updateAspect(this[$scene].aspect),this.requestUpdate("maxFieldOfView",this.maxFieldOfView),await this.updateComplete,this[$controls].setFieldOfView(ze),this.jumpCameraToGoal()}[$onModelLoad](){super[$onModelLoad](),this[$initialized]?this[$maintainThetaPhi]=!0:this[$initialized]=!0,this.requestUpdate("maxFieldOfView",this.maxFieldOfView),this.requestUpdate("fieldOfView",this.fieldOfView),this.requestUpdate("minCameraOrbit",this.minCameraOrbit),this.requestUpdate("maxCameraOrbit",this.maxCameraOrbit),this.requestUpdate("cameraOrbit",this.cameraOrbit),this.requestUpdate("cameraTarget",this.cameraTarget),this.jumpCameraToGoal()}[(Le=$cancelPrompts,xe=$onChange,Fe=$onPointerChange,$updateA11y)](){if(typeof this.a11y=="string")if(this.a11y.startsWith("{"))try{this[$a11y]=JSON.parse(this.a11y)}catch(ke){console.warn("Error parsing a11y JSON:",ke)}else this.a11y.length>0?console.warn("Error not supported format, should be a JSON string:",this.a11y):this[$a11y]={};else typeof this.a11y=="object"&&this.a11y!=null?this[$a11y]=Object.assign({},this.a11y):this[$a11y]={};this[$userInputElement].setAttribute("aria-label",this[$ariaLabel])}}return __decorate$6([n$6({type:Boolean,attribute:"camera-controls"})],Oe.prototype,"cameraControls",void 0),__decorate$6([style({intrinsics:cameraOrbitIntrinsics,observeEffects:!0,updateHandler:$syncCameraOrbit}),n$6({type:String,attribute:"camera-orbit",hasChanged:()=>!0})],Oe.prototype,"cameraOrbit",void 0),__decorate$6([style({intrinsics:cameraTargetIntrinsics,observeEffects:!0,updateHandler:$syncCameraTarget}),n$6({type:String,attribute:"camera-target",hasChanged:()=>!0})],Oe.prototype,"cameraTarget",void 0),__decorate$6([style({intrinsics:fieldOfViewIntrinsics,observeEffects:!0,updateHandler:$syncFieldOfView}),n$6({type:String,attribute:"field-of-view",hasChanged:()=>!0})],Oe.prototype,"fieldOfView",void 0),__decorate$6([style({intrinsics:minCameraOrbitIntrinsics,updateHandler:$syncMinCameraOrbit}),n$6({type:String,attribute:"min-camera-orbit",hasChanged:()=>!0})],Oe.prototype,"minCameraOrbit",void 0),__decorate$6([style({intrinsics:maxCameraOrbitIntrinsics,updateHandler:$syncMaxCameraOrbit}),n$6({type:String,attribute:"max-camera-orbit",hasChanged:()=>!0})],Oe.prototype,"maxCameraOrbit",void 0),__decorate$6([style({intrinsics:minFieldOfViewIntrinsics,updateHandler:$syncMinFieldOfView}),n$6({type:String,attribute:"min-field-of-view",hasChanged:()=>!0})],Oe.prototype,"minFieldOfView",void 0),__decorate$6([style({intrinsics:fieldOfViewIntrinsics,updateHandler:$syncMaxFieldOfView}),n$6({type:String,attribute:"max-field-of-view",hasChanged:()=>!0})],Oe.prototype,"maxFieldOfView",void 0),__decorate$6([n$6({type:Number,attribute:"interaction-prompt-threshold"})],Oe.prototype,"interactionPromptThreshold",void 0),__decorate$6([n$6({type:String,attribute:"interaction-prompt"})],Oe.prototype,"interactionPrompt",void 0),__decorate$6([n$6({type:String,attribute:"interaction-prompt-style"})],Oe.prototype,"interactionPromptStyle",void 0),__decorate$6([n$6({type:Number,attribute:"orbit-sensitivity"})],Oe.prototype,"orbitSensitivity",void 0),__decorate$6([n$6({type:Number,attribute:"zoom-sensitivity"})],Oe.prototype,"zoomSensitivity",void 0),__decorate$6([n$6({type:Number,attribute:"pan-sensitivity"})],Oe.prototype,"panSensitivity",void 0),__decorate$6([n$6({type:String,attribute:"touch-action"})],Oe.prototype,"touchAction",void 0),__decorate$6([n$6({type:Boolean,attribute:"disable-zoom"})],Oe.prototype,"disableZoom",void 0),__decorate$6([n$6({type:Boolean,attribute:"disable-pan"})],Oe.prototype,"disablePan",void 0),__decorate$6([n$6({type:Boolean,attribute:"disable-tap"})],Oe.prototype,"disableTap",void 0),__decorate$6([n$6({type:Number,attribute:"interpolation-decay"})],Oe.prototype,"interpolationDecay",void 0),__decorate$6([n$6()],Oe.prototype,"a11y",void 0),Oe};/* @license
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PAN_SENSITIVITY=.018,TAP_DISTANCE=2,TAP_MS=300,vector2=new Vector2,vector3$2=new Vector3,DEFAULT_OPTIONS=Object.freeze({minimumRadius:0,maximumRadius:1/0,minimumPolarAngle:0,maximumPolarAngle:Math.PI,minimumAzimuthalAngle:-1/0,maximumAzimuthalAngle:1/0,minimumFieldOfView:10,maximumFieldOfView:45,touchAction:"none"}),KEYBOARD_ORBIT_INCREMENT=Math.PI/8,ZOOM_SENSITIVITY=.04,PAN_KEY_INCREMENT=10,ChangeSource={USER_INTERACTION:"user-interaction",NONE:"none",AUTOMATIC:"automatic"};class SmoothControls extends EventDispatcher{constructor(U,Y,ie){super(),this.camera=U,this.element=Y,this.scene=ie,this.orbitSensitivity=1,this.zoomSensitivity=1,this.panSensitivity=1,this.inputSensitivity=1,this.changeSource=ChangeSource.NONE,this._interactionEnabled=!1,this._disableZoom=!1,this.isUserPointing=!1,this.enablePan=!0,this.enableTap=!0,this.panProjection=new Matrix3,this.panPerPixel=0,this.spherical=new Spherical,this.goalSpherical=new Spherical,this.thetaDamper=new Damper,this.phiDamper=new Damper,this.radiusDamper=new Damper,this.logFov=Math.log(DEFAULT_OPTIONS.maximumFieldOfView),this.goalLogFov=this.logFov,this.fovDamper=new Damper,this.touchMode=null,this.pointers=[],this.startTime=0,this.startPointerPosition={clientX:0,clientY:0},this.lastSeparation=0,this.touchDecided=!1,this.onContext=ne=>{if(this.enablePan)ne.preventDefault();else for(const F of this.pointers)this.onPointerUp(new PointerEvent("pointercancel",Object.assign(Object.assign({},this.startPointerPosition),{pointerId:F.id})))},this.touchModeZoom=(ne,F)=>{if(!this._disableZoom){const fe=this.twoTouchDistance(this.pointers[0],this.pointers[1]),pe=ZOOM_SENSITIVITY*this.zoomSensitivity*(this.lastSeparation-fe)*50/this.scene.height;this.lastSeparation=fe,this.userAdjustOrbit(0,0,pe)}this.panPerPixel>0&&this.movePan(ne,F)},this.disableScroll=ne=>{ne.preventDefault()},this.touchModeRotate=(ne,F)=>{const{touchAction:fe}=this._options;if(!this.touchDecided&&fe!=="none"){this.touchDecided=!0;const pe=Math.abs(ne),Me=Math.abs(F);if(this.changeSource===ChangeSource.USER_INTERACTION&&(fe==="pan-y"&&Me>pe||fe==="pan-x"&&pe>Me)){this.touchMode=null;return}else this.element.addEventListener("touchmove",this.disableScroll,{passive:!1})}this.handleSinglePointerMove(ne,F)},this.onPointerDown=ne=>{if(this.pointers.length>2)return;const{element:F}=this;this.pointers.length===0&&(F.addEventListener("pointermove",this.onPointerMove),F.addEventListener("pointerup",this.onPointerUp),this.touchMode=null,this.touchDecided=!1,this.startPointerPosition.clientX=ne.clientX,this.startPointerPosition.clientY=ne.clientY,this.startTime=performance.now());try{F.setPointerCapture(ne.pointerId)}catch{}this.pointers.push({clientX:ne.clientX,clientY:ne.clientY,id:ne.pointerId}),this.isUserPointing=!1,ne.pointerType==="touch"?(this.changeSource=ne.altKey?ChangeSource.AUTOMATIC:ChangeSource.USER_INTERACTION,this.onTouchChange(ne)):(this.changeSource=ChangeSource.USER_INTERACTION,this.onMouseDown(ne)),this.changeSource===ChangeSource.USER_INTERACTION&&this.dispatchEvent({type:"user-interaction"})},this.onPointerMove=ne=>{const F=this.pointers.find(ve=>ve.id===ne.pointerId);if(F==null)return;if(ne.pointerType==="mouse"&&ne.buttons===0){this.onPointerUp(ne);return}const fe=this.pointers.length,pe=(ne.clientX-F.clientX)/fe,Me=(ne.clientY-F.clientY)/fe;pe===0&&Me===0||(F.clientX=ne.clientX,F.clientY=ne.clientY,ne.pointerType==="touch"?(this.changeSource=ne.altKey?ChangeSource.AUTOMATIC:ChangeSource.USER_INTERACTION,this.touchMode!==null&&this.touchMode(pe,Me)):(this.changeSource=ChangeSource.USER_INTERACTION,this.panPerPixel>0?this.movePan(pe,Me):this.handleSinglePointerMove(pe,Me)))},this.onPointerUp=ne=>{const{element:F}=this,fe=this.pointers.findIndex(pe=>pe.id===ne.pointerId);fe!==-1&&this.pointers.splice(fe,1),this.panPerPixel>0&&!ne.altKey&&this.resetRadius(),this.pointers.length===0?(F.removeEventListener("pointermove",this.onPointerMove),F.removeEventListener("pointerup",this.onPointerUp),F.removeEventListener("touchmove",this.disableScroll),this.enablePan&&this.enableTap&&this.recenter(ne)):this.touchMode!==null&&this.onTouchChange(ne),this.scene.element[$panElement].style.opacity=0,F.style.cursor="grab",this.panPerPixel=0,this.isUserPointing&&this.dispatchEvent({type:"pointer-change-end"})},this.onWheel=ne=>{this.changeSource=ChangeSource.USER_INTERACTION;const F=ne.deltaY*(ne.deltaMode==1?18:1)*ZOOM_SENSITIVITY*this.zoomSensitivity/30;this.userAdjustOrbit(0,0,F),ne.preventDefault(),this.dispatchEvent({type:"user-interaction"})},this.onKeyDown=ne=>{const{changeSource:F}=this;this.changeSource=ChangeSource.USER_INTERACTION,(ne.shiftKey&&this.enablePan?this.panKeyCodeHandler(ne):this.orbitZoomKeyCodeHandler(ne))?(ne.preventDefault(),this.dispatchEvent({type:"user-interaction"})):this.changeSource=F},this._options=Object.assign({},DEFAULT_OPTIONS),this.setOrbit(0,Math.PI/2,1),this.setFieldOfView(100),this.jumpToGoal()}get interactionEnabled(){return this._interactionEnabled}enableInteraction(){if(this._interactionEnabled===!1){const{element:U}=this;U.addEventListener("pointerdown",this.onPointerDown),U.addEventListener("pointercancel",this.onPointerUp),this._disableZoom||U.addEventListener("wheel",this.onWheel),U.addEventListener("keydown",this.onKeyDown),U.addEventListener("touchmove",()=>{},{passive:!1}),U.addEventListener("contextmenu",this.onContext),this.element.style.cursor="grab",this._interactionEnabled=!0,this.updateTouchActionStyle()}}disableInteraction(){if(this._interactionEnabled===!0){const{element:U}=this;U.removeEventListener("pointerdown",this.onPointerDown),U.removeEventListener("pointermove",this.onPointerMove),U.removeEventListener("pointerup",this.onPointerUp),U.removeEventListener("pointercancel",this.onPointerUp),U.removeEventListener("wheel",this.onWheel),U.removeEventListener("keydown",this.onKeyDown),U.removeEventListener("contextmenu",this.onContext),U.style.cursor="",this.touchMode=null,this._interactionEnabled=!1,this.updateTouchActionStyle()}}get options(){return this._options}set disableZoom(U){this._disableZoom!=U&&(this._disableZoom=U,U===!0?this.element.removeEventListener("wheel",this.onWheel):this.element.addEventListener("wheel",this.onWheel),this.updateTouchActionStyle())}getCameraSpherical(U=new Spherical){return U.copy(this.spherical)}getFieldOfView(){return this.camera.fov}applyOptions(U){Object.assign(this._options,U),this.setOrbit(),this.setFieldOfView(Math.exp(this.goalLogFov))}updateNearFar(U,Y){this.camera.far=Y===0?2:Y,this.camera.near=Math.max(U,this.camera.far/1e3),this.camera.updateProjectionMatrix()}updateAspect(U){this.camera.aspect=U,this.camera.updateProjectionMatrix()}setOrbit(U=this.goalSpherical.theta,Y=this.goalSpherical.phi,ie=this.goalSpherical.radius){const{minimumAzimuthalAngle:ne,maximumAzimuthalAngle:F,minimumPolarAngle:fe,maximumPolarAngle:pe,minimumRadius:Me,maximumRadius:ve}=this._options,{theta:se,phi:me,radius:Te}=this.goalSpherical,Re=clamp(U,ne,F);!isFinite(ne)&&!isFinite(F)&&(this.spherical.theta=this.wrapAngle(this.spherical.theta-Re)+Re);const be=clamp(Y,fe,pe),Pe=clamp(ie,Me,ve);return Re===se&&be===me&&Pe===Te||!isFinite(Re)||!isFinite(be)||!isFinite(Pe)?!1:(this.goalSpherical.theta=Re,this.goalSpherical.phi=be,this.goalSpherical.radius=Pe,this.goalSpherical.makeSafe(),!0)}setRadius(U){this.goalSpherical.radius=U,this.setOrbit()}setFieldOfView(U){const{minimumFieldOfView:Y,maximumFieldOfView:ie}=this._options;U=clamp(U,Y,ie),this.goalLogFov=Math.log(U)}setDamperDecayTime(U){this.thetaDamper.setDecayTime(U),this.phiDamper.setDecayTime(U),this.radiusDamper.setDecayTime(U),this.fovDamper.setDecayTime(U)}adjustOrbit(U,Y,ie){const{theta:ne,phi:F,radius:fe}=this.goalSpherical,{minimumRadius:pe,maximumRadius:Me,minimumFieldOfView:ve,maximumFieldOfView:se}=this._options,me=this.spherical.theta-ne,Te=Math.PI-.001,Re=ne-clamp(U,-Te-me,Te-me),be=F-Y,Pe=ie===0?0:((ie>0?Me:pe)-fe)/(Math.log(ie>0?se:ve)-this.goalLogFov),Le=fe+ie*(isFinite(Pe)?Pe:(Me-pe)*2);if(this.setOrbit(Re,be,Le),ie!==0){const xe=this.goalLogFov+ie;this.setFieldOfView(Math.exp(xe))}}jumpToGoal(){this.update(0,SETTLING_TIME)}update(U,Y){if(this.isStationary())return!1;const{maximumPolarAngle:ie,maximumRadius:ne}=this._options,F=this.spherical.theta-this.goalSpherical.theta;return Math.abs(F)>Math.PI&&!isFinite(this._options.minimumAzimuthalAngle)&&!isFinite(this._options.maximumAzimuthalAngle)&&(this.spherical.theta-=Math.sign(F)*2*Math.PI),this.spherical.theta=this.thetaDamper.update(this.spherical.theta,this.goalSpherical.theta,Y,Math.PI),this.spherical.phi=this.phiDamper.update(this.spherical.phi,this.goalSpherical.phi,Y,ie),this.spherical.radius=this.radiusDamper.update(this.spherical.radius,this.goalSpherical.radius,Y,ne),this.logFov=this.fovDamper.update(this.logFov,this.goalLogFov,Y,1),this.moveCamera(),!0}updateTouchActionStyle(){const{style:U}=this.element;if(this._interactionEnabled){const{touchAction:Y}=this._options;this._disableZoom&&Y!=="none"?U.touchAction="manipulation":U.touchAction=Y}else U.touchAction=""}isStationary(){return this.goalSpherical.theta===this.spherical.theta&&this.goalSpherical.phi===this.spherical.phi&&this.goalSpherical.radius===this.spherical.radius&&this.goalLogFov===this.logFov}moveCamera(){this.spherical.makeSafe(),this.camera.position.setFromSpherical(this.spherical),this.camera.setRotationFromEuler(new Euler(this.spherical.phi-Math.PI/2,this.spherical.theta,0,"YXZ")),this.camera.fov!==Math.exp(this.logFov)&&(this.camera.fov=Math.exp(this.logFov),this.camera.updateProjectionMatrix())}userAdjustOrbit(U,Y,ie){this.adjustOrbit(U*this.orbitSensitivity*this.inputSensitivity,Y*this.orbitSensitivity*this.inputSensitivity,ie*this.inputSensitivity)}wrapAngle(U){const Y=(U+Math.PI)/(2*Math.PI);return(Y-Math.floor(Y))*2*Math.PI-Math.PI}pixelLengthToSphericalAngle(U){return 2*Math.PI*U/this.scene.height}twoTouchDistance(U,Y){const{clientX:ie,clientY:ne}=U,{clientX:F,clientY:fe}=Y,pe=F-ie,Me=fe-ne;return Math.sqrt(pe*pe+Me*Me)}handleSinglePointerMove(U,Y){const ie=this.pixelLengthToSphericalAngle(U),ne=this.pixelLengthToSphericalAngle(Y);this.isUserPointing===!1&&(this.isUserPointing=!0,this.dispatchEvent({type:"pointer-change-start"})),this.userAdjustOrbit(ie,ne,0)}initializePan(){const{theta:U,phi:Y}=this.spherical,ie=U-this.scene.yaw;this.panPerPixel=PAN_SENSITIVITY*this.panSensitivity/this.scene.height,this.panProjection.set(-Math.cos(ie),-Math.cos(Y)*Math.sin(ie),0,0,Math.sin(Y),0,Math.sin(ie),-Math.cos(Y)*Math.cos(ie),0)}movePan(U,Y){const{scene:ie}=this,ne=vector3$2.set(U,Y,0).multiplyScalar(this.inputSensitivity),F=this.spherical.radius*Math.exp(this.logFov)*this.panPerPixel;ne.multiplyScalar(F);const fe=ie.getTarget();fe.add(ne.applyMatrix3(this.panProjection)),ie.boundingSphere.clampPoint(fe,fe),ie.setTarget(fe.x,fe.y,fe.z)}recenter(U){if(performance.now()>this.startTime+TAP_MS||Math.abs(U.clientX-this.startPointerPosition.clientX)>TAP_DISTANCE||Math.abs(U.clientY-this.startPointerPosition.clientY)>TAP_DISTANCE)return;const{scene:Y}=this,ie=Y.positionAndNormalFromPoint(Y.getNDC(U.clientX,U.clientY));if(ie==null){const{cameraTarget:ne}=Y.element;Y.element.cameraTarget="",Y.element.cameraTarget=ne,this.userAdjustOrbit(0,0,1)}else Y.target.worldToLocal(ie.position),Y.setTarget(ie.position.x,ie.position.y,ie.position.z)}resetRadius(){const{scene:U}=this,Y=U.positionAndNormalFromPoint(vector2.set(0,0));if(Y==null)return;U.target.worldToLocal(Y.position);const ie=U.getTarget(),{theta:ne,phi:F}=this.spherical,fe=ne-U.yaw,pe=vector3$2.set(Math.sin(F)*Math.sin(fe),Math.cos(F),Math.sin(F)*Math.cos(fe)),Me=pe.dot(Y.position.sub(ie));ie.add(pe.multiplyScalar(Me)),U.setTarget(ie.x,ie.y,ie.z),this.setOrbit(void 0,void 0,this.goalSpherical.radius-Me)}onTouchChange(U){if(this.pointers.length===1)this.touchMode=this.touchModeRotate;else{if(this._disableZoom){this.touchMode=null,this.element.removeEventListener("touchmove",this.disableScroll);return}this.touchMode=this.touchDecided&&this.touchMode===null?null:this.touchModeZoom,this.touchDecided=!0,this.element.addEventListener("touchmove",this.disableScroll,{passive:!1}),this.lastSeparation=this.twoTouchDistance(this.pointers[0],this.pointers[1]),this.enablePan&&this.touchMode!=null&&(this.initializePan(),U.altKey||(this.scene.element[$panElement].style.opacity=1))}}onMouseDown(U){this.panPerPixel=0,this.enablePan&&(U.button===2||U.ctrlKey||U.metaKey||U.shiftKey)&&(this.initializePan(),this.scene.element[$panElement].style.opacity=1),this.element.style.cursor="grabbing"}orbitZoomKeyCodeHandler(U){let Y=!0;switch(U.key){case"PageUp":this.userAdjustOrbit(0,0,ZOOM_SENSITIVITY*this.zoomSensitivity);break;case"PageDown":this.userAdjustOrbit(0,0,-1*ZOOM_SENSITIVITY*this.zoomSensitivity);break;case"ArrowUp":this.userAdjustOrbit(0,-KEYBOARD_ORBIT_INCREMENT,0);break;case"ArrowDown":this.userAdjustOrbit(0,KEYBOARD_ORBIT_INCREMENT,0);break;case"ArrowLeft":this.userAdjustOrbit(-KEYBOARD_ORBIT_INCREMENT,0,0);break;case"ArrowRight":this.userAdjustOrbit(KEYBOARD_ORBIT_INCREMENT,0,0);break;default:Y=!1;break}return Y}panKeyCodeHandler(U){this.initializePan();let Y=!0;switch(U.key){case"ArrowUp":this.movePan(0,-1*PAN_KEY_INCREMENT);break;case"ArrowDown":this.movePan(0,PAN_KEY_INCREMENT);break;case"ArrowLeft":this.movePan(-1*PAN_KEY_INCREMENT,0);break;case"ArrowRight":this.movePan(PAN_KEY_INCREMENT,0);break;default:Y=!1;break}return Y}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const INIT_FRAMES=30,AR_SHADOW_INTENSITY=.8,ROTATION_RATE=1.5,HIT_ANGLE_DEG=20,SCALE_SNAP=.2,MIN_VIEWPORT_SCALE=.25,MAX_DISTANCE=10,DECAY=150,MAX_LINE_LENGTH=5,BOX_SIZE=.1,ARStatus={NOT_PRESENTING:"not-presenting",SESSION_STARTED:"session-started",OBJECT_PLACED:"object-placed",FAILED:"failed"},ARTracking={TRACKING:"tracking",NOT_TRACKING:"not-tracking"},vector3$1=new Vector3,quaternion=new Quaternion,matrix4=new Matrix4,hitPosition=new Vector3,camera=new PerspectiveCamera(45,1,.1,100),lineGeometry=new BufferGeometry().setFromPoints([new Vector3(0,0,0),new Vector3(0,0,-1)]),boxGeometry=new BoxGeometry;class ARRenderer extends EventDispatcher{constructor(U){super(),this.renderer=U,this.currentSession=null,this.placeOnWall=!1,this.placementBox=null,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.initialHitSource=null,this.transientHitTestSource=null,this.inputSource=null,this._presentedScene=null,this.resolveCleanup=null,this.exitWebXRButtonContainer=null,this.overlay=null,this.xrLight=null,this.xrMode=null,this.controller1=null,this.controller2=null,this.selectedController=null,this.tracking=!0,this.frames=0,this.initialized=!1,this.oldTarget=new Vector3,this.placementComplete=!1,this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastDragPosition=new Vector3,this.relativeOrientation=new Quaternion,this.scaleLine=new Line(lineGeometry),this.firstRatio=0,this.lastAngle=0,this.goalPosition=new Vector3,this.goalYaw=0,this.goalScale=1,this.xDamper=new Damper,this.yDamper=new Damper,this.zDamper=new Damper,this.yawDamper=new Damper,this.pitchDamper=new Damper,this.rollDamper=new Damper,this.scaleDamper=new Damper,this.onExitWebXRButtonContainerClick=()=>this.stopPresenting(),this.onControllerSelectStart=Y=>{const ie=this.presentedScene,ne=Y.target;if(this.placementBox.controllerIntersection(ie,ne)!=null)this.selectedController!=null&&(this.selectedController.userData.line.visible=!1,ie.canScale&&(this.isTwoFingering=!0,this.firstRatio=this.controllerSeparation()/ie.pivot.scale.x,this.scaleLine.visible=!0)),ne.attach(ie.pivot),this.selectedController=ne,ie.setShadowIntensity(.01);else{const F=ne===this.controller1?this.controller2:this.controller1;this.relativeOrientation.copy(ne.quaternion).invert().multiply(ie.pivot.getWorldQuaternion(quaternion)),F.userData.turning=!1,ne.userData.turning=!0,ne.userData.line.visible=!1}},this.onControllerSelectEnd=Y=>{const ie=Y.target;if(ie.userData.turning=!1,ie.userData.line.visible=!0,this.isTwoFingering=!1,this.scaleLine.visible=!1,this.selectedController!=null&&this.selectedController!=ie)return;const ne=this.presentedScene;ne.attach(ne.pivot),this.selectedController=null,this.goalYaw=Math.atan2(ne.pivot.matrix.elements[8],ne.pivot.matrix.elements[10]),this.goalPosition.x=ne.pivot.position.x,this.goalPosition.z=ne.pivot.position.z},this.onUpdateScene=()=>{this.placementBox!=null&&this.isPresenting&&(this.placementBox.dispose(),this.placementBox=new PlacementBox(this.presentedScene,this.placeOnWall?"back":"bottom"))},this.onSelectStart=Y=>{const ie=this.transientHitTestSource;if(ie==null)return;const ne=this.frame.getHitTestResultsForTransientInput(ie),F=this.presentedScene,fe=this.placementBox;if(ne.length===1){this.inputSource=Y.inputSource;const{axes:pe}=this.inputSource.gamepad,Me=fe.getHit(this.presentedScene,pe[0],pe[1]);fe.show=!0,Me!=null?(this.isTranslating=!0,this.lastDragPosition.copy(Me)):this.placeOnWall===!1&&(this.isRotating=!0,this.lastAngle=pe[0]*ROTATION_RATE)}else if(ne.length===2){fe.show=!0,this.isTwoFingering=!0;const{separation:pe}=this.fingerPolar(ne);this.firstRatio=pe/F.pivot.scale.x}},this.onSelectEnd=()=>{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.inputSource=null,this.goalPosition.y+=this.placementBox.offsetHeight*this.presentedScene.scale.x,this.placementBox.show=!1},this.threeRenderer=U.threeRenderer,this.threeRenderer.xr.enabled=!0}async resolveARSession(){assertIsArCandidate();const U=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test"],optionalFeatures:["dom-overlay","light-estimation"],domOverlay:this.overlay?{root:this.overlay}:void 0});return this.threeRenderer.xr.setReferenceSpaceType("local"),await this.threeRenderer.xr.setSession(U),this.threeRenderer.xr.cameraAutoUpdate=!1,U}get presentedScene(){return this._presentedScene}async supportsPresentation(){try{return assertIsArCandidate(),await navigator.xr.isSessionSupported("immersive-ar")}catch(U){return console.warn("Request to present in WebXR denied:"),console.warn(U),console.warn("Falling back to next ar-mode"),!1}}async present(U,Y=!1){this.isPresenting&&console.warn("Cannot present while a model is already presenting");let ie=new Promise((ve,se)=>{requestAnimationFrame(()=>ve())});U.setHotspotsVisibility(!1),U.queueRender(),await ie,this._presentedScene=U,this.overlay=U.element.shadowRoot.querySelector("div.default"),Y===!0&&(this.xrLight=new XREstimatedLight(this.threeRenderer),this.xrLight.addEventListener("estimationstart",()=>{if(!this.isPresenting||this.xrLight==null)return;const ve=this.presentedScene;ve.add(this.xrLight),ve.environment=this.xrLight.environment}));const ne=await this.resolveARSession();ne.addEventListener("end",()=>{this.postSessionCleanup()},{once:!0});const F=U.element.shadowRoot.querySelector(".slot.exit-webxr-ar-button");F.classList.add("enabled"),F.addEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=F;const fe=await ne.requestReferenceSpace("viewer");this.xrMode=ne.interactionMode,this.tracking=!0,this.frames=0,this.initialized=!1,this.turntableRotation=U.yaw,this.goalYaw=U.yaw,this.goalScale=1,U.setBackground(null),this.oldShadowIntensity=U.shadowIntensity,U.setShadowIntensity(.01),this.oldTarget.copy(U.getTarget()),U.element.addEventListener("load",this.onUpdateScene);const pe=HIT_ANGLE_DEG*Math.PI/180,Me=this.placeOnWall===!0?void 0:new XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(pe),z:-Math.cos(pe)});ne.requestHitTestSource({space:fe,offsetRay:Me}).then(ve=>{this.initialHitSource=ve}),this.xrMode!=="screen-space"&&(this.setupControllers(),this.xDamper.setDecayTime(DECAY),this.yDamper.setDecayTime(DECAY),this.zDamper.setDecayTime(DECAY),this.yawDamper.setDecayTime(DECAY),this.pitchDamper.setDecayTime(DECAY),this.rollDamper.setDecayTime(DECAY)),this.currentSession=ne,this.placementBox=new PlacementBox(U,this.placeOnWall?"back":"bottom"),this.placementComplete=!1,this.lastTick=performance.now(),this.dispatchEvent({type:"status",status:ARStatus.SESSION_STARTED})}setupControllers(){this.controller1=this.threeRenderer.xr.getController(0),this.controller1.addEventListener("selectstart",this.onControllerSelectStart),this.controller1.addEventListener("selectend",this.onControllerSelectEnd),this.controller2=this.threeRenderer.xr.getController(1),this.controller2.addEventListener("selectstart",this.onControllerSelectStart),this.controller2.addEventListener("selectend",this.onControllerSelectEnd);const U=this.presentedScene;if(U.add(this.controller1),U.add(this.controller2),!this.controller1.userData.line){const Y=new Line(lineGeometry);Y.name="line",Y.scale.z=MAX_LINE_LENGTH,this.controller1.userData.turning=!1,this.controller1.userData.line=Y,this.controller1.add(Y),this.controller2.userData.turning=!1;const ie=Y.clone();this.controller2.userData.line=ie,this.controller2.add(ie),this.scaleLine.name="scale line",this.scaleLine.visible=!1,this.controller1.add(this.scaleLine);const{size:ne}=U,F=BOX_SIZE/Math.max(ne.x,ne.y,ne.z),fe=new Mesh(boxGeometry);fe.name="box",fe.scale.copy(ne).multiplyScalar(F),fe.visible=!1,this.controller1.userData.box=fe,U.add(fe);const pe=fe.clone();this.controller2.userData.box=pe,U.add(pe)}}hover(U){if(this.xrMode==="screen-space"||this.selectedController==U)return!1;const Y=this.presentedScene,ie=this.placementBox.controllerIntersection(Y,U);return U.userData.box.visible=(ie==null||U.userData.turning)&&!this.isTwoFingering,U.userData.line.scale.z=ie==null?MAX_LINE_LENGTH:ie.distance,ie!=null}controllerSeparation(){return this.controller1.position.distanceTo(this.controller2.position)}async stopPresenting(){if(!this.isPresenting)return;const U=new Promise(Y=>{this.resolveCleanup=Y});try{await this.currentSession.end(),await U}catch(Y){console.warn("Error while trying to end WebXR AR session"),console.warn(Y),this.postSessionCleanup()}}get isPresenting(){return this.presentedScene!=null}get target(){return this.oldTarget}updateTarget(){const U=this.presentedScene;if(U!=null){const Y=U.getTarget();this.oldTarget.copy(Y),this.placeOnWall?Y.z=U.boundingBox.min.z:Y.y=U.boundingBox.min.y,U.setTarget(Y.x,Y.y,Y.z)}}postSessionCleanup(){const U=this.currentSession;U!=null&&(U.removeEventListener("selectstart",this.onSelectStart),U.removeEventListener("selectend",this.onSelectEnd),this.currentSession=null);const Y=this.presentedScene;if(this._presentedScene=null,Y!=null){const{element:fe}=Y;this.xrLight!=null&&(Y.remove(this.xrLight),this.xrLight.dispose(),this.xrLight=null),Y.add(Y.pivot),Y.pivot.quaternion.set(0,0,0,1),Y.pivot.position.set(0,0,0),Y.pivot.scale.set(1,1,1),Y.setShadowOffset(0);const pe=this.turntableRotation;pe!=null&&(Y.yaw=pe);const Me=this.oldShadowIntensity;Me!=null&&Y.setShadowIntensity(Me),Y.setEnvironmentAndSkybox(fe[$currentEnvironmentMap],fe[$currentBackground]);const ve=this.oldTarget;Y.setTarget(ve.x,ve.y,ve.z),Y.xrCamera=null,Y.element.removeEventListener("load",this.onUpdateScene),Y.orientHotspots(0);const{width:se,height:me}=fe.getBoundingClientRect();Y.setSize(se,me),requestAnimationFrame(()=>{Y.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:ChangeSource.NONE}}))})}this.renderer.height=0;const ie=this.exitWebXRButtonContainer;ie!=null&&(ie.classList.remove("enabled"),ie.removeEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=null);const ne=this.transientHitTestSource;ne!=null&&(ne.cancel(),this.transientHitTestSource=null);const F=this.initialHitSource;F!=null&&(F.cancel(),this.initialHitSource=null),this.placementBox!=null&&(this.placementBox.dispose(),this.placementBox=null),this.xrMode!=="screen-space"&&(this.controller1!=null&&(this.controller1.userData.turning=!1,this.controller1.userData.box.visible=!1,this.controller1.userData.line.visible=!0,this.controller1.removeEventListener("selectstart",this.onControllerSelectStart),this.controller1.removeEventListener("selectend",this.onControllerSelectEnd),this.controller1.removeFromParent(),this.controller1=null),this.controller2!=null&&(this.controller2.userData.turning=!1,this.controller2.userData.box.visible=!1,this.controller2.userData.line.visible=!0,this.controller2.removeEventListener("selectstart",this.onControllerSelectStart),this.controller2.removeEventListener("selectend",this.onControllerSelectEnd),this.controller2.removeFromParent(),this.controller2=null),this.selectedController=null,this.scaleLine.visible=!1),this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.inputSource=null,this.overlay=null,this.resolveCleanup!=null&&this.resolveCleanup(),this.dispatchEvent({type:"status",status:ARStatus.NOT_PRESENTING})}updateView(U){const Y=this.presentedScene,ie=this.threeRenderer.xr;ie.updateCamera(camera),Y.xrCamera=ie.getCamera();const{elements:ne}=Y.getCamera().matrixWorld;if(Y.orientHotspots(Math.atan2(ne[1],ne[5])),this.initialized||(this.placeInitially(),this.initialized=!0),U.requestViewportScale&&U.recommendedViewportScale){const fe=U.recommendedViewportScale;U.requestViewportScale(Math.max(fe,MIN_VIEWPORT_SCALE))}const F=ie.getBaseLayer();if(F!=null){const fe=F instanceof XRWebGLLayer?F.getViewport(U):ie.getBinding().getViewSubImage(F,U).viewport;this.threeRenderer.setViewport(fe.x,fe.y,fe.width,fe.height)}}placeInitially(){const U=this.presentedScene,{pivot:Y,element:ie}=U,{position:ne}=Y,F=U.getCamera(),{width:fe,height:pe}=this.overlay.getBoundingClientRect();U.setSize(fe,pe),F.projectionMatrixInverse.copy(F.projectionMatrix).invert();const{theta:Me}=ie.getCameraOrbit(),ve=F.getWorldDirection(vector3$1);U.yaw=Math.atan2(-ve.x,-ve.z)-Me,this.goalYaw=U.yaw;const se=Math.max(1,2*U.boundingSphere.radius);ne.copy(F.position).add(ve.multiplyScalar(se)),this.updateTarget();const me=U.getTarget();if(ne.add(me).sub(this.oldTarget),this.goalPosition.copy(ne),U.setHotspotsVisibility(!0),this.xrMode==="screen-space"){const{session:Te}=this.frame;Te.addEventListener("selectstart",this.onSelectStart),Te.addEventListener("selectend",this.onSelectEnd),Te.requestHitTestSourceForTransientInput({profile:"generic-touchscreen"}).then(Re=>{this.transientHitTestSource=Re})}}getTouchLocation(){const{axes:U}=this.inputSource.gamepad;let Y=this.placementBox.getExpandedHit(this.presentedScene,U[0],U[1]);return Y!=null&&(vector3$1.copy(Y).sub(this.presentedScene.getCamera().position),vector3$1.length()>MAX_DISTANCE)?null:Y}getHitPoint(U){const Y=this.threeRenderer.xr.getReferenceSpace(),ie=U.getPose(Y);if(ie==null)return null;const ne=matrix4.fromArray(ie.transform.matrix);return this.placeOnWall===!0&&(this.goalYaw=Math.atan2(ne.elements[4],ne.elements[6])),ne.elements[5]>.75!==this.placeOnWall?hitPosition.setFromMatrixPosition(ne):null}moveToFloor(U){const Y=this.initialHitSource;if(Y==null)return;const ie=U.getHitTestResults(Y);if(ie.length==0)return;const ne=ie[0],F=this.getHitPoint(ne);F!=null&&(this.placementBox.show=!0,this.isTranslating||(this.placeOnWall?this.goalPosition.copy(F):this.goalPosition.y=F.y),Y.cancel(),this.initialHitSource=null,this.dispatchEvent({type:"status",status:ARStatus.OBJECT_PLACED}))}fingerPolar(U){const Y=U[0].inputSource.gamepad.axes,ie=U[1].inputSource.gamepad.axes,ne=ie[0]-Y[0],F=ie[1]-Y[1],fe=Math.atan2(F,ne);let pe=this.lastAngle-fe;return pe>Math.PI?pe-=2*Math.PI:pe<-Math.PI&&(pe+=2*Math.PI),this.lastAngle=fe,{separation:Math.sqrt(ne*ne+F*F),deltaYaw:pe}}setScale(U){const Y=U/this.firstRatio;this.goalScale=Math.abs(Y-1)<SCALE_SNAP?1:Y}processInput(U){const Y=this.transientHitTestSource;if(Y==null||!this.isTranslating&&!this.isTwoFingering&&!this.isRotating)return;const ie=U.getHitTestResultsForTransientInput(Y),ne=this.presentedScene,F=ne.pivot.scale.x;if(this.isTwoFingering){if(ie.length<2)this.isTwoFingering=!1;else{const{separation:fe,deltaYaw:pe}=this.fingerPolar(ie);this.placeOnWall===!1&&(this.goalYaw+=pe),ne.canScale&&this.setScale(fe)}return}else if(ie.length===2){this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!0;const{separation:fe}=this.fingerPolar(ie);this.firstRatio=fe/F;return}if(this.isRotating){const fe=this.inputSource.gamepad.axes[0]*ROTATION_RATE;this.goalYaw+=fe-this.lastAngle,this.lastAngle=fe}else this.isTranslating&&ie.forEach(fe=>{if(fe.inputSource!==this.inputSource)return;let pe=null;if(fe.results.length>0&&(pe=this.getHitPoint(fe.results[0])),pe==null&&(pe=this.getTouchLocation()),pe!=null){if(this.goalPosition.sub(this.lastDragPosition),this.placeOnWall===!1){const Me=pe.y-this.lastDragPosition.y;if(Me<0){this.placementBox.offsetHeight=Me/F,this.presentedScene.setShadowOffset(Me);const ve=vector3$1.copy(ne.getCamera().position),se=-Me/(ve.y-pe.y);ve.multiplyScalar(se),pe.multiplyScalar(1-se).add(ve)}}this.goalPosition.add(pe),this.lastDragPosition.copy(pe)}})}moveScene(U){const Y=this.presentedScene,{pivot:ie}=Y,ne=this.placementBox;if(ne.updateOpacity(U),this.controller1&&(this.controller1.userData.turning&&(ie.quaternion.copy(this.controller1.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller2&&ie.quaternion.premultiply(quaternion.copy(this.controller2.quaternion).invert())),this.controller1.userData.box.position.copy(this.controller1.position),ie.getWorldQuaternion(this.controller1.userData.box.quaternion)),this.controller2&&(this.controller2.userData.turning&&(ie.quaternion.copy(this.controller2.quaternion).multiply(this.relativeOrientation),this.selectedController&&this.selectedController===this.controller1&&ie.quaternion.premultiply(quaternion.copy(this.controller1.quaternion).invert())),this.controller2.userData.box.position.copy(this.controller2.position),ie.getWorldQuaternion(this.controller2.userData.box.quaternion)),this.controller1&&this.controller2&&this.isTwoFingering){const Te=this.controllerSeparation();this.setScale(Te),this.scaleLine.scale.z=-Te,this.scaleLine.lookAt(this.controller2.position)}const F=Y.pivot.scale.x;if(this.goalScale!==F){const Te=this.scaleDamper.update(F,this.goalScale,U,1);Y.pivot.scale.set(Te,Te,Te)}if(ie.parent!==Y)return;const{position:fe}=ie,pe=Y.boundingSphere.radius,Me=this.goalPosition;let ve=ChangeSource.NONE;if(!Me.equals(fe)){ve=ChangeSource.USER_INTERACTION;let{x:Te,y:Re,z:be}=fe;if(Te=this.xDamper.update(Te,Me.x,U,pe),Re=this.yDamper.update(Re,Me.y,U,pe),be=this.zDamper.update(be,Me.z,U,pe),fe.set(Te,Re,be),this.xrMode==="screen-space"&&!this.isTranslating){const Pe=Me.y-Re;this.placementComplete&&this.placeOnWall===!1?(ne.offsetHeight=Pe/Y.pivot.scale.x,Y.setShadowOffset(Pe)):Pe===0&&(this.placementComplete=!0,ne.show=!1,Y.setShadowIntensity(AR_SHADOW_INTENSITY))}this.xrMode!=="screen-space"&&Me.equals(fe)&&Y.setShadowIntensity(AR_SHADOW_INTENSITY)}Y.updateTarget(U),quaternion.setFromAxisAngle(vector3$1.set(0,1,0),this.goalYaw);const se=Y.pivot.quaternion.angleTo(quaternion),me=se-this.yawDamper.update(se,0,U,Math.PI);Y.pivot.quaternion.rotateTowards(quaternion,me),Y.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:ve}}))}onWebXRFrame(U,Y){if(this.xrMode!=="screen-space"){const pe=this.hover(this.controller1),Me=this.hover(this.controller2);this.placementBox.show=(pe||Me)&&!this.isTwoFingering}this.frame=Y,++this.frames;const ie=this.threeRenderer.xr.getReferenceSpace(),ne=Y.getViewerPose(ie);ne==null&&this.tracking===!0&&this.frames>INIT_FRAMES&&(this.tracking=!1,this.dispatchEvent({type:"tracking",status:ARTracking.NOT_TRACKING}));const F=this.presentedScene;if(ne==null||F==null||!F.element.loaded){this.threeRenderer.clear();return}this.tracking===!1&&(this.tracking=!0,this.dispatchEvent({type:"tracking",status:ARTracking.TRACKING}));let fe=!0;for(const pe of ne.views){if(this.updateView(pe),fe){this.moveToFloor(Y),this.processInput(Y);const Me=U-this.lastTick;this.moveScene(Me),this.renderer.preRender(F,U,Me),this.lastTick=U,F.renderShadow(this.threeRenderer)}this.threeRenderer.render(F,F.getCamera()),fe=!1}}}function clone(re){const U=new Map,Y=new Map,ie=re.clone();return parallelTraverse(re,ie,function(ne,F){U.set(F,ne),Y.set(ne,F)}),ie.traverse(function(ne){if(!ne.isSkinnedMesh)return;const F=ne,fe=U.get(ne),pe=fe.skeleton.bones;F.skeleton=fe.skeleton.clone(),F.bindMatrix.copy(fe.bindMatrix),F.skeleton.bones=pe.map(function(Me){return Y.get(Me)}),F.bind(F.skeleton,F.bindMatrix)}),ie}function parallelTraverse(re,U,Y){Y(re,U);for(let ie=0;ie<re.children.length;ie++)parallelTraverse(re.children[ie],U.children[ie],Y)}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $prepared=Symbol("prepared"),$prepare=Symbol("prepare"),$preparedGLTF=Symbol("preparedGLTF"),$clone=Symbol("clone");class GLTFInstance{constructor(U){this[$preparedGLTF]=U}static prepare(U){if(U.scene==null)throw new Error("Model does not have a scene");if(U[$prepared])return U;const Y=this[$prepare](U);return Y[$prepared]=!0,Y}static[$prepare](U){const{scene:Y}=U,ie=[Y];return Object.assign(Object.assign({},U),{scene:Y,scenes:ie})}get parser(){return this[$preparedGLTF].parser}get animations(){return this[$preparedGLTF].animations}get scene(){return this[$preparedGLTF].scene}get scenes(){return this[$preparedGLTF].scenes}get cameras(){return this[$preparedGLTF].cameras}get asset(){return this[$preparedGLTF].asset}get userData(){return this[$preparedGLTF].userData}clone(){const U=this.constructor,Y=this[$clone]();return new U(Y)}dispose(){this.scenes.forEach(U=>{U.traverse(Y=>{const ie=Y;if(!ie.material)return;(Array.isArray(ie.material)?ie.material:[ie.material]).forEach(F=>{for(const fe in F){const pe=F[fe];if(pe instanceof Texture$1){const Me=pe.source.data;Me.close!=null&&Me.close(),pe.dispose()}}F.dispose()}),ie.geometry.dispose()})})}[$clone](){const U=this[$preparedGLTF],Y=clone(this.scene);cloneVariantMaterials(Y,this.scene);const ie=[Y],ne=U.userData?Object.assign({},U.userData):{};return Object.assign(Object.assign({},U),{scene:Y,scenes:ie,userData:ne})}}const cloneVariantMaterials=(re,U)=>{traversePair(re,U,(Y,ie)=>{ie.userData.variantMaterials!==void 0&&(Y.userData.variantMaterials=new Map(ie.userData.variantMaterials)),ie.userData.variantData!==void 0&&(Y.userData.variantData=ie.userData.variantData),ie.userData.originalMaterial!==void 0&&(Y.userData.originalMaterial=ie.userData.originalMaterial)})},traversePair=(re,U,Y)=>{Y(re,U);for(let ie=0;ie<re.children.length;ie++)traversePair(re.children[ie],U.children[ie],Y)},$threeGLTF=Symbol("threeGLTF"),$gltf=Symbol("gltf"),$gltfElementMap=Symbol("gltfElementMap"),$threeObjectMap=Symbol("threeObjectMap"),$parallelTraverseThreeScene=Symbol("parallelTraverseThreeScene"),$correlateOriginalThreeGLTF=Symbol("correlateOriginalThreeGLTF"),$correlateCloneThreeGLTF=Symbol("correlateCloneThreeGLTF");class CorrelatedSceneGraph{constructor(U,Y,ie,ne){this[$threeGLTF]=U,this[$gltf]=Y,this[$gltfElementMap]=ne,this[$threeObjectMap]=ie}static from(U,Y){return Y!=null?this[$correlateCloneThreeGLTF](U,Y):this[$correlateOriginalThreeGLTF](U)}static[$correlateOriginalThreeGLTF](U){const Y=U.parser.json,ie=U.parser.associations,ne=new Map,F={name:"Default"},fe={type:"materials",index:-1};for(const pe of ie.keys())pe instanceof Material$1&&ie.get(pe)==null&&(fe.index<0&&(Y.materials==null&&(Y.materials=[]),fe.index=Y.materials.length,Y.materials.push(F)),pe.name=F.name,ie.set(pe,{materials:fe.index}));for(const[pe,Me]of ie){Me&&(pe.userData=pe.userData||{},pe.userData.associations=Me);for(const ve in Me)if(ve!=null&&ve!=="primitives"){const se=ve,Te=(Y[se]||[])[Me[se]];if(Te==null)continue;let Re=ne.get(Te);Re==null&&(Re=new Set,ne.set(Te,Re)),Re.add(pe)}}return new CorrelatedSceneGraph(U,Y,ie,ne)}static[$correlateCloneThreeGLTF](U,Y){const ie=Y.threeGLTF,ne=Y.gltf,F=JSON.parse(JSON.stringify(ne)),fe=new Map,pe=new Map;for(let Me=0;Me<ie.scenes.length;Me++)this[$parallelTraverseThreeScene](ie.scenes[Me],U.scenes[Me],(ve,se)=>{const me=Y.threeObjectMap.get(ve);if(me!=null){for(const Te in me)if(Te!=null&&Te!=="primitives"){const Re=Te,be=me[Re],Pe=F[Re][be],Le=fe.get(se)||{};Le[Re]=be,fe.set(se,Le);const xe=pe.get(Pe)||new Set;xe.add(se),pe.set(Pe,xe)}}});return new CorrelatedSceneGraph(U,F,fe,pe)}static[$parallelTraverseThreeScene](U,Y,ie){const ne=(F,fe)=>{if(ie(F,fe),F.isObject3D){const pe=F,Me=fe;if(pe.material)if(Array.isArray(pe.material))for(let ve=0;ve<pe.material.length;++ve)ie(pe.material[ve],Me.material[ve]);else ie(pe.material,Me.material);for(let ve=0;ve<F.children.length;++ve)ne(F.children[ve],fe.children[ve])}};ne(U,Y)}get threeGLTF(){return this[$threeGLTF]}get gltf(){return this[$gltf]}get gltfElementMap(){return this[$gltfElementMap]}get threeObjectMap(){return this[$threeObjectMap]}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $correlatedSceneGraph=Symbol("correlatedSceneGraph");class ModelViewerGLTFInstance extends GLTFInstance{static[$prepare](U){const Y=super[$prepare](U);Y[$correlatedSceneGraph]==null&&(Y[$correlatedSceneGraph]=CorrelatedSceneGraph.from(Y));const{scene:ie}=Y,ne=new Sphere(void 0,1/0);return ie.traverse(F=>{F.renderOrder=1e3,F.frustumCulled=!1,F.name||(F.name=F.uuid);const fe=F;if(fe.material){const{geometry:pe}=fe;fe.castShadow=!0,fe.isSkinnedMesh&&(pe.boundingSphere=ne,pe.boundingBox=null);const Me=fe.material;if(Me.isMeshBasicMaterial===!0&&(Me.toneMapped=!1),Me.shadowSide=FrontSide,Me.aoMap){const{gltf:ve,threeObjectMap:se}=Y[$correlatedSceneGraph],me=se.get(Me);if(ve.materials!=null&&me!=null&&me.materials!=null){const Te=ve.materials[me.materials];Te.occlusionTexture&&Te.occlusionTexture.texCoord===0&&pe.attributes.uv!=null&&pe.setAttribute("uv2",pe.attributes.uv)}}}}),Y}get correlatedSceneGraph(){return this[$preparedGLTF][$correlatedSceneGraph]}[$clone](){const U=super[$clone](),Y=new Map;return U.scene.traverse(ie=>{const ne=ie;if(ne.material){const fe=ne.material;if(fe!=null){if(Y.has(fe.uuid)){ne.material=Y.get(fe.uuid);return}ne.material=fe.clone(),Y.set(fe.uuid,ne.material)}}const F=ie;F.target!==void 0&&F.add(F.target)}),U[$correlatedSceneGraph]=CorrelatedSceneGraph.from(U,this.correlatedSceneGraph),U}}const getBufferForType=(re,U,Y)=>{let ie;switch(re){case UnsignedByteType:ie=new Uint8ClampedArray(U*Y*4);break;case HalfFloatType:ie=new Uint16Array(U*Y*4);break;case UnsignedIntType:ie=new Uint32Array(U*Y*4);break;case ByteType:ie=new Int8Array(U*Y*4);break;case ShortType:ie=new Int16Array(U*Y*4);break;case IntType:ie=new Int32Array(U*Y*4);break;case FloatType:ie=new Float32Array(U*Y*4);break;default:throw new Error("Unsupported data type")}return ie};let _canReadPixelsResult;const canReadPixels=(re,U,Y,ie)=>{if(_canReadPixelsResult!==void 0)return _canReadPixelsResult;const ne=new WebGLRenderTarget(1,1,ie);U.setRenderTarget(ne);const F=new Mesh(new PlaneGeometry,new MeshBasicMaterial({color:16777215}));U.render(F,Y),U.setRenderTarget(null);const fe=getBufferForType(re,ne.width,ne.height);return U.readRenderTargetPixels(ne,0,0,ne.width,ne.height,fe),ne.dispose(),F.geometry.dispose(),F.material.dispose(),_canReadPixelsResult=fe[0]!==0,_canReadPixelsResult};class QuadRenderer{constructor(U){var Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le,xe;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(Oe){throw this._renderer.setRenderTarget(null),Oe}this._renderer.setRenderTarget(null)},this._width=U.width,this._height=U.height,this._type=U.type,this._colorSpace=U.colorSpace;const Fe={format:RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((Y=U.renderTargetOptions)===null||Y===void 0?void 0:Y.anisotropy)!==void 0?(ie=U.renderTargetOptions)===null||ie===void 0?void 0:ie.anisotropy:1,generateMipmaps:((ne=U.renderTargetOptions)===null||ne===void 0?void 0:ne.generateMipmaps)!==void 0?(F=U.renderTargetOptions)===null||F===void 0?void 0:F.generateMipmaps:!1,magFilter:((fe=U.renderTargetOptions)===null||fe===void 0?void 0:fe.magFilter)!==void 0?(pe=U.renderTargetOptions)===null||pe===void 0?void 0:pe.magFilter:LinearFilter,minFilter:((Me=U.renderTargetOptions)===null||Me===void 0?void 0:Me.minFilter)!==void 0?(ve=U.renderTargetOptions)===null||ve===void 0?void 0:ve.minFilter:LinearFilter,samples:((se=U.renderTargetOptions)===null||se===void 0?void 0:se.samples)!==void 0?(me=U.renderTargetOptions)===null||me===void 0?void 0:me.samples:void 0,wrapS:((Te=U.renderTargetOptions)===null||Te===void 0?void 0:Te.wrapS)!==void 0?(Re=U.renderTargetOptions)===null||Re===void 0?void 0:Re.wrapS:ClampToEdgeWrapping,wrapT:((be=U.renderTargetOptions)===null||be===void 0?void 0:be.wrapT)!==void 0?(Pe=U.renderTargetOptions)===null||Pe===void 0?void 0:Pe.wrapT:ClampToEdgeWrapping};if(this._material=U.material,U.renderer?this._renderer=U.renderer:(this._renderer=QuadRenderer.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Scene,this._camera=new OrthographicCamera,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!canReadPixels(this._type,this._renderer,this._camera,Fe)){let Oe;switch(this._type){case HalfFloatType:Oe=this._renderer.extensions.has("EXT_color_buffer_float")?FloatType:void 0;break}Oe!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${FloatType}`),this._type=Oe):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Mesh(new PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new WebGLRenderTarget(this.width,this.height,Fe),this._renderTarget.texture.mapping=((Le=U.renderTargetOptions)===null||Le===void 0?void 0:Le.mapping)!==void 0?(xe=U.renderTargetOptions)===null||xe===void 0?void 0:xe.mapping:UVMapping}static instantiateRenderer(){const U=new WebGLRenderer;return U.setSize(128,128),U}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const U=getBufferForType(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,U),U}toDataTexture(U){const Y=new DataTexture(this.toArray(),this.width,this.height,RGBAFormat,this._type,(U==null?void 0:U.mapping)||UVMapping,(U==null?void 0:U.wrapS)||ClampToEdgeWrapping,(U==null?void 0:U.wrapT)||ClampToEdgeWrapping,(U==null?void 0:U.magFilter)||LinearFilter,(U==null?void 0:U.minFilter)||LinearFilter,(U==null?void 0:U.anisotropy)||1,LinearSRGBColorSpace);return Y.generateMipmaps=(U==null?void 0:U.generateMipmaps)!==void 0?U==null?void 0:U.generateMipmaps:!1,Y}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(U){this.disposeOnDemandRenderer(),U&&this.renderTarget.dispose(),this.material instanceof ShaderMaterial&&Object.values(this.material.uniforms).forEach(Y=>{Y.value instanceof Texture$1&&Y.value.dispose()}),Object.values(this.material).forEach(Y=>{Y instanceof Texture$1&&Y.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(U){this._width=U,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(U){this._height=U,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(U){this._renderTarget=U,this._width=U.width,this._height=U.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const vertexShader=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,fragmentShader=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class GainMapDecoderMaterial extends ShaderMaterial{constructor({gamma:U,offsetHdr:Y,offsetSdr:ie,gainMapMin:ne,gainMapMax:F,maxDisplayBoost:fe,hdrCapacityMin:pe,hdrCapacityMax:Me,sdr:ve,gainMap:se}){super({name:"GainMapDecoderMaterial",vertexShader,fragmentShader,uniforms:{sdr:{value:ve},gainMap:{value:se},gamma:{value:new Vector3(1/U[0],1/U[1],1/U[2])},offsetHdr:{value:new Vector3().fromArray(Y)},offsetSdr:{value:new Vector3().fromArray(ie)},gainMapMin:{value:new Vector3().fromArray(ne)},gainMapMax:{value:new Vector3().fromArray(F)},weightFactor:{value:(Math.log2(fe)-pe)/(Me-pe)}},blending:NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=fe,this._hdrCapacityMin=pe,this._hdrCapacityMax=Me,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(U){this.uniforms.sdr.value=U}get gainMap(){return this.uniforms.gainMap.value}set gainMap(U){this.uniforms.gainMap.value=U}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(U){this.uniforms.offsetHdr.value.fromArray(U)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(U){this.uniforms.offsetSdr.value.fromArray(U)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(U){this.uniforms.gainMapMin.value.fromArray(U)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(U){this.uniforms.gainMapMax.value.fromArray(U)}get gamma(){const U=this.uniforms.gamma.value;return[1/U.x,1/U.y,1/U.z]}set gamma(U){const Y=this.uniforms.gamma.value;Y.x=1/U[0],Y.y=1/U[1],Y.z=1/U[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(U){this._hdrCapacityMin=U,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(U){this._hdrCapacityMax=U,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(U){this._maxDisplayBoost=Math.max(1,Math.min(65504,U)),this.calculateWeight()}calculateWeight(){const U=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,U))}}class GainMapNotFoundError extends Error{}class XMPMetadataNotFoundError extends Error{}const getXMLValue=(re,U,Y)=>{const ie=new RegExp(`${U}="([^"]*)"`,"i").exec(re);if(ie)return ie[1];const ne=new RegExp(`<${U}[^>]*>([\\s\\S]*?)</${U}>`,"i").exec(re);if(ne){const F=ne[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return F&&F.length===3?F.map(fe=>fe.replace(/<\/?rdf:li>/g,"")):ne[1].trim()}if(Y!==void 0)return Y;throw new Error(`Can't find ${U} in gainmap metadata`)},extractXMP=re=>{let U;typeof TextDecoder<"u"?U=new TextDecoder().decode(re):U=re.toString();let Y=U.indexOf("<x:xmpmeta");for(;Y!==-1;){const ie=U.indexOf("x:xmpmeta>",Y),ne=U.slice(Y,ie+10);try{const F=getXMLValue(ne,"hdrgm:GainMapMin","0"),fe=getXMLValue(ne,"hdrgm:GainMapMax"),pe=getXMLValue(ne,"hdrgm:Gamma","1"),Me=getXMLValue(ne,"hdrgm:OffsetSDR","0.015625"),ve=getXMLValue(ne,"hdrgm:OffsetHDR","0.015625"),se=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(ne),me=se?se[1]:"0",Te=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(ne);if(!Te)throw new Error("Incomplete gainmap metadata");const Re=Te[1];return{gainMapMin:Array.isArray(F)?F.map(be=>parseFloat(be)):[parseFloat(F),parseFloat(F),parseFloat(F)],gainMapMax:Array.isArray(fe)?fe.map(be=>parseFloat(be)):[parseFloat(fe),parseFloat(fe),parseFloat(fe)],gamma:Array.isArray(pe)?pe.map(be=>parseFloat(be)):[parseFloat(pe),parseFloat(pe),parseFloat(pe)],offsetSdr:Array.isArray(Me)?Me.map(be=>parseFloat(be)):[parseFloat(Me),parseFloat(Me),parseFloat(Me)],offsetHdr:Array.isArray(ve)?ve.map(be=>parseFloat(be)):[parseFloat(ve),parseFloat(ve),parseFloat(ve)],hdrCapacityMin:parseFloat(me),hdrCapacityMax:parseFloat(Re)}}catch{}Y=U.indexOf("<x:xmpmeta",ie)}};class MPFExtractor{constructor(U){this.options={debug:U&&U.debug!==void 0?U.debug:!1,extractFII:U&&U.extractFII!==void 0?U.extractFII:!0,extractNonFII:U&&U.extractNonFII!==void 0?U.extractNonFII:!0}}extract(U){return new Promise((Y,ie)=>{const ne=this.options.debug,F=new DataView(U.buffer);if(F.getUint16(0)!==65496){ie(new Error("Not a valid jpeg"));return}const fe=F.byteLength;let pe=2,Me=0,ve;for(;pe<fe;){if(++Me>250){ie(new Error(`Found no marker after ${Me} loops 😵`));return}if(F.getUint8(pe)!==255){ie(new Error(`Not a valid marker at offset 0x${pe.toString(16)}, found: 0x${F.getUint8(pe).toString(16)}`));return}if(ve=F.getUint8(pe+1),ne&&console.log(`Marker: ${ve.toString(16)}`),ve===226){ne&&console.log("Found APP2 marker (0xffe2)");const se=pe+4;if(F.getUint32(se)===1297106432){const me=se+4;let Te;if(F.getUint16(me)===18761)Te=!1;else if(F.getUint16(me)===19789)Te=!0;else{ie(new Error("No valid endianness marker found in TIFF header"));return}if(F.getUint16(me+2,!Te)!==42){ie(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const Re=F.getUint32(me+4,!Te);if(Re<8){ie(new Error("Not valid TIFF data! (First offset less than 8)"));return}const be=me+Re,Pe=F.getUint16(be,!Te),Le=be+2;let xe=0;for(let ke=Le;ke<Le+12*Pe;ke+=12)F.getUint16(ke,!Te)===45057&&(xe=F.getUint32(ke+8,!Te));const Oe=be+2+Pe*12+4,Ne=[];for(let ke=Oe;ke<Oe+xe*16;ke+=16){const Ve={MPType:F.getUint32(ke,!Te),size:F.getUint32(ke+4,!Te),dataOffset:F.getUint32(ke+8,!Te),dependantImages:F.getUint32(ke+12,!Te),start:-1,end:-1,isFII:!1};Ve.dataOffset?(Ve.start=me+Ve.dataOffset,Ve.isFII=!1):(Ve.start=0,Ve.isFII=!0),Ve.end=Ve.start+Ve.size,Ne.push(Ve)}if(this.options.extractNonFII&&Ne.length){const ke=new Blob([F]),Ve=[];for(const Xe of Ne){if(Xe.isFII&&!this.options.extractFII)continue;const $e=ke.slice(Xe.start,Xe.end+1,"image/jpeg");Ve.push($e)}Y(Ve)}}}pe+=2+F.getUint16(pe+2)}})}}const extractGainmapFromJPEG=async re=>{const U=extractXMP(re);if(!U)throw new XMPMetadataNotFoundError("Gain map XMP metadata not found");const ie=await new MPFExtractor({extractFII:!0,extractNonFII:!0}).extract(re);if(ie.length!==2)throw new GainMapNotFoundError("Gain map recovery image not found");return{sdr:new Uint8Array(await ie[0].arrayBuffer()),gainMap:new Uint8Array(await ie[1].arrayBuffer()),metadata:U}},getHTMLImageFromBlob=re=>new Promise((U,Y)=>{const ie=document.createElement("img");ie.onload=()=>{U(ie)},ie.onerror=ne=>{Y(ne)},ie.src=URL.createObjectURL(re)});class LoaderBase extends Loader{constructor(U,Y){super(Y),U&&(this._renderer=U),this._internalLoadingManager=new LoadingManager}setRenderer(U){return this._renderer=U,this}setRenderTargetOptions(U){return this._renderTargetOptions=U,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const U=new GainMapDecoderMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Texture$1,sdr:new Texture$1});return new QuadRenderer({width:16,height:16,type:HalfFloatType,colorSpace:LinearSRGBColorSpace,material:U,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(U,Y,ie,ne){const F=ne?new Blob([ne],{type:"image/jpeg"}):void 0,fe=new Blob([ie],{type:"image/jpeg"});let pe,Me,ve=!1;if(typeof createImageBitmap>"u"){const Te=await Promise.all([F?getHTMLImageFromBlob(F):Promise.resolve(void 0),getHTMLImageFromBlob(fe)]);Me=Te[0],pe=Te[1],ve=!0}else{const Te=await Promise.all([F?createImageBitmap(F,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(fe,{imageOrientation:"flipY"})]);Me=Te[0],pe=Te[1]}const se=new Texture$1(Me||new ImageData(2,2),UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,LinearSRGBColorSpace);se.flipY=ve,se.needsUpdate=!0;const me=new Texture$1(pe,UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,SRGBColorSpace);me.flipY=ve,me.needsUpdate=!0,U.width=pe.width,U.height=pe.height,U.material.gainMap=se,U.material.sdr=me,U.material.gainMapMin=Y.gainMapMin,U.material.gainMapMax=Y.gainMapMax,U.material.offsetHdr=Y.offsetHdr,U.material.offsetSdr=Y.offsetSdr,U.material.gamma=Y.gamma,U.material.hdrCapacityMin=Y.hdrCapacityMin,U.material.hdrCapacityMax=Y.hdrCapacityMax,U.material.maxDisplayBoost=Math.pow(2,Y.hdrCapacityMax),U.material.needsUpdate=!0,U.render()}}class HDRJPGLoader extends LoaderBase{load(U,Y,ie,ne){const F=this.prepareQuadRenderer(),fe=new FileLoader(this._internalLoadingManager);return fe.setResponseType("arraybuffer"),fe.setRequestHeader(this.requestHeader),fe.setPath(this.path),fe.setWithCredentials(this.withCredentials),this.manager.itemStart(U),fe.load(U,async pe=>{if(typeof pe=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const Me=new Uint8Array(pe);let ve,se,me;try{const Te=await extractGainmapFromJPEG(Me);ve=Te.sdr,se=Te.gainMap,me=Te.metadata}catch(Te){if(Te instanceof XMPMetadataNotFoundError||Te instanceof GainMapNotFoundError)console.warn(`Failure to reconstruct an HDR image from ${U}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),me={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},ve=Me;else throw Te}try{await this.render(F,me,ve,se)}catch(Te){this.manager.itemError(U),typeof ne=="function"&&ne(Te),F.disposeOnDemandRenderer();return}typeof Y=="function"&&Y(F),this.manager.itemEnd(U),F.disposeOnDemandRenderer()},ie,pe=>{this.manager.itemError(U),typeof ne=="function"&&ne(pe)}),F}}class RGBELoader extends DataTextureLoader{constructor(U){super(U),this.type=HalfFloatType}parse(U){const fe=function($e,st){switch($e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(st||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(st||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(st||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(st||""))}},se=`
`,me=function($e,st,ze){st=st||1024;let ft=$e.pos,Rt=-1,Mt=0,Gt="",_t=String.fromCharCode.apply(null,new Uint16Array($e.subarray(ft,ft+128)));for(;0>(Rt=_t.indexOf(se))&&Mt<st&&ft<$e.byteLength;)Gt+=_t,Mt+=_t.length,ft+=128,_t+=String.fromCharCode.apply(null,new Uint16Array($e.subarray(ft,ft+128)));return-1<Rt?($e.pos+=Mt+Rt+1,Gt+_t.slice(0,Rt)):!1},Te=function($e){const st=/^#\?(\S+)/,ze=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,tt=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,ft=/^\s*FORMAT=(\S+)\s*$/,Rt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Mt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Gt,_t;for(($e.pos>=$e.byteLength||!(Gt=me($e)))&&fe(1,"no header found"),(_t=Gt.match(st))||fe(3,"bad initial token"),Mt.valid|=1,Mt.programtype=_t[1],Mt.string+=Gt+`
`;Gt=me($e),Gt!==!1;){if(Mt.string+=Gt+`
`,Gt.charAt(0)==="#"){Mt.comments+=Gt+`
`;continue}if((_t=Gt.match(ze))&&(Mt.gamma=parseFloat(_t[1])),(_t=Gt.match(tt))&&(Mt.exposure=parseFloat(_t[1])),(_t=Gt.match(ft))&&(Mt.valid|=2,Mt.format=_t[1]),(_t=Gt.match(Rt))&&(Mt.valid|=4,Mt.height=parseInt(_t[1],10),Mt.width=parseInt(_t[2],10)),Mt.valid&2&&Mt.valid&4)break}return Mt.valid&2||fe(3,"missing format specifier"),Mt.valid&4||fe(3,"missing image size specifier"),Mt},Re=function($e,st,ze){const tt=st;if(tt<8||tt>32767||$e[0]!==2||$e[1]!==2||$e[2]&128)return new Uint8Array($e);tt!==($e[2]<<8|$e[3])&&fe(3,"wrong scanline width");const ft=new Uint8Array(4*st*ze);ft.length||fe(4,"unable to allocate buffer space");let Rt=0,Mt=0;const Gt=4*tt,_t=new Uint8Array(4),Bt=new Uint8Array(Gt);let dt=ze;for(;dt>0&&Mt<$e.byteLength;){Mt+4>$e.byteLength&&fe(1),_t[0]=$e[Mt++],_t[1]=$e[Mt++],_t[2]=$e[Mt++],_t[3]=$e[Mt++],(_t[0]!=2||_t[1]!=2||(_t[2]<<8|_t[3])!=tt)&&fe(3,"bad rgbe scanline format");let ut=0,Ut;for(;ut<Gt&&Mt<$e.byteLength;){Ut=$e[Mt++];const Xt=Ut>128;if(Xt&&(Ut-=128),(Ut===0||ut+Ut>Gt)&&fe(3,"bad scanline data"),Xt){const hn=$e[Mt++];for(let nn=0;nn<Ut;nn++)Bt[ut++]=hn}else Bt.set($e.subarray(Mt,Mt+Ut),ut),ut+=Ut,Mt+=Ut}const Tt=tt;for(let Xt=0;Xt<Tt;Xt++){let hn=0;ft[Rt]=Bt[Xt+hn],hn+=tt,ft[Rt+1]=Bt[Xt+hn],hn+=tt,ft[Rt+2]=Bt[Xt+hn],hn+=tt,ft[Rt+3]=Bt[Xt+hn],Rt+=4}dt--}return ft},be=function($e,st,ze,tt){const ft=$e[st+3],Rt=Math.pow(2,ft-128)/255;ze[tt+0]=$e[st+0]*Rt,ze[tt+1]=$e[st+1]*Rt,ze[tt+2]=$e[st+2]*Rt,ze[tt+3]=1},Pe=function($e,st,ze,tt){const ft=$e[st+3],Rt=Math.pow(2,ft-128)/255;ze[tt+0]=DataUtils.toHalfFloat(Math.min($e[st+0]*Rt,65504)),ze[tt+1]=DataUtils.toHalfFloat(Math.min($e[st+1]*Rt,65504)),ze[tt+2]=DataUtils.toHalfFloat(Math.min($e[st+2]*Rt,65504)),ze[tt+3]=DataUtils.toHalfFloat(1)},Le=new Uint8Array(U);Le.pos=0;const xe=Te(Le),Fe=xe.width,Oe=xe.height,Ne=Re(Le.subarray(Le.pos),Fe,Oe);let ke,Ve,Xe;switch(this.type){case FloatType:Xe=Ne.length/4;const $e=new Float32Array(Xe*4);for(let ze=0;ze<Xe;ze++)be(Ne,ze*4,$e,ze*4);ke=$e,Ve=FloatType;break;case HalfFloatType:Xe=Ne.length/4;const st=new Uint16Array(Xe*4);for(let ze=0;ze<Xe;ze++)Pe(Ne,ze*4,st,ze*4);ke=st,Ve=HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:Fe,height:Oe,data:ke,header:xe.string,gamma:xe.gamma,exposure:xe.exposure,type:Ve}}setDataType(U){return this.type=U,this}load(U,Y,ie,ne){function F(fe,pe){switch(fe.type){case FloatType:case HalfFloatType:fe.colorSpace=LinearSRGBColorSpace,fe.minFilter=LinearFilter,fe.magFilter=LinearFilter,fe.generateMipmaps=!1,fe.flipY=!0;break}Y&&Y(fe,pe)}return super.load(U,F,ie,ne)}}/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const legacy={topLight:{intensity:500,position:[.418,16.199,.3]},room:{position:[-.757,13.219,.717],scale:[31.713,28.305,28.591]},boxes:[{position:[-10.906,2.009,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,.857,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:50,position:[-16.116,14.37,8.208],scale:[.1,2.428,2.739]},{intensity:50,position:[-16.109,18.021,-8.207],scale:[.1,2.425,2.751]},{intensity:17,position:[14.904,12.198,-1.832],scale:[.15,4.265,6.331]},{intensity:43,position:[-.462,8.89,14.52],scale:[4.38,5.441,.088]},{intensity:20,position:[3.235,11.486,-12.541],scale:[2.5,2,.1]},{intensity:100,position:[0,20,0],scale:[1,.1,1]}]},neutral={topLight:{intensity:400,position:[.5,14,.5]},room:{position:[0,13.2,0],scale:[31.5,28.5,31.5]},boxes:[{position:[-10.906,-1,1.846],rotation:-.195,scale:[2.328,7.905,4.651]},{position:[-5.607,-.754,-.758],rotation:.994,scale:[1.97,1.534,3.955]},{position:[6.167,-.16,7.803],rotation:.561,scale:[3.927,6.285,3.687]},{position:[-2.017,.018,6.124],rotation:.333,scale:[2.002,4.566,2.064]},{position:[2.291,-.756,-2.621],rotation:-.286,scale:[1.546,1.552,1.496]},{position:[-2.193,-.369,-5.547],rotation:.516,scale:[3.875,3.487,2.986]}],lights:[{intensity:80,position:[-14,10,8],scale:[.1,2.5,2.5]},{intensity:80,position:[-14,14,-4],scale:[.1,2.5,2.5]},{intensity:23,position:[14,12,0],scale:[.1,5,5]},{intensity:16,position:[0,9,14],scale:[5,5,.1]},{intensity:80,position:[7,8,-14],scale:[2.5,2.5,.1]},{intensity:80,position:[-7,16,-14],scale:[2.5,2.5,.1]},{intensity:1,position:[0,20,0],scale:[.1,.1,.1]}]};class EnvironmentScene extends Scene{constructor(U){super(),this.position.y=-3.5;const Y=new BoxGeometry;Y.deleteAttribute("uv");const ie=new MeshStandardMaterial({metalness:0,side:BackSide}),ne=new MeshStandardMaterial({metalness:0}),F=U=="legacy"?legacy:neutral,fe=new PointLight(16777215,F.topLight.intensity,28,2);fe.position.set(...F.topLight.position),this.add(fe);const pe=new Mesh(Y,ie);pe.position.set(...F.room.position),pe.scale.set(...F.room.scale),this.add(pe);for(const Me of F.boxes){const ve=new Mesh(Y,ne);ve.position.set(...Me.position),ve.rotation.set(0,Me.rotation,0),ve.scale.set(...Me.scale),this.add(ve)}for(const Me of F.lights){const ve=new Mesh(Y,this.createAreaLightMaterial(Me.intensity));ve.position.set(...Me.position),ve.scale.set(...Me.scale),this.add(ve)}}createAreaLightMaterial(U){const Y=new MeshBasicMaterial;return Y.color.setScalar(U),Y}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GENERATED_SIGMA=.04,MAX_SAMPLES=20,HDR_FILE_RE=/\.hdr(\.js)?$/;class TextureUtils{constructor(U){this.threeRenderer=U,this.lottieLoaderUrl="",this._ldrLoader=null,this._imageLoader=null,this._hdrLoader=null,this._lottieLoader=null,this.generatedEnvironmentMap=null,this.generatedEnvironmentMapAlt=null,this.skyboxCache=new Map,this.blurMaterial=null,this.blurScene=null}ldrLoader(U){return this._ldrLoader==null&&(this._ldrLoader=new TextureLoader),this._ldrLoader.setWithCredentials(U),this._ldrLoader}imageLoader(U){return this._imageLoader==null&&(this._imageLoader=new HDRJPGLoader(this.threeRenderer)),this._imageLoader.setWithCredentials(U),this._imageLoader}hdrLoader(U){return this._hdrLoader==null&&(this._hdrLoader=new RGBELoader,this._hdrLoader.setDataType(HalfFloatType)),this._hdrLoader.setWithCredentials(U),this._hdrLoader}async getLottieLoader(U){if(this._lottieLoader==null){const{LottieLoader:Y}=await import(this.lottieLoaderUrl);this._lottieLoader=new Y}return this._lottieLoader.setWithCredentials(U),this._lottieLoader}async loadImage(U,Y){const ie=await new Promise((ne,F)=>this.ldrLoader(Y).load(U,ne,()=>{},F));return ie.name=U,ie.flipY=!1,ie}async loadLottie(U,Y,ie){const ne=await this.getLottieLoader(ie);ne.setQuality(Y);const F=await new Promise((fe,pe)=>ne.load(U,fe,()=>{},pe));return F.name=U,F}async loadEquirect(U,Y=!1,ie=()=>{}){try{const ne=HDR_FILE_RE.test(U),F=ne?this.hdrLoader(Y):this.imageLoader(Y),fe=await new Promise((pe,Me)=>F.load(U,ve=>{const{renderTarget:se}=ve;if(se!=null){const{texture:me}=se;ve.dispose(!1),pe(me)}else pe(ve)},ve=>{ie(ve.loaded/ve.total*.9)},Me));return ie(1),fe.name=U,fe.mapping=EquirectangularReflectionMapping,ne||(fe.colorSpace=SRGBColorSpace),fe}finally{ie&&ie(1)}}async generateEnvironmentMapAndSkybox(U=null,Y=null,ie=()=>{},ne=!1){const F=Y!=="legacy";(Y==="legacy"||Y==="neutral")&&(Y=null),Y=deserializeUrl(Y);let fe=Promise.resolve(null),pe;U&&(fe=this.loadEquirectFromUrl(U,ne,ie)),Y?pe=this.loadEquirectFromUrl(Y,ne,ie):U?pe=this.loadEquirectFromUrl(U,ne,ie):pe=F?this.loadGeneratedEnvironmentMapAlt():this.loadGeneratedEnvironmentMap();const[Me,ve]=await Promise.all([pe,fe]);if(Me==null)throw new Error("Failed to load environment map.");return{environmentMap:Me,skybox:ve}}async loadEquirectFromUrl(U,Y,ie){if(!this.skyboxCache.has(U)){const ne=this.loadEquirect(U,Y,ie);this.skyboxCache.set(U,ne)}return this.skyboxCache.get(U)}async GenerateEnvironmentMap(U,Y){await timePasses();const ie=this.threeRenderer,ne=new WebGLCubeRenderTarget(256,{generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!0}),F=new CubeCamera(.1,100,ne),fe=F.renderTarget.texture;fe.name=Y;const pe=ie.outputColorSpace,Me=ie.toneMapping;return ie.toneMapping=NoToneMapping,ie.outputColorSpace=LinearSRGBColorSpace,F.update(ie,U),this.blurCubemap(ne,GENERATED_SIGMA),ie.toneMapping=Me,ie.outputColorSpace=pe,fe}async loadGeneratedEnvironmentMap(){return this.generatedEnvironmentMap==null&&(this.generatedEnvironmentMap=this.GenerateEnvironmentMap(new EnvironmentScene("legacy"),"legacy")),this.generatedEnvironmentMap}async loadGeneratedEnvironmentMapAlt(){return this.generatedEnvironmentMapAlt==null&&(this.generatedEnvironmentMapAlt=this.GenerateEnvironmentMap(new EnvironmentScene("neutral"),"neutral")),this.generatedEnvironmentMapAlt}blurCubemap(U,Y){if(this.blurMaterial==null){this.blurMaterial=this.getBlurShader(MAX_SAMPLES);const ne=new BoxGeometry,F=new Mesh(ne,this.blurMaterial);this.blurScene=new Scene,this.blurScene.add(F)}const ie=U.clone();this.halfblur(U,ie,Y,"latitudinal"),this.halfblur(ie,U,Y,"longitudinal")}halfblur(U,Y,ie,ne){const fe=U.width,pe=isFinite(ie)?Math.PI/(2*fe):2*Math.PI/(2*MAX_SAMPLES-1),Me=ie/pe,ve=isFinite(ie)?1+Math.floor(3*Me):MAX_SAMPLES;ve>MAX_SAMPLES&&console.warn(`sigmaRadians, ${ie}, is too large and will clip, as it requested ${ve} samples when the maximum is set to ${MAX_SAMPLES}`);const se=[];let me=0;for(let be=0;be<MAX_SAMPLES;++be){const Pe=be/Me,Le=Math.exp(-Pe*Pe/2);se.push(Le),be==0?me+=Le:be<ve&&(me+=2*Le)}for(let be=0;be<se.length;be++)se[be]=se[be]/me;const Te=this.blurMaterial.uniforms;Te.envMap.value=U.texture,Te.samples.value=ve,Te.weights.value=se,Te.latitudinal.value=ne==="latitudinal",Te.dTheta.value=pe,new CubeCamera(.1,100,Y).update(this.threeRenderer,this.blurScene)}getBlurShader(U){const Y=new Float32Array(U),ie=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:U},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:Y},latitudinal:{value:!1},dTheta:{value:0},poleAxis:{value:ie}},vertexShader:`
      
      varying vec3 vOutputDirection;
  
      void main() {
  
        vOutputDirection = vec3( position );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  
      }
    `,fragmentShader:`
        varying vec3 vOutputDirection;
  
        uniform samplerCube envMap;
        uniform int samples;
        uniform float weights[ n ];
        uniform bool latitudinal;
        uniform float dTheta;
        uniform vec3 poleAxis;
  
        vec3 getSample( float theta, vec3 axis ) {
  
          float cosTheta = cos( theta );
          // Rodrigues' axis-angle rotation
          vec3 sampleDirection = vOutputDirection * cosTheta
            + cross( axis, vOutputDirection ) * sin( theta )
            + axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );
  
          return vec3( textureCube( envMap, sampleDirection ) );
  
        }
  
        void main() {
  
          vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );
  
          if ( all( equal( axis, vec3( 0.0 ) ) ) ) {
  
            axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );
  
          }
  
          axis = normalize( axis );
  
          gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
          gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );
  
          for ( int i = 1; i < n; i++ ) {
  
            if ( i >= samples ) {
  
              break;
  
            }
  
            float theta = dTheta * float( i );
            gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
            gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );
  
          }
        }
      `,blending:NoBlending,depthTest:!1,depthWrite:!1,side:BackSide})}async dispose(){for(const[,U]of this.skyboxCache)(await U).dispose();this.generatedEnvironmentMap!=null&&((await this.generatedEnvironmentMap).dispose(),this.generatedEnvironmentMap=null),this.generatedEnvironmentMapAlt!=null&&((await this.generatedEnvironmentMapAlt).dispose(),this.generatedEnvironmentMapAlt=null),this.blurMaterial!=null&&this.blurMaterial.dispose()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DURATION_DECAY=.2,LOW_FRAME_DURATION_MS=40,HIGH_FRAME_DURATION_MS=60,MAX_AVG_CHANGE_MS=5,SCALE_STEPS=[1,.79,.62,.5,.4,.31,.25],DEFAULT_LAST_STEP=3,DEFAULT_POWER_PREFERENCE="high-performance",COMMERCE_EXPOSURE=1.3;class Renderer extends EventDispatcher{constructor(U){super(),this.loader=new CachingGLTFLoader(ModelViewerGLTFInstance),this.width=0,this.height=0,this.dpr=1,this.scenes=new Set,this.multipleScenesVisible=!1,this.lastTick=performance.now(),this.renderedLastFrame=!1,this.scaleStep=0,this.lastStep=DEFAULT_LAST_STEP,this.avgFrameDuration=(HIGH_FRAME_DURATION_MS+LOW_FRAME_DURATION_MS)/2,this.onWebGLContextLost=Y=>{this.dispatchEvent({type:"contextlost",sourceEvent:Y})},this.onWebGLContextRestored=()=>{var Y;(Y=this.textureUtils)===null||Y===void 0||Y.dispose(),this.textureUtils=new TextureUtils(this.threeRenderer);for(const ie of this.scenes)ie.element[$updateEnvironment]()},this.dpr=window.devicePixelRatio,this.canvas3D=document.createElement("canvas"),this.canvas3D.id="webgl-canvas",this.canvas3D.classList.add("show");try{this.threeRenderer=new WebGLRenderer({canvas:this.canvas3D,alpha:!0,antialias:!0,powerPreference:U.powerPreference,preserveDrawingBuffer:!0}),this.threeRenderer.autoClear=!0,this.threeRenderer.setPixelRatio(1),this.threeRenderer.debug={checkShaderErrors:!!U.debug,onShaderError:null},this.threeRenderer.toneMapping=ACESFilmicToneMapping}catch(Y){console.warn(Y)}this.arRenderer=new ARRenderer(this),this.textureUtils=this.canRender?new TextureUtils(this.threeRenderer):null,CachingGLTFLoader.initializeKTX2Loader(this.threeRenderer),this.canvas3D.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.updateRendererSize()}static get singleton(){return this._singleton||(this._singleton=new Renderer({powerPreference:(self.ModelViewerElement||{}).powerPreference||DEFAULT_POWER_PREFERENCE,debug:isDebugMode()})),this._singleton}static resetSingleton(){const U=this._singleton.dispose();for(const Y of U)Y.disconnectedCallback();this._singleton=new Renderer({powerPreference:(self.ModelViewerElement||{}).powerPreference||DEFAULT_POWER_PREFERENCE,debug:isDebugMode()});for(const Y of U)Y.connectedCallback()}get canRender(){return this.threeRenderer!=null}get scaleFactor(){return SCALE_STEPS[this.scaleStep]}set minScale(U){let Y=1;for(;Y<SCALE_STEPS.length&&!(SCALE_STEPS[Y]<U);)++Y;this.lastStep=Y-1}registerScene(U){this.scenes.add(U),U.forceRescale();const Y=new Vector2;this.threeRenderer.getSize(Y),U.canvas.width=Y.x,U.canvas.height=Y.y,this.canRender&&this.scenes.size>0&&this.threeRenderer.setAnimationLoop((ie,ne)=>this.render(ie,ne))}unregisterScene(U){this.scenes.delete(U),this.canvas3D.parentElement===U.canvas.parentElement&&U.canvas.parentElement.removeChild(this.canvas3D),this.canRender&&this.scenes.size===0&&this.threeRenderer.setAnimationLoop(null)}displayCanvas(U){return U.element.modelIsVisible&&!this.multipleScenesVisible?this.canvas3D:U.element[$canvas]}countVisibleScenes(){const{canvas3D:U}=this;let Y=0,ie=null;for(const F of this.scenes){const{element:fe}=F;fe.modelIsVisible&&F.externalRenderer==null&&++Y,U.parentElement===F.canvas.parentElement&&(ie=F)}const ne=Y>1;if(ie!=null){const F=ne&&!this.multipleScenesVisible,fe=!ie.element.modelIsVisible;if(F||fe){const{width:pe,height:Me}=this.sceneSize(ie);this.copyPixels(ie,pe,Me),U.parentElement.removeChild(U)}}this.multipleScenesVisible=ne}updateRendererSize(){var U;const Y=window.devicePixelRatio;if(Y!==this.dpr)for(const F of this.scenes){const{element:fe}=F;fe[$updateSize](fe.getBoundingClientRect())}let ie=0,ne=0;for(const F of this.scenes)ie=Math.max(ie,F.width),ne=Math.max(ne,F.height);if(!(ie===this.width&&ne===this.height&&Y===this.dpr)){this.width=ie,this.height=ne,this.dpr=Y,ie=Math.ceil(ie*Y),ne=Math.ceil(ne*Y),this.canRender&&this.threeRenderer.setSize(ie,ne,!1);for(const F of this.scenes){const{canvas:fe}=F;fe.width=ie,fe.height=ne,F.forceRescale(),(U=F.effectRenderer)===null||U===void 0||U.setSize(ie,ne)}}}updateRendererScale(U){const Y=this.scaleStep;this.avgFrameDuration+=clamp(DURATION_DECAY*(U-this.avgFrameDuration),-5,MAX_AVG_CHANGE_MS),this.avgFrameDuration>HIGH_FRAME_DURATION_MS?++this.scaleStep:this.avgFrameDuration<LOW_FRAME_DURATION_MS&&this.scaleStep>0&&--this.scaleStep,this.scaleStep=Math.min(this.scaleStep,this.lastStep),Y!==this.scaleStep&&(this.avgFrameDuration=(HIGH_FRAME_DURATION_MS+LOW_FRAME_DURATION_MS)/2)}shouldRender(U){if(U.shouldRender())U.scaleStep!=this.scaleStep&&(U.scaleStep=this.scaleStep,this.rescaleCanvas(U));else if(U.scaleStep!=0)U.scaleStep=0,this.rescaleCanvas(U);else return!1;return!0}rescaleCanvas(U){const Y=SCALE_STEPS[U.scaleStep],ie=Math.ceil(this.width/Y),ne=Math.ceil(this.height/Y),{style:F}=U.canvas;F.width=`${ie}px`,F.height=`${ne}px`,this.canvas3D.style.width=`${ie}px`,this.canvas3D.style.height=`${ne}px`;const fe=this.dpr*Y,pe=Y<1?"GPU throttling":this.dpr!==window.devicePixelRatio?"No meta viewport tag":"";U.element.dispatchEvent(new CustomEvent("render-scale",{detail:{reportedDpr:window.devicePixelRatio,renderedDpr:fe,minimumDpr:this.dpr*SCALE_STEPS[this.lastStep],pixelWidth:Math.ceil(U.width*fe),pixelHeight:Math.ceil(U.height*fe),reason:pe}}))}sceneSize(U){const{dpr:Y}=this,ie=SCALE_STEPS[U.scaleStep],ne=Math.min(Math.ceil(U.width*ie*Y),this.canvas3D.width),F=Math.min(Math.ceil(U.height*ie*Y),this.canvas3D.height);return{width:ne,height:F}}copyPixels(U,Y,ie){const ne=U.context;if(ne==null){console.log("could not acquire 2d context");return}ne.clearRect(0,0,Y,ie),ne.drawImage(this.canvas3D,0,0,Y,ie,0,0,Y,ie),U.canvas.classList.add("show")}orderedScenes(){const U=[];for(const Y of[!1,!0])for(const ie of this.scenes)ie.element.modelIsVisible===Y&&U.push(ie);return U}get isPresenting(){return this.arRenderer.isPresenting}preRender(U,Y,ie){const{element:ne,exposure:F,toneMapping:fe}=U;ne[$tick](Y,ie);const pe=typeof F=="number"&&!Number.isNaN(F),Me=ne.environmentImage,ve=ne.skyboxImage,se=fe===NeutralToneMapping&&(Me==="neutral"||Me==="legacy"||!Me&&!ve);this.threeRenderer.toneMappingExposure=(pe?F:1)*(se?COMMERCE_EXPOSURE:1)}render(U,Y){if(Y!=null){this.arRenderer.onWebXRFrame(U,Y);return}const ie=U-this.lastTick;if(this.lastTick=U,!this.canRender||this.isPresenting)return;this.countVisibleScenes(),this.updateRendererSize(),this.renderedLastFrame&&(this.updateRendererScale(ie),this.renderedLastFrame=!1);const{canvas3D:ne}=this;for(const F of this.orderedScenes()){const{element:fe}=F;if(!fe.loaded||!fe.modelIsVisible&&F.renderCount>0||(this.preRender(F,U,ie),!this.shouldRender(F)))continue;if(F.externalRenderer!=null){const ve=F.getCamera();ve.updateMatrix();const{matrix:se,projectionMatrix:me}=ve,Te=se.elements.slice(),Re=F.getTarget();Te[12]+=Re.x,Te[13]+=Re.y,Te[14]+=Re.z,F.externalRenderer.render({viewMatrix:Te,projectionMatrix:me.elements});continue}if(!fe.modelIsVisible&&!this.multipleScenesVisible)for(const ve of this.scenes)ve.element.modelIsVisible&&ve.queueRender();const{width:pe,height:Me}=this.sceneSize(F);F.renderShadow(this.threeRenderer),this.threeRenderer.setRenderTarget(null),this.threeRenderer.setViewport(0,Math.ceil(this.height*this.dpr)-Me,pe,Me),F.effectRenderer!=null?F.effectRenderer.render(ie):(this.threeRenderer.autoClear=!0,this.threeRenderer.toneMapping=F.toneMapping,this.threeRenderer.render(F,F.camera)),this.multipleScenesVisible||!F.element.modelIsVisible&&F.renderCount===0?this.copyPixels(F,pe,Me):ne.parentElement!==F.canvas.parentElement&&(F.canvas.parentElement.appendChild(ne),F.canvas.classList.remove("show")),F.hasRendered(),++F.renderCount,this.renderedLastFrame=!0}}dispose(){this.textureUtils!=null&&this.textureUtils.dispose(),this.threeRenderer!=null&&this.threeRenderer.dispose(),this.textureUtils=null,this.threeRenderer=null;const U=[];for(const Y of this.scenes)U.push(Y.element);return this.canvas3D.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.removeEventListener("webglcontextrestored",this.onWebGLContextRestored),U}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $correlatedObjects=Symbol("correlatedObjects"),$onUpdate$1=Symbol("onUpdate");class ThreeDOMElement{constructor(U,Y){this[$onUpdate$1]=U,this[$correlatedObjects]=Y}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const quadMaterial=new MeshBasicMaterial,quad=new PlaneGeometry(2,2);let adhocNum=0;const $threeTexture$2=Symbol("threeTexture"),$threeTextures$1=Symbol("threeTextures");let Image$1=class extends ThreeDOMElement{get[$threeTexture$2](){var U;return(U=this[$correlatedObjects])===null||U===void 0?void 0:U.values().next().value}get[$threeTextures$1](){return this[$correlatedObjects]}constructor(U,Y){super(U,new Set(Y?[Y]:[])),this[$threeTexture$2].image.src||(this[$threeTexture$2].image.src=Y.name?Y.name:"adhoc_image"+adhocNum++),this[$threeTexture$2].image.name||(this[$threeTexture$2].image.name=Y&&Y.image&&Y.image.src?Y.image.src.split("/").pop():"adhoc_image")}get name(){return this[$threeTexture$2].image.name||""}get uri(){return this[$threeTexture$2].image.src}get bufferView(){return this[$threeTexture$2].image.bufferView}get element(){const U=this[$threeTexture$2];if(U&&(U.isCanvasTexture||U.isVideoTexture))return U.image}get animation(){const U=this[$threeTexture$2];if(U&&U.isCanvasTexture&&U.animation)return U.animation}get type(){return this.uri!=null?"external":"embedded"}set name(U){for(const Y of this[$threeTextures$1])Y.image.name=U}update(){const U=this[$threeTexture$2];U&&U.isCanvasTexture&&!U.animation&&(this[$threeTexture$2].needsUpdate=!0,this[$onUpdate$1]())}async createThumbnail(U,Y){const ie=new Scene;quadMaterial.map=this[$threeTexture$2];const ne=new Mesh(quad,quadMaterial);ie.add(ne);const F=new OrthographicCamera(-1,1,1,-1,0,1),{threeRenderer:fe}=Renderer.singleton,pe=new WebGLRenderTarget(U,Y);fe.setRenderTarget(pe),fe.render(ie,F),fe.setRenderTarget(null);const Me=new Uint8Array(U*Y*4);fe.readRenderTargetPixels(pe,0,0,U,Y,Me),blobCanvas.width=U,blobCanvas.height=Y;const ve=blobCanvas.getContext("2d"),se=ve.createImageData(U,Y);return se.data.set(Me),ve.putImageData(se,0,0),new Promise(async(me,Te)=>{blobCanvas.toBlob(Re=>{if(!Re)return Te("Failed to capture thumbnail.");me(URL.createObjectURL(Re))},"image/png")})}};var Filter;(function(re){re[re.Nearest=9728]="Nearest",re[re.Linear=9729]="Linear",re[re.NearestMipmapNearest=9984]="NearestMipmapNearest",re[re.LinearMipmapNearest=9985]="LinearMipmapNearest",re[re.NearestMipmapLinear=9986]="NearestMipmapLinear",re[re.LinearMipmapLinear=9987]="LinearMipmapLinear"})(Filter||(Filter={}));var Wrap;(function(re){re[re.ClampToEdge=33071]="ClampToEdge",re[re.MirroredRepeat=33648]="MirroredRepeat",re[re.Repeat=10497]="Repeat"})(Wrap||(Wrap={}));/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wrapModeToWrapping=new Map([[Wrap.Repeat,RepeatWrapping],[Wrap.ClampToEdge,ClampToEdgeWrapping],[Wrap.MirroredRepeat,MirroredRepeatWrapping]]),wrappingToWrapMode=new Map([[RepeatWrapping,Wrap.Repeat],[ClampToEdgeWrapping,Wrap.ClampToEdge],[MirroredRepeatWrapping,Wrap.MirroredRepeat]]),minFilterToMinification=new Map([[Filter.Nearest,NearestFilter],[Filter.Linear,LinearFilter],[Filter.NearestMipmapNearest,NearestMipmapNearestFilter],[Filter.LinearMipmapNearest,LinearMipmapNearestFilter],[Filter.NearestMipmapLinear,NearestMipmapLinearFilter],[Filter.LinearMipmapLinear,LinearMipmapLinearFilter]]),minificationToMinFilter=new Map([[NearestFilter,Filter.Nearest],[LinearFilter,Filter.Linear],[NearestMipmapNearestFilter,Filter.NearestMipmapNearest],[LinearMipmapNearestFilter,Filter.LinearMipmapNearest],[NearestMipmapLinearFilter,Filter.NearestMipmapLinear],[LinearMipmapLinearFilter,Filter.LinearMipmapLinear]]),magFilterToMagnification=new Map([[Filter.Nearest,NearestFilter],[Filter.Linear,LinearFilter]]),magnificationToMagFilter=new Map([[NearestFilter,Filter.Nearest],[LinearFilter,Filter.Linear]]),isMinFilter=re=>minificationToMinFilter.has(re),isMagFilter=re=>magnificationToMagFilter.has(re),isWrapping=re=>wrappingToWrapMode.has(re),isValidSamplerValue=(re,U)=>{switch(re){case"minFilter":return isMinFilter(U);case"magFilter":return isMagFilter(U);case"wrapS":case"wrapT":return isWrapping(U);case"rotation":case"repeat":case"offset":return!0;default:throw new Error(`Cannot configure property "${re}" on Sampler`)}},$threeTexture$1=Symbol("threeTexture"),$threeTextures=Symbol("threeTextures"),$setProperty=Symbol("setProperty");class Sampler extends ThreeDOMElement{get[$threeTexture$1](){var U;return(U=this[$correlatedObjects])===null||U===void 0?void 0:U.values().next().value}get[$threeTextures](){return this[$correlatedObjects]}constructor(U,Y){super(U,new Set(Y?[Y]:[]))}get name(){return this[$threeTexture$1].name||""}get minFilter(){return minificationToMinFilter.get(this[$threeTexture$1].minFilter)}get magFilter(){return magnificationToMagFilter.get(this[$threeTexture$1].magFilter)}get wrapS(){return wrappingToWrapMode.get(this[$threeTexture$1].wrapS)}get wrapT(){return wrappingToWrapMode.get(this[$threeTexture$1].wrapT)}get rotation(){return this[$threeTexture$1].rotation}get scale(){return toVector2D(this[$threeTexture$1].repeat)}get offset(){return toVector2D(this[$threeTexture$1].offset)}setMinFilter(U){this[$setProperty]("minFilter",minFilterToMinification.get(U))}setMagFilter(U){this[$setProperty]("magFilter",magFilterToMagnification.get(U))}setWrapS(U){this[$setProperty]("wrapS",wrapModeToWrapping.get(U))}setWrapT(U){this[$setProperty]("wrapT",wrapModeToWrapping.get(U))}setRotation(U){U==null&&(U=0),this[$setProperty]("rotation",U)}setScale(U){U==null&&(U={u:1,v:1}),this[$setProperty]("repeat",new Vector2(U.u,U.v))}setOffset(U){U==null&&(U={u:0,v:0}),this[$setProperty]("offset",new Vector2(U.u,U.v))}[$setProperty](U,Y){if(isValidSamplerValue(U,Y))for(const ie of this[$threeTextures])ie[U]=Y,ie.needsUpdate=!0;this[$onUpdate$1]()}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $image=Symbol("image"),$sampler=Symbol("sampler"),$threeTexture=Symbol("threeTexture");class Texture extends ThreeDOMElement{constructor(U,Y){super(U,new Set(Y?[Y]:[])),this[$sampler]=new Sampler(U,Y),this[$image]=new Image$1(U,Y)}get[$threeTexture](){var U;return(U=this[$correlatedObjects])===null||U===void 0?void 0:U.values().next().value}get name(){return this[$threeTexture].name||""}set name(U){for(const Y of this[$correlatedObjects])Y.name=U}get sampler(){return this[$sampler]}get source(){return this[$image]}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$4,_b$4,_c$2;const $texture=Symbol("texture"),$transform=Symbol("transform"),$materials$1=Symbol("materials"),$usage=Symbol("usage"),$onUpdate=Symbol("onUpdate"),$activeVideo=Symbol("activeVideo");var TextureUsage;(function(re){re[re.Base=0]="Base",re[re.MetallicRoughness=1]="MetallicRoughness",re[re.Normal=2]="Normal",re[re.Occlusion=3]="Occlusion",re[re.Emissive=4]="Emissive",re[re.Clearcoat=5]="Clearcoat",re[re.ClearcoatRoughness=6]="ClearcoatRoughness",re[re.ClearcoatNormal=7]="ClearcoatNormal",re[re.SheenColor=8]="SheenColor",re[re.SheenRoughness=9]="SheenRoughness",re[re.Transmission=10]="Transmission",re[re.Thickness=11]="Thickness",re[re.Specular=12]="Specular",re[re.SpecularColor=13]="SpecularColor",re[re.Iridescence=14]="Iridescence",re[re.IridescenceThickness=15]="IridescenceThickness",re[re.Anisotropy=16]="Anisotropy"})(TextureUsage||(TextureUsage={}));class TextureInfo{constructor(U,Y,ie,ne){this[_a$4]=null,this[_b$4]={rotation:0,scale:new Vector2(1,1),offset:new Vector2(0,0)},this[_c$2]=!1,ie&&(this[$transform].rotation=ie.rotation,this[$transform].scale.copy(ie.repeat),this[$transform].offset.copy(ie.offset),this[$texture]=new Texture(U,ie)),this[$onUpdate]=U,this[$materials$1]=ne,this[$usage]=Y}get texture(){return this[$texture]}setTexture(U){var Y,ie;const ne=U!=null?U.source[$threeTexture$2]:null,F=(Y=this[$texture])===null||Y===void 0?void 0:Y.source[$threeTexture$2];if(F!=null&&F.isVideoTexture?this[$activeVideo]=!1:!((ie=this[$texture])===null||ie===void 0)&&ie.source.animation&&this[$texture].source.animation.removeEventListener("enterFrame",this[$onUpdate]),this[$texture]=U,ne!=null&&ne.isVideoTexture){const pe=ne.image;if(this[$activeVideo]=!0,pe.requestVideoFrameCallback!=null){const Me=()=>{this[$activeVideo]&&(this[$onUpdate](),pe.requestVideoFrameCallback(Me))};pe.requestVideoFrameCallback(Me)}else{const Me=()=>{this[$activeVideo]&&(this[$onUpdate](),requestAnimationFrame(Me))};requestAnimationFrame(Me)}}else(U==null?void 0:U.source.animation)!=null&&U.source.animation.addEventListener("enterFrame",this[$onUpdate]);let fe=SRGBColorSpace;if(this[$materials$1])for(const pe of this[$materials$1]){switch(this[$usage]){case TextureUsage.Base:pe.map=ne;break;case TextureUsage.MetallicRoughness:fe=LinearSRGBColorSpace,pe.metalnessMap=ne,pe.roughnessMap=ne;break;case TextureUsage.Normal:fe=LinearSRGBColorSpace,pe.normalMap=ne;break;case TextureUsage.Occlusion:fe=LinearSRGBColorSpace,pe.aoMap=ne;break;case TextureUsage.Emissive:pe.emissiveMap=ne;break;case TextureUsage.Clearcoat:pe.clearcoatMap=ne;break;case TextureUsage.ClearcoatRoughness:pe.clearcoatRoughnessMap=ne;break;case TextureUsage.ClearcoatNormal:pe.clearcoatNormalMap=ne;break;case TextureUsage.SheenColor:pe.sheenColorMap=ne;break;case TextureUsage.SheenRoughness:pe.sheenRoughnessMap=ne;break;case TextureUsage.Transmission:pe.transmissionMap=ne;break;case TextureUsage.Thickness:pe.thicknessMap=ne;break;case TextureUsage.Specular:pe.specularIntensityMap=ne;break;case TextureUsage.SpecularColor:pe.specularColorMap=ne;break;case TextureUsage.Iridescence:pe.iridescenceMap=ne;break;case TextureUsage.IridescenceThickness:pe.iridescenceThicknessMap=ne;break;case TextureUsage.Anisotropy:pe.anisotropyMap=ne;break}pe.needsUpdate=!0}ne&&(ne.colorSpace=fe,ne.rotation=this[$transform].rotation,ne.repeat=this[$transform].scale,ne.offset=this[$transform].offset),this[$onUpdate]()}}_a$4=$texture,_b$4=$transform,_c$2=$activeVideo;/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $threeMaterial=Symbol("threeMaterial"),$threeMaterials=Symbol("threeMaterials"),$baseColorTexture=Symbol("baseColorTexture"),$metallicRoughnessTexture=Symbol("metallicRoughnessTexture");class PBRMetallicRoughness extends ThreeDOMElement{constructor(U,Y){super(U,Y);const{map:ie,metalnessMap:ne}=Y.values().next().value;this[$baseColorTexture]=new TextureInfo(U,TextureUsage.Base,ie,Y),this[$metallicRoughnessTexture]=new TextureInfo(U,TextureUsage.MetallicRoughness,ne,Y)}get[$threeMaterials](){return this[$correlatedObjects]}get[$threeMaterial](){var U;return(U=this[$correlatedObjects])===null||U===void 0?void 0:U.values().next().value}get baseColorFactor(){const U=[0,0,0,this[$threeMaterial].opacity];return this[$threeMaterial].color.toArray(U),U}get metallicFactor(){return this[$threeMaterial].metalness}get roughnessFactor(){return this[$threeMaterial].roughness}get baseColorTexture(){return this[$baseColorTexture]}get metallicRoughnessTexture(){return this[$metallicRoughnessTexture]}setBaseColorFactor(U){const Y=new Color;U instanceof Array?Y.fromArray(U):Y.set(U);for(const ie of this[$threeMaterials])ie.color.set(Y),U instanceof Array&&U.length>3?ie.opacity=U[3]:(U=[0,0,0,ie.opacity],Y.toArray(U));this[$onUpdate$1]()}setMetallicFactor(U){for(const Y of this[$threeMaterials])Y.metalness=U;this[$onUpdate$1]()}setRoughnessFactor(U){for(const Y of this[$threeMaterials])Y.roughness=U;this[$onUpdate$1]()}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$3,_b$3;const $pbrMetallicRoughness=Symbol("pbrMetallicRoughness"),$normalTexture=Symbol("normalTexture"),$occlusionTexture=Symbol("occlusionTexture"),$emissiveTexture=Symbol("emissiveTexture"),$backingThreeMaterial=Symbol("backingThreeMaterial"),$applyAlphaCutoff=Symbol("applyAlphaCutoff"),$getAlphaMode=Symbol("getAlphaMode"),$lazyLoadGLTFInfo=Symbol("lazyLoadGLTFInfo"),$initialize=Symbol("initialize"),$getLoadedMaterial=Symbol("getLoadedMaterial"),$ensureMaterialIsLoaded=Symbol("ensureMaterialIsLoaded"),$gltfIndex=Symbol("gltfIndex"),$setActive=Symbol("setActive"),$variantIndices=Symbol("variantIndices"),$isActive=Symbol("isActive"),$modelVariants=Symbol("modelVariants"),$name=Symbol("name"),$pbrTextures=Symbol("pbrTextures");class Material extends ThreeDOMElement{constructor(U,Y,ie,ne,F,fe,pe=void 0){super(U,F),this[_a$3]=new Set,this[_b$3]=new Map,this[$gltfIndex]=Y,this[$isActive]=ie,this[$modelVariants]=ne,this[$name]=fe,pe==null?this[$initialize]():this[$lazyLoadGLTFInfo]=pe}get[(_a$3=$variantIndices,_b$3=$pbrTextures,$backingThreeMaterial)](){return this[$correlatedObjects].values().next().value}[$initialize](){const U=this[$onUpdate$1],Y=this[$correlatedObjects];this[$pbrMetallicRoughness]=new PBRMetallicRoughness(U,Y);const{normalMap:ie,aoMap:ne,emissiveMap:F}=Y.values().next().value;this[$normalTexture]=new TextureInfo(U,TextureUsage.Normal,ie,Y),this[$occlusionTexture]=new TextureInfo(U,TextureUsage.Occlusion,ne,Y),this[$emissiveTexture]=new TextureInfo(U,TextureUsage.Emissive,F,Y);const fe=pe=>{this[$pbrTextures].set(pe,new TextureInfo(U,pe,null,Y))};fe(TextureUsage.Clearcoat),fe(TextureUsage.ClearcoatRoughness),fe(TextureUsage.ClearcoatNormal),fe(TextureUsage.SheenColor),fe(TextureUsage.SheenRoughness),fe(TextureUsage.Transmission),fe(TextureUsage.Thickness),fe(TextureUsage.Specular),fe(TextureUsage.SpecularColor),fe(TextureUsage.Iridescence),fe(TextureUsage.IridescenceThickness),fe(TextureUsage.Anisotropy)}async[$getLoadedMaterial](){if(this[$lazyLoadGLTFInfo]!=null){const U=await this[$lazyLoadGLTFInfo].doLazyLoad();return this[$initialize](),this[$lazyLoadGLTFInfo]=void 0,this.ensureLoaded=async()=>{},U}return null}colorFromRgb(U){const Y=new Color;return U instanceof Array?Y.fromArray(U):Y.set(U),Y}[$ensureMaterialIsLoaded](){if(this[$lazyLoadGLTFInfo]!=null)throw new Error(`Material "${this.name}" has not been loaded, call 'await
    myMaterial.ensureLoaded()' before using an unloaded material.`)}async ensureLoaded(){await this[$getLoadedMaterial]()}get isLoaded(){return this[$lazyLoadGLTFInfo]==null}get isActive(){return this[$isActive]}[$setActive](U){this[$isActive]=U}get name(){return this[$name]||""}set name(U){if(this[$name]=U,this[$correlatedObjects]!=null)for(const Y of this[$correlatedObjects])Y.name=U}get pbrMetallicRoughness(){return this[$ensureMaterialIsLoaded](),this[$pbrMetallicRoughness]}get normalTexture(){return this[$ensureMaterialIsLoaded](),this[$normalTexture]}get occlusionTexture(){return this[$ensureMaterialIsLoaded](),this[$occlusionTexture]}get emissiveTexture(){return this[$ensureMaterialIsLoaded](),this[$emissiveTexture]}get emissiveFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].emissive.toArray()}get index(){return this[$gltfIndex]}hasVariant(U){const Y=this[$modelVariants].get(U);return Y!=null&&this[$variantIndices].has(Y.index)}setEmissiveFactor(U){this[$ensureMaterialIsLoaded]();const Y=this.colorFromRgb(U);for(const ie of this[$correlatedObjects])ie.emissive.set(Y);this[$onUpdate$1]()}[$getAlphaMode](){return this[$backingThreeMaterial].transparent?"BLEND":this[$backingThreeMaterial].alphaTest>0?"MASK":"OPAQUE"}[$applyAlphaCutoff](){this[$ensureMaterialIsLoaded]();for(const U of this[$correlatedObjects])this[$getAlphaMode]()==="MASK"?U.alphaTest==null&&(U.alphaTest=.5):U.alphaTest=void 0,U.needsUpdate=!0}setAlphaCutoff(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.alphaTest=U,Y.needsUpdate=!0;this[$applyAlphaCutoff](),this[$onUpdate$1]()}getAlphaCutoff(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].alphaTest}setDoubleSided(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.side=U?DoubleSide:FrontSide,Y.needsUpdate=!0;this[$onUpdate$1]()}getDoubleSided(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].side==DoubleSide}setAlphaMode(U){this[$ensureMaterialIsLoaded]();const Y=(ie,ne)=>{ie.transparent=ne,ie.depthWrite=!ne};for(const ie of this[$correlatedObjects])Y(ie,U==="BLEND"),U==="MASK"?ie.alphaTest=.5:ie.alphaTest=void 0,ie.needsUpdate=!0;this[$onUpdate$1]()}getAlphaMode(){return this[$ensureMaterialIsLoaded](),this[$getAlphaMode]()}get emissiveStrength(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].emissiveIntensity}setEmissiveStrength(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.emissiveIntensity=U;this[$onUpdate$1]()}get clearcoatFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].clearcoat}get clearcoatRoughnessFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].clearcoatRoughness}get clearcoatTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.Clearcoat)}get clearcoatRoughnessTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.ClearcoatRoughness)}get clearcoatNormalTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.ClearcoatNormal)}get clearcoatNormalScale(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].clearcoatNormalScale.x}setClearcoatFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.clearcoat=U;this[$onUpdate$1]()}setClearcoatRoughnessFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.clearcoatRoughness=U;this[$onUpdate$1]()}setClearcoatNormalScale(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.clearcoatNormalScale=new Vector2(U,U);this[$onUpdate$1]()}get ior(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].ior}setIor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.ior=U;this[$onUpdate$1]()}get sheenColorFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].sheenColor.toArray()}get sheenColorTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.SheenColor)}get sheenRoughnessFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].sheenRoughness}get sheenRoughnessTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.SheenRoughness)}setSheenColorFactor(U){this[$ensureMaterialIsLoaded]();const Y=this.colorFromRgb(U);for(const ie of this[$correlatedObjects])ie.sheenColor.set(Y),ie.sheen=1;this[$onUpdate$1]()}setSheenRoughnessFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.sheenRoughness=U,Y.sheen=1;this[$onUpdate$1]()}get transmissionFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].transmission}get transmissionTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.Transmission)}setTransmissionFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.transmission=U;this[$onUpdate$1]()}get thicknessFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].thickness}get thicknessTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.Thickness)}get attenuationDistance(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].attenuationDistance}get attenuationColor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].attenuationColor.toArray()}setThicknessFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.thickness=U;this[$onUpdate$1]()}setAttenuationDistance(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.attenuationDistance=U;this[$onUpdate$1]()}setAttenuationColor(U){this[$ensureMaterialIsLoaded]();const Y=this.colorFromRgb(U);for(const ie of this[$correlatedObjects])ie.attenuationColor.set(Y);this[$onUpdate$1]()}get specularFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].specularIntensity}get specularTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.Specular)}get specularColorFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].specularColor.toArray()}get specularColorTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.SheenColor)}setSpecularFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.specularIntensity=U;this[$onUpdate$1]()}setSpecularColorFactor(U){this[$ensureMaterialIsLoaded]();const Y=this.colorFromRgb(U);for(const ie of this[$correlatedObjects])ie.specularColor.set(Y);this[$onUpdate$1]()}get iridescenceFactor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].iridescence}get iridescenceTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.Iridescence)}get iridescenceIor(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].iridescenceIOR}get iridescenceThicknessMinimum(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].iridescenceThicknessRange[0]}get iridescenceThicknessMaximum(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].iridescenceThicknessRange[1]}get iridescenceThicknessTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.IridescenceThickness)}setIridescenceFactor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.iridescence=U;this[$onUpdate$1]()}setIridescenceIor(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.iridescenceIOR=U;this[$onUpdate$1]()}setIridescenceThicknessMinimum(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.iridescenceThicknessRange[0]=U;this[$onUpdate$1]()}setIridescenceThicknessMaximum(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.iridescenceThicknessRange[1]=U;this[$onUpdate$1]()}get anisotropyStrength(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].anisotropy}get anisotropyRotation(){return this[$ensureMaterialIsLoaded](),this[$backingThreeMaterial].anisotropyRotation}get anisotropyTexture(){return this[$ensureMaterialIsLoaded](),this[$pbrTextures].get(TextureUsage.Anisotropy)}setAnisotropyStrength(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.anisotropy=U;this[$onUpdate$1]()}setAnisotropyRotation(U){this[$ensureMaterialIsLoaded]();for(const Y of this[$correlatedObjects])Y.anisotropyRotation=U;this[$onUpdate$1]()}}let Node$1=class{constructor(U){this.name="",this.children=new Array,this.name=U}};class PrimitiveNode extends Node$1{constructor(U,Y,ie,ne){super(U.name),this.materials=new Map,this.variantToMaterialMap=new Map,this.initialMaterialIdx=0,this.activeMaterialIdx=0,this.mesh=U;const{gltf:F,threeGLTF:fe,threeObjectMap:pe}=ne;this.parser=fe.parser,this.modelVariants=ie,this.mesh.userData.variantData=ie;const Me=pe.get(U.material);Me.materials!=null?this.initialMaterialIdx=this.activeMaterialIdx=Me.materials:console.error(`Primitive (${U.name}) missing initial material reference.`);const ve=U.userData.associations||{};if(ve.meshes==null){console.error("Mesh is missing primitive index association");return}const Te=((F.meshes||[])[ve.meshes].primitives||[])[ve.primitives];if(Te==null){console.error("Mesh primitive definition is missing.");return}if(Te.material!=null)this.materials.set(Te.material,Y[Te.material]);else{const Re=Y.findIndex(be=>be.name==="Default");Re>=0?this.materials.set(Re,Y[Re]):console.warn("gltfPrimitive has no material!")}if(Te.extensions&&Te.extensions.KHR_materials_variants){const Re=Te.extensions.KHR_materials_variants,Pe=fe.parser.json.extensions.KHR_materials_variants.variants;for(const Le of Re.mappings){const xe=Y[Le.material];this.materials.set(Le.material,xe);for(const Fe of Le.variants){const{name:Oe}=Pe[Fe];this.variantToMaterialMap.set(Fe,xe),xe[$variantIndices].add(Fe),ie.has(Oe)||ie.set(Oe,{name:Oe,index:Fe})}}}}async setActiveMaterial(U){const Y=this.materials.get(U);if(U!==this.activeMaterialIdx){const ie=Y[$correlatedObjects],ne=await Y[$getLoadedMaterial]();ne!=null?this.mesh.material=ne:this.mesh.material=ie.values().next().value,this.parser.assignFinalMaterial(this.mesh),ie.add(this.mesh.material),this.activeMaterialIdx=U}return this.mesh.material}getActiveMaterial(){return this.materials.get(this.activeMaterialIdx)}getMaterial(U){return this.materials.get(U)}async enableVariant(U){if(U==null)return this.setActiveMaterial(this.initialMaterialIdx);if(this.variantToMaterialMap!=null&&this.modelVariants.has(U)){const Y=this.modelVariants.get(U);return this.enableVariantHelper(Y.index)}return null}async enableVariantHelper(U){if(this.variantToMaterialMap!=null&&U!=null){const Y=this.variantToMaterialMap.get(U);if(Y!=null)return this.setActiveMaterial(Y.index)}return null}async instantiateVariants(){if(this.variantToMaterialMap!=null)for(const U of this.variantToMaterialMap.keys()){const Y=this.mesh.userData.variantMaterials.get(U);if(Y.material!=null)continue;const ie=await this.enableVariantHelper(U);ie!=null&&(Y.material=ie)}}get variantInfo(){return this.variantToMaterialMap}addVariant(U,Y){if(!this.ensureVariantIsUnused(Y))return!1;this.modelVariants.has(Y)||this.modelVariants.set(Y,{name:Y,index:this.modelVariants.size});const ne=this.modelVariants.get(Y).index;return U[$variantIndices].add(ne),this.variantToMaterialMap.set(ne,U),this.materials.set(U.index,U),this.updateVariantUserData(ne,U),!0}deleteVariant(U){if(this.variantInfo.has(U)){this.variantInfo.delete(U);const Y=this.mesh.userData.variantMaterials;Y!=null&&Y.delete(U)}}updateVariantUserData(U,Y){Y[$variantIndices].add(U),this.mesh.userData.variantData=this.modelVariants,this.mesh.userData.variantMaterials=this.mesh.userData.variantMaterials||new Map,this.mesh.userData.variantMaterials.set(U,{material:Y[$correlatedObjects].values().next().value,gltfMaterialIndex:Y.index})}ensureVariantIsUnused(U){const Y=this.modelVariants.get(U);return Y!=null&&this.variantInfo.has(Y.index)?(console.warn(`Primitive cannot add variant '${U}' for this material, it already exists.`),!1):!0}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a$2,_b$2,_c$1,_d$1,_e$1,_f$1;const $materials=Symbol("materials"),$hierarchy=Symbol("hierarchy"),$roots=Symbol("roots"),$primitivesList=Symbol("primitives"),$prepareVariantsForExport=Symbol("prepareVariantsForExport"),$switchVariant=Symbol("switchVariant"),$materialFromPoint=Symbol("materialFromPoint"),$nodeFromPoint=Symbol("nodeFromPoint"),$nodeFromIndex=Symbol("nodeFromIndex"),$variantData=Symbol("variantData"),$availableVariants=Symbol("availableVariants"),$modelOnUpdate=Symbol("modelOnUpdate"),$cloneMaterial=Symbol("cloneMaterial");class LazyLoader{constructor(U,Y,ie,ne){this.gltf=U,this.gltfElementMap=Y,this.mapKey=ie,this.doLazyLoad=ne}}class Model{constructor(U,Y=()=>{}){this[_a$2]=new Array,this[_b$2]=new Array,this[_c$1]=new Array,this[_d$1]=new Array,this[_e$1]=()=>{},this[_f$1]=new Map,this[$modelOnUpdate]=Y;const{gltf:ie,threeGLTF:ne,gltfElementMap:F}=U;for(const[Me,ve]of ie.materials.entries()){const se=F.get(ve);if(se!=null)this[$materials].push(new Material(Y,Me,!0,this[$variantData],se,ve.name));else{const Te=(ie.materials||[])[Me],Re=new Set;F.set(Te,Re);const be=async()=>{const Pe=await ne.parser.getDependency("material",Me);return Re.add(Pe),Pe};this[$materials].push(new Material(Y,Me,!1,this[$variantData],Re,ve.name,new LazyLoader(ie,F,Te,be)))}}const fe=new Map,pe=new Array;for(const Me of ne.scene.children)pe.push(Me);for(;pe.length>0;){const Me=pe.pop();let ve=null;Me instanceof Mesh?(ve=new PrimitiveNode(Me,this.materials,this[$variantData],U),this[$primitivesList].push(ve)):ve=new Node$1(Me.name);const se=fe.get(Me);se!=null?se.children.push(ve):this[$roots].push(ve),this[$hierarchy].push(ve);for(const me of Me.children)pe.push(me),fe.set(Me,ve)}}get materials(){return this[$materials]}[(_a$2=$materials,_b$2=$hierarchy,_c$1=$roots,_d$1=$primitivesList,_e$1=$modelOnUpdate,_f$1=$variantData,$availableVariants)](){const U=Array.from(this[$variantData].values());return U.sort((Y,ie)=>Y.index-ie.index),U.map(Y=>Y.name)}getMaterialByName(U){const Y=this[$materials].filter(ie=>ie.name===U);return Y.length>0?Y[0]:null}[$nodeFromIndex](U,Y){const ie=this[$hierarchy].find(ne=>{if(ne instanceof PrimitiveNode){const{meshes:F,primitives:fe}=ne.mesh.userData.associations;if(F==U&&fe==Y)return!0}return!1});return ie??null}[$nodeFromPoint](U){return this[$hierarchy].find(Y=>Y instanceof PrimitiveNode&&Y.mesh===U.object)}[$materialFromPoint](U){return this[$nodeFromPoint](U).getActiveMaterial()}async[$switchVariant](U){for(const Y of this[$primitivesList])await Y.enableVariant(U);for(const Y of this.materials)Y[$setActive](!1);for(const Y of this[$primitivesList])this.materials[Y.getActiveMaterial().index][$setActive](!0)}async[$prepareVariantsForExport](){const U=new Array;for(const Y of this[$primitivesList])U.push(Y.instantiateVariants());await Promise.all(U)}[$cloneMaterial](U,Y){const ie=this.materials[U];ie.isLoaded||console.error(`Cloning an unloaded material,
           call 'material.ensureLoaded() before cloning the material.`);const ne=ie[$correlatedObjects],F=new Set;for(const[pe,Me]of ne.entries()){const ve=Me.clone();ve.name=Y+(ne.size>1?"_inst"+pe:""),F.add(ve)}const fe=new Material(this[$modelOnUpdate],this[$materials].length,!1,this[$variantData],F,Y);return this[$materials].push(fe),fe}createMaterialInstanceForVariant(U,Y,ie,ne=!0){let F=null;for(const fe of this[$primitivesList]){const pe=this[$variantData].get(ie);pe!=null&&fe.variantInfo.has(pe.index)||fe.getMaterial(U)!=null&&(this.hasVariant(ie)||this.createVariant(ie),F==null&&(F=this[$cloneMaterial](U,Y)),fe.addVariant(F,ie))}if(ne&&F!=null){F[$setActive](!0),this.materials[U][$setActive](!1);for(const fe of this[$primitivesList])fe.enableVariant(ie)}return F}createVariant(U){this[$variantData].has(U)?console.warn(`Variant '${U}'' already exists`):this[$variantData].set(U,{name:U,index:this[$variantData].size})}hasVariant(U){return this[$variantData].has(U)}setMaterialToVariant(U,Y){if(this[$availableVariants]().find(ie=>ie===Y)==null){console.warn(`Can't add material to '${Y}', the variant does not exist.'`);return}if(U<0||U>=this.materials.length){console.error("setMaterialToVariant(): materialIndex is out of bounds.");return}for(const ie of this[$primitivesList]){const ne=ie.getMaterial(U);ne!=null&&ie.addVariant(ne,Y)}}updateVariantName(U,Y){const ie=this[$variantData].get(U);ie!=null&&(ie.name=Y,this[$variantData].set(Y,ie),this[$variantData].delete(U))}deleteVariant(U){const Y=this[$variantData].get(U);if(Y!=null){for(const ie of this.materials)ie.hasVariant(U)&&ie[$variantIndices].delete(Y.index);for(const ie of this[$primitivesList])ie.deleteVariant(Y.index);this[$variantData].delete(U)}}}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$5=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};const $currentGLTF=Symbol("currentGLTF"),$originalGltfJson=Symbol("originalGltfJson"),$model=Symbol("model"),$getOnUpdateMethod=Symbol("getOnUpdateMethod"),$buildTexture=Symbol("buildTexture"),SceneGraphMixin=re=>{var U,Y,ie;class ne extends re{constructor(){super(...arguments),this[U]=void 0,this[Y]=null,this[ie]=null,this.variantName=null,this.orientation="0 0 0",this.scale="1 1 1"}get model(){return this[$model]}get availableVariants(){return this.model?this.model[$availableVariants]():[]}get originalGltfJson(){return this[$originalGltfJson]}[(U=$model,Y=$currentGLTF,ie=$originalGltfJson,$getOnUpdateMethod)](){return()=>{this[$needsRender]()}}[$buildTexture](fe){return fe.colorSpace=SRGBColorSpace,fe.wrapS=RepeatWrapping,fe.wrapT=RepeatWrapping,new Texture(this[$getOnUpdateMethod](),fe)}async createTexture(fe,pe="image/png"){const{textureUtils:Me}=this[$renderer],ve=await Me.loadImage(fe,this.withCredentials);return ve.userData.mimeType=pe,this[$buildTexture](ve)}async createLottieTexture(fe,pe=1){const{textureUtils:Me}=this[$renderer],ve=await Me.loadLottie(fe,pe,this.withCredentials);return this[$buildTexture](ve)}createVideoTexture(fe){const pe=document.createElement("video");pe.crossOrigin=this.withCredentials?"use-credentials":"anonymous",pe.src=fe,pe.muted=!0,pe.playsInline=!0,pe.loop=!0,pe.play();const Me=new VideoTexture(pe);return this[$buildTexture](Me)}createCanvasTexture(){const fe=document.createElement("canvas"),pe=new CanvasTexture(fe);return this[$buildTexture](pe)}async updated(fe){if(super.updated(fe),fe.has("variantName")){const pe=this[$progressTracker].beginActivity("variant-update");pe(.1);const Me=this[$model],{variantName:ve}=this;Me!=null&&(await Me[$switchVariant](ve),this[$needsRender](),this.dispatchEvent(new CustomEvent("variant-applied"))),pe(1)}if(fe.has("orientation")||fe.has("scale")){if(!this.loaded)return;const pe=this[$scene];pe.applyTransform(),pe.updateBoundingBox(),pe.updateShadow(),this[$renderer].arRenderer.onUpdateScene(),this[$needsRender]()}}[$onModelLoad](){super[$onModelLoad]();const{currentGLTF:fe}=this[$scene];if(fe!=null){const{correlatedSceneGraph:pe}=fe;pe!=null&&fe!==this[$currentGLTF]&&(this[$model]=new Model(pe,this[$getOnUpdateMethod]()),this[$originalGltfJson]=JSON.parse(JSON.stringify(pe.gltf))),"variants"in fe.userData&&this.requestUpdate("variantName")}this[$currentGLTF]=fe}async exportScene(fe){const pe=this[$scene];return new Promise(async(Me,ve)=>{const se={binary:!0,onlyVisible:!0,maxTextureSize:1/0,includeCustomExtensions:!1,forceIndices:!1};Object.assign(se,fe),se.animations=pe.animations,se.truncateDrawRange=!0;const me=pe.shadow;let Te=!1;me!=null&&(Te=me.visible,me.visible=!1),await this[$model][$prepareVariantsForExport](),new GLTFExporter().register(be=>new GLTFExporterMaterialsVariantsExtension(be)).parse(pe.model,be=>Me(new Blob([se.binary?be:JSON.stringify(be)],{type:se.binary?"application/octet-stream":"application/json"})),()=>ve("glTF export failed"),se),me!=null&&(me.visible=Te)})}materialFromPoint(fe,pe){const Me=this[$model];if(Me==null)return null;const ve=this[$scene],se=ve.getNDC(fe,pe),me=ve.hitFromPoint(se);return me==null||me.face==null?null:Me[$materialFromPoint](me)}}return __decorate$5([n$6({type:String,attribute:"variant-name"})],ne.prototype,"variantName",void 0),__decorate$5([n$6({type:String,attribute:"orientation"})],ne.prototype,"orientation",void 0),__decorate$5([n$6({type:String,attribute:"scale"})],ne.prototype,"scale",void 0),ne};/* @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GroundedSkybox extends Mesh{constructor(){super(void 0,new MeshBasicMaterial({depthWrite:!1})),this.height=0,this.radius=0,this.resolution=0,this.userData.noHit=!0}get map(){return this.material.map}set map(U){this.material.map=U}isUsable(){return this.height>0&&this.radius>0&&this.geometry!=null&&this.map!=null}updateGeometry(U=this.height,Y=this.radius,ie=128){(U!=this.height||Y!=this.radius||ie!=this.resolution)&&(this.height=U,this.radius=Y,this.resolution=ie,U>0&&Y>0&&(this.geometry.dispose(),this.geometry=makeGeometry(U,Y,ie)))}}function makeGeometry(re,U,Y){const ie=new SphereGeometry(U,2*Y,Y);ie.scale(1,1,-1);const ne=ie.getAttribute("position"),F=new Vector3;for(let fe=0;fe<ne.count;++fe)if(F.fromBufferAttribute(ne,fe),F.y<0){const pe=-re*3/2,Me=F.y<pe?-re/F.y:1-F.y*F.y/(3*pe*pe);F.multiplyScalar(Me),F.toArray(ne.array,3*fe)}return ne.needsUpdate=!0,ie}/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a=new Vector3,b=new Vector3,c=new Vector3,mat=new Matrix3,triangle=new Triangle,quat=new Quaternion;class Hotspot extends CSS2DObject{constructor(U){super(document.createElement("div")),this.normal=new Vector3(0,1,0),this.initialized=!1,this.referenceCount=1,this.pivot=document.createElement("div"),this.slot=document.createElement("slot"),this.element.classList.add("annotation-wrapper"),this.slot.name=U.name,this.element.appendChild(this.pivot),this.pivot.appendChild(this.slot),this.updatePosition(U.position),this.updateNormal(U.normal),this.surface=U.surface}get facingCamera(){return!this.element.classList.contains("hide")}show(){(!this.facingCamera||!this.initialized)&&this.updateVisibility(!0)}hide(){(this.facingCamera||!this.initialized)&&this.updateVisibility(!1)}increment(){this.referenceCount++}decrement(){return this.referenceCount>0&&--this.referenceCount,this.referenceCount===0}updatePosition(U){if(U==null)return;const Y=parseExpressions(U)[0].terms;for(let ie=0;ie<3;++ie)this.position.setComponent(ie,normalizeUnit(Y[ie]).number);this.updateMatrixWorld()}updateNormal(U){if(U==null)return;const Y=parseExpressions(U)[0].terms;for(let ie=0;ie<3;++ie)this.normal.setComponent(ie,Y[ie].number)}updateSurface(){const{mesh:U,tri:Y,bary:ie}=this;if(U==null||Y==null||ie==null)return;U.getVertexPosition(Y.x,a),U.getVertexPosition(Y.y,b),U.getVertexPosition(Y.z,c),a.toArray(mat.elements,0),b.toArray(mat.elements,3),c.toArray(mat.elements,6),this.position.copy(ie).applyMatrix3(mat);const ne=this.parent;ne.worldToLocal(U.localToWorld(this.position)),triangle.set(a,b,c),triangle.getNormal(this.normal).transformDirection(U.matrixWorld);const F=ne.parent;quat.setFromAxisAngle(a.set(0,1,0),-F.rotation.y),this.normal.applyQuaternion(quat)}orient(U){this.pivot.style.transform=`rotate(${U}rad)`}updateVisibility(U){this.element.classList.toggle("hide",!U),this.slot.assignedNodes().forEach(Y=>{if(Y.nodeType!==Node.ELEMENT_NODE)return;const ie=Y,ne=ie.dataset.visibilityAttribute;if(ne!=null){const F=`data-${ne}`;ie.toggleAttribute(F,U)}ie.dispatchEvent(new CustomEvent("hotspot-visibility",{detail:{visible:U}}))}),this.initialized=!0}}const HorizontalBlurShader={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float h;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

			gl_FragColor = sum;

		}`},VerticalBlurShader={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float v;

		varying vec2 vUv;

		void main() {

			vec4 sum = vec4( 0.0 );

			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
			sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

			gl_FragColor = sum;

		}`};function lerp(re,U,Y){return(1-Y)*re+Y*U}/* @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LOG_MAX_RESOLUTION=9,LOG_MIN_RESOLUTION=6,ANIMATION_SCALING=2,DEFAULT_HARD_INTENSITY=.3;class Shadow extends Object3D{constructor(U,Y,ie){super(),this.camera=new OrthographicCamera,this.renderTarget=null,this.renderTargetBlur=null,this.depthMaterial=new MeshDepthMaterial,this.horizontalBlurMaterial=new ShaderMaterial(HorizontalBlurShader),this.verticalBlurMaterial=new ShaderMaterial(VerticalBlurShader),this.intensity=0,this.softness=1,this.boundingBox=new Box3,this.size=new Vector3,this.maxDimension=0,this.isAnimated=!1,this.needsUpdate=!1;const{camera:ne}=this;ne.rotation.x=Math.PI/2,ne.left=-.5,ne.right=.5,ne.bottom=-.5,ne.top=.5,this.add(ne);const F=new PlaneGeometry,fe=new MeshBasicMaterial({opacity:1,transparent:!0,side:BackSide});this.floor=new Mesh(F,fe),this.floor.userData.noHit=!0,ne.add(this.floor),this.blurPlane=new Mesh(F),this.blurPlane.visible=!1,ne.add(this.blurPlane),U.target.add(this),this.depthMaterial.onBeforeCompile=function(pe){pe.fragmentShader=pe.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * opacity );")},this.horizontalBlurMaterial.depthTest=!1,this.verticalBlurMaterial.depthTest=!1,this.setScene(U,Y,ie)}setScene(U,Y,ie){const{boundingBox:ne,size:F,rotation:fe,position:pe}=this;if(this.isAnimated=U.animationNames.length>0,this.boundingBox.copy(U.boundingBox),this.size.copy(U.size),this.maxDimension=Math.max(F.x,F.y,F.z)*(this.isAnimated?ANIMATION_SCALING:1),this.boundingBox.getCenter(pe),ie==="back"){const{min:Me,max:ve}=ne;[Me.y,Me.z]=[Me.z,Me.y],[ve.y,ve.z]=[ve.z,ve.y],[F.y,F.z]=[F.z,F.y],fe.x=Math.PI/2,fe.y=Math.PI}else fe.x=0,fe.y=0;if(this.isAnimated){const Me=ne.min.y,ve=ne.max.y;F.y=this.maxDimension,ne.expandByVector(F.subScalar(this.maxDimension).multiplyScalar(-.5)),ne.min.y=Me,ne.max.y=ve,F.set(this.maxDimension,ve-Me,this.maxDimension)}ie==="bottom"?pe.y=ne.min.y:pe.z=ne.min.y,this.setSoftness(Y)}setSoftness(U){this.softness=U;const{size:Y,camera:ie}=this,ne=this.isAnimated?ANIMATION_SCALING:1,F=ne*Math.pow(2,LOG_MAX_RESOLUTION-U*(LOG_MAX_RESOLUTION-LOG_MIN_RESOLUTION));this.setMapSize(F);const fe=Y.y/2,pe=Y.y*ne;ie.near=0,ie.far=lerp(pe,fe,U),this.depthMaterial.opacity=1/U,ie.updateProjectionMatrix(),this.setIntensity(this.intensity),this.setOffset(0)}setMapSize(U){const{size:Y}=this;this.isAnimated&&(U*=ANIMATION_SCALING);const ie=Math.floor(Y.x>Y.z?U:U*Y.x/Y.z),ne=Math.floor(Y.x>Y.z?U*Y.z/Y.x:U),F=10,fe=F+ie,pe=F+ne;if(this.renderTarget!=null&&(this.renderTarget.width!==fe||this.renderTarget.height!==pe)&&(this.renderTarget.dispose(),this.renderTarget=null,this.renderTargetBlur.dispose(),this.renderTargetBlur=null),this.renderTarget==null){const Me={format:RGBAFormat};this.renderTarget=new WebGLRenderTarget(fe,pe,Me),this.renderTargetBlur=new WebGLRenderTarget(fe,pe,Me),this.floor.material.map=this.renderTarget.texture}this.camera.scale.set(Y.x*(1+F/ie),Y.z*(1+F/ne),1),this.needsUpdate=!0}setIntensity(U){this.intensity=U,U>0?(this.visible=!0,this.floor.visible=!0,this.floor.material.opacity=U*lerp(DEFAULT_HARD_INTENSITY,1,this.softness*this.softness)):(this.visible=!1,this.floor.visible=!1)}getIntensity(){return this.intensity}setOffset(U){this.floor.position.z=-U+this.gap()}gap(){return .001*this.maxDimension}render(U,Y){Y.overrideMaterial=this.depthMaterial;const ie=U.getClearAlpha();U.setClearAlpha(0),this.floor.visible=!1;const ne=U.xr.enabled;U.xr.enabled=!1;const F=U.getRenderTarget();U.setRenderTarget(this.renderTarget),U.render(Y,this.camera),Y.overrideMaterial=null,this.floor.visible=!0,this.blurShadow(U),U.xr.enabled=ne,U.setRenderTarget(F),U.setClearAlpha(ie)}blurShadow(U){const{camera:Y,horizontalBlurMaterial:ie,verticalBlurMaterial:ne,renderTarget:F,renderTargetBlur:fe,blurPlane:pe}=this;pe.visible=!0,pe.material=ie,ie.uniforms.h.value=1/this.renderTarget.width,ie.uniforms.tDiffuse.value=this.renderTarget.texture,U.setRenderTarget(fe),U.render(pe,Y),pe.material=ne,ne.uniforms.v.value=1/this.renderTarget.height,ne.uniforms.tDiffuse.value=this.renderTargetBlur.texture,U.setRenderTarget(F),U.render(pe,Y),pe.visible=!1}dispose(){this.renderTarget!=null&&this.renderTarget.dispose(),this.renderTargetBlur!=null&&this.renderTargetBlur.dispose(),this.depthMaterial.dispose(),this.horizontalBlurMaterial.dispose(),this.verticalBlurMaterial.dispose(),this.floor.material.dispose(),this.floor.geometry.dispose(),this.blurPlane.geometry.dispose(),this.removeFromParent()}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GROUNDED_SKYBOX_SIZE=10,MIN_SHADOW_RATIO=100,view=new Vector3,target=new Vector3,normalWorld=new Vector3,raycaster=new Raycaster,vector3=new Vector3,ndc=new Vector2;class ModelScene extends Scene{constructor({canvas:U,element:Y,width:ie,height:ne}){super(),this.annotationRenderer=new CSS2DRenderer,this.effectRenderer=null,this.schemaElement=document.createElement("script"),this.width=1,this.height=1,this.aspect=1,this.scaleStep=0,this.renderCount=0,this.externalRenderer=null,this.camera=new PerspectiveCamera(45,1,.1,100),this.xrCamera=null,this.url=null,this.pivot=new Object3D,this.target=new Object3D,this.animationNames=[],this.boundingBox=new Box3,this.boundingSphere=new Sphere,this.size=new Vector3,this.idealAspect=0,this.framedFoVDeg=0,this.shadow=null,this.shadowIntensity=0,this.shadowSoftness=1,this.bakedShadows=new Set,this.exposure=1,this.toneMapping=ACESFilmicToneMapping,this.canScale=!0,this.isDirty=!1,this.goalTarget=new Vector3,this.targetDamperX=new Damper,this.targetDamperY=new Damper,this.targetDamperZ=new Damper,this._currentGLTF=null,this._model=null,this.cancelPendingSourceChange=null,this.animationsByName=new Map,this.currentAnimationAction=null,this.groundedSkybox=new GroundedSkybox,this.name="ModelScene",this.element=Y,this.canvas=U,this.camera=new PerspectiveCamera(45,1,.1,100),this.camera.name="MainCamera",this.add(this.pivot),this.pivot.name="Pivot",this.pivot.add(this.target),this.setSize(ie,ne),this.target.name="Target",this.mixer=new AnimationMixer(this.target);const{domElement:F}=this.annotationRenderer,{style:fe}=F;fe.display="none",fe.pointerEvents="none",fe.position="absolute",fe.top="0",this.element.shadowRoot.querySelector(".default").appendChild(F),this.schemaElement.setAttribute("type","application/ld+json")}get context(){return this.canvas.getContext("2d")}getCamera(){return this.xrCamera!=null?this.xrCamera:this.camera}queueRender(){this.isDirty=!0}shouldRender(){return this.isDirty}hasRendered(){this.isDirty=!1}forceRescale(){this.scaleStep=-1,this.queueRender()}async setObject(U){this.reset(),this._model=U,this.target.add(U),await this.setupScene()}async setSource(U,Y=()=>{}){if(!U||U===this.url){Y(1);return}if(this.reset(),this.url=U,this.externalRenderer!=null){const pe=await this.externalRenderer.load(Y);this.boundingSphere.radius=pe.framedRadius,this.idealAspect=pe.fieldOfViewAspect;return}this.cancelPendingSourceChange!=null&&(this.cancelPendingSourceChange(),this.cancelPendingSourceChange=null);let ie;try{ie=await new Promise(async(pe,Me)=>{this.cancelPendingSourceChange=()=>Me();try{const ve=await this.element[$renderer].loader.load(U,this.element,Y);pe(ve)}catch(ve){Me(ve)}})}catch(pe){if(pe==null)return;throw pe}this.cancelPendingSourceChange=null,this.reset(),this.url=U,this._currentGLTF=ie,ie!=null&&(this._model=ie.scene,this.target.add(ie.scene));const{animations:ne}=ie,F=new Map,fe=[];for(const pe of ne)F.set(pe.name,pe),fe.push(pe.name);this.animations=ne,this.animationsByName=F,this.animationNames=fe,await this.setupScene()}async setupScene(){this.applyTransform(),this.updateBoundingBox(),await this.updateFraming(),this.updateShadow(),this.setShadowIntensity(this.shadowIntensity),this.setGroundedSkybox()}reset(){this.url=null,this.renderCount=0,this.queueRender(),this.shadow!=null&&this.shadow.setIntensity(0),this.bakedShadows.clear();const{_model:U}=this;U!=null&&(U.removeFromParent(),this._model=null);const Y=this._currentGLTF;Y!=null&&(Y.dispose(),this._currentGLTF=null),this.currentAnimationAction!=null&&(this.currentAnimationAction.stop(),this.currentAnimationAction=null),this.mixer.stopAllAction(),this.mixer.uncacheRoot(this)}dispose(){this.reset(),this.shadow!=null&&(this.shadow.dispose(),this.shadow=null),this.element[$currentGLTF]=null,this.element[$originalGltfJson]=null,this.element[$model]=null}get currentGLTF(){return this._currentGLTF}setSize(U,Y){if(!(this.width===U&&this.height===Y)){if(this.width=Math.max(U,1),this.height=Math.max(Y,1),this.annotationRenderer.setSize(U,Y),this.aspect=this.width/this.height,this.externalRenderer!=null){const ie=window.devicePixelRatio;this.externalRenderer.resize(U*ie,Y*ie)}this.queueRender()}}markBakedShadow(U){U.userData.noHit=!0,this.bakedShadows.add(U)}unmarkBakedShadow(U){U.userData.noHit=!1,U.visible=!0,this.bakedShadows.delete(U),this.boundingBox.expandByObject(U)}findBakedShadows(U){const Y=new Box3;U.traverse(ie=>{const ne=ie;if(!ne.material||!ne.material.transparent)return;Y.setFromObject(ne);const fe=Y.getSize(vector3),pe=Math.min(fe.x,fe.y,fe.z);Math.max(fe.x,fe.y,fe.z)<MIN_SHADOW_RATIO*pe||this.markBakedShadow(ne)})}checkBakedShadows(){const{min:U,max:Y}=this.boundingBox,ie=new Box3;this.boundingBox.getSize(this.size);for(const ne of this.bakedShadows)ie.setFromObject(ne),!(ie.min.y<U.y+this.size.y/MIN_SHADOW_RATIO&&ie.min.x<=U.x&&ie.max.x>=Y.x&&ie.min.z<=U.z&&ie.max.z>=Y.z)&&(ie.min.z<U.z+this.size.z/MIN_SHADOW_RATIO&&ie.min.x<=U.x&&ie.max.x>=Y.x&&ie.min.y<=U.y&&ie.max.y>=Y.y||this.unmarkBakedShadow(ne))}applyTransform(){const{model:U}=this;if(U==null)return;const Y=parseExpressions(this.element.orientation)[0].terms,ie=normalizeUnit(Y[0]).number,ne=normalizeUnit(Y[1]).number,F=normalizeUnit(Y[2]).number;U.quaternion.setFromEuler(new Euler(ne,F,ie,"YXZ"));const fe=parseExpressions(this.element.scale)[0].terms;U.scale.set(fe[0].number,fe[1].number,fe[2].number)}updateBoundingBox(){const{model:U}=this;if(U==null)return;this.target.remove(U),this.findBakedShadows(U);const Y=(ie,ne)=>ie.expandByPoint(ne);this.setBakedShadowVisibility(!1),this.boundingBox=reduceVertices(U,Y,new Box3),this.boundingBox.isEmpty()&&(this.setBakedShadowVisibility(!0),this.bakedShadows.forEach(ie=>this.unmarkBakedShadow(ie)),this.boundingBox=reduceVertices(U,Y,new Box3)),this.checkBakedShadows(),this.setBakedShadowVisibility(),this.boundingBox.getSize(this.size),this.target.add(U)}async updateFraming(){const{model:U}=this;if(U==null)return;this.target.remove(U),this.setBakedShadowVisibility(!1);const{center:Y}=this.boundingSphere;this.element.requestUpdate("cameraTarget"),await this.element.updateComplete,Y.copy(this.getTarget());const ie=(F,fe)=>Math.max(F,Y.distanceToSquared(fe));this.boundingSphere.radius=Math.sqrt(reduceVertices(U,ie,0));const ne=(F,fe)=>{fe.sub(Y);const pe=Math.sqrt(fe.x*fe.x+fe.z*fe.z);return Math.max(F,pe/(this.idealCameraDistance()-Math.abs(fe.y)))};this.idealAspect=reduceVertices(U,ne,0)/Math.tan(this.framedFoVDeg/2*Math.PI/180),this.setBakedShadowVisibility(),this.target.add(U)}setBakedShadowVisibility(U=this.shadowIntensity<=0){for(const Y of this.bakedShadows)Y.visible=U}idealCameraDistance(){const U=this.framedFoVDeg/2*Math.PI/180;return this.boundingSphere.radius/Math.sin(U)}adjustedFoV(U){const Y=Math.tan(U/2*Math.PI/180)*Math.max(1,this.idealAspect/this.aspect);return 2*Math.atan(Y)*180/Math.PI}getNDC(U,Y){if(this.xrCamera!=null)ndc.set(U/window.screen.width,Y/window.screen.height);else{const ie=this.element.getBoundingClientRect();ndc.set((U-ie.x)/this.width,(Y-ie.y)/this.height)}return ndc.multiplyScalar(2).subScalar(1),ndc.y*=-1,ndc}getSize(){return{width:this.width,height:this.height}}setEnvironmentAndSkybox(U,Y){this.element[$renderer].arRenderer.presentedScene!==this&&(this.environment=U,this.setBackground(Y),this.queueRender())}setBackground(U){this.groundedSkybox.map=U,this.groundedSkybox.isUsable()?(this.target.add(this.groundedSkybox),this.background=null):(this.target.remove(this.groundedSkybox),this.background=U)}farRadius(){return this.boundingSphere.radius*(this.groundedSkybox.parent!=null?GROUNDED_SKYBOX_SIZE:1)}setGroundedSkybox(){const U=parseExpressions(this.element.skyboxHeight)[0].terms[0],Y=normalizeUnit(U).number,ie=GROUNDED_SKYBOX_SIZE*this.boundingSphere.radius;this.groundedSkybox.updateGeometry(Y,ie),this.groundedSkybox.position.y=Y-(this.shadow?2*this.shadow.gap():0),this.setBackground(this.groundedSkybox.map)}setTarget(U,Y,ie){this.goalTarget.set(-U,-Y,-ie)}setTargetDamperDecayTime(U){this.targetDamperX.setDecayTime(U),this.targetDamperY.setDecayTime(U),this.targetDamperZ.setDecayTime(U)}getTarget(){return this.goalTarget.clone().multiplyScalar(-1)}getDynamicTarget(){return this.target.position.clone().multiplyScalar(-1)}jumpToGoal(){this.updateTarget(SETTLING_TIME)}updateTarget(U){const Y=this.goalTarget,ie=this.target.position;if(Y.equals(ie))return!1;{const ne=this.boundingSphere.radius/10;let{x:F,y:fe,z:pe}=ie;return F=this.targetDamperX.update(F,Y.x,U,ne),fe=this.targetDamperY.update(fe,Y.y,U,ne),pe=this.targetDamperZ.update(pe,Y.z,U,ne),this.groundedSkybox.position.x=-F,this.groundedSkybox.position.z=-pe,this.target.position.set(F,fe,pe),this.target.updateMatrixWorld(),this.queueRender(),!0}}pointTowards(U,Y){const{x:ie,z:ne}=this.position;this.yaw=Math.atan2(U-ie,Y-ne)}get model(){return this._model}set yaw(U){this.pivot.rotation.y=U,this.groundedSkybox.rotation.y=-U,this.queueRender()}get yaw(){return this.pivot.rotation.y}set animationTime(U){this.mixer.setTime(U),this.queueShadowRender()}get animationTime(){if(this.currentAnimationAction!=null){const U=Math.max(this.currentAnimationAction._loopCount,0);return this.currentAnimationAction.loop===LoopPingPong&&(U&1)===1?this.duration-this.currentAnimationAction.time:this.currentAnimationAction.time}return 0}set animationTimeScale(U){this.mixer.timeScale=U}get animationTimeScale(){return this.mixer.timeScale}get duration(){return this.currentAnimationAction!=null&&this.currentAnimationAction.getClip()?this.currentAnimationAction.getClip().duration:0}get hasActiveAnimation(){return this.currentAnimationAction!=null}playAnimation(U=null,Y=0,ie=LoopRepeat,ne=1/0){if(this._currentGLTF==null)return;const{animations:F}=this;if(F==null||F.length===0)return;let fe=null;if(U!=null&&(fe=this.animationsByName.get(U),fe==null)){const pe=parseInt(U);!isNaN(pe)&&pe>=0&&pe<F.length&&(fe=F[pe])}fe==null&&(fe=F[0]);try{const{currentAnimationAction:pe}=this,Me=this.mixer.clipAction(fe,this);this.currentAnimationAction=Me,this.element.paused?this.mixer.stopAllAction():(Me.paused=!1,pe!=null&&Me!==pe?Me.crossFadeFrom(pe,Y,!1):this.animationTimeScale>0&&this.animationTime==this.duration&&(this.animationTime=0)),Me.setLoop(ie,ne),Me.enabled=!0,Me.clampWhenFinished=!0,Me.play()}catch(pe){console.error(pe)}}stopAnimation(){this.currentAnimationAction=null,this.mixer.stopAllAction()}updateAnimation(U){this.mixer.update(U),this.queueShadowRender()}subscribeMixerEvent(U,Y){this.mixer.addEventListener(U,Y)}updateShadow(){const U=this.shadow;if(U!=null){const Y=this.element.arPlacement==="wall"?"back":"bottom";U.setScene(this,this.shadowSoftness,Y),U.needsUpdate=!0}}renderShadow(U){const Y=this.shadow;Y!=null&&Y.needsUpdate==!0&&(Y.render(U,this),Y.needsUpdate=!1)}queueShadowRender(){this.shadow!=null&&(this.shadow.needsUpdate=!0)}setShadowIntensity(U){if(this.shadowIntensity=U,this._currentGLTF!=null&&(this.setBakedShadowVisibility(),!(U<=0&&this.shadow==null))){if(this.shadow==null){const Y=this.element.arPlacement==="wall"?"back":"bottom";this.shadow=new Shadow(this,this.shadowSoftness,Y)}this.shadow.setIntensity(U)}}setShadowSoftness(U){this.shadowSoftness=U;const Y=this.shadow;Y!=null&&Y.setSoftness(U)}setShadowOffset(U){const Y=this.shadow;Y!=null&&Y.setOffset(U)}getHit(U=this){return raycaster.intersectObject(U,!0).find(ie=>ie.object.visible&&!ie.object.userData.noHit)}hitFromController(U,Y=this){return raycaster.setFromXRController(U),this.getHit(Y)}hitFromPoint(U,Y=this){return raycaster.setFromCamera(U,this.getCamera()),this.getHit(Y)}positionAndNormalFromPoint(U,Y=this){var ie;const ne=this.hitFromPoint(U,Y);if(ne==null)return null;const F=ne.point,fe=ne.face!=null?ne.face.normal.clone().applyNormalMatrix(new Matrix3().getNormalMatrix(ne.object.matrixWorld)):raycaster.ray.direction.clone().multiplyScalar(-1),pe=(ie=ne.uv)!==null&&ie!==void 0?ie:null;return{position:F,normal:fe,uv:pe}}surfaceFromPoint(U,Y=this){const ie=this.element.model;if(ie==null)return null;const ne=this.hitFromPoint(U,Y);if(ne==null||ne.face==null)return null;const F=ie[$nodeFromPoint](ne),{meshes:fe,primitives:pe}=F.mesh.userData.associations,Me=new Vector3,ve=new Vector3,se=new Vector3,{a:me,b:Te,c:Re}=ne.face,be=ne.object;be.getVertexPosition(me,Me),be.getVertexPosition(Te,ve),be.getVertexPosition(Re,se);const Pe=new Triangle(Me,ve,se),Le=new Vector3;return Pe.getBarycoord(be.worldToLocal(ne.point),Le),`${fe} ${pe} ${me} ${Te} ${Re} ${Le.x.toFixed(3)} ${Le.y.toFixed(3)} ${Le.z.toFixed(3)}`}addHotspot(U){this.target.add(U),this.annotationRenderer.domElement.appendChild(U.element),this.updateSurfaceHotspot(U)}removeHotspot(U){this.target.remove(U)}forHotspots(U){const{children:Y}=this.target;for(let ie=0,ne=Y.length;ie<ne;ie++){const F=Y[ie];F instanceof Hotspot&&U(F)}}updateSurfaceHotspot(U){if(U.surface==null||this.element.model==null)return;const Y=parseExpressions(U.surface)[0].terms;if(Y.length!=8){console.warn(U.surface+" does not have exactly 8 numbers.");return}const ie=this.element.model[$nodeFromIndex](Y[0].number,Y[1].number);if(ie==null){console.warn(U.surface+" does not match a node/primitive in this glTF! Skipping this hotspot.");return}const ne=ie.mesh.geometry.attributes.position.count,F=new Vector3(Y[2].number,Y[3].number,Y[4].number);if(F.x>=ne||F.y>=ne||F.z>=ne){console.warn(U.surface+" vertex indices out of range in this glTF! Skipping this hotspot.");return}const fe=new Vector3(Y[5].number,Y[6].number,Y[7].number);U.mesh=ie.mesh,U.tri=F,U.bary=fe,U.updateSurface()}animateSurfaceHotspots(){this.element.paused||this.forHotspots(U=>{U.updateSurface()})}updateHotspotsVisibility(U){this.forHotspots(Y=>{view.copy(U),target.setFromMatrixPosition(Y.matrixWorld),view.sub(target),normalWorld.copy(Y.normal).transformDirection(this.target.matrixWorld),view.dot(normalWorld)<0?Y.hide():Y.show()})}orientHotspots(U){this.forHotspots(Y=>{Y.orient(U)})}setHotspotsVisibility(U){this.forHotspots(Y=>{Y.visible=U})}updateSchema(U){var Y;const{schemaElement:ie,element:ne}=this,{alt:F,poster:fe,iosSrc:pe}=ne;if(U!=null){const Me=[{"@type":"MediaObject",contentUrl:U,encodingFormat:((Y=U.split(".").pop())===null||Y===void 0?void 0:Y.toLowerCase())==="gltf"?"model/gltf+json":"model/gltf-binary"}];pe&&Me.push({"@type":"MediaObject",contentUrl:pe,encodingFormat:"model/vnd.usdz+zip"});const ve={"@context":"http://schema.org/","@type":"3DModel",image:fe??void 0,name:F??void 0,encoding:Me};ie.textContent=JSON.stringify(ve),document.head.appendChild(ie)}else ie.parentElement!=null&&ie.parentElement.removeChild(ie)}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProgressTracker extends EventTarget{constructor(){super(...arguments),this.ongoingActivities=new Set,this.totalProgress=0}get ongoingActivityCount(){return this.ongoingActivities.size}beginActivity(U){const Y={progress:0,completed:!1};return this.ongoingActivities.add(Y),this.ongoingActivityCount===1&&this.announceTotalProgress(Y,0,U),ie=>{let ne;return ne=Math.max(clamp(ie,0,1),Y.progress),ne!==Y.progress&&this.announceTotalProgress(Y,ne,U),Y.progress}}announceTotalProgress(U,Y,ie){let ne=0,F=0;Y==1&&(U.completed=!0);for(const Me of this.ongoingActivities){const{progress:ve}=Me;ne+=1-ve,Me.completed&&F++}const fe=U.progress;U.progress=Y,this.totalProgress+=(Y-fe)*(1-this.totalProgress)/ne;const pe=F===this.ongoingActivityCount?1:this.totalProgress;this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:pe,reason:ie}})),F===this.ongoingActivityCount&&(this.totalProgress=0,this.ongoingActivities.clear())}}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$4=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F},_a$1,_b$1,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o;const CLEAR_MODEL_TIMEOUT_MS=10,FALLBACK_SIZE_UPDATE_THRESHOLD_MS=50,ANNOUNCE_MODEL_VISIBILITY_DEBOUNCE_THRESHOLD=0,UNSIZED_MEDIA_WIDTH=300,UNSIZED_MEDIA_HEIGHT=150,blobCanvas=document.createElement("canvas"),$fallbackResizeHandler=Symbol("fallbackResizeHandler"),$defaultAriaLabel=Symbol("defaultAriaLabel"),$resizeObserver=Symbol("resizeObserver"),$clearModelTimeout=Symbol("clearModelTimeout"),$onContextLost=Symbol("onContextLost"),$loaded=Symbol("loaded"),$status=Symbol("status"),$onFocus=Symbol("onFocus"),$onBlur=Symbol("onBlur"),$updateSize=Symbol("updateSize"),$intersectionObserver=Symbol("intersectionObserver"),$isElementInViewport=Symbol("isElementInViewport"),$announceModelVisibility=Symbol("announceModelVisibility"),$ariaLabel=Symbol("ariaLabel"),$altDefaulted=Symbol("altDefaulted"),$statusElement=Symbol("statusElement"),$updateStatus=Symbol("updateStatus"),$loadedTime=Symbol("loadedTime"),$updateSource=Symbol("updateSource"),$markLoaded=Symbol("markLoaded"),$container=Symbol("container"),$userInputElement=Symbol("input"),$canvas=Symbol("canvas"),$scene=Symbol("scene"),$needsRender=Symbol("needsRender"),$tick=Symbol("tick"),$onModelLoad=Symbol("onModelLoad"),$onResize=Symbol("onResize"),$renderer=Symbol("renderer"),$progressTracker=Symbol("progressTracker"),$getLoaded=Symbol("getLoaded"),$getModelIsVisible=Symbol("getModelIsVisible"),$shouldAttemptPreload=Symbol("shouldAttemptPreload"),toVector3D=re=>({x:re.x,y:re.y,z:re.z,toString(){return`${this.x}m ${this.y}m ${this.z}m`}}),toVector2D=re=>({u:re.x,v:re.y,toString(){return`${this.u} ${this.v}`}});class ModelViewerElementBase extends u$2{constructor(){super(),this.alt=null,this.src=null,this.withCredentials=!1,this.generateSchema=!1,this[_a$1]=!1,this[_b$1]=!1,this[_c]=0,this[_d]="",this[_e]=null,this[_f]=debounce(()=>{const ne=this.getBoundingClientRect();this[$updateSize](ne)},FALLBACK_SIZE_UPDATE_THRESHOLD_MS),this[_g]=debounce(ne=>{const F=this.modelIsVisible;F!==ne&&this.dispatchEvent(new CustomEvent("model-visibility",{detail:{visible:F}}))},ANNOUNCE_MODEL_VISIBILITY_DEBOUNCE_THRESHOLD),this[_h]=null,this[_j]=null,this[_k]=new ProgressTracker,this[_l]=()=>{this[$statusElement].textContent=this[$status]},this[_m]=()=>{this[$statusElement].textContent=""},this[_o]=ne=>{this.dispatchEvent(new CustomEvent("error",{detail:{type:"webglcontextlost",sourceError:ne.sourceEvent}}))},this.attachShadow({mode:"open"});const U=this.shadowRoot;makeTemplate(U),this[$container]=U.querySelector(".container"),this[$userInputElement]=U.querySelector(".userInput"),this[$canvas]=U.querySelector("canvas"),this[$statusElement]=U.querySelector("#status"),this[$defaultAriaLabel]=this[$userInputElement].getAttribute("aria-label");let Y,ie;if(this.isConnected){const ne=this.getBoundingClientRect();Y=ne.width,ie=ne.height}else Y=UNSIZED_MEDIA_WIDTH,ie=UNSIZED_MEDIA_HEIGHT;this[$scene]=new ModelScene({canvas:this[$canvas],element:this,width:Y,height:ie}),Promise.resolve().then(()=>{this[$updateSize](this.getBoundingClientRect())}),HAS_RESIZE_OBSERVER&&(this[$resizeObserver]=new ResizeObserver(ne=>{if(!this[$renderer].isPresenting)for(let F of ne)F.target===this&&this[$updateSize](F.contentRect)})),HAS_INTERSECTION_OBSERVER?this[$intersectionObserver]=new IntersectionObserver(ne=>{for(let F of ne)if(F.target===this){const fe=this.modelIsVisible;this[$isElementInViewport]=F.isIntersecting,this[$announceModelVisibility](fe),this[$isElementInViewport]&&!this.loaded&&this[$updateSource]()}},{root:null,rootMargin:"0px",threshold:1e-5}):this[$isElementInViewport]=!0}static get is(){return"model-viewer"}static set modelCacheSize(U){CachingGLTFLoader[$evictionPolicy].evictionThreshold=U}static get modelCacheSize(){return CachingGLTFLoader[$evictionPolicy].evictionThreshold}static set minimumRenderScale(U){U>1&&console.warn("<model-viewer> minimumRenderScale has been clamped to a maximum value of 1."),U<=0&&console.warn("<model-viewer> minimumRenderScale has been clamped to a minimum value of 0.25."),Renderer.singleton.minScale=U}static get minimumRenderScale(){return Renderer.singleton.minScale}get loaded(){return this[$getLoaded]()}get[(_a$1=$isElementInViewport,_b$1=$loaded,_c=$loadedTime,_d=$status,_e=$clearModelTimeout,_f=$fallbackResizeHandler,_g=$announceModelVisibility,_h=$resizeObserver,_j=$intersectionObserver,_k=$progressTracker,$renderer)](){return Renderer.singleton}get modelIsVisible(){return this[$getModelIsVisible]()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),HAS_RESIZE_OBSERVER?this[$resizeObserver].observe(this):self.addEventListener("resize",this[$fallbackResizeHandler]),HAS_INTERSECTION_OBSERVER&&this[$intersectionObserver].observe(this),this.addEventListener("focus",this[$onFocus]),this.addEventListener("blur",this[$onBlur]);const U=this[$renderer];U.addEventListener("contextlost",this[$onContextLost]),U.registerScene(this[$scene]),this[$clearModelTimeout]!=null&&(self.clearTimeout(this[$clearModelTimeout]),this[$clearModelTimeout]=null,this.requestUpdate("src",null))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),HAS_RESIZE_OBSERVER?this[$resizeObserver].unobserve(this):self.removeEventListener("resize",this[$fallbackResizeHandler]),HAS_INTERSECTION_OBSERVER&&this[$intersectionObserver].unobserve(this),this.removeEventListener("focus",this[$onFocus]),this.removeEventListener("blur",this[$onBlur]);const U=this[$renderer];U.removeEventListener("contextlost",this[$onContextLost]),U.unregisterScene(this[$scene]),this[$clearModelTimeout]=self.setTimeout(()=>{this[$scene].dispose(),this[$clearModelTimeout]=null},CLEAR_MODEL_TIMEOUT_MS)}updated(U){super.updated(U),U.has("src")&&(this.src==null?(this[$loaded]=!1,this[$loadedTime]=0,this[$scene].reset()):this.src!==this[$scene].url&&(this[$loaded]=!1,this[$loadedTime]=0,this[$updateSource]())),U.has("alt")&&this[$userInputElement].setAttribute("aria-label",this[$ariaLabel]),U.has("generateSchema")&&(this.generateSchema?this[$scene].updateSchema(this.src):this[$scene].updateSchema(null))}toDataURL(U,Y){return this[$renderer].displayCanvas(this[$scene]).toDataURL(U,Y)}async toBlob(U){const Y=U?U.mimeType:void 0,ie=U?U.qualityArgument:void 0,ne=U?U.idealAspect:void 0,{width:F,height:fe,idealAspect:pe,aspect:Me}=this[$scene],{dpr:ve,scaleFactor:se}=this[$renderer];let me=F*se*ve,Te=fe*se*ve,Re=0,be=0;if(ne===!0)if(pe>Me){const Pe=Te;Te=Math.round(me/pe),be=(Pe-Te)/2}else{const Pe=me;me=Math.round(Te*pe),Re=(Pe-me)/2}blobCanvas.width=me,blobCanvas.height=Te;try{return new Promise(async(Pe,Le)=>{blobCanvas.getContext("2d").drawImage(this[$renderer].displayCanvas(this[$scene]),Re,be,me,Te,0,0,me,Te),blobCanvas.toBlob(xe=>{if(!xe)return Le(new Error("Unable to retrieve canvas blob"));Pe(xe)},Y,ie)})}finally{this[$updateSize]({width:F,height:fe})}}registerEffectComposer(U){U.setRenderer(this[$renderer].threeRenderer),U.setMainCamera(this[$scene].getCamera()),U.setMainScene(this[$scene]),this[$scene].effectRenderer=U}unregisterEffectComposer(){this[$scene].effectRenderer=null}registerRenderer(U){this[$scene].externalRenderer=U}unregisterRenderer(){this[$scene].externalRenderer=null}get[$ariaLabel](){return this[$altDefaulted]}get[$altDefaulted](){return this.alt==null||this.alt==="null"?this[$defaultAriaLabel]:this.alt}[$getLoaded](){return this[$loaded]}[$getModelIsVisible](){return this.loaded&&this[$isElementInViewport]}[$shouldAttemptPreload](){return!!this.src&&this[$isElementInViewport]}[$updateSize]({width:U,height:Y}){U===0||Y===0||(this[$container].style.width=`${U}px`,this[$container].style.height=`${Y}px`,this[$onResize]({width:U,height:Y}))}[$tick](U,Y){var ie;(ie=this[$scene].effectRenderer)===null||ie===void 0||ie.beforeRender(U,Y)}[$markLoaded](){this[$loaded]||(this[$loaded]=!0,this[$loadedTime]=performance.now())}[$needsRender](){this[$scene].queueRender()}[$onModelLoad](){}[$updateStatus](U){this[$status]=U;const Y=this.getRootNode();Y!=null&&Y.activeElement===this&&this[$statusElement].textContent!=U&&(this[$statusElement].textContent=U)}[(_l=$onFocus,_m=$onBlur,$onResize)](U){this[$scene].setSize(U.width,U.height)}async[(_o=$onContextLost,$updateSource)](){const U=this[$scene];if(this.loaded||!this[$shouldAttemptPreload]()||this.src===U.url)return;this.generateSchema&&U.updateSchema(this.src),this[$updateStatus]("Loading"),U.stopAnimation();const Y=this[$progressTracker].beginActivity("model-load"),ie=this.src;try{const ne=U.setSource(ie,fe=>Y(clamp(fe,0,1)*.95)),F=this[$updateEnvironment]();await Promise.all([ne,F]),this[$markLoaded](),this[$onModelLoad](),this.updateComplete.then(()=>{this.dispatchEvent(new CustomEvent("before-render"))}),await new Promise(fe=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.dispatchEvent(new CustomEvent("load",{detail:{url:ie}})),fe()})})})}catch(ne){this.dispatchEvent(new CustomEvent("error",{detail:{type:"loadfailure",sourceError:ne}}))}finally{Y(1)}}}__decorate$4([n$6({type:String})],ModelViewerElementBase.prototype,"alt",void 0);__decorate$4([n$6({type:String})],ModelViewerElementBase.prototype,"src",void 0);__decorate$4([n$6({type:Boolean,attribute:"with-credentials"})],ModelViewerElementBase.prototype,"withCredentials",void 0);__decorate$4([n$6({type:Boolean,attribute:"generate-schema"})],ModelViewerElementBase.prototype,"generateSchema",void 0);/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$3=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};const MILLISECONDS_PER_SECOND=1e3,$changeAnimation=Symbol("changeAnimation"),$paused=Symbol("paused"),DEFAULT_PLAY_OPTIONS={repetitions:1/0,pingpong:!1},AnimationMixin=re=>{var U;class Y extends re{constructor(...ne){super(ne),this.autoplay=!1,this.animationName=void 0,this.animationCrossfadeDuration=300,this[U]=!0,this[$scene].subscribeMixerEvent("loop",F=>{const fe=F.action._loopCount;this.dispatchEvent(new CustomEvent("loop",{detail:{count:fe}}))}),this[$scene].subscribeMixerEvent("finished",()=>{this[$paused]=!0,this.dispatchEvent(new CustomEvent("finished"))})}get availableAnimations(){return this.loaded?this[$scene].animationNames:[]}get duration(){return this[$scene].duration}get paused(){return this[$paused]}get currentTime(){return this[$scene].animationTime}set currentTime(ne){this[$scene].animationTime=ne,this[$needsRender]()}get timeScale(){return this[$scene].animationTimeScale}set timeScale(ne){this[$scene].animationTimeScale=ne}pause(){this[$paused]||(this[$paused]=!0,this.dispatchEvent(new CustomEvent("pause")))}play(ne){this.availableAnimations.length>0&&(this[$paused]=!1,this[$changeAnimation](ne),this.dispatchEvent(new CustomEvent("play")))}[(U=$paused,$onModelLoad)](){super[$onModelLoad](),this[$paused]=!0,this.animationName!=null&&this[$changeAnimation](),this.autoplay&&this.play()}[$tick](ne,F){super[$tick](ne,F),!(this[$paused]||!this[$getModelIsVisible]()&&!this[$renderer].isPresenting)&&(this[$scene].updateAnimation(F/MILLISECONDS_PER_SECOND),this[$needsRender]())}updated(ne){super.updated(ne),ne.has("autoplay")&&this.autoplay&&this.play(),ne.has("animationName")&&this[$changeAnimation]()}[$changeAnimation](ne=DEFAULT_PLAY_OPTIONS){var F;const fe=(F=ne.repetitions)!==null&&F!==void 0?F:1/0,pe=ne.pingpong?LoopPingPong:fe===1?LoopOnce:LoopRepeat;this[$scene].playAnimation(this.animationName,this.animationCrossfadeDuration/MILLISECONDS_PER_SECOND,pe,fe),this[$paused]&&(this[$scene].updateAnimation(0),this[$needsRender]())}}return __decorate$3([n$6({type:Boolean})],Y.prototype,"autoplay",void 0),__decorate$3([n$6({type:String,attribute:"animation-name"})],Y.prototype,"animationName",void 0),__decorate$3([n$6({type:Number,attribute:"animation-crossfade-duration"})],Y.prototype,"animationCrossfadeDuration",void 0),Y};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $hotspotMap=Symbol("hotspotMap"),$mutationCallback=Symbol("mutationCallback"),$observer=Symbol("observer"),$addHotspot=Symbol("addHotspot"),$removeHotspot=Symbol("removeHotspot"),worldToModel=new Matrix4,AnnotationMixin=re=>{var U,Y,ie;class ne extends re{constructor(){super(...arguments),this[U]=new Map,this[Y]=fe=>{fe.forEach(pe=>{(!(pe instanceof MutationRecord)||pe.type==="childList")&&(pe.addedNodes.forEach(Me=>{this[$addHotspot](Me)}),pe.removedNodes.forEach(Me=>{this[$removeHotspot](Me)}),this[$needsRender]())})},this[ie]=new MutationObserver(this[$mutationCallback])}connectedCallback(){super.connectedCallback();for(let pe=0;pe<this.children.length;++pe)this[$addHotspot](this.children[pe]);const{ShadyDOM:fe}=self;fe==null?this[$observer].observe(this,{childList:!0}):this[$observer]=fe.observeChildren(this,this[$mutationCallback])}disconnectedCallback(){super.disconnectedCallback();const{ShadyDOM:fe}=self;fe==null?this[$observer].disconnect():fe.unobserveChildren(this[$observer])}[(U=$hotspotMap,Y=$mutationCallback,ie=$observer,$onModelLoad)](){super[$onModelLoad]();const fe=this[$scene];fe.forHotspots(pe=>{fe.updateSurfaceHotspot(pe)})}[$tick](fe,pe){super[$tick](fe,pe);const Me=this[$scene],{annotationRenderer:ve}=Me,se=Me.getCamera();Me.shouldRender()&&(Me.animateSurfaceHotspots(),Me.updateHotspotsVisibility(se.position),ve.domElement.style.display="",ve.render(Me,se))}updateHotspot(fe){const pe=this[$hotspotMap].get(fe.name);pe!=null&&(pe.updatePosition(fe.position),pe.updateNormal(fe.normal),pe.surface=fe.surface,this[$scene].updateSurfaceHotspot(pe),this[$needsRender]())}queryHotspot(fe){const pe=this[$hotspotMap].get(fe);if(pe==null)return null;const Me=toVector3D(pe.position),ve=toVector3D(pe.normal),se=pe.facingCamera,me=this[$scene],Te=me.getCamera(),Re=new Vector3;Re.setFromMatrixPosition(pe.matrixWorld),Re.project(Te);const be=me.width/2,Pe=me.height/2;Re.x=Re.x*be+be,Re.y=-(Re.y*Pe)+Pe;const Le=toVector3D(new Vector3(Re.x,Re.y,Re.z));return!Number.isFinite(Le.x)||!Number.isFinite(Le.y)?null:{position:Me,normal:ve,canvasPosition:Le,facingCamera:se}}positionAndNormalFromPoint(fe,pe){const Me=this[$scene],ve=Me.getNDC(fe,pe),se=Me.positionAndNormalFromPoint(ve);if(se==null)return null;worldToModel.copy(Me.target.matrixWorld).invert();const me=toVector3D(se.position.applyMatrix4(worldToModel)),Te=toVector3D(se.normal.transformDirection(worldToModel));let Re=null;return se.uv!=null&&(Re=toVector2D(se.uv)),{position:me,normal:Te,uv:Re}}surfaceFromPoint(fe,pe){const Me=this[$scene],ve=Me.getNDC(fe,pe);return Me.surfaceFromPoint(ve)}[$addHotspot](fe){if(!(fe instanceof HTMLElement&&fe.slot.indexOf("hotspot")===0))return;let pe=this[$hotspotMap].get(fe.slot);pe!=null?pe.increment():(pe=new Hotspot({name:fe.slot,position:fe.dataset.position,normal:fe.dataset.normal,surface:fe.dataset.surface}),this[$hotspotMap].set(fe.slot,pe),this[$scene].addHotspot(pe)),this[$scene].queueRender()}[$removeHotspot](fe){if(!(fe instanceof HTMLElement))return;const pe=this[$hotspotMap].get(fe.slot);pe&&(pe.decrement()&&(this[$scene].removeHotspot(pe),this[$hotspotMap].delete(fe.slot)),this[$scene].queueRender())}}return ne};/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.8.2
*/var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(re,U){for(var Y=new u16(31),ie=0;ie<31;++ie)Y[ie]=U+=1<<re[ie-1];for(var ne=new i32(Y[30]),ie=1;ie<30;++ie)for(var F=Y[ie];F<Y[ie+1];++F)ne[F]=F-Y[ie]<<5|ie;return{b:Y,r:ne}},_a=freb(fleb,2),fl=_a.b,revfl=_a.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),revfd=_b.r,rev=new u16(32768);for(var i=0;i<32768;++i){var x=(i&43690)>>1|(i&21845)<<1;x=(x&52428)>>2|(x&13107)<<2,x=(x&61680)>>4|(x&3855)<<4,rev[i]=((x&65280)>>8|(x&255)<<8)>>1}var hMap=function(re,U,Y){for(var ie=re.length,ne=0,F=new u16(U);ne<ie;++ne)re[ne]&&++F[re[ne]-1];var fe=new u16(U);for(ne=1;ne<U;++ne)fe[ne]=fe[ne-1]+F[ne-1]<<1;var pe;if(Y){pe=new u16(1<<U);var Me=15-U;for(ne=0;ne<ie;++ne)if(re[ne])for(var ve=ne<<4|re[ne],se=U-re[ne],me=fe[re[ne]-1]++<<se,Te=me|(1<<se)-1;me<=Te;++me)pe[rev[me]>>Me]=ve}else for(pe=new u16(ie),ne=0;ne<ie;++ne)re[ne]&&(pe[ne]=rev[fe[re[ne]-1]++]>>15-re[ne]);return pe},flt=new u8(288);for(var i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;var fdt=new u8(32);for(var i=0;i<32;++i)fdt[i]=5;var flm=hMap(flt,9,0),fdm=hMap(fdt,5,0),shft=function(re){return(re+7)/8|0},slc=function(re,U,Y){return(Y==null||Y>re.length)&&(Y=re.length),new u8(re.subarray(U,Y))},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(re,U,Y){var ie=new Error(U||ec[re]);if(ie.code=re,Error.captureStackTrace&&Error.captureStackTrace(ie,err),!Y)throw ie;return ie},wbits=function(re,U,Y){Y<<=U&7;var ie=U/8|0;re[ie]|=Y,re[ie+1]|=Y>>8},wbits16=function(re,U,Y){Y<<=U&7;var ie=U/8|0;re[ie]|=Y,re[ie+1]|=Y>>8,re[ie+2]|=Y>>16},hTree=function(re,U){for(var Y=[],ie=0;ie<re.length;++ie)re[ie]&&Y.push({s:ie,f:re[ie]});var ne=Y.length,F=Y.slice();if(!ne)return{t:et,l:0};if(ne==1){var fe=new u8(Y[0].s+1);return fe[Y[0].s]=1,{t:fe,l:1}}Y.sort(function(ke,Ve){return ke.f-Ve.f}),Y.push({s:-1,f:25001});var pe=Y[0],Me=Y[1],ve=0,se=1,me=2;for(Y[0]={s:-1,f:pe.f+Me.f,l:pe,r:Me};se!=ne-1;)pe=Y[Y[ve].f<Y[me].f?ve++:me++],Me=Y[ve!=se&&Y[ve].f<Y[me].f?ve++:me++],Y[se++]={s:-1,f:pe.f+Me.f,l:pe,r:Me};for(var Te=F[0].s,ie=1;ie<ne;++ie)F[ie].s>Te&&(Te=F[ie].s);var Re=new u16(Te+1),be=ln(Y[se-1],Re,0);if(be>U){var ie=0,Pe=0,Le=be-U,xe=1<<Le;for(F.sort(function(Ve,Xe){return Re[Xe.s]-Re[Ve.s]||Ve.f-Xe.f});ie<ne;++ie){var Fe=F[ie].s;if(Re[Fe]>U)Pe+=xe-(1<<be-Re[Fe]),Re[Fe]=U;else break}for(Pe>>=Le;Pe>0;){var Oe=F[ie].s;Re[Oe]<U?Pe-=1<<U-Re[Oe]++-1:++ie}for(;ie>=0&&Pe;--ie){var Ne=F[ie].s;Re[Ne]==U&&(--Re[Ne],++Pe)}be=U}return{t:new u8(Re),l:be}},ln=function(re,U,Y){return re.s==-1?Math.max(ln(re.l,U,Y+1),ln(re.r,U,Y+1)):U[re.s]=Y},lc=function(re){for(var U=re.length;U&&!re[--U];);for(var Y=new u16(++U),ie=0,ne=re[0],F=1,fe=function(Me){Y[ie++]=Me},pe=1;pe<=U;++pe)if(re[pe]==ne&&pe!=U)++F;else{if(!ne&&F>2){for(;F>138;F-=138)fe(32754);F>2&&(fe(F>10?F-11<<5|28690:F-3<<5|12305),F=0)}else if(F>3){for(fe(ne),--F;F>6;F-=6)fe(8304);F>2&&(fe(F-3<<5|8208),F=0)}for(;F--;)fe(ne);F=1,ne=re[pe]}return{c:Y.subarray(0,ie),n:U}},clen=function(re,U){for(var Y=0,ie=0;ie<U.length;++ie)Y+=re[ie]*U[ie];return Y},wfblk=function(re,U,Y){var ie=Y.length,ne=shft(U+2);re[ne]=ie&255,re[ne+1]=ie>>8,re[ne+2]=re[ne]^255,re[ne+3]=re[ne+1]^255;for(var F=0;F<ie;++F)re[ne+F+4]=Y[F];return(ne+4+ie)*8},wblk=function(re,U,Y,ie,ne,F,fe,pe,Me,ve,se){wbits(U,se++,Y),++ne[256];for(var me=hTree(ne,15),Te=me.t,Re=me.l,be=hTree(F,15),Pe=be.t,Le=be.l,xe=lc(Te),Fe=xe.c,Oe=xe.n,Ne=lc(Pe),ke=Ne.c,Ve=Ne.n,Xe=new u16(19),$e=0;$e<Fe.length;++$e)++Xe[Fe[$e]&31];for(var $e=0;$e<ke.length;++$e)++Xe[ke[$e]&31];for(var st=hTree(Xe,7),ze=st.t,tt=st.l,ft=19;ft>4&&!ze[clim[ft-1]];--ft);var Rt=ve+5<<3,Mt=clen(ne,flt)+clen(F,fdt)+fe,Gt=clen(ne,Te)+clen(F,Pe)+fe+14+3*ft+clen(Xe,ze)+2*Xe[16]+3*Xe[17]+7*Xe[18];if(Me>=0&&Rt<=Mt&&Rt<=Gt)return wfblk(U,se,re.subarray(Me,Me+ve));var _t,Bt,dt,ut;if(wbits(U,se,1+(Gt<Mt)),se+=2,Gt<Mt){_t=hMap(Te,Re,0),Bt=Te,dt=hMap(Pe,Le,0),ut=Pe;var Ut=hMap(ze,tt,0);wbits(U,se,Oe-257),wbits(U,se+5,Ve-1),wbits(U,se+10,ft-4),se+=14;for(var $e=0;$e<ft;++$e)wbits(U,se+3*$e,ze[clim[$e]]);se+=3*ft;for(var Tt=[Fe,ke],Xt=0;Xt<2;++Xt)for(var hn=Tt[Xt],$e=0;$e<hn.length;++$e){var nn=hn[$e]&31;wbits(U,se,Ut[nn]),se+=ze[nn],nn>15&&(wbits(U,se,hn[$e]>>5&127),se+=hn[$e]>>12)}}else _t=flm,Bt=flt,dt=fdm,ut=fdt;for(var $e=0;$e<pe;++$e){var An=ie[$e];if(An>255){var nn=An>>18&31;wbits16(U,se,_t[nn+257]),se+=Bt[nn+257],nn>7&&(wbits(U,se,An>>23&31),se+=fleb[nn]);var Cn=An&31;wbits16(U,se,dt[Cn]),se+=ut[Cn],Cn>3&&(wbits16(U,se,An>>5&8191),se+=fdeb[Cn])}else wbits16(U,se,_t[An]),se+=Bt[An]}return wbits16(U,se,_t[256]),se+Bt[256]},deo=new i32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et=new u8(0),dflt=function(re,U,Y,ie,ne,F){var fe=F.z||re.length,pe=new u8(ie+fe+5*(1+Math.ceil(fe/7e3))+ne),Me=pe.subarray(ie,pe.length-ne),ve=F.l,se=(F.r||0)&7;if(U){se&&(Me[0]=F.r>>3);for(var me=deo[U-1],Te=me>>13,Re=me&8191,be=(1<<Y)-1,Pe=F.p||new u16(32768),Le=F.h||new u16(be+1),xe=Math.ceil(Y/3),Fe=2*xe,Oe=function(Vr){return(re[Vr]^re[Vr+1]<<xe^re[Vr+2]<<Fe)&be},Ne=new i32(25e3),ke=new u16(288),Ve=new u16(32),Xe=0,$e=0,st=F.i||0,ze=0,tt=F.w||0,ft=0;st+2<fe;++st){var Rt=Oe(st),Mt=st&32767,Gt=Le[Rt];if(Pe[Mt]=Gt,Le[Rt]=Mt,tt<=st){var _t=fe-st;if((Xe>7e3||ze>24576)&&(_t>423||!ve)){se=wblk(re,Me,0,Ne,ke,Ve,$e,ze,ft,st-ft,se),ze=Xe=$e=0,ft=st;for(var Bt=0;Bt<286;++Bt)ke[Bt]=0;for(var Bt=0;Bt<30;++Bt)Ve[Bt]=0}var dt=2,ut=0,Ut=Re,Tt=Mt-Gt&32767;if(_t>2&&Rt==Oe(st-Tt))for(var Xt=Math.min(Te,_t)-1,hn=Math.min(32767,st),nn=Math.min(258,_t);Tt<=hn&&--Ut&&Mt!=Gt;){if(re[st+dt]==re[st+dt-Tt]){for(var An=0;An<nn&&re[st+An]==re[st+An-Tt];++An);if(An>dt){if(dt=An,ut=Tt,An>Xt)break;for(var Cn=Math.min(Tt,An-2),Nn=0,Bt=0;Bt<Cn;++Bt){var Qn=st-Tt+Bt&32767,fi=Pe[Qn],hi=Qn-fi&32767;hi>Nn&&(Nn=hi,Gt=Qn)}}}Mt=Gt,Gt=Pe[Mt],Tt+=Mt-Gt&32767}if(ut){Ne[ze++]=268435456|revfl[dt]<<18|revfd[ut];var Qi=revfl[dt]&31,Zi=revfd[ut]&31;$e+=fleb[Qi]+fdeb[Zi],++ke[257+Qi],++Ve[Zi],tt=st+dt,++Xe}else Ne[ze++]=re[st],++ke[re[st]]}}for(st=Math.max(st,tt);st<fe;++st)Ne[ze++]=re[st],++ke[re[st]];se=wblk(re,Me,ve,Ne,ke,Ve,$e,ze,ft,st-ft,se),ve||(F.r=se&7|Me[se/8|0]<<3,se-=7,F.h=Le,F.p=Pe,F.i=st,F.w=tt)}else{for(var st=F.w||0;st<fe+ve;st+=65535){var Mn=st+65535;Mn>=fe&&(Me[se/8|0]=ve,Mn=fe),se=wfblk(Me,se+1,re.subarray(st,Mn))}F.i=fe}return slc(pe,0,ie+shft(se)+ne)},crct=function(){for(var re=new Int32Array(256),U=0;U<256;++U){for(var Y=U,ie=9;--ie;)Y=(Y&1&&-306674912)^Y>>>1;re[U]=Y}return re}(),crc=function(){var re=-1;return{p:function(U){for(var Y=re,ie=0;ie<U.length;++ie)Y=crct[Y&255^U[ie]]^Y>>>8;re=Y},d:function(){return~re}}},dopt=function(re,U,Y,ie,ne){if(!ne&&(ne={l:1},U.dictionary)){var F=U.dictionary.subarray(-32768),fe=new u8(F.length+re.length);fe.set(F),fe.set(re,F.length),re=fe,ne.w=F.length}return dflt(re,U.level==null?6:U.level,U.mem==null?ne.l?Math.ceil(Math.max(8,Math.min(13,Math.log(re.length)))*1.5):20:12+U.mem,Y,ie,ne)},mrg=function(re,U){var Y={};for(var ie in re)Y[ie]=re[ie];for(var ie in U)Y[ie]=U[ie];return Y},wbytes=function(re,U,Y){for(;Y;++U)re[U]=Y,Y>>>=8};function deflateSync(re,U){return dopt(re,U||{},0,0)}var fltn=function(re,U,Y,ie){for(var ne in re){var F=re[ne],fe=U+ne,pe=ie;Array.isArray(F)&&(pe=mrg(ie,F[1]),F=F[0]),F instanceof u8?Y[fe]=[F,pe]:(Y[fe+="/"]=[new u8(0),pe],fltn(F,fe,Y,ie))}},te=typeof TextEncoder<"u"&&new TextEncoder,td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch{}function strToU8(re,U){var Y;if(te)return te.encode(re);for(var ie=re.length,ne=new u8(re.length+(re.length>>1)),F=0,fe=function(ve){ne[F++]=ve},Y=0;Y<ie;++Y){if(F+5>ne.length){var pe=new u8(F+8+(ie-Y<<1));pe.set(ne),ne=pe}var Me=re.charCodeAt(Y);Me<128||U?fe(Me):Me<2048?(fe(192|Me>>6),fe(128|Me&63)):Me>55295&&Me<57344?(Me=65536+(Me&1047552)|re.charCodeAt(++Y)&1023,fe(240|Me>>18),fe(128|Me>>12&63),fe(128|Me>>6&63),fe(128|Me&63)):(fe(224|Me>>12),fe(128|Me>>6&63),fe(128|Me&63))}return slc(ne,0,F)}var exfl=function(re){var U=0;if(re)for(var Y in re){var ie=re[Y].length;ie>65535&&err(9),U+=ie+4}return U},wzh=function(re,U,Y,ie,ne,F,fe,pe){var Me=ie.length,ve=Y.extra,se=pe&&pe.length,me=exfl(ve);wbytes(re,U,fe!=null?33639248:67324752),U+=4,fe!=null&&(re[U++]=20,re[U++]=Y.os),re[U]=20,U+=2,re[U++]=Y.flag<<1|(F<0&&8),re[U++]=ne&&8,re[U++]=Y.compression&255,re[U++]=Y.compression>>8;var Te=new Date(Y.mtime==null?Date.now():Y.mtime),Re=Te.getFullYear()-1980;if((Re<0||Re>119)&&err(10),wbytes(re,U,Re<<25|Te.getMonth()+1<<21|Te.getDate()<<16|Te.getHours()<<11|Te.getMinutes()<<5|Te.getSeconds()>>1),U+=4,F!=-1&&(wbytes(re,U,Y.crc),wbytes(re,U+4,F<0?-F-2:F),wbytes(re,U+8,Y.size)),wbytes(re,U+12,Me),wbytes(re,U+14,me),U+=16,fe!=null&&(wbytes(re,U,se),wbytes(re,U+6,Y.attrs),wbytes(re,U+10,fe),U+=14),re.set(ie,U),U+=Me,me)for(var be in ve){var Pe=ve[be],Le=Pe.length;wbytes(re,U,+be),wbytes(re,U+2,Le),re.set(Pe,U+4),U+=4+Le}return se&&(re.set(pe,U),U+=se),U},wzf=function(re,U,Y,ie,ne){wbytes(re,U,101010256),wbytes(re,U+8,Y),wbytes(re,U+10,Y),wbytes(re,U+12,ie),wbytes(re,U+16,ne)};function zipSync(re,U){U||(U={});var Y={},ie=[];fltn(re,"",Y,U);var ne=0,F=0;for(var fe in Y){var pe=Y[fe],Me=pe[0],ve=pe[1],se=ve.level==0?0:8,me=strToU8(fe),Te=me.length,Re=ve.comment,be=Re&&strToU8(Re),Pe=be&&be.length,Le=exfl(ve.extra);Te>65535&&err(11);var xe=se?deflateSync(Me,ve):Me,Fe=xe.length,Oe=crc();Oe.p(Me),ie.push(mrg(ve,{size:Me.length,crc:Oe.d(),c:xe,f:me,m:be,u:Te!=fe.length||be&&Re.length!=Pe,o:ne,compression:se})),ne+=30+Te+Le+Fe,F+=76+2*(Te+Le)+(Pe||0)+Fe}for(var Ne=new u8(F+22),ke=ne,Ve=F-ne,Xe=0;Xe<ie.length;++Xe){var me=ie[Xe];wzh(Ne,me.o,me,me.f,me.u,me.c.length);var $e=30+me.f.length+exfl(me.extra);Ne.set(me.c,me.o+$e),wzh(Ne,ne,me,me.f,me.u,me.c.length,me.o,me.m),ne+=16+$e+(me.m?me.m.length:0)}return wzf(Ne,ne,ie.length,Ve,ke),Ne}class USDZExporter{parse(U,Y,ie,ne){this.parseAsync(U,ne).then(Y).catch(ie)}async parseAsync(U,Y={}){Y=Object.assign({ar:{anchoring:{type:"plane"},planeAnchoring:{alignment:"horizontal"}},includeAnchoringProperties:!0,quickLookCompatible:!1,maxTextureSize:1024},Y);const ie={},ne="model.usda";ie[ne]=null;let F=buildHeader();F+=buildSceneStart(Y);const fe={},pe={};U.traverseVisible(ve=>{if(ve.isMesh){const se=ve.geometry,me=ve.material;if(me.isMeshStandardMaterial){const Te="geometries/Geometry_"+se.id+".usda";if(!(Te in ie)){const Re=buildMeshObject(se);ie[Te]=buildUSDFileAsString(Re)}me.uuid in fe||(fe[me.uuid]=me),F+=buildXform(ve,se,me)}else console.warn("THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)",ve)}else ve.isCamera&&(F+=buildCamera(ve))}),F+=buildSceneEnd(),F+=buildMaterials(fe,pe,Y.quickLookCompatible),ie[ne]=strToU8(F),F=null;for(const ve in pe){let se=pe[ve];se.isCompressedTexture===!0&&(se=decompress(se));const me=imageToCanvas(se.image,se.flipY,Y.maxTextureSize),Te=await new Promise(Re=>me.toBlob(Re,"image/png",1));ie[`textures/Texture_${ve}.png`]=new Uint8Array(await Te.arrayBuffer())}let Me=0;for(const ve in ie){const se=ie[ve],me=34+ve.length;Me+=me;const Te=Me&63;if(Te!==4){const Re=64-Te,be=new Uint8Array(Re);ie[ve]=[se,{extra:{12345:be}}]}Me=se.length}return zipSync(ie,{level:0})}}function imageToCanvas(re,U,Y){if(typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&re instanceof OffscreenCanvas||typeof ImageBitmap<"u"&&re instanceof ImageBitmap){const ie=Y/Math.max(re.width,re.height),ne=document.createElement("canvas");ne.width=re.width*Math.min(1,ie),ne.height=re.height*Math.min(1,ie);const F=ne.getContext("2d");return U===!0&&(F.translate(0,ne.height),F.scale(1,-1)),F.drawImage(re,0,0,ne.width,ne.height),ne}else throw new Error("THREE.USDZExporter: No valid image data found. Unable to process texture.")}const PRECISION=7;function buildHeader(){return`#usda 1.0
(
	customLayerData = {
		string creator = "Three.js USDZExporter"
	}
	defaultPrim = "Root"
	metersPerUnit = 1
	upAxis = "Y"
)

`}function buildSceneStart(re){return`def Xform "Root"
{
	def Scope "Scenes" (
		kind = "sceneLibrary"
	)
	{
		def Xform "Scene" (
			customData = {
				bool preliminary_collidesWithEnvironment = 0
				string sceneName = "Scene"
			}
			sceneName = "Scene"
		)
		{${re.includeAnchoringProperties===!0?`
		token preliminary:anchoring:type = "${re.ar.anchoring.type}"
		token preliminary:planeAnchoring:alignment = "${re.ar.planeAnchoring.alignment}"
	`:""}
`}function buildSceneEnd(){return`
		}
	}
}

`}function buildUSDFileAsString(re){let U=buildHeader();return U+=re,strToU8(U)}function buildXform(re,U,Y){const ie="Object_"+re.id,ne=buildMatrix(re.matrixWorld);return re.matrixWorld.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",re),`def Xform "${ie}" (
	prepend references = @./geometries/Geometry_${U.id}.usda@</Geometry>
	prepend apiSchemas = ["MaterialBindingAPI"]
)
{
	matrix4d xformOp:transform = ${ne}
	uniform token[] xformOpOrder = ["xformOp:transform"]

	rel material:binding = </Materials/Material_${Y.id}>
}

`}function buildMatrix(re){const U=re.elements;return`( ${buildMatrixRow(U,0)}, ${buildMatrixRow(U,4)}, ${buildMatrixRow(U,8)}, ${buildMatrixRow(U,12)} )`}function buildMatrixRow(re,U){return`(${re[U+0]}, ${re[U+1]}, ${re[U+2]}, ${re[U+3]})`}function buildMeshObject(re){return`
def "Geometry"
{
${buildMesh(re)}
}
`}function buildMesh(re){const U="Geometry",Y=re.attributes,ie=Y.position.count;return`
	def Mesh "${U}"
	{
		int[] faceVertexCounts = [${buildMeshVertexCount(re)}]
		int[] faceVertexIndices = [${buildMeshVertexIndices(re)}]
		normal3f[] normals = [${buildVector3Array(Y.normal,ie)}] (
			interpolation = "vertex"
		)
		point3f[] points = [${buildVector3Array(Y.position,ie)}]
${buildPrimvars(Y)}
		uniform token subdivisionScheme = "none"
	}
`}function buildMeshVertexCount(re){const U=re.index!==null?re.index.count:re.attributes.position.count;return Array(U/3).fill(3).join(", ")}function buildMeshVertexIndices(re){const U=re.index,Y=[];if(U!==null)for(let ie=0;ie<U.count;ie++)Y.push(U.getX(ie));else{const ie=re.attributes.position.count;for(let ne=0;ne<ie;ne++)Y.push(ne)}return Y.join(", ")}function buildVector3Array(re,U){if(re===void 0)return console.warn("USDZExporter: Normals missing."),Array(U).fill("(0, 0, 0)").join(", ");const Y=[];for(let ie=0;ie<re.count;ie++){const ne=re.getX(ie),F=re.getY(ie),fe=re.getZ(ie);Y.push(`(${ne.toPrecision(PRECISION)}, ${F.toPrecision(PRECISION)}, ${fe.toPrecision(PRECISION)})`)}return Y.join(", ")}function buildVector2Array(re){const U=[];for(let Y=0;Y<re.count;Y++){const ie=re.getX(Y),ne=re.getY(Y);U.push(`(${ie.toPrecision(PRECISION)}, ${1-ne.toPrecision(PRECISION)})`)}return U.join(", ")}function buildPrimvars(re){let U="";for(let ie=0;ie<4;ie++){const ne=ie>0?ie:"",F=re["uv"+ne];F!==void 0&&(U+=`
		texCoord2f[] primvars:st${ne} = [${buildVector2Array(F)}] (
			interpolation = "vertex"
		)`)}const Y=re.color;if(Y!==void 0){const ie=Y.count;U+=`
	color3f[] primvars:displayColor = [${buildVector3Array(Y,ie)}] (
		interpolation = "vertex"
		)`}return U}function buildMaterials(re,U,Y=!1){const ie=[];for(const ne in re){const F=re[ne];ie.push(buildMaterial(F,U,Y))}return`def "Materials"
{
${ie.join("")}
}

`}function buildMaterial(re,U,Y=!1){const ie="			",ne=[],F=[];function fe(pe,Me,ve){const se=pe.source.id+"_"+pe.flipY;U[se]=pe;const me=pe.channel>0?"st"+pe.channel:"st",Te={1e3:"repeat",1001:"clamp",1002:"mirror"},Re=pe.repeat.clone(),be=pe.offset.clone(),Pe=pe.rotation,Le=Math.sin(Pe),xe=Math.cos(Pe);return be.y=1-be.y-Re.y,Y?(be.x=be.x/Re.x,be.y=be.y/Re.y,be.x+=Le/Re.x,be.y+=xe-1):(be.x+=Le*Re.x,be.y+=(1-xe)*Re.y),`
		def Shader "PrimvarReader_${Me}"
		{
			uniform token info:id = "UsdPrimvarReader_float2"
			float2 inputs:fallback = (0.0, 0.0)
			token inputs:varname = "${me}"
			float2 outputs:result
		}

		def Shader "Transform2d_${Me}"
		{
			uniform token info:id = "UsdTransform2d"
			token inputs:in.connect = </Materials/Material_${re.id}/PrimvarReader_${Me}.outputs:result>
			float inputs:rotation = ${(Pe*(180/Math.PI)).toFixed(PRECISION)}
			float2 inputs:scale = ${buildVector2(Re)}
			float2 inputs:translation = ${buildVector2(be)}
			float2 outputs:result
		}

		def Shader "Texture_${pe.id}_${Me}"
		{
			uniform token info:id = "UsdUVTexture"
			asset inputs:file = @textures/Texture_${se}.png@
			float2 inputs:st.connect = </Materials/Material_${re.id}/Transform2d_${Me}.outputs:result>
			${ve!==void 0?"float4 inputs:scale = "+buildColor4(ve):""}
			token inputs:sourceColorSpace = "${pe.colorSpace===NoColorSpace?"raw":"sRGB"}"
			token inputs:wrapS = "${Te[pe.wrapS]}"
			token inputs:wrapT = "${Te[pe.wrapT]}"
			float outputs:r
			float outputs:g
			float outputs:b
			float3 outputs:rgb
			${re.transparent||re.alphaTest>0?"float outputs:a":""}
		}`}return re.side===DoubleSide&&console.warn("THREE.USDZExporter: USDZ does not support double sided materials",re),re.map!==null?(ne.push(`${ie}color3f inputs:diffuseColor.connect = </Materials/Material_${re.id}/Texture_${re.map.id}_diffuse.outputs:rgb>`),re.transparent?ne.push(`${ie}float inputs:opacity.connect = </Materials/Material_${re.id}/Texture_${re.map.id}_diffuse.outputs:a>`):re.alphaTest>0&&(ne.push(`${ie}float inputs:opacity.connect = </Materials/Material_${re.id}/Texture_${re.map.id}_diffuse.outputs:a>`),ne.push(`${ie}float inputs:opacityThreshold = ${re.alphaTest}`)),F.push(fe(re.map,"diffuse",re.color))):ne.push(`${ie}color3f inputs:diffuseColor = ${buildColor(re.color)}`),re.emissiveMap!==null?(ne.push(`${ie}color3f inputs:emissiveColor.connect = </Materials/Material_${re.id}/Texture_${re.emissiveMap.id}_emissive.outputs:rgb>`),F.push(fe(re.emissiveMap,"emissive",new Color(re.emissive.r*re.emissiveIntensity,re.emissive.g*re.emissiveIntensity,re.emissive.b*re.emissiveIntensity)))):re.emissive.getHex()>0&&ne.push(`${ie}color3f inputs:emissiveColor = ${buildColor(re.emissive)}`),re.normalMap!==null&&(ne.push(`${ie}normal3f inputs:normal.connect = </Materials/Material_${re.id}/Texture_${re.normalMap.id}_normal.outputs:rgb>`),F.push(fe(re.normalMap,"normal"))),re.aoMap!==null&&(ne.push(`${ie}float inputs:occlusion.connect = </Materials/Material_${re.id}/Texture_${re.aoMap.id}_occlusion.outputs:r>`),F.push(fe(re.aoMap,"occlusion",new Color(re.aoMapIntensity,re.aoMapIntensity,re.aoMapIntensity)))),re.roughnessMap!==null?(ne.push(`${ie}float inputs:roughness.connect = </Materials/Material_${re.id}/Texture_${re.roughnessMap.id}_roughness.outputs:g>`),F.push(fe(re.roughnessMap,"roughness",new Color(re.roughness,re.roughness,re.roughness)))):ne.push(`${ie}float inputs:roughness = ${re.roughness}`),re.metalnessMap!==null?(ne.push(`${ie}float inputs:metallic.connect = </Materials/Material_${re.id}/Texture_${re.metalnessMap.id}_metallic.outputs:b>`),F.push(fe(re.metalnessMap,"metallic",new Color(re.metalness,re.metalness,re.metalness)))):ne.push(`${ie}float inputs:metallic = ${re.metalness}`),re.alphaMap!==null?(ne.push(`${ie}float inputs:opacity.connect = </Materials/Material_${re.id}/Texture_${re.alphaMap.id}_opacity.outputs:r>`),ne.push(`${ie}float inputs:opacityThreshold = 0.0001`),F.push(fe(re.alphaMap,"opacity"))):ne.push(`${ie}float inputs:opacity = ${re.opacity}`),re.isMeshPhysicalMaterial&&(re.clearcoatMap!==null?(ne.push(`${ie}float inputs:clearcoat.connect = </Materials/Material_${re.id}/Texture_${re.clearcoatMap.id}_clearcoat.outputs:r>`),F.push(fe(re.clearcoatMap,"clearcoat",new Color(re.clearcoat,re.clearcoat,re.clearcoat)))):ne.push(`${ie}float inputs:clearcoat = ${re.clearcoat}`),re.clearcoatRoughnessMap!==null?(ne.push(`${ie}float inputs:clearcoatRoughness.connect = </Materials/Material_${re.id}/Texture_${re.clearcoatRoughnessMap.id}_clearcoatRoughness.outputs:g>`),F.push(fe(re.clearcoatRoughnessMap,"clearcoatRoughness",new Color(re.clearcoatRoughness,re.clearcoatRoughness,re.clearcoatRoughness)))):ne.push(`${ie}float inputs:clearcoatRoughness = ${re.clearcoatRoughness}`),ne.push(`${ie}float inputs:ior = ${re.ior}`)),`
	def Material "Material_${re.id}"
	{
		def Shader "PreviewSurface"
		{
			uniform token info:id = "UsdPreviewSurface"
${ne.join(`
`)}
			int inputs:useSpecularWorkflow = 0
			token outputs:surface
		}

		token outputs:surface.connect = </Materials/Material_${re.id}/PreviewSurface.outputs:surface>

${F.join(`
`)}

	}
`}function buildColor(re){return`(${re.r}, ${re.g}, ${re.b})`}function buildColor4(re){return`(${re.r}, ${re.g}, ${re.b}, 1.0)`}function buildVector2(re){return`(${re.x}, ${re.y})`}function buildCamera(re){const U=re.name?re.name:"Camera_"+re.id,Y=buildMatrix(re.matrixWorld);return re.matrixWorld.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",re),re.isOrthographicCamera?`def Camera "${U}"
		{
			matrix4d xformOp:transform = ${Y}
			uniform token[] xformOpOrder = ["xformOp:transform"]

			float2 clippingRange = (${re.near.toPrecision(PRECISION)}, ${re.far.toPrecision(PRECISION)})
			float horizontalAperture = ${((Math.abs(re.left)+Math.abs(re.right))*10).toPrecision(PRECISION)}
			float verticalAperture = ${((Math.abs(re.top)+Math.abs(re.bottom))*10).toPrecision(PRECISION)}
			token projection = "orthographic"
		}
	
	`:`def Camera "${U}"
		{
			matrix4d xformOp:transform = ${Y}
			uniform token[] xformOpOrder = ["xformOp:transform"]

			float2 clippingRange = (${re.near.toPrecision(PRECISION)}, ${re.far.toPrecision(PRECISION)})
			float focalLength = ${re.getFocalLength().toPrecision(PRECISION)}
			float focusDistance = ${re.focus.toPrecision(PRECISION)}
			float horizontalAperture = ${re.getFilmWidth().toPrecision(PRECISION)}
			token projection = "perspective"
			float verticalAperture = ${re.getFilmHeight().toPrecision(PRECISION)}
		}
	
	`}/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const enumerationDeserializer=re=>U=>{try{const Y=parseExpressions(U),ie=(Y.length?Y[0].terms:[]).filter(ne=>ne&&ne.type==="ident").map(ne=>ne.value).filter(ne=>re.indexOf(ne)>-1);return new Set(ie)}catch{}return new Set};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$2=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};let isWebXRBlocked=!1,isSceneViewerBlocked=!1;const noArViewerSigil="#model-viewer-no-ar-fallback",deserializeARModes=enumerationDeserializer(["quick-look","scene-viewer","webxr","none"]),DEFAULT_AR_MODES="webxr scene-viewer quick-look",ARMode={QUICK_LOOK:"quick-look",SCENE_VIEWER:"scene-viewer",WEBXR:"webxr",NONE:"none"},$arButtonContainer=Symbol("arButtonContainer"),$enterARWithWebXR=Symbol("enterARWithWebXR"),$openSceneViewer=Symbol("openSceneViewer"),$openIOSARQuickLook=Symbol("openIOSARQuickLook"),$canActivateAR=Symbol("canActivateAR"),$arMode=Symbol("arMode"),$arModes=Symbol("arModes"),$arAnchor=Symbol("arAnchor"),$preload=Symbol("preload"),$onARButtonContainerClick=Symbol("onARButtonContainerClick"),$onARStatus=Symbol("onARStatus"),$onARTracking=Symbol("onARTracking"),$onARTap=Symbol("onARTap"),$selectARMode=Symbol("selectARMode"),$triggerLoad=Symbol("triggerLoad"),ARMixin=re=>{var U,Y,ie,ne,F,fe,pe,Me,ve,se;class me extends re{constructor(){super(...arguments),this.ar=!1,this.arScale="auto",this.arPlacement="floor",this.arModes=DEFAULT_AR_MODES,this.iosSrc=null,this.xrEnvironment=!1,this[U]=!1,this[Y]=this.shadowRoot.querySelector(".ar-button"),this[ie]=document.createElement("a"),this[ne]=new Set,this[F]=ARMode.NONE,this[fe]=!1,this[pe]=Re=>{Re.preventDefault(),this.activateAR()},this[Me]=({status:Re})=>{(Re===ARStatus.NOT_PRESENTING||this[$renderer].arRenderer.presentedScene===this[$scene])&&(this.setAttribute("ar-status",Re),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:Re}})),Re===ARStatus.NOT_PRESENTING?this.removeAttribute("ar-tracking"):Re===ARStatus.SESSION_STARTED&&this.setAttribute("ar-tracking",ARTracking.TRACKING))},this[ve]=({status:Re})=>{this.setAttribute("ar-tracking",Re),this.dispatchEvent(new CustomEvent("ar-tracking",{detail:{status:Re}}))},this[se]=Re=>{Re.data=="_apple_ar_quicklook_button_tapped"&&this.dispatchEvent(new CustomEvent("quick-look-button-tapped"))}}get canActivateAR(){return this[$arMode]!==ARMode.NONE}connectedCallback(){super.connectedCallback(),this[$renderer].arRenderer.addEventListener("status",this[$onARStatus]),this.setAttribute("ar-status",ARStatus.NOT_PRESENTING),this[$renderer].arRenderer.addEventListener("tracking",this[$onARTracking]),this[$arAnchor].addEventListener("message",this[$onARTap])}disconnectedCallback(){super.disconnectedCallback(),this[$renderer].arRenderer.removeEventListener("status",this[$onARStatus]),this[$renderer].arRenderer.removeEventListener("tracking",this[$onARTracking]),this[$arAnchor].removeEventListener("message",this[$onARTap])}update(Re){super.update(Re),Re.has("arScale")&&(this[$scene].canScale=this.arScale!=="fixed"),Re.has("arPlacement")&&(this[$scene].updateShadow(),this[$needsRender]()),Re.has("arModes")&&(this[$arModes]=deserializeARModes(this.arModes)),(Re.has("ar")||Re.has("arModes")||Re.has("src")||Re.has("iosSrc"))&&this[$selectARMode]()}async activateAR(){switch(this[$arMode]){case ARMode.QUICK_LOOK:await this[$openIOSARQuickLook]();break;case ARMode.WEBXR:await this[$enterARWithWebXR]();break;case ARMode.SCENE_VIEWER:this[$openSceneViewer]();break;default:console.warn("No AR Mode can be activated. This is probably due to missing configuration or device capabilities");break}}async[(U=$canActivateAR,Y=$arButtonContainer,ie=$arAnchor,ne=$arModes,F=$arMode,fe=$preload,pe=$onARButtonContainerClick,Me=$onARStatus,ve=$onARTracking,se=$onARTap,$selectARMode)](){var Re;let be=ARMode.NONE;if(this.ar){if(this.src!=null)for(const Pe of this[$arModes]){if(Pe==="webxr"&&IS_WEBXR_AR_CANDIDATE&&!isWebXRBlocked&&await this[$renderer].arRenderer.supportsPresentation()){be=ARMode.WEBXR;break}if(Pe==="scene-viewer"&&!isSceneViewerBlocked&&(IS_SCENEVIEWER_CANDIDATE||navigator.userAgentData&&navigator.userAgentData.getHighEntropyValues&&(!((Re=(await navigator.userAgentData.getHighEntropyValues(["formFactor"])).formFactor)===null||Re===void 0)&&Re.includes("XR")))){be=ARMode.SCENE_VIEWER;break}if(Pe==="quick-look"&&IS_AR_QUICKLOOK_CANDIDATE){be=ARMode.QUICK_LOOK;break}}be===ARMode.NONE&&this.iosSrc!=null&&IS_AR_QUICKLOOK_CANDIDATE&&(be=ARMode.QUICK_LOOK)}if(be!==ARMode.NONE)this[$arButtonContainer].classList.add("enabled"),this[$arButtonContainer].addEventListener("click",this[$onARButtonContainerClick]);else if(this[$arButtonContainer].classList.contains("enabled")){this[$arButtonContainer].removeEventListener("click",this[$onARButtonContainerClick]),this[$arButtonContainer].classList.remove("enabled");const Pe=ARStatus.FAILED;this.setAttribute("ar-status",Pe),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:Pe}}))}this[$arMode]=be}async[$enterARWithWebXR](){console.log("Attempting to present in AR with WebXR..."),await this[$triggerLoad]();try{this[$arButtonContainer].removeEventListener("click",this[$onARButtonContainerClick]);const{arRenderer:Re}=this[$renderer];Re.placeOnWall=this.arPlacement==="wall",await Re.present(this[$scene],this.xrEnvironment)}catch(Re){console.warn("Error while trying to present in AR with WebXR"),console.error(Re),await this[$renderer].arRenderer.stopPresenting(),isWebXRBlocked=!0,console.warn("Falling back to next ar-mode"),await this[$selectARMode](),this.activateAR()}finally{this[$selectARMode]()}}async[$triggerLoad](){this.loaded||(this[$preload]=!0,this[$updateSource](),await waitForEvent(this,"load"),this[$preload]=!1)}[$shouldAttemptPreload](){return super[$shouldAttemptPreload]()||this[$preload]}[$openSceneViewer](){const Re=self.location.toString(),be=new URL(Re),Pe=new URL(this.src,Re);Pe.hash&&(Pe.hash="");const Le=new URLSearchParams(Pe.search);if(be.hash=noArViewerSigil,Le.set("mode","ar_preferred"),Le.has("disable_occlusion")||Le.set("disable_occlusion","true"),this.arScale==="fixed"&&Le.set("resizable","false"),this.arPlacement==="wall"&&Le.set("enable_vertical_placement","true"),Le.has("sound")){const Oe=new URL(Le.get("sound"),Re);Le.set("sound",Oe.toString())}if(Le.has("link")){const Oe=new URL(Le.get("link"),Re);Le.set("link",Oe.toString())}const xe=`intent://arvr.google.com/scene-viewer/1.2?${Le.toString()+"&file="+encodeURIComponent(Pe.toString())}#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;S.browser_fallback_url=${encodeURIComponent(be.toString())};end;`,Fe=()=>{self.location.hash===noArViewerSigil&&(isSceneViewerBlocked=!0,self.history.back(),console.warn("Error while trying to present in AR with Scene Viewer"),console.warn("Falling back to next ar-mode"),this[$selectARMode]())};self.addEventListener("hashchange",Fe,{once:!0}),this[$arAnchor].setAttribute("href",xe),console.log("Attempting to present in AR with Scene Viewer..."),this[$arAnchor].click()}async[$openIOSARQuickLook](){const Re=!this.iosSrc;this[$arButtonContainer].classList.remove("enabled");const be=Re?await this.prepareUSDZ():this.iosSrc,Pe=new URL(be,self.location.toString());if(Re){const Fe=self.location.toString(),Oe=new URL(Fe),Ne=new URL(this.src,Oe);Ne.hash&&(Pe.hash=Ne.hash)}this.arScale==="fixed"&&(Pe.hash&&(Pe.hash+="&"),Pe.hash+="allowsContentScaling=0");const Le=this[$arAnchor];Le.setAttribute("rel","ar");const xe=document.createElement("img");Le.appendChild(xe),Le.setAttribute("href",Pe.toString()),Re&&Le.setAttribute("download","model.usdz"),Le.style.display="none",Le.isConnected||this.shadowRoot.appendChild(Le),console.log("Attempting to present in AR with Quick Look..."),Le.click(),Le.removeChild(xe),Re&&URL.revokeObjectURL(be),this[$arButtonContainer].classList.add("enabled")}async prepareUSDZ(){const Re=this[$progressTracker].beginActivity("usdz-conversion");await this[$triggerLoad]();const{model:be,shadow:Pe,target:Le}=this[$scene];if(be==null)return"";let xe=!1;Pe!=null&&(xe=Pe.visible,Pe.visible=!1),Re(.2);const Fe=new USDZExporter;Le.remove(be),be.position.copy(Le.position),be.updateWorldMatrix(!1,!0);const Oe=await Fe.parseAsync(be);be.position.set(0,0,0),Le.add(be);const Ne=new Blob([Oe],{type:"model/vnd.usdz+zip"}),ke=URL.createObjectURL(Ne);return Re(1),Pe!=null&&(Pe.visible=xe),ke}}return __decorate$2([n$6({type:Boolean,attribute:"ar"})],me.prototype,"ar",void 0),__decorate$2([n$6({type:String,attribute:"ar-scale"})],me.prototype,"arScale",void 0),__decorate$2([n$6({type:String,attribute:"ar-placement"})],me.prototype,"arPlacement",void 0),__decorate$2([n$6({type:String,attribute:"ar-modes"})],me.prototype,"arModes",void 0),__decorate$2([n$6({type:String,attribute:"ios-src"})],me.prototype,"iosSrc",void 0),__decorate$2([n$6({type:Boolean,attribute:"xr-environment"})],me.prototype,"xrEnvironment",void 0),me};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate$1=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};const PROGRESS_BAR_UPDATE_THRESHOLD=100,DEFAULT_DRACO_DECODER_LOCATION="https://www.gstatic.com/draco/versioned/decoders/1.5.6/",DEFAULT_KTX2_TRANSCODER_LOCATION="https://www.gstatic.com/basis-universal/versioned/2021-04-15-ba1c3e4/",DEFAULT_LOTTIE_LOADER_LOCATION="https://cdn.jsdelivr.net/npm/three@0.149.0/examples/jsm/loaders/LottieLoader.js",RevealStrategy={AUTO:"auto",MANUAL:"manual"},LoadingStrategy={AUTO:"auto",LAZY:"lazy",EAGER:"eager"},$defaultProgressBarElement=Symbol("defaultProgressBarElement"),$posterContainerElement=Symbol("posterContainerElement"),$defaultPosterElement=Symbol("defaultPosterElement"),$shouldDismissPoster=Symbol("shouldDismissPoster"),$hidePoster=Symbol("hidePoster"),$modelIsRevealed=Symbol("modelIsRevealed"),$updateProgressBar=Symbol("updateProgressBar"),$ariaLabelCallToAction=Symbol("ariaLabelCallToAction"),$onProgress=Symbol("onProgress"),LoadingMixin=re=>{var U,Y,ie,ne,F,fe,pe,Me;class ve extends re{constructor(...me){super(...me),this.poster=null,this.reveal=RevealStrategy.AUTO,this.loading=LoadingStrategy.AUTO,this[U]=!1,this[Y]=!1,this[ie]=this.shadowRoot.querySelector(".slot.poster"),this[ne]=this.shadowRoot.querySelector("#default-poster"),this[F]=this.shadowRoot.querySelector("#default-progress-bar > .bar"),this[fe]=this[$defaultPosterElement].getAttribute("aria-label"),this[pe]=throttle(Le=>{const xe=this[$defaultProgressBarElement].parentNode;requestAnimationFrame(()=>{this[$defaultProgressBarElement].style.transform=`scaleX(${Le})`,Le===0&&(xe.removeChild(this[$defaultProgressBarElement]),xe.appendChild(this[$defaultProgressBarElement])),this[$defaultProgressBarElement].classList.toggle("hide",Le===1)})},PROGRESS_BAR_UPDATE_THRESHOLD),this[Me]=Le=>{const xe=Le.detail.totalProgress,Fe=Le.detail.reason;xe===1&&(this[$updateProgressBar].flush(),this.loaded&&(this[$shouldDismissPoster]||this.reveal===RevealStrategy.AUTO)&&this[$hidePoster]()),this[$updateProgressBar](xe),this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:xe,reason:Fe}}))};const Te=self.ModelViewerElement||{},Re=Te.dracoDecoderLocation||DEFAULT_DRACO_DECODER_LOCATION;CachingGLTFLoader.setDRACODecoderLocation(Re);const be=Te.ktx2TranscoderLocation||DEFAULT_KTX2_TRANSCODER_LOCATION;CachingGLTFLoader.setKTX2TranscoderLocation(be),Te.meshoptDecoderLocation&&CachingGLTFLoader.setMeshoptDecoderLocation(Te.meshoptDecoderLocation);const Pe=Te.lottieLoaderLocation||DEFAULT_LOTTIE_LOADER_LOCATION;Renderer.singleton.textureUtils.lottieLoaderUrl=Pe}static set dracoDecoderLocation(me){CachingGLTFLoader.setDRACODecoderLocation(me)}static get dracoDecoderLocation(){return CachingGLTFLoader.getDRACODecoderLocation()}static set ktx2TranscoderLocation(me){CachingGLTFLoader.setKTX2TranscoderLocation(me)}static get ktx2TranscoderLocation(){return CachingGLTFLoader.getKTX2TranscoderLocation()}static set meshoptDecoderLocation(me){CachingGLTFLoader.setMeshoptDecoderLocation(me)}static get meshoptDecoderLocation(){return CachingGLTFLoader.getMeshoptDecoderLocation()}static set lottieLoaderLocation(me){Renderer.singleton.textureUtils.lottieLoaderUrl=me}static get lottieLoaderLocation(){return Renderer.singleton.textureUtils.lottieLoaderUrl}static mapURLs(me){Renderer.singleton.loader[$loader].manager.setURLModifier(me)}dismissPoster(){this.loaded?this[$hidePoster]():(this[$shouldDismissPoster]=!0,this[$updateSource]())}showPoster(){const me=this[$posterContainerElement];if(me.classList.contains("show"))return;me.classList.add("show"),this[$userInputElement].classList.remove("show");const Te=this[$defaultPosterElement];Te.removeAttribute("tabindex"),Te.removeAttribute("aria-hidden");const Re=this.modelIsVisible;this[$modelIsRevealed]=!1,this[$announceModelVisibility](Re)}getDimensions(){return toVector3D(this[$scene].size)}getBoundingBoxCenter(){return toVector3D(this[$scene].boundingBox.getCenter(new Vector3))}connectedCallback(){super.connectedCallback(),this.loaded||this.showPoster(),this[$progressTracker].addEventListener("progress",this[$onProgress])}disconnectedCallback(){super.disconnectedCallback(),this[$progressTracker].removeEventListener("progress",this[$onProgress])}async updated(me){super.updated(me),me.has("poster")&&this.poster!=null&&(this[$defaultPosterElement].style.backgroundImage=`url(${this.poster})`),me.has("alt")&&this[$defaultPosterElement].setAttribute("aria-label",this[$altDefaulted]),(me.has("reveal")||me.has("loading"))&&this[$updateSource]()}[(U=$modelIsRevealed,Y=$shouldDismissPoster,ie=$posterContainerElement,ne=$defaultPosterElement,F=$defaultProgressBarElement,fe=$ariaLabelCallToAction,pe=$updateProgressBar,Me=$onProgress,$shouldAttemptPreload)](){return!!this.src&&(this[$shouldDismissPoster]||this.loading===LoadingStrategy.EAGER||this.reveal===RevealStrategy.AUTO&&this[$isElementInViewport])}[$hidePoster](){this[$shouldDismissPoster]=!1;const me=this[$posterContainerElement];if(!me.classList.contains("show"))return;me.classList.remove("show"),this[$userInputElement].classList.add("show");const Te=this.modelIsVisible;this[$modelIsRevealed]=!0,this[$announceModelVisibility](Te);const Re=this.getRootNode();Re&&Re.activeElement===this&&this[$userInputElement].focus();const be=this[$defaultPosterElement];be.setAttribute("aria-hidden","true"),be.tabIndex=-1,this.dispatchEvent(new CustomEvent("poster-dismissed"))}[$getModelIsVisible](){return super[$getModelIsVisible]()&&this[$modelIsRevealed]}}return __decorate$1([n$6({type:String})],ve.prototype,"poster",void 0),__decorate$1([n$6({type:String})],ve.prototype,"reveal",void 0),__decorate$1([n$6({type:String})],ve.prototype,"loading",void 0),ve};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __decorate=function(re,U,Y,ie){var ne=arguments.length,F=ne<3?U:ie===null?ie=Object.getOwnPropertyDescriptor(U,Y):ie,fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(re,U,Y,ie);else for(var pe=re.length-1;pe>=0;pe--)(fe=re[pe])&&(F=(ne<3?fe(F):ne>3?fe(U,Y,F):fe(U,Y))||F);return ne>3&&F&&Object.defineProperty(U,Y,F),F};const DEFAULT_ROTATION_SPEED=Math.PI/32,AUTO_ROTATE_DELAY_DEFAULT=3e3,rotationRateIntrinsics={basis:[degreesToRadians(numberNode(DEFAULT_ROTATION_SPEED,"rad"))],keywords:{auto:[null]}},$autoRotateStartTime=Symbol("autoRotateStartTime"),$radiansPerSecond=Symbol("radiansPerSecond"),$syncRotationRate=Symbol("syncRotationRate"),$onCameraChange=Symbol("onCameraChange"),StagingMixin=re=>{var U,Y,ie;class ne extends re{constructor(){super(...arguments),this.autoRotate=!1,this.autoRotateDelay=AUTO_ROTATE_DELAY_DEFAULT,this.rotationPerSecond="auto",this[U]=performance.now(),this[Y]=0,this[ie]=fe=>{this.autoRotate&&fe.detail.source==="user-interaction"&&(this[$autoRotateStartTime]=performance.now())}}connectedCallback(){super.connectedCallback(),this.addEventListener("camera-change",this[$onCameraChange]),this[$autoRotateStartTime]=performance.now()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("camera-change",this[$onCameraChange]),this[$autoRotateStartTime]=performance.now()}updated(fe){super.updated(fe),fe.has("autoRotate")&&(this[$autoRotateStartTime]=performance.now())}[(U=$autoRotateStartTime,Y=$radiansPerSecond,$syncRotationRate)](fe){this[$radiansPerSecond]=fe[0]}[$tick](fe,pe){if(super[$tick](fe,pe),!this.autoRotate||!this[$getModelIsVisible]()||this[$renderer].isPresenting)return;const Me=Math.min(pe,fe-this[$autoRotateStartTime]-this.autoRotateDelay);Me>0&&(this[$scene].yaw=this.turntableRotation+this[$radiansPerSecond]*Me*.001)}get turntableRotation(){return this[$scene].yaw}resetTurntableRotation(fe=0){this[$scene].yaw=fe}}return ie=$onCameraChange,__decorate([n$6({type:Boolean,attribute:"auto-rotate"})],ne.prototype,"autoRotate",void 0),__decorate([n$6({type:Number,attribute:"auto-rotate-delay"})],ne.prototype,"autoRotateDelay",void 0),__decorate([style({intrinsics:rotationRateIntrinsics,updateHandler:$syncRotationRate}),n$6({type:String,attribute:"rotation-per-second"})],ne.prototype,"rotationPerSecond",void 0),ne};/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ModelViewerElement=AnnotationMixin(SceneGraphMixin(StagingMixin(EnvironmentMixin(ControlsMixin(ARMixin(LoadingMixin(AnimationMixin(ModelViewerElementBase))))))));customElements.define("model-viewer",ModelViewerElement);var aframeMaster={exports:{}},hasRequiredAframeMaster;function requireAframeMaster(){return hasRequiredAframeMaster||(hasRequiredAframeMaster=1,function(re,U){var Y={};(function(ne,F){re.exports=F()})(self,()=>(()=>{var ie={"./node_modules/an-array/index.js":pe=>{var Me=Object.prototype.toString;pe.exports=ve;function ve(se){return se.BYTES_PER_ELEMENT&&Me.call(se.buffer)==="[object ArrayBuffer]"||Array.isArray(se)}},"./node_modules/as-number/index.js":pe=>{pe.exports=function(ve,se){return typeof ve=="number"?ve:typeof se=="number"?se:0}},"./node_modules/base64-js/index.js":(pe,Me)=>{Me.byteLength=Le,Me.toByteArray=Fe,Me.fromByteArray=ke;for(var ve=[],se=[],me=typeof Uint8Array<"u"?Uint8Array:Array,Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Re=0,be=Te.length;Re<be;++Re)ve[Re]=Te[Re],se[Te.charCodeAt(Re)]=Re;se[45]=62,se[95]=63;function Pe(Ve){var Xe=Ve.length;if(Xe%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var $e=Ve.indexOf("=");$e===-1&&($e=Xe);var st=$e===Xe?0:4-$e%4;return[$e,st]}function Le(Ve){var Xe=Pe(Ve),$e=Xe[0],st=Xe[1];return($e+st)*3/4-st}function xe(Ve,Xe,$e){return(Xe+$e)*3/4-$e}function Fe(Ve){var Xe,$e=Pe(Ve),st=$e[0],ze=$e[1],tt=new me(xe(Ve,st,ze)),ft=0,Rt=ze>0?st-4:st,Mt;for(Mt=0;Mt<Rt;Mt+=4)Xe=se[Ve.charCodeAt(Mt)]<<18|se[Ve.charCodeAt(Mt+1)]<<12|se[Ve.charCodeAt(Mt+2)]<<6|se[Ve.charCodeAt(Mt+3)],tt[ft++]=Xe>>16&255,tt[ft++]=Xe>>8&255,tt[ft++]=Xe&255;return ze===2&&(Xe=se[Ve.charCodeAt(Mt)]<<2|se[Ve.charCodeAt(Mt+1)]>>4,tt[ft++]=Xe&255),ze===1&&(Xe=se[Ve.charCodeAt(Mt)]<<10|se[Ve.charCodeAt(Mt+1)]<<4|se[Ve.charCodeAt(Mt+2)]>>2,tt[ft++]=Xe>>8&255,tt[ft++]=Xe&255),tt}function Oe(Ve){return ve[Ve>>18&63]+ve[Ve>>12&63]+ve[Ve>>6&63]+ve[Ve&63]}function Ne(Ve,Xe,$e){for(var st,ze=[],tt=Xe;tt<$e;tt+=3)st=(Ve[tt]<<16&16711680)+(Ve[tt+1]<<8&65280)+(Ve[tt+2]&255),ze.push(Oe(st));return ze.join("")}function ke(Ve){for(var Xe,$e=Ve.length,st=$e%3,ze=[],tt=16383,ft=0,Rt=$e-st;ft<Rt;ft+=tt)ze.push(Ne(Ve,ft,ft+tt>Rt?Rt:ft+tt));return st===1?(Xe=Ve[$e-1],ze.push(ve[Xe>>2]+ve[Xe<<4&63]+"==")):st===2&&(Xe=(Ve[$e-2]<<8)+Ve[$e-1],ze.push(ve[Xe>>10]+ve[Xe>>4&63]+ve[Xe<<2&63]+"=")),ze.join("")}},"./node_modules/buffer-equal/index.js":(pe,Me,ve)=>{var se=ve("./node_modules/buffer/index.js").Buffer;pe.exports=function(me,Te){if(se.isBuffer(me)&&se.isBuffer(Te)){if(typeof me.equals=="function")return me.equals(Te);if(me.length!==Te.length)return!1;for(var Re=0;Re<me.length;Re++)if(me[Re]!==Te[Re])return!1;return!0}}},"./node_modules/buffer/index.js":(pe,Me,ve)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const se=ve("./node_modules/base64-js/index.js"),me=ve("./node_modules/ieee754/index.js"),Te=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Me.Buffer=Le,Me.SlowBuffer=tt,Me.INSPECT_MAX_BYTES=50;const Re=2147483647;Me.kMaxLength=Re,Le.TYPED_ARRAY_SUPPORT=be(),!Le.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function be(){try{const Nt=new Uint8Array(1),ht={foo:function(){return 42}};return Object.setPrototypeOf(ht,Uint8Array.prototype),Object.setPrototypeOf(Nt,ht),Nt.foo()===42}catch{return!1}}Object.defineProperty(Le.prototype,"parent",{enumerable:!0,get:function(){if(Le.isBuffer(this))return this.buffer}}),Object.defineProperty(Le.prototype,"offset",{enumerable:!0,get:function(){if(Le.isBuffer(this))return this.byteOffset}});function Pe(Nt){if(Nt>Re)throw new RangeError('The value "'+Nt+'" is invalid for option "size"');const ht=new Uint8Array(Nt);return Object.setPrototypeOf(ht,Le.prototype),ht}function Le(Nt,ht,ot){if(typeof Nt=="number"){if(typeof ht=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Ne(Nt)}return xe(Nt,ht,ot)}Le.poolSize=8192;function xe(Nt,ht,ot){if(typeof Nt=="string")return ke(Nt,ht);if(ArrayBuffer.isView(Nt))return Xe(Nt);if(Nt==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Nt);if(Yt(Nt,ArrayBuffer)||Nt&&Yt(Nt.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Yt(Nt,SharedArrayBuffer)||Nt&&Yt(Nt.buffer,SharedArrayBuffer)))return $e(Nt,ht,ot);if(typeof Nt=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Vt=Nt.valueOf&&Nt.valueOf();if(Vt!=null&&Vt!==Nt)return Le.from(Vt,ht,ot);const Wt=st(Nt);if(Wt)return Wt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Nt[Symbol.toPrimitive]=="function")return Le.from(Nt[Symbol.toPrimitive]("string"),ht,ot);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Nt)}Le.from=function(Nt,ht,ot){return xe(Nt,ht,ot)},Object.setPrototypeOf(Le.prototype,Uint8Array.prototype),Object.setPrototypeOf(Le,Uint8Array);function Fe(Nt){if(typeof Nt!="number")throw new TypeError('"size" argument must be of type number');if(Nt<0)throw new RangeError('The value "'+Nt+'" is invalid for option "size"')}function Oe(Nt,ht,ot){return Fe(Nt),Nt<=0?Pe(Nt):ht!==void 0?typeof ot=="string"?Pe(Nt).fill(ht,ot):Pe(Nt).fill(ht):Pe(Nt)}Le.alloc=function(Nt,ht,ot){return Oe(Nt,ht,ot)};function Ne(Nt){return Fe(Nt),Pe(Nt<0?0:ze(Nt)|0)}Le.allocUnsafe=function(Nt){return Ne(Nt)},Le.allocUnsafeSlow=function(Nt){return Ne(Nt)};function ke(Nt,ht){if((typeof ht!="string"||ht==="")&&(ht="utf8"),!Le.isEncoding(ht))throw new TypeError("Unknown encoding: "+ht);const ot=ft(Nt,ht)|0;let Vt=Pe(ot);const Wt=Vt.write(Nt,ht);return Wt!==ot&&(Vt=Vt.slice(0,Wt)),Vt}function Ve(Nt){const ht=Nt.length<0?0:ze(Nt.length)|0,ot=Pe(ht);for(let Vt=0;Vt<ht;Vt+=1)ot[Vt]=Nt[Vt]&255;return ot}function Xe(Nt){if(Yt(Nt,Uint8Array)){const ht=new Uint8Array(Nt);return $e(ht.buffer,ht.byteOffset,ht.byteLength)}return Ve(Nt)}function $e(Nt,ht,ot){if(ht<0||Nt.byteLength<ht)throw new RangeError('"offset" is outside of buffer bounds');if(Nt.byteLength<ht+(ot||0))throw new RangeError('"length" is outside of buffer bounds');let Vt;return ht===void 0&&ot===void 0?Vt=new Uint8Array(Nt):ot===void 0?Vt=new Uint8Array(Nt,ht):Vt=new Uint8Array(Nt,ht,ot),Object.setPrototypeOf(Vt,Le.prototype),Vt}function st(Nt){if(Le.isBuffer(Nt)){const ht=ze(Nt.length)|0,ot=Pe(ht);return ot.length===0||Nt.copy(ot,0,0,ht),ot}if(Nt.length!==void 0)return typeof Nt.length!="number"||fn(Nt.length)?Pe(0):Ve(Nt);if(Nt.type==="Buffer"&&Array.isArray(Nt.data))return Ve(Nt.data)}function ze(Nt){if(Nt>=Re)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Re.toString(16)+" bytes");return Nt|0}function tt(Nt){return+Nt!=Nt&&(Nt=0),Le.alloc(+Nt)}Le.isBuffer=function(ht){return ht!=null&&ht._isBuffer===!0&&ht!==Le.prototype},Le.compare=function(ht,ot){if(Yt(ht,Uint8Array)&&(ht=Le.from(ht,ht.offset,ht.byteLength)),Yt(ot,Uint8Array)&&(ot=Le.from(ot,ot.offset,ot.byteLength)),!Le.isBuffer(ht)||!Le.isBuffer(ot))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ht===ot)return 0;let Vt=ht.length,Wt=ot.length;for(let sn=0,yn=Math.min(Vt,Wt);sn<yn;++sn)if(ht[sn]!==ot[sn]){Vt=ht[sn],Wt=ot[sn];break}return Vt<Wt?-1:Wt<Vt?1:0},Le.isEncoding=function(ht){switch(String(ht).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Le.concat=function(ht,ot){if(!Array.isArray(ht))throw new TypeError('"list" argument must be an Array of Buffers');if(ht.length===0)return Le.alloc(0);let Vt;if(ot===void 0)for(ot=0,Vt=0;Vt<ht.length;++Vt)ot+=ht[Vt].length;const Wt=Le.allocUnsafe(ot);let sn=0;for(Vt=0;Vt<ht.length;++Vt){let yn=ht[Vt];if(Yt(yn,Uint8Array))sn+yn.length>Wt.length?(Le.isBuffer(yn)||(yn=Le.from(yn)),yn.copy(Wt,sn)):Uint8Array.prototype.set.call(Wt,yn,sn);else if(Le.isBuffer(yn))yn.copy(Wt,sn);else throw new TypeError('"list" argument must be an Array of Buffers');sn+=yn.length}return Wt};function ft(Nt,ht){if(Le.isBuffer(Nt))return Nt.length;if(ArrayBuffer.isView(Nt)||Yt(Nt,ArrayBuffer))return Nt.byteLength;if(typeof Nt!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Nt);const ot=Nt.length,Vt=arguments.length>2&&arguments[2]===!0;if(!Vt&&ot===0)return 0;let Wt=!1;for(;;)switch(ht){case"ascii":case"latin1":case"binary":return ot;case"utf8":case"utf-8":return Nr(Nt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ot*2;case"hex":return ot>>>1;case"base64":return Bi(Nt).length;default:if(Wt)return Vt?-1:Nr(Nt).length;ht=(""+ht).toLowerCase(),Wt=!0}}Le.byteLength=ft;function Rt(Nt,ht,ot){let Vt=!1;if((ht===void 0||ht<0)&&(ht=0),ht>this.length||((ot===void 0||ot>this.length)&&(ot=this.length),ot<=0)||(ot>>>=0,ht>>>=0,ot<=ht))return"";for(Nt||(Nt="utf8");;)switch(Nt){case"hex":return Qn(this,ht,ot);case"utf8":case"utf-8":return hn(this,ht,ot);case"ascii":return Cn(this,ht,ot);case"latin1":case"binary":return Nn(this,ht,ot);case"base64":return Xt(this,ht,ot);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fi(this,ht,ot);default:if(Vt)throw new TypeError("Unknown encoding: "+Nt);Nt=(Nt+"").toLowerCase(),Vt=!0}}Le.prototype._isBuffer=!0;function Mt(Nt,ht,ot){const Vt=Nt[ht];Nt[ht]=Nt[ot],Nt[ot]=Vt}Le.prototype.swap16=function(){const ht=this.length;if(ht%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let ot=0;ot<ht;ot+=2)Mt(this,ot,ot+1);return this},Le.prototype.swap32=function(){const ht=this.length;if(ht%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let ot=0;ot<ht;ot+=4)Mt(this,ot,ot+3),Mt(this,ot+1,ot+2);return this},Le.prototype.swap64=function(){const ht=this.length;if(ht%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let ot=0;ot<ht;ot+=8)Mt(this,ot,ot+7),Mt(this,ot+1,ot+6),Mt(this,ot+2,ot+5),Mt(this,ot+3,ot+4);return this},Le.prototype.toString=function(){const ht=this.length;return ht===0?"":arguments.length===0?hn(this,0,ht):Rt.apply(this,arguments)},Le.prototype.toLocaleString=Le.prototype.toString,Le.prototype.equals=function(ht){if(!Le.isBuffer(ht))throw new TypeError("Argument must be a Buffer");return this===ht?!0:Le.compare(this,ht)===0},Le.prototype.inspect=function(){let ht="";const ot=Me.INSPECT_MAX_BYTES;return ht=this.toString("hex",0,ot).replace(/(.{2})/g,"$1 ").trim(),this.length>ot&&(ht+=" ... "),"<Buffer "+ht+">"},Te&&(Le.prototype[Te]=Le.prototype.inspect),Le.prototype.compare=function(ht,ot,Vt,Wt,sn){if(Yt(ht,Uint8Array)&&(ht=Le.from(ht,ht.offset,ht.byteLength)),!Le.isBuffer(ht))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ht);if(ot===void 0&&(ot=0),Vt===void 0&&(Vt=ht?ht.length:0),Wt===void 0&&(Wt=0),sn===void 0&&(sn=this.length),ot<0||Vt>ht.length||Wt<0||sn>this.length)throw new RangeError("out of range index");if(Wt>=sn&&ot>=Vt)return 0;if(Wt>=sn)return-1;if(ot>=Vt)return 1;if(ot>>>=0,Vt>>>=0,Wt>>>=0,sn>>>=0,this===ht)return 0;let yn=sn-Wt,ni=Vt-ot;const ki=Math.min(yn,ni),Hi=this.slice(Wt,sn),ji=ht.slice(ot,Vt);for(let Xi=0;Xi<ki;++Xi)if(Hi[Xi]!==ji[Xi]){yn=Hi[Xi],ni=ji[Xi];break}return yn<ni?-1:ni<yn?1:0};function Gt(Nt,ht,ot,Vt,Wt){if(Nt.length===0)return-1;if(typeof ot=="string"?(Vt=ot,ot=0):ot>2147483647?ot=2147483647:ot<-2147483648&&(ot=-2147483648),ot=+ot,fn(ot)&&(ot=Wt?0:Nt.length-1),ot<0&&(ot=Nt.length+ot),ot>=Nt.length){if(Wt)return-1;ot=Nt.length-1}else if(ot<0)if(Wt)ot=0;else return-1;if(typeof ht=="string"&&(ht=Le.from(ht,Vt)),Le.isBuffer(ht))return ht.length===0?-1:_t(Nt,ht,ot,Vt,Wt);if(typeof ht=="number")return ht=ht&255,typeof Uint8Array.prototype.indexOf=="function"?Wt?Uint8Array.prototype.indexOf.call(Nt,ht,ot):Uint8Array.prototype.lastIndexOf.call(Nt,ht,ot):_t(Nt,[ht],ot,Vt,Wt);throw new TypeError("val must be string, number or Buffer")}function _t(Nt,ht,ot,Vt,Wt){let sn=1,yn=Nt.length,ni=ht.length;if(Vt!==void 0&&(Vt=String(Vt).toLowerCase(),Vt==="ucs2"||Vt==="ucs-2"||Vt==="utf16le"||Vt==="utf-16le")){if(Nt.length<2||ht.length<2)return-1;sn=2,yn/=2,ni/=2,ot/=2}function ki(ji,Xi){return sn===1?ji[Xi]:ji.readUInt16BE(Xi*sn)}let Hi;if(Wt){let ji=-1;for(Hi=ot;Hi<yn;Hi++)if(ki(Nt,Hi)===ki(ht,ji===-1?0:Hi-ji)){if(ji===-1&&(ji=Hi),Hi-ji+1===ni)return ji*sn}else ji!==-1&&(Hi-=Hi-ji),ji=-1}else for(ot+ni>yn&&(ot=yn-ni),Hi=ot;Hi>=0;Hi--){let ji=!0;for(let Xi=0;Xi<ni;Xi++)if(ki(Nt,Hi+Xi)!==ki(ht,Xi)){ji=!1;break}if(ji)return Hi}return-1}Le.prototype.includes=function(ht,ot,Vt){return this.indexOf(ht,ot,Vt)!==-1},Le.prototype.indexOf=function(ht,ot,Vt){return Gt(this,ht,ot,Vt,!0)},Le.prototype.lastIndexOf=function(ht,ot,Vt){return Gt(this,ht,ot,Vt,!1)};function Bt(Nt,ht,ot,Vt){ot=Number(ot)||0;const Wt=Nt.length-ot;Vt?(Vt=Number(Vt),Vt>Wt&&(Vt=Wt)):Vt=Wt;const sn=ht.length;Vt>sn/2&&(Vt=sn/2);let yn;for(yn=0;yn<Vt;++yn){const ni=parseInt(ht.substr(yn*2,2),16);if(fn(ni))return yn;Nt[ot+yn]=ni}return yn}function dt(Nt,ht,ot,Vt){return Kt(Nr(ht,Nt.length-ot),Nt,ot,Vt)}function ut(Nt,ht,ot,Vt){return Kt(Ar(ht),Nt,ot,Vt)}function Ut(Nt,ht,ot,Vt){return Kt(Bi(ht),Nt,ot,Vt)}function Tt(Nt,ht,ot,Vt){return Kt(fr(ht,Nt.length-ot),Nt,ot,Vt)}Le.prototype.write=function(ht,ot,Vt,Wt){if(ot===void 0)Wt="utf8",Vt=this.length,ot=0;else if(Vt===void 0&&typeof ot=="string")Wt=ot,Vt=this.length,ot=0;else if(isFinite(ot))ot=ot>>>0,isFinite(Vt)?(Vt=Vt>>>0,Wt===void 0&&(Wt="utf8")):(Wt=Vt,Vt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const sn=this.length-ot;if((Vt===void 0||Vt>sn)&&(Vt=sn),ht.length>0&&(Vt<0||ot<0)||ot>this.length)throw new RangeError("Attempt to write outside buffer bounds");Wt||(Wt="utf8");let yn=!1;for(;;)switch(Wt){case"hex":return Bt(this,ht,ot,Vt);case"utf8":case"utf-8":return dt(this,ht,ot,Vt);case"ascii":case"latin1":case"binary":return ut(this,ht,ot,Vt);case"base64":return Ut(this,ht,ot,Vt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Tt(this,ht,ot,Vt);default:if(yn)throw new TypeError("Unknown encoding: "+Wt);Wt=(""+Wt).toLowerCase(),yn=!0}},Le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Xt(Nt,ht,ot){return ht===0&&ot===Nt.length?se.fromByteArray(Nt):se.fromByteArray(Nt.slice(ht,ot))}function hn(Nt,ht,ot){ot=Math.min(Nt.length,ot);const Vt=[];let Wt=ht;for(;Wt<ot;){const sn=Nt[Wt];let yn=null,ni=sn>239?4:sn>223?3:sn>191?2:1;if(Wt+ni<=ot){let ki,Hi,ji,Xi;switch(ni){case 1:sn<128&&(yn=sn);break;case 2:ki=Nt[Wt+1],(ki&192)===128&&(Xi=(sn&31)<<6|ki&63,Xi>127&&(yn=Xi));break;case 3:ki=Nt[Wt+1],Hi=Nt[Wt+2],(ki&192)===128&&(Hi&192)===128&&(Xi=(sn&15)<<12|(ki&63)<<6|Hi&63,Xi>2047&&(Xi<55296||Xi>57343)&&(yn=Xi));break;case 4:ki=Nt[Wt+1],Hi=Nt[Wt+2],ji=Nt[Wt+3],(ki&192)===128&&(Hi&192)===128&&(ji&192)===128&&(Xi=(sn&15)<<18|(ki&63)<<12|(Hi&63)<<6|ji&63,Xi>65535&&Xi<1114112&&(yn=Xi))}}yn===null?(yn=65533,ni=1):yn>65535&&(yn-=65536,Vt.push(yn>>>10&1023|55296),yn=56320|yn&1023),Vt.push(yn),Wt+=ni}return An(Vt)}const nn=4096;function An(Nt){const ht=Nt.length;if(ht<=nn)return String.fromCharCode.apply(String,Nt);let ot="",Vt=0;for(;Vt<ht;)ot+=String.fromCharCode.apply(String,Nt.slice(Vt,Vt+=nn));return ot}function Cn(Nt,ht,ot){let Vt="";ot=Math.min(Nt.length,ot);for(let Wt=ht;Wt<ot;++Wt)Vt+=String.fromCharCode(Nt[Wt]&127);return Vt}function Nn(Nt,ht,ot){let Vt="";ot=Math.min(Nt.length,ot);for(let Wt=ht;Wt<ot;++Wt)Vt+=String.fromCharCode(Nt[Wt]);return Vt}function Qn(Nt,ht,ot){const Vt=Nt.length;(!ht||ht<0)&&(ht=0),(!ot||ot<0||ot>Vt)&&(ot=Vt);let Wt="";for(let sn=ht;sn<ot;++sn)Wt+=on[Nt[sn]];return Wt}function fi(Nt,ht,ot){const Vt=Nt.slice(ht,ot);let Wt="";for(let sn=0;sn<Vt.length-1;sn+=2)Wt+=String.fromCharCode(Vt[sn]+Vt[sn+1]*256);return Wt}Le.prototype.slice=function(ht,ot){const Vt=this.length;ht=~~ht,ot=ot===void 0?Vt:~~ot,ht<0?(ht+=Vt,ht<0&&(ht=0)):ht>Vt&&(ht=Vt),ot<0?(ot+=Vt,ot<0&&(ot=0)):ot>Vt&&(ot=Vt),ot<ht&&(ot=ht);const Wt=this.subarray(ht,ot);return Object.setPrototypeOf(Wt,Le.prototype),Wt};function hi(Nt,ht,ot){if(Nt%1!==0||Nt<0)throw new RangeError("offset is not uint");if(Nt+ht>ot)throw new RangeError("Trying to access beyond buffer length")}Le.prototype.readUintLE=Le.prototype.readUIntLE=function(ht,ot,Vt){ht=ht>>>0,ot=ot>>>0,Vt||hi(ht,ot,this.length);let Wt=this[ht],sn=1,yn=0;for(;++yn<ot&&(sn*=256);)Wt+=this[ht+yn]*sn;return Wt},Le.prototype.readUintBE=Le.prototype.readUIntBE=function(ht,ot,Vt){ht=ht>>>0,ot=ot>>>0,Vt||hi(ht,ot,this.length);let Wt=this[ht+--ot],sn=1;for(;ot>0&&(sn*=256);)Wt+=this[ht+--ot]*sn;return Wt},Le.prototype.readUint8=Le.prototype.readUInt8=function(ht,ot){return ht=ht>>>0,ot||hi(ht,1,this.length),this[ht]},Le.prototype.readUint16LE=Le.prototype.readUInt16LE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,2,this.length),this[ht]|this[ht+1]<<8},Le.prototype.readUint16BE=Le.prototype.readUInt16BE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,2,this.length),this[ht]<<8|this[ht+1]},Le.prototype.readUint32LE=Le.prototype.readUInt32LE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,4,this.length),(this[ht]|this[ht+1]<<8|this[ht+2]<<16)+this[ht+3]*16777216},Le.prototype.readUint32BE=Le.prototype.readUInt32BE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,4,this.length),this[ht]*16777216+(this[ht+1]<<16|this[ht+2]<<8|this[ht+3])},Le.prototype.readBigUInt64LE=an(function(ht){ht=ht>>>0,Kn(ht,"offset");const ot=this[ht],Vt=this[ht+7];(ot===void 0||Vt===void 0)&&ai(ht,this.length-8);const Wt=ot+this[++ht]*2**8+this[++ht]*2**16+this[++ht]*2**24,sn=this[++ht]+this[++ht]*2**8+this[++ht]*2**16+Vt*2**24;return BigInt(Wt)+(BigInt(sn)<<BigInt(32))}),Le.prototype.readBigUInt64BE=an(function(ht){ht=ht>>>0,Kn(ht,"offset");const ot=this[ht],Vt=this[ht+7];(ot===void 0||Vt===void 0)&&ai(ht,this.length-8);const Wt=ot*2**24+this[++ht]*2**16+this[++ht]*2**8+this[++ht],sn=this[++ht]*2**24+this[++ht]*2**16+this[++ht]*2**8+Vt;return(BigInt(Wt)<<BigInt(32))+BigInt(sn)}),Le.prototype.readIntLE=function(ht,ot,Vt){ht=ht>>>0,ot=ot>>>0,Vt||hi(ht,ot,this.length);let Wt=this[ht],sn=1,yn=0;for(;++yn<ot&&(sn*=256);)Wt+=this[ht+yn]*sn;return sn*=128,Wt>=sn&&(Wt-=Math.pow(2,8*ot)),Wt},Le.prototype.readIntBE=function(ht,ot,Vt){ht=ht>>>0,ot=ot>>>0,Vt||hi(ht,ot,this.length);let Wt=ot,sn=1,yn=this[ht+--Wt];for(;Wt>0&&(sn*=256);)yn+=this[ht+--Wt]*sn;return sn*=128,yn>=sn&&(yn-=Math.pow(2,8*ot)),yn},Le.prototype.readInt8=function(ht,ot){return ht=ht>>>0,ot||hi(ht,1,this.length),this[ht]&128?(255-this[ht]+1)*-1:this[ht]},Le.prototype.readInt16LE=function(ht,ot){ht=ht>>>0,ot||hi(ht,2,this.length);const Vt=this[ht]|this[ht+1]<<8;return Vt&32768?Vt|4294901760:Vt},Le.prototype.readInt16BE=function(ht,ot){ht=ht>>>0,ot||hi(ht,2,this.length);const Vt=this[ht+1]|this[ht]<<8;return Vt&32768?Vt|4294901760:Vt},Le.prototype.readInt32LE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,4,this.length),this[ht]|this[ht+1]<<8|this[ht+2]<<16|this[ht+3]<<24},Le.prototype.readInt32BE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,4,this.length),this[ht]<<24|this[ht+1]<<16|this[ht+2]<<8|this[ht+3]},Le.prototype.readBigInt64LE=an(function(ht){ht=ht>>>0,Kn(ht,"offset");const ot=this[ht],Vt=this[ht+7];(ot===void 0||Vt===void 0)&&ai(ht,this.length-8);const Wt=this[ht+4]+this[ht+5]*2**8+this[ht+6]*2**16+(Vt<<24);return(BigInt(Wt)<<BigInt(32))+BigInt(ot+this[++ht]*256+this[++ht]*65536+this[++ht]*16777216)}),Le.prototype.readBigInt64BE=an(function(ht){ht=ht>>>0,Kn(ht,"offset");const ot=this[ht],Vt=this[ht+7];(ot===void 0||Vt===void 0)&&ai(ht,this.length-8);const Wt=(ot<<24)+this[++ht]*2**16+this[++ht]*2**8+this[++ht];return(BigInt(Wt)<<BigInt(32))+BigInt(this[++ht]*16777216+this[++ht]*65536+this[++ht]*256+Vt)}),Le.prototype.readFloatLE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,4,this.length),me.read(this,ht,!0,23,4)},Le.prototype.readFloatBE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,4,this.length),me.read(this,ht,!1,23,4)},Le.prototype.readDoubleLE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,8,this.length),me.read(this,ht,!0,52,8)},Le.prototype.readDoubleBE=function(ht,ot){return ht=ht>>>0,ot||hi(ht,8,this.length),me.read(this,ht,!1,52,8)};function Qi(Nt,ht,ot,Vt,Wt,sn){if(!Le.isBuffer(Nt))throw new TypeError('"buffer" argument must be a Buffer instance');if(ht>Wt||ht<sn)throw new RangeError('"value" argument is out of bounds');if(ot+Vt>Nt.length)throw new RangeError("Index out of range")}Le.prototype.writeUintLE=Le.prototype.writeUIntLE=function(ht,ot,Vt,Wt){if(ht=+ht,ot=ot>>>0,Vt=Vt>>>0,!Wt){const ni=Math.pow(2,8*Vt)-1;Qi(this,ht,ot,Vt,ni,0)}let sn=1,yn=0;for(this[ot]=ht&255;++yn<Vt&&(sn*=256);)this[ot+yn]=ht/sn&255;return ot+Vt},Le.prototype.writeUintBE=Le.prototype.writeUIntBE=function(ht,ot,Vt,Wt){if(ht=+ht,ot=ot>>>0,Vt=Vt>>>0,!Wt){const ni=Math.pow(2,8*Vt)-1;Qi(this,ht,ot,Vt,ni,0)}let sn=Vt-1,yn=1;for(this[ot+sn]=ht&255;--sn>=0&&(yn*=256);)this[ot+sn]=ht/yn&255;return ot+Vt},Le.prototype.writeUint8=Le.prototype.writeUInt8=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,1,255,0),this[ot]=ht&255,ot+1},Le.prototype.writeUint16LE=Le.prototype.writeUInt16LE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,2,65535,0),this[ot]=ht&255,this[ot+1]=ht>>>8,ot+2},Le.prototype.writeUint16BE=Le.prototype.writeUInt16BE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,2,65535,0),this[ot]=ht>>>8,this[ot+1]=ht&255,ot+2},Le.prototype.writeUint32LE=Le.prototype.writeUInt32LE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,4,4294967295,0),this[ot+3]=ht>>>24,this[ot+2]=ht>>>16,this[ot+1]=ht>>>8,this[ot]=ht&255,ot+4},Le.prototype.writeUint32BE=Le.prototype.writeUInt32BE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,4,4294967295,0),this[ot]=ht>>>24,this[ot+1]=ht>>>16,this[ot+2]=ht>>>8,this[ot+3]=ht&255,ot+4};function Zi(Nt,ht,ot,Vt,Wt){rn(ht,Vt,Wt,Nt,ot,7);let sn=Number(ht&BigInt(4294967295));Nt[ot++]=sn,sn=sn>>8,Nt[ot++]=sn,sn=sn>>8,Nt[ot++]=sn,sn=sn>>8,Nt[ot++]=sn;let yn=Number(ht>>BigInt(32)&BigInt(4294967295));return Nt[ot++]=yn,yn=yn>>8,Nt[ot++]=yn,yn=yn>>8,Nt[ot++]=yn,yn=yn>>8,Nt[ot++]=yn,ot}function Mn(Nt,ht,ot,Vt,Wt){rn(ht,Vt,Wt,Nt,ot,7);let sn=Number(ht&BigInt(4294967295));Nt[ot+7]=sn,sn=sn>>8,Nt[ot+6]=sn,sn=sn>>8,Nt[ot+5]=sn,sn=sn>>8,Nt[ot+4]=sn;let yn=Number(ht>>BigInt(32)&BigInt(4294967295));return Nt[ot+3]=yn,yn=yn>>8,Nt[ot+2]=yn,yn=yn>>8,Nt[ot+1]=yn,yn=yn>>8,Nt[ot]=yn,ot+8}Le.prototype.writeBigUInt64LE=an(function(ht,ot=0){return Zi(this,ht,ot,BigInt(0),BigInt("0xffffffffffffffff"))}),Le.prototype.writeBigUInt64BE=an(function(ht,ot=0){return Mn(this,ht,ot,BigInt(0),BigInt("0xffffffffffffffff"))}),Le.prototype.writeIntLE=function(ht,ot,Vt,Wt){if(ht=+ht,ot=ot>>>0,!Wt){const ki=Math.pow(2,8*Vt-1);Qi(this,ht,ot,Vt,ki-1,-ki)}let sn=0,yn=1,ni=0;for(this[ot]=ht&255;++sn<Vt&&(yn*=256);)ht<0&&ni===0&&this[ot+sn-1]!==0&&(ni=1),this[ot+sn]=(ht/yn>>0)-ni&255;return ot+Vt},Le.prototype.writeIntBE=function(ht,ot,Vt,Wt){if(ht=+ht,ot=ot>>>0,!Wt){const ki=Math.pow(2,8*Vt-1);Qi(this,ht,ot,Vt,ki-1,-ki)}let sn=Vt-1,yn=1,ni=0;for(this[ot+sn]=ht&255;--sn>=0&&(yn*=256);)ht<0&&ni===0&&this[ot+sn+1]!==0&&(ni=1),this[ot+sn]=(ht/yn>>0)-ni&255;return ot+Vt},Le.prototype.writeInt8=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,1,127,-128),ht<0&&(ht=255+ht+1),this[ot]=ht&255,ot+1},Le.prototype.writeInt16LE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,2,32767,-32768),this[ot]=ht&255,this[ot+1]=ht>>>8,ot+2},Le.prototype.writeInt16BE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,2,32767,-32768),this[ot]=ht>>>8,this[ot+1]=ht&255,ot+2},Le.prototype.writeInt32LE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,4,2147483647,-2147483648),this[ot]=ht&255,this[ot+1]=ht>>>8,this[ot+2]=ht>>>16,this[ot+3]=ht>>>24,ot+4},Le.prototype.writeInt32BE=function(ht,ot,Vt){return ht=+ht,ot=ot>>>0,Vt||Qi(this,ht,ot,4,2147483647,-2147483648),ht<0&&(ht=4294967295+ht+1),this[ot]=ht>>>24,this[ot+1]=ht>>>16,this[ot+2]=ht>>>8,this[ot+3]=ht&255,ot+4},Le.prototype.writeBigInt64LE=an(function(ht,ot=0){return Zi(this,ht,ot,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),Le.prototype.writeBigInt64BE=an(function(ht,ot=0){return Mn(this,ht,ot,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Vr(Nt,ht,ot,Vt,Wt,sn){if(ot+Vt>Nt.length)throw new RangeError("Index out of range");if(ot<0)throw new RangeError("Index out of range")}function Ir(Nt,ht,ot,Vt,Wt){return ht=+ht,ot=ot>>>0,Wt||Vr(Nt,ht,ot,4),me.write(Nt,ht,ot,Vt,23,4),ot+4}Le.prototype.writeFloatLE=function(ht,ot,Vt){return Ir(this,ht,ot,!0,Vt)},Le.prototype.writeFloatBE=function(ht,ot,Vt){return Ir(this,ht,ot,!1,Vt)};function Rr(Nt,ht,ot,Vt,Wt){return ht=+ht,ot=ot>>>0,Wt||Vr(Nt,ht,ot,8),me.write(Nt,ht,ot,Vt,52,8),ot+8}Le.prototype.writeDoubleLE=function(ht,ot,Vt){return Rr(this,ht,ot,!0,Vt)},Le.prototype.writeDoubleBE=function(ht,ot,Vt){return Rr(this,ht,ot,!1,Vt)},Le.prototype.copy=function(ht,ot,Vt,Wt){if(!Le.isBuffer(ht))throw new TypeError("argument should be a Buffer");if(Vt||(Vt=0),!Wt&&Wt!==0&&(Wt=this.length),ot>=ht.length&&(ot=ht.length),ot||(ot=0),Wt>0&&Wt<Vt&&(Wt=Vt),Wt===Vt||ht.length===0||this.length===0)return 0;if(ot<0)throw new RangeError("targetStart out of bounds");if(Vt<0||Vt>=this.length)throw new RangeError("Index out of range");if(Wt<0)throw new RangeError("sourceEnd out of bounds");Wt>this.length&&(Wt=this.length),ht.length-ot<Wt-Vt&&(Wt=ht.length-ot+Vt);const sn=Wt-Vt;return this===ht&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(ot,Vt,Wt):Uint8Array.prototype.set.call(ht,this.subarray(Vt,Wt),ot),sn},Le.prototype.fill=function(ht,ot,Vt,Wt){if(typeof ht=="string"){if(typeof ot=="string"?(Wt=ot,ot=0,Vt=this.length):typeof Vt=="string"&&(Wt=Vt,Vt=this.length),Wt!==void 0&&typeof Wt!="string")throw new TypeError("encoding must be a string");if(typeof Wt=="string"&&!Le.isEncoding(Wt))throw new TypeError("Unknown encoding: "+Wt);if(ht.length===1){const yn=ht.charCodeAt(0);(Wt==="utf8"&&yn<128||Wt==="latin1")&&(ht=yn)}}else typeof ht=="number"?ht=ht&255:typeof ht=="boolean"&&(ht=Number(ht));if(ot<0||this.length<ot||this.length<Vt)throw new RangeError("Out of range index");if(Vt<=ot)return this;ot=ot>>>0,Vt=Vt===void 0?this.length:Vt>>>0,ht||(ht=0);let sn;if(typeof ht=="number")for(sn=ot;sn<Vt;++sn)this[sn]=ht;else{const yn=Le.isBuffer(ht)?ht:Le.from(ht,Wt),ni=yn.length;if(ni===0)throw new TypeError('The value "'+ht+'" is invalid for argument "value"');for(sn=0;sn<Vt-ot;++sn)this[sn+ot]=yn[sn%ni]}return this};const ir={};function zr(Nt,ht,ot){ir[Nt]=class extends ot{constructor(){super(),Object.defineProperty(this,"message",{value:ht.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Nt}]`,this.stack,delete this.name}get code(){return Nt}set code(Wt){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Wt,writable:!0})}toString(){return`${this.name} [${Nt}]: ${this.message}`}}}zr("ERR_BUFFER_OUT_OF_BOUNDS",function(Nt){return Nt?`${Nt} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),zr("ERR_INVALID_ARG_TYPE",function(Nt,ht){return`The "${Nt}" argument must be of type number. Received type ${typeof ht}`},TypeError),zr("ERR_OUT_OF_RANGE",function(Nt,ht,ot){let Vt=`The value of "${Nt}" is out of range.`,Wt=ot;return Number.isInteger(ot)&&Math.abs(ot)>4294967296?Wt=Br(String(ot)):typeof ot=="bigint"&&(Wt=String(ot),(ot>BigInt(2)**BigInt(32)||ot<-(BigInt(2)**BigInt(32)))&&(Wt=Br(Wt)),Wt+="n"),Vt+=` It must be ${ht}. Received ${Wt}`,Vt},RangeError);function Br(Nt){let ht="",ot=Nt.length;const Vt=Nt[0]==="-"?1:0;for(;ot>=Vt+4;ot-=3)ht=`_${Nt.slice(ot-3,ot)}${ht}`;return`${Nt.slice(0,ot)}${ht}`}function kt(Nt,ht,ot){Kn(ht,"offset"),(Nt[ht]===void 0||Nt[ht+ot]===void 0)&&ai(ht,Nt.length-(ot+1))}function rn(Nt,ht,ot,Vt,Wt,sn){if(Nt>ot||Nt<ht){const yn=typeof ht=="bigint"?"n":"";let ni;throw ht===0||ht===BigInt(0)?ni=`>= 0${yn} and < 2${yn} ** ${(sn+1)*8}${yn}`:ni=`>= -(2${yn} ** ${(sn+1)*8-1}${yn}) and < 2 ** ${(sn+1)*8-1}${yn}`,new ir.ERR_OUT_OF_RANGE("value",ni,Nt)}kt(Vt,Wt,sn)}function Kn(Nt,ht){if(typeof Nt!="number")throw new ir.ERR_INVALID_ARG_TYPE(ht,"number",Nt)}function ai(Nt,ht,ot){throw Math.floor(Nt)!==Nt?(Kn(Nt,ot),new ir.ERR_OUT_OF_RANGE("offset","an integer",Nt)):ht<0?new ir.ERR_BUFFER_OUT_OF_BOUNDS:new ir.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${ht}`,Nt)}const Ui=/[^+/0-9A-Za-z-_]/g;function yi(Nt){if(Nt=Nt.split("=")[0],Nt=Nt.trim().replace(Ui,""),Nt.length<2)return"";for(;Nt.length%4!==0;)Nt=Nt+"=";return Nt}function Nr(Nt,ht){ht=ht||1/0;let ot;const Vt=Nt.length;let Wt=null;const sn=[];for(let yn=0;yn<Vt;++yn){if(ot=Nt.charCodeAt(yn),ot>55295&&ot<57344){if(!Wt){if(ot>56319){(ht-=3)>-1&&sn.push(239,191,189);continue}else if(yn+1===Vt){(ht-=3)>-1&&sn.push(239,191,189);continue}Wt=ot;continue}if(ot<56320){(ht-=3)>-1&&sn.push(239,191,189),Wt=ot;continue}ot=(Wt-55296<<10|ot-56320)+65536}else Wt&&(ht-=3)>-1&&sn.push(239,191,189);if(Wt=null,ot<128){if((ht-=1)<0)break;sn.push(ot)}else if(ot<2048){if((ht-=2)<0)break;sn.push(ot>>6|192,ot&63|128)}else if(ot<65536){if((ht-=3)<0)break;sn.push(ot>>12|224,ot>>6&63|128,ot&63|128)}else if(ot<1114112){if((ht-=4)<0)break;sn.push(ot>>18|240,ot>>12&63|128,ot>>6&63|128,ot&63|128)}else throw new Error("Invalid code point")}return sn}function Ar(Nt){const ht=[];for(let ot=0;ot<Nt.length;++ot)ht.push(Nt.charCodeAt(ot)&255);return ht}function fr(Nt,ht){let ot,Vt,Wt;const sn=[];for(let yn=0;yn<Nt.length&&!((ht-=2)<0);++yn)ot=Nt.charCodeAt(yn),Vt=ot>>8,Wt=ot%256,sn.push(Wt),sn.push(Vt);return sn}function Bi(Nt){return se.toByteArray(yi(Nt))}function Kt(Nt,ht,ot,Vt){let Wt;for(Wt=0;Wt<Vt&&!(Wt+ot>=ht.length||Wt>=Nt.length);++Wt)ht[Wt+ot]=Nt[Wt];return Wt}function Yt(Nt,ht){return Nt instanceof ht||Nt!=null&&Nt.constructor!=null&&Nt.constructor.name!=null&&Nt.constructor.name===ht.name}function fn(Nt){return Nt!==Nt}const on=function(){const Nt="0123456789abcdef",ht=new Array(256);for(let ot=0;ot<16;++ot){const Vt=ot*16;for(let Wt=0;Wt<16;++Wt)ht[Vt+Wt]=Nt[ot]+Nt[Wt]}return ht}();function an(Nt){return typeof BigInt>"u"?gn:Nt}function gn(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":pe=>{pe.exports=function(Me){var ve=[];return ve.toString=function(){return this.map(function(me){var Te="",Re=typeof me[5]<"u";return me[4]&&(Te+="@supports (".concat(me[4],") {")),me[2]&&(Te+="@media ".concat(me[2]," {")),Re&&(Te+="@layer".concat(me[5].length>0?" ".concat(me[5]):""," {")),Te+=Me(me),Re&&(Te+="}"),me[2]&&(Te+="}"),me[4]&&(Te+="}"),Te}).join("")},ve.i=function(me,Te,Re,be,Pe){typeof me=="string"&&(me=[[null,me,void 0]]);var Le={};if(Re)for(var xe=0;xe<this.length;xe++){var Fe=this[xe][0];Fe!=null&&(Le[Fe]=!0)}for(var Oe=0;Oe<me.length;Oe++){var Ne=[].concat(me[Oe]);Re&&Le[Ne[0]]||(typeof Pe<"u"&&(typeof Ne[5]>"u"||(Ne[1]="@layer".concat(Ne[5].length>0?" ".concat(Ne[5]):""," {").concat(Ne[1],"}")),Ne[5]=Pe),Te&&(Ne[2]&&(Ne[1]="@media ".concat(Ne[2]," {").concat(Ne[1],"}")),Ne[2]=Te),be&&(Ne[4]?(Ne[1]="@supports (".concat(Ne[4],") {").concat(Ne[1],"}"),Ne[4]=be):Ne[4]="".concat(be)),ve.push(Ne))}},ve}},"./node_modules/css-loader/dist/runtime/getUrl.js":pe=>{pe.exports=function(Me,ve){return ve||(ve={}),Me&&(Me=String(Me.__esModule?Me.default:Me),/^['"].*['"]$/.test(Me)&&(Me=Me.slice(1,-1)),ve.hash&&(Me+=ve.hash),/["'() \t\n]|(%20)/.test(Me)||ve.needQuotes?'"'.concat(Me.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):Me)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":pe=>{pe.exports=function(Me){var ve=Me[1],se=Me[3];if(!se)return ve;if(typeof btoa=="function"){var me=btoa(unescape(encodeURIComponent(JSON.stringify(se)))),Te="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(me),Re="/*# ".concat(Te," */");return[ve].concat([Re]).join(`
`)}return[ve].join(`
`)}},"./node_modules/debug/src/browser.js":(pe,Me,ve)=>{Me.formatArgs=me,Me.save=Te,Me.load=Re,Me.useColors=se,Me.storage=be(),Me.destroy=(()=>{let Le=!1;return()=>{Le||(Le=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),Me.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function se(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function me(Le){if(Le[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Le[0]+(this.useColors?"%c ":" ")+"+"+pe.exports.humanize(this.diff),!this.useColors)return;const xe="color: "+this.color;Le.splice(1,0,xe,"color: inherit");let Fe=0,Oe=0;Le[0].replace(/%[a-zA-Z%]/g,Ne=>{Ne!=="%%"&&(Fe++,Ne==="%c"&&(Oe=Fe))}),Le.splice(Oe,0,xe)}Me.log=console.debug||console.log||(()=>{});function Te(Le){try{Le?Me.storage.setItem("debug",Le):Me.storage.removeItem("debug")}catch{}}function Re(){let Le;try{Le=Me.storage.getItem("debug")}catch{}return!Le&&typeof process<"u"&&"env"in process&&(Le=Y.DEBUG),Le}function be(){try{return localStorage}catch{}}pe.exports=ve("./node_modules/debug/src/common.js")(Me);const{formatters:Pe}=pe.exports;Pe.j=function(Le){try{return JSON.stringify(Le)}catch(xe){return"[UnexpectedJSONParseError]: "+xe.message}}},"./node_modules/debug/src/common.js":(pe,Me,ve)=>{function se(me){Re.debug=Re,Re.default=Re,Re.coerce=Oe,Re.disable=Le,Re.enable=Pe,Re.enabled=xe,Re.humanize=ve("./node_modules/ms/index.js"),Re.destroy=Ne,Object.keys(me).forEach(ke=>{Re[ke]=me[ke]}),Re.names=[],Re.skips=[],Re.formatters={};function Te(ke){let Ve=0;for(let Xe=0;Xe<ke.length;Xe++)Ve=(Ve<<5)-Ve+ke.charCodeAt(Xe),Ve|=0;return Re.colors[Math.abs(Ve)%Re.colors.length]}Re.selectColor=Te;function Re(ke){let Ve,Xe=null,$e,st;function ze(...tt){if(!ze.enabled)return;const ft=ze,Rt=Number(new Date),Mt=Rt-(Ve||Rt);ft.diff=Mt,ft.prev=Ve,ft.curr=Rt,Ve=Rt,tt[0]=Re.coerce(tt[0]),typeof tt[0]!="string"&&tt.unshift("%O");let Gt=0;tt[0]=tt[0].replace(/%([a-zA-Z%])/g,(Bt,dt)=>{if(Bt==="%%")return"%";Gt++;const ut=Re.formatters[dt];if(typeof ut=="function"){const Ut=tt[Gt];Bt=ut.call(ft,Ut),tt.splice(Gt,1),Gt--}return Bt}),Re.formatArgs.call(ft,tt),(ft.log||Re.log).apply(ft,tt)}return ze.namespace=ke,ze.useColors=Re.useColors(),ze.color=Re.selectColor(ke),ze.extend=be,ze.destroy=Re.destroy,Object.defineProperty(ze,"enabled",{enumerable:!0,configurable:!1,get:()=>Xe!==null?Xe:($e!==Re.namespaces&&($e=Re.namespaces,st=Re.enabled(ke)),st),set:tt=>{Xe=tt}}),typeof Re.init=="function"&&Re.init(ze),ze}function be(ke,Ve){const Xe=Re(this.namespace+(typeof Ve>"u"?":":Ve)+ke);return Xe.log=this.log,Xe}function Pe(ke){Re.save(ke),Re.namespaces=ke,Re.names=[],Re.skips=[];let Ve;const Xe=(typeof ke=="string"?ke:"").split(/[\s,]+/),$e=Xe.length;for(Ve=0;Ve<$e;Ve++)Xe[Ve]&&(ke=Xe[Ve].replace(/\*/g,".*?"),ke[0]==="-"?Re.skips.push(new RegExp("^"+ke.slice(1)+"$")):Re.names.push(new RegExp("^"+ke+"$")))}function Le(){const ke=[...Re.names.map(Fe),...Re.skips.map(Fe).map(Ve=>"-"+Ve)].join(",");return Re.enable(""),ke}function xe(ke){if(ke[ke.length-1]==="*")return!0;let Ve,Xe;for(Ve=0,Xe=Re.skips.length;Ve<Xe;Ve++)if(Re.skips[Ve].test(ke))return!1;for(Ve=0,Xe=Re.names.length;Ve<Xe;Ve++)if(Re.names[Ve].test(ke))return!0;return!1}function Fe(ke){return ke.toString().substring(2,ke.toString().length-2).replace(/\.\*\?$/,"*")}function Oe(ke){return ke instanceof Error?ke.stack||ke.message:ke}function Ne(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return Re.enable(Re.load()),Re}pe.exports=se},"./node_modules/deep-assign/index.js":(pe,Me,ve)=>{var se=ve("./node_modules/is-obj/index.js"),me=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;function Re(Le){if(Le==null)throw new TypeError("Sources cannot be null or undefined");return Object(Le)}function be(Le,xe,Fe){var Oe=xe[Fe];if(Oe!=null){if(me.call(Le,Fe)&&(Le[Fe]===void 0||Le[Fe]===null))throw new TypeError("Cannot convert undefined or null to object ("+Fe+")");!me.call(Le,Fe)||!se(Oe)?Le[Fe]=Oe:Le[Fe]=Pe(Object(Le[Fe]),xe[Fe])}}function Pe(Le,xe){if(Le===xe)return Le;xe=Object(xe);for(var Fe in xe)me.call(xe,Fe)&&be(Le,xe,Fe);if(Object.getOwnPropertySymbols)for(var Oe=Object.getOwnPropertySymbols(xe),Ne=0;Ne<Oe.length;Ne++)Te.call(xe,Oe[Ne])&&be(Le,xe,Oe[Ne]);return Le}pe.exports=function(xe){xe=Re(xe);for(var Fe=1;Fe<arguments.length;Fe++)Pe(xe,arguments[Fe]);return xe}},"./node_modules/dtype/index.js":pe=>{pe.exports=function(Me){switch(Me){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(pe,Me,ve)=>{var se;typeof window<"u"?se=window:typeof ve.g<"u"?se=ve.g:typeof self<"u"?se=self:se={},pe.exports=se},"./node_modules/ieee754/index.js":(pe,Me)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Me.read=function(ve,se,me,Te,Re){var be,Pe,Le=Re*8-Te-1,xe=(1<<Le)-1,Fe=xe>>1,Oe=-7,Ne=me?Re-1:0,ke=me?-1:1,Ve=ve[se+Ne];for(Ne+=ke,be=Ve&(1<<-Oe)-1,Ve>>=-Oe,Oe+=Le;Oe>0;be=be*256+ve[se+Ne],Ne+=ke,Oe-=8);for(Pe=be&(1<<-Oe)-1,be>>=-Oe,Oe+=Te;Oe>0;Pe=Pe*256+ve[se+Ne],Ne+=ke,Oe-=8);if(be===0)be=1-Fe;else{if(be===xe)return Pe?NaN:(Ve?-1:1)*(1/0);Pe=Pe+Math.pow(2,Te),be=be-Fe}return(Ve?-1:1)*Pe*Math.pow(2,be-Te)},Me.write=function(ve,se,me,Te,Re,be){var Pe,Le,xe,Fe=be*8-Re-1,Oe=(1<<Fe)-1,Ne=Oe>>1,ke=Re===23?Math.pow(2,-24)-Math.pow(2,-77):0,Ve=Te?0:be-1,Xe=Te?1:-1,$e=se<0||se===0&&1/se<0?1:0;for(se=Math.abs(se),isNaN(se)||se===1/0?(Le=isNaN(se)?1:0,Pe=Oe):(Pe=Math.floor(Math.log(se)/Math.LN2),se*(xe=Math.pow(2,-Pe))<1&&(Pe--,xe*=2),Pe+Ne>=1?se+=ke/xe:se+=ke*Math.pow(2,1-Ne),se*xe>=2&&(Pe++,xe/=2),Pe+Ne>=Oe?(Le=0,Pe=Oe):Pe+Ne>=1?(Le=(se*xe-1)*Math.pow(2,Re),Pe=Pe+Ne):(Le=se*Math.pow(2,Ne-1)*Math.pow(2,Re),Pe=0));Re>=8;ve[me+Ve]=Le&255,Ve+=Xe,Le/=256,Re-=8);for(Pe=Pe<<Re|Le,Fe+=Re;Fe>0;ve[me+Ve]=Pe&255,Ve+=Xe,Pe/=256,Fe-=8);ve[me+Ve-Xe]|=$e*128}},"./node_modules/is-buffer/index.js":pe=>{/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */pe.exports=function(se){return se!=null&&(Me(se)||ve(se)||!!se._isBuffer)};function Me(se){return!!se.constructor&&typeof se.constructor.isBuffer=="function"&&se.constructor.isBuffer(se)}function ve(se){return typeof se.readFloatLE=="function"&&typeof se.slice=="function"&&Me(se.slice(0,0))}},"./node_modules/is-function/index.js":pe=>{pe.exports=ve;var Me=Object.prototype.toString;function ve(se){if(!se)return!1;var me=Me.call(se);return me==="[object Function]"||typeof se=="function"&&me!=="[object RegExp]"||typeof window<"u"&&(se===window.setTimeout||se===window.alert||se===window.confirm||se===window.prompt)}},"./node_modules/is-obj/index.js":pe=>{pe.exports=function(Me){var ve=typeof Me;return Me!==null&&(ve==="object"||ve==="function")}},"./node_modules/layout-bmfont-text/index.js":(pe,Me,ve)=>{var se=ve("./node_modules/word-wrapper/index.js"),me=ve("./node_modules/xtend/immutable.js"),Te=ve("./node_modules/as-number/index.js"),Re=["x","e","a","o","n","s","r","c","u","m","v","w","z"],be=["m","w"],Pe=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],Le=9,xe=32,Fe=0,Oe=1,Ne=2;pe.exports=function(_t){return new ke(_t)};function ke(Gt){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(Gt)}ke.prototype.update=function(Gt){if(Gt=me({measure:this._measure},Gt),this._opt=Gt,this._opt.tabSize=Te(this._opt.tabSize,4),!Gt.font)throw new Error("must provide a valid bitmap font");var _t=this.glyphs,Bt=Gt.text||"",dt=Gt.font;this._setupSpaceGlyphs(dt);var ut=se.lines(Bt,Gt),Ut=Gt.width||0;_t.length=0;var Tt=ut.reduce(function(Qi,Zi){return Math.max(Qi,Zi.width,Ut)},0),Xt=0,hn=0,nn=Te(Gt.lineHeight,dt.common.lineHeight),An=dt.common.base,Cn=nn-An,Nn=Gt.letterSpacing||0,Qn=nn*ut.length-Cn,fi=Rt(this._opt.align);hn-=Qn,this._width=Tt,this._height=Qn,this._descender=nn-An,this._baseline=An,this._xHeight=st(dt),this._capHeight=tt(dt),this._lineHeight=nn,this._ascender=nn-Cn-this._xHeight;var hi=this;ut.forEach(function(Qi,Zi){for(var Mn=Qi.start,Vr=Qi.end,Ir=Qi.width,Rr,ir=Mn;ir<Vr;ir++){var zr=Bt.charCodeAt(ir),Br=hi.getGlyph(dt,zr);if(Br){Rr&&(Xt+=ft(dt,Rr.id,Br.id));var kt=Xt;fi===Oe?kt+=(Tt-Ir)/2:fi===Ne&&(kt+=Tt-Ir),_t.push({position:[kt,hn],data:Br,index:ir,line:Zi}),Xt+=Br.xadvance+Nn,Rr=Br}}hn+=nn,Xt=0}),this._linesTotal=ut.length},ke.prototype._setupSpaceGlyphs=function(Gt){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!Gt.chars||Gt.chars.length===0)){var _t=$e(Gt,xe)||ze(Gt)||Gt.chars[0],Bt=this._opt.tabSize*_t.xadvance;this._fallbackSpaceGlyph=_t,this._fallbackTabGlyph=me(_t,{x:0,y:0,xadvance:Bt,id:Le,xoffset:0,yoffset:0,width:0,height:0})}},ke.prototype.getGlyph=function(Gt,_t){var Bt=$e(Gt,_t);return Bt||(_t===Le?this._fallbackTabGlyph:_t===xe?this._fallbackSpaceGlyph:null)},ke.prototype.computeMetrics=function(Gt,_t,Bt,dt){var ut=this._opt.letterSpacing||0,Ut=this._opt.font,Tt=0,Xt=0,hn=0,nn,An;if(!Ut.chars||Ut.chars.length===0)return{start:_t,end:_t,width:0};Bt=Math.min(Gt.length,Bt);for(var Cn=_t;Cn<Bt;Cn++){var Nn=Gt.charCodeAt(Cn),nn=this.getGlyph(Ut,Nn);if(nn){nn.xoffset;var Qn=An?ft(Ut,An.id,nn.id):0;Tt+=Qn;var fi=Tt+nn.xadvance+ut,hi=Tt+nn.width;if(hi>=dt||fi>=dt)break;Tt=fi,Xt=hi,An=nn}hn++}return An&&(Xt+=An.xoffset),{start:_t,end:_t+hn,width:Xt}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(Ve);function Ve(Gt){Object.defineProperty(ke.prototype,Gt,{get:Xe(Gt),configurable:!0})}function Xe(Gt){return new Function(["return function "+Gt+"() {","  return this._"+Gt,"}"].join(`
`))()}function $e(Gt,_t){if(!Gt.chars||Gt.chars.length===0)return null;var Bt=Mt(Gt.chars,_t);return Bt>=0?Gt.chars[Bt]:null}function st(Gt){for(var _t=0;_t<Re.length;_t++){var Bt=Re[_t].charCodeAt(0),dt=Mt(Gt.chars,Bt);if(dt>=0)return Gt.chars[dt].height}return 0}function ze(Gt){for(var _t=0;_t<be.length;_t++){var Bt=be[_t].charCodeAt(0),dt=Mt(Gt.chars,Bt);if(dt>=0)return Gt.chars[dt]}return 0}function tt(Gt){for(var _t=0;_t<Pe.length;_t++){var Bt=Pe[_t].charCodeAt(0),dt=Mt(Gt.chars,Bt);if(dt>=0)return Gt.chars[dt].height}return 0}function ft(Gt,_t,Bt){if(!Gt.kernings||Gt.kernings.length===0)return 0;for(var dt=Gt.kernings,ut=0;ut<dt.length;ut++){var Ut=dt[ut];if(Ut.first===_t&&Ut.second===Bt)return Ut.amount}return 0}function Rt(Gt){return Gt==="center"?Oe:Gt==="right"?Ne:Fe}function Mt(Gt,_t,Bt){Bt=Bt||0;for(var dt=Bt;dt<Gt.length;dt++)if(Gt[dt].id===_t)return dt;return-1}},"./node_modules/load-bmfont/browser.js":(pe,Me,ve)=>{var se=ve("./node_modules/buffer/index.js").Buffer,me=ve("./node_modules/xhr/index.js"),Te=function(){},Re=ve("./node_modules/parse-bmfont-ascii/index.js"),be=ve("./node_modules/parse-bmfont-xml/lib/browser.js"),Pe=ve("./node_modules/parse-bmfont-binary/index.js"),Le=ve("./node_modules/load-bmfont/lib/is-binary.js"),xe=ve("./node_modules/xtend/immutable.js"),Fe=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();pe.exports=function(ke,Ve){Ve=typeof Ve=="function"?Ve:Te,typeof ke=="string"?ke={uri:ke}:ke||(ke={});var Xe=ke.binary;Xe&&(ke=Ne(ke)),me(ke,function($e,st,ze){if($e)return Ve($e);if(!/^2/.test(st.statusCode))return Ve(new Error("http status code: "+st.statusCode));if(!ze)return Ve(new Error("no body result"));var tt=!1;if(Oe(ze)){var ft=new Uint8Array(ze);ze=se.from(ft,"binary")}Le(ze)&&(tt=!0,typeof ze=="string"&&(ze=se.from(ze,"binary"))),tt||(se.isBuffer(ze)&&(ze=ze.toString(ke.encoding)),ze=ze.trim());var Rt;try{var Mt=st.headers["content-type"];tt?Rt=Pe(ze):/json/.test(Mt)||ze.charAt(0)==="{"?Rt=JSON.parse(ze):/xml/.test(Mt)||ze.charAt(0)==="<"?Rt=be(ze):Rt=Re(ze)}catch(Gt){Ve(new Error("error parsing font "+Gt.message)),Ve=Te}Ve(null,Rt)})};function Oe(ke){var Ve=Object.prototype.toString;return Ve.call(ke)==="[object ArrayBuffer]"}function Ne(ke){if(Fe)return xe(ke,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var Ve=new self.XMLHttpRequest;return Ve.overrideMimeType("text/plain; charset=x-user-defined"),xe({xhr:Ve},ke)}},"./node_modules/load-bmfont/lib/is-binary.js":(pe,Me,ve)=>{var se=ve("./node_modules/buffer/index.js").Buffer,me=ve("./node_modules/buffer-equal/index.js"),Te=se.from([66,77,70,3]);pe.exports=function(Re){return typeof Re=="string"?Re.substring(0,3)==="BMF":Re.length>4&&me(Re.slice(0,4),Te)}},"./node_modules/ms/index.js":pe=>{var Me=1e3,ve=Me*60,se=ve*60,me=se*24,Te=me*7,Re=me*365.25;pe.exports=function(Fe,Oe){Oe=Oe||{};var Ne=typeof Fe;if(Ne==="string"&&Fe.length>0)return be(Fe);if(Ne==="number"&&isFinite(Fe))return Oe.long?Le(Fe):Pe(Fe);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Fe))};function be(Fe){if(Fe=String(Fe),!(Fe.length>100)){var Oe=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Fe);if(Oe){var Ne=parseFloat(Oe[1]),ke=(Oe[2]||"ms").toLowerCase();switch(ke){case"years":case"year":case"yrs":case"yr":case"y":return Ne*Re;case"weeks":case"week":case"w":return Ne*Te;case"days":case"day":case"d":return Ne*me;case"hours":case"hour":case"hrs":case"hr":case"h":return Ne*se;case"minutes":case"minute":case"mins":case"min":case"m":return Ne*ve;case"seconds":case"second":case"secs":case"sec":case"s":return Ne*Me;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Ne;default:return}}}}function Pe(Fe){var Oe=Math.abs(Fe);return Oe>=me?Math.round(Fe/me)+"d":Oe>=se?Math.round(Fe/se)+"h":Oe>=ve?Math.round(Fe/ve)+"m":Oe>=Me?Math.round(Fe/Me)+"s":Fe+"ms"}function Le(Fe){var Oe=Math.abs(Fe);return Oe>=me?xe(Fe,Oe,me,"day"):Oe>=se?xe(Fe,Oe,se,"hour"):Oe>=ve?xe(Fe,Oe,ve,"minute"):Oe>=Me?xe(Fe,Oe,Me,"second"):Fe+" ms"}function xe(Fe,Oe,Ne,ke){var Ve=Oe>=Ne*1.5;return Math.round(Fe/Ne)+" "+ke+(Ve?"s":"")}},"./node_modules/parse-bmfont-ascii/index.js":pe=>{pe.exports=function(Te){if(!Te)throw new Error("no data provided");Te=Te.toString().trim();var Re={pages:[],chars:[],kernings:[]},be=Te.split(/\r\n?|\n/g);if(be.length===0)throw new Error("no data in BMFont file");for(var Pe=0;Pe<be.length;Pe++){var Le=Me(be[Pe],Pe);if(Le)if(Le.key==="page"){if(typeof Le.data.id!="number")throw new Error("malformed file at line "+Pe+" -- needs page id=N");if(typeof Le.data.file!="string")throw new Error("malformed file at line "+Pe+' -- needs page file="path"');Re.pages[Le.data.id]=Le.data.file}else Le.key==="chars"||Le.key==="kernings"||(Le.key==="char"?Re.chars.push(Le.data):Le.key==="kerning"?Re.kernings.push(Le.data):Re[Le.key]=Le.data)}return Re};function Me(me,Te){if(me=me.replace(/\t+/g," ").trim(),!me)return null;var Re=me.indexOf(" ");if(Re===-1)throw new Error("no named row at line "+Te);var be=me.substring(0,Re);me=me.substring(Re+1),me=me.replace(/letter=[\'\"]\S+[\'\"]/gi,""),me=me.split("="),me=me.map(function(Oe){return Oe.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var Pe=[],Le=0;Le<me.length;Le++){var xe=me[Le];Le===0?Pe.push({key:xe[0],data:""}):Le===me.length-1?Pe[Pe.length-1].data=ve(xe[0]):(Pe[Pe.length-1].data=ve(xe[0]),Pe.push({key:xe[1],data:""}))}var Fe={key:be,data:{}};return Pe.forEach(function(Oe){Fe.data[Oe.key]=Oe.data}),Fe}function ve(me){return!me||me.length===0?"":me.indexOf('"')===0||me.indexOf("'")===0?me.substring(1,me.length-1):me.indexOf(",")!==-1?se(me):parseInt(me,10)}function se(me){return me.split(",").map(function(Te){return parseInt(Te,10)})}},"./node_modules/parse-bmfont-binary/index.js":pe=>{var Me=[66,77,70];pe.exports=function(Fe){if(Fe.length<6)throw new Error("invalid buffer length for BMFont");var Oe=Me.every(function($e,st){return Fe.readUInt8(st)===$e});if(!Oe)throw new Error("BMFont missing BMF byte header");var Ne=3,ke=Fe.readUInt8(Ne++);if(ke>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var Ve={kernings:[],chars:[]},Xe=0;Xe<5;Xe++)Ne+=ve(Ve,Fe,Ne);return Ve};function ve(xe,Fe,Oe){if(Oe>Fe.length-1)return 0;var Ne=Fe.readUInt8(Oe++),ke=Fe.readInt32LE(Oe);switch(Oe+=4,Ne){case 1:xe.info=se(Fe,Oe);break;case 2:xe.common=me(Fe,Oe);break;case 3:xe.pages=Te(Fe,Oe,ke);break;case 4:xe.chars=Re(Fe,Oe,ke);break;case 5:xe.kernings=be(Fe,Oe,ke);break}return 5+ke}function se(xe,Fe){var Oe={};Oe.size=xe.readInt16LE(Fe);var Ne=xe.readUInt8(Fe+2);return Oe.smooth=Ne>>7&1,Oe.unicode=Ne>>6&1,Oe.italic=Ne>>5&1,Oe.bold=Ne>>4&1,Ne>>3&1&&(Oe.fixedHeight=1),Oe.charset=xe.readUInt8(Fe+3)||"",Oe.stretchH=xe.readUInt16LE(Fe+4),Oe.aa=xe.readUInt8(Fe+6),Oe.padding=[xe.readInt8(Fe+7),xe.readInt8(Fe+8),xe.readInt8(Fe+9),xe.readInt8(Fe+10)],Oe.spacing=[xe.readInt8(Fe+11),xe.readInt8(Fe+12)],Oe.outline=xe.readUInt8(Fe+13),Oe.face=Le(xe,Fe+14),Oe}function me(xe,Fe){var Oe={};return Oe.lineHeight=xe.readUInt16LE(Fe),Oe.base=xe.readUInt16LE(Fe+2),Oe.scaleW=xe.readUInt16LE(Fe+4),Oe.scaleH=xe.readUInt16LE(Fe+6),Oe.pages=xe.readUInt16LE(Fe+8),xe.readUInt8(Fe+10),Oe.packed=0,Oe.alphaChnl=xe.readUInt8(Fe+11),Oe.redChnl=xe.readUInt8(Fe+12),Oe.greenChnl=xe.readUInt8(Fe+13),Oe.blueChnl=xe.readUInt8(Fe+14),Oe}function Te(xe,Fe,Oe){for(var Ne=[],ke=Pe(xe,Fe),Ve=ke.length+1,Xe=Oe/Ve,$e=0;$e<Xe;$e++)Ne[$e]=xe.slice(Fe,Fe+ke.length).toString("utf8"),Fe+=Ve;return Ne}function Re(xe,Fe,Oe){for(var Ne=[],ke=Oe/20,Ve=0;Ve<ke;Ve++){var Xe={},$e=Ve*20;Xe.id=xe.readUInt32LE(Fe+0+$e),Xe.x=xe.readUInt16LE(Fe+4+$e),Xe.y=xe.readUInt16LE(Fe+6+$e),Xe.width=xe.readUInt16LE(Fe+8+$e),Xe.height=xe.readUInt16LE(Fe+10+$e),Xe.xoffset=xe.readInt16LE(Fe+12+$e),Xe.yoffset=xe.readInt16LE(Fe+14+$e),Xe.xadvance=xe.readInt16LE(Fe+16+$e),Xe.page=xe.readUInt8(Fe+18+$e),Xe.chnl=xe.readUInt8(Fe+19+$e),Ne[Ve]=Xe}return Ne}function be(xe,Fe,Oe){for(var Ne=[],ke=Oe/10,Ve=0;Ve<ke;Ve++){var Xe={},$e=Ve*10;Xe.first=xe.readUInt32LE(Fe+0+$e),Xe.second=xe.readUInt32LE(Fe+4+$e),Xe.amount=xe.readInt16LE(Fe+8+$e),Ne[Ve]=Xe}return Ne}function Pe(xe,Fe){for(var Oe=Fe;Oe<xe.length&&xe[Oe]!==0;Oe++);return xe.slice(Fe,Oe)}function Le(xe,Fe){return Pe(xe,Fe).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(pe,Me,ve)=>{var se=ve("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),me=ve("./node_modules/xml-parse-from-string/index.js"),Te={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};pe.exports=function(xe){xe=xe.toString();var Fe=me(xe),Oe={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(ze){var tt=Fe.getElementsByTagName(ze)[0];tt&&(Oe[ze]=se(Re(tt)))});var Ne=Fe.getElementsByTagName("pages")[0];if(!Ne)throw new Error("malformed file -- no <pages> element");for(var ke=Ne.getElementsByTagName("page"),Ve=0;Ve<ke.length;Ve++){var Xe=ke[Ve],$e=parseInt(Xe.getAttribute("id"),10),st=Xe.getAttribute("file");if(isNaN($e))throw new Error('malformed file -- page "id" attribute is NaN');if(!st)throw new Error('malformed file -- needs page "file" attribute');Oe.pages[parseInt($e,10)]=st}return["chars","kernings"].forEach(function(ze){var tt=Fe.getElementsByTagName(ze)[0];if(tt)for(var ft=ze.substring(0,ze.length-1),Rt=tt.getElementsByTagName(ft),Mt=0;Mt<Rt.length;Mt++){var Gt=Rt[Mt];Oe[ze].push(se(Re(Gt)))}}),Oe};function Re(Le){var xe=be(Le);return xe.reduce(function(Fe,Oe){var Ne=Pe(Oe.nodeName);return Fe[Ne]=Oe.nodeValue,Fe},{})}function be(Le){for(var xe=[],Fe=0;Fe<Le.attributes.length;Fe++)xe.push(Le.attributes[Fe]);return xe}function Pe(Le){return Te[Le.toLowerCase()]||Le}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":pe=>{var Me="chasrset";pe.exports=function(me){Me in me&&(me.charset=me[Me],delete me[Me]);for(var Te in me)Te==="face"||Te==="charset"||(Te==="padding"||Te==="spacing"?me[Te]=ve(me[Te]):me[Te]=parseInt(me[Te],10));return me};function ve(se){return se.split(",").map(function(me){return parseInt(me,10)})}},"./node_modules/parse-headers/parse-headers.js":pe=>{var Me=function(se){return se.replace(/^\s+|\s+$/g,"")},ve=function(se){return Object.prototype.toString.call(se)==="[object Array]"};pe.exports=function(se){if(!se)return{};for(var me={},Te=Me(se).split(`
`),Re=0;Re<Te.length;Re++){var be=Te[Re],Pe=be.indexOf(":"),Le=Me(be.slice(0,Pe)).toLowerCase(),xe=Me(be.slice(Pe+1));typeof me[Le]>"u"?me[Le]=xe:ve(me[Le])?me[Le].push(xe):me[Le]=[me[Le],xe]}return me}},"./node_modules/quad-indices/index.js":(pe,Me,ve)=>{var se=ve("./node_modules/dtype/index.js"),me=ve("./node_modules/an-array/index.js"),Te=ve("./node_modules/is-buffer/index.js"),Re=[0,2,3],be=[2,1,3];pe.exports=function(Le,xe){(!Le||!(me(Le)||Te(Le)))&&(xe=Le||{},Le=null),typeof xe=="number"?xe={count:xe}:xe=xe||{};for(var Fe=typeof xe.type=="string"?xe.type:"uint16",Oe=typeof xe.count=="number"?xe.count:1,Ne=xe.start||0,ke=xe.clockwise!==!1?Re:be,Ve=ke[0],Xe=ke[1],$e=ke[2],st=Oe*6,ze=Le||new(se(Fe))(st),tt=0,ft=0;tt<st;tt+=6,ft+=4){var Rt=tt+Ne;ze[Rt+0]=ft+0,ze[Rt+1]=ft+1,ze[Rt+2]=ft+2,ze[Rt+3]=ft+Ve,ze[Rt+4]=ft+Xe,ze[Rt+5]=ft+$e}return ze}},"./node_modules/super-animejs/lib/anime.es.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{default:()=>di});var se={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},me={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},Te=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],Re={CSS:{},springs:{}};function be($t,Jt,xn){return Math.min(Math.max($t,Jt),xn)}function Pe($t,Jt){return $t.indexOf(Jt)>-1}function Le($t,Jt){return $t.apply(null,Jt)}var xe=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,Fe=/^rgb/,Oe=/^hsl/,Ne={arr:function($t){return Array.isArray($t)},obj:function($t){return Pe(Object.prototype.toString.call($t),"Object")},pth:function($t){return Ne.obj($t)&&$t.hasOwnProperty("totalLength")},svg:function($t){return $t instanceof SVGElement},inp:function($t){return $t instanceof HTMLInputElement},dom:function($t){return $t.nodeType||Ne.svg($t)},str:function($t){return typeof $t=="string"},fnc:function($t){return typeof $t=="function"},und:function($t){return typeof $t>"u"},hex:function($t){return xe.test($t)},rgb:function($t){return Fe.test($t)},hsl:function($t){return Oe.test($t)},col:function($t){return Ne.hex($t)||Ne.rgb($t)||Ne.hsl($t)},key:function($t){return!se.hasOwnProperty($t)&&!me.hasOwnProperty($t)&&$t!=="targets"&&$t!=="keyframes"}},ke=/\(([^)]+)\)/;function Ve($t){var Jt=ke.exec($t);return Jt?Jt[1].split(",").map(function(xn){return parseFloat(xn)}):[]}function Xe($t,Jt){var xn=Ve($t),Vn=be(Ne.und(xn[0])?1:xn[0],.1,100),Dn=be(Ne.und(xn[1])?100:xn[1],.1,100),jn=be(Ne.und(xn[2])?10:xn[2],.1,100),gi=be(Ne.und(xn[3])?0:xn[3],.1,100),Wi=Math.sqrt(Dn/Vn),Li=jn/(2*Math.sqrt(Dn*Vn)),vi=Li<1?Wi*Math.sqrt(1-Li*Li):0,yr=1,Sr=Li<1?(Li*Wi+-gi)/vi:-gi+Wi;function Ur(er){var as=Jt?Jt*er/1e3:er;return Li<1?as=Math.exp(-as*Li*Wi)*(yr*Math.cos(vi*as)+Sr*Math.sin(vi*as)):as=(yr+Sr*as)*Math.exp(-as*Wi),er===0||er===1?er:1-as}function hs(){var er=Re.springs[$t];if(er)return er;for(var as=1/6,Yr=0,eo=0;;)if(Yr+=as,Ur(Yr)===1){if(eo++,eo>=16)break}else eo=0;var wo=Yr*as*1e3;return Re.springs[$t]=wo,wo}return Jt?Ur:hs}function $e($t,Jt){$t===void 0&&($t=1),Jt===void 0&&(Jt=.5);var xn=be($t,1,10),Vn=be(Jt,.1,2);return function(Dn){return Dn===0||Dn===1?Dn:-xn*Math.pow(2,10*(Dn-1))*Math.sin((Dn-1-Vn/(Math.PI*2)*Math.asin(1/xn))*(Math.PI*2)/Vn)}}function st($t){return $t===void 0&&($t=10),function(Jt){return Math.round(Jt*$t)*(1/$t)}}var ze=function(){var $t=11,Jt=1/($t-1);function xn(yr,Sr){return 1-3*Sr+3*yr}function Vn(yr,Sr){return 3*Sr-6*yr}function Dn(yr){return 3*yr}function jn(yr,Sr,Ur){return((xn(Sr,Ur)*yr+Vn(Sr,Ur))*yr+Dn(Sr))*yr}function gi(yr,Sr,Ur){return 3*xn(Sr,Ur)*yr*yr+2*Vn(Sr,Ur)*yr+Dn(Sr)}function Wi(yr,Sr,Ur,hs,er){var as,Yr,eo=0;do Yr=Sr+(Ur-Sr)/2,as=jn(Yr,hs,er)-yr,as>0?Ur=Yr:Sr=Yr;while(Math.abs(as)>1e-7&&++eo<10);return Yr}function Li(yr,Sr,Ur,hs){for(var er=0;er<4;++er){var as=gi(Sr,Ur,hs);if(as===0)return Sr;var Yr=jn(Sr,Ur,hs)-yr;Sr-=Yr/as}return Sr}function vi(yr,Sr,Ur,hs){if(!(0<=yr&&yr<=1&&0<=Ur&&Ur<=1))return;var er=new Float32Array($t);if(yr!==Sr||Ur!==hs)for(var as=0;as<$t;++as)er[as]=jn(as*Jt,yr,Ur);function Yr(eo){for(var wo=0,Er=1,Ss=$t-1;Er!==Ss&&er[Er]<=eo;++Er)wo+=Jt;--Er;var bs=(eo-er[Er])/(er[Er+1]-er[Er]),Ns=wo+bs*Jt,It=gi(Ns,yr,Ur);return It>=.001?Li(eo,Ns,yr,Ur):It===0?Ns:Wi(eo,wo,wo+Jt,yr,Ur)}return function(eo){return yr===Sr&&Ur===hs||eo===0||eo===1?eo:jn(Yr(eo),Sr,hs)}}return vi}(),tt=function(){var $t=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],Jt={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],$e],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(gi,Wi){return function(Li){return 1-$e(gi,Wi)(1-Li)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(gi,Wi){return function(Li){return Li<.5?$e(gi,Wi)(Li*2)/2:1-$e(gi,Wi)(Li*-2+2)/2}}]},xn={linear:[.25,.25,.75,.75]};for(var Vn in Jt)for(var Dn=0,jn=Jt[Vn].length;Dn<jn;Dn++)xn["ease"+Vn+$t[Dn]]=Jt[Vn][Dn];return xn}();function ft($t,Jt){if(Ne.fnc($t))return $t;var xn=$t.split("(")[0],Vn=tt[xn],Dn=Ve($t);switch(xn){case"spring":return Xe($t,Jt);case"cubicBezier":return Le(ze,Dn);case"steps":return Le(st,Dn);default:return Ne.fnc(Vn)?Le(Vn,Dn):Le(ze,Vn)}}function Rt($t){try{var Jt=document.querySelectorAll($t);return Jt}catch{return}}var Mt=[];function Gt($t,Jt){for(var xn=Mt,Vn=$t.length,Dn=arguments.length>=2?arguments[1]:void 0,jn=0;jn<Vn;jn++)if(jn in $t){var gi=$t[jn];Jt.call(Dn,gi,jn,$t)&&xn.push(gi)}return Mt=$t,Mt.length=0,xn}function _t($t,Jt){Jt||(Jt=[]);for(var xn=0,Vn=$t.length;xn<Vn;xn++){var Dn=$t[xn];Array.isArray(Dn)?_t(Dn,Jt):Jt.push(Dn)}return Jt}function Bt($t){return Ne.arr($t)?$t:(Ne.str($t)&&($t=Rt($t)||$t),$t instanceof NodeList||$t instanceof HTMLCollection?[].slice.call($t):[$t])}function dt($t,Jt){return $t.some(function(xn){return xn===Jt})}function ut($t){var Jt={};for(var xn in $t)Jt[xn]=$t[xn];return Jt}function Ut($t,Jt){var xn=ut($t);for(var Vn in $t)xn[Vn]=Jt.hasOwnProperty(Vn)?Jt[Vn]:$t[Vn];return xn}function Tt($t,Jt){var xn=ut($t);for(var Vn in Jt)xn[Vn]=Ne.und($t[Vn])?Jt[Vn]:$t[Vn];return xn}var Xt=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function hn($t){var Jt=Xt.exec($t);return Jt?"rgba("+Jt[1]+",1)":$t}var nn=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,An=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function Cn($t){var Jt=$t.replace(nn,function(gi,Wi,Li,vi){return Wi+Wi+Li+Li+vi+vi}),xn=An.exec(Jt),Vn=parseInt(xn[1],16),Dn=parseInt(xn[2],16),jn=parseInt(xn[3],16);return"rgba("+Vn+","+Dn+","+jn+",1)"}var Nn=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Qn=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function fi($t){var Jt=Nn.exec($t)||Qn.exec($t),xn=parseInt(Jt[1],10)/360,Vn=parseInt(Jt[2],10)/100,Dn=parseInt(Jt[3],10)/100,jn=Jt[4]||1;function gi(Ur,hs,er){return er<0&&(er+=1),er>1&&(er-=1),er<.16666666666666666?Ur+(hs-Ur)*6*er:er<.5?hs:er<.6666666666666666?Ur+(hs-Ur)*(.6666666666666666-er)*6:Ur}var Wi,Li,vi;if(Vn==0)Wi=Li=vi=Dn;else{var yr=Dn<.5?Dn*(1+Vn):Dn+Vn-Dn*Vn,Sr=2*Dn-yr;Wi=gi(Sr,yr,xn+.3333333333333333),Li=gi(Sr,yr,xn),vi=gi(Sr,yr,xn-.3333333333333333)}return"rgba("+Wi*255+","+Li*255+","+vi*255+","+jn+")"}function hi($t){if(Ne.rgb($t))return hn($t);if(Ne.hex($t))return Cn($t);if(Ne.hsl($t))return fi($t)}var Qi=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Zi($t){var Jt=Qi.exec($t);if(Jt)return Jt[2]}function Mn($t){if(Pe($t,"translate")||$t==="perspective")return"px";if(Pe($t,"rotate")||Pe($t,"skew"))return"deg"}function Vr($t,Jt){return Ne.fnc($t)?$t(Jt.target,Jt.id,Jt.total):$t}function Ir($t,Jt){return $t.getAttribute(Jt)}function Rr($t,Jt,xn){var Vn=Zi(Jt);if(dt([xn,"deg","rad","turn"],Vn))return Jt;var Dn=Re.CSS[Jt+xn];if(!Ne.und(Dn))return Dn;var jn=100,gi=document.createElement($t.tagName),Wi=$t.parentNode&&$t.parentNode!==document?$t.parentNode:document.body;Wi.appendChild(gi),gi.style.position="absolute",gi.style.width=jn+xn;var Li=jn/gi.offsetWidth;Wi.removeChild(gi);var vi=Li*parseFloat(Jt);return Re.CSS[Jt+xn]=vi,vi}function ir($t,Jt,xn){if(Jt in $t.style){var Vn=Jt.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Dn=$t.style[Jt]||getComputedStyle($t).getPropertyValue(Vn)||"0";return xn?Rr($t,Dn,xn):Dn}}function zr($t,Jt){if(Ne.dom($t)&&!Ne.inp($t)&&(Ir($t,Jt)||Ne.svg($t)&&$t[Jt]))return"attribute";if(Ne.dom($t)&&dt(Te,Jt))return"transform";if(Ne.dom($t)&&Jt!=="transform"&&ir($t,Jt))return"css";if($t[Jt]!=null)return"object"}var Br=/(\w+)\(([^)]*)\)/g;function kt($t){if(Ne.dom($t)){for(var Jt=$t.style.transform||"",xn=new Map,Vn;Vn=Br.exec(Jt);)xn.set(Vn[1],Vn[2]);return xn}}function rn($t,Jt,xn,Vn){var Dn=Pe(Jt,"scale")?1:0+Mn(Jt),jn=kt($t).get(Jt)||Dn;return xn&&(xn.transforms.list.set(Jt,jn),xn.transforms.last=Jt),Vn?Rr($t,jn,Vn):jn}function Kn($t,Jt,xn,Vn){switch(zr($t,Jt)){case"transform":return rn($t,Jt,Vn,xn);case"css":return ir($t,Jt,xn);case"attribute":return Ir($t,Jt);default:return $t[Jt]||0}}var ai=/^(\*=|\+=|-=)/;function Ui($t,Jt){var xn=ai.exec($t);if(!xn)return $t;var Vn=Zi($t)||0,Dn=parseFloat(Jt),jn=parseFloat($t.replace(xn[0],""));switch(xn[0][0]){case"+":return Dn+jn+Vn;case"-":return Dn-jn+Vn;case"*":return Dn*jn+Vn}}var yi=/\s/g;function Nr($t,Jt){if(Ne.col($t))return hi($t);var xn=Zi($t),Vn=xn?$t.substr(0,$t.length-xn.length):$t;return Jt&&!yi.test($t)?Vn+Jt:Vn}function Ar($t,Jt){return Math.sqrt(Math.pow(Jt.x-$t.x,2)+Math.pow(Jt.y-$t.y,2))}function fr($t){return Math.PI*2*Ir($t,"r")}function Bi($t){return Ir($t,"width")*2+Ir($t,"height")*2}function Kt($t){return Ar({x:Ir($t,"x1"),y:Ir($t,"y1")},{x:Ir($t,"x2"),y:Ir($t,"y2")})}function Yt($t){for(var Jt=$t.points,xn=0,Vn,Dn=0;Dn<Jt.numberOfItems;Dn++){var jn=Jt.getItem(Dn);Dn>0&&(xn+=Ar(Vn,jn)),Vn=jn}return xn}function fn($t){var Jt=$t.points;return Yt($t)+Ar(Jt.getItem(Jt.numberOfItems-1),Jt.getItem(0))}function on($t){if($t.getTotalLength)return $t.getTotalLength();switch($t.tagName.toLowerCase()){case"circle":return fr($t);case"rect":return Bi($t);case"line":return Kt($t);case"polyline":return Yt($t);case"polygon":return fn($t)}}function an($t){var Jt=on($t);return $t.setAttribute("stroke-dasharray",Jt),Jt}function gn($t){for(var Jt=$t.parentNode;Ne.svg(Jt)&&(Jt=Jt.parentNode,!!Ne.svg(Jt.parentNode)););return Jt}function Nt($t,Jt){var xn=Jt||{},Vn=xn.el||gn($t),Dn=Vn.getBoundingClientRect(),jn=Ir(Vn,"viewBox"),gi=Dn.width,Wi=Dn.height,Li=xn.viewBox||(jn?jn.split(" "):[0,0,gi,Wi]);return{el:Vn,viewBox:Li,x:Li[0]/1,y:Li[1]/1,w:gi/Li[2],h:Wi/Li[3]}}function ht($t,Jt){var xn=Ne.str($t)?Rt($t)[0]:$t,Vn=Jt||100;return function(Dn){return{property:Dn,el:xn,svg:Nt(xn),totalLength:on(xn)*(Vn/100)}}}function ot($t,Jt){function xn(Wi){Wi===void 0&&(Wi=0);var Li=Jt+Wi>=1?Jt+Wi:0;return $t.el.getPointAtLength(Li)}var Vn=Nt($t.el,$t.svg),Dn=xn(),jn=xn(-1),gi=xn(1);switch($t.property){case"x":return(Dn.x-Vn.x)*Vn.w;case"y":return(Dn.y-Vn.y)*Vn.h;case"angle":return Math.atan2(gi.y-jn.y,gi.x-jn.x)*180/Math.PI}}var Vt=/-?\d*\.?\d+/g;function Wt($t,Jt){var xn=Nr(Ne.pth($t)?$t.totalLength:$t,Jt)+"";return{original:xn,numbers:xn.match(Vt)?xn.match(Vt).map(Number):[0],strings:Ne.str($t)||Jt?xn.split(Vt):[]}}function sn($t){var Jt=$t?_t(Ne.arr($t)?$t.map(Bt):Bt($t)):[];return Gt(Jt,function(xn,Vn,Dn){return Dn.indexOf(xn)===Vn})}function yn($t){var Jt=sn($t);return Jt.map(function(xn,Vn){return{target:xn,id:Vn,total:Jt.length,transforms:{list:kt(xn)}}})}var ni=/^spring/;function ki($t,Jt){var xn=ut(Jt);if(ni.test(xn.easing)&&(xn.duration=Xe(xn.easing)),Ne.arr($t)){var Vn=$t.length,Dn=Vn===2&&!Ne.obj($t[0]);Dn?$t={value:$t}:Ne.fnc(Jt.duration)||(xn.duration=Jt.duration/Vn)}var jn=Ne.arr($t)?$t:[$t];return jn.map(function(gi,Wi){var Li=Ne.obj(gi)&&!Ne.pth(gi)?gi:{value:gi};return Ne.und(Li.delay)&&(Li.delay=Wi?0:Jt.delay),Ne.und(Li.endDelay)&&(Li.endDelay=Wi===jn.length-1?Jt.endDelay:0),Li}).map(function(gi){return Tt(gi,xn)})}function Hi($t){for(var Jt=Gt(_t($t.map(function(jn){return Object.keys(jn)})),function(jn){return Ne.key(jn)}).reduce(function(jn,gi){return jn.indexOf(gi)<0&&jn.push(gi),jn},[]),xn={},Vn=function(jn){var gi=Jt[jn];xn[gi]=$t.map(function(Wi){var Li={};for(var vi in Wi)Ne.key(vi)?vi==gi&&(Li.value=Wi[vi]):Li[vi]=Wi[vi];return Li})},Dn=0;Dn<Jt.length;Dn++)Vn(Dn);return xn}function ji($t,Jt){var xn=[],Vn=Jt.keyframes;Vn&&(Jt=Tt(Hi(Vn),Jt));for(var Dn in Jt)Ne.key(Dn)&&xn.push({name:Dn,tweens:ki(Jt[Dn],$t)});return xn}function Xi($t,Jt){var xn={};for(var Vn in $t){var Dn=Vr($t[Vn],Jt);Ne.arr(Dn)&&(Dn=Dn.map(function(jn){return Vr(jn,Jt)}),Dn.length===1&&(Dn=Dn[0])),xn[Vn]=Dn}return xn.duration=parseFloat(xn.duration),xn.delay=parseFloat(xn.delay),xn}function Ws($t,Jt){var xn;return $t.tweens.map(function(Vn){var Dn=Xi(Vn,Jt),jn=Dn.value,gi=Ne.arr(jn)?jn[1]:jn,Wi=Zi(gi),Li=Kn(Jt.target,$t.name,Wi,Jt),vi=xn?xn.to.original:Li,yr=Ne.arr(jn)?jn[0]:vi,Sr=Zi(yr)||Zi(Li),Ur=Wi||Sr;return Ne.und(gi)&&(gi=vi),Dn.from=Wt(yr,Ur),Dn.to=Wt(Ui(gi,yr),Ur),Dn.start=xn?xn.end:0,Dn.end=Dn.start+Dn.delay+Dn.duration+Dn.endDelay,Dn.easing=ft(Dn.easing,Dn.duration),Dn.isPath=Ne.pth(jn),Dn.isColor=Ne.col(Dn.from.original),Dn.isColor&&(Dn.round=1),xn=Dn,Dn})}var Jr={css:function($t,Jt,xn){return $t.style[Jt]=xn},attribute:function($t,Jt,xn){return $t.setAttribute(Jt,xn)},object:function($t,Jt,xn){return $t[Jt]=xn},transform:function($t,Jt,xn,Vn,Dn){if(Vn.list.set(Jt,xn),Jt===Vn.last||Dn){var jn="";Vn.list.forEach(function(gi,Wi){jn+=Wi+"("+gi+") "}),$t.style.transform=jn}}};function Ai($t,Jt){for(var xn=yn($t),Vn=0,Dn=xn.length;Vn<Dn;Vn++){var jn=xn[Vn];for(var gi in Jt){var Wi=Vr(Jt[gi],jn),Li=jn.target,vi=Zi(Wi),yr=Kn(Li,gi,vi,jn),Sr=vi||Zi(yr),Ur=Ui(Nr(Wi,Sr),yr),hs=zr(Li,gi);Jr[hs](Li,gi,Ur,jn.transforms,!0)}}}function js($t,Jt){var xn=zr($t.target,Jt.name);if(xn){var Vn=Ws(Jt,$t),Dn=Vn[Vn.length-1];return{type:xn,property:Jt.name,animatable:$t,tweens:Vn,duration:Dn.end,delay:Vn[0].delay,endDelay:Dn.endDelay}}}function Qs($t,Jt){return Gt(_t($t.map(function(xn){return Jt.map(function(Vn){return js(xn,Vn)})})),function(xn){return!Ne.und(xn)})}function Vo($t,Jt){var xn=$t.length,Vn=function(jn){return jn.timelineOffset?jn.timelineOffset:0},Dn={};return Dn.duration=xn?Math.max.apply(Math,$t.map(function(jn){return Vn(jn)+jn.duration})):Jt.duration,Dn.delay=xn?Math.min.apply(Math,$t.map(function(jn){return Vn(jn)+jn.delay})):Jt.delay,Dn.endDelay=xn?Dn.duration-Math.max.apply(Math,$t.map(function(jn){return Vn(jn)+jn.duration-jn.endDelay})):Jt.endDelay,Dn}var Mo=0;function Ia($t){var Jt=Ut(se,$t),xn=Ut(me,$t),Vn=ji(xn,$t),Dn=yn($t.targets),jn=Qs(Dn,Vn),gi=Vo(jn,xn),Wi=Mo;return Mo++,Tt(Jt,{id:Wi,children:[],animatables:Dn,animations:jn,duration:gi.duration,delay:gi.delay,endDelay:gi.endDelay})}var Do=[],Ca=[],l0,Ra=function(){function $t(){l0=requestAnimationFrame(Jt)}function Jt(xn){var Vn=Do.length;if(Vn){for(var Dn=0;Dn<Vn;){var jn=Do[Dn];if(!jn.paused)jn.tick(xn);else{var gi=Do.indexOf(jn);gi>-1&&(Do.splice(gi,1),Vn=Do.length)}Dn++}$t()}else l0=cancelAnimationFrame(l0)}return $t}();function ko(){if(document.hidden){for(var $t=0,Jt=Do.length;$t<Jt;$t++)activeInstance[$t].pause();Ca=Do.slice(0),Do=[]}else for(var xn=0,Vn=Ca.length;xn<Vn;xn++)Ca[xn].play()}document.addEventListener("visibilitychange",ko);function Ts($t){$t===void 0&&($t={});var Jt=0,xn=0,Vn=0,Dn,jn=0,gi=null;function Wi(){return window.Promise&&new Promise(function(Er){return gi=Er})}var Li=Wi(),vi=Ia($t);function yr(){vi.reversed=!vi.reversed;for(var Er=0,Ss=Dn.length;Er<Ss;Er++)Dn[Er].reversed=vi.reversed}function Sr(Er){return vi.reversed?vi.duration-Er:Er}function Ur(){Jt=0,xn=Sr(vi.currentTime)*(1/Ts.speed)}function hs(Er,Ss){Ss&&Ss.seek(Er-Ss.timelineOffset)}function er(Er){if(vi.reversePlayback)for(var bs=jn;bs--;)hs(Er,Dn[bs]);else for(var Ss=0;Ss<jn;Ss++)hs(Er,Dn[Ss])}function as(Er){for(var Ss=0,bs=vi.animations,Ns=bs.length;Ss<Ns;){var It=bs[Ss],Ot=It.animatable,zt=It.tweens,jt=zt.length-1,mn=zt[jt];jt&&(mn=Gt(zt,function(Po){return Er<Po.end})[0]||mn);for(var kn=be(Er-mn.start-mn.delay,0,mn.duration)/mn.duration,Yn=isNaN(kn)?1:mn.easing(kn),xi=mn.to.strings,zi=mn.round,ti=[],bi=mn.to.numbers.length,cr=void 0,Gr=0;Gr<bi;Gr++){var Ki=void 0,As=mn.to.numbers[Gr],Ls=mn.from.numbers[Gr]||0;mn.isPath?Ki=ot(mn.value,Yn*As):Ki=Ls+Yn*(As-Ls),zi&&(mn.isColor&&Gr>2||(Ki=Math.round(Ki*zi)/zi)),ti.push(Ki)}var ys=xi.length;if(!ys)cr=ti[0];else{cr=xi[0];for(var ds=0;ds<ys;ds++){xi[ds];var $s=xi[ds+1],Ao=ti[ds];isNaN(Ao)||($s?cr+=Ao+$s:cr+=Ao+" ")}}Jr[It.type](Ot.target,It.property,cr,Ot.transforms),It.currentValue=cr,Ss++}}function Yr(Er){vi[Er]&&!vi.passThrough&&vi[Er](vi)}function eo(){vi.remaining&&vi.remaining!==!0&&vi.remaining--}function wo(Er){var Ss=vi.duration,bs=vi.delay,Ns=Ss-vi.endDelay,It=Sr(Er);vi.progress=be(It/Ss*100,0,100),vi.reversePlayback=It<vi.currentTime,Dn&&er(It),!vi.began&&vi.currentTime>0&&(vi.began=!0,Yr("begin"),Yr("loopBegin")),It<=bs&&vi.currentTime!==0&&as(0),(It>=Ns&&vi.currentTime!==Ss||!Ss)&&as(Ss),It>bs&&It<Ns?(vi.changeBegan||(vi.changeBegan=!0,vi.changeCompleted=!1,Yr("changeBegin")),Yr("change"),as(It)):vi.changeBegan&&(vi.changeCompleted=!0,vi.changeBegan=!1,Yr("changeComplete")),vi.currentTime=be(It,0,Ss),vi.began&&Yr("update"),Er>=Ss&&(xn=0,eo(),vi.remaining?(Jt=Vn,Yr("loopComplete"),Yr("loopBegin"),vi.direction==="alternate"&&yr()):(vi.paused=!0,vi.completed||(vi.completed=!0,Yr("loopComplete"),Yr("complete"),"Promise"in window&&(gi(),Li=Wi()))))}return vi.reset=function(){var Er=vi.direction;vi.passThrough=!1,vi.currentTime=0,vi.progress=0,vi.paused=!0,vi.began=!1,vi.changeBegan=!1,vi.completed=!1,vi.changeCompleted=!1,vi.reversePlayback=!1,vi.reversed=Er==="reverse",vi.remaining=vi.loop,Dn=vi.children,jn=Dn.length;for(var Ss=jn;Ss--;)vi.children[Ss].reset();(vi.reversed&&vi.loop!==!0||Er==="alternate"&&vi.loop===1)&&vi.remaining++,as(0)},vi.set=function(Er,Ss){return Ai(Er,Ss),vi},vi.tick=function(Er){Vn=Er,Jt||(Jt=Vn),wo((Vn+(xn-Jt))*Ts.speed)},vi.seek=function(Er){wo(Sr(Er))},vi.pause=function(){vi.paused=!0,Ur()},vi.play=function(){vi.paused&&(vi.paused=!1,Do.push(vi),Ur(),l0||Ra())},vi.reverse=function(){yr(),Ur()},vi.restart=function(){vi.reset(),vi.play()},vi.finished=Li,vi.reset(),vi.autoplay&&vi.play(),vi}function ta($t,Jt){for(var xn=Jt.length;xn--;)dt($t,Jt[xn].animatable.target)&&Jt.splice(xn,1)}function q0($t){for(var Jt=sn($t),xn=Do.length;xn--;){var Vn=Do[xn],Dn=Vn.animations,jn=Vn.children;ta(Jt,Dn);for(var gi=jn.length;gi--;){var Wi=jn[gi],Li=Wi.animations;ta(Jt,Li),!Li.length&&!Wi.children.length&&jn.splice(gi,1)}!Dn.length&&!jn.length&&Vn.pause()}}function dn($t,Jt){Jt===void 0&&(Jt={});var xn=Jt.direction||"normal",Vn=Jt.easing?ft(Jt.easing):null,Dn=Jt.grid,jn=Jt.axis,gi=Jt.from||0,Wi=gi==="first",Li=gi==="center",vi=gi==="last",yr=Ne.arr($t),Sr=parseFloat(yr?$t[0]:$t),Ur=yr?parseFloat($t[1]):0,hs=Zi(yr?$t[1]:$t)||0,er=Jt.start||0+(yr?Sr:0),as=[],Yr=0;return function(eo,wo,Er){if(Wi&&(gi=0),Li&&(gi=(Er-1)/2),vi&&(gi=Er-1),!as.length){for(var Ss=0;Ss<Er;Ss++){if(!Dn)as.push(Math.abs(gi-Ss));else{var bs=Li?(Dn[0]-1)/2:gi%Dn[0],Ns=Li?(Dn[1]-1)/2:Math.floor(gi/Dn[0]),It=Ss%Dn[0],Ot=Math.floor(Ss/Dn[0]),zt=bs-It,jt=Ns-Ot,mn=Math.sqrt(zt*zt+jt*jt);jn==="x"&&(mn=-zt),jn==="y"&&(mn=-jt),as.push(mn)}Yr=Math.max.apply(Math,as)}Vn&&(as=as.map(function(Yn){return Vn(Yn/Yr)*Yr})),xn==="reverse"&&(as=as.map(function(Yn){return jn?Yn<0?Yn*-1:-Yn:Math.abs(Yr-Yn)}))}var kn=yr?(Ur-Sr)/Yr:Sr;return er+kn*(Math.round(as[wo]*100)/100)+hs}}function qn($t){$t===void 0&&($t={});var Jt=Ts($t);return Jt.duration=0,Jt.add=function(xn,Vn){var Dn=Do.indexOf(Jt),jn=Jt.children;Dn>-1&&Do.splice(Dn,1);function gi(Ur){Ur.passThrough=!0}for(var Wi=0;Wi<jn.length;Wi++)gi(jn[Wi]);var Li=Tt(xn,Ut(me,$t));Li.targets=Li.targets||$t.targets;var vi=Jt.duration;Li.autoplay=!1,Li.direction=Jt.direction,Li.timelineOffset=Ne.und(Vn)?vi:Ui(Vn,vi),gi(Jt),Jt.seek(Li.timelineOffset);var yr=Ts(Li);gi(yr),jn.push(yr);var Sr=Vo(jn,$t);return Jt.delay=Sr.delay,Jt.endDelay=Sr.endDelay,Jt.duration=Sr.duration,Jt.seek(0),Jt.reset(),Jt.autoplay&&Jt.play(),Jt},Jt}Ts.version="3.0.0",Ts.speed=1,Ts.running=Do,Ts.remove=q0,Ts.get=Kn,Ts.set=Ai,Ts.convertPx=Rr,Ts.path=ht,Ts.setDashoffset=an,Ts.stagger=dn,Ts.timeline=qn,Ts.easing=ft,Ts.penner=tt,Ts.random=function($t,Jt){return Math.floor(Math.random()*(Jt-$t+1))+$t};const di=Ts},"./node_modules/three-bmfont-text/index.js":(pe,Me,ve)=>{var se=ve("./node_modules/layout-bmfont-text/index.js"),me=ve("./node_modules/quad-indices/index.js"),Te=ve("./node_modules/three-bmfont-text/lib/vertices.js"),Re=ve("./node_modules/three-bmfont-text/lib/utils.js");pe.exports=function(Le){return new be(Le)};class be extends THREE.BufferGeometry{constructor(Le){super(),typeof Le=="string"&&(Le={text:Le}),this._opt=Object.assign({},Le),Le&&this.update(Le)}update(Le){if(typeof Le=="string"&&(Le={text:Le}),Le=Object.assign({},this._opt,Le),!Le.font)throw new TypeError("must specify a { font } in options");this.layout=se(Le);var xe=Le.flipY!==!1,Fe=Le.font,Oe=Fe.common.scaleW,Ne=Fe.common.scaleH,ke=this.layout.glyphs.filter(function(ze){var tt=ze.data;return tt.width*tt.height>0});this.visibleGlyphs=ke;var Ve=Te.positions(ke),Xe=Te.uvs(ke,Oe,Ne,xe),$e=me([],{clockwise:!0,type:"uint16",count:ke.length});if(this.setIndex($e),this.setAttribute("position",new THREE.BufferAttribute(Ve,2)),this.setAttribute("uv",new THREE.BufferAttribute(Xe,2)),!Le.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(Le.multipage){var st=Te.pages(ke);this.setAttribute("page",new THREE.BufferAttribute(st,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var Le=this.attributes.position.array,xe=this.attributes.position.itemSize;if(!Le||!xe||Le.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}Re.computeSphere(Le,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var Le=this.boundingBox,xe=this.attributes.position.array,Fe=this.attributes.position.itemSize;if(!xe||!Fe||xe.length<2){Le.makeEmpty();return}Re.computeBox(xe,Le)}}},"./node_modules/three-bmfont-text/lib/utils.js":pe=>{var Me=2,ve={min:[0,0],max:[0,0]};function se(me){var Te=me.length/Me;ve.min[0]=me[0],ve.min[1]=me[1],ve.max[0]=me[0],ve.max[1]=me[1];for(var Re=0;Re<Te;Re++){var be=me[Re*Me+0],Pe=me[Re*Me+1];ve.min[0]=Math.min(be,ve.min[0]),ve.min[1]=Math.min(Pe,ve.min[1]),ve.max[0]=Math.max(be,ve.max[0]),ve.max[1]=Math.max(Pe,ve.max[1])}}pe.exports.computeBox=function(me,Te){se(me),Te.min.set(ve.min[0],ve.min[1],0),Te.max.set(ve.max[0],ve.max[1],0)},pe.exports.computeSphere=function(me,Te){se(me);var Re=ve.min[0],be=ve.min[1],Pe=ve.max[0],Le=ve.max[1],xe=Pe-Re,Fe=Le-be,Oe=Math.sqrt(xe*xe+Fe*Fe);Te.center.set(Re+xe/2,be+Fe/2,0),Te.radius=Oe/2}},"./node_modules/three-bmfont-text/lib/vertices.js":pe=>{pe.exports.pages=function(ve){var se=new Float32Array(ve.length*4*1),me=0;return ve.forEach(function(Te){var Re=Te.data.page||0;se[me++]=Re,se[me++]=Re,se[me++]=Re,se[me++]=Re}),se},pe.exports.uvs=function(ve,se,me,Te){var Re=new Float32Array(ve.length*4*2),be=0;return ve.forEach(function(Pe){var Le=Pe.data,xe=Le.x+Le.width,Fe=Le.y+Le.height,Oe=Le.x/se,Ne=Le.y/me,ke=xe/se,Ve=Fe/me;Te&&(Ne=(me-Le.y)/me,Ve=(me-Fe)/me),Re[be++]=Oe,Re[be++]=Ne,Re[be++]=Oe,Re[be++]=Ve,Re[be++]=ke,Re[be++]=Ve,Re[be++]=ke,Re[be++]=Ne}),Re},pe.exports.positions=function(ve){var se=new Float32Array(ve.length*4*2),me=0;return ve.forEach(function(Te){var Re=Te.data,be=Te.position[0]+Re.xoffset,Pe=Te.position[1]+Re.yoffset,Le=Re.width,xe=Re.height;se[me++]=be,se[me++]=Pe,se[me++]=be,se[me++]=Pe+xe,se[me++]=be+Le,se[me++]=Pe+xe,se[me++]=be+Le,se[me++]=Pe}),se}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(pe,Me,ve){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(se,me){pe.exports=me()})(this,function(){var se=typeof window<"u"?window:typeof ve.g<"u"?ve.g:typeof self<"u"?self:{};function me($e){return $e&&$e.__esModule&&Object.prototype.hasOwnProperty.call($e,"default")?$e.default:$e}function Te($e,st){return st={exports:{}},$e(st,st.exports),st.exports}var Re=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},be=function(st,ze){for(var tt=0,ft=st.length;tt<ft;tt++)ze[tt]=st[tt]},Pe=function(st,ze){for(var tt in ze)ze.hasOwnProperty(tt)&&(st[tt]=ze[tt]);return st},Le=Te(function($e,st){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(ze,tt){$e.exports=tt()})(se,function(){var ze=function(It,Ot){if(!(It instanceof Ot))throw new TypeError("Cannot call a class as a function")},tt=function(){function It(Ot,zt){for(var jt=0;jt<zt.length;jt++){var mn=zt[jt];mn.enumerable=mn.enumerable||!1,mn.configurable=!0,"value"in mn&&(mn.writable=!0),Object.defineProperty(Ot,mn.key,mn)}}return function(Ot,zt,jt){return zt&&It(Ot.prototype,zt),jt&&It(Ot,jt),Ot}}(),ft=function(){function It(Ot,zt){var jt=[],mn=!0,kn=!1,Yn=void 0;try{for(var xi=Ot[Symbol.iterator](),zi;!(mn=(zi=xi.next()).done)&&(jt.push(zi.value),!(zt&&jt.length===zt));mn=!0);}catch(ti){kn=!0,Yn=ti}finally{try{!mn&&xi.return&&xi.return()}finally{if(kn)throw Yn}}return jt}return function(Ot,zt){if(Array.isArray(Ot))return Ot;if(Symbol.iterator in Object(Ot))return It(Ot,zt);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Rt=.001,Mt=1,Gt=function(Ot,zt){return"data:"+Ot+","+encodeURIComponent(zt)},_t=function(Ot,zt,jt){return Ot+(zt-Ot)*jt},Bt=function(){var It=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return It}}(),dt=function(){var It=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return It}}(),ut=function(){var It=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return It}}(),Ut=function(){var It=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return It}}(),Tt=function(){var It=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),Ot=It?parseInt(It[1],10):null;return function(){return Ot}}(),Xt=function(){var It=!1;return It=Bt()&&ut()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return It}}(),hn=function(){var It=!1;if(Tt()===65){var Ot=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(Ot){var zt=Ot[1].split("."),jt=ft(zt,4);jt[0],jt[1];var mn=jt[2],kn=jt[3];It=parseInt(mn,10)===3325&&parseInt(kn,10)<148}}return function(){return It}}(),nn=function(){var It=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return It}}(),An=function(){var Ot=window.orientation==90||window.orientation==-90;return nn()?!Ot:Ot},Cn=function(Ot){return!(isNaN(Ot)||Ot<=Rt||Ot>Mt)},Nn=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Qn=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},fi=function(Ot){if(dt())return!1;if(Ot.requestFullscreen)Ot.requestFullscreen();else if(Ot.webkitRequestFullscreen)Ot.webkitRequestFullscreen();else if(Ot.mozRequestFullScreen)Ot.mozRequestFullScreen();else if(Ot.msRequestFullscreen)Ot.msRequestFullscreen();else return!1;return!0},hi=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},Qi=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Zi=function(Ot,zt,jt,mn){var kn=Ot.createShader(Ot.VERTEX_SHADER);Ot.shaderSource(kn,zt),Ot.compileShader(kn);var Yn=Ot.createShader(Ot.FRAGMENT_SHADER);Ot.shaderSource(Yn,jt),Ot.compileShader(Yn);var xi=Ot.createProgram();Ot.attachShader(xi,kn),Ot.attachShader(xi,Yn);for(var zi in mn)Ot.bindAttribLocation(xi,mn[zi],zi);return Ot.linkProgram(xi),Ot.deleteShader(kn),Ot.deleteShader(Yn),xi},Mn=function(Ot,zt){for(var jt={},mn=Ot.getProgramParameter(zt,Ot.ACTIVE_UNIFORMS),kn="",Yn=0;Yn<mn;Yn++){var xi=Ot.getActiveUniform(zt,Yn);kn=xi.name.replace("[0]",""),jt[kn]=Ot.getUniformLocation(zt,kn)}return jt},Vr=function(Ot,zt,jt,mn,kn,Yn,xi){var zi=1/(zt-jt),ti=1/(mn-kn),bi=1/(Yn-xi);return Ot[0]=-2*zi,Ot[1]=0,Ot[2]=0,Ot[3]=0,Ot[4]=0,Ot[5]=-2*ti,Ot[6]=0,Ot[7]=0,Ot[8]=0,Ot[9]=0,Ot[10]=2*bi,Ot[11]=0,Ot[12]=(zt+jt)*zi,Ot[13]=(kn+mn)*ti,Ot[14]=(xi+Yn)*bi,Ot[15]=1,Ot},Ir=function(){var Ot=!1;return function(zt){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(zt)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(zt.substr(0,4)))&&(Ot=!0)}(navigator.userAgent||navigator.vendor||window.opera),Ot},Rr=function(Ot,zt){for(var jt in zt)zt.hasOwnProperty(jt)&&(Ot[jt]=zt[jt]);return Ot},ir=function(Ot){if(Bt()){var zt=Ot.style.width,jt=Ot.style.height;Ot.style.width=parseInt(zt)+1+"px",Ot.style.height=parseInt(jt)+"px",setTimeout(function(){Ot.style.width=zt,Ot.style.height=jt},100)}window.canvas=Ot},zr=function(){var It=Math.PI/180,Ot=Math.PI*.25;function zt(ti,bi,cr,Gr){var Ki=Math.tan(bi?bi.upDegrees*It:Ot),As=Math.tan(bi?bi.downDegrees*It:Ot),Ls=Math.tan(bi?bi.leftDegrees*It:Ot),ys=Math.tan(bi?bi.rightDegrees*It:Ot),ds=2/(Ls+ys),$s=2/(Ki+As);return ti[0]=ds,ti[1]=0,ti[2]=0,ti[3]=0,ti[4]=0,ti[5]=$s,ti[6]=0,ti[7]=0,ti[8]=-((Ls-ys)*ds*.5),ti[9]=(Ki-As)*$s*.5,ti[10]=Gr/(cr-Gr),ti[11]=-1,ti[12]=0,ti[13]=0,ti[14]=Gr*cr/(cr-Gr),ti[15]=0,ti}function jt(ti,bi,cr){var Gr=bi[0],Ki=bi[1],As=bi[2],Ls=bi[3],ys=Gr+Gr,ds=Ki+Ki,$s=As+As,Ao=Gr*ys,Po=Gr*ds,mo=Gr*$s,fa=Ki*ds,pa=Ki*$s,zo=As*$s,Aa=Ls*ys,na=Ls*ds,ma=Ls*$s;return ti[0]=1-(fa+zo),ti[1]=Po+ma,ti[2]=mo-na,ti[3]=0,ti[4]=Po-ma,ti[5]=1-(Ao+zo),ti[6]=pa+Aa,ti[7]=0,ti[8]=mo+na,ti[9]=pa-Aa,ti[10]=1-(Ao+fa),ti[11]=0,ti[12]=cr[0],ti[13]=cr[1],ti[14]=cr[2],ti[15]=1,ti}function mn(ti,bi,cr){var Gr=cr[0],Ki=cr[1],As=cr[2],Ls,ys,ds,$s,Ao,Po,mo,fa,pa,zo,Aa,na;return bi===ti?(ti[12]=bi[0]*Gr+bi[4]*Ki+bi[8]*As+bi[12],ti[13]=bi[1]*Gr+bi[5]*Ki+bi[9]*As+bi[13],ti[14]=bi[2]*Gr+bi[6]*Ki+bi[10]*As+bi[14],ti[15]=bi[3]*Gr+bi[7]*Ki+bi[11]*As+bi[15]):(Ls=bi[0],ys=bi[1],ds=bi[2],$s=bi[3],Ao=bi[4],Po=bi[5],mo=bi[6],fa=bi[7],pa=bi[8],zo=bi[9],Aa=bi[10],na=bi[11],ti[0]=Ls,ti[1]=ys,ti[2]=ds,ti[3]=$s,ti[4]=Ao,ti[5]=Po,ti[6]=mo,ti[7]=fa,ti[8]=pa,ti[9]=zo,ti[10]=Aa,ti[11]=na,ti[12]=Ls*Gr+Ao*Ki+pa*As+bi[12],ti[13]=ys*Gr+Po*Ki+zo*As+bi[13],ti[14]=ds*Gr+mo*Ki+Aa*As+bi[14],ti[15]=$s*Gr+fa*Ki+na*As+bi[15]),ti}function kn(ti,bi){var cr=bi[0],Gr=bi[1],Ki=bi[2],As=bi[3],Ls=bi[4],ys=bi[5],ds=bi[6],$s=bi[7],Ao=bi[8],Po=bi[9],mo=bi[10],fa=bi[11],pa=bi[12],zo=bi[13],Aa=bi[14],na=bi[15],ma=cr*ys-Gr*Ls,L0=cr*ds-Ki*Ls,J0=cr*$s-As*Ls,C0=Gr*ds-Ki*ys,H0=Gr*$s-As*ys,D0=Ki*$s-As*ds,Z0=Ao*zo-Po*pa,Tl=Ao*Aa-mo*pa,Il=Ao*na-fa*pa,Va=Po*Aa-mo*zo,V0=Po*na-fa*zo,Ba=mo*na-fa*Aa,lo=ma*Ba-L0*V0+J0*Va+C0*Il-H0*Tl+D0*Z0;return lo?(lo=1/lo,ti[0]=(ys*Ba-ds*V0+$s*Va)*lo,ti[1]=(Ki*V0-Gr*Ba-As*Va)*lo,ti[2]=(zo*D0-Aa*H0+na*C0)*lo,ti[3]=(mo*H0-Po*D0-fa*C0)*lo,ti[4]=(ds*Il-Ls*Ba-$s*Tl)*lo,ti[5]=(cr*Ba-Ki*Il+As*Tl)*lo,ti[6]=(Aa*J0-pa*D0-na*L0)*lo,ti[7]=(Ao*D0-mo*J0+fa*L0)*lo,ti[8]=(Ls*V0-ys*Il+$s*Z0)*lo,ti[9]=(Gr*Il-cr*V0-As*Z0)*lo,ti[10]=(pa*H0-zo*J0+na*ma)*lo,ti[11]=(Po*J0-Ao*H0-fa*ma)*lo,ti[12]=(ys*Tl-Ls*Va-ds*Z0)*lo,ti[13]=(cr*Va-Gr*Tl+Ki*Z0)*lo,ti[14]=(zo*L0-pa*C0-Aa*ma)*lo,ti[15]=(Ao*C0-Po*L0+mo*ma)*lo,ti):null}var Yn=new Float32Array([0,0,0,1]),xi=new Float32Array([0,0,0]);function zi(ti,bi,cr,Gr,Ki,As){zt(ti,Gr||null,As.depthNear,As.depthFar);var Ls=cr.orientation||Yn,ys=cr.position||xi;jt(bi,Ls,ys),Ki&&mn(bi,bi,Ki),kn(bi,bi)}return function(ti,bi,cr){return!ti||!bi?!1:(ti.pose=bi,ti.timestamp=bi.timestamp,zi(ti.leftProjectionMatrix,ti.leftViewMatrix,bi,cr._getFieldOfView("left"),cr._getEyeOffset("left"),cr),zi(ti.rightProjectionMatrix,ti.rightViewMatrix,bi,cr._getFieldOfView("right"),cr._getEyeOffset("right"),cr),!0)}}(),Br=function(){var Ot=window.self!==window.top,zt=kt(document.referrer),jt=kt(window.location.href);return Ot&&zt!==jt},kt=function(Ot){var zt,jt=Ot.indexOf("://");jt!==-1?zt=jt+3:zt=0;var mn=Ot.indexOf("/",zt);return mn===-1&&(mn=Ot.length),Ot.substring(0,mn)},rn=function(Ot){if(Ot.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var zt=2*Math.acos(Ot.w);return zt},Kn=function(){var It={};return function(Ot,zt){It[Ot]===void 0&&(console.warn("webvr-polyfill: "+zt),It[Ot]=!0)}}(),ai=function(Ot,zt){var jt=zt?"Please use "+zt+" instead.":"";Kn(Ot,Ot+" has been deprecated. This may not work on native WebVR displays. "+jt)};function Ui(It,Ot,zt){if(!Ot){zt(It);return}for(var jt=[],mn=null,kn=0;kn<Ot.length;++kn){var Yn=Ot[kn];switch(Yn){case It.TEXTURE_BINDING_2D:case It.TEXTURE_BINDING_CUBE_MAP:var xi=Ot[++kn];if(xi<It.TEXTURE0||xi>It.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),jt.push(null,null);break}mn||(mn=It.getParameter(It.ACTIVE_TEXTURE)),It.activeTexture(xi),jt.push(It.getParameter(Yn),null);break;case It.ACTIVE_TEXTURE:mn=It.getParameter(It.ACTIVE_TEXTURE),jt.push(null);break;default:jt.push(It.getParameter(Yn));break}}zt(It);for(var kn=0;kn<Ot.length;++kn){var Yn=Ot[kn],zi=jt[kn];switch(Yn){case It.ACTIVE_TEXTURE:break;case It.ARRAY_BUFFER_BINDING:It.bindBuffer(It.ARRAY_BUFFER,zi);break;case It.COLOR_CLEAR_VALUE:It.clearColor(zi[0],zi[1],zi[2],zi[3]);break;case It.COLOR_WRITEMASK:It.colorMask(zi[0],zi[1],zi[2],zi[3]);break;case It.CURRENT_PROGRAM:It.useProgram(zi);break;case It.ELEMENT_ARRAY_BUFFER_BINDING:It.bindBuffer(It.ELEMENT_ARRAY_BUFFER,zi);break;case It.FRAMEBUFFER_BINDING:It.bindFramebuffer(It.FRAMEBUFFER,zi);break;case It.RENDERBUFFER_BINDING:It.bindRenderbuffer(It.RENDERBUFFER,zi);break;case It.TEXTURE_BINDING_2D:var xi=Ot[++kn];if(xi<It.TEXTURE0||xi>It.TEXTURE31)break;It.activeTexture(xi),It.bindTexture(It.TEXTURE_2D,zi);break;case It.TEXTURE_BINDING_CUBE_MAP:var xi=Ot[++kn];if(xi<It.TEXTURE0||xi>It.TEXTURE31)break;It.activeTexture(xi),It.bindTexture(It.TEXTURE_CUBE_MAP,zi);break;case It.VIEWPORT:It.viewport(zi[0],zi[1],zi[2],zi[3]);break;case It.BLEND:case It.CULL_FACE:case It.DEPTH_TEST:case It.SCISSOR_TEST:case It.STENCIL_TEST:zi?It.enable(Yn):It.disable(Yn);break;default:console.log("No GL restore behavior for 0x"+Yn.toString(16));break}mn&&It.activeTexture(mn)}}var yi=Ui,Nr=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),Ar=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function fr(It,Ot,zt,jt){this.gl=It,this.cardboardUI=Ot,this.bufferScale=zt,this.dirtySubmitFrameBindings=jt,this.ctxAttribs=It.getContextAttributes(),this.instanceExt=It.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=It.drawingBufferWidth,this.bufferHeight=It.drawingBufferHeight,this.realBindFramebuffer=It.bindFramebuffer,this.realEnable=It.enable,this.realDisable=It.disable,this.realColorMask=It.colorMask,this.realClearColor=It.clearColor,this.realViewport=It.viewport,Bt()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(It.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(It.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Zi(It,Nr,Ar,this.attribs),this.uniforms=Mn(It,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=It.createBuffer(),this.indexBuffer=It.createBuffer(),this.indexCount=0,this.renderTarget=It.createTexture(),this.framebuffer=It.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=It.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=It.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=It.createRenderbuffer()),this.patch(),this.onResize()}fr.prototype.destroy=function(){var It=this.gl;this.unpatch(),It.deleteProgram(this.program),It.deleteBuffer(this.vertexBuffer),It.deleteBuffer(this.indexBuffer),It.deleteTexture(this.renderTarget),It.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&It.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&It.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&It.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},fr.prototype.onResize=function(){var It=this.gl,Ot=this,zt=[It.RENDERBUFFER_BINDING,It.TEXTURE_BINDING_2D,It.TEXTURE0];yi(It,zt,function(jt){Ot.realBindFramebuffer.call(jt,jt.FRAMEBUFFER,null),Ot.scissorTest&&Ot.realDisable.call(jt,jt.SCISSOR_TEST),Ot.realColorMask.call(jt,!0,!0,!0,!0),Ot.realViewport.call(jt,0,0,jt.drawingBufferWidth,jt.drawingBufferHeight),Ot.realClearColor.call(jt,0,0,0,1),jt.clear(jt.COLOR_BUFFER_BIT),Ot.realBindFramebuffer.call(jt,jt.FRAMEBUFFER,Ot.framebuffer),jt.bindTexture(jt.TEXTURE_2D,Ot.renderTarget),jt.texImage2D(jt.TEXTURE_2D,0,Ot.ctxAttribs.alpha?jt.RGBA:jt.RGB,Ot.bufferWidth,Ot.bufferHeight,0,Ot.ctxAttribs.alpha?jt.RGBA:jt.RGB,jt.UNSIGNED_BYTE,null),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MAG_FILTER,jt.LINEAR),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_MIN_FILTER,jt.LINEAR),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_S,jt.CLAMP_TO_EDGE),jt.texParameteri(jt.TEXTURE_2D,jt.TEXTURE_WRAP_T,jt.CLAMP_TO_EDGE),jt.framebufferTexture2D(jt.FRAMEBUFFER,jt.COLOR_ATTACHMENT0,jt.TEXTURE_2D,Ot.renderTarget,0),Ot.ctxAttribs.depth&&Ot.ctxAttribs.stencil?(jt.bindRenderbuffer(jt.RENDERBUFFER,Ot.depthStencilBuffer),jt.renderbufferStorage(jt.RENDERBUFFER,jt.DEPTH_STENCIL,Ot.bufferWidth,Ot.bufferHeight),jt.framebufferRenderbuffer(jt.FRAMEBUFFER,jt.DEPTH_STENCIL_ATTACHMENT,jt.RENDERBUFFER,Ot.depthStencilBuffer)):Ot.ctxAttribs.depth?(jt.bindRenderbuffer(jt.RENDERBUFFER,Ot.depthBuffer),jt.renderbufferStorage(jt.RENDERBUFFER,jt.DEPTH_COMPONENT16,Ot.bufferWidth,Ot.bufferHeight),jt.framebufferRenderbuffer(jt.FRAMEBUFFER,jt.DEPTH_ATTACHMENT,jt.RENDERBUFFER,Ot.depthBuffer)):Ot.ctxAttribs.stencil&&(jt.bindRenderbuffer(jt.RENDERBUFFER,Ot.stencilBuffer),jt.renderbufferStorage(jt.RENDERBUFFER,jt.STENCIL_INDEX8,Ot.bufferWidth,Ot.bufferHeight),jt.framebufferRenderbuffer(jt.FRAMEBUFFER,jt.STENCIL_ATTACHMENT,jt.RENDERBUFFER,Ot.stencilBuffer)),!jt.checkFramebufferStatus(jt.FRAMEBUFFER)===jt.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),Ot.realBindFramebuffer.call(jt,jt.FRAMEBUFFER,Ot.lastBoundFramebuffer),Ot.scissorTest&&Ot.realEnable.call(jt,jt.SCISSOR_TEST),Ot.realColorMask.apply(jt,Ot.colorMask),Ot.realViewport.apply(jt,Ot.viewport),Ot.realClearColor.apply(jt,Ot.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},fr.prototype.patch=function(){if(!this.isPatched){var It=this,Ot=this.gl.canvas,zt=this.gl;Bt()||(Ot.width=Nn()*this.bufferScale,Ot.height=Qn()*this.bufferScale,Object.defineProperty(Ot,"width",{configurable:!0,enumerable:!0,get:function(){return It.bufferWidth},set:function(mn){It.bufferWidth=mn,It.realCanvasWidth.set.call(Ot,mn),It.onResize()}}),Object.defineProperty(Ot,"height",{configurable:!0,enumerable:!0,get:function(){return It.bufferHeight},set:function(mn){It.bufferHeight=mn,It.realCanvasHeight.set.call(Ot,mn),It.onResize()}})),this.lastBoundFramebuffer=zt.getParameter(zt.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(zt.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(jt,mn){It.lastBoundFramebuffer=mn||It.framebuffer,It.realBindFramebuffer.call(zt,jt,It.lastBoundFramebuffer)},this.cullFace=zt.getParameter(zt.CULL_FACE),this.depthTest=zt.getParameter(zt.DEPTH_TEST),this.blend=zt.getParameter(zt.BLEND),this.scissorTest=zt.getParameter(zt.SCISSOR_TEST),this.stencilTest=zt.getParameter(zt.STENCIL_TEST),zt.enable=function(jt){switch(jt){case zt.CULL_FACE:It.cullFace=!0;break;case zt.DEPTH_TEST:It.depthTest=!0;break;case zt.BLEND:It.blend=!0;break;case zt.SCISSOR_TEST:It.scissorTest=!0;break;case zt.STENCIL_TEST:It.stencilTest=!0;break}It.realEnable.call(zt,jt)},zt.disable=function(jt){switch(jt){case zt.CULL_FACE:It.cullFace=!1;break;case zt.DEPTH_TEST:It.depthTest=!1;break;case zt.BLEND:It.blend=!1;break;case zt.SCISSOR_TEST:It.scissorTest=!1;break;case zt.STENCIL_TEST:It.stencilTest=!1;break}It.realDisable.call(zt,jt)},this.colorMask=zt.getParameter(zt.COLOR_WRITEMASK),zt.colorMask=function(jt,mn,kn,Yn){It.colorMask[0]=jt,It.colorMask[1]=mn,It.colorMask[2]=kn,It.colorMask[3]=Yn,It.realColorMask.call(zt,jt,mn,kn,Yn)},this.clearColor=zt.getParameter(zt.COLOR_CLEAR_VALUE),zt.clearColor=function(jt,mn,kn,Yn){It.clearColor[0]=jt,It.clearColor[1]=mn,It.clearColor[2]=kn,It.clearColor[3]=Yn,It.realClearColor.call(zt,jt,mn,kn,Yn)},this.viewport=zt.getParameter(zt.VIEWPORT),zt.viewport=function(jt,mn,kn,Yn){It.viewport[0]=jt,It.viewport[1]=mn,It.viewport[2]=kn,It.viewport[3]=Yn,It.realViewport.call(zt,jt,mn,kn,Yn)},this.isPatched=!0,ir(Ot)}},fr.prototype.unpatch=function(){if(this.isPatched){var It=this.gl,Ot=this.gl.canvas;Bt()||(Object.defineProperty(Ot,"width",this.realCanvasWidth),Object.defineProperty(Ot,"height",this.realCanvasHeight)),Ot.width=this.bufferWidth,Ot.height=this.bufferHeight,It.bindFramebuffer=this.realBindFramebuffer,It.enable=this.realEnable,It.disable=this.realDisable,It.colorMask=this.realColorMask,It.clearColor=this.realClearColor,It.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&It.bindFramebuffer(It.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){ir(Ot)},1)}},fr.prototype.setTextureBounds=function(It,Ot){It||(It=[0,0,.5,1]),Ot||(Ot=[.5,0,.5,1]),this.viewportOffsetScale[0]=It[0],this.viewportOffsetScale[1]=It[1],this.viewportOffsetScale[2]=It[2],this.viewportOffsetScale[3]=It[3],this.viewportOffsetScale[4]=Ot[0],this.viewportOffsetScale[5]=Ot[1],this.viewportOffsetScale[6]=Ot[2],this.viewportOffsetScale[7]=Ot[3]},fr.prototype.submitFrame=function(){var It=this.gl,Ot=this,zt=[];if(this.dirtySubmitFrameBindings||zt.push(It.CURRENT_PROGRAM,It.ARRAY_BUFFER_BINDING,It.ELEMENT_ARRAY_BUFFER_BINDING,It.TEXTURE_BINDING_2D,It.TEXTURE0),yi(It,zt,function(mn){Ot.realBindFramebuffer.call(mn,mn.FRAMEBUFFER,null);var kn=0,Yn=0;Ot.instanceExt&&(kn=mn.getVertexAttrib(Ot.attribs.position,Ot.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),Yn=mn.getVertexAttrib(Ot.attribs.texCoord,Ot.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),Ot.cullFace&&Ot.realDisable.call(mn,mn.CULL_FACE),Ot.depthTest&&Ot.realDisable.call(mn,mn.DEPTH_TEST),Ot.blend&&Ot.realDisable.call(mn,mn.BLEND),Ot.scissorTest&&Ot.realDisable.call(mn,mn.SCISSOR_TEST),Ot.stencilTest&&Ot.realDisable.call(mn,mn.STENCIL_TEST),Ot.realColorMask.call(mn,!0,!0,!0,!0),Ot.realViewport.call(mn,0,0,mn.drawingBufferWidth,mn.drawingBufferHeight),(Ot.ctxAttribs.alpha||Bt())&&(Ot.realClearColor.call(mn,0,0,0,1),mn.clear(mn.COLOR_BUFFER_BIT)),mn.useProgram(Ot.program),mn.bindBuffer(mn.ELEMENT_ARRAY_BUFFER,Ot.indexBuffer),mn.bindBuffer(mn.ARRAY_BUFFER,Ot.vertexBuffer),mn.enableVertexAttribArray(Ot.attribs.position),mn.enableVertexAttribArray(Ot.attribs.texCoord),mn.vertexAttribPointer(Ot.attribs.position,2,mn.FLOAT,!1,20,0),mn.vertexAttribPointer(Ot.attribs.texCoord,3,mn.FLOAT,!1,20,8),Ot.instanceExt&&(kn!=0&&Ot.instanceExt.vertexAttribDivisorANGLE(Ot.attribs.position,0),Yn!=0&&Ot.instanceExt.vertexAttribDivisorANGLE(Ot.attribs.texCoord,0)),mn.activeTexture(mn.TEXTURE0),mn.uniform1i(Ot.uniforms.diffuse,0),mn.bindTexture(mn.TEXTURE_2D,Ot.renderTarget),mn.uniform4fv(Ot.uniforms.viewportOffsetScale,Ot.viewportOffsetScale),mn.drawElements(mn.TRIANGLES,Ot.indexCount,mn.UNSIGNED_SHORT,0),Ot.cardboardUI&&Ot.cardboardUI.renderNoState(),Ot.realBindFramebuffer.call(Ot.gl,mn.FRAMEBUFFER,Ot.framebuffer),Ot.ctxAttribs.preserveDrawingBuffer||(Ot.realClearColor.call(mn,0,0,0,0),mn.clear(mn.COLOR_BUFFER_BIT)),Ot.dirtySubmitFrameBindings||Ot.realBindFramebuffer.call(mn,mn.FRAMEBUFFER,Ot.lastBoundFramebuffer),Ot.cullFace&&Ot.realEnable.call(mn,mn.CULL_FACE),Ot.depthTest&&Ot.realEnable.call(mn,mn.DEPTH_TEST),Ot.blend&&Ot.realEnable.call(mn,mn.BLEND),Ot.scissorTest&&Ot.realEnable.call(mn,mn.SCISSOR_TEST),Ot.stencilTest&&Ot.realEnable.call(mn,mn.STENCIL_TEST),Ot.realColorMask.apply(mn,Ot.colorMask),Ot.realViewport.apply(mn,Ot.viewport),(Ot.ctxAttribs.alpha||!Ot.ctxAttribs.preserveDrawingBuffer)&&Ot.realClearColor.apply(mn,Ot.clearColor),Ot.instanceExt&&(kn!=0&&Ot.instanceExt.vertexAttribDivisorANGLE(Ot.attribs.position,kn),Yn!=0&&Ot.instanceExt.vertexAttribDivisorANGLE(Ot.attribs.texCoord,Yn))}),Bt()){var jt=It.canvas;(jt.width!=Ot.bufferWidth||jt.height!=Ot.bufferHeight)&&(Ot.bufferWidth=jt.width,Ot.bufferHeight=jt.height,Ot.onResize())}},fr.prototype.updateDeviceInfo=function(It){var Ot=this.gl,zt=this,jt=[Ot.ARRAY_BUFFER_BINDING,Ot.ELEMENT_ARRAY_BUFFER_BINDING];yi(Ot,jt,function(mn){var kn=zt.computeMeshVertices_(zt.meshWidth,zt.meshHeight,It);if(mn.bindBuffer(mn.ARRAY_BUFFER,zt.vertexBuffer),mn.bufferData(mn.ARRAY_BUFFER,kn,mn.STATIC_DRAW),!zt.indexCount){var Yn=zt.computeMeshIndices_(zt.meshWidth,zt.meshHeight);mn.bindBuffer(mn.ELEMENT_ARRAY_BUFFER,zt.indexBuffer),mn.bufferData(mn.ELEMENT_ARRAY_BUFFER,Yn,mn.STATIC_DRAW),zt.indexCount=Yn.length}})},fr.prototype.computeMeshVertices_=function(It,Ot,zt){for(var jt=new Float32Array(2*It*Ot*5),mn=zt.getLeftEyeVisibleTanAngles(),kn=zt.getLeftEyeNoLensTanAngles(),Yn=zt.getLeftEyeVisibleScreenRect(kn),xi=0,zi=0;zi<2;zi++){for(var ti=0;ti<Ot;ti++)for(var bi=0;bi<It;bi++,xi++){var cr=bi/(It-1),Gr=ti/(Ot-1),Ki=cr,As=Gr,Ls=_t(mn[0],mn[2],cr),ys=_t(mn[3],mn[1],Gr),ds=Math.sqrt(Ls*Ls+ys*ys),$s=zt.distortion.distortInverse(ds),Ao=Ls*$s/ds,Po=ys*$s/ds;cr=(Ao-kn[0])/(kn[2]-kn[0]),Gr=(Po-kn[3])/(kn[1]-kn[3]),cr=(Yn.x+cr*Yn.width-.5)*2,Gr=(Yn.y+Gr*Yn.height-.5)*2,jt[xi*5+0]=cr,jt[xi*5+1]=Gr,jt[xi*5+2]=Ki,jt[xi*5+3]=As,jt[xi*5+4]=zi}var mo=mn[2]-mn[0];mn[0]=-(mo+mn[0]),mn[2]=mo-mn[2],mo=kn[2]-kn[0],kn[0]=-(mo+kn[0]),kn[2]=mo-kn[2],Yn.x=1-(Yn.x+Yn.width)}return jt},fr.prototype.computeMeshIndices_=function(It,Ot){for(var zt=new Uint16Array(2*(It-1)*(Ot-1)*6),jt=It/2,mn=Ot/2,kn=0,Yn=0,xi=0;xi<2;xi++)for(var zi=0;zi<Ot;zi++)for(var ti=0;ti<It;ti++,kn++)ti==0||zi==0||(ti<=jt==zi<=mn?(zt[Yn++]=kn,zt[Yn++]=kn-It-1,zt[Yn++]=kn-It,zt[Yn++]=kn-It-1,zt[Yn++]=kn,zt[Yn++]=kn-1):(zt[Yn++]=kn-1,zt[Yn++]=kn-It,zt[Yn++]=kn,zt[Yn++]=kn-It,zt[Yn++]=kn-1,zt[Yn++]=kn-It-1));return zt},fr.prototype.getOwnPropertyDescriptor_=function(It,Ot){var zt=Object.getOwnPropertyDescriptor(It,Ot);return(zt.get===void 0||zt.set===void 0)&&(zt.configurable=!0,zt.enumerable=!0,zt.get=function(){return this.getAttribute(Ot)},zt.set=function(jt){this.setAttribute(Ot,jt)}),zt};var Bi=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),Kt=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),Yt=Math.PI/180,fn=60,on=12,an=20,gn=1,Nt=.75,ht=.3125,ot=4,Vt=28,Wt=1.5;function sn(It){this.gl=It,this.attribs={position:0},this.program=Zi(It,Bi,Kt,this.attribs),this.uniforms=Mn(It,this.program),this.vertexBuffer=It.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}sn.prototype.destroy=function(){var It=this.gl;this.listener&&It.canvas.removeEventListener("click",this.listener,!1),It.deleteProgram(this.program),It.deleteBuffer(this.vertexBuffer)},sn.prototype.listen=function(It,Ot){var zt=this.gl.canvas;this.listener=function(jt){var mn=zt.clientWidth/2,kn=Vt*Wt;jt.clientX>mn-kn&&jt.clientX<mn+kn&&jt.clientY>zt.clientHeight-kn?It(jt):jt.clientX<kn&&jt.clientY<kn&&Ot(jt)},zt.addEventListener("click",this.listener,!1)},sn.prototype.onResize=function(){var It=this.gl,Ot=this,zt=[It.ARRAY_BUFFER_BINDING];yi(It,zt,function(jt){var mn=[],kn=jt.drawingBufferWidth/2,Yn=Math.max(screen.width,screen.height)*window.devicePixelRatio,xi=jt.drawingBufferWidth/Yn,zi=xi*window.devicePixelRatio,ti=ot*zi/2,bi=Vt*Wt*zi,cr=Vt*zi/2,Gr=(Vt*Wt-Vt)*zi;mn.push(kn-ti,bi),mn.push(kn-ti,jt.drawingBufferHeight),mn.push(kn+ti,bi),mn.push(kn+ti,jt.drawingBufferHeight),Ot.gearOffset=mn.length/2;function Ki($s,Ao){var Po=(90-$s)*Yt,mo=Math.cos(Po),fa=Math.sin(Po);mn.push(ht*mo*cr+kn,ht*fa*cr+cr),mn.push(Ao*mo*cr+kn,Ao*fa*cr+cr)}for(var As=0;As<=6;As++){var Ls=As*fn;Ki(Ls,gn),Ki(Ls+on,gn),Ki(Ls+an,Nt),Ki(Ls+(fn-an),Nt),Ki(Ls+(fn-on),gn)}Ot.gearVertexCount=mn.length/2-Ot.gearOffset,Ot.arrowOffset=mn.length/2;function ys($s,Ao){mn.push(Gr+$s,jt.drawingBufferHeight-Gr-Ao)}var ds=ti/Math.sin(45*Yt);ys(0,cr),ys(cr,0),ys(cr+ds,ds),ys(ds,cr+ds),ys(ds,cr-ds),ys(0,cr),ys(cr,cr*2),ys(cr+ds,cr*2-ds),ys(ds,cr-ds),ys(0,cr),ys(ds,cr-ti),ys(Vt*zi,cr-ti),ys(ds,cr+ti),ys(Vt*zi,cr+ti),Ot.arrowVertexCount=mn.length/2-Ot.arrowOffset,jt.bindBuffer(jt.ARRAY_BUFFER,Ot.vertexBuffer),jt.bufferData(jt.ARRAY_BUFFER,new Float32Array(mn),jt.STATIC_DRAW)})},sn.prototype.render=function(){var It=this.gl,Ot=this,zt=[It.CULL_FACE,It.DEPTH_TEST,It.BLEND,It.SCISSOR_TEST,It.STENCIL_TEST,It.COLOR_WRITEMASK,It.VIEWPORT,It.CURRENT_PROGRAM,It.ARRAY_BUFFER_BINDING];yi(It,zt,function(jt){jt.disable(jt.CULL_FACE),jt.disable(jt.DEPTH_TEST),jt.disable(jt.BLEND),jt.disable(jt.SCISSOR_TEST),jt.disable(jt.STENCIL_TEST),jt.colorMask(!0,!0,!0,!0),jt.viewport(0,0,jt.drawingBufferWidth,jt.drawingBufferHeight),Ot.renderNoState()})},sn.prototype.renderNoState=function(){var It=this.gl;It.useProgram(this.program),It.bindBuffer(It.ARRAY_BUFFER,this.vertexBuffer),It.enableVertexAttribArray(this.attribs.position),It.vertexAttribPointer(this.attribs.position,2,It.FLOAT,!1,8,0),It.uniform4f(this.uniforms.color,1,1,1,1),Vr(this.projMat,0,It.drawingBufferWidth,0,It.drawingBufferHeight,.1,1024),It.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),It.drawArrays(It.TRIANGLE_STRIP,0,4),It.drawArrays(It.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),It.drawArrays(It.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function yn(It){this.coefficients=It}yn.prototype.distortInverse=function(It){for(var Ot=0,zt=1,jt=It-this.distort(Ot);Math.abs(zt-Ot)>1e-4;){var mn=It-this.distort(zt),kn=zt-mn*((zt-Ot)/(mn-jt));Ot=zt,zt=kn,jt=mn}return zt},yn.prototype.distort=function(It){for(var Ot=It*It,zt=0,jt=0;jt<this.coefficients.length;jt++)zt=Ot*(zt+this.coefficients[jt]);return(zt+1)*It};var ni=Math.PI/180,ki=180/Math.PI,Hi=function(Ot,zt,jt){this.x=Ot||0,this.y=zt||0,this.z=jt||0};Hi.prototype={constructor:Hi,set:function(Ot,zt,jt){return this.x=Ot,this.y=zt,this.z=jt,this},copy:function(Ot){return this.x=Ot.x,this.y=Ot.y,this.z=Ot.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var Ot=this.length();if(Ot!==0){var zt=1/Ot;this.multiplyScalar(zt)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(Ot){this.x*=Ot,this.y*=Ot,this.z*=Ot},applyQuaternion:function(Ot){var zt=this.x,jt=this.y,mn=this.z,kn=Ot.x,Yn=Ot.y,xi=Ot.z,zi=Ot.w,ti=zi*zt+Yn*mn-xi*jt,bi=zi*jt+xi*zt-kn*mn,cr=zi*mn+kn*jt-Yn*zt,Gr=-kn*zt-Yn*jt-xi*mn;return this.x=ti*zi+Gr*-kn+bi*-xi-cr*-Yn,this.y=bi*zi+Gr*-Yn+cr*-kn-ti*-xi,this.z=cr*zi+Gr*-xi+ti*-Yn-bi*-kn,this},dot:function(Ot){return this.x*Ot.x+this.y*Ot.y+this.z*Ot.z},crossVectors:function(Ot,zt){var jt=Ot.x,mn=Ot.y,kn=Ot.z,Yn=zt.x,xi=zt.y,zi=zt.z;return this.x=mn*zi-kn*xi,this.y=kn*Yn-jt*zi,this.z=jt*xi-mn*Yn,this}};var ji=function(Ot,zt,jt,mn){this.x=Ot||0,this.y=zt||0,this.z=jt||0,this.w=mn!==void 0?mn:1};ji.prototype={constructor:ji,set:function(Ot,zt,jt,mn){return this.x=Ot,this.y=zt,this.z=jt,this.w=mn,this},copy:function(Ot){return this.x=Ot.x,this.y=Ot.y,this.z=Ot.z,this.w=Ot.w,this},setFromEulerXYZ:function(Ot,zt,jt){var mn=Math.cos(Ot/2),kn=Math.cos(zt/2),Yn=Math.cos(jt/2),xi=Math.sin(Ot/2),zi=Math.sin(zt/2),ti=Math.sin(jt/2);return this.x=xi*kn*Yn+mn*zi*ti,this.y=mn*zi*Yn-xi*kn*ti,this.z=mn*kn*ti+xi*zi*Yn,this.w=mn*kn*Yn-xi*zi*ti,this},setFromEulerYXZ:function(Ot,zt,jt){var mn=Math.cos(Ot/2),kn=Math.cos(zt/2),Yn=Math.cos(jt/2),xi=Math.sin(Ot/2),zi=Math.sin(zt/2),ti=Math.sin(jt/2);return this.x=xi*kn*Yn+mn*zi*ti,this.y=mn*zi*Yn-xi*kn*ti,this.z=mn*kn*ti-xi*zi*Yn,this.w=mn*kn*Yn+xi*zi*ti,this},setFromAxisAngle:function(Ot,zt){var jt=zt/2,mn=Math.sin(jt);return this.x=Ot.x*mn,this.y=Ot.y*mn,this.z=Ot.z*mn,this.w=Math.cos(jt),this},multiply:function(Ot){return this.multiplyQuaternions(this,Ot)},multiplyQuaternions:function(Ot,zt){var jt=Ot.x,mn=Ot.y,kn=Ot.z,Yn=Ot.w,xi=zt.x,zi=zt.y,ti=zt.z,bi=zt.w;return this.x=jt*bi+Yn*xi+mn*ti-kn*zi,this.y=mn*bi+Yn*zi+kn*xi-jt*ti,this.z=kn*bi+Yn*ti+jt*zi-mn*xi,this.w=Yn*bi-jt*xi-mn*zi-kn*ti,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var Ot=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return Ot===0?(this.x=0,this.y=0,this.z=0,this.w=1):(Ot=1/Ot,this.x=this.x*Ot,this.y=this.y*Ot,this.z=this.z*Ot,this.w=this.w*Ot),this},slerp:function(Ot,zt){if(zt===0)return this;if(zt===1)return this.copy(Ot);var jt=this.x,mn=this.y,kn=this.z,Yn=this.w,xi=Yn*Ot.w+jt*Ot.x+mn*Ot.y+kn*Ot.z;if(xi<0?(this.w=-Ot.w,this.x=-Ot.x,this.y=-Ot.y,this.z=-Ot.z,xi=-xi):this.copy(Ot),xi>=1)return this.w=Yn,this.x=jt,this.y=mn,this.z=kn,this;var zi=Math.acos(xi),ti=Math.sqrt(1-xi*xi);if(Math.abs(ti)<.001)return this.w=.5*(Yn+this.w),this.x=.5*(jt+this.x),this.y=.5*(mn+this.y),this.z=.5*(kn+this.z),this;var bi=Math.sin((1-zt)*zi)/ti,cr=Math.sin(zt*zi)/ti;return this.w=Yn*bi+this.w*cr,this.x=jt*bi+this.x*cr,this.y=mn*bi+this.y*cr,this.z=kn*bi+this.z*cr,this},setFromUnitVectors:function(){var It,Ot,zt=1e-6;return function(jt,mn){return It===void 0&&(It=new Hi),Ot=jt.dot(mn)+1,Ot<zt?(Ot=0,Math.abs(jt.x)>Math.abs(jt.z)?It.set(-jt.y,jt.x,0):It.set(0,-jt.z,jt.y)):It.crossVectors(jt,mn),this.x=It.x,this.y=It.y,this.z=It.z,this.w=Ot,this.normalize(),this}}()};function Xi(It){this.width=It.width||Nn(),this.height=It.height||Qn(),this.widthMeters=It.widthMeters,this.heightMeters=It.heightMeters,this.bevelMeters=It.bevelMeters}var Ws=new Xi({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),Jr=new Xi({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Ai={CardboardV1:new Qs({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Qs({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function js(It,Ot){this.viewer=Ai.CardboardV2,this.updateDeviceParams(It),this.distortion=new yn(this.viewer.distortionCoefficients);for(var zt=0;zt<Ot.length;zt++){var jt=Ot[zt];Ai[jt.id]=new Qs(jt)}}js.prototype.updateDeviceParams=function(It){this.device=this.determineDevice_(It)||this.device},js.prototype.getDevice=function(){return this.device},js.prototype.setViewer=function(It){this.viewer=It,this.distortion=new yn(this.viewer.distortionCoefficients)},js.prototype.determineDevice_=function(It){if(!It)return Bt()?(console.warn("Using fallback iOS device measurements."),Jr):(console.warn("Using fallback Android device measurements."),Ws);var Ot=.0254,zt=Ot/It.xdpi,jt=Ot/It.ydpi,mn=Nn(),kn=Qn();return new Xi({widthMeters:zt*mn,heightMeters:jt*kn,bevelMeters:It.bevelMm*.001})},js.prototype.getDistortedFieldOfViewLeftEye=function(){var It=this.viewer,Ot=this.device,zt=this.distortion,jt=It.screenLensDistance,mn=(Ot.widthMeters-It.interLensDistance)/2,kn=It.interLensDistance/2,Yn=It.baselineLensDistance-Ot.bevelMeters,xi=Ot.heightMeters-Yn,zi=ki*Math.atan(zt.distort(mn/jt)),ti=ki*Math.atan(zt.distort(kn/jt)),bi=ki*Math.atan(zt.distort(Yn/jt)),cr=ki*Math.atan(zt.distort(xi/jt));return{leftDegrees:Math.min(zi,It.fov),rightDegrees:Math.min(ti,It.fov),downDegrees:Math.min(bi,It.fov),upDegrees:Math.min(cr,It.fov)}},js.prototype.getLeftEyeVisibleTanAngles=function(){var It=this.viewer,Ot=this.device,zt=this.distortion,jt=Math.tan(-ni*It.fov),mn=Math.tan(ni*It.fov),kn=Math.tan(ni*It.fov),Yn=Math.tan(-ni*It.fov),xi=Ot.widthMeters/4,zi=Ot.heightMeters/2,ti=It.baselineLensDistance-Ot.bevelMeters-zi,bi=It.interLensDistance/2-xi,cr=-ti,Gr=It.screenLensDistance,Ki=zt.distort((bi-xi)/Gr),As=zt.distort((cr+zi)/Gr),Ls=zt.distort((bi+xi)/Gr),ys=zt.distort((cr-zi)/Gr),ds=new Float32Array(4);return ds[0]=Math.max(jt,Ki),ds[1]=Math.min(mn,As),ds[2]=Math.min(kn,Ls),ds[3]=Math.max(Yn,ys),ds},js.prototype.getLeftEyeNoLensTanAngles=function(){var It=this.viewer,Ot=this.device,zt=this.distortion,jt=new Float32Array(4),mn=zt.distortInverse(Math.tan(-ni*It.fov)),kn=zt.distortInverse(Math.tan(ni*It.fov)),Yn=zt.distortInverse(Math.tan(ni*It.fov)),xi=zt.distortInverse(Math.tan(-ni*It.fov)),zi=Ot.widthMeters/4,ti=Ot.heightMeters/2,bi=It.baselineLensDistance-Ot.bevelMeters-ti,cr=It.interLensDistance/2-zi,Gr=-bi,Ki=It.screenLensDistance,As=(cr-zi)/Ki,Ls=(Gr+ti)/Ki,ys=(cr+zi)/Ki,ds=(Gr-ti)/Ki;return jt[0]=Math.max(mn,As),jt[1]=Math.min(kn,Ls),jt[2]=Math.min(Yn,ys),jt[3]=Math.max(xi,ds),jt},js.prototype.getLeftEyeVisibleScreenRect=function(It){var Ot=this.viewer,zt=this.device,jt=Ot.screenLensDistance,mn=(zt.widthMeters-Ot.interLensDistance)/2,kn=Ot.baselineLensDistance-zt.bevelMeters,Yn=(It[0]*jt+mn)/zt.widthMeters,xi=(It[1]*jt+kn)/zt.heightMeters,zi=(It[2]*jt+mn)/zt.widthMeters,ti=(It[3]*jt+kn)/zt.heightMeters;return{x:Yn,y:ti,width:zi-Yn,height:xi-ti}},js.prototype.getFieldOfViewLeftEye=function(It){return It?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},js.prototype.getFieldOfViewRightEye=function(It){var Ot=this.getFieldOfViewLeftEye(It);return{leftDegrees:Ot.rightDegrees,rightDegrees:Ot.leftDegrees,upDegrees:Ot.upDegrees,downDegrees:Ot.downDegrees}},js.prototype.getUndistortedFieldOfViewLeftEye=function(){var It=this.getUndistortedParams_();return{leftDegrees:ki*Math.atan(It.outerDist),rightDegrees:ki*Math.atan(It.innerDist),downDegrees:ki*Math.atan(It.bottomDist),upDegrees:ki*Math.atan(It.topDist)}},js.prototype.getUndistortedViewportLeftEye=function(){var It=this.getUndistortedParams_(),Ot=this.viewer,zt=this.device,jt=Ot.screenLensDistance,mn=zt.widthMeters/jt,kn=zt.heightMeters/jt,Yn=zt.width/mn,xi=zt.height/kn,zi=Math.round((It.eyePosX-It.outerDist)*Yn),ti=Math.round((It.eyePosY-It.bottomDist)*xi);return{x:zi,y:ti,width:Math.round((It.eyePosX+It.innerDist)*Yn)-zi,height:Math.round((It.eyePosY+It.topDist)*xi)-ti}},js.prototype.getUndistortedParams_=function(){var It=this.viewer,Ot=this.device,zt=this.distortion,jt=It.screenLensDistance,mn=It.interLensDistance/2/jt,kn=Ot.widthMeters/jt,Yn=Ot.heightMeters/jt,xi=kn/2-mn,zi=(It.baselineLensDistance-Ot.bevelMeters)/jt,ti=It.fov,bi=zt.distortInverse(Math.tan(ni*ti)),cr=Math.min(xi,bi),Gr=Math.min(mn,bi),Ki=Math.min(zi,bi),As=Math.min(Yn-zi,bi);return{outerDist:cr,innerDist:Gr,topDist:As,bottomDist:Ki,eyePosX:xi,eyePosY:zi}};function Qs(It){this.id=It.id,this.label=It.label,this.fov=It.fov,this.interLensDistance=It.interLensDistance,this.baselineLensDistance=It.baselineLensDistance,this.screenLensDistance=It.screenLensDistance,this.distortionCoefficients=It.distortionCoefficients,this.inverseCoefficients=It.inverseCoefficients}js.Viewers=Ai;var Vo=1,Mo="2019-11-09T17:36:14Z",Ia=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Do={format:Vo,last_updated:Mo,devices:Ia};function Ca(It,Ot){if(this.dpdb=Do,this.recalculateDeviceParams_(),It){this.onDeviceParamsUpdated=Ot;var zt=new XMLHttpRequest,jt=this;zt.open("GET",It,!0),zt.addEventListener("load",function(){jt.loading=!1,zt.status>=200&&zt.status<=299?(jt.dpdb=JSON.parse(zt.response),jt.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),zt.send()}}Ca.prototype.getDeviceParams=function(){return this.deviceParams},Ca.prototype.recalculateDeviceParams_=function(){var It=this.calcDeviceParams_();It?(this.deviceParams=It,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Ca.prototype.calcDeviceParams_=function(){var It=this.dpdb;if(!It)return console.error("DPDB not available."),null;if(It.format!=1)return console.error("DPDB has unexpected format version."),null;if(!It.devices||!It.devices.length)return console.error("DPDB does not have a devices section."),null;var Ot=navigator.userAgent||navigator.vendor||window.opera,zt=Nn(),jt=Qn();if(!It.devices)return console.error("DPDB has no devices section."),null;for(var mn=0;mn<It.devices.length;mn++){var kn=It.devices[mn];if(!kn.rules){console.warn("Device["+mn+"] has no rules section.");continue}if(kn.type!="ios"&&kn.type!="android"){console.warn("Device["+mn+"] has invalid type.");continue}if(Bt()==(kn.type=="ios")){for(var Yn=!1,xi=0;xi<kn.rules.length;xi++){var zi=kn.rules[xi];if(this.ruleMatches_(zi,Ot,zt,jt)){Yn=!0;break}}if(Yn){var ti=kn.dpi[0]||kn.dpi,bi=kn.dpi[1]||kn.dpi;return new l0({xdpi:ti,ydpi:bi,bevelMm:kn.bw})}}}return console.warn("No DPDB device match."),null},Ca.prototype.ruleMatches_=function(It,Ot,zt,jt){if(!It.ua&&!It.res||(It.ua&&It.ua.substring(0,2)==="SM"&&(It.ua=It.ua.substring(0,7)),It.ua&&Ot.indexOf(It.ua)<0))return!1;if(It.res){if(!It.res[0]||!It.res[1])return!1;var mn=It.res[0],kn=It.res[1];if(Math.min(zt,jt)!=Math.min(mn,kn)||Math.max(zt,jt)!=Math.max(mn,kn))return!1}return!0};function l0(It){this.xdpi=It.xdpi,this.ydpi=It.ydpi,this.bevelMm=It.bevelMm}function Ra(It,Ot){this.set(It,Ot)}Ra.prototype.set=function(It,Ot){this.sample=It,this.timestampS=Ot},Ra.prototype.copy=function(It){this.set(It.sample,It.timestampS)};function ko(It,Ot){this.kFilter=It,this.isDebug=Ot,this.currentAccelMeasurement=new Ra,this.currentGyroMeasurement=new Ra,this.previousGyroMeasurement=new Ra,Bt()?this.filterQ=new ji(-1,0,0,1):this.filterQ=new ji(1,0,0,1),this.previousFilterQ=new ji,this.previousFilterQ.copy(this.filterQ),this.accelQ=new ji,this.isOrientationInitialized=!1,this.estimatedGravity=new Hi,this.measuredGravity=new Hi,this.gyroIntegralQ=new ji}ko.prototype.addAccelMeasurement=function(It,Ot){this.currentAccelMeasurement.set(It,Ot)},ko.prototype.addGyroMeasurement=function(It,Ot){this.currentGyroMeasurement.set(It,Ot);var zt=Ot-this.previousGyroMeasurement.timestampS;Cn(zt)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},ko.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var It=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,Ot=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,It);this.gyroIntegralQ.multiply(Ot),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(Ot);var zt=new ji;zt.copy(this.filterQ),zt.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(zt),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var jt=new ji;jt.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),jt.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",ki*rn(jt),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var mn=new ji;mn.copy(this.filterQ),mn.multiply(jt),this.filterQ.slerp(mn,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},ko.prototype.getOrientation=function(){return this.filterQ},ko.prototype.accelToQuaternion_=function(It){var Ot=new Hi;Ot.copy(It),Ot.normalize();var zt=new ji;return zt.setFromUnitVectors(new Hi(0,0,-1),Ot),zt.inverse(),zt},ko.prototype.gyroToQuaternionDelta_=function(It,Ot){var zt=new ji,jt=new Hi;return jt.copy(It),jt.normalize(),zt.setFromAxisAngle(jt,It.length()*Ot),zt};function Ts(It,Ot){this.predictionTimeS=It,this.isDebug=Ot,this.previousQ=new ji,this.previousTimestampS=null,this.deltaQ=new ji,this.outQ=new ji}Ts.prototype.getPrediction=function(It,Ot,zt){if(!this.previousTimestampS)return this.previousQ.copy(It),this.previousTimestampS=zt,It;var jt=new Hi;jt.copy(Ot),jt.normalize();var mn=Ot.length();if(mn<ni*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(ki*mn).toFixed(1)),this.outQ.copy(It),this.previousQ.copy(It),this.outQ;var kn=mn*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(jt,kn),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(It),this.previousTimestampS=zt,this.outQ};function ta(It,Ot,zt,jt){this.yawOnly=zt,this.accelerometer=new Hi,this.gyroscope=new Hi,this.filter=new ko(It,jt),this.posePredictor=new Ts(Ot,jt),this.isFirefoxAndroid=Ut(),this.isIOS=Bt();var mn=Tt();this.isDeviceMotionInRadians=!this.isIOS&&mn&&mn<66,this.isWithoutDeviceMotion=hn()||Xt(),this.filterToWorldQ=new ji,Bt()?this.filterToWorldQ.setFromAxisAngle(new Hi(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Hi(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new ji,this.worldToScreenQ=new ji,this.originalPoseAdjustQ=new ji,this.originalPoseAdjustQ.setFromAxisAngle(new Hi(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),An()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new ji,this.orientationOut_=new Float32Array(4),this.start()}ta.prototype.getPosition=function(){return null},ta.prototype.getOrientation=function(){var It=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var mn=new ji().setFromAxisAngle(new Hi(0,0,-1),0),kn=new ji;return window.orientation===-90?kn.setFromAxisAngle(new Hi(0,1,0),Math.PI/-2):kn.setFromAxisAngle(new Hi(0,1,0),Math.PI/2),mn.multiply(kn)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var mn=new ji;return mn.setFromAxisAngle(new Hi(1,0,0),-Math.PI/2),mn}(),It=this._deviceOrientationQ;var zt=new ji;return zt.copy(It),zt.multiply(this.deviceOrientationFilterToWorldQ),zt.multiply(this.resetQ),zt.multiply(this.worldToScreenQ),zt.multiplyQuaternions(this.deviceOrientationFixQ,zt),this.yawOnly&&(zt.x=0,zt.z=0,zt.normalize()),this.orientationOut_[0]=zt.x,this.orientationOut_[1]=zt.y,this.orientationOut_[2]=zt.z,this.orientationOut_[3]=zt.w,this.orientationOut_}else{var Ot=this.filter.getOrientation();It=this.posePredictor.getPrediction(Ot,this.gyroscope,this.previousTimestampS)}var zt=new ji;return zt.copy(this.filterToWorldQ),zt.multiply(this.resetQ),zt.multiply(It),zt.multiply(this.worldToScreenQ),this.yawOnly&&(zt.x=0,zt.z=0,zt.normalize()),this.orientationOut_[0]=zt.x,this.orientationOut_[1]=zt.y,this.orientationOut_[2]=zt.z,this.orientationOut_[3]=zt.w,this.orientationOut_},ta.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),An()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},ta.prototype.onDeviceOrientation_=function(It){this._deviceOrientationQ=this._deviceOrientationQ||new ji;var Ot=It.alpha,zt=It.beta,jt=It.gamma;Ot=(Ot||0)*Math.PI/180,zt=(zt||0)*Math.PI/180,jt=(jt||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(zt,Ot,-jt)},ta.prototype.onDeviceMotion_=function(It){this.updateDeviceMotion_(It)},ta.prototype.updateDeviceMotion_=function(It){var Ot=It.accelerationIncludingGravity,zt=It.rotationRate,jt=It.timeStamp/1e3,mn=jt-this.previousTimestampS;if(mn<0){Kn("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=jt;return}else if(mn<=Rt||mn>Mt){Kn("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=jt;return}this.accelerometer.set(-Ot.x,-Ot.y,-Ot.z),zt&&(nn()?this.gyroscope.set(-zt.beta,zt.alpha,zt.gamma):this.gyroscope.set(zt.alpha,zt.beta,zt.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,jt)),this.filter.addAccelMeasurement(this.accelerometer,jt),this.previousTimestampS=jt},ta.prototype.onOrientationChange_=function(It){this.setScreenTransform_()},ta.prototype.onMessage_=function(It){var Ot=It.data;if(!(!Ot||!Ot.type)){var zt=Ot.type.toLowerCase();zt==="devicemotion"&&this.updateDeviceMotion_(Ot.deviceMotionEvent)}},ta.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Hi(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Hi(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},ta.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),Bt()&&Br()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},ta.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var q0=60,dn=new Hi(1,0,0),qn=new Hi(0,0,1),di=new ji;di.setFromAxisAngle(dn,-Math.PI/2),di.multiply(new ji().setFromAxisAngle(qn,Math.PI/2));var $t=function(){function It(Ot){ze(this,It),this.config=Ot,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new ji,this._outQ=new ji,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return tt(It,[{key:"init",value:function(){var zt=null;try{zt=new RelativeOrientationSensor({frequency:q0,referenceFrame:"screen"}),zt.addEventListener("error",this._onSensorError)}catch(jt){this.errors.push(jt),jt.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):jt.name==="ReferenceError"?this.useDeviceMotion():console.error(jt)}zt&&(this.api="sensor",this.sensor=zt,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new ta(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var zt=this.sensor.quaternion;this._sensorQ.set(zt[0],zt[1],zt[2],zt[3]);var jt=this._outQ;return jt.copy(di),jt.multiply(this._sensorQ),this.config.YAW_ONLY&&(jt.x=jt.z=0,jt.normalize()),this._out[0]=jt.x,this._out[1]=jt.y,this._out[2]=jt.z,this._out[3]=jt.w,this._out}},{key:"_onSensorError",value:function(zt){this.errors.push(zt.error),zt.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):zt.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(zt.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),It}(),Jt="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function xn(){this.loadIcon_();var It=document.createElement("div"),Yn=It.style;Yn.position="fixed",Yn.top=0,Yn.right=0,Yn.bottom=0,Yn.left=0,Yn.backgroundColor="gray",Yn.fontFamily="sans-serif",Yn.zIndex=1e6;var Ot=document.createElement("img");Ot.src=this.icon;var Yn=Ot.style;Yn.marginLeft="25%",Yn.marginTop="25%",Yn.width="50%",It.appendChild(Ot);var zt=document.createElement("div"),Yn=zt.style;Yn.textAlign="center",Yn.fontSize="16px",Yn.lineHeight="24px",Yn.margin="24px 25%",Yn.width="50%",zt.innerHTML="Place your phone into your Cardboard viewer.",It.appendChild(zt);var jt=document.createElement("div"),Yn=jt.style;Yn.backgroundColor="#CFD8DC",Yn.position="fixed",Yn.bottom=0,Yn.width="100%",Yn.height="48px",Yn.padding="14px 24px",Yn.boxSizing="border-box",Yn.color="#656A6B",It.appendChild(jt);var mn=document.createElement("div");mn.style.float="left",mn.innerHTML="No Cardboard viewer?";var kn=document.createElement("a");kn.href="https://www.google.com/get/cardboard/get-cardboard/",kn.innerHTML="get one",kn.target="_blank";var Yn=kn.style;Yn.float="right",Yn.fontWeight=600,Yn.textTransform="uppercase",Yn.borderLeft="1px solid gray",Yn.paddingLeft="24px",Yn.textDecoration="none",Yn.color="#656A6B",jt.appendChild(mn),jt.appendChild(kn),this.overlay=It,this.text=zt,this.hide()}xn.prototype.show=function(It){!It&&!this.overlay.parentElement?document.body.appendChild(this.overlay):It&&(this.overlay.parentElement&&this.overlay.parentElement!=It&&this.overlay.parentElement.removeChild(this.overlay),It.appendChild(this.overlay)),this.overlay.style.display="block";var Ot=this.overlay.querySelector("img"),zt=Ot.style;An()?(zt.width="20%",zt.marginLeft="40%",zt.marginTop="3%"):(zt.width="50%",zt.marginLeft="25%",zt.marginTop="25%")},xn.prototype.hide=function(){this.overlay.style.display="none"},xn.prototype.showTemporarily=function(It,Ot){this.show(Ot),this.timer=setTimeout(this.hide.bind(this),It)},xn.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},xn.prototype.update=function(){this.disableShowTemporarily(),!An()&&Ir()?this.show():this.hide()},xn.prototype.loadIcon_=function(){this.icon=Gt("image/svg+xml",Jt)};var Vn="CardboardV1",Dn="WEBVR_CARDBOARD_VIEWER",jn="webvr-polyfill-viewer-selector";function gi(It){try{this.selectedKey=localStorage.getItem(Dn)}catch(Ot){console.error("Failed to load viewer profile: %s",Ot)}this.selectedKey||(this.selectedKey=It||Vn),this.dialog=this.createDialog_(js.Viewers),this.root=null,this.onChangeCallbacks_=[]}gi.prototype.show=function(It){this.root=It,It.appendChild(this.dialog);var Ot=this.dialog.querySelector("#"+this.selectedKey);Ot.checked=!0,this.dialog.style.display="block"},gi.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},gi.prototype.getCurrentViewer=function(){return js.Viewers[this.selectedKey]},gi.prototype.getSelectedKey_=function(){var It=this.dialog.querySelector("input[name=field]:checked");return It?It.id:null},gi.prototype.onChange=function(It){this.onChangeCallbacks_.push(It)},gi.prototype.fireOnChange_=function(It){for(var Ot=0;Ot<this.onChangeCallbacks_.length;Ot++)this.onChangeCallbacks_[Ot](It)},gi.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!js.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(js.Viewers[this.selectedKey]);try{localStorage.setItem(Dn,this.selectedKey)}catch(It){console.error("Failed to save viewer profile: %s",It)}this.hide()},gi.prototype.createDialog_=function(It){var Ot=document.createElement("div");Ot.classList.add(jn),Ot.style.display="none";var zt=document.createElement("div"),kn=zt.style;kn.position="fixed",kn.left=0,kn.top=0,kn.width="100%",kn.height="100%",kn.background="rgba(0, 0, 0, 0.3)",zt.addEventListener("click",this.hide.bind(this));var jt=280,mn=document.createElement("div"),kn=mn.style;kn.boxSizing="border-box",kn.position="fixed",kn.top="24px",kn.left="50%",kn.marginLeft=-280/2+"px",kn.width=jt+"px",kn.padding="24px",kn.overflow="hidden",kn.background="#fafafa",kn.fontFamily="'Roboto', sans-serif",kn.boxShadow="0px 5px 20px #666",mn.appendChild(this.createH1_("Select your viewer"));for(var Yn in It)mn.appendChild(this.createChoice_(Yn,It[Yn].label));return mn.appendChild(this.createButton_("Save",this.onSave_.bind(this))),Ot.appendChild(zt),Ot.appendChild(mn),Ot},gi.prototype.createH1_=function(It){var Ot=document.createElement("h1"),zt=Ot.style;return zt.color="black",zt.fontSize="20px",zt.fontWeight="bold",zt.marginTop=0,zt.marginBottom="24px",Ot.innerHTML=It,Ot},gi.prototype.createChoice_=function(It,Ot){var zt=document.createElement("div");zt.style.marginTop="8px",zt.style.color="black";var jt=document.createElement("input");jt.style.fontSize="30px",jt.setAttribute("id",It),jt.setAttribute("type","radio"),jt.setAttribute("value",It),jt.setAttribute("name","field");var mn=document.createElement("label");return mn.style.marginLeft="4px",mn.setAttribute("for",It),mn.innerHTML=Ot,zt.appendChild(jt),zt.appendChild(mn),zt},gi.prototype.createButton_=function(It,Ot){var zt=document.createElement("button");zt.innerHTML=It;var jt=zt.style;return jt.float="right",jt.textTransform="uppercase",jt.color="#1094f7",jt.fontSize="14px",jt.letterSpacing=0,jt.border=0,jt.background="none",jt.marginTop="16px",zt.addEventListener("click",Ot),zt};var Wi=typeof window<"u"?window:typeof se<"u"?se:typeof self<"u"?self:{};function Li(It){return It&&It.__esModule&&Object.prototype.hasOwnProperty.call(It,"default")?It.default:It}function vi(It,Ot){return Ot={exports:{}},It(Ot,Ot.exports),Ot.exports}var yr=vi(function(It,Ot){(function(jt,mn){It.exports=mn()})(Wi,function(){return function(zt){var jt={};function mn(kn){if(jt[kn])return jt[kn].exports;var Yn=jt[kn]={i:kn,l:!1,exports:{}};return zt[kn].call(Yn.exports,Yn,Yn.exports,mn),Yn.l=!0,Yn.exports}return mn.m=zt,mn.c=jt,mn.d=function(kn,Yn,xi){mn.o(kn,Yn)||Object.defineProperty(kn,Yn,{configurable:!1,enumerable:!0,get:xi})},mn.n=function(kn){var Yn=kn&&kn.__esModule?function(){return kn.default}:function(){return kn};return mn.d(Yn,"a",Yn),Yn},mn.o=function(kn,Yn){return Object.prototype.hasOwnProperty.call(kn,Yn)},mn.p="",mn(mn.s=0)}([function(zt,jt,mn){var kn=function(){function bi(cr,Gr){for(var Ki=0;Ki<Gr.length;Ki++){var As=Gr[Ki];As.enumerable=As.enumerable||!1,As.configurable=!0,"value"in As&&(As.writable=!0),Object.defineProperty(cr,As.key,As)}}return function(cr,Gr,Ki){return Gr&&bi(cr.prototype,Gr),Ki&&bi(cr,Ki),cr}}();function Yn(bi,cr){if(!(bi instanceof cr))throw new TypeError("Cannot call a class as a function")}var xi=mn(1),zi=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,ti=function(){function bi(){Yn(this,bi),zi?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",xi),this.noSleepVideo.addEventListener("timeupdate",(function(cr){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return kn(bi,[{key:"enable",value:function(){zi?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){zi?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),bi}();zt.exports=ti},function(zt,jt,mn){zt.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),Sr=Li(yr),Ur=1e3,hs=[0,0,.5,1],er=[.5,0,.5,1],as=window.requestAnimationFrame,Yr=window.cancelAnimationFrame;function eo(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function wo(It){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:It.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:It.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:It.canPresent},maxLayers:{writable:!1,enumerable:!0,value:It.maxLayers},hasOrientation:{enumerable:!0,get:function(){return ai("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),It.hasOrientation}}})}function Er(It){It=It||{};var Ot="wakelock"in It?It.wakelock:!0;this.isPolyfilled=!0,this.displayId=Ur++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return ai("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new wo({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,Ot&&Ir()&&(this.wakelock_=new Sr)}Er.prototype.getFrameData=function(It){return zr(It,this._getPose(),this)},Er.prototype.getPose=function(){return ai("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Er.prototype.resetPose=function(){return ai("VRDisplay.prototype.resetPose"),this._resetPose()},Er.prototype.getImmediatePose=function(){return ai("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Er.prototype.requestAnimationFrame=function(It){return as(It)},Er.prototype.cancelAnimationFrame=function(It){return Yr(It)},Er.prototype.wrapForFullscreen=function(It){if(Bt())return It;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var Ot=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",Ot.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==It)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=It,this.originalParent_=It.parentElement,this.originalParent_||document.body.appendChild(It),!this.fullscreenWrapper_.parentElement){var zt=this.fullscreenElement_.parentElement;zt.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),zt.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var jt=this;function mn(){if(jt.fullscreenElement_){var kn=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];jt.fullscreenElement_.setAttribute("style",kn.join("; ")+";")}}return mn(),this.fullscreenWrapper_},Er.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var It=this.fullscreenElement_;this.fullscreenElementCachedStyle_?It.setAttribute("style",this.fullscreenElementCachedStyle_):It.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var Ot=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(It),this.originalParent_===Ot?Ot.insertBefore(It,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(It),Ot.removeChild(this.fullscreenWrapper_),It}},Er.prototype.requestPresent=function(It){var Ot=this.isPresenting,zt=this;return It instanceof Array||(ai("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),It=[It]),new Promise(function(jt,mn){if(!zt.capabilities.canPresent){mn(new Error("VRDisplay is not capable of presenting."));return}if(It.length==0||It.length>zt.capabilities.maxLayers){mn(new Error("Invalid number of layers."));return}var kn=It[0];if(!kn.source){jt();return}var Yn=kn.leftBounds||hs,xi=kn.rightBounds||er;if(Ot){var zi=zt.layer_;zi.source!==kn.source&&(zi.source=kn.source);for(var ti=0;ti<4;ti++)zi.leftBounds[ti]=Yn[ti],zi.rightBounds[ti]=xi[ti];zt.wrapForFullscreen(zt.layer_.source),zt.updatePresent_(),jt();return}if(zt.layer_={predistorted:kn.predistorted,source:kn.source,leftBounds:Yn.slice(0),rightBounds:xi.slice(0)},zt.waitingForPresent_=!1,zt.layer_&&zt.layer_.source){var bi=zt.wrapForFullscreen(zt.layer_.source),cr=function(){var As=Qi();zt.isPresenting=bi===As,zt.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Ls){console.error("screen.orientation.lock() failed due to",Ls.message)}),zt.waitingForPresent_=!1,zt.beginPresent_(),jt()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),zt.removeFullscreenWrapper(),zt.disableWakeLock(),zt.endPresent_(),zt.removeFullscreenListeners_()),zt.fireVRDisplayPresentChange_()},Gr=function(){zt.waitingForPresent_&&(zt.removeFullscreenWrapper(),zt.removeFullscreenListeners_(),zt.disableWakeLock(),zt.waitingForPresent_=!1,zt.isPresenting=!1,mn(new Error("Unable to present.")))};zt.addFullscreenListeners_(bi,cr,Gr),fi(bi)?(zt.enableWakeLock(),zt.waitingForPresent_=!0):(Bt()||dt())&&(zt.enableWakeLock(),zt.isPresenting=!0,zt.beginPresent_(),zt.fireVRDisplayPresentChange_(),jt())}!zt.waitingForPresent_&&!Bt()&&(hi(),mn(new Error("Unable to present.")))})},Er.prototype.exitPresent=function(){var It=this.isPresenting,Ot=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(zt,jt){It?(!hi()&&Bt()&&(Ot.endPresent_(),Ot.fireVRDisplayPresentChange_()),dt()&&(Ot.removeFullscreenWrapper(),Ot.removeFullscreenListeners_(),Ot.endPresent_(),Ot.fireVRDisplayPresentChange_()),zt()):jt(new Error("Was not presenting to VRDisplay."))})},Er.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Er.prototype.fireVRDisplayPresentChange_=function(){var It=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(It)},Er.prototype.fireVRDisplayConnect_=function(){var It=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(It)},Er.prototype.addFullscreenListeners_=function(It,Ot,zt){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=It,this.fullscreenChangeHandler_=Ot,this.fullscreenErrorHandler_=zt,Ot&&(document.fullscreenEnabled?It.addEventListener("fullscreenchange",Ot,!1):document.webkitFullscreenEnabled?It.addEventListener("webkitfullscreenchange",Ot,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",Ot,!1):document.msFullscreenEnabled&&It.addEventListener("msfullscreenchange",Ot,!1)),zt&&(document.fullscreenEnabled?It.addEventListener("fullscreenerror",zt,!1):document.webkitFullscreenEnabled?It.addEventListener("webkitfullscreenerror",zt,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",zt,!1):document.msFullscreenEnabled&&It.addEventListener("msfullscreenerror",zt,!1))},Er.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var It=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var Ot=this.fullscreenChangeHandler_;It.removeEventListener("fullscreenchange",Ot,!1),It.removeEventListener("webkitfullscreenchange",Ot,!1),document.removeEventListener("mozfullscreenchange",Ot,!1),It.removeEventListener("msfullscreenchange",Ot,!1)}if(this.fullscreenErrorHandler_){var zt=this.fullscreenErrorHandler_;It.removeEventListener("fullscreenerror",zt,!1),It.removeEventListener("webkitfullscreenerror",zt,!1),document.removeEventListener("mozfullscreenerror",zt,!1),It.removeEventListener("msfullscreenerror",zt,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Er.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Er.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Er.prototype.beginPresent_=function(){},Er.prototype.endPresent_=function(){},Er.prototype.submitFrame=function(It){},Er.prototype.getEyeParameters=function(It){return null};var Ss={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},bs={LEFT:"left",RIGHT:"right"};function Ns(It){var Ot=Rr({},Ss);It=Rr(Ot,It||{}),Er.call(this,{wakelock:It.MOBILE_WAKE_LOCK}),this.config=It,this.displayName="Cardboard VRDisplay",this.capabilities=new wo({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new $t(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Ca(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new js(this.dpdb_.getDeviceParams(),It.ADDITIONAL_VIEWERS),this.viewerSelector_=new gi(It.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new xn),Bt()&&window.addEventListener("resize",this.onResize_.bind(this))}return Ns.prototype=Object.create(Er.prototype),Ns.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Ns.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Ns.prototype._getFieldOfView=function(It){var Ot;if(It==bs.LEFT)Ot=this.deviceInfo_.getFieldOfViewLeftEye();else if(It==bs.RIGHT)Ot=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",It),null;return Ot},Ns.prototype._getEyeOffset=function(It){var Ot;if(It==bs.LEFT)Ot=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(It==bs.RIGHT)Ot=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",It),null;return Ot},Ns.prototype.getEyeParameters=function(It){var Ot=this._getEyeOffset(It),zt=this._getFieldOfView(It),jt={offset:Ot,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(jt,"fieldOfView",{enumerable:!0,get:function(){return ai("VRFieldOfView","VRFrameData's projection matrices"),zt}}),jt},Ns.prototype.onDeviceParamsUpdated_=function(It){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(It),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Ns.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Ns.prototype.beginPresent_=function(){var It=this.layer_.source.getContext("webgl");It||(It=this.layer_.source.getContext("experimental-webgl")),It||(It=this.layer_.source.getContext("webgl2")),It&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(It.canvas.width=Nn()*this.bufferScale_,It.canvas.height=Qn()*this.bufferScale_,this.cardboardUI_=new sn(It)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new sn(It)),this.distorter_=new fr(It,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(Ot){this.viewerSelector_.show(this.layer_.source.parentElement),Ot.stopPropagation(),Ot.preventDefault()}).bind(this),(function(Ot){this.exitPresent(),Ot.stopPropagation(),Ot.preventDefault()}).bind(this)),this.rotateInstructions_&&(An()&&Ir()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Ns.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Ns.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Ns.prototype.submitFrame=function(It){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var Ot=this.layer_.source.getContext("webgl");Ot||(Ot=this.layer_.source.getContext("experimental-webgl")),Ot||(Ot=this.layer_.source.getContext("webgl2"));var zt=Ot.canvas;(zt.width!=this.lastWidth||zt.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=zt.width,this.lastHeight=zt.height,this.cardboardUI_.render()}},Ns.prototype.onOrientationChange_=function(It){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Ns.prototype.onResize_=function(It){if(this.layer_){var Ot=this.layer_.source.getContext("webgl");Ot||(Ot=this.layer_.source.getContext("experimental-webgl")),Ot||(Ot=this.layer_.source.getContext("webgl2"));var zt=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];Ot.canvas.setAttribute("style",zt.join("; ")+";"),ir(Ot.canvas)}},Ns.prototype.onViewerChanged_=function(It){this.deviceInfo_.setViewer(It),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Ns.prototype.fireVRDisplayDeviceParamsChange_=function(){var It=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(It)},Ns.VRFrameData=eo,Ns.VRDisplay=Er,Ns})}),xe=me(Le),Fe="0.10.12",Oe={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function Ne($e){this.config=Pe(Pe({},Oe),$e),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&Re())&&(this.enable(),this.getVRDisplays().then(function(st){st&&st[0]&&st[0].fireVRDisplayConnect_&&st[0].fireVRDisplayConnect_()}))}Ne.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(Re()){var $e=new xe({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push($e)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},Ne.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var $e=this.native.VRFrameData,st=new this.native.VRFrameData,ze=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(tt){if(tt instanceof $e){ze.call(this,tt);return}ze.call(this,st),tt.pose=st.pose,be(st.leftProjectionMatrix,tt.leftProjectionMatrix),be(st.rightProjectionMatrix,tt.rightProjectionMatrix),be(st.leftViewMatrix,tt.leftViewMatrix),be(st.rightViewMatrix,tt.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=xe.VRDisplay,window.VRFrameData=xe.VRFrameData},Ne.prototype.getVRDisplays=function(){var $e=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(st){return st.length>0?st:$e.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},Ne.version=Fe,Ne.VRFrameData=xe.VRFrameData,Ne.VRDisplay=xe.VRDisplay;var ke=Object.freeze({default:Ne}),Ve=ke&&Ne||ke;typeof se<"u"&&se.window&&(se.document||(se.document=se.window.document),se.navigator||(se.navigator=se.window.navigator));var Xe=Ve;return Xe})},"./node_modules/word-wrapper/index.js":pe=>{var Me=/\n/,ve=`
`,se=/\s/;pe.exports=function(Le,xe){var Fe=pe.exports.lines(Le,xe);return Fe.map(function(Oe){return Le.substring(Oe.start,Oe.end)}).join(`
`)},pe.exports.lines=function(xe,Fe){if(Fe=Fe||{},Fe.width===0&&Fe.mode!=="nowrap")return[];xe=xe||"";var Oe=typeof Fe.width=="number"?Fe.width:Number.MAX_VALUE,Ne=Math.max(0,Fe.start||0),ke=typeof Fe.end=="number"?Fe.end:xe.length,Ve=Fe.mode,Xe=Fe.measure||Pe;return Ve==="pre"?Re(Xe,xe,Ne,ke,Oe):be(Xe,xe,Ne,ke,Oe,Ve)};function me(Le,xe,Fe,Oe){var Ne=Le.indexOf(xe,Fe);return Ne===-1||Ne>Oe?Oe:Ne}function Te(Le){return se.test(Le)}function Re(Le,xe,Fe,Oe,Ne){for(var ke=[],Ve=Fe,Xe=Fe;Xe<Oe&&Xe<xe.length;Xe++){var $e=xe.charAt(Xe),st=Me.test($e);if(st||Xe===Oe-1){var ze=st?Xe:Xe+1,tt=Le(xe,Ve,ze,Ne);ke.push(tt),Ve=Xe+1}}return ke}function be(Le,xe,Fe,Oe,Ne,ke){var Ve=[],Xe=Ne;for(ke==="nowrap"&&(Xe=Number.MAX_VALUE);Fe<Oe&&Fe<xe.length;){for(var $e=me(xe,ve,Fe,Oe);Fe<$e&&Te(xe.charAt(Fe));)Fe++;var st=Le(xe,Fe,$e,Xe),ze=Fe+(st.end-st.start),tt=ze+ve.length;if(ze<$e){for(;ze>Fe&&!Te(xe.charAt(ze));)ze--;if(ze===Fe)tt>Fe+ve.length&&tt--,ze=tt;else for(tt=ze;ze>Fe&&Te(xe.charAt(ze-ve.length));)ze--}if(ze>=Fe){var ft=Le(xe,Fe,ze,Xe);Ve.push(ft)}Fe=tt}return Ve}function Pe(Le,xe,Fe,Oe){var Ne=Math.min(Oe,Fe-xe);return{start:xe,end:xe+Ne}}},"./node_modules/xhr/index.js":(pe,Me,ve)=>{var se=ve("./node_modules/global/window.js"),me=ve("./node_modules/is-function/index.js"),Te=ve("./node_modules/parse-headers/parse-headers.js"),Re=ve("./node_modules/xtend/immutable.js");pe.exports=xe,pe.exports.default=xe,xe.XMLHttpRequest=se.XMLHttpRequest||Ne,xe.XDomainRequest="withCredentials"in new xe.XMLHttpRequest?xe.XMLHttpRequest:se.XDomainRequest,be(["get","put","post","patch","head","delete"],function(ke){xe[ke==="delete"?"del":ke]=function(Ve,Xe,$e){return Xe=Le(Ve,Xe,$e),Xe.method=ke.toUpperCase(),Fe(Xe)}});function be(ke,Ve){for(var Xe=0;Xe<ke.length;Xe++)Ve(ke[Xe])}function Pe(ke){for(var Ve in ke)if(ke.hasOwnProperty(Ve))return!1;return!0}function Le(ke,Ve,Xe){var $e=ke;return me(Ve)?(Xe=Ve,typeof ke=="string"&&($e={uri:ke})):$e=Re(Ve,{uri:ke}),$e.callback=Xe,$e}function xe(ke,Ve,Xe){return Ve=Le(ke,Ve,Xe),Fe(Ve)}function Fe(ke){if(typeof ke.callback>"u")throw new Error("callback argument missing");var Ve=!1,Xe=function(nn,An,Cn){Ve||(Ve=!0,ke.callback(nn,An,Cn))};function $e(){ft.readyState===4&&setTimeout(tt,0)}function st(){var hn=void 0;if(ft.response?hn=ft.response:hn=ft.responseText||Oe(ft),Ut)try{hn=JSON.parse(hn)}catch{}return hn}function ze(hn){return clearTimeout(Tt),hn instanceof Error||(hn=new Error(""+(hn||"Unknown XMLHttpRequest Error"))),hn.statusCode=0,Xe(hn,Xt)}function tt(){if(!Mt){var hn;clearTimeout(Tt),ke.useXDR&&ft.status===void 0?hn=200:hn=ft.status===1223?204:ft.status;var nn=Xt,An=null;return hn!==0?(nn={body:st(),statusCode:hn,method:_t,headers:{},url:Gt,rawRequest:ft},ft.getAllResponseHeaders&&(nn.headers=Te(ft.getAllResponseHeaders()))):An=new Error("Internal XMLHttpRequest Error"),Xe(An,nn,nn.body)}}var ft=ke.xhr||null;ft||(ke.cors||ke.useXDR?ft=new xe.XDomainRequest:ft=new xe.XMLHttpRequest);var Rt,Mt,Gt=ft.url=ke.uri||ke.url,_t=ft.method=ke.method||"GET",Bt=ke.body||ke.data,dt=ft.headers=ke.headers||{},ut=!!ke.sync,Ut=!1,Tt,Xt={body:void 0,headers:{},statusCode:0,method:_t,url:Gt,rawRequest:ft};if("json"in ke&&ke.json!==!1&&(Ut=!0,dt.accept||dt.Accept||(dt.Accept="application/json"),_t!=="GET"&&_t!=="HEAD"&&(dt["content-type"]||dt["Content-Type"]||(dt["Content-Type"]="application/json"),Bt=JSON.stringify(ke.json===!0?Bt:ke.json))),ft.onreadystatechange=$e,ft.onload=tt,ft.onerror=ze,ft.onprogress=function(){},ft.onabort=function(){Mt=!0},ft.ontimeout=ze,ft.open(_t,Gt,!ut,ke.username,ke.password),ut||(ft.withCredentials=!!ke.withCredentials),!ut&&ke.timeout>0&&(Tt=setTimeout(function(){if(!Mt){Mt=!0,ft.abort("timeout");var hn=new Error("XMLHttpRequest timeout");hn.code="ETIMEDOUT",ze(hn)}},ke.timeout)),ft.setRequestHeader)for(Rt in dt)dt.hasOwnProperty(Rt)&&ft.setRequestHeader(Rt,dt[Rt]);else if(ke.headers&&!Pe(ke.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in ke&&(ft.responseType=ke.responseType),"beforeSend"in ke&&typeof ke.beforeSend=="function"&&ke.beforeSend(ft),ft.send(Bt||null),ft}function Oe(ke){try{if(ke.responseType==="document")return ke.responseXML;var Ve=ke.responseXML&&ke.responseXML.documentElement.nodeName==="parsererror";if(ke.responseType===""&&!Ve)return ke.responseXML}catch{}return null}function Ne(){}},"./node_modules/xml-parse-from-string/index.js":pe=>{pe.exports=function(){return typeof self.DOMParser<"u"?function(ve){var se=new self.DOMParser;return se.parseFromString(ve,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(ve){var se=new self.ActiveXObject("Microsoft.XMLDOM");return se.async="false",se.loadXML(ve),se}:function(ve){var se=document.createElement("div");return se.innerHTML=ve,se}}()},"./node_modules/xtend/immutable.js":pe=>{pe.exports=ve;var Me=Object.prototype.hasOwnProperty;function ve(){for(var se={},me=0;me<arguments.length;me++){var Te=arguments[me];for(var Re in Te)Me.call(Te,Re)&&(se[Re]=Te[Re])}return se}},"./src/components/anchored.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/index.js"),Te=me.debug("components:anchored:warn");pe.exports.Component=se("anchored",{schema:{persistent:{default:!1}},init:function(){var be=this.el.sceneEl,Pe=be.getAttribute("webxr"),Le=Pe.optionalFeatures;Le.indexOf("anchors")===-1&&(Le.push("anchors"),this.el.sceneEl.setAttribute("webxr",Pe)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var be=this.el.sceneEl,Pe=be.renderer.xr,Le,xe,Fe,Oe=this.el.object3D;!be.is("ar-mode")&&!be.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(Le=be.frame,xe=Pe.getReferenceSpace(),Fe=Le.getPose(this.anchor.anchorSpace,xe),Oe.matrix.elements=Fe.transform.matrix,Oe.matrix.decompose(Oe.position,Oe.rotation,Oe.scale)))},createAnchor:async function(Pe,Le){var xe=this.el.sceneEl,Fe=xe.renderer.xr,Oe,Ne,ke,Ve,Xe=this.el.object3D;if(Pe=Pe||Xe.position,Le=Le||this.auxQuaternion.setFromEuler(Xe.rotation),!Re(xe)){Te("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),Oe=xe.frame,Ne=Fe.getReferenceSpace(),ke=new XRRigidTransform({x:Pe.x,y:Pe.y,z:Pe.z},{x:Le.x,y:Le.y,z:Le.z,w:Le.w}),this.requestAnchorPending=!1,Ve=await Oe.createAnchor(ke,Ne),this.data.persistent&&(this.el.id?(this.persistentHandle=await Ve.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):Te("The anchor won't be persisted because the entity has no assigned id.")),xe.object3D.attach(this.el.object3D),this.anchor=Ve},restorePersistentAnchor:async function(){var Pe=this.el.sceneEl.renderer.xr,Le=Pe.getSession(),xe=Le.persistentAnchors,Fe;if(this.requestPersistentAnchorPending=!1,!this.el.id){Te("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(xe){Fe=localStorage.getItem(this.el.id);for(var Oe=0;Oe<xe.length;++Oe)if(Fe===xe[Oe]){this.anchor=await Le.restorePersistentAnchor(xe[Oe]),this.anchor&&(this.persistentHandle=xe[Oe]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var be,Pe,Le=this.anchor;Le&&(be=this.el.sceneEl.renderer.xr,Pe=be.getSession(),Le.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&Pe.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function Re(be){var Pe=be.renderer.xr,Le=Pe.getSession();return Le&&Le.restorePersistentAnchor}},"./src/components/animation.js":(pe,Me,ve)=>{var se=ve("./node_modules/super-animejs/lib/anime.es.js").default,me=ve("./src/core/component.js").components,Te=ve("./src/core/component.js").registerComponent,Re=ve("./src/lib/three.js"),be=ve("./src/utils/index.js"),Pe=new Re.Color,Le=new Re.Color,xe=be.entity.getComponentProperty,Fe=be.entity.setComponentProperty,Oe={},Ne="color",ke="position",Ve="rotation",Xe="scale",$e="components",st="object3D";pe.exports.Component=Te("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(dt){return dt===!0||dt==="true"?!0:dt===!1||dt==="false"?!1:parseInt(dt,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var dt=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){dt.animationIsPlaying=!1,dt.el.emit("animationcomplete",dt.eventDetail,!1),dt.id&&dt.el.emit("animationcomplete__"+dt.id,dt.eventDetail,!1)}}},update:function(dt){var ut=this.config,Ut=this.data;this.animationIsPlaying=!1,this.data.enabled&&Ut.property&&(ut.autoplay=!1,ut.direction=Ut.dir,ut.duration=Ut.dur,ut.easing=Ut.easing,ut.elasticity=Ut.elasticity,ut.loop=Ut.loop,ut.round=Ut.round,this.createAndStartAnimation())},tick:function(dt,ut){this.animationIsPlaying&&(this.time+=ut,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var dt=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=se(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!dt.autoplay||dt.startEvents&&dt.startEvents.length)){if(dt.delay){setTimeout(this.beginAnimation,dt.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=se(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var dt=this.config,ut=this.data,Ut=this.el,Tt,Xt,hn;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){Tt=ut.from===""?Mt(Ut,ut.property):ut.from,hn=ut.to,this.setColorConfig(Tt,hn),Tt=this.fromColor,hn=this.toColor,this.targetsArray.length=0,this.targetsArray.push(Tt),dt.targets=this.targetsArray;for(Xt in hn)dt[Xt]=hn[Xt];dt.update=function(){var nn={};return function(An){var Cn;Cn=An.animatables[0].target,!(Cn.r===nn.r&&Cn.g===nn.g&&Cn.b===nn.b)&&Gt(Ut,ut.property,Cn,ut.type)}}()}},updateConfigForDefault:function(){var dt=this.config,ut=this.data,Ut=this.el,Tt,Xt,hn,nn;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(ut.from===""?Tt=Bt(ut)?Mt(Ut,ut.property):xe(Ut,ut.property):Tt=ut.from,nn=ut.to,hn=!isNaN(Tt||nn),hn?(Tt=parseFloat(Tt),nn=parseFloat(nn)):(Tt=Tt&&Tt.toString(),nn=nn&&nn.toString()),Xt=ut.to==="true"||ut.to==="false"||ut.to===!0||ut.to===!1,Xt&&(Tt=ut.from==="true"||ut.from===!0?1:0,nn=ut.to==="true"||ut.to===!0?1:0),this.targets.aframeProperty=Tt,dt.targets=this.targets,dt.aframeProperty=nn,dt.update=function(){var An;return function(Cn){var Nn;Nn=Cn.animatables[0].target.aframeProperty,Nn!==An&&(An=Nn,Xt&&(Nn=Nn>=1),Bt(ut)?Gt(Ut,ut.property,Nn,ut.type):Fe(Ut,ut.property,Nn))}}())},updateConfigForVector:function(){var dt=this.config,ut=this.data,Ut=this.el,Tt,Xt,hn;Xt=ut.from!==""?be.coordinates.parse(ut.from):xe(Ut,ut.property),hn=be.coordinates.parse(ut.to),ut.property===Ve&&(tt(Xt),tt(hn)),this.targetsArray.length=0,this.targetsArray.push(Xt),dt.targets=this.targetsArray;for(Tt in hn)dt[Tt]=hn[Tt];if(ut.property===ke||ut.property===Ve||ut.property===Xe){dt.update=function(){var nn={};return function(An){var Cn=An.animatables[0].target;Cn.x===nn.x&&Cn.y===nn.y&&Cn.z===nn.z||(nn.x=Cn.x,nn.y=Cn.y,nn.z=Cn.z,Ut.object3D[ut.property].set(Cn.x,Cn.y,Cn.z))}}();return}dt.update=function(){var nn={};return function(An){var Cn=An.animatables[0].target;Cn.x===nn.x&&Cn.y===nn.y&&Cn.z===nn.z||(nn.x=Cn.x,nn.y=Cn.y,nn.z=Cn.z,Fe(Ut,ut.property,Cn))}}()},updateConfig:function(){var dt;dt=ze(this.el,this.data.property),Bt(this.data)&&this.data.type===Ne?this.updateConfigForRawColor():dt==="vec2"||dt==="vec3"||dt==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(dt){var ut,Ut=this.data,Tt=this.el,Xt=this;return Ut.from!==""||!Ut.property.startsWith($e)||(ut=_t(Ut.property)[1],Tt.components[ut])?!1:(Tt.addEventListener("componentinitialized",function hn(nn){nn.detail.name===ut&&(dt(),Xt.animation=se(Xt.config),Tt.removeEventListener("componentinitialized",hn))}),!0)},stopRelatedAnimations:function(){var dt,ut;for(ut in this.el.components)dt=this.el.components[ut],ut!==this.attrName&&dt.name==="animation"&&dt.animationIsPlaying&&dt.data.property===this.data.property&&(dt.animationIsPlaying=!1)},addEventListeners:function(){var dt=this.data,ut=this.el;ft(ut,dt.startEvents,this.onStartEvent),ft(ut,dt.pauseEvents,this.pauseAnimation),ft(ut,dt.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var dt=this.data,ut=this.el;Rt(ut,dt.startEvents,this.onStartEvent),Rt(ut,dt.pauseEvents,this.pauseAnimation),Rt(ut,dt.resumeEvents,this.resumeAnimation)},setColorConfig:function(dt,ut){Pe.set(dt),Le.set(ut),dt=this.fromColor,ut=this.toColor,dt.r=Pe.r,dt.g=Pe.g,dt.b=Pe.b,ut.r=Le.r,ut.g=Le.g,ut.b=Le.b}});function ze(dt,ut){var Ut,Tt,Xt,hn;return Xt=ut.split("."),Tt=Xt[0],hn=Xt[1],Ut=dt.components[Tt]||me[Tt],!Ut||hn&&!Ut.schema[hn]?null:hn?Ut.schema[hn].type:Ut.schema.type}function tt(dt){dt.x=Re.MathUtils.degToRad(dt.x),dt.y=Re.MathUtils.degToRad(dt.y),dt.z=Re.MathUtils.degToRad(dt.z)}function ft(dt,ut,Ut){var Tt;for(Tt=0;Tt<ut.length;Tt++)dt.addEventListener(ut[Tt],Ut)}function Rt(dt,ut,Ut){var Tt;for(Tt=0;Tt<ut.length;Tt++)dt.removeEventListener(ut[Tt],Ut)}function Mt(dt,ut){var Ut,Tt,Xt;for(Tt=_t(ut),Xt=dt,Ut=0;Ut<Tt.length;Ut++)Xt=Xt[Tt[Ut]];if(Xt===void 0)throw console.log(dt),new Error("[animation] property ("+ut+") could not be found");return Xt}function Gt(dt,ut,Ut,Tt){var Xt,hn,nn,An;for(ut.startsWith("object3D.rotation")&&(Ut=Re.MathUtils.degToRad(Ut)),hn=_t(ut),An=dt,Xt=0;Xt<hn.length-1;Xt++)An=An[hn[Xt]];if(nn=hn[hn.length-1],Tt===Ne){"r"in An[nn]?(An[nn].r=Ut.r,An[nn].g=Ut.g,An[nn].b=Ut.b):(An[nn].x=Ut.r,An[nn].y=Ut.g,An[nn].z=Ut.b);return}An[nn]=Ut}function _t(dt){return dt in Oe||(Oe[dt]=dt.split(".")),Oe[dt]}function Bt(dt){return dt.isRawProperty||dt.property.startsWith($e)||dt.property.startsWith(st)}},"./src/components/camera.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js");pe.exports.Component=se("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var Te,Re=this.el;Te=this.camera=new me.PerspectiveCamera,Re.setObject3D("camera",Te)},update:function(Te){var Re=this.data,be=this.camera;be.aspect=Re.aspect||window.innerWidth/window.innerHeight,be.far=Re.far,be.fov=Re.fov,be.near=Re.near,be.zoom=Re.zoom,be.updateProjectionMatrix(),this.updateActiveCamera(Te),this.updateSpectatorCamera(Te)},updateActiveCamera:function(Te){var Re=this.data,be=this.el,Pe=this.system;Te&&Te.active===Re.active||Re.spectator||(Re.active&&Pe.activeCameraEl!==be?Pe.setActiveCamera(be):!Re.active&&Pe.activeCameraEl===be&&Pe.disableActiveCamera())},updateSpectatorCamera:function(Te){var Re=this.data,be=this.el,Pe=this.system;Te&&Te.spectator===Re.spectator||(Re.spectator&&Pe.spectatorCameraEl!==be?Pe.setSpectatorCamera(be):!Re.spectator&&Pe.spectatorCameraEl===be&&Pe.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/index.js"),Te={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},Re={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},be={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},Pe={DOWN:["selectstart"],UP:["selectend"]},Le="a-mouse-cursor-hover";pe.exports.Component=se("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:me.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:!0,init:function(){var xe=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=me.debounce(function(){xe.canvasBounds=xe.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=this.onCursorDown.bind(this),this.onCursorUp=this.onCursorUp.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},update:function(xe){this.data.rayOrigin!==xe.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var xe=this.el.sceneEl.frame,Fe=this.activeXRInput;this.data.rayOrigin==="xrselect"&&xe&&Fe&&this.onMouseMove({frame:xe,inputSource:Fe,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var xe=this.el;xe.removeState(Re.HOVERING),xe.removeState(Re.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(Re.HOVERED),this.removeEventListeners()},addEventListeners:function(){var xe,Fe=this.data,Oe=this.el,Ne=this;function ke(){xe=Oe.sceneEl.canvas,!(Fe.downEvents.length||Fe.upEvents.length)&&(be.DOWN.forEach(function(Ve){xe.addEventListener(Ve,Ne.onCursorDown,{passive:!1})}),be.UP.forEach(function(Ve){xe.addEventListener(Ve,Ne.onCursorUp,{passive:!1})}))}xe=Oe.sceneEl.canvas,xe?ke():Oe.sceneEl.addEventListener("render-target-loaded",ke),Fe.downEvents.forEach(function(Ve){Oe.addEventListener(Ve,Ne.onCursorDown)}),Fe.upEvents.forEach(function(Ve){Oe.addEventListener(Ve,Ne.onCursorUp)}),Oe.addEventListener("raycaster-intersection",this.onIntersection),Oe.addEventListener("raycaster-closest-entity-changed",this.onIntersection),Oe.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),Oe.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),Oe.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var xe,Fe=this.data,Oe=this.el,Ne=this;xe=Oe.sceneEl.canvas,xe&&!Fe.downEvents.length&&!Fe.upEvents.length&&(be.DOWN.forEach(function(ke){xe.removeEventListener(ke,Ne.onCursorDown)}),be.UP.forEach(function(ke){xe.removeEventListener(ke,Ne.onCursorUp)})),Fe.downEvents.forEach(function(ke){Oe.removeEventListener(ke,Ne.onCursorDown)}),Fe.upEvents.forEach(function(ke){Oe.removeEventListener(ke,Ne.onCursorUp)}),Oe.removeEventListener("raycaster-intersection",this.onIntersection),Oe.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),xe.removeEventListener("mousemove",this.onMouseMove),xe.removeEventListener("touchstart",this.onMouseMove),xe.removeEventListener("touchmove",this.onMouseMove),Oe.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),Oe.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var xe,Fe=this.el;xe=Fe.sceneEl.canvas,xe.removeEventListener("mousemove",this.onMouseMove),xe.removeEventListener("touchmove",this.onMouseMove),Fe.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(xe.addEventListener("mousemove",this.onMouseMove),xe.addEventListener("touchmove",this.onMouseMove,{passive:!1}),Fe.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var xe=new THREE.Vector3,Fe=new THREE.Vector2,Oe=new THREE.Vector3,Ne={origin:Oe,direction:xe};return function(ke){var Ve=this.canvasBounds,Xe=this.el.sceneEl.camera,$e,st,ze,tt,ft,Rt,Mt,Gt;Xe.parent.updateMatrixWorld(),ke.type==="touchmove"||ke.type==="touchstart"?st=ke.touches.item(0):st=ke,$e=st.clientX-Ve.left,ze=st.clientY-Ve.top,Fe.x=$e/Ve.width*2-1,Fe.y=-(ze/Ve.height)*2+1,this.data.rayOrigin==="xrselect"&&(ke.type==="selectstart"||ke.type==="fakeselectevent")?(tt=ke.frame,ft=ke.inputSource,Rt=this.el.renderer.xr.getReferenceSpace(),Mt=tt.getPose(ft.targetRaySpace,Rt),Gt=Mt.transform,xe.set(0,0,-1),xe.applyQuaternion(Gt.orientation),Oe.copy(Gt.position)):ke.type==="fakeselectout"?(xe.set(0,1,0),Oe.set(0,9999,0)):Xe&&Xe.isPerspectiveCamera?(Oe.setFromMatrixPosition(Xe.matrixWorld),xe.set(Fe.x,Fe.y,.5).unproject(Xe).sub(Oe).normalize()):Xe&&Xe.isOrthographicCamera?(Oe.set(Fe.x,Fe.y,(Xe.near+Xe.far)/(Xe.near-Xe.far)).unproject(Xe),xe.set(0,0,-1).transformDirection(Xe.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+Xe.type),this.el.setAttribute("raycaster",Ne),ke.type==="touchmove"&&ke.preventDefault()}}(),onCursorDown:function(xe){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&xe.type==="touchstart"&&(this.onMouseMove(xe),this.el.components.raycaster.checkIntersections(),xe.preventDefault()),this.data.rayOrigin==="xrselect"&&xe.type==="selectstart"&&(this.activeXRInput=xe.inputSource,this.onMouseMove(xe),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(Te.MOUSEDOWN,xe),this.cursorDownEl=this.intersectedEl},onCursorUp:function(xe){if(this.isCursorDown){this.isCursorDown=!1;var Fe=this.data;this.twoWayEmit(Te.MOUSEUP,xe),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(Te.MOUSEUP,this.intersectedEventDetail)),(!Fe.fuse||Fe.rayOrigin==="mouse"||Fe.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(Te.CLICK,xe),Fe.rayOrigin==="xrselect"&&this.activeXRInput===xe.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,xe.type==="touchend"&&xe.preventDefault()}},onIntersection:function(xe){var Fe,Oe=this.el,Ne,ke,Ve;Ne=xe.detail.els[0]===Oe?1:0,Ve=xe.detail.intersections[Ne],ke=xe.detail.els[Ne],ke&&this.intersectedEl!==ke&&(this.intersectedEl&&(Fe=this.el.components.raycaster.getIntersection(this.intersectedEl),Fe&&Fe.distance<=Ve.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(ke,Ve)))},onIntersectionCleared:function(xe){var Fe=xe.detail.clearedEls;Fe.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var xe=this.el.sceneEl.xrSession,Fe=this;xe&&this.data.rayOrigin!=="mouse"&&(Pe.DOWN.forEach(function(Oe){xe.addEventListener(Oe,Fe.onCursorDown)}),Pe.UP.forEach(function(Oe){xe.addEventListener(Oe,Fe.onCursorUp)}))},setIntersection:function(xe,Fe){var Oe=this.el,Ne=this.data,ke=this;this.intersectedEl!==xe&&(this.intersectedEl=xe,Oe.addState(Re.HOVERING),xe.addState(Re.HOVERED),this.twoWayEmit(Te.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(Le),!(Ne.fuseTimeout===0||!Ne.fuse||Ne.rayOrigin==="xrselect"||Ne.rayOrigin==="mouse")&&(Oe.addState(Re.FUSING),this.twoWayEmit(Te.FUSING),this.fuseTimeout=setTimeout(function(){Oe.removeState(Re.FUSING),ke.twoWayEmit(Te.CLICK)},Ne.fuseTimeout)))},clearCurrentIntersection:function(xe){var Fe,Oe,Ne,ke=this.el;this.intersectedEl&&(this.intersectedEl.removeState(Re.HOVERED),ke.removeState(Re.HOVERING),ke.removeState(Re.FUSING),this.twoWayEmit(Te.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(Le),this.intersectedEl=null,clearTimeout(this.fuseTimeout),xe!==!0&&(Ne=this.el.components.raycaster.intersections,Ne.length!==0&&(Fe=Ne[0].object.el===ke?1:0,Oe=Ne[Fe],Oe&&this.setIntersection(Oe.object.el,Oe))))},twoWayEmit:function(xe,Fe){var Oe=this.el,Ne=this.intersectedEl,ke;function Ve(Xe,$e){Fe instanceof MouseEvent?Xe.mouseEvent=Fe:typeof TouchEvent<"u"&&Fe instanceof TouchEvent&&(Xe.touchEvent=Fe)}ke=this.el.components.raycaster.getIntersection(Ne),this.eventDetail.intersectedEl=Ne,this.eventDetail.intersection=ke,Ve(this.eventDetail),Oe.emit(xe,this.eventDetail),Ne&&(this.intersectedEventDetail.intersection=ke,Ve(this.intersectedEventDetail),Ne.emit(xe,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=me.checkControllerPresentAndSetup,Re=me.emitIfAxesChanged,be=me.onButtonEvent,Pe="generic",Le={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};pe.exports.Component=se("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},after:["tracked-controls"],mapping:Le,bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var xe=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(Fe){be(Fe.detail.id,"down",xe)},this.onButtonUp=function(Fe){be(Fe.detail.id,"up",xe)},this.onButtonTouchStart=function(Fe){be(Fe.detail.id,"touchstart",xe)},this.onButtonTouchEnd=function(Fe){be(Fe.detail.id,"touchend",xe)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(Fe){Fe.detail.name!==xe.name&&(xe.wasControllerConnected=!0,xe.removeEventListeners(),xe.removeControllersUpdateListener())})},addEventListeners:function(){var xe=this.el;xe.addEventListener("buttonchanged",this.onButtonChanged),xe.addEventListener("buttondown",this.onButtonDown),xe.addEventListener("buttonup",this.onButtonUp),xe.addEventListener("touchstart",this.onButtonTouchStart),xe.addEventListener("touchend",this.onButtonTouchEnd),xe.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var xe=this.el;xe.removeEventListener("buttonchanged",this.onButtonChanged),xe.removeEventListener("buttondown",this.onButtonDown),xe.removeEventListener("buttonup",this.onButtonUp),xe.removeEventListener("touchstart",this.onButtonTouchStart),xe.removeEventListener("touchend",this.onButtonTouchEnd),xe.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var xe=this.data,Fe=xe.hand?xe.hand:void 0;Te(this,Pe,{hand:Fe,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var xe=this.el,Fe=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}xe.setAttribute("tracked-controls",{hand:Fe.hand,idPrefix:Pe,orientationOffset:Fe.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(xe){var Fe=this.mapping.buttons[xe.detail.id];Fe&&this.el.emit(Fe+"changed",xe.detail.state)},onAxisMoved:function(xe){Re(this,this.mapping.axes,xe)},initDefaultModel:function(){var xe=this.modelEl=document.createElement("a-entity");xe.setAttribute("geometry",{primitive:"sphere",radius:.03}),xe.setAttribute("material",{color:this.data.color}),this.el.appendChild(xe),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").geometries,me=ve("./src/core/geometry.js").geometryNames,Te=ve("./src/core/component.js").registerComponent,Re=ve("./src/lib/three.js"),be=new Re.BufferGeometry;pe.exports.Component=Te("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:me,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(Pe){var Le=this.data,xe=this.el,Fe,Oe=this.system;this.geometry&&(Oe.unuseGeometry(Pe),this.geometry=null),this.geometry=Oe.getOrCreateGeometry(Le),Fe=xe.getObject3D("mesh"),Fe?Fe.geometry=this.geometry:(Fe=new Re.Mesh,Fe.geometry=this.geometry,this.el.getAttribute("material")||(Fe.material=new Re.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),xe.setObject3D("mesh",Fe))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=be,this.geometry=null},updateSchema:function(Pe){var Le=this.oldData&&this.oldData.primitive,xe=Pe.primitive,Fe=se[xe]&&se[xe].schema;if(!Fe)throw new Error("Unknown geometry schema `"+xe+"`");Le&&Le===xe||this.extendSchema(Fe)}})},"./src/components/gltf-model.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js"),Re=Te.debug("components:gltf-model:warn");pe.exports.Component=se("gltf-model",{schema:{type:"model"},init:function(){var be=this,Pe=this.system.getDRACOLoader(),Le=this.system.getMeshoptDecoder(),xe=this.system.getKTX2Loader();this.model=null,this.loader=new me.GLTFLoader,Pe&&this.loader.setDRACOLoader(Pe),Le?this.ready=Le.then(function(Fe){be.loader.setMeshoptDecoder(Fe)}):this.ready=Promise.resolve(),xe&&this.loader.setKTX2Loader(xe)},update:function(){var be=this,Pe=this.el,Le=this.data;Le&&(this.remove(),this.ready.then(function(){be.loader.load(Le,function(Fe){be.model=Fe.scene||Fe.scenes[0],be.model.animations=Fe.animations,Pe.setObject3D("mesh",be.model),Pe.emit("model-loaded",{format:"gltf",model:be.model})},void 0,function(Fe){var Oe=Fe&&Fe.message?Fe.message:"Failed to load glTF model";Re(Oe),Pe.emit("model-error",{format:"gltf",src:Le})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;se("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Te={toonLeft:me+"controllers/hands/leftHand.glb",toonRight:me+"controllers/hands/rightHand.glb",lowPolyLeft:me+"controllers/hands/leftHandLow.glb",lowPolyRight:me+"controllers/hands/rightHandLow.glb",highPolyLeft:me+"controllers/hands/leftHandHigh.glb",highPolyRight:me+"controllers/hands/rightHandHigh.glb"},Re={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},be={};be[Re.fist]="grip",be[Re.thumbUp]="pistol",be[Re.point]="pointing",pe.exports.Component=se("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var xe=this,Fe=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){xe.handleButton("grip","down")},this.onGripUp=function(){xe.handleButton("grip","up")},this.onTrackpadDown=function(){xe.handleButton("trackpad","down")},this.onTrackpadUp=function(){xe.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){xe.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){xe.handleButton("trackpad","touchend")},this.onTriggerDown=function(){xe.handleButton("trigger","down")},this.onTriggerUp=function(){xe.handleButton("trigger","up")},this.onTriggerTouchStart=function(){xe.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){xe.handleButton("trigger","touchend")},this.onGripTouchStart=function(){xe.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){xe.handleButton("grip","touchend")},this.onThumbstickDown=function(){xe.handleButton("thumbstick","down")},this.onThumbstickUp=function(){xe.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){xe.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){xe.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){xe.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){xe.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){xe.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){xe.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),Fe.addEventListener("controllerconnected",this.onControllerConnected),Fe.addEventListener("controllerdisconnected",this.onControllerDisconnected),Fe.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(xe,Fe){var Oe=this.el.getObject3D("mesh");!Oe||!Oe.mixer||Oe.mixer.update(Fe/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var xe=this.el;xe.addEventListener("gripdown",this.onGripDown),xe.addEventListener("gripup",this.onGripUp),xe.addEventListener("trackpaddown",this.onTrackpadDown),xe.addEventListener("trackpadup",this.onTrackpadUp),xe.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),xe.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),xe.addEventListener("triggerdown",this.onTriggerDown),xe.addEventListener("triggerup",this.onTriggerUp),xe.addEventListener("triggertouchstart",this.onTriggerTouchStart),xe.addEventListener("triggertouchend",this.onTriggerTouchEnd),xe.addEventListener("griptouchstart",this.onGripTouchStart),xe.addEventListener("griptouchend",this.onGripTouchEnd),xe.addEventListener("thumbstickdown",this.onThumbstickDown),xe.addEventListener("thumbstickup",this.onThumbstickUp),xe.addEventListener("abuttontouchstart",this.onAorXTouchStart),xe.addEventListener("abuttontouchend",this.onAorXTouchEnd),xe.addEventListener("bbuttontouchstart",this.onBorYTouchStart),xe.addEventListener("bbuttontouchend",this.onBorYTouchEnd),xe.addEventListener("xbuttontouchstart",this.onAorXTouchStart),xe.addEventListener("xbuttontouchend",this.onAorXTouchEnd),xe.addEventListener("ybuttontouchstart",this.onBorYTouchStart),xe.addEventListener("ybuttontouchend",this.onBorYTouchEnd),xe.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),xe.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var xe=this.el;xe.removeEventListener("gripdown",this.onGripDown),xe.removeEventListener("gripup",this.onGripUp),xe.removeEventListener("trackpaddown",this.onTrackpadDown),xe.removeEventListener("trackpadup",this.onTrackpadUp),xe.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),xe.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),xe.removeEventListener("triggerdown",this.onTriggerDown),xe.removeEventListener("triggerup",this.onTriggerUp),xe.removeEventListener("triggertouchstart",this.onTriggerTouchStart),xe.removeEventListener("triggertouchend",this.onTriggerTouchEnd),xe.removeEventListener("griptouchstart",this.onGripTouchStart),xe.removeEventListener("griptouchend",this.onGripTouchEnd),xe.removeEventListener("thumbstickdown",this.onThumbstickDown),xe.removeEventListener("thumbstickup",this.onThumbstickUp),xe.removeEventListener("abuttontouchstart",this.onAorXTouchStart),xe.removeEventListener("abuttontouchend",this.onAorXTouchEnd),xe.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),xe.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),xe.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),xe.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),xe.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),xe.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),xe.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),xe.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(xe){var Fe,Oe=this.el,Ne=this.data.hand,ke=this.data.handModelStyle,Ve=this.data.color,Xe=this;if(Fe={hand:Ne,model:!1},Ne!==xe){var $e=Te[ke+Ne.charAt(0).toUpperCase()+Ne.slice(1)];this.loader.load($e,function(st){var ze=st.scene.children[0],tt=Ne==="left"?Math.PI/2:-Math.PI/2,ft=Oe.sceneEl.hasWebXR?-Math.PI/2:0;ze.mixer=new THREE.AnimationMixer(ze),Xe.clips=st.animations,Oe.setObject3D("mesh",ze),ze.traverse(function(Rt){Rt.isMesh&&(Rt.material.color=new THREE.Color(Ve))}),ze.position.set(0,0,0),ze.rotation.set(ft,0,tt),Oe.setAttribute("magicleap-controls",Fe),Oe.setAttribute("vive-controls",Fe),Oe.setAttribute("oculus-touch-controls",Fe),Oe.setAttribute("pico-controls",Fe),Oe.setAttribute("windows-motion-controls",Fe),Oe.setAttribute("hp-mixed-reality-controls",Fe)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(xe,Fe){var Oe,Ne=Fe==="down",ke=Fe==="touchstart";if(Fe.indexOf("touch")===0){if(ke===this.touchedButtons[xe])return;this.touchedButtons[xe]=ke}else{if(Ne===this.pressedButtons[xe])return;this.pressedButtons[xe]=Ne}Oe=this.gesture,this.gesture=this.determineGesture(),this.gesture!==Oe&&(this.animateGesture(this.gesture,Oe),this.emitGestureEvents(this.gesture,Oe))},determineGesture:function(){var xe,Fe=this.pressedButtons.grip,Oe=this.pressedButtons.surface||this.touchedButtons.surface,Ne=this.pressedButtons.trackpad||this.touchedButtons.trackpad,ke=this.pressedButtons.trigger||this.touchedButtons.trigger,Ve=this.touchedButtons.AorX||this.touchedButtons.BorY,Xe=Le(this.el.components["tracked-controls"]);return Xe?Fe||ke?xe=Re.fist:Ne&&(xe=Re.point):Fe?Oe||Ve||Ne?xe=ke?Re.fist:Re.point:xe=ke?Re.thumbUp:Re.pointThumb:ke&&(xe=Re.hold),xe},getClip:function(xe){var Fe,Oe;for(Oe=0;Oe<this.clips.length;Oe++)if(Fe=this.clips[Oe],Fe.name===xe)return Fe},animateGesture:function(xe,Fe){if(xe){this.playAnimation(xe||Re.open,Fe,!1);return}this.playAnimation(Fe,Fe,!0)},emitGestureEvents:function(xe,Fe){var Oe=this.el,Ne;Fe!==xe&&(Ne=Pe(Fe,!1),Ne&&Oe.emit(Ne),Ne=Pe(xe,!0),Ne&&Oe.emit(Ne))},playAnimation:function(xe,Fe,Oe){var Ne,ke,Ve=this.el.getObject3D("mesh"),Xe;if(Ve){if(Ne=this.getClip(xe),Xe=Ve.mixer.clipAction(Ne),Oe){Xe.paused=!1,Xe.timeScale=-1;return}if(Xe.clampWhenFinished=!0,Xe.loop=THREE.LoopOnce,Xe.repetitions=0,Xe.timeScale=1,Xe.time=0,Xe.weight=1,!Fe){Ve.mixer.stopAllAction(),Xe.play();return}Ne=this.getClip(Fe),Xe.reset(),Xe.play(),ke=Ve.mixer.clipAction(Ne),ke.crossFadeTo(Xe,.15,!0)}}});function Pe(xe,Fe){var Oe;if(xe){if(Oe=be[xe],Oe==="grip")return Oe+(Fe?"close":"open");if(Oe==="point")return Oe+(Fe?"up":"down");if(Oe==="pointing"||Oe==="pistol")return Oe+(Fe?"start":"end")}}function Le(xe){var Fe=xe&&xe.controller,Oe=Fe&&(Fe.id&&Fe.id.indexOf("OpenVR ")===0||Fe.profiles&&Fe.profiles[0]&&Fe.profiles[0]==="htc-vive");return Oe}},"./src/components/hand-tracking-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/core/a-entity.js").AEntity,Te=ve("./src/utils/tracked-controls.js"),Re=Te.checkControllerPresentAndSetup,be=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Pe=be+"controllers/oculus-hands/v4/left.glb",Le=be+"controllers/oculus-hands/v4/right.glb",xe=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],Fe=0,Oe=4,Ne=9,ke=.015,Ve=.1;pe.exports.Component=se("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var Xe=0;Xe<this.jointEls.length;++Xe)this.jointEls[Xe].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var Xe=0;Xe<this.jointEls.length;++Xe)this.jointEls[Xe].object3D.visible=!1},init:function(){var Xe=this.el.sceneEl,$e=Xe.getAttribute("webxr"),st=$e.optionalFeatures;st.indexOf("hand-tracking")===-1&&(st.push("hand-tracking"),Xe.setAttribute("webxr",$e)),this.wristObject3D=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wristObject3D),this.onModelLoaded=this.onModelLoaded.bind(this),this.onChildAttached=this.onChildAttached.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*xe.length),this.jointRadii=new Float32Array(xe.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace),this.el.addEventListener("child-attached",this.onChildAttached),this.el.object3D.visible=!1,this.wristObject3D.visible=!1},onChildAttached:function(Xe){this.addChildEntity(Xe.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var Xe=this.jointEls,$e=this.skinnedMesh,st=this.data.modelOpacity!==1;$e&&(this.skinnedMesh.material.color.set(this.data.modelColor),this.skinnedMesh.material.transparent=st,this.skinnedMesh.material.opacity=this.data.modelOpacity);for(var ze=0;ze<Xe.length;ze++)Xe[ze].setAttribute("material",{color:this.data.modelColor,transparent:st,opacity:this.data.modelOpacity})},updateReferenceSpace:function(){var Xe=this,$e=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!$e){var st=Xe.el.sceneEl.systems.webxr.sessionReferenceSpaceType;$e.requestReferenceSpace(st).then(function(ze){Xe.referenceSpace=ze}).catch(function(ze){throw Xe.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(st,"tracked-controls-webxr uses reference space "+st),ze})}},checkIfControllerPresent:function(){var Xe=this.data,$e=Xe.hand?Xe.hand:void 0;Re(this,"",{hand:$e,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var Xe=this.el.sceneEl,$e=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,st=Xe.frame,ze=this.el.components["tracked-controls-webxr"],tt=this.referenceSpace;!$e||!st||!tt||!ze||(this.hasPoses=!1,$e.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=st.fillPoses($e.hand.values(),tt,this.jointPoses)&&st.fillJointRadii($e.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture(),this.updateWristObject()))},updateWristObject:function(){var Xe=new THREE.Matrix4;return function(){var $e=this.wristObject3D;!$e||!this.hasPoses||(Xe.fromArray(this.jointPoses,Fe*16),$e.position.setFromMatrixPosition(Xe),$e.quaternion.setFromRotationMatrix(Xe))}}(),updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(Xe){for(var $e=this.bones,st=0;st<$e.length;st++)if($e[st].name===Xe)return $e[st];return null},updateHandMeshModel:function(){var Xe=new THREE.Matrix4;return function(){var $e=0,st=this.jointPoses,ze=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!ze||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var tt of ze.hand.values()){var ft=this.getBone(tt.jointName);ft!=null&&(this.mesh.visible=!0,Xe.fromArray(st,$e*16),ft.position.setFromMatrixPosition(Xe),ft.quaternion.setFromRotationMatrix(Xe)),$e++}}}(),updateHandDotsModel:function(){for(var Xe=this.jointPoses,$e=this.jointRadii,st=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,ze,tt,ft=0;ft<st.hand.size;ft++)ze=this.jointEls[ft],tt=ze.object3D,ze.object3D.visible=this.hasPoses,this.hasPoses&&(tt.matrix.fromArray(Xe,ft*16),tt.matrix.decompose(tt.position,tt.rotation,tt.scale),ze.setAttribute("scale",{x:$e[ft],y:$e[ft],z:$e[ft]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var Xe=new THREE.Vector3,$e=new THREE.Matrix4;return function(){var st=this.indexTipPosition,ze=this.pinchEventDetail;if(this.hasPoses){Xe.setFromMatrixPosition($e.fromArray(this.jointPoses,Oe*16)),st.setFromMatrixPosition($e.fromArray(this.jointPoses,Ne*16)),ze.wristRotation.setFromRotationMatrix($e.fromArray(this.jointPoses,Fe*16));var tt=st.distanceTo(Xe);tt<ke&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=tt,ze.position.copy(st).add(Xe).multiplyScalar(.5),this.el.emit("pinchstarted",ze)),tt>this.pinchDistance+this.pinchDistance*Ve&&this.isPinched===!0&&(this.isPinched=!1,ze.position.copy(st).add(Xe).multiplyScalar(.5),this.el.emit("pinchended",ze)),this.isPinched&&(ze.position.copy(st).add(Xe).multiplyScalar(.5),this.el.emit("pinchmoved",ze))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var Xe=this.el,$e=this.data;if(Xe.setAttribute("tracked-controls",{id:"",hand:$e.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==Xe.getObject3D("mesh")&&Xe.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var Xe=this.el,$e;this.checkIfControllerPresent(),$e=Xe.components["tracked-controls"]&&Xe.components["tracked-controls"].controller,this.mesh&&$e&&$e.hand&&$e.hand instanceof XRHand&&Xe.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var Xe=this.data;Xe.modelStyle==="dots"&&this.initDotsModel(),Xe.modelStyle==="mesh"&&this.initMeshHandModel(),this.el.object3D.visible=!0,this.wristObject3D.visible=!0},initDotsModel:function(){if(this.jointEls.length===0){for(var Xe=0;Xe<xe.length;++Xe){var $e=this.jointEl=document.createElement("a-entity");$e.setAttribute("geometry",{primitive:"sphere",radius:1}),$e.object3D.visible=!1,this.el.appendChild($e),this.jointEls.push($e)}this.updateModelMaterial()}},initMeshHandModel:function(){var Xe=this.data.hand==="left"?Pe:Le;this.el.setAttribute("gltf-model",Xe)},onModelLoaded:function(){var Xe=this.mesh=this.el.getObject3D("mesh").children[0],$e=this.skinnedMesh=Xe.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=$e.skeleton.bones,this.el.removeObject3D("mesh"),Xe.position.set(0,0,0),Xe.rotation.set(0,0,0),$e.frustumCulled=!1,$e.material=new THREE.MeshStandardMaterial,this.updateModelMaterial(),this.setupChildrenEntities(),this.el.setObject3D("mesh",Xe))},setupChildrenEntities:function(){for(var Xe=this.el.children,$e=0;$e<Xe.length;++$e)Xe[$e]instanceof me&&this.addChildEntity(Xe[$e])},addChildEntity:function(Xe){Xe instanceof me&&this.wristObject3D.add(Xe.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js");se("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var Te=this.el,Re=this.data,be;Re.hand==="right"?be="components.hand-tracking-controls.bones.3":be="components.hand-tracking-controls.bones.21",Te.setAttribute("hand-tracking-controls",{hand:Re.hand}),Te.setAttribute("obb-collider",{trackedObject3D:be,size:.04}),this.auxMatrix=new me.Matrix4,this.auxQuaternion=new me.Quaternion,this.auxQuaternion2=new me.Quaternion,this.auxVector=new me.Vector3,this.auxVector2=new me.Vector3,this.grabbingObjectPosition=new me.Vector3,this.grabbedObjectPosition=new me.Vector3,this.grabbedObjectPositionDelta=new me.Vector3,this.grabDeltaPosition=new me.Vector3,this.grabInitialRotation=new me.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var Te,Re=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),be=0;be<Re.length;++be)Te=Re[be].components["hand-tracking-grab-controls"],Te!==this&&this.grabbedEl&&this.grabbedEl===Te.grabbedEl&&Te.releaseGrabbedEntity();return!1},onCollisionStarted:function(Te){var Re=Te.detail.withEl;this.collidedEl||Re.getAttribute("grabbable")&&(this.collidedEl=Re,this.grabbingObject3D=Te.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(Te){this.collidedEl&&(this.pinchPosition=Te.detail.position,this.wristRotation=Te.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(Te){this.wristRotation=Te.detail.wristRotation},releaseGrabbedEntity:function(){var Te=this.grabbedEl;Te&&(Te.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,Te.object3D.matrixAutoUpdate=!0,Te.object3D.matrixWorldAutoUpdate=!0,Te.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),Te.object3D.position.copy(this.auxVector),Te.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:Te}),this.grabbedEl=void 0)},grab:function(){var Te=this.grabbedEl,Re;Re=Te.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(Re).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=Te.object3D.updateMatrixWorld,Te.object3D.updateMatrixWorld=function(){},Te.object3D.updateMatrixWorldChildren=function(be){for(var Pe=this.children,Le=0,xe=Pe.length;Le<xe;Le++){var Fe=Pe[Le];(Fe.matrixWorldAutoUpdate===!0||be===!0)&&Fe.updateMatrixWorld(!0)}},Te.object3D.matrixAutoUpdate=!1,Te.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:Te})},tock:function(){var Te=this.auxMatrix,Re=this.auxQuaternion,be=this.auxQuaternion2,Pe,Le=this.grabbedEl;Le&&(Pe=Le.object3D,Pe.getWorldQuaternion(be),Pe.matrixWorld.identity(),Te.identity(),Te.makeTranslation(this.pinchPosition),Pe.matrixWorld.multiply(Te),Te.identity(),Te.makeRotationFromQuaternion(Re.copy(this.wristRotation).multiply(this.grabInitialRotation)),Pe.matrixWorld.multiply(Te),Te.identity(),Te.makeTranslation(this.grabDeltaPosition),Pe.matrixWorld.multiply(Te),Te.identity(),Te.makeRotationFromQuaternion(be),Pe.matrixWorld.multiply(Te),Te.makeScale(Le.object3D.scale.x,Le.object3D.scale.y,Le.object3D.scale.z),Pe.matrixWorld.multiply(Te),Pe.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("hide-on-enter-ar",{init:function(){var me=this;this.el.sceneEl.addEventListener("enter-vr",function(){me.el.sceneEl.is("ar-mode")&&(me.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){me.el.object3D.visible=!0})}})},"./src/components/hide-on-enter-vr.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("hide-on-enter-vr",{init:function(){var me=this;this.el.sceneEl.addEventListener("enter-vr",function(){me.el.sceneEl.is("vr-mode")&&(me.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){me.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/tracked-controls.js"),Re=Te.checkControllerPresentAndSetup,be=Te.emitIfAxesChanged,Pe=Te.onButtonEvent,Le="hp-mixed-reality",xe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Fe=xe+"controllers/hp/mixed-reality/",Oe={x:0,y:0,z:.06},Ne={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},ke={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};pe.exports.Component=se("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:ke,init:function(){var Ve=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(Xe){Pe(Xe.detail.id,"down",Ve,Ve.data.hand)},this.onButtonUp=function(Xe){Pe(Xe.detail.id,"up",Ve,Ve.data.hand)},this.onButtonTouchEnd=function(Xe){Pe(Xe.detail.id,"touchend",Ve,Ve.data.hand)},this.onButtonTouchStart=function(Xe){Pe(Xe.detail.id,"touchstart",Ve,Ve.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var Ve=this.data;this.controllerIndex=Ve.hand==="right"?0:Ve.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var Ve=this.el;Ve.addEventListener("buttonchanged",this.onButtonChanged),Ve.addEventListener("buttondown",this.onButtonDown),Ve.addEventListener("buttonup",this.onButtonUp),Ve.addEventListener("touchstart",this.onButtonTouchStart),Ve.addEventListener("touchend",this.onButtonTouchEnd),Ve.addEventListener("axismove",this.onAxisMoved),Ve.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Ve=this.el;Ve.removeEventListener("buttonchanged",this.onButtonChanged),Ve.removeEventListener("buttondown",this.onButtonDown),Ve.removeEventListener("buttonup",this.onButtonUp),Ve.removeEventListener("touchstart",this.onButtonTouchStart),Ve.removeEventListener("touchend",this.onButtonTouchEnd),Ve.removeEventListener("axismove",this.onAxisMoved),Ve.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var Ve=this.data;Re(this,Le,{index:this.controllerIndex,hand:Ve.hand})},injectTrackedControls:function(){var Ve=this.el,Xe=this.data;Ve.setAttribute("tracked-controls",{idPrefix:Le,hand:Xe.hand,controller:this.controllerIndex,orientationOffset:Xe.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",Fe+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(Ve){var Xe=this.mapping[this.data.hand].buttons[Ve.detail.id],$e;Xe&&(Xe==="trigger"&&($e=Ve.detail.state.value,console.log("analog value of trigger press: "+$e)),this.el.emit(Xe+"changed",Ve.detail.state))},onModelLoaded:function(Ve){var Xe=Ve.detail.model;this.data.model&&(Xe.position.copy(Oe),Xe.rotation.copy(Ne),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new me.Vector3(0,0,0)}))},onAxisMoved:function(Ve){be(this,this.mapping.axes,Ve)}})},"./src/components/index.js":(pe,Me,ve)=>{ve("./src/components/animation.js"),ve("./src/components/anchored.js"),ve("./src/components/camera.js"),ve("./src/components/cursor.js"),ve("./src/components/geometry.js"),ve("./src/components/generic-tracked-controller-controls.js"),ve("./src/components/gltf-model.js"),ve("./src/components/grabbable.js"),ve("./src/components/hand-tracking-controls.js"),ve("./src/components/hand-tracking-grab-controls.js"),ve("./src/components/hand-controls.js"),ve("./src/components/hide-on-enter-ar.js"),ve("./src/components/hide-on-enter-vr.js"),ve("./src/components/hp-mixed-reality-controls.js"),ve("./src/components/layer.js"),ve("./src/components/laser-controls.js"),ve("./src/components/light.js"),ve("./src/components/line.js"),ve("./src/components/link.js"),ve("./src/components/look-controls.js"),ve("./src/components/magicleap-controls.js"),ve("./src/components/material.js"),ve("./src/components/obb-collider.js"),ve("./src/components/obj-model.js"),ve("./src/components/oculus-go-controls.js"),ve("./src/components/oculus-touch-controls.js"),ve("./src/components/pico-controls.js"),ve("./src/components/position.js"),ve("./src/components/raycaster.js"),ve("./src/components/rotation.js"),ve("./src/components/scale.js"),ve("./src/components/shadow.js"),ve("./src/components/sound.js"),ve("./src/components/text.js"),ve("./src/components/tracked-controls.js"),ve("./src/components/tracked-controls-webvr.js"),ve("./src/components/tracked-controls-webxr.js"),ve("./src/components/visible.js"),ve("./src/components/valve-index-controls.js"),ve("./src/components/vive-controls.js"),ve("./src/components/vive-focus-controls.js"),ve("./src/components/wasd-controls.js"),ve("./src/components/windows-motion-controls.js"),ve("./src/components/scene/ar-hit-test.js"),ve("./src/components/scene/background.js"),ve("./src/components/scene/debug.js"),ve("./src/components/scene/device-orientation-permission-ui.js"),ve("./src/components/scene/embedded.js"),ve("./src/components/scene/inspector.js"),ve("./src/components/scene/fog.js"),ve("./src/components/scene/keyboard-shortcuts.js"),ve("./src/components/scene/pool.js"),ve("./src/components/scene/real-world-meshing.js"),ve("./src/components/scene/reflection.js"),ve("./src/components/scene/screenshot.js"),ve("./src/components/scene/stats.js"),ve("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/index.js");se("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var Te=this.config,Re=this.data,be=this.el,Pe=this,Le={hand:Re.hand,model:Re.model};be.setAttribute("hp-mixed-reality-controls",Le),be.setAttribute("magicleap-controls",Le),be.setAttribute("oculus-go-controls",Le),be.setAttribute("oculus-touch-controls",Le),be.setAttribute("pico-controls",Le),be.setAttribute("valve-index-controls",Le),be.setAttribute("vive-controls",Le),be.setAttribute("vive-focus-controls",Le),be.setAttribute("windows-motion-controls",Le),be.setAttribute("generic-tracked-controller-controls",{hand:Le.hand}),be.addEventListener("controllerconnected",xe),be.addEventListener("controllerdisconnected",Fe),be.addEventListener("controllermodelready",function(Oe){xe(Oe),Pe.modelReady=!0});function xe(Oe){var Ne=Te[Oe.detail.name];if(Ne){var ke=me.extend({showLine:!0},Ne.raycaster||{});Oe.detail.rayOrigin&&(ke.origin=Oe.detail.rayOrigin.origin,ke.direction=Oe.detail.rayOrigin.direction,ke.showLine=!0),Oe.detail.rayOrigin||!Pe.modelReady?be.setAttribute("raycaster",ke):be.setAttribute("raycaster","showLine",!0),be.setAttribute("cursor",me.extend({fuse:!1},Ne.cursor))}}function Fe(Oe){var Ne=Te[Oe.detail.name];Ne&&be.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/index.js"),Te=me.debug("components:layer:warn");pe.exports.Component=se("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var be=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=be.createFramebuffer();var Pe=this.el.sceneEl.getAttribute("webxr"),Le=Pe.requiredFeatures;Le.indexOf("layers")===-1&&(Le.push("layers"),this.el.sceneEl.setAttribute("webxr",Pe)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(be){this.data.src!==be.src&&this.updateSrc()},updateSrc:function(){var be=this.data.type;if(this.texture=void 0,be==="quad"){this.loadQuadImage();return}if(be==="monocubemap"||be==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var be,Pe=this.xrGLFactory,Le=this.el.sceneEl.frame,xe=this.data.src,Fe=this.data.type;this.visibilityChanged=!1,this.layer&&(Fe!=="monocubemap"&&Fe!=="stereocubemap"||(xe.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,Fe==="monocubemap"?(be=Pe.getSubImage(this.layer,Le),this.loadCubeMapImage(be.colorTexture,xe,0)):(be=Pe.getSubImage(this.layer,Le,"left"),this.loadCubeMapImage(be.colorTexture,xe,0),be=Pe.getSubImage(this.layer,Le,"right"),this.loadCubeMapImage(be.colorTexture,xe,6))))},loadQuadImage:function(){var be=this.data.src,Pe=this;this.el.sceneEl.systems.material.loadTexture(be,{src:be},function(xe){Pe.el.sceneEl.renderer.initTexture(xe),Pe.texture=xe,be.tagName==="VIDEO"&&setTimeout(function(){Pe.textureIsVideo=!0},1e3),Pe.layer&&(Pe.layer.height=Pe.data.height/2||Pe.texture.image.height/1e3,Pe.layer.width=Pe.data.width/2||Pe.texture.image.width/1e3,Pe.needsRedraw=!0),Pe.updateQuadPanel()})},preGenerateCubeMapTextures:function(be,Pe){this.data.type==="monocubemap"?this.generateCubeMapTextures(be,0,Pe):(this.generateCubeMapTextures(be,0,Pe),this.generateCubeMapTextures(be,6,Pe))},generateCubeMapTextures:function(be,Pe,Le){for(var xe=this.data,Fe=this.cubeFaceSize,Oe=Math.min(be.width,be.height),Ne=[],ke,Ve,Xe=0;Xe<6;Xe++){var $e=document.createElement("CANVAS");$e.width=$e.height=Fe;var st=$e.getContext("2d");xe.rotateCubemap&&(Xe===2||Xe===3)&&(st.save(),st.translate(Fe,Fe),st.rotate(Math.PI)),st.drawImage(be,(Xe+Pe)*Oe,0,Oe,Oe,0,0,Fe,Fe),st.restore(),Le&&Le(),Ne.push($e)}return xe.rotateCubemap&&(ke=Ne[0],Ve=Ne[1],Ne[0]=Ve,Ne[1]=ke,ke=Ne[4],Ve=Ne[5],Ne[4]=Ve,Ne[5]=ke),Le&&Le(),Ne},loadCubeMapImage:function(be,Pe,Le){var xe=this.el.sceneEl.renderer.getContext(),Fe;xe.pixelStorei(xe.UNPACK_FLIP_Y_WEBGL,!1),xe.bindTexture(xe.TEXTURE_CUBE_MAP,be),!Pe.complete||this.loadingScreen?Fe=this.loadingScreenImages:Fe=this.generateCubeMapTextures(Pe,Le);var Oe=0;Fe.forEach(function(Ne,ke){xe.texSubImage2D(xe.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,0,0,xe.RGBA,xe.UNSIGNED_BYTE,Ne),Oe=xe.getError()}),Oe!==0&&console.log("renderingError, WebGL Error Code: "+Oe),xe.bindTexture(xe.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var be=this,Pe=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(Le){be.visibilityChanged=Le.session.visibilityState!=="hidden"},Pe==="quad"){this.initQuadLayer();return}if(Pe==="monocubemap"||Pe==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var be=this.el.sceneEl,Pe=be.renderer.getContext(),Le=this.xrGLFactory=new XRWebGLBinding(be.xrSession,Pe);this.texture&&(this.layer=Le.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),be.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var be=this.data.src,Pe=this.el.sceneEl,Le=Pe.renderer.getContext(),xe=Le.getParameter(Le.MAX_CUBE_MAP_TEXTURE_SIZE),Fe=this.cubeFaceSize=Math.min(xe,Math.min(be.width,be.height)),Oe=this.xrGLFactory=new XRWebGLBinding(Pe.xrSession,Le);this.layer=Oe.createCubeLayer({space:this.referenceSpace,viewPixelWidth:Fe,viewPixelHeight:Fe,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),Pe.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var be=this.cubeFaceSize,Pe=this.loadingScreenImages=[],Le=0;Le<6;Le++){var xe=document.createElement("CANVAS");xe.width=xe.height=be;var Fe=xe.getContext("2d");xe.width=xe.height=be,Fe.fillStyle="black",Fe.fillRect(0,0,be,be),Le!==2&&Le!==3&&(Fe.translate(be,0),Fe.scale(-1,1),Fe.fillStyle="white",Fe.font="30px Arial",Fe.fillText("Loading",be/2,be/2)),Pe.push(xe)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(be){this.layerEnabled=be,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var be=this.quadPanelEl;this.quadPanelEl||(be=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(be)),be.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),be.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var be=this.el.sceneEl,Pe=this.el.sceneEl.renderer.getContext(),Le=this.xrGLFactory.getSubImage(this.layer,be.frame),xe=be.renderer.properties.get(this.texture).__webglTexture,Fe=Pe.getParameter(Pe.FRAMEBUFFER_BINDING);Pe.viewport(Le.viewport.x,Le.viewport.y,Le.viewport.width,Le.viewport.height),Pe.bindFramebuffer(Pe.FRAMEBUFFER,this.frameBuffer),Pe.framebufferTexture2D(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,Pe.TEXTURE_2D,Le.colorTexture,0),Re(Pe,xe,Le,this.data.src),Pe.bindFramebuffer(Pe.FRAMEBUFFER,Fe)},updateTransform:function(){var be=this.el,Pe=this.position,Le=this.quaternion;be.object3D.updateMatrixWorld(),Pe.setFromMatrixPosition(be.object3D.matrixWorld),Le.setFromRotationMatrix(be.object3D.matrixWorld),this.layerEnabled||Pe.set(0,0,1e8),this.layer.transform=new XRRigidTransform(Pe,Le)},onEnterVR:function(){var be=this.el.sceneEl,Pe=be.xrSession;if(!be.hasWebXR||!XRWebGLBinding||!Pe){Te("The layer component requires WebXR and the layers API enabled");return}Pe.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(be){this.referenceSpace=be}});function Re(be,Pe,Le,xe){var Fe=be.createFramebuffer(),Oe=Le.viewport.x,Ne=Le.viewport.y,ke=Le.viewport.x+Le.viewport.width,Ve=Le.viewport.y+Le.viewport.height;xe.tagName==="VIDEO"&&(be.bindTexture(be.TEXTURE_2D,Pe),be.texSubImage2D(be.TEXTURE_2D,0,0,0,xe.width,xe.height,be.RGB,be.UNSIGNED_BYTE,xe)),be.bindFramebuffer(be.READ_FRAMEBUFFER,Fe),be.framebufferTexture2D(be.READ_FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_2D,Pe,0),be.readBuffer(be.COLOR_ATTACHMENT0),be.blitFramebuffer(0,0,xe.width,xe.height,Oe,Ne,ke,Ve,be.COLOR_BUFFER_BIT,be.NEAREST),be.bindFramebuffer(be.READ_FRAMEBUFFER,null),be.deleteFramebuffer(Fe)}},"./src/components/light.js":(pe,Me,ve)=>{var se=ve("./src/utils/index.js"),me=se.diff,Te=ve("./src/utils/debug.js"),Re=ve("./src/core/component.js").registerComponent,be=ve("./src/lib/three.js"),Pe=ve("./src/utils/math.js"),Le=be.MathUtils.degToRad,xe=Te("components:light:warn"),Fe=new be.CubeTextureLoader,Oe={};pe.exports.Component=Re("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var Ne=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(Ne)},update:function(Ne){var ke=this.data,Ve=me(ke,Ne),Xe=this.light,$e=this;if(Xe&&!("type"in Ve)){var st=!1;Object.keys(Ve).forEach(function(ze){var tt=ke[ze];switch(ze){case"color":{Xe.color.set(tt);break}case"groundColor":{Xe.groundColor.set(tt);break}case"angle":{Xe.angle=Le(tt);break}case"target":{tt===null?(ke.type==="spot"||ke.type==="directional")&&(Xe.target=$e.defaultTarget):tt.hasLoaded?$e.onSetTarget(tt,Xe):tt.addEventListener("loaded",$e.onSetTarget.bind($e,tt,Xe));break}case"envMap":$e.updateProbeMap(ke,Xe);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":st||($e.updateShadow(),st=!0);break;case"shadowCameraAutomatic":ke.shadowCameraAutomatic?$e.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(ke.shadowCameraAutomatic)):$e.shadowCameraAutomaticEls=[];break;default:Xe[ze]=tt}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var Ne=new be.Box3,ke=new be.Vector3,Ve=new be.Vector3,Xe=new be.Matrix4,$e=new be.Sphere,st=new be.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof be.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var ze=this.light.shadow.camera;ze.getWorldDirection(ke),ze.getWorldPosition(Ve),Xe.copy(ze.matrixWorld),Xe.invert(),ze.near=1,ze.left=1e5,ze.right=-1e5,ze.top=-1e5,ze.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(tt){Ne.setFromObject(tt.object3D),Ne.getBoundingSphere($e);var ft=Pe.distanceOfPointFromPlane(Ve,ke,$e.center),Rt=Pe.nearestPointInPlane(Ve,ke,$e.center,st),Mt=Rt.applyMatrix4(Xe);ze.near=Math.min(-ft-$e.radius-1,ze.near),ze.left=Math.min(-$e.radius+Mt.x,ze.left),ze.right=Math.max($e.radius+Mt.x,ze.right),ze.top=Math.max($e.radius+Mt.y,ze.top),ze.bottom=Math.min(-$e.radius+Mt.y,ze.bottom)}),ze.updateProjectionMatrix()}}}(),setLight:function(Ne){var ke=this.el,Ve=this.getLight(Ne);Ve&&(this.light&&ke.removeObject3D("light"),this.light=Ve,this.light.el=ke,ke.setObject3D("light",this.light),(Ne.type==="spot"||Ne.type==="directional"||Ne.type==="hemisphere")&&ke.getObject3D("light").translateY(-1),Ne.type==="spot"&&(ke.setObject3D("light-target",this.defaultTarget),ke.getObject3D("light-target").position.set(0,0,-1)),Ne.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(Ne.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var Ne=this.el,ke=this.data,Ve=this.light;Ve.castShadow=ke.castShadow;var Xe=Ne.getObject3D("cameraHelper");if(ke.shadowCameraVisible&&!Xe?Ne.setObject3D("cameraHelper",new be.CameraHelper(Ve.shadow.camera)):!ke.shadowCameraVisible&&Xe&&Ne.removeObject3D("cameraHelper"),!ke.castShadow)return Ve;Ve.shadow.bias=ke.shadowBias,Ve.shadow.radius=ke.shadowRadius,Ve.shadow.mapSize.height=ke.shadowMapHeight,Ve.shadow.mapSize.width=ke.shadowMapWidth,Ve.shadow.camera.near=ke.shadowCameraNear,Ve.shadow.camera.far=ke.shadowCameraFar,Ve.shadow.camera instanceof be.OrthographicCamera?(Ve.shadow.camera.top=ke.shadowCameraTop,Ve.shadow.camera.right=ke.shadowCameraRight,Ve.shadow.camera.bottom=ke.shadowCameraBottom,Ve.shadow.camera.left=ke.shadowCameraLeft):Ve.shadow.camera.fov=ke.shadowCameraFov,Ve.shadow.camera.updateProjectionMatrix(),Xe&&Xe.update()},getLight:function(Ne){var ke=Ne.angle,Ve=new be.Color(Ne.color);Ve=Ve.getHex();var Xe=Ne.decay,$e=Ne.distance,st=new be.Color(Ne.groundColor);st=st.getHex();var ze=Ne.intensity,tt=Ne.type,ft=Ne.target,Rt=null;switch(tt.toLowerCase()){case"ambient":return new be.AmbientLight(Ve,ze);case"directional":return Rt=new be.DirectionalLight(Ve,ze),this.defaultTarget=Rt.target,ft&&(ft.hasLoaded?this.onSetTarget(ft,Rt):ft.addEventListener("loaded",this.onSetTarget.bind(this,ft,Rt))),Rt;case"hemisphere":return new be.HemisphereLight(Ve,st,ze);case"point":return new be.PointLight(Ve,ze,$e,Xe);case"spot":return Rt=new be.SpotLight(Ve,ze,$e,Le(ke),Ne.penumbra,Xe),this.defaultTarget=Rt.target,ft&&(ft.hasLoaded?this.onSetTarget(ft,Rt):ft.addEventListener("loaded",this.onSetTarget.bind(this,ft,Rt))),Rt;case"probe":return Rt=new be.LightProbe,this.updateProbeMap(Ne,Rt),Rt;default:xe("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",tt)}},updateProbeMap:function(Ne,ke){Ne.envMap||ke.copy(new be.LightProbe),Oe[Ne.envMap]instanceof window.Promise&&Oe[Ne.envMap].then(function(Ve){ke.copy(Ve)}),Oe[Ne.envMap]instanceof be.LightProbe&&ke.copy(Oe[Ne.envMap]),Oe[Ne.envMap]=new window.Promise(function(Ve){se.srcLoader.validateCubemapSrc(Ne.envMap,function($e){Fe.load($e,function(st){var ze=be.LightProbeGenerator.fromCubeTexture(st);Oe[Ne.envMap]=ze,ke.copy(ze)})})})},onSetTarget:function(Ne,ke){ke.target=Ne.object3D},remove:function(){var Ne=this.el;Ne.removeObject3D("light"),Ne.getObject3D("cameraHelper")&&Ne.removeObject3D("cameraHelper")}})},"./src/components/line.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var Te=this.data,Re,be;be=this.material=new THREE.LineBasicMaterial({color:Te.color,opacity:Te.opacity,transparent:Te.opacity<1,visible:Te.visible}),Re=this.geometry=new THREE.BufferGeometry,Re.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(Re,be),this.el.setObject3D(this.attrName,this.line)},update:function(Te){var Re=this.data,be=this.geometry,Pe=!1,Le=this.material,xe=be.attributes.position.array;me(Re.start,Te.start)||(xe[0]=Re.start.x,xe[1]=Re.start.y,xe[2]=Re.start.z,Pe=!0),me(Re.end,Te.end)||(xe[3]=Re.end.x,xe[4]=Re.end.y,xe[5]=Re.end.z,Pe=!0),Pe&&(be.attributes.position.needsUpdate=!0,be.computeBoundingSphere()),Le.color.setStyle(Re.color),Le.opacity=Re.opacity,Le.transparent=Re.opacity<1,Le.visible=Re.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function me(Te,Re){return!Te||!Re?!1:Te.x===Re.x&&Te.y===Re.y&&Te.z===Re.z}},"./src/components/link.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/core/shader.js").registerShader,Te=ve("./src/lib/three.js");pe.exports.Component=se("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new Te.Quaternion,this.hiddenEls=[]},update:function(Re){var be=this.data,Pe=this.el,Le,xe;be.visualAspectEnabled&&(this.initVisualAspect(),Le=be.highlighted?be.highlightedColor:be.backgroundColor,xe=be.highlighted?be.highlightedColor:be.borderColor,Pe.setAttribute("material","backgroundColor",Le),Pe.setAttribute("material","strokeColor",xe),be.on!==Re.on&&this.updateEventListener(),Re.peekMode!==void 0&&be.peekMode!==Re.peekMode&&this.updatePeekMode(),!(!be.image||Re.image===be.image)&&Pe.setAttribute("material","pano",typeof be.image=="string"?be.image:be.image.src))},updatePeekMode:function(){var Re=this.el,be=this.sphereEl;this.data.peekMode?(this.hideAll(),Re.getObject3D("mesh").visible=!1,be.setAttribute("visible",!0)):(this.showAll(),Re.getObject3D("mesh").visible=!0,be.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var Re=this.el;Re.isPlaying&&(this.removeEventListener(),Re.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var Re=this.data.on;Re&&this.el.removeEventListener(Re,this.navigate)},initVisualAspect:function(){var Re=this.el,be,Pe,Le;!this.data.visualAspectEnabled||this.visualAspectInitialized||(Le=this.textEl=this.textEl||document.createElement("a-entity"),Pe=this.sphereEl=this.sphereEl||document.createElement("a-entity"),be=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),Re.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),Re.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),Le.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),Le.setAttribute("position","0 1.5 0"),Re.appendChild(Le),be.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),be.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),be.setAttribute("rotation","0 180 0"),be.setAttribute("position","0 0 0"),be.setAttribute("visible",!1),Re.appendChild(be),Pe.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),Pe.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),Pe.setAttribute("visible",!1),Re.appendChild(Pe),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var Re=new Te.Vector3,be=new Te.Vector3,Pe=new Te.Quaternion,Le=new Te.Vector3;return function(){var xe=this.el,Fe=xe.object3D,Oe=xe.sceneEl.camera,Ne,ke,Ve=this.textEl;if(this.data.visualAspectEnabled)if(Fe.updateMatrixWorld(),Oe.parent.updateMatrixWorld(),Oe.updateMatrixWorld(),Fe.matrix.decompose(be,Pe,Le),be.setFromMatrixPosition(Fe.matrixWorld),Re.setFromMatrixPosition(Oe.matrixWorld),ke=be.distanceTo(Re),ke>20)this.previousQuaternion||(this.quaternionClone.copy(Pe),this.previousQuaternion=this.quaternionClone),Fe.lookAt(Re);else{if(Ne=this.calculateCameraPortalOrientation(),ke<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;Ve.setAttribute("text","width",1.5),Ne<=0?(Ve.setAttribute("position","0 0 0.75"),Ve.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(Ve.setAttribute("position","0 0 -0.75"),Ve.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),xe.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=Ne}else Ne<=0?Ve.setAttribute("rotation","0 180 0"):Ve.setAttribute("rotation","0 0 0"),Ve.setAttribute("text","width",5),Ve.setAttribute("position","0 1.5 0"),xe.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(Fe.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var Re=this.el,be=this.hiddenEls,Pe=this;be.length>0||Re.sceneEl.object3D.traverse(function(Le){Le&&Le.el&&Le.el.hasAttribute("link-controls")||!Le.el||Le===Re.sceneEl.object3D||Le.el===Re||Le.el===Pe.sphereEl||Le.el===Re.sceneEl.cameraEl||Le.el.getAttribute("visible")===!1||Le.el===Pe.textEl||Le.el===Pe.semiSphereEl||(Le.el.setAttribute("visible",!1),be.push(Le.el))})},showAll:function(){this.hiddenEls.forEach(function(Re){Re.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var Re=new Te.Matrix4,be=new Te.Vector3,Pe=new Te.Vector3(0,0,1),Le=new Te.Vector3(0,0,0);return function(){var xe=this.el,Fe=xe.sceneEl.camera;return be.set(0,0,0),Pe.set(0,0,1),Le.set(0,0,0),xe.object3D.matrixWorld.extractRotation(Re),Pe.applyMatrix4(Re),xe.object3D.updateMatrixWorld(),xe.object3D.localToWorld(Le),Fe.parent.parent.updateMatrixWorld(),Fe.parent.updateMatrixWorld(),Fe.updateMatrixWorld(),Fe.localToWorld(be),be.sub(Le).normalize(),Pe.normalize(),Math.sign(Pe.dot(be))}}(),remove:function(){this.removeEventListener()}}),me("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js"),Re=Math.PI/2;pe.exports.Component=se("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new me.Vector3,this.hmdQuaternion=new me.Quaternion,this.magicWindowAbsoluteEuler=new me.Euler,this.magicWindowDeltaEuler=new me.Euler,this.position=new me.Vector3,this.magicWindowObject=new me.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new me.Vector3,rotation:new me.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var be,Pe=this.data;(Te.device.isMobile()||Te.device.isMobileDeviceRequestingDesktopSite())&&(be=this.magicWindowControls=new me.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(be.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?be.enabled=Pe.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){be.enabled=Pe.magicWindowTrackingEnabled})))},update:function(be){var Pe=this.data;Pe.enabled!==be.enabled&&this.updateGrabCursor(Pe.enabled),be&&!Pe.magicWindowTrackingEnabled&&be.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=Pe.magicWindowTrackingEnabled),be&&!Pe.pointerLockEnabled!==be.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(be){var Pe=this.data;Pe.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockError=this.onPointerLockError.bind(this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new me.Object3D,this.yawObject=new me.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var be=this.el.sceneEl,Pe=be.canvas;if(!Pe){be.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}Pe.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),Pe.addEventListener("touchstart",this.onTouchStart,{passive:!0}),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),window.addEventListener("touchend",this.onTouchEnd,{passive:!0}),be.addEventListener("enter-vr",this.onEnterVR),be.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var be=this.el.sceneEl,Pe=be&&be.canvas;Pe&&(Pe.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),Pe.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),be.removeEventListener("enter-vr",this.onEnterVR),be.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var be=this.el.object3D,Pe=this.pitchObject,Le=this.yawObject,xe=this.el.sceneEl;(xe.is("vr-mode")||xe.is("ar-mode"))&&xe.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),be.rotation.x=this.magicWindowDeltaEuler.x+Pe.rotation.x,be.rotation.y=this.magicWindowDeltaEuler.y+Le.rotation.y,be.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var be=this.magicWindowAbsoluteEuler,Pe=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),be.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&be.y!==0&&(this.previousMagicWindowYaw=be.y),this.previousMagicWindowYaw&&(Pe.x=be.x,Pe.y+=be.y-this.previousMagicWindowYaw,Pe.z=be.z,this.previousMagicWindowYaw=be.y))},onMouseMove:function(be){var Pe,Le,xe,Fe=this.pitchObject,Oe=this.previousMouseEvent,Ne=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(Le=be.movementX||be.mozMovementX||0,xe=be.movementY||be.mozMovementY||0):(Le=be.screenX-Oe.screenX,xe=be.screenY-Oe.screenY),this.previousMouseEvent.screenX=be.screenX,this.previousMouseEvent.screenY=be.screenY,Pe=this.data.reverseMouseDrag?1:-1,Ne.rotation.y+=Le*.002*Pe,Fe.rotation.x+=xe*.002*Pe,Fe.rotation.x=Math.max(-Re,Math.min(Re,Fe.rotation.x)))},onMouseDown:function(be){var Pe=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(Pe.is("vr-mode")||Pe.is("ar-mode"))&&Pe.checkHeadsetConnected())&&be.button===0){var Le=Pe&&Pe.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=be.screenX,this.previousMouseEvent.screenY=be.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(Le.requestPointerLock?Le.requestPointerLock():Le.mozRequestPointerLock&&Le.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(be){be.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:be.touches[0].pageX,y:be.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(be){var Pe,Le=this.el.sceneEl.canvas,xe,Fe=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(xe=2*Math.PI*(be.touches[0].pageX-this.touchStart.x)/Le.clientWidth,Pe=this.data.reverseTouchDrag?1:-1,Fe.rotation.y-=xe*.5*Pe,this.touchStart={x:be.touches[0].pageX,y:be.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var be=this.el.sceneEl;be.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),be.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(be){var Pe=this.el.sceneEl;function Le(){Pe.canvas.classList.add("a-grab-cursor")}function xe(){Pe.canvas.classList.remove("a-grab-cursor")}if(!Pe.canvas){be?Pe.addEventListener("render-target-loaded",Le):Pe.addEventListener("render-target-loaded",xe);return}if(be){Le();return}xe()},saveCameraPose:function(){var be=this.el;this.savedPose.position.copy(be.object3D.position),this.savedPose.rotation.copy(be.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var be=this.el,Pe=this.savedPose;this.hasSavedPose&&(be.object3D.position.copy(Pe.position),be.object3D.rotation.copy(Pe.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=me.checkControllerPresentAndSetup,Re=me.emitIfAxesChanged,be=me.onButtonEvent,Pe="magicleap",Le="-one",xe=Pe+Le,Fe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Oe=Fe+"controllers/magicleap/magicleap-one-controller.glb",Ne={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};pe.exports.Component=se("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:Ne,init:function(){var ke=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(Ve){be(Ve.detail.id,"down",ke)},this.onButtonUp=function(Ve){be(Ve.detail.id,"up",ke)},this.onButtonTouchEnd=function(Ve){be(Ve.detail.id,"touchend",ke)},this.onButtonTouchStart=function(Ve){be(Ve.detail.id,"touchstart",ke)},this.previousButtonValues={},this.bindMethods()},update:function(){var ke=this.data;this.controllerIndex=ke.hand==="right"?0:ke.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var ke=this.el;ke.addEventListener("buttonchanged",this.onButtonChanged),ke.addEventListener("buttondown",this.onButtonDown),ke.addEventListener("buttonup",this.onButtonUp),ke.addEventListener("touchstart",this.onButtonTouchStart),ke.addEventListener("touchend",this.onButtonTouchEnd),ke.addEventListener("axismove",this.onAxisMoved),ke.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var ke=this.el;ke.removeEventListener("buttonchanged",this.onButtonChanged),ke.removeEventListener("buttondown",this.onButtonDown),ke.removeEventListener("buttonup",this.onButtonUp),ke.removeEventListener("touchstart",this.onButtonTouchStart),ke.removeEventListener("touchend",this.onButtonTouchEnd),ke.removeEventListener("axismove",this.onAxisMoved),ke.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var ke=this.data;Te(this,xe,{index:this.controllerIndex,hand:ke.hand})},injectTrackedControls:function(){var ke=this.el,Ve=this.data;ke.setAttribute("tracked-controls",{idPrefix:xe,hand:Ve.hand,controller:this.controllerIndex,orientationOffset:Ve.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",Oe)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(ke){var Ve=this.mapping.buttons[ke.detail.id],Xe;Ve&&(Ve==="trigger"&&(Xe=ke.detail.state.value,console.log("analog value of trigger press: "+Xe)),this.el.emit(Ve+"changed",ke.detail.state))},onModelLoaded:function(ke){var Ve=ke.detail.model;Ve.scale.set(.01,.01,.01)},onAxisMoved:function(ke){Re(this,this.mapping.axes,ke)},updateModel:function(ke,Ve){},setButtonColor:function(ke,Ve){}})},"./src/components/material.js":(pe,Me,ve)=>{var se=ve("./src/utils/index.js"),me=ve("./src/core/component.js"),Te=ve("./src/lib/three.js"),Re=ve("./src/core/shader.js"),be=se.debug("components:material:error"),Pe=me.registerComponent,Le=Re.shaders,xe=Re.shaderNames;pe.exports.Component=Pe("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:xe,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(ke){var Ve=this.data;(!this.shader||Ve.shader!==ke.shader)&&this.updateShader(Ve.shader),this.shader.update(this.data),this.updateMaterial(ke)},updateSchema:function(ke){var Ve,Xe,$e,st;Xe=ke&&ke.shader,Ve=this.oldData&&this.oldData.shader,st=Xe||Ve,$e=Le[st]&&Le[st].schema,$e||be("Unknown shader schema "+st),!(Ve&&Xe===Ve)&&(this.extendSchema($e),this.updateBehavior())},updateBehavior:function(){var ke,Ve=this.el.sceneEl,Xe=this.schema,$e=this,st;function ze(tt,ft){var Rt;for(Rt in st)st[Rt]=tt;$e.shader.update(st)}this.tick=void 0,st={};for(ke in Xe)Xe[ke].type==="time"&&(this.tick=ze,st[ke]=!0);Ve&&(this.tick?Ve.addBehavior(this):Ve.removeBehavior(this))},updateShader:function(ke){var Ve=this.data,Xe=Le[ke]&&Le[ke].Shader,$e;if(!Xe)throw new Error("Unknown shader "+ke);$e=this.shader=new Xe,$e.el=this.el,$e.init(Ve),this.setMaterial($e.material),this.updateSchema(Ve)},updateMaterial:function(ke){var Ve=this.data,Xe=this.material,$e;Xe.alphaTest=Ve.alphaTest,Xe.depthTest=Ve.depthTest!==!1,Xe.depthWrite=Ve.depthWrite!==!1,Xe.opacity=Ve.opacity,Xe.flatShading=Ve.flatShading,Xe.side=Fe(Ve.side),Xe.transparent=Ve.transparent!==!1||Ve.opacity<1,Xe.vertexColors=Ve.vertexColorsEnabled,Xe.visible=Ve.visible,Xe.blending=Oe(Ve.blending),Xe.dithering=Ve.dithering;for($e in ke)break;$e&&(ke.alphaTest!==Ve.alphaTest||ke.side!==Ve.side||ke.vertexColorsEnabled!==Ve.vertexColorsEnabled)&&(Xe.needsUpdate=!0)},remove:function(){var ke=new Te.MeshBasicMaterial,Ve=this.material,Xe=this.el.getObject3D("mesh");Xe&&(Xe.material=ke),Ne(Ve,this.system)},setMaterial:function(ke){var Ve=this.el,Xe,$e=this.system;this.material&&Ne(this.material,$e),this.material=ke,$e.registerMaterial(ke),Xe=Ve.getObject3D("mesh"),Xe?Xe.material=ke:Ve.addEventListener("object3dset",function st(ze){ze.detail.type!=="mesh"||ze.target!==Ve||(Ve.getObject3D("mesh").material=ke,Ve.removeEventListener("object3dset",st))})}});function Fe(ke){switch(ke){case"back":return Te.BackSide;case"double":return Te.DoubleSide;default:return Te.FrontSide}}function Oe(ke){switch(ke){case"none":return Te.NoBlending;case"additive":return Te.AdditiveBlending;case"subtractive":return Te.SubtractiveBlending;case"multiply":return Te.MultiplyBlending;default:return Te.NormalBlending}}function Ne(ke,Ve){ke.dispose(),Ve.unregisterMaterial(ke),Object.keys(ke).filter(function(Xe){return ke[Xe]&&ke[Xe].isTexture}).forEach(function(Xe){ke[Xe].dispose()})}},"./src/components/obb-collider.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js");se("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new me.Vector3().copy(this.el.object3D.scale),this.auxEuler=new me.Euler,this.boundingBox=new me.Box3,this.boundingBoxSize=new me.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var Te=this.el,Re=Te.components["gltf-model"]&&Te.components["gltf-model"].model,be,Pe;Re&&(this.el.removeObject3D("mesh"),be=new me.Box3().setFromObject(Re),Pe=be.getCenter(new me.Vector3),Re.position.x+=Re.position.x-Pe.x,Re.position.y+=Re.position.y-Pe.y,Re.position.z+=Re.position.z-Pe.z,this.el.setObject3D("mesh",Re))},updateCollider:function(){var Te=this.el,Re=this.boundingBoxSize,be=this.aabb=this.aabb||new me.OBB;if(this.obb=this.obb||new me.OBB,!Te.hasLoaded){Te.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),be.halfSize.copy(Re).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var Te=this.renderColliderMesh,Re=this.boundingBoxSize;if(!Te){this.initColliderMesh();return}Te.geometry.dispose(),Te.geometry=new me.BoxGeometry(Re.x,Re.y,Re.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var Te,Re,be;Te=this.boundingBoxSize,Re=this.renderColliderGeometry=new me.BoxGeometry(Te.x,Te.y,Te.z),be=this.renderColliderMesh=new me.Mesh(Re,new me.MeshLambertMaterial({color:65280,side:me.DoubleSide})),be.matrixAutoUpdate=!1,be.matrixWorldAutoUpdate=!1,be.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(be)},updateBoundingBox:function(){var Te=new me.Vector3,Re=new me.Vector3,be=new me.Quaternion,Pe=new me.Quaternion,Le=new me.Matrix4;return function(){var xe=this.auxEuler,Fe=this.boundingBox,Oe=this.data.size,Ne=this.trackedObject3D||this.el.object3D,ke=this.boundingBoxSize,Ve=this.data.minimumColliderDimension;if(Oe){this.boundingBoxSize.x=Oe,this.boundingBoxSize.y=Oe,this.boundingBoxSize.z=Oe;return}xe.copy(Ne.rotation),Ne.rotation.set(0,0,0),Ne.parent.matrixWorld.decompose(Te,be,Re),Le.compose(Te,Pe,Re),Ne.parent.matrixWorld.copy(Le),Fe.setFromObject(Ne,!0),Fe.getSize(ke),ke.x=ke.x<Ve?Ve:ke.x,ke.y=ke.y<Ve?Ve:ke.y,ke.z=ke.z<Ve?Ve:ke.z,Ne.parent.matrixWorld.compose(Te,be,Re),this.el.object3D.rotation.copy(xe)}}(),checkTrackedObject:function(){var Te=this.trackedObject3DPath,Re;if(Te&&Te.length&&!this.trackedObject3D){Re=this.el;for(var be=0;be<Te.length&&(Re=Re[Te[be]],!!Re);be++);Re&&(this.trackedObject3D=Re,this.updateCollider())}return this.trackedObject3D},tick:function(){var Te=new me.Vector3,Re=new me.Vector3,be=new me.Quaternion,Pe=new me.Matrix4;return function(){var Le=this.obb,xe=this.renderColliderMesh,Fe=this.checkTrackedObject()||this.el.object3D;Fe&&(Fe.updateMatrix(),Fe.updateMatrixWorld(!0),Fe.matrixWorld.decompose(Te,be,Re),(Math.abs(Re.x-this.previousScale.x)>1e-4||Math.abs(Re.y-this.previousScale.y)>1e-4||Math.abs(Re.z-this.previousScale.z)>1e-4)&&this.updateCollider(),this.previousScale.copy(Re),Re.set(1,1,1),Pe.compose(Te,be,Re),xe&&xe.matrixWorld.copy(Pe),Le.copy(this.aabb),Le.applyMatrix4(Pe))}}()})},"./src/components/obj-model.js":(pe,Me,ve)=>{var se=ve("./src/utils/debug.js"),me=ve("./src/core/component.js").registerComponent,Te=ve("./src/lib/three.js"),Re=se("components:obj-model:warn");pe.exports.Component=me("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var be=this;this.model=null,this.objLoader=new Te.OBJLoader,this.mtlLoader=new Te.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(Pe){be.model&&Pe.detail.name==="material"&&be.applyMaterial()})},update:function(){var be=this.data;be.obj&&(this.resetMesh(),this.loadObj(be.obj,be.mtl))},remove:function(){this.resetMesh()},resetMesh:function(){this.model&&this.el.removeObject3D("mesh")},loadObj:function(be,Pe){var Le=this,xe=this.el,Fe=this.mtlLoader,Oe=this.objLoader,Ne=this.el.sceneEl.systems.renderer,ke=Pe.substr(0,Pe.lastIndexOf("/")+1);if(Pe){xe.hasAttribute("material")&&Re("Material component properties are ignored when a .MTL is provided"),Fe.setResourcePath(ke),Fe.load(Pe,function(Ve){Ve.preload(),Oe.setMaterials(Ve),Oe.load(be,function(Xe){Le.model=Xe,Le.model.traverse(function($e){if($e.isMesh){var st=$e.material;st.map&&Ne.applyColorCorrection(st.map),st.emissiveMap&&Ne.applyColorCorrection(st.emissiveMap)}}),xe.setObject3D("mesh",Xe),xe.emit("model-loaded",{format:"obj",model:Xe})})});return}Oe.load(be,function(Xe){Le.model=Xe,Le.applyMaterial(),xe.setObject3D("mesh",Xe),xe.emit("model-loaded",{format:"obj",model:Xe})})},applyMaterial:function(){var be=this.el.components.material;be&&this.model.traverse(function(Pe){Pe instanceof Te.Mesh&&(Pe.material=be.material)})}})},"./src/components/oculus-go-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=me.checkControllerPresentAndSetup,Re=me.emitIfAxesChanged,be=me.onButtonEvent,Pe=ve("./src/utils/index.js").device.isWebXRAvailable,Le="oculus-go",xe="Oculus Go",Fe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Oe=Fe+"controllers/oculus/go/oculus-go-controller.gltf",Ne=Pe?Le:xe,ke={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},Ve={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},Xe=Pe?Ve:ke;pe.exports.Component=se("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:Xe,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var $e=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(st){be(st.detail.id,"down",$e)},this.onButtonUp=function(st){be(st.detail.id,"up",$e)},this.onButtonTouchStart=function(st){be(st.detail.id,"touchstart",$e)},this.onButtonTouchEnd=function(st){be(st.detail.id,"touchend",$e)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var $e=this.el;$e.addEventListener("buttonchanged",this.onButtonChanged),$e.addEventListener("buttondown",this.onButtonDown),$e.addEventListener("buttonup",this.onButtonUp),$e.addEventListener("touchstart",this.onButtonTouchStart),$e.addEventListener("touchend",this.onButtonTouchEnd),$e.addEventListener("model-loaded",this.onModelLoaded),$e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var $e=this.el;$e.removeEventListener("buttonchanged",this.onButtonChanged),$e.removeEventListener("buttondown",this.onButtonDown),$e.removeEventListener("buttonup",this.onButtonUp),$e.removeEventListener("touchstart",this.onButtonTouchStart),$e.removeEventListener("touchend",this.onButtonTouchEnd),$e.removeEventListener("model-loaded",this.onModelLoaded),$e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){Te(this,Ne,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var $e=this.el,st=this.data;$e.setAttribute("tracked-controls",{armModel:st.armModel,hand:st.hand,idPrefix:Ne,orientationOffset:st.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",Oe)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function($e){var st=$e.detail.model,ze;$e.target!==this.el||!this.data.model||(ze=this.buttonMeshes={},ze.trigger=st.getObjectByName("oculus_go_button_trigger"),ze.trackpad=st.getObjectByName("oculus_go_touchpad"),ze.touchpad=st.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function($e){var st=this.mapping.buttons[$e.detail.id];st&&this.el.emit(st+"changed",$e.detail.state)},onAxisMoved:function($e){Re(this,this.mapping.axes,$e)},updateModel:function($e,st){this.data.model&&this.updateButtonModel($e,st)},updateButtonModel:function($e,st){var ze=this.buttonMeshes;if(!(!ze||!ze[$e])){var tt,ft;switch(st){case"down":tt=this.data.buttonHighlightColor;break;case"touchstart":tt=this.data.buttonTouchedColor;break;default:tt=this.data.buttonColor}ft=ze[$e],ft.material.color.set(tt)}}})},"./src/components/oculus-touch-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/tracked-controls.js"),Re=Te.checkControllerPresentAndSetup,be=Te.emitIfAxesChanged,Pe=Te.onButtonEvent,Le=ve("./src/utils/index.js").device.isWebXRAvailable,xe="oculus-touch",Fe="Oculus Touch",Oe=Le?xe:Fe,Ne=ve("./src/constants/index.js").AFRAME_CDN_ROOT,ke=Ne+"controllers/oculus/oculus-touch-controller-",Ve=Ne+"controllers/meta/",Xe={left:{modelUrl:ke+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new me.Vector3(-.005,.003,-.055),modelPivotRotation:new me.Euler(0,0,0)},right:{modelUrl:ke+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new me.Vector3(.005,.003,-.055),modelPivotRotation:new me.Euler(0,0,0)}},$e={left:{modelUrl:ke+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new me.Vector3(-.005,.036,-.037),modelPivotRotation:new me.Euler(Math.PI/4.5,0,0)},right:{modelUrl:ke+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new me.Vector3(.005,.036,-.037),modelPivotRotation:new me.Euler(Math.PI/4.5,0,0)}},st=Le?$e:Xe,ze="oculus-touch",tt={"oculus-touch":st,"oculus-touch-v2":{left:{modelUrl:ke+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new me.Vector3(0,-.007,-.021),modelPivotRotation:new me.Euler(-Math.PI/4,0,0)},right:{modelUrl:ke+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new me.Vector3(0,-.007,-.021),modelPivotRotation:new me.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:ke+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new me.Vector3(0,0,0),modelPivotRotation:new me.Euler(0,0,0)},right:{modelUrl:ke+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new me.Vector3(0,0,0),modelPivotRotation:new me.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:Ve+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new me.Vector3(0,0,0),modelPivotRotation:new me.Euler(0,0,0)},right:{modelUrl:Ve+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new me.Vector3(0,0,0),modelPivotRotation:new me.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:Ve+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new me.Vector3(0,0,0),modelPivotRotation:new me.Euler(0,0,0)},right:{modelUrl:Ve+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new me.Vector3(0,0,0),modelPivotRotation:new me.Euler(0,0,0)}}},ft={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},Rt={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},Mt=Le?Rt:ft;pe.exports.Component=se("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},after:["tracked-controls"],mapping:Mt,bindMethods:function(){this.onButtonChanged=this.onButtonChanged.bind(this),this.onThumbstickMoved=this.onThumbstickMoved.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var _t=this;this.onButtonDown=function(Bt){Pe(Bt.detail.id,"down",_t,_t.data.hand)},this.onButtonUp=function(Bt){Pe(Bt.detail.id,"up",_t,_t.data.hand)},this.onButtonTouchStart=function(Bt){Pe(Bt.detail.id,"touchstart",_t,_t.data.hand)},this.onButtonTouchEnd=function(Bt){Pe(Bt.detail.id,"touchend",_t,_t.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new me.Euler},addEventListeners:function(){var _t=this.el;_t.addEventListener("buttonchanged",this.onButtonChanged),_t.addEventListener("buttondown",this.onButtonDown),_t.addEventListener("buttonup",this.onButtonUp),_t.addEventListener("touchstart",this.onButtonTouchStart),_t.addEventListener("touchend",this.onButtonTouchEnd),_t.addEventListener("axismove",this.onAxisMoved),_t.addEventListener("model-loaded",this.onModelLoaded),_t.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var _t=this.el;_t.removeEventListener("buttonchanged",this.onButtonChanged),_t.removeEventListener("buttondown",this.onButtonDown),_t.removeEventListener("buttonup",this.onButtonUp),_t.removeEventListener("touchstart",this.onButtonTouchStart),_t.removeEventListener("touchend",this.onButtonTouchEnd),_t.removeEventListener("axismove",this.onAxisMoved),_t.removeEventListener("model-loaded",this.onModelLoaded),_t.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){Re(this,Oe,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(_t){var Bt=this.data,dt;if(Bt.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=tt[Bt.controllerType]||tt[ze],Bt.controllerType==="auto"){var ut=this.el.sceneEl.systems["tracked-controls-webvr"];if(ut&&ut.vrDisplay){var Ut=ut.vrDisplay.displayName;/^Oculus Quest$/.test(Ut)&&(this.displayModel=tt["oculus-touch-v2"])}else{dt=ze;for(var Tt=Object.keys(tt),Xt=0;Xt<_t.profiles.length;Xt++)if(Tt.indexOf(_t.profiles[Xt])!==-1){dt=_t.profiles[Xt];break}this.displayModel=tt[dt]}}var hn=this.displayModel[Bt.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===tt["oculus-touch-v3"]||this.displayModel===tt["meta-quest-touch-pro"]||this.displayModel===tt["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",hn)}},injectTrackedControls:function(_t){var Bt=this.data,dt=xe,ut=Bt.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",Ut=Le?dt:ut;this.el.setAttribute("tracked-controls",{id:Ut,hand:Bt.hand,orientationOffset:Bt.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(_t)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(_t){var Bt=this.mapping[this.data.hand].buttons[_t.detail.id];if(Bt){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(_t);else{var dt=this.buttonMeshes,ut;(Bt==="trigger"||Bt==="grip")&&(ut=_t.detail.state.value),dt&&(Bt==="trigger"&&dt.trigger&&(dt.trigger.rotation.x=this.originalXRotationTrigger-ut*(Math.PI/26)),Bt==="grip"&&dt.grip&&(ut*=this.data.hand==="left"?-1:1,dt.grip.position.x=this.originalXPositionGrip+ut*.004))}this.el.emit(Bt+"changed",_t.detail.state)}},onButtonChangedV3orPROorPlus:function(_t){var Bt=this.mapping[this.data.hand].buttons[_t.detail.id],dt=this.buttonObjects,ut;!dt||!dt[Bt]||(ut=_t.detail.state.value,dt[Bt].quaternion.slerpQuaternions(this.buttonRanges[Bt].min.quaternion,this.buttonRanges[Bt].max.quaternion,ut),dt[Bt].position.lerpVectors(this.buttonRanges[Bt].min.position,this.buttonRanges[Bt].max.position,ut))},onModelLoaded:function(_t){if(!(_t.target!==this.el||!this.data.model)){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(_t);else{var Bt=this.controllerObject3D=_t.detail.model,dt;dt=this.buttonMeshes={},dt.grip=Bt.getObjectByName("buttonHand"),this.originalXPositionGrip=dt.grip&&dt.grip.position.x,dt.trigger=Bt.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=dt.trigger&&dt.trigger.rotation.x,dt.thumbstick=Bt.getObjectByName("stick"),dt.xbutton=Bt.getObjectByName("buttonX"),dt.abutton=Bt.getObjectByName("buttonA"),dt.ybutton=Bt.getObjectByName("buttonY"),dt.bbutton=Bt.getObjectByName("buttonB")}for(var ut in this.buttonMeshes)this.buttonMeshes[ut]&&Gt(this.buttonMeshes[ut]);this.applyOffset(_t.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(_t){_t.position.copy(this.displayModel[this.data.hand].modelPivotOffset),_t.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(_t){var Bt=this.controllerObject3D=_t.detail.model,dt=this.buttonObjects={},ut=this.buttonMeshes={},Ut=this.buttonRanges={};ut.grip=Bt.getObjectByName("squeeze"),dt.grip=Bt.getObjectByName("xr_standard_squeeze_pressed_value"),Ut.grip={min:Bt.getObjectByName("xr_standard_squeeze_pressed_min"),max:Bt.getObjectByName("xr_standard_squeeze_pressed_max")},dt.grip.minX=dt.grip.position.x,ut.thumbstick=Bt.getObjectByName("thumbstick"),dt.thumbstick=Bt.getObjectByName("xr_standard_thumbstick_pressed_value"),Ut.thumbstick={min:Bt.getObjectByName("xr_standard_thumbstick_pressed_min"),max:Bt.getObjectByName("xr_standard_thumbstick_pressed_max")},dt.thumbstickXAxis=Bt.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),Ut.thumbstickXAxis={min:Bt.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:Bt.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},dt.thumbstickYAxis=Bt.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),Ut.thumbstickYAxis={min:Bt.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:Bt.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},ut.trigger=Bt.getObjectByName("trigger"),dt.trigger=Bt.getObjectByName("xr_standard_trigger_pressed_value"),Ut.trigger={min:Bt.getObjectByName("xr_standard_trigger_pressed_min"),max:Bt.getObjectByName("xr_standard_trigger_pressed_max")},Ut.trigger.diff={x:Math.abs(Ut.trigger.max.rotation.x)-Math.abs(Ut.trigger.min.rotation.x),y:Math.abs(Ut.trigger.max.rotation.y)-Math.abs(Ut.trigger.min.rotation.y),z:Math.abs(Ut.trigger.max.rotation.z)-Math.abs(Ut.trigger.min.rotation.z)};var Tt=this.data.hand==="left"?"x":"a",Xt=this.data.hand==="left"?"y":"b",hn=Tt+"button",nn=Xt+"button";ut[hn]=Bt.getObjectByName(Tt+"_button"),dt[hn]=Bt.getObjectByName(Tt+"_button_pressed_value"),Ut[hn]={min:Bt.getObjectByName(Tt+"_button_pressed_min"),max:Bt.getObjectByName(Tt+"_button_pressed_max")},ut[nn]=Bt.getObjectByName(Xt+"_button"),dt[nn]=Bt.getObjectByName(Xt+"_button_pressed_value"),Ut[nn]={min:Bt.getObjectByName(Xt+"_button_pressed_min"),max:Bt.getObjectByName(Xt+"_button_pressed_max")}},onAxisMoved:function(_t){be(this,this.mapping[this.data.hand].axes,_t)},onThumbstickMoved:function(_t){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(_t);return}for(var Bt in _t.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[Bt]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[Bt]]-Math.PI/8*_t.detail[Bt]*(Bt==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(_t){var Bt=(_t.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,Bt);var dt=(_t.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,dt)},updateModel:function(_t,Bt){this.data.model&&this.updateButtonModel(_t,Bt)},updateButtonModel:function(_t,Bt){var dt=this.buttonMeshes,ut,Ut;dt&&dt[_t]&&(Ut=Bt==="up"||Bt==="touchend"?dt[_t].originalColor||this.data.buttonColor:Bt==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,ut=dt[_t],ut.material.color.set(Ut))}});function Gt(_t){_t.traverse(function(Bt){var dt;Bt.type==="Mesh"&&(dt=Bt.material.clone(),_t.originalColor=Bt.material.color,Bt.material.dispose(),Bt.material=dt)})}},"./src/components/pico-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/tracked-controls.js"),Re=Te.checkControllerPresentAndSetup,be=Te.emitIfAxesChanged,Pe=Te.onButtonEvent,Le="pico-4",xe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Fe=xe+"controllers/pico/pico4/",Oe={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};pe.exports.Component=se("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:Oe,init:function(){var Ne=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(ke){Pe(ke.detail.id,"down",Ne,Ne.data.hand)},this.onButtonUp=function(ke){Pe(ke.detail.id,"up",Ne,Ne.data.hand)},this.onButtonTouchEnd=function(ke){Pe(ke.detail.id,"touchend",Ne,Ne.data.hand)},this.onButtonTouchStart=function(ke){Pe(ke.detail.id,"touchstart",Ne,Ne.data.hand)},this.bindMethods()},update:function(){var Ne=this.data;this.controllerIndex=Ne.hand==="right"?0:Ne.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var Ne=this.el;Ne.addEventListener("buttonchanged",this.onButtonChanged),Ne.addEventListener("buttondown",this.onButtonDown),Ne.addEventListener("buttonup",this.onButtonUp),Ne.addEventListener("touchstart",this.onButtonTouchStart),Ne.addEventListener("touchend",this.onButtonTouchEnd),Ne.addEventListener("axismove",this.onAxisMoved),Ne.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Ne=this.el;Ne.removeEventListener("buttonchanged",this.onButtonChanged),Ne.removeEventListener("buttondown",this.onButtonDown),Ne.removeEventListener("buttonup",this.onButtonUp),Ne.removeEventListener("touchstart",this.onButtonTouchStart),Ne.removeEventListener("touchend",this.onButtonTouchEnd),Ne.removeEventListener("axismove",this.onAxisMoved),Ne.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var Ne=this.data;Re(this,Le,{index:this.controllerIndex,hand:Ne.hand})},injectTrackedControls:function(){var Ne=this.el,ke=this.data;Ne.setAttribute("tracked-controls",{idPrefix:Le,hand:ke.hand,controller:this.controllerIndex,orientationOffset:ke.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",Fe+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(Ne){var ke=this.mapping[this.data.hand].buttons[Ne.detail.id],Ve;ke&&(ke==="trigger"&&(Ve=Ne.detail.state.value,console.log("analog value of trigger press: "+Ve)),this.el.emit(ke+"changed",Ne.detail.state))},onModelLoaded:function(Ne){Ne.target!==this.el||!this.data.model||this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new me.Vector3(0,0,0)})},onAxisMoved:function(Ne){be(this,this.mapping.axes,Ne)}})},"./src/components/position.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("position",{schema:{type:"vec3"},update:function(){var me=this.el.object3D,Te=this.data;me.position.set(Te.x,Te.y,Te.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js"),Re=Te.debug("components:raycaster:warn"),be=/^[\w\s-.,[\]#]*$/,Pe={childList:!0,attributes:!0,subtree:!0},Le={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};pe.exports.Component=se("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new me.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new me.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new me.Vector3,this.otherLineEndVec3=new me.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(Fe){var Oe=this.data,Ne=this.el,ke=this.raycaster;ke.far=Oe.far,ke.near=Oe.near,Oe.showLine&&(Oe.far!==Fe.far||Oe.origin!==Fe.origin||Oe.direction!==Fe.direction||!Fe.showLine)&&(this.unitLineEndVec3.copy(Oe.direction).normalize(),this.drawLine()),!Oe.showLine&&Fe.showLine&&Ne.removeAttribute("line"),Oe.objects!==Fe.objects&&!be.test(Oe.objects)&&Re('[raycaster] Selector "'+Oe.objects+'" may not update automatically with DOM changes.'),Oe.objects||Re('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),Oe.autoRefresh!==Fe.autoRefresh&&Ne.isPlaying&&(Oe.autoRefresh?this.addEventListeners():this.removeEventListeners()),Fe.enabled&&!Oe.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,Pe),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var Fe=this.data,Oe;Oe=Fe.objects?this.el.sceneEl.querySelectorAll(Fe.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(Oe),this.dirty=!1},tock:function(Fe){var Oe=this.data,Ne=this.prevCheckTime;Oe.enabled&&(Ne&&Fe-Ne<Oe.interval||(this.prevCheckTime=Fe,this.checkIntersections()))},checkIntersections:function(){var Fe=this.clearedIntersectedEls,Oe=this.el,Ne=this.data,ke,Ve=this.intersectedEls,Xe,$e=this.intersections,st=this.newIntersectedEls,ze=this.newIntersections,tt=this.prevIntersectedEls,ft=this.rawIntersections;for(this.dirty&&this.refreshObjects(),xe(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),ft.length=0,this.raycaster.intersectObjects(this.objects,!0,ft),$e.length=0,Ve.length=0,ke=0;ke<ft.length;ke++)Xe=ft[ke],!(Ne.showLine&&Xe.object===Oe.getObject3D("line"))&&Xe.object.el&&($e.push(Xe),Ve.push(Xe.object.el));for(ze.length=0,st.length=0,ke=0;ke<$e.length;ke++)tt.indexOf($e[ke].object.el)===-1&&(ze.push($e[ke]),st.push($e[ke].object.el));for(Fe.length=0,ke=0;ke<tt.length;ke++)Ve.indexOf(tt[ke])===-1&&(tt[ke].emit(Le.INTERSECT_CLEAR,this.intersectedClearedDetail),Fe.push(tt[ke]));for(Fe.length&&Oe.emit(Le.INTERSECTION_CLEAR,this.intersectionClearedDetail),ke=0;ke<st.length;ke++)st[ke].emit(Le.INTERSECT,this.intersectedDetail);ze.length&&(this.intersectionDetail.els=st,this.intersectionDetail.intersections=ze,Oe.emit(Le.INTERSECTION,this.intersectionDetail)),(tt.length===0&&$e.length>0||tt.length>0&&$e.length===0||tt.length&&$e.length&&tt[0]!==$e[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=$e,Oe.emit(Le.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),Ne.showLine&&setTimeout(this.updateLine)},updateLine:function(){var Fe=this.el,Oe=this.intersections,Ne;Oe.length&&(Oe[0].object.el===Fe&&Oe[1]?Ne=Oe[1].distance:Ne=Oe[0].distance),this.drawLine(Ne)},getIntersection:function(Fe){var Oe,Ne;for(Oe=0;Oe<this.intersections.length;Oe++)if(Ne=this.intersections[Oe],Ne.object.el===Fe)return Ne;return null},updateOriginDirection:function(){var Fe=new me.Vector3,Oe=new me.Vector3;return function(){var ke=this.el,Ve=this.data;if(Ve.useWorldCoordinates){this.raycaster.set(Ve.origin,Ve.direction);return}ke.object3D.updateMatrixWorld(),Oe.setFromMatrixPosition(ke.object3D.matrixWorld),(Ve.origin.x!==0||Ve.origin.y!==0||Ve.origin.z!==0)&&(Oe=ke.object3D.localToWorld(Oe.copy(Ve.origin))),Fe.copy(Ve.direction).transformDirection(ke.object3D.matrixWorld).normalize(),this.raycaster.set(Oe,Fe)}}(),drawLine:function(Fe){var Oe=this.data,Ne=this.el,ke;ke=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,Fe===void 0&&(Fe=Oe.far===1/0?1e3:Oe.far),this.lineData.start=Oe.origin,this.lineData.end=ke.copy(this.unitLineEndVec3).multiplyScalar(Fe).add(Oe.origin),this.lineData.color=Oe.lineColor,this.lineData.opacity=Oe.lineOpacity,Ne.setAttribute("line",this.lineData)},flattenObject3DMaps:function(Fe){var Oe,Ne,ke=this.objects,Ve=this.el.sceneEl.object3D;function Xe(st){return st.parent?Xe(st.parent):st===Ve}for(ke.length=0,Ne=0;Ne<Fe.length;Ne++){var $e=Fe[Ne];if($e.isEntity&&$e.object3D&&Xe($e.object3D))for(Oe in $e.object3DMap)ke.push($e.getObject3D(Oe))}return ke},clearAllIntersections:function(){var Fe;for(Fe=0;Fe<this.intersectedEls.length;Fe++)this.intersectedEls[Fe].emit(Le.INTERSECT_CLEAR,this.intersectedClearedDetail);xe(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(Le.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function xe(Fe,Oe){var Ne;for(Fe.length=Oe.length,Ne=0;Ne<Oe.length;Ne++)Fe[Ne]=Oe[Ne]}},"./src/components/rotation.js":(pe,Me,ve)=>{var se=ve("./src/lib/three.js").MathUtils.degToRad,me=ve("./src/core/component.js").registerComponent;pe.exports.Component=me("rotation",{schema:{type:"vec3"},update:function(){var Te=this.data,Re=this.el.object3D;Re.rotation.set(se(Te.x),se(Te.y),se(Te.z),"YXZ")},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var me=this.data,Te=this.el.object3D;Te.scale.set(me.x,me.y,me.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(pe,Me,ve)=>{var se="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",me=ve("./src/core/component.js").registerComponent,Te=ve("./src/lib/three.js"),Re=21,be=function(){var Fe=new Te.Quaternion,Oe=new Te.Vector3;function Ne(ke,Ve,Xe){Ve.position.copy(ke.transform.position),Ve.quaternion.copy(ke.transform.orientation),Oe.copy(Xe),Fe.copy(ke.transform.orientation),Oe.applyQuaternion(Fe),Ve.position.sub(Oe)}return Ne}();be.tempFakePose={transform:{orientation:new Te.Quaternion,position:new Te.Vector3}};function Pe(Fe,Oe){this.renderer=Fe,this.xrHitTestSource=null,Fe.xr.addEventListener("sessionend",(function(){this.xrHitTestSource=null}).bind(this)),Fe.xr.addEventListener("sessionstart",(function(){this.sessionStart(Oe)}).bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(Oe)}Pe.prototype.previousFrameAnchors=new Set,Pe.prototype.anchorToObject3D=new Map;function Le(Fe){console.warn(Fe.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}Pe.prototype.sessionStart=function(Oe){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){Le({message:"No requestHitTestSource on the session."});return}Oe.space?this.session.requestHitTestSource(Oe).then((function(Ne){this.xrHitTestSource=Ne}).bind(this)).catch(Le):Oe.profile&&this.session.requestHitTestSourceForTransientInput(Oe).then((function(Ne){this.xrHitTestSource=Ne,this.transient=!0}).bind(this)).catch(Le)},Pe.prototype.anchorFromLastHitTestResult=function(Fe,Oe){var Ne=this.lastHitTest;if(Ne){var ke={object3D:Fe,offset:Oe};Array.from(this.anchorToObject3D.entries()).forEach((function(Ve){var Xe=Ve[1].object3D,$e=Ve[0];Xe===Fe&&(this.anchorToObject3D.delete($e),$e.delete())}).bind(this)),Ne.createAnchor&&Ne.createAnchor().then((function(Ve){this.anchorToObject3D.set(Ve,ke)}).bind(this)).catch(function(Ve){console.warn(Ve.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},Pe.prototype.doHit=function(Oe){if(this.renderer.xr.isPresenting){var Ne=this.renderer.xr.getReferenceSpace(),ke=Oe.getViewerPose(Ne),Ve,Xe;if(this.xrHitTestSource&&ke)return this.transient?(Ve=Oe.getHitTestResultsForTransientInput(this.xrHitTestSource),Ve.length>0?(Xe=Ve[0].results,Xe.length>0?(this.lastHitTest=Xe[0],Xe[0].getPose(Ne)):!1):!1):(Ve=Oe.getHitTestResults(this.xrHitTestSource),Ve.length>0?(this.lastHitTest=Ve[0],Ve[0].getPose(Ne)):!1)}},Pe.updateAnchorPoses=function(Fe,Oe){var Ne=Fe.trackedAnchors||Pe.prototype.previousFrameAnchors;Pe.prototype.previousFrameAnchors.forEach(function(ke){Ne.has(ke)||Pe.prototype.anchorToObject3D.delete(ke)}),Ne.forEach(function(ke){var Ve,Xe,$e,st;try{Ve=Fe.getPose(ke.anchorSpace,Oe)}catch{}if(Ve){if(Xe=Pe.prototype.anchorToObject3D.get(ke),!Xe)return;$e=Xe.offset,st=Xe.object3D,be(Ve,st,$e)}})};var xe;pe.exports.Component=me("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:se,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:!0,init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new Te.OrthographicCamera,this.orthoCam.layers.set(Re),this.textureTarget=new Te.WebGLRenderTarget(512,512,{}),this.basicMaterial=new Te.MeshBasicMaterial({color:0,side:Te.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new Te.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var Fe=this.el.getAttribute("webxr"),Oe=Fe.optionalFeatures;(!Oe.includes("hit-test")||!Oe.includes("anchors"))&&(Oe.push("hit-test"),Oe.push("anchors"),this.el.setAttribute("webxr",Fe)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",(function(){this.hitTest=null}).bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",(function(){if(this.el.is("ar-mode")){var Ne=this.el.sceneEl.renderer,ke=this.session=Ne.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,xe||(xe=new Map),ke.requestReferenceSpace("viewer").then((function($e){this.hitTest=new Pe(Ne,{space:$e}),xe.set($e,this.hitTest),this.el.emit("ar-hit-test-start")}).bind(this));var Ve="generic-touchscreen",Xe=new Pe(Ne,{profile:Ve});ke.addEventListener("selectstart",(function($e){if(this.data.enabled===!0){var st=$e.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:st,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),st.profiles[0]===Ve?this.hitTest=Xe:(this.hitTest=xe.get(st)||new Pe(Ne,{space:st.targetRaySpace}),xe.set(st,this.hitTest)))}}).bind(this)),ke.addEventListener("selectend",(function($e){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var st=$e.inputSource,ze;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(ze=this.data.target.object3D,ze&&(be.tempFakePose.transform.position.copy(this.bboxMesh.position),be.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),be(be.tempFakePose,ze,this.bboxOffset),ze.visible=!0,this.hitTest.anchorFromLastHitTestResult(ze,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:st,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}).bind(this))}}).bind(this)),this.bboxOffset=new Te.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(Re),this.data.target.object3D.traverse(function(Fe){Fe.layers.enable(Re)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var Fe=new Te.PlaneGeometry(1,1),Oe=new Te.MeshBasicMaterial({transparent:!0,color:16777215});Fe.rotateX(-Math.PI/2),Fe.rotateY(-Math.PI/2),this.bbox=new Te.Box3,this.bboxMesh=new Te.Mesh(Fe,Oe),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var Fe,Oe=this.el.sceneEl.renderer,Ne,ke,Ve=Oe.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),Ne=Oe.getRenderTarget(),Oe.setRenderTarget(this.textureTarget),Oe.xr.enabled=!1,ke=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,Oe.render(this.el.object3D,this.orthoCam),this.el.object3D.background=ke,this.el.object3D.overrideMaterial=null,Oe.xr.enabled=Ve,Oe.setRenderTarget(Ne),Oe.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),Fe=this.context.getImageData(0,0,512,512);for(var Xe=0;Xe<262144;Xe++)Fe.data[Xe*4+3]!==0&&Fe.data[Xe*4+3]!==255&&(Fe.data[Xe*4+3]=128);this.context.putImageData(Fe,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var Fe,Oe=this.el.sceneEl.frame,Ne=this.el.sceneEl.renderer;if(Oe&&Pe.updateAnchorPoses(Oe,Ne.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var ke;this.textureCache.has(this.data.src)?ke=this.textureCache.get(this.data.src):(ke=new Te.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,ke)),this.bboxMesh.material.map=ke,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(Fe=this.hitTest.doHit(Oe),Fe&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(Fe.transform.position),this.bboxMesh.quaternion.copy(Fe.transform.orientation)))}})},"./src/components/scene/background.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},sceneOnly:!0,update:function(){var me=this.data,Te=this.el.object3D;me.transparent?Te.background=null:Te.background=new THREE.Color(me.color)},remove:function(){var me=this.el.object3D;me.background=null}})},"./src/components/scene/debug.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("debug",{schema:{default:!0},sceneOnly:!0})},"./src/components/scene/device-orientation-permission-ui.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/constants/index.js"),Te="a-modal",Re="a-dialog",be="a-dialog-text",Pe="a-dialog-text-container",Le="a-dialog-buttons-container",xe="a-dialog-button",Fe="a-dialog-allow-button",Oe="a-dialog-deny-button",Ne="a-dialog-ok-button";pe.exports.Component=se("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:!0,init:function(){var $e=this;if(this.data.enabled){if(window.isSecureContext||this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=this.onDeviceMotionDialogAllowClicked.bind(this),this.onDeviceMotionDialogDenyClicked=this.onDeviceMotionDialogDenyClicked.bind(this),DeviceOrientationEvent.requestPermission().then(function(){$e.el.emit("deviceorientationpermissiongranted"),$e.permissionGranted=!0}).catch(function(){$e.devicePermissionDialogEl=ke($e.data.denyButtonText,$e.data.allowButtonText,$e.data.deviceMotionMessage,$e.onDeviceMotionDialogAllowClicked,$e.onDeviceMotionDialogDenyClicked),$e.el.appendChild($e.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var $e=this,st=Ve($e.data.cancelButtonText,$e.data.httpsMessage,function(){$e.el.removeChild(st)});this.el.appendChild(st)},onDeviceMotionDialogAllowClicked:function(){var $e=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(st){st==="granted"?($e.el.emit("deviceorientationpermissiongranted"),$e.permissionGranted=!0):$e.el.emit("deviceorientationpermissionrejected"),$e.remove()}).catch(console.error)}});function ke($e,st,ze,tt,ft){var Rt,Mt,Gt;return Rt=document.createElement("div"),Rt.classList.add(Le),Mt=document.createElement("button"),Mt.classList.add(xe,Oe),Mt.setAttribute(me.AFRAME_INJECTED,""),Mt.innerHTML=$e,Rt.appendChild(Mt),Gt=document.createElement("button"),Gt.classList.add(xe,Fe),Gt.setAttribute(me.AFRAME_INJECTED,""),Gt.innerHTML=st,Rt.appendChild(Gt),Gt.addEventListener("click",function(_t){_t.stopPropagation(),tt()}),Mt.addEventListener("click",function(_t){_t.stopPropagation(),ft()}),Xe(ze,Rt)}function Ve($e,st,ze){var tt,ft;return tt=document.createElement("div"),tt.classList.add(Le),ft=document.createElement("button"),ft.classList.add(xe,Ne),ft.setAttribute(me.AFRAME_INJECTED,""),ft.innerHTML=$e,tt.appendChild(ft),ft.addEventListener("click",function(Rt){Rt.stopPropagation(),ze()}),Xe(st,tt)}function Xe($e,st){var ze,tt,ft,Rt;return ze=document.createElement("div"),ze.classList.add(Te),ze.setAttribute(me.AFRAME_INJECTED,""),tt=document.createElement("div"),tt.className=Re,tt.setAttribute(me.AFRAME_INJECTED,""),ze.appendChild(tt),ft=document.createElement("div"),ft.classList.add(Pe),tt.appendChild(ft),Rt=document.createElement("div"),Rt.classList.add(be),Rt.innerHTML=$e,ft.appendChild(Rt),tt.appendChild(st),ze}},"./src/components/scene/embedded.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},sceneOnly:!0,update:function(){var me=this.el,Te=me.querySelector(".a-enter-vr");this.data===!0?(Te&&Te.classList.add("embedded"),me.removeFullScreenStyles()):(Te&&Te.classList.remove("embedded"),me.addFullScreenStyles())}})},"./src/components/scene/fog.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/debug.js");Te("components:fog:warn"),pe.exports.Component=se("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:!0,update:function(){var be=this.data,Pe=this.el,Le=this.el.object3D.fog;if(!Le||be.type!==Le.name){Pe.object3D.fog=Re(be);return}Object.keys(this.schema).forEach(function(xe){var Fe=be[xe];xe==="color"&&(Fe=new me.Color(Fe)),Le[xe]=Fe})},remove:function(){var be=this.el,Pe=this.el.object3D.fog;Pe&&(be.object3D.fog=null)}});function Re(be){var Pe;return be.type==="exponential"?Pe=new me.FogExp2(be.color,be.density):Pe=new me.Fog(be.color,be.near,be.far),Pe.name=be.type,Pe}},"./src/components/scene/inspector.js":(pe,Me,ve)=>{var se=ve("./src/constants/index.js").AFRAME_INJECTED,me=ve("./package.json"),Te=ve("./src/core/component.js").registerComponent,Re=ve("./src/utils/index.js");function be(Oe){var Ne=Oe.split(".");return Ne[2]="x",Ne.join(".")}var Pe="https://unpkg.com/aframe-inspector@"+be(me.version)+"/dist/aframe-inspector.min.js",Le=Pe,xe="Loading Inspector",Fe="Error loading Inspector";pe.exports.Component=Te("inspector",{schema:{url:{default:Le}},sceneOnly:!0,init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var Oe;this.firstPlay&&(Oe=Re.getUrlParameter("inspector"),Oe!=="false"&&Oe&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var Oe='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=xe+Oe},remove:function(){this.removeEventListeners()},onKeydown:function(Oe){var Ne=Oe.keyCode===73&&(Oe.ctrlKey&&Oe.altKey||Oe.getModifierState("AltGraph"));Ne&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(Oe){Oe.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(Oe){var Ne=this,ke;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(Oe);return}this.showLoader(),ke=document.createElement("script"),ke.src=this.data.url,ke.setAttribute("data-name","aframe-inspector"),ke.setAttribute(se,""),ke.onload=function(){AFRAME.INSPECTOR.open(Oe),Ne.hideLoader(),Ne.removeEventListeners()},ke.onerror=function(){Ne.loadingMessageEl.innerHTML=Fe},document.head.appendChild(ke),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/index.js").shouldCaptureKeyEvent;pe.exports.Component=se("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},sceneOnly:!0,init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(Te){var Re=this.data;this.enterVREnabled=Re.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(Te){var Re=this.el;me(Te)&&(this.enterVREnabled&&Te.keyCode===70&&Re.enterVR(),this.enterVREnabled&&Te.keyCode===27&&Re.exitVR())}})},"./src/components/scene/pool.js":(pe,Me,ve)=>{var se=ve("./src/utils/debug.js"),me=ve("./src/core/component.js").registerComponent,Te=se("components:pool:warn");pe.exports.Component=me("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},sceneOnly:!0,multiple:!0,initPool:function(){var Re;for(this.availableEls=[],this.usedEls=[],this.data.mixin||Te("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||Te("Container "+this.data.container+" not found.")),this.container=this.container||this.el,Re=0;Re<this.data.size;++Re)this.createEntity()},update:function(Re){var be=this.data;(Re.mixin!==be.mixin||Re.size!==be.size)&&this.initPool()},createEntity:function(){var Re;Re=document.createElement("a-entity"),Re.play=this.wrapPlay(Re.play),Re.setAttribute("mixin",this.data.mixin),Re.object3D.visible=!1,Re.pause(),this.container.appendChild(Re),this.availableEls.push(Re);var be=this.usedEls;Re.addEventListener("loaded",function(){be.indexOf(Re)===-1&&(Re.object3DParent=Re.object3D.parent,Re.object3D.parent.remove(Re.object3D))})},wrapPlay:function(Re){var be=this.usedEls;return function(){be.indexOf(this)!==-1&&Re.call(this)}},requestEntity:function(){var Re;if(this.availableEls.length===0){if(this.data.dynamic===!1){Te("Requested entity from empty pool: "+this.attrName);return}else Te("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return Re=this.availableEls.shift(),this.usedEls.push(Re),Re.object3DParent&&(Re.object3DParent.add(Re.object3D),this.updateRaycasters()),Re.object3D.visible=!0,Re},returnEntity:function(Re){var be=this.usedEls.indexOf(Re);if(be===-1){Te("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(be,1),this.availableEls.push(Re),Re.object3DParent=Re.object3D.parent,Re.object3D.parent.remove(Re.object3D),this.updateRaycasters(),Re.object3D.visible=!1,Re.pause(),Re},updateRaycasters:function(){var Re=document.querySelectorAll("[raycaster]");Re.forEach(function(be){be.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js");pe.exports.Component=se("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},sceneOnly:!0,init:function(){var Te=this.el.getAttribute("webxr"),Re=Te.requiredFeatures;Re.indexOf("mesh-detection")===-1&&(Re.push("mesh-detection"),this.el.setAttribute("webxr",Te)),Re.indexOf("plane-detection")===-1&&(Re.push("plane-detection"),this.el.setAttribute("webxr",Te)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var Te=this.data,Re,be,Pe=this.el;Pe.renderer.xr;var Le,xe=this.meshEntities,Fe=!1,Oe=[],Ne=this.data.filterLabels;Le=Pe.frame,Re=Le.detectedMeshes,be=Le.detectedPlanes;for(var ke=0;ke<xe.length;ke++)xe[ke].present=!1;if(Te.meshesEnabled){for(var Ve of Re.values())if(!(Ne.length&&Ne.indexOf(Ve.semanticLabel)===-1)){for(ke=0;ke<xe.length;ke++)if(Ve===xe[ke].mesh){Fe=!0,xe[ke].present=!0,xe[ke].lastChangedTime<Ve.lastChangedTime&&this.updateMeshGeometry(xe[ke].el,Ve),xe[ke].lastChangedTime=Ve.lastChangedTime;break}Fe||Oe.push(Ve),Fe=!1}}if(Te.planesEnabled){for(Ve of be.values())if(!(Ne.length&&Ne.indexOf(Ve.semanticLabel)===-1)){for(ke=0;ke<xe.length;ke++)if(Ve===xe[ke].mesh){Fe=!0,xe[ke].present=!0,xe[ke].lastChangedTime<Ve.lastChangedTime&&this.updateMeshGeometry(xe[ke].el,Ve),xe[ke].lastChangedTime=Ve.lastChangedTime;break}Fe||Oe.push(Ve),Fe=!1}}this.deleteMeshes(),this.createNewMeshes(Oe)},updateMeshes:function(){var Te=new me.Matrix4;return function(){for(var Re,be=this.el,Pe,Le=be.frame,xe=this.meshEntities,Fe=be.renderer.xr.getReferenceSpace(),Oe,Ne=0;Ne<xe.length;Ne++)Oe=xe[Ne].mesh.meshSpace||xe[Ne].mesh.planeSpace,Re=Le.getPose(Oe,Fe),Pe=xe[Ne].el,Pe.hasLoaded&&(Te.fromArray(Re.transform.matrix),Te.decompose(Pe.object3D.position,Pe.object3D.quaternion,Pe.object3D.scale))}}(),deleteMeshes:function(){for(var Te=this.meshEntities,Re=[],be=0;be<Te.length;be++)Te[be].present?Re.push(Te[be]):this.el.removeChild(Te[be]);this.meshEntities=Re},createNewMeshes:function(Te){for(var Re,be=0;be<Te.length;be++)Re=document.createElement("a-entity"),this.meshEntities.push({mesh:Te[be],el:Re}),Re.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(Re)},initMeshGeometry:function(Te){var Re,be,Pe;if(Te instanceof XRPlane){be=new me.Shape,Pe=Te.polygon;for(var Le=0;Le<Pe.length;++Le)Le===0?be.moveTo(Pe[Le].x,Pe[Le].z):be.lineTo(Pe[Le].x,Pe[Le].z);return Re=new me.ShapeGeometry(be),Re.rotateX(Math.PI/2),Re}return Re=new me.BufferGeometry,Re.setAttribute("position",new me.BufferAttribute(Te.vertices,3)),Re.setIndex(new me.BufferAttribute(Te.indices,1)),Re},initWorldMeshEntity:function(Te){for(var Re=Te.target,be,Pe,Le,xe=this.meshEntities,Fe=0;Fe<xe.length;Fe++)if(xe[Fe].el===Re){Le=xe[Fe];break}be=this.initMeshGeometry(Le.mesh),Pe=new me.Mesh(be,new me.MeshBasicMaterial({color:Math.random()*16777215,side:me.DoubleSide})),Re.setObject3D("mesh",Pe),Le.mesh instanceof XRPlane&&this.data.planeMixin?Re.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&Re.setAttribute("mixin",this.data.meshMixin),Re.setAttribute("data-world-mesh",Le.mesh.semanticLabel)},updateMeshGeometry:function(Te,Re){var be=Te.getObject3D("mesh");be.geometry.dispose(),be.geometry=this.initMeshGeometry(Re)}})},"./src/components/scene/reflection.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;function me(Te,Re,be,Pe){var Le=Math.max(Te.primaryLightIntensity.x,Math.max(Te.primaryLightIntensity.y,Te.primaryLightIntensity.z));Re.sh.fromArray(Te.sphericalHarmonicsCoefficients),Re.intensity=1,be&&(be.color.setRGB(Te.primaryLightIntensity.x/Le,Te.primaryLightIntensity.y/Le,Te.primaryLightIntensity.z/Le),be.intensity=Le,Pe.copy(Te.primaryLightDirection))}pe.exports.Component=se("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:!0,init:function(){var Te=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var Re=this.el.getAttribute("webxr"),be=Re.optionalFeatures;be.includes("light-estimation")||(be.push("light-estimation"),this.el.setAttribute("webxr",Re)),this.el.addEventListener("enter-vr",function(){if(Te.el.is("ar-mode")){var Pe=Te.el.renderer,Le=Pe.xr.getSession();Le.requestLightProbe&&Te.startLightProbe()}}),this.el.addEventListener("exit-vr",function(){Te.xrLightProbe&&Te.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var Te=this.el.renderer,Re=Te.xr.getSession(),be=this,Pe=Te.getContext();if(!this.probeLight){var Le=document.createElement("a-light");Le.setAttribute("type","probe"),Le.setAttribute("intensity",0),this.el.appendChild(Le),this.probeLight=Le}switch(Re.preferredReflectionFormat){case"srgba8":Pe.getExtension("EXT_sRGB");break;case"rgba16f":Pe.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(Re,Pe),Pe.getExtension("EXT_sRGB"),Pe.getExtension("OES_texture_half_float"),Re.requestLightProbe().then(function(xe){be.xrLightProbe=xe,xe.addEventListener("reflectionchange",be.updateXRCubeMap.bind(be))}).catch(function(xe){console.warn("Lighting estimation not supported: "+xe.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var Te=this.el.renderer,Re=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(Re){var be=Te.properties.get(this.lightingEstimationTexture);be.__webglTexture=Re,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var Te=this.el.object3D,Re=this.el.renderer,be=this.el.frame;if(be&&this.xrLightProbe){var Pe=be.getLightEstimate(this.xrLightProbe);Pe&&me(Pe,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(Te.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(Re,Te),Te.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&be&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),Re=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);pe.exports.Component=se("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:!0,setup:function(){var be=this.el;if(!this.canvas){var Pe=be.renderer.getContext();Pe&&(this.cubeMapSize=Pe.getParameter(Pe.MAX_CUBE_MAP_TEXTURE_SIZE),this.material=new me.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:Te,fragmentShader:Re,side:me.DoubleSide}),this.quad=new me.Mesh(new me.PlaneGeometry(1,1),this.material),this.quad.visible=!1,this.camera=new me.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),be.object3D.add(this.quad),this.onKeyDown=this.onKeyDown.bind(this))}},getRenderTarget:function(be,Pe){return new me.WebGLRenderTarget(be,Pe,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:me.LinearFilter,magFilter:me.LinearFilter,wrapS:me.ClampToEdgeWrapping,wrapT:me.ClampToEdgeWrapping,format:me.RGBAFormat,type:me.UnsignedByteType})},resize:function(be,Pe){this.quad.scale.set(be,Pe,1),this.camera.left=-1*be/2,this.camera.right=be/2,this.camera.top=Pe/2,this.camera.bottom=-1*Pe/2,this.camera.updateProjectionMatrix(),this.canvas.width=be,this.canvas.height=Pe},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(be){var Pe=be.keyCode===83&&be.ctrlKey&&be.altKey;if(!(!this.data||!Pe)){var Le=be.shiftKey?"equirectangular":"perspective";this.capture(Le)}},setCapture:function(be){var Pe=this.el,Le,xe,Fe,Oe;return be==="perspective"?(this.quad.visible=!1,xe=this.data.camera&&this.data.camera.components.camera.camera||Pe.camera,Le={width:this.data.width,height:this.data.height}):(xe=this.camera,Oe=new me.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:me.RGBFormat,generateMipmaps:!0,minFilter:me.LinearMipmapLinearFilter,colorSpace:me.SRGBColorSpace}),Fe=new me.CubeCamera(Pe.camera.near,Pe.camera.far,Oe),Pe.camera.getWorldPosition(Fe.position),Pe.camera.getWorldQuaternion(Fe.quaternion),Fe.update(Pe.renderer,Pe.object3D),this.quad.material.uniforms.map.value=Fe.renderTarget.texture,Le={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:xe,size:Le,projection:be}},capture:function(be){var Pe=this.el.renderer.xr.enabled,Le=this.el.renderer,xe;this.setup(),Le.xr.enabled=!1,xe=this.setCapture(be),this.renderCapture(xe.camera,xe.size,xe.projection),this.saveCapture(),Le.xr.enabled=Pe},getCanvas:function(be){var Pe=this.el.renderer.xr.enabled,Le=this.el.renderer;this.setup();var xe=this.setCapture(be);return Le.xr.enabled=!1,this.renderCapture(xe.camera,xe.size,xe.projection),Le.xr.enabled=Pe,this.canvas},renderCapture:function(be,Pe,Le){var xe=this.el.renderer.autoClear,Fe=this.el,Oe,Ne,ke,Ve=Fe.renderer;Ne=this.getRenderTarget(Pe.width,Pe.height),ke=new Uint8Array(4*Pe.width*Pe.height),this.resize(Pe.width,Pe.height),Ve.autoClear=!0,Ve.clear(),Ve.setRenderTarget(Ne),Ve.render(Fe.object3D,be),Ve.autoClear=xe,Ve.readRenderTargetPixels(Ne,0,0,Pe.width,Pe.height,ke),Ve.setRenderTarget(null),Le==="perspective"&&(ke=this.flipPixelsVertically(ke,Pe.width,Pe.height)),Oe=new ImageData(new Uint8ClampedArray(ke),Pe.width,Pe.height),this.quad.visible=!1,this.ctx.putImageData(Oe,0,0)},flipPixelsVertically:function(be,Pe,Le){for(var xe=be.slice(0),Fe=0;Fe<Pe;++Fe)for(var Oe=0;Oe<Le;++Oe)xe[Fe*4+Oe*Pe*4]=be[Fe*4+(Le-Oe)*Pe*4],xe[Fe*4+1+Oe*Pe*4]=be[Fe*4+1+(Le-Oe)*Pe*4],xe[Fe*4+2+Oe*Pe*4]=be[Fe*4+2+(Le-Oe)*Pe*4],xe[Fe*4+3+Oe*Pe*4]=be[Fe*4+3+(Le-Oe)*Pe*4];return xe},saveCapture:function(){this.canvas.toBlob(function(be){var Pe="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",Le=document.createElement("a"),xe=URL.createObjectURL(be);Le.href=xe,Le.setAttribute("download",Pe),Le.innerHTML="downloading...",Le.style.display="none",document.body.appendChild(Le),setTimeout(function(){Le.click(),document.body.removeChild(Le)},1)},"image/png")}})},"./src/components/scene/stats.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./vendor/rStats.js"),Te=ve("./src/utils/index.js");ve("./vendor/rStats.extras.js"),ve("./src/lib/rStatsAframe.js");var Re=window.aframeStats,be="a-hidden",Pe=window.threeStats;pe.exports.Component=se("stats",{schema:{default:!0},sceneOnly:!0,init:function(){var xe=this.el;Te.getUrlParameter("stats")!=="false"&&(this.stats=Le(xe),this.statsEl=document.querySelector(".rs-base"),this.hideBound=this.hide.bind(this),this.showBound=this.show.bind(this),xe.addEventListener("enter-vr",this.hideBound),xe.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var xe=this.stats;xe&&(xe("rAF").tick(),xe("FPS").frame(),xe().update())},hide:function(){this.statsEl.classList.add(be)},show:function(){this.statsEl.classList.remove(be)}});function Le(xe){var Fe=new Pe(xe.renderer),Oe=new Re(xe),Ne=xe.isMobile?[]:[Fe,Oe];return new me({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:Ne})}},"./src/components/scene/xr-mode-ui.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/constants/index.js"),Te=ve("./src/utils/index.js"),Re="a-enter-vr",be="a-enter-ar",Pe="a-enter-vr-button",Le="a-enter-ar-button",xe="a-hidden",Fe="a-orientation-modal";pe.exports.Component=se("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:!0,init:function(){var Xe=this,$e=this.el;Te.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),$e.addEventListener("enter-vr",this.updateEnterInterfaces),$e.addEventListener("exit-vr",this.updateEnterInterfaces),$e.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(st){st.data.type==="loaderReady"&&(Xe.insideLoader=!0,Xe.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=this.onEnterVRButtonClick.bind(this),this.onEnterARButtonClick=this.onEnterARButtonClick.bind(this),this.onModalClick=this.onModalClick.bind(this),this.toggleOrientationModalIfNeeded=this.toggleOrientationModalIfNeeded.bind(this),this.updateEnterInterfaces=this.updateEnterInterfaces.bind(this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var Xe=this.data,$e=this.el;if(!Xe.enabled||this.insideLoader||Te.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&Xe.enterVREnabled&&(Xe.XRMode==="xr"||Xe.XRMode==="vr")&&(Xe.enterVRButton?(this.enterVREl=document.querySelector(Xe.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=Oe(this.onEnterVRButtonClick),$e.appendChild(this.enterVREl))),!this.enterAREl&&Xe.enterAREnabled&&(Xe.XRMode==="xr"||Xe.XRMode==="ar")&&(Xe.enterARButton?(this.enterAREl=document.querySelector(Xe.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=Ne(this.onEnterARButtonClick,Xe.XRMode==="xr"),$e.appendChild(this.enterAREl))),this.orientationModalEl=ke(this.onModalClick),$e.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(Xe){Xe&&Xe.parentNode&&Xe.parentNode.removeChild(Xe)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var Xe=this.el;this.enterVREl&&(Xe.is("vr-mode")||(Xe.isMobile||Te.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!Te.device.checkVRSupport()?this.enterVREl.classList.add(xe):(Te.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(xe),Xe.enterVR(!1,!0)))},toggleEnterARButtonIfNeeded:function(){var Xe=this.el;this.enterAREl&&(Xe.is("vr-mode")||!Te.device.checkARSupport()?this.enterAREl.classList.add(xe):(this.enterAREl.classList.remove(xe),Xe.enterVR(!0,!0)))},toggleOrientationModalIfNeeded:function(){var Xe=this.el,$e=this.orientationModalEl;!$e||!Xe.isMobile||(!Te.device.isLandscape()&&Xe.is("vr-mode")?$e.classList.remove(xe):$e.classList.add(xe))}});function Oe(Xe){var $e,st;return st=document.createElement("div"),st.classList.add(Re),st.setAttribute(me.AFRAME_INJECTED,""),$e=document.createElement("button"),$e.className=Pe,$e.setAttribute("title","Enter VR mode with a headset or fullscreen without"),$e.setAttribute(me.AFRAME_INJECTED,""),Te.device.isMobile()&&Ve($e),st.appendChild($e),$e.addEventListener("click",function(ze){Xe(),ze.stopPropagation()}),st}function Ne(Xe,$e){var st,ze;return ze=document.createElement("div"),ze.classList.add(be),$e&&ze.classList.add("xr"),ze.setAttribute(me.AFRAME_INJECTED,""),st=document.createElement("button"),st.className=Le,st.setAttribute("title","Enter AR mode with a headset or handheld device."),st.setAttribute(me.AFRAME_INJECTED,""),Te.device.isMobile()&&Ve(st),ze.appendChild(st),st.addEventListener("click",function(tt){Xe(),tt.stopPropagation()}),ze}function ke(Xe){var $e=document.createElement("div");$e.className=Fe,$e.classList.add(xe),$e.setAttribute(me.AFRAME_INJECTED,"");var st=document.createElement("button");return st.setAttribute(me.AFRAME_INJECTED,""),st.innerHTML="Exit VR",st.addEventListener("click",Xe),$e.appendChild(st),$e}function Ve(Xe){Xe.addEventListener("touchstart",function(){Xe.classList.remove("resethover")},{passive:!0}),Xe.addEventListener("touchend",function(){Xe.classList.add("resethover")},{passive:!0})}},"./src/components/shadow.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js"),me=ve("./src/lib/three.js"),Te=se.registerComponent;pe.exports.Component=Te("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=this.update.bind(this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var Re=this.data;this.updateDescendants(Re.cast,Re.receive)},remove:function(){var Re=this.el;Re.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(Re,be){var Pe=this.el.sceneEl;this.el.object3D.traverse(function(Le){if(Le instanceof me.Mesh&&(Le.castShadow=Re,Le.receiveShadow=be,Pe.hasLoaded&&Le.material))for(var xe=Array.isArray(Le.material)?Le.material:[Le.material],Fe=0;Fe<xe.length;Fe++)xe[Fe].needsUpdate=!0})}})},"./src/components/sound.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/debug.js"),Te=ve("./src/lib/three.js"),Re=me("components:sound:warn");pe.exports.Component=se("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var be=this;this.listener=null,this.audioLoader=new Te.AudioLoader,this.pool=new Te.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){be.playSound()}},update:function(be){var Pe=this.data,Le,xe,Fe=Pe.src!==be.src;if(Fe){if(!Pe.src)return;this.setupSound()}for(Le=0;Le<this.pool.children.length;Le++)xe=this.pool.children[Le],Pe.positional&&(xe.setDistanceModel(Pe.distanceModel),xe.setMaxDistance(Pe.maxDistance),xe.setRefDistance(Pe.refDistance),xe.setRolloffFactor(Pe.rolloffFactor)),xe.setLoop(Pe.loop),xe.setLoopStart(Pe.loopStart),Pe.loopStart!==0&&Pe.loopEnd===0?xe.setLoopEnd(xe.buffer.duration):xe.setLoopEnd(Pe.loopEnd),xe.setVolume(Pe.volume),xe.isPaused=!1;if(Pe.on!==be.on&&this.updateEventListener(be.on),Fe){var Oe=this;this.loaded=!1,this.audioLoader.load(Pe.src,function(Ne){for(Le=0;Le<Oe.pool.children.length;Le++)xe=Oe.pool.children[Le],xe.setBuffer(Ne);Oe.loaded=!0,Te.Cache.remove(Pe.src),(Oe.data.autoplay||Oe.mustPlay)&&Oe.playSound(Oe.processSound),Oe.el.emit("sound-loaded",Oe.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var be,Pe;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(be=0;be<this.pool.children.length;be++)Pe=this.pool.children[be],Pe.disconnect()}catch{Re("Audio source not properly disconnected")}},updateEventListener:function(be){var Pe=this.el;be&&Pe.removeEventListener(be,this.playSoundBound),Pe.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var be=this.el,Pe,Le=be.sceneEl,xe=this,Fe;this.pool.children.length>0&&(this.stopSound(),be.removeObject3D("sound"));var Oe=this.listener=Le.audioListener||new Te.AudioListener;for(Le.audioListener=Oe,Le.camera&&Le.camera.add(Oe),Le.addEventListener("camera-set-active",function(Ne){Ne.detail.cameraEl.getObject3D("camera").add(Oe)}),this.pool=new Te.Group,Pe=0;Pe<this.data.poolSize;Pe++)Fe=this.data.positional?new Te.PositionalAudio(Oe):new Te.Audio(Oe),this.pool.add(Fe);for(be.setObject3D(this.attrName,this.pool),Pe=0;Pe<this.pool.children.length;Pe++)Fe=this.pool.children[Pe],Fe.onEnded=function(){this.isPlaying=!1,xe.el.emit("sound-ended",xe.evtDetail,!1)}},pauseSound:function(){var be,Pe;for(this.isPlaying=!1,be=0;be<this.pool.children.length;be++)Pe=this.pool.children[be],!(!Pe.source||!Pe.source.buffer||!Pe.isPlaying||Pe.isPaused)&&(Pe.isPaused=!0,Pe.pause())},playSound:function(be){var Pe,Le,xe;if(!this.loaded){Re("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=be;return}for(Pe=!1,this.isPlaying=!0,Le=0;Le<this.pool.children.length;Le++)if(xe=this.pool.children[Le],!xe.isPlaying&&xe.buffer&&!Pe){be&&be(xe),xe.play(),xe.isPaused=!1,Pe=!0;continue}if(!Pe){Re("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var be,Pe;for(this.isPlaying=!1,be=0;be<this.pool.children.length;be++){if(Pe=this.pool.children[be],!Pe.source||!Pe.source.buffer)return;Pe.stop()}}})},"./src/components/text.js":(pe,Me,ve)=>{var se=ve("./node_modules/three-bmfont-text/index.js"),me=ve("./node_modules/load-bmfont/browser.js"),Te=ve("./src/core/component.js").registerComponent,Re=ve("./src/core/shader.js"),be=ve("./src/lib/three.js"),Pe=ve("./src/utils/index.js"),Le=Pe.debug("components:text:error"),xe=Re.shaders,Fe=Pe.debug("components:text:warn"),Oe=1,Ne=16,ke=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Ve=ke+"fonts/",Xe={aileronsemibold:Ve+"Aileron-Semibold.fnt",dejavu:Ve+"DejaVu-sdf.fnt",exo2bold:Ve+"Exo2Bold.fnt",exo2semibold:Ve+"Exo2SemiBold.fnt",kelsonsans:Ve+"KelsonSans.fnt",monoid:Ve+"Monoid.fnt",mozillavr:Ve+"mozillavr.fnt",roboto:Ve+"Roboto-msdf.json",sourcecodepro:Ve+"SourceCodePro.fnt"},$e=["roboto"],st="roboto";pe.exports.FONTS=Xe;var ze=new Ut,tt={},ft={},Rt=/^\w+:/;pe.exports.Component=Te("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:st},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:xe},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=se(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(Tt){var Xt=this.data,hn=this.currentFont;if(ft[Xt.font]?this.texture=ft[Xt.font]:(this.texture=ft[Xt.font]=new be.Texture,this.texture.anisotropy=Ne),this.createOrUpdateMaterial(),Tt.font!==Xt.font){this.updateFont();return}hn&&(this.updateGeometry(this.geometry,hn),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var Tt=this.data,Xt,hn=this.material,nn,An=this.shaderData,Cn;if(Cn=Tt.shader,$e.indexOf(Tt.font)!==-1||Tt.font.indexOf("-msdf.")>=0?Cn="msdf":Tt.font in Xe&&$e.indexOf(Tt.font)===-1&&(Cn="sdf"),Xt=(this.shaderObject&&this.shaderObject.name)!==Cn,An.alphaTest=Tt.alphaTest,An.color=Tt.color,An.map=this.texture,An.opacity=Tt.opacity,An.side=Mt(Tt.side),An.transparent=Tt.transparent,An.negate=Tt.negate,!Xt){this.shaderObject.update(An),hn.transparent=An.transparent,hn.side=An.side;return}nn=Bt(this.el,Cn,An),this.material=nn.material,this.shaderObject=nn.shader,this.material.side=An.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var Tt=this.data,Xt=this.el,hn,nn=this.geometry,An=this;Tt.font||Fe("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),hn=this.lookupFont(Tt.font||st)||Tt.font,ze.get(hn,function(){return Gt(hn,Tt.yOffset)}).then(function(Nn){var Qn;if(Nn.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");tt[hn]||(Nn.widthFactor=tt[Nn]=ut(Nn)),An.currentFont=Nn,Qn=An.getFontImageSrc(),ze.get(Qn,function(){return _t(Qn)}).then(function(fi){var hi=An.texture;hi&&(hi.image=fi,hi.needsUpdate=!0,ft[Tt.font]=hi,An.texture=hi,An.initMesh(),An.currentFont=Nn,An.updateGeometry(nn,Nn),An.updateLayout(),An.mesh.visible=!0,Xt.emit("textfontset",{font:Tt.font,fontObj:Nn}))}).catch(function(fi){Le(fi.message),Le(fi.stack)})}).catch(function(Cn){Le(Cn.message),Le(Cn.stack)})},initMesh:function(){this.mesh||(this.mesh=new be.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var Tt=this.lookupFont(this.data.font||st)||this.data.font,Xt=this.currentFont.pages[0];return Xt.match(Rt)&&Xt.indexOf("http")!==0?Tt.replace(/(\.fnt)|(\.json)/,".png"):be.LoaderUtils.extractUrlBase(Tt)+Xt},updateLayout:function(){var Tt,Xt,hn=this.el,nn=this.data,An=this.geometry,Cn,Nn,Qn,fi=this.mesh,hi,Qi,Zi,Mn,Vr;if(!(!fi||!An.layout)){if(Cn=hn.getAttribute("geometry"),Zi=nn.width||Cn&&Cn.width||Oe,hi=dt(nn.wrapPixels,nn.wrapCount,this.currentFont.widthFactor),Qi=Zi/hi,Qn=An.layout,Nn=Qi*(Qn.height+Qn.descender),Cn&&Cn.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!Cn.width,this.hasExplicitGeoHeight=!!Cn.height),this.hasExplicitGeoWidth||hn.setAttribute("geometry","width",Zi),this.hasExplicitGeoHeight||hn.setAttribute("geometry","height",Nn)),Tt=nn.anchor==="align"?nn.align:nn.anchor,Tt==="left")Mn=0;else if(Tt==="right")Mn=-1*Qn.width;else if(Tt==="center")Mn=-1*Qn.width/2;else throw new TypeError("Invalid text.anchor property value",Tt);if(Xt=nn.baseline,Xt==="bottom")Vr=0;else if(Xt==="top")Vr=-1*Qn.height+Qn.ascender;else if(Xt==="center")Vr=-1*Qn.height/2;else throw new TypeError("Invalid text.baseline property value",Xt);fi.position.x=Mn*Qi+nn.xOffset,fi.position.y=Vr*Qi,fi.position.z=nn.zOffset,fi.scale.set(Qi,-1*Qi,Qi)}},lookupFont:function(Tt){return Xe[Tt]},updateGeometry:function(){var Tt={},Xt={},hn=/\\n/g,nn=/\\t/g;return function(An,Cn){var Nn=this.data;Xt.font=Cn,Xt.lineHeight=Nn.lineHeight&&isFinite(Nn.lineHeight)?Nn.lineHeight:Cn.common.lineHeight,Xt.text=Nn.value.toString().replace(hn,`
`).replace(nn,"	"),Xt.width=dt(Nn.wrapPixels,Nn.wrapCount,Cn.widthFactor),An.update(Pe.extend(Tt,Nn,Xt))}}()});function Mt(Tt){switch(Tt){case"back":return be.FrontSide;case"double":return be.DoubleSide;default:return be.BackSide}}function Gt(Tt,Xt){return new Promise(function(hn,nn){me(Tt,function(An,Cn){if(An){Le("Error loading font",Tt),nn(An);return}Tt.indexOf("/Roboto-msdf.json")>=0&&(Xt=30),Xt&&Cn.chars.map(function(Qn){Qn.yoffset+=Xt}),hn(Cn)})})}function _t(Tt){return new Promise(function(Xt,hn){new be.ImageLoader().load(Tt,function(nn){Xt(nn)},void 0,function(){Le("Error loading font image",Tt),hn(null)})})}function Bt(Tt,Xt,hn){var nn,An;return An=new xe[Xt].Shader,An.el=Tt,An.init(hn),An.update(hn),nn=An.material,nn.transparent=hn.transparent,{material:nn,shader:An}}function dt(Tt,Xt,hn){return Tt||(.5+Xt)*hn}function ut(Tt){var Xt=0,hn=0,nn=0;return Tt.chars.map(function(An){Xt+=An.xadvance,An.id>=48&&An.id<=57&&(nn++,hn+=An.xadvance)}),nn?hn/nn:Xt/Tt.chars.length}function Ut(){var Tt=this.cache={};this.get=function(Xt,hn){return Xt in Tt||(Tt[Xt]=hn()),Tt[Xt]}}},"./src/components/tracked-controls-webvr.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=ve("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,Re=ve("./src/lib/three.js"),be=ve("./src/constants/index.js").DEFAULT_HANDEDNESS,Pe={x:.175,y:-.3,z:-.03},Le={x:0,y:0,z:-.175},xe={touches:[]},Fe={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};pe.exports.Component=se("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new Re.Vector3,this.controllerQuaternion=new Re.Quaternion,this.controllerEuler=new Re.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(Oe,Ne){var ke=this.el.getObject3D("mesh");ke&&ke.update&&ke.update(Ne/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return Te},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var Oe=this.data,Ne=me.findMatchingControllerWebVR(this.system.controllers,Oe.id,Oe.idPrefix,Oe.hand,Oe.controller);this.controller=Ne,this.el.components["tracked-controls"].controller=Ne,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(Oe){var Ne=this.controller,ke=this.controllerEuler,Ve=this.controllerQuaternion,Xe=this.deltaControllerPosition,$e,st,ze,tt,ft;st=this.getHeadElement(),ze=st.object3D,ft=this.defaultUserHeight(),tt=Ne.pose,$e=(Ne?Ne.hand:void 0)||be,Oe.copy(ze.position),Xe.set(Pe.x*($e==="left"?-1:$e==="right"?1:0),Pe.y,Pe.z),Xe.multiplyScalar(ft),Xe.applyAxisAngle(ze.up,ze.rotation.y),Oe.add(Xe),Xe.set(Le.x,Le.y,Le.z),Xe.multiplyScalar(ft),tt.orientation?Ve.fromArray(tt.orientation):Ve.copy(ze.quaternion),ke.setFromQuaternion(Ve),ke.set(ke.x,ke.y,0),Xe.applyEuler(ke),Oe.add(Xe)},updatePose:function(){var Oe=this.controller,Ne=this.data,ke=this.el.object3D,Ve,Xe=this.system.vrDisplay,$e;Oe&&(Ve=Oe.pose,Ve.position?ke.position.fromArray(Ve.position):Ne.armModel&&this.applyArmModel(ke.position),Ve.orientation&&ke.quaternion.fromArray(Ve.orientation),Xe&&Ve.position&&($e=this.el.sceneEl.renderer.xr.getStandingMatrix(),ke.matrix.compose(ke.position,ke.quaternion,ke.scale),ke.matrix.multiplyMatrices($e,ke.matrix),ke.matrix.decompose(ke.position,ke.quaternion,ke.scale)),ke.rotateX(this.data.orientationOffset.x*Re.MathUtils.DEG2RAD),ke.rotateY(this.data.orientationOffset.y*Re.MathUtils.DEG2RAD),ke.rotateZ(this.data.orientationOffset.z*Re.MathUtils.DEG2RAD))},updateButtons:function(){var Oe,Ne=this.controller,ke;if(Ne){for(ke=0;ke<Ne.buttons.length;++ke)this.buttonStates[ke]||(this.buttonStates[ke]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[ke]||(this.buttonEventDetails[ke]={id:ke,state:this.buttonStates[ke]}),Oe=Ne.buttons[ke],this.handleButton(ke,Oe);this.handleAxes()}},handleButton:function(Oe,Ne){var ke;return ke=this.handlePress(Oe,Ne)|this.handleTouch(Oe,Ne)|this.handleValue(Oe,Ne),ke?(this.el.emit(Fe.BUTTONCHANGED,this.buttonEventDetails[Oe],!1),!0):!1},handleAxes:function(){var Oe=!1,Ne=this.controller.axes,ke,Ve=this.axis,Xe=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),ke=0;ke<Ne.length;++ke)Xe.push(Ve[ke]!==Ne[ke]),Xe[ke]&&(Oe=!0);if(!Oe)return!1;for(this.axis.splice(0,this.axis.length),ke=0;ke<Ne.length;ke++)this.axis.push(Ne[ke]);return this.el.emit(Fe.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(Oe,Ne){var ke,Ve=this.buttonStates[Oe];return Ne.pressed===Ve.pressed?!1:(ke=Ne.pressed?Fe.BUTTONDOWN:Fe.BUTTONUP,this.el.emit(ke,this.buttonEventDetails[Oe],!1),Ve.pressed=Ne.pressed,!0)},handleTouch:function(Oe,Ne){var ke,Ve=this.buttonStates[Oe];return Ne.touched===Ve.touched?!1:(ke=Ne.touched?Fe.TOUCHSTART:Fe.TOUCHEND,this.el.emit(ke,this.buttonEventDetails[Oe],!1,xe),Ve.touched=Ne.touched,!0)},handleValue:function(Oe,Ne){var ke=this.buttonStates[Oe];return Ne.value===ke.value?!1:(ke.value=Ne.value,!0)}})},"./src/components/tracked-controls-webxr.js":(pe,Me,ve)=>{var se=ve("./src/utils/tracked-controls.js"),me=ve("./src/core/component.js").registerComponent,Te={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};pe.exports.Component=me("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var Re=this.el.sceneEl;this.updateController(),Re.addEventListener("controllersupdated",this.updateController)},pause:function(){var Re=this.el.sceneEl;Re.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(Re){return!(!this.controller||this.controller.gamepad||Re.inputSource.handedness!=="none"&&Re.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=se.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var Re=this.el.sceneEl,be=this.controller,Pe=Re.frame;!be||!Re.frame||!this.system.referenceSpace||be.hand||(this.pose=Pe.getPose(be[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var Re=this.el.object3D,be=this.pose;be&&(Re.matrix.elements=be.transform.matrix,Re.matrix.decompose(Re.position,Re.rotation,Re.scale))},updateButtons:function(){var Re,be,Pe=this.controller,Le;if(!(!Pe||!Pe.gamepad)){for(Le=Pe.gamepad,be=0;be<Le.buttons.length;++be)this.buttonStates[be]||(this.buttonStates[be]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[be]||(this.buttonEventDetails[be]={id:be,state:this.buttonStates[be]}),Re=Le.buttons[be],this.handleButton(be,Re);this.handleAxes()}},handleButton:function(Re,be){var Pe;return Pe=this.handlePress(Re,be)|this.handleTouch(Re,be)|this.handleValue(Re,be),Pe?(this.el.emit(Te.BUTTONCHANGED,this.buttonEventDetails[Re],!1),!0):!1},handleAxes:function(){var Re=!1,be=this.controller.gamepad.axes,Pe,Le=this.axis,xe=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),Pe=0;Pe<be.length;++Pe)xe.push(Le[Pe]!==be[Pe]),xe[Pe]&&(Re=!0);if(!Re)return!1;for(this.axis.splice(0,this.axis.length),Pe=0;Pe<be.length;Pe++)this.axis.push(be[Pe]);return this.el.emit(Te.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(Re,be){var Pe,Le=this.buttonStates[Re];return be.pressed===Le.pressed?!1:(Pe=be.pressed?Te.BUTTONDOWN:Te.BUTTONUP,this.el.emit(Pe,this.buttonEventDetails[Re],!1),Le.pressed=be.pressed,!0)},handleTouch:function(Re,be){var Pe,Le=this.buttonStates[Re];return be.touched===Le.touched?!1:(Pe=be.touched?Te.TOUCHSTART:Te.TOUCHEND,this.el.emit(Pe,this.buttonEventDetails[Re],!1),Le.touched=be.touched,!0)},handleValue:function(Re,be){var Pe=this.buttonStates[Re];return be.value===Pe.value?!1:(Pe.value=be.value,!0)}})},"./src/components/tracked-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},after:["tracked-controls-webvr","tracked-controls-webxr"],update:function(){var me=this.data,Te=this.el;Te.sceneEl.hasWebXR?Te.setAttribute("tracked-controls-webxr",{id:me.id,hand:me.hand,index:me.controller,iterateControllerProfiles:me.iterateControllerProfiles,handTrackingEnabled:me.handTrackingEnabled,space:me.space}):Te.setAttribute("tracked-controls-webvr",me)}})},"./src/components/valve-index-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=ve("./src/utils/tracked-controls.js"),Re=Te.checkControllerPresentAndSetup,be=Te.emitIfAxesChanged,Pe=Te.onButtonEvent,Le=ve("./src/constants/index.js").AFRAME_CDN_ROOT,xe=Le+"controllers/valve/index/valve-index-",Fe={left:xe+"left.glb",right:xe+"right.glb"},Oe="valve",Ne=ve("./src/utils/index.js").device.isWebXRAvailable,ke={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},Ve={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},Xe={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},$e={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},st=Ne?$e:Xe,ze=Ne?Ve:ke;pe.exports.Component=se("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var tt=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(ft){Pe(ft.detail.id,"down",tt)},this.onButtonUp=function(ft){Pe(ft.detail.id,"up",tt)},this.onButtonTouchEnd=function(ft){Pe(ft.detail.id,"touchend",tt)},this.onButtonTouchStart=function(ft){Pe(ft.detail.id,"touchstart",tt)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var tt=this.el;tt.addEventListener("buttonchanged",this.onButtonChanged),tt.addEventListener("buttondown",this.onButtonDown),tt.addEventListener("buttonup",this.onButtonUp),tt.addEventListener("touchend",this.onButtonTouchEnd),tt.addEventListener("touchstart",this.onButtonTouchStart),tt.addEventListener("model-loaded",this.onModelLoaded),tt.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var tt=this.el;tt.removeEventListener("buttonchanged",this.onButtonChanged),tt.removeEventListener("buttondown",this.onButtonDown),tt.removeEventListener("buttonup",this.onButtonUp),tt.removeEventListener("touchend",this.onButtonTouchEnd),tt.removeEventListener("touchstart",this.onButtonTouchStart),tt.removeEventListener("model-loaded",this.onModelLoaded),tt.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var tt=this.data,ft=tt.hand==="right"?0:tt.hand==="left"?1:2;Re(this,Oe,{index:ft,iterateControllerProfiles:!0,hand:tt.hand})},injectTrackedControls:function(){var tt=this.el,ft=this.data;tt.setAttribute("tracked-controls",{idPrefix:Oe,controller:ft.hand==="right"?1:ft.hand==="left"?0:2,hand:ft.hand,orientationOffset:ft.orientationOffset}),this.loadModel()},loadModel:function(){var tt=this.data;tt.model&&this.el.setAttribute("gltf-model",""+Fe[tt.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(tt){var ft=this.mapping.buttons[tt.detail.id],Rt=this.buttonMeshes,Mt;ft&&(ft==="trigger"&&(Mt=tt.detail.state.value,Rt&&Rt.trigger&&(Rt.trigger.rotation.x=this.triggerOriginalRotationX-Mt*(Math.PI/40))),this.el.emit(ft+"changed",tt.detail.state))},onModelLoaded:function(tt){var ft,Rt=tt.detail.model,Mt=this;tt.target!==this.el||!this.data.model||(ft=this.buttonMeshes={},ft.grip={left:Rt.getObjectByName("leftgrip"),right:Rt.getObjectByName("rightgrip")},ft.menu=Rt.getObjectByName("menubutton"),ft.system=Rt.getObjectByName("systembutton"),ft.trackpad=Rt.getObjectByName("touchpad"),ft.trigger=Rt.getObjectByName("trigger"),this.triggerOriginalRotationX=ft.trigger.rotation.x,Object.keys(ft).forEach(function(Gt){Mt.setButtonColor(Gt,Mt.data.buttonColor)}),Rt.position.copy(ze[this.data.hand]),Rt.rotation.copy(st[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controls",model:this.data.model,rayOrigin:new me.Vector3(0,0,0)}))},onAxisMoved:function(tt){be(this,this.mapping.axes,tt)},updateModel:function(tt,ft){var Rt,Mt;this.data.model&&(Mt=ft.indexOf("touch")!==-1,!Mt&&(Rt=ft==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(tt,Rt)))},setButtonColor:function(tt,ft){}})},"./src/components/visible.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent;pe.exports.Component=se("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=me.checkControllerPresentAndSetup,Re=me.emitIfAxesChanged,be=me.onButtonEvent,Pe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Le=Pe+"controllers/vive/vr_controller_vive.obj",xe=Pe+"controllers/vive/vr_controller_vive.mtl",Fe=ve("./src/utils/index.js").device.isWebXRAvailable,Oe="htc-vive",Ne="OpenVR ",ke=Fe?Oe:Ne,Ve={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},Xe={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]},$e=Fe?Xe:Ve;pe.exports.Component=se("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:$e,init:function(){var st=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(ze){be(ze.detail.id,"down",st)},this.onButtonUp=function(ze){be(ze.detail.id,"up",st)},this.onButtonTouchEnd=function(ze){be(ze.detail.id,"touchend",st)},this.onButtonTouchStart=function(ze){be(ze.detail.id,"touchstart",st)},this.previousButtonValues={},this.bindMethods()},update:function(){var st=this.data;this.controllerIndex=st.hand==="right"?0:st.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var st=this.el;st.addEventListener("buttonchanged",this.onButtonChanged),st.addEventListener("buttondown",this.onButtonDown),st.addEventListener("buttonup",this.onButtonUp),st.addEventListener("touchend",this.onButtonTouchEnd),st.addEventListener("touchstart",this.onButtonTouchStart),st.addEventListener("model-loaded",this.onModelLoaded),st.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var st=this.el;st.removeEventListener("buttonchanged",this.onButtonChanged),st.removeEventListener("buttondown",this.onButtonDown),st.removeEventListener("buttonup",this.onButtonUp),st.removeEventListener("touchend",this.onButtonTouchEnd),st.removeEventListener("touchstart",this.onButtonTouchStart),st.removeEventListener("model-loaded",this.onModelLoaded),st.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var st=this.data;Te(this,ke,{index:this.controllerIndex,hand:st.hand})},injectTrackedControls:function(){var st=this.el,ze=this.data;st.setAttribute("tracked-controls",{idPrefix:ke,hand:ze.hand,controller:this.controllerIndex,orientationOffset:ze.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:Le,mtl:xe})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(st){var ze=this.mapping.buttons[st.detail.id],tt=this.buttonMeshes,ft;ze&&(ze==="trigger"&&(ft=st.detail.state.value,tt&&tt.trigger&&(tt.trigger.rotation.x=-ft*(Math.PI/12))),this.el.emit(ze+"changed",st.detail.state))},onModelLoaded:function(st){var ze,tt=st.detail.model,ft=this;st.target!==this.el||!this.data.model||(ze=this.buttonMeshes={},ze.grip={left:tt.getObjectByName("leftgrip"),right:tt.getObjectByName("rightgrip")},ze.menu=tt.getObjectByName("menubutton"),ze.system=tt.getObjectByName("systembutton"),ze.trackpad=tt.getObjectByName("touchpad"),ze.touchpad=tt.getObjectByName("touchpad"),ze.trigger=tt.getObjectByName("trigger"),Object.keys(ze).forEach(function(Rt){ft.setButtonColor(Rt,ft.data.buttonColor)}),tt.position.set(0,-.015,.04))},onAxisMoved:function(st){Re(this,this.mapping.axes,st)},updateModel:function(st,ze){var tt,ft;this.data.model&&(ft=ze.indexOf("touch")!==-1,!ft&&(tt=ze==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(st,tt)))},setButtonColor:function(st,ze){var tt=this.buttonMeshes;if(tt){if(st==="grip"){tt.grip.left.material.color.set(ze),tt.grip.right.material.color.set(ze);return}tt[st].material.color.set(ze)}}})},"./src/components/vive-focus-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=me.checkControllerPresentAndSetup,Re=me.emitIfAxesChanged,be=me.onButtonEvent,Pe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Le=Pe+"controllers/vive/focus-controller/focus-controller.gltf",xe=ve("./src/utils/index.js").device.isWebXRAvailable,Fe="htc-vive-focus",Oe="HTC Vive Focus ",Ne=xe?Fe:Oe,ke={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},Ve={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},Xe=xe?Ve:ke;pe.exports.Component=se("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},after:["tracked-controls"],mapping:Xe,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var $e=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(st){be(st.detail.id,"down",$e)},this.onButtonUp=function(st){be(st.detail.id,"up",$e)},this.onButtonTouchStart=function(st){be(st.detail.id,"touchstart",$e)},this.onButtonTouchEnd=function(st){be(st.detail.id,"touchend",$e)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var $e=this.el;$e.addEventListener("buttonchanged",this.onButtonChanged),$e.addEventListener("buttondown",this.onButtonDown),$e.addEventListener("buttonup",this.onButtonUp),$e.addEventListener("touchstart",this.onButtonTouchStart),$e.addEventListener("touchend",this.onButtonTouchEnd),$e.addEventListener("model-loaded",this.onModelLoaded),$e.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var $e=this.el;$e.removeEventListener("buttonchanged",this.onButtonChanged),$e.removeEventListener("buttondown",this.onButtonDown),$e.removeEventListener("buttonup",this.onButtonUp),$e.removeEventListener("touchstart",this.onButtonTouchStart),$e.removeEventListener("touchend",this.onButtonTouchEnd),$e.removeEventListener("model-loaded",this.onModelLoaded),$e.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){Te(this,Ne,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var $e=this.el,st=this.data;$e.setAttribute("tracked-controls",{armModel:st.armModel,idPrefix:Ne,orientationOffset:st.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",Le)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function($e){var st=$e.detail.model,ze;$e.target!==this.el||!this.data.model||(ze=this.buttonMeshes={},ze.trigger=st.getObjectByName("BumperKey"),ze.triggerPressed=st.getObjectByName("BumperKey_Press"),ze.triggerPressed&&(ze.triggerPressed.visible=!1),ze.trackpad=st.getObjectByName("TouchPad"),ze.trackpadPressed=st.getObjectByName("TouchPad_Press"),ze.trackpadPressed&&(ze.trackpadPressed.visible=!1))},onButtonChanged:function($e){var st=this.mapping.buttons[$e.detail.id];st&&this.el.emit(st+"changed",$e.detail.state)},onAxisMoved:function($e){Re(this,this.mapping.axes,$e)},updateModel:function($e,st){this.data.model&&this.updateButtonModel($e,st)},updateButtonModel:function($e,st){var ze=this.buttonMeshes,tt=$e+"Pressed";if(!(!ze||!ze[$e]||!ze[tt])){var ft;switch(st){case"down":ft=this.data.buttonHighlightColor;break;case"touchstart":ft=this.data.buttonTouchedColor;break}ft&&ze[tt].material.color.set(ft),ze[tt].visible=!!ft,ze[$e].visible=!ft}}})},"./src/components/wasd-controls.js":(pe,Me,ve)=>{var se=ve("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,me=ve("./src/core/component.js").registerComponent,Te=ve("./src/lib/three.js"),Re=ve("./src/utils/index.js"),be=Re.shouldCaptureKeyEvent,Pe=1e-5,Le=.2,xe=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];pe.exports.Component=me("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},after:["look-controls"],init:function(){this.keys={},this.easing=1.1,this.velocity=new Te.Vector3,this.onBlur=this.onBlur.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.attachVisibilityEventListeners()},tick:function(Oe,Ne){var ke=this.data,Ve=this.el,Xe=this.velocity;!Xe[ke.adAxis]&&!Xe[ke.wsAxis]&&Fe(this.keys)||(Ne=Ne/1e3,this.updateVelocity(Ne),!(!Xe[ke.adAxis]&&!Xe[ke.wsAxis])&&Ve.object3D.position.add(this.getMovementVector(Ne)))},update:function(Oe){Oe.adAxis!==this.data.adAxis&&(this.velocity[Oe.adAxis]=0),Oe.wsAxis!==this.data.wsAxis&&(this.velocity[Oe.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(Oe){var Ne,ke,Ve,Xe=this.data,$e=this.keys,st=this.velocity,ze,tt;if(ke=Xe.adAxis,ze=Xe.wsAxis,Oe>Le){st[ke]=0,st[ze]=0;return}var ft=Math.pow(1/this.easing,Oe*60);st[ke]!==0&&(st[ke]=st[ke]*ft),st[ze]!==0&&(st[ze]=st[ze]*ft),Math.abs(st[ke])<Pe&&(st[ke]=0),Math.abs(st[ze])<Pe&&(st[ze]=0),Xe.enabled&&(Ne=Xe.acceleration,Xe.adEnabled&&(Ve=Xe.adInverted?-1:1,($e.KeyA||$e.ArrowLeft)&&(st[ke]-=Ve*Ne*Oe),($e.KeyD||$e.ArrowRight)&&(st[ke]+=Ve*Ne*Oe)),Xe.wsEnabled&&(tt=Xe.wsInverted?-1:1,($e.KeyW||$e.ArrowUp)&&(st[ze]-=tt*Ne*Oe),($e.KeyS||$e.ArrowDown)&&(st[ze]+=tt*Ne*Oe)))},getMovementVector:function(){var Oe=new Te.Vector3(0,0,0),Ne=new Te.Euler(0,0,0,"YXZ");return function(ke){var Ve=this.el.getAttribute("rotation"),Xe=this.velocity,$e;return Oe.copy(Xe),Oe.multiplyScalar(ke),Ve&&($e=this.data.fly?Ve.x:0,Ne.set(Te.MathUtils.degToRad($e),Te.MathUtils.degToRad(Ve.y),0),Oe.applyEuler(Ne)),Oe}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var Oe=Object.keys(this.keys),Ne=0;Ne<Oe.length;Ne++)delete this.keys[Oe[Ne]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(Oe){var Ne;be(Oe)&&(Ne=Oe.code||se[Oe.keyCode],xe.indexOf(Ne)!==-1&&(this.keys[Ne]=!0))},onKeyUp:function(Oe){var Ne;Ne=Oe.code||se[Oe.keyCode],delete this.keys[Ne]}});function Fe(Oe){var Ne;for(Ne in Oe)return!1;return!0}},"./src/components/windows-motion-controls.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/utils/tracked-controls.js"),Te=me.checkControllerPresentAndSetup,Re=me.emitIfAxesChanged,be=me.onButtonEvent,Pe=ve("./src/utils/index.js"),Le=Pe.debug("components:windows-motion-controls:debug"),xe=Pe.debug("components:windows-motion-controls:warn"),Fe=ve("./src/constants/index.js").DEFAULT_HANDEDNESS,Oe=ve("./src/constants/index.js").AFRAME_CDN_ROOT,Ne=Oe+"controllers/microsoft/",ke={left:"left.glb",right:"right.glb",default:"universal.glb"},Ve=ve("./src/utils/index.js").device.isWebXRAvailable,Xe="windows-mixed-reality",$e="Spatial Controller (Spatial Interaction Source) ",st=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,ze=Ve?Xe:$e,tt={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},ft={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},Rt=Ve?ft:tt;pe.exports.Component=se("windows-motion-controls",{schema:{hand:{default:Fe},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},after:["tracked-controls"],mapping:Rt,bindMethods:function(){this.onModelError=this.onModelError.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var Mt=this,Gt=this.el;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(_t){be(_t.detail.id,"down",Mt)},this.onButtonUp=function(_t){be(_t.detail.id,"up",Mt)},this.onButtonTouchStart=function(_t){be(_t.detail.id,"touchstart",Mt)},this.onButtonTouchEnd=function(_t){be(_t.detail.id,"touchend",Mt)},this.onControllerConnected=function(){Mt.setModelVisibility(!0)},this.onControllerDisconnected=function(){Mt.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},Gt.addEventListener("controllerconnected",this.onControllerConnected),Gt.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var Mt=this.el;Mt.addEventListener("buttonchanged",this.onButtonChanged),Mt.addEventListener("buttondown",this.onButtonDown),Mt.addEventListener("buttonup",this.onButtonUp),Mt.addEventListener("touchstart",this.onButtonTouchStart),Mt.addEventListener("touchend",this.onButtonTouchEnd),Mt.addEventListener("axismove",this.onAxisMoved),Mt.addEventListener("model-error",this.onModelError),Mt.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Mt=this.el;Mt.removeEventListener("buttonchanged",this.onButtonChanged),Mt.removeEventListener("buttondown",this.onButtonDown),Mt.removeEventListener("buttonup",this.onButtonUp),Mt.removeEventListener("touchstart",this.onButtonTouchStart),Mt.removeEventListener("touchend",this.onButtonTouchEnd),Mt.removeEventListener("axismove",this.onAxisMoved),Mt.removeEventListener("model-error",this.onModelError),Mt.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){Te(this,ze,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var Mt=this.createControllerModelUrl();this.loadModel(Mt)},createControllerModelUrl:function(Mt){var Gt=this.el.components["tracked-controls"],_t=Gt?Gt.controller:null,Bt="default",dt=this.data.hand,ut;if(_t&&!window.hasNativeWebXRImplementation&&(dt=_t.hand,!Mt)){var Ut=_t.id.match(st);Bt=Ut&&Ut[0]||Bt}return ut=ke[dt]||ke.default,Ne+Bt+"/"+ut},injectTrackedControls:function(){var Mt=this.data;this.el.setAttribute("tracked-controls",{idPrefix:ze,controller:Mt.pair,hand:Mt.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(Mt){var Gt=this.createControllerModelUrl(!0);Mt.detail.src!==Gt?(xe("Failed to load controller model for device, attempting to load default."),this.loadModel(Gt)):xe("Failed to load default controller model.")},loadModel:function(Mt){this.el.setAttribute("gltf-model","url("+Mt+")")},onModelLoaded:function(Mt){var Gt=this.controllerModel=Mt.detail.model,_t=this.loadedMeshInfo,Bt,dt,ut,Ut;if(Mt.target!==this.el)return;if(Le("Processing model"),_t.buttonMeshes={},_t.axisMeshes={},Gt){for(Bt=0;Bt<this.mapping.buttons.length;Bt++){if(dt=this.mapping.buttonMeshNames[this.mapping.buttons[Bt]],!dt){Le("Skipping unknown button at index: "+Bt+" with mapped name: "+this.mapping.buttons[Bt]);continue}if(ut=Gt.getObjectByName(dt),!ut){xe("Missing button mesh with name: "+dt);continue}Ut={index:Bt,value:Tt(ut,"VALUE"),pressed:Tt(ut,"PRESSED"),unpressed:Tt(ut,"UNPRESSED")},Ut.value&&Ut.pressed&&Ut.unpressed?_t.buttonMeshes[this.mapping.buttons[Bt]]=Ut:xe("Missing button submesh under mesh with name: "+dt+"(VALUE: "+!!Ut.value+", PRESSED: "+!!Ut.pressed+", UNPRESSED:"+!!Ut.unpressed+")")}for(Bt=0;Bt<this.mapping.axisMeshNames.length;Bt++){if(dt=this.mapping.axisMeshNames[Bt],!dt){Le("Skipping unknown axis at index: "+Bt);continue}if(ut=Gt.getObjectByName(dt),!ut){xe("Missing axis mesh with name: "+dt);continue}Ut={index:Bt,value:Tt(ut,"VALUE"),min:Tt(ut,"MIN"),max:Tt(ut,"MAX")},Ut.value&&Ut.min&&Ut.max?_t.axisMeshes[Bt]=Ut:xe("Missing axis submesh under mesh with name: "+dt+"(VALUE: "+!!Ut.value+", MIN: "+!!Ut.min+", MAX:"+!!Ut.max+")")}this.calculateRayOriginFromMesh(Gt),this.setModelVisibility()}Le("Model load complete.");function Tt(Xt,hn){for(var nn=0,An=Xt.children.length;nn<An;nn++){var Cn=Xt.children[nn];if(Cn&&Cn.name===hn)return Cn}}},calculateRayOriginFromMesh:function(){var Mt=new THREE.Quaternion;return function(Gt){var _t;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,_t=Gt.getObjectByName(this.mapping.pointingPoseMeshName),_t){var Bt=Gt.parent;Bt&&(Gt.parent=null,Gt.updateMatrixWorld(!0),Gt.parent=Bt),_t.getWorldPosition(this.rayOrigin.origin),_t.getWorldQuaternion(Mt),this.rayOrigin.direction.applyQuaternion(Mt),Bt&&Gt.updateMatrixWorld(!0)}else Le("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var Mt=new THREE.Quaternion;return function(Gt,_t){var Bt=this.loadedMeshInfo.axisMeshes[Gt];if(Bt){var dt=Bt.min,ut=Bt.max,Ut=Bt.value,Tt=_t*.5+.5;Ut.setRotationFromQuaternion(Mt.copy(dt.quaternion).slerp(ut.quaternion,Tt)),Ut.position.lerpVectors(dt.position,ut.position,Tt)}}}(),lerpButtonTransform:function(){var Mt=new THREE.Quaternion;return function(Gt,_t){var Bt=this.loadedMeshInfo.buttonMeshes[Gt];if(Bt){var dt=Bt.unpressed,ut=Bt.pressed,Ut=Bt.value;Ut.setRotationFromQuaternion(Mt.copy(dt.quaternion).slerp(ut.quaternion,_t)),Ut.position.lerpVectors(dt.position,ut.position,_t)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(Mt){var Gt=this.mapping.buttons[Mt.detail.id];Gt&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(Gt,Mt.detail.state.value),this.el.emit(Gt+"changed",Mt.detail.state))},onAxisMoved:function(Mt){var Gt=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var _t=0;_t<Gt;_t++)this.lerpAxisTransform(_t,Mt.detail.axis[_t]||0);Re(this,this.mapping.axes,Mt)},setModelVisibility:function(Mt){var Gt=this.el.getObject3D("mesh");this.controllerPresent&&(Mt=Mt!==void 0?Mt:this.modelVisible,this.modelVisible=Mt,Gt&&(Gt.visible=Mt))}})},"./src/constants/index.js":(pe,Me,ve)=>{pe.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:ve("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":pe=>{pe.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(pe,Me,ve)=>{var se=ve("./src/core/a-node.js").ANode,me=ve("./src/utils/debug.js"),Te=ve("./src/lib/three.js"),Re=new Te.FileLoader,be=me("core:a-assets:warn");class Pe extends se{constructor(){super(),this.isAssets=!0,this.fileLoader=Re,this.timeout=null}doConnectedCallback(){var $e=this,st,ze=[],tt,ft,Rt,Mt,Gt,_t;if(super.doConnectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(Mt=this.querySelectorAll("img"),st=0;st<Mt.length;st++)Rt=Fe(Mt[st]),ze.push(new Promise(function(Bt,dt){if(Te.Cache.add(Mt[st].getAttribute("src"),Rt),Rt.complete){Bt();return}Rt.onload=Bt,Rt.onerror=dt}));for(ft=this.querySelectorAll("audio, video"),st=0;st<ft.length;st++)tt=Fe(ft[st]),!tt.src&&!tt.srcObject&&be("Audio/video asset has neither `src` nor `srcObject` attributes."),ze.push(xe(tt));_t=this.getChildren(),_t.forEach(function(Bt){!Bt.isAssetItem||!Bt.hasAttribute("src")||ze.push(new Promise(function(ut,Ut){if(Bt.hasLoaded)return ut();Bt.addEventListener("loaded",ut),Bt.addEventListener("error",Ut)}))}),Promise.allSettled(ze).then(function(){$e.timeout!==null&&$e.load()}),Gt=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){$e.hasLoaded||(be("Asset loading timed out in",Gt,"ms"),$e.timeout=null,$e.emit("timeout"),$e.load())},Gt)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(){return!1})}}customElements.define("a-assets",Pe);class Le extends se{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var $e=this,st=this.getAttribute("src");Re.setResponseType(this.getAttribute("response-type")||ke(st)),Re.load(st,function(tt){$e.data=tt,se.prototype.load.call($e)},function(tt){$e.emit("progress",{loadedBytes:tt.loaded,totalBytes:tt.total,xhr:tt})},function(tt){$e.emit("error",{xhr:tt})})}}customElements.define("a-asset-item",Le);function xe(Xe){if(!(!Xe.hasAttribute("autoplay")&&Xe.getAttribute("preload")!=="auto"))return new Promise(function($e,st){if(Xe.readyState===4)return $e();if(Xe.error)return st();Xe.addEventListener("loadeddata",ze,!1),Xe.addEventListener("progress",ze,!1),Xe.addEventListener("error",st,!1);function ze(){for(var tt=0,ft=0;ft<Xe.buffered.length;ft++)tt+=Xe.buffered.end(ft)-Xe.buffered.start(ft);tt>=Xe.duration&&(Xe.tagName==="VIDEO"&&Te.Cache.add(Xe.getAttribute("src"),Xe),$e())}})}function Fe(Xe){var $e=Oe(Xe);return $e.tagName&&$e.tagName.toLowerCase()==="video"&&($e.setAttribute("playsinline",""),$e.setAttribute("webkit-playsinline","")),$e!==Xe&&(Xe.parentNode.appendChild($e),Xe.parentNode.removeChild(Xe)),$e}function Oe(Xe){var $e,st;return Xe.hasAttribute("crossorigin")||(st=Xe.getAttribute("src"),st!==null&&(st.indexOf("://")===-1||Ne(st)===window.location.host))?Xe:(be('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',st),Xe.crossOrigin="anonymous",$e=Xe.cloneNode(!0),$e)}function Ne(Xe){var $e=Xe.indexOf("://")>-1?Xe.split("/")[2]:Xe.split("/")[0];return $e.substring(0,$e.indexOf(":"))}function ke(Xe){var $e=Ve(Xe),st=$e.lastIndexOf(".");if(st>=0){var ze=$e.slice(st,Xe.search(/\?|#|$/));if(ze===".glb")return"arraybuffer"}return"text"}pe.exports.inferResponseType=ke;function Ve(Xe){var $e=document.createElement("a");$e.href=Xe;var st=$e.search.replace(/^\?/,""),ze=Xe.replace(st,"").replace("?","");return ze.substring(ze.lastIndexOf("/")+1)}pe.exports.getFileNameFromURL=Ve},"./src/core/a-cubemap.js":(pe,Me,ve)=>{var se=ve("./src/utils/debug.js"),me=se("core:cubemap:warn");class Te extends HTMLElement{constructor(be){return be=super(be),be}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}Te.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var be=this.querySelectorAll("[src]"),Pe,Le=[];if(be.length===6){for(Pe=0;Pe<be.length;Pe++)be[Pe].tagName==="IMG"?Le.push(be[Pe]):Le.push(be[Pe].getAttribute("src"));return Le}me("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",Te)},"./src/core/a-entity.js":(pe,Me,ve)=>{var se=ve("./src/core/a-node.js").ANode,me=ve("./src/core/component.js").components,Te=ve("./src/lib/three.js"),Re=ve("./src/utils/index.js"),be=Re.debug("core:a-entity:debug"),Pe=Re.debug("core:a-entity:warn"),Le="__",xe=["position","rotation","scale","visible"],Fe={once:!0};class Oe extends se{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new Te.Group,this.object3D.rotation.order="YXZ",this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(ze,tt,ft){var Rt=this.components[ze];if(super.attributeChangedCallback(),Rt&&Rt.justInitialized&&ft===""){delete Rt.justInitialized;return}!Rt&&ft===null||this.setEntityAttribute(ze,tt,ft)}doConnectedCallback(){var ze=this,tt,ft;if(super.doConnectedCallback(),ft=this.sceneEl,this.addToParent(),!this.isScene){if(!ft){this.load();return}if(tt=ft.querySelector("a-assets"),tt&&!tt.hasLoaded){tt.addEventListener("loaded",function(){ze.load()});return}this.load()}}disconnectedCallback(){var ze;if(this.parentEl){for(ze in this.components)this.removeComponent(ze,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(ze){return this.object3DMap[ze]}setObject3D(ze,tt){var ft,Rt=this;if(!(tt instanceof Te.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");ft=this.getObject3D(ze),ft&&this.object3D.remove(ft),tt.el=this,tt.children.length&&tt.traverse(function(Gt){Gt.el=Rt}),this.object3D.add(tt),this.object3DMap[ze]=tt,this.emit("object3dset",{object:tt,type:ze})}removeObject3D(ze){var tt=this.getObject3D(ze);if(!tt){Pe("Tried to remove `Object3D` of type:",ze,"which was not defined.");return}this.object3D.remove(tt),delete this.object3DMap[ze],this.emit("object3dremove",{type:ze})}getOrCreateObject3D(ze,tt){var ft=this.getObject3D(ze);return!ft&&tt&&(ft=new tt,this.setObject3D(ze,ft)),Pe("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),ft}add(ze){if(!ze.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(ze.object3D),this.emit("child-attached",{el:ze})}addToParent(){var ze=this.parentEl=this.parentNode;!ze||!ze.add||this.attachedToParent||(ze.add(this),this.attachedToParent=!0)}removeFromParent(){var ze=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,ze.emit("child-detached",{el:this})}load(){var ze=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){ze.parentEl&&(ze.updateComponents(),(ze.isScene||ze.parentEl.isPlaying)&&ze.play())})}remove(ze){ze?this.object3D.remove(ze.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var ze=this.children,tt=[],ft=0;ft<ze.length;ft++){var Rt=ze[ft];Rt instanceof Oe&&tt.push(Rt)}return tt}initComponent(ze,tt,ft){var Rt,Mt,Gt,_t,Bt;Gt=Re.split(ze,Le),_t=Gt[0],Mt=Gt.length>2?Gt.slice(1).join("__"):Gt[1],me[_t]&&(Bt=Ne(this,ze)||tt!==void 0,!(!Bt&&!ft)&&(ze in this.components||(this.initComponentDependencies(_t),Rt=new me[_t].Component(this,tt,Mt),this.isPlaying&&Rt.play(),this.hasAttribute(ze)||(Rt.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,ze,"")),be("Component initialized: %s",ze))))}initComponentDependencies(ze){var tt=this,ft=me[ze],Rt,Mt;if(ft&&(Rt=me[ze].dependencies,!!Rt))for(Mt=0;Mt<Rt.length;Mt++)tt.initComponent(Rt[Mt],window.HTMLElement.prototype.getAttribute.call(tt,Rt[Mt])||void 0,!0)}removeComponent(ze,tt){var ft;if(ft=this.components[ze],!!ft){if(!ft.initialized){this.addEventListener("componentinitialized",function Rt(Mt){Mt.detail.name===ze&&(this.removeComponent(ze,tt),this.removeEventListener("componentinitialized",Rt))});return}ft.pause(),ft.remove(),tt&&(ft.destroy(),delete this.components[ze],this.hasAttribute(ze)&&window.HTMLElement.prototype.removeAttribute.call(this,ze)),this.emit("componentremoved",ft.evtDetail,!1)}}updateComponents(){var ze,tt,ft,Rt,Mt=this.componentsToUpdate;if(!(!this.hasLoaded&&!this.isLoading)){for(ft=0;ft<this.mixinEls.length;ft++)for(Rt in this.mixinEls[ft].componentCache)Xe(Rt)&&(Mt[Rt]=!0);if(this.getExtraComponents){tt=this.getExtraComponents();for(Rt in tt)Xe(Rt)&&(Mt[Rt]=!0)}for(ft=0;ft<this.attributes.length;++ft)Rt=this.attributes[ft].name,xe.indexOf(Rt)===-1&&Xe(Rt)&&(Mt[Rt]=!0);for(ft=0;ft<xe.length;ft++)Rt=xe[ft],this.hasAttribute(Rt)&&this.updateComponent(Rt,this.getDOMAttribute(Rt));for(Rt in Mt)ze=Ve(this.getDOMAttribute(Rt),tt&&tt[Rt]),this.updateComponent(Rt,ze),delete Mt[Rt]}}updateComponent(ze,tt,ft){var Rt=this.components[ze];if(Rt){if(tt===null&&!Ne(this,ze)){this.removeComponent(ze,!0);return}Rt.updateProperties(tt,ft);return}this.initComponent(ze,tt,!1)}removeAttribute(ze,tt){var ft=this.components[ze];if(ft&&tt===void 0&&this.removeComponent(ze,!0),ft&&tt!==void 0){ft.resetProperty(tt);return}ze==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,ze)}play(){var ze,tt,ft;if(!(this.isPlaying||!this.hasLoaded&&!this.isLoading)){this.isPlaying=!0;for(ft in this.components)this.components[ft].play();for(ze=this.getChildEntities(),tt=0;tt<ze.length;tt++)ze[tt].play();this.emit("play")}}pause(){var ze,tt,ft;if(this.isPlaying){this.isPlaying=!1;for(ft in this.components)this.components[ft].pause();for(ze=this.getChildEntities(),tt=0;tt<ze.length;tt++)ze[tt].pause();this.emit("pause")}}setEntityAttribute(ze,tt,ft){if(me[ze]||this.components[ze]){this.updateComponent(ze,ft);return}if(ze==="mixin"){if(ft===this.computedMixinStr)return;this.mixinUpdate(ft,tt)}}mixinUpdate(ze,tt,ft){var Rt=Oe.componentsUpdated,Mt,Gt,_t,Bt,dt=this;if(ft||(tt=tt||this.getAttribute("mixin")),!this.hasLoaded){this.addEventListener("loaded-private",function(){dt.mixinUpdate(ze,tt,!0)},Fe);return}for(_t=this.updateMixins(ze,tt),Rt.length=0,Bt=0;Bt<this.mixinEls.length;Bt++)for(Mt in this.mixinEls[Bt].componentCache)Rt.indexOf(Mt)===-1&&(this.components[Mt]?this.components[Mt].handleMixinUpdate():this.initComponent(Mt,null),Rt.push(Mt));for(Bt=0;Bt<_t.oldMixinIds.length;Bt++)if(Gt=document.getElementById(_t.oldMixinIds[Bt]),!!Gt)for(Mt in Gt.componentCache)Rt.indexOf(Mt)===-1&&this.components[Mt]&&(this.getDOMAttribute(Mt)?this.components[Mt].handleMixinUpdate():this.removeComponent(Mt,!0))}setAttribute(ze,tt,ft){var Rt=Oe.singlePropUpdate,Mt,Gt,_t,Bt,dt,ut;if(Bt=ze.indexOf(Le),_t=Bt>0?ze.substring(0,Bt):ze,!me[_t]){ze==="mixin"&&this.mixinUpdate(tt),super.setAttribute.call(this,ze,tt);return}if(!this.components[ze]&&this.hasAttribute(ze)&&this.updateComponent(ze,window.HTMLElement.prototype.getAttribute.call(this,ze)),typeof ft<"u"&&typeof tt=="string"&&tt.length>0&&typeof Re.styleParser.parse(tt)=="string"){for(ut in Rt)delete Rt[ut];Mt=Rt,Mt[tt]=ft,Gt=!1}else Mt=tt,Gt=ft===!0;this.updateComponent(ze,Mt,Gt),dt=this.sceneEl&&this.sceneEl.getAttribute("debug"),dt&&this.components[ze].flushToDOM()}flushToDOM(ze){var tt=this.components,ft,Rt=this.children,Mt,Gt;for(Gt in tt)tt[Gt].flushToDOM();if(ze)for(Mt=0;Mt<Rt.length;++Mt)ft=Rt[Mt],ft.flushToDOM&&ft.flushToDOM(ze)}getAttribute(ze){var tt;return ze==="position"?this.object3D.position:ze==="rotation"?$e(this):ze==="scale"?this.object3D.scale:ze==="visible"?this.object3D.visible:(tt=this.components[ze],tt?tt.data:window.HTMLElement.prototype.getAttribute.call(this,ze))}getDOMAttribute(ze){var tt=this.components[ze];return tt?tt.attrValue:window.HTMLElement.prototype.getAttribute.call(this,ze)}addState(ze){this.is(ze)||(this.states.push(ze),this.emit("stateadded",ze))}removeState(ze){var tt=this.states.indexOf(ze);tt!==-1&&(this.states.splice(tt,1),this.emit("stateremoved",ze))}is(ze){return this.states.indexOf(ze)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var ze;if(this.parentNode){Pe("Entity can only be destroyed if detached from scenegraph.");return}for(ze in this.components)this.components[ze].destroy()}}function Ne(st,ze){return st.components[ze]&&st.components[ze].attrValue?!0:ke(ze,st.mixinEls)}function ke(st,ze){var tt,ft=!1;for(tt=0;tt<ze.length&&(ft=ze[tt].hasAttribute(st),!ft);++tt);return ft}function Ve(st,ze){return ze?ze.constructor===Object?Re.extend(ze,Re.styleParser.parse(st||{})):st||ze:st}function Xe(st){return st.indexOf(Le)!==-1&&(st=Re.split(st,Le)[0]),!!me[st]}function $e(st){var ze=Te.MathUtils.radToDeg,tt=st.object3D.rotation,ft=st.rotationObj;return ft.x=ze(tt.x),ft.y=ze(tt.y),ft.z=ze(tt.z),ft}Oe.componentsUpdated=[],Oe.singlePropUpdate={},customElements.define("a-entity",Oe),pe.exports.AEntity=Oe},"./src/core/a-mixin.js":(pe,Me,ve)=>{var se=ve("./src/core/a-node.js").ANode,me=ve("./src/core/component.js").components,Te=ve("./src/utils/index.js"),Re=Te.styleParser,be="__";class Pe extends se{constructor(){super(),this.componentCache={},this.rawAttributeCache={},this.isMixin=!0}doConnectedCallback(){super.doConnectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(xe,Fe,Oe){super.attributeChangedCallback(),this.cacheAttribute(xe,Oe),this.updateEntities()}setAttribute(xe,Fe){window.HTMLElement.prototype.setAttribute.call(this,xe,Fe),this.cacheAttribute(xe,Fe)}cacheAttribute(xe,Fe){var Oe,Ne;Ne=Te.split(xe,be)[0],Oe=me[Ne],Fe===void 0&&(Fe=window.HTMLElement.prototype.getAttribute.call(this,xe)),this.rawAttributeCache[xe]=Fe,Oe&&(this.componentCache[xe]=this.parseComponentAttrValue(Oe,Fe))}parseComponentAttrValue(xe,Fe){var Oe;return typeof Fe!="string"?Fe:(xe.isSingleProperty?(Oe=xe.schema.parse(Fe),typeof Oe=="string"&&(Oe=Fe)):Oe=Re.parse(Fe),Oe)}getAttribute(xe){return this.componentCache[xe]||window.HTMLElement.prototype.getAttribute.call(this,xe)}cacheAttributes(){var xe=this.attributes,Fe,Oe;for(Oe=0;Oe<xe.length;Oe++)Fe=xe[Oe].name,this.cacheAttribute(Fe)}updateEntities(){var xe,Fe,Oe;if(this.sceneEl)for(Fe=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),Oe=0;Oe<Fe.length;Oe++)xe=Fe[Oe],!(!xe.hasLoaded||xe.isMixin)&&xe.mixinUpdate(this.id)}}customElements.define("a-mixin",Pe)},"./src/core/a-node.js":(pe,Me,ve)=>{var se=ve("./src/utils/index.js"),me=ve("./src/core/readyState.js"),Te=se.debug("core:a-node:warn"),Re={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function be(Le){return Le.tagName.toLowerCase()in Re||Le.isNode}class Pe extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}connectedCallback(){if(!me.canInitializeElements){document.addEventListener("aframeready",this.connectedCallback.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var xe;this.sceneEl=this.closestScene(),this.sceneEl||Te("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(xe=this.getAttribute("mixin"),xe&&this.updateMixins(xe))}attributeChangedCallback(xe,Fe,Oe){Oe!==this.computedMixinStr&&xe==="mixin"&&!this.isMixin&&this.updateMixins(Oe,Fe)}closestScene(){for(var xe=this;xe&&!xe.isScene;)xe=xe.parentElement;return xe}closest(xe){for(var Fe=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,Oe=this;Oe&&!Fe.call(Oe,xe);)Oe=Oe.parentElement;return Oe}disconnectedCallback(){this.hasLoaded=!1}load(xe,Fe){var Oe,Ne,ke=this;this.hasLoaded||(Fe=Fe||be,Oe=this.getChildren(),Ne=Oe.filter(Fe).map(function(Ve){return new Promise(function($e,st){if(Ve.hasLoaded)return $e();Ve.addEventListener("loaded",$e),Ve.addEventListener("error",st)})}),Promise.allSettled(Ne).then(function(Xe){Xe.forEach(function(st){st.status==="rejected"&&Te("Rendering scene with errors on node: ",st.reason.target)}),ke.isLoading=!0,ke.setupMutationObserver(),xe&&xe(),ke.isLoading=!1,ke.hasLoaded=!0,ke.emit("loaded-private",void 0,!1),ke.emit("loaded",void 0,!1)}))}setupMutationObserver(){var xe=this,Fe={attributes:!0,attributeOldValue:!0},Oe=new MutationObserver(function(ke){var Ve;for(Ve=0;Ve<ke.length;Ve++)if(ke[Ve].type==="attributes"){var Xe=ke[Ve].attributeName,$e=window.HTMLElement.prototype.getAttribute.call(xe,Xe),st=ke[Ve].oldValue;xe.attributeChangedCallback(Xe,st,$e)}});Oe.observe(this,Fe)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(xe,Fe){var Oe=Pe.newMixinIdArray,Ne=Pe.oldMixinIdArray,ke=Pe.mixinIds,Ve,Xe,$e;for(Oe.length=0,Ne.length=0,Xe=xe?se.split(xe.trim(),/\s+/):Oe,$e=Fe?se.split(Fe.trim(),/\s+/):Ne,ke.newMixinIds=Xe,ke.oldMixinIds=$e,Ve=0;Ve<$e.length;Ve++)Xe.indexOf($e[Ve])===-1&&this.unregisterMixin($e[Ve]);for(this.computedMixinStr="",this.mixinEls.length=0,Ve=0;Ve<Xe.length;Ve++)this.registerMixin(Xe[Ve]);return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),Xe.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin"),ke}registerMixin(xe){var Fe,Oe,Ne,ke=document.getElementById(xe);if(!ke){Te("No mixin was found with id `%s`",xe);return}if(Ne=ke.getAttribute("mixin"),Ne)for(Fe=se.split(Ne.trim(),/\s+/),Oe=0;Oe<Fe.length;Oe++)this.registerMixin(Fe[Oe]);this.computedMixinStr=this.computedMixinStr+" "+ke.id,this.mixinEls.push(ke)}setAttribute(xe,Fe){xe==="mixin"&&this.updateMixins(Fe),window.HTMLElement.prototype.setAttribute.call(this,xe,Fe)}unregisterMixin(xe){var Fe,Oe=this.mixinEls,Ne;for(Fe=0;Fe<Oe.length;++Fe)if(Ne=Oe[Fe],xe===Ne.id){Oe.splice(Fe,1);break}}emit(xe,Fe,Oe,Ne){var ke=Pe.evtData;Oe===void 0&&(Oe=!0),ke.bubbles=!!Oe,ke.detail=Fe,Ne&&(ke=se.extend({},Ne,ke)),this.dispatchEvent(new CustomEvent(xe,ke))}}Pe.evtData={},Pe.newMixinIdArray=[],Pe.oldMixinIdArray=[],Pe.mixinIds={},customElements.define("a-node",Pe),pe.exports.ANode=Pe,pe.exports.knownTags=Re},"./src/core/component.js":(pe,Me,ve)=>{var se=ve("./src/core/schema.js"),me=ve("./src/core/scene/scenes.js"),Te=ve("./src/core/system.js"),Re=ve("./src/utils/index.js"),be=pe.exports.components={},Pe=se.parseProperty,Le=se.process,xe=se.isSingleProperty,Fe=se.stringifyProperties,Oe=se.stringifyProperty,Ne=Re.styleParser,ke=Re.debug("core:component:warn"),Ve=document.currentScript,Xe=new RegExp("[A-Z]+"),$e={},st=Object.freeze({}),ze=[],tt={get:function(ut,Ut){return ut.getComputedPropertyValue(Ut)},set:function(ut,Ut,Tt){return Ut in ut.schema?ut.recomputeProperty(Ut,Tt):Tt!==void 0&&ut.handleUnknownProperty(Ut,Tt),!0}},ft=pe.exports.Component=function(ut,Ut,Tt){var Xt=this;if(this.sceneOnly&&!ut.isScene)throw new Error("Component `"+this.name+"` can only be applied to <a-scene>");if(Tt&&!this.multiple)throw new Error("Trying to initialize multiple components of type `"+this.name+"`. There can only be one component of this type per entity.");this.el=ut,this.id=Tt,this.attrName=this.name+(Tt?"__"+Tt:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=$e[this.name];var hn=this.events;this.events={},Rt(this,hn),this.attrValue=void 0,this.isObjectBased?(this.data=this.objectPool.use(),Re.objectPool.removeUnusedKeys(this.data,this.schema),this.oldData=this.objectPool.use(),Re.objectPool.removeUnusedKeys(this.oldData,this.schema),this.attrValueProxy=new Proxy(this,tt)):(this.data=void 0,this.oldData=void 0,this.attrValueProxy=void 0),this.deferUnknownPropertyWarnings=!!this.updateSchema,this.silenceUnknownPropertyWarnings=!1,this.throttledEmitComponentChanged=Re.throttleLeadingAndTrailing(function(){ut.emit("componentchanged",Xt.evtDetail,!1)},200),this.updateProperties(Ut,!0)};ft.prototype={schema:{},init:function(){},events:{},update:function(ut){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},stringify:function(ut){var Ut=this.schema;return typeof ut=="string"?ut:this.isSingleProperty?Oe(ut,Ut):(ut=Fe(ut,Ut),Ne.stringify(ut))},flushToDOM:function(ut){var Ut=ut?this.data:this.attrValue;Ut!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(Ut))},updateProperties:function(ut,Ut){var Tt=this.el;this.updateData(ut,Ut),!(!Tt.hasLoaded&&!Tt.isLoading)&&(this.initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var ut=this.el,Ut;ut.initializingComponents[this.name]||(ut.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete ut.initializingComponents[this.name],Ut=this.isObjectBased?st:void 0,this.dataChanged=!1,this.storeOldData(),this.update(Ut),ut.isPlaying&&this.play(),ut.emit("componentinitialized",this.evtDetail,!1))},updateData:function(ut,Ut){if(this.isSingleProperty){this.recomputeProperty(void 0,ut);return}Ut?(Re.objectPool.clearObject(this.attrValue),this.recomputeData(ut),this.schemaChangeRequired=!!this.updateSchema):typeof ut=="string"?Ne.parse(ut,this.attrValueProxy):Re.extend(this.attrValueProxy,ut),this.updateSchemaIfNeeded(ut)},updateSchemaIfNeeded:function(ut){if(!this.schemaChangeRequired||!this.updateSchema){for(var Ut=0;Ut<ze.length;Ut++)ke("Unknown property `"+ze[Ut]+"` for component `"+this.name+"`.");ze.length=0;return}ze.length=0,this.updateSchema(this.data),Re.objectPool.removeUnusedKeys(this.data,this.schema),this.silenceUnknownPropertyWarnings=!0,this.recomputeData(ut),this.silenceUnknownPropertyWarnings=!1,this.schemaChangeRequired=!1},callUpdateHandler:function(){if(!(!this.isPositionRotationScale&&!this.dataChanged)){this.dataChanged=!1;var ut=this.oldData;this.oldDataInUse=!0,this.update(ut),ut!==this.oldData&&this.objectPool.recycle(ut),this.oldDataInUse=!1,this.storeOldData(),this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData(),this.updateSchemaIfNeeded(),this.callUpdateHandler()},resetProperty:function(ut){!this.isSingleProperty&&!(ut in this.schema)||(ut?this.attrValue[ut]=void 0:(this.isObjectBased&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0),this.recomputeProperty(ut,void 0),this.updateSchemaIfNeeded(),this.callUpdateHandler())},extendSchema:function(ut){var Ut;Ut=Re.extend({},be[this.name].schema),Re.extend(Ut,ut),this.schema=Le(Ut),this.el.emit("schemachanged",this.evtDetail)},getComputedPropertyValue:function(ut){var Ut=this.el.mixinEls,Tt=this.attrValue&&ut?this.attrValue[ut]:this.attrValue;if(Tt!==void 0)return Tt;for(var Xt=Ut.length-1;Xt>=0;Xt--){var hn=Ut[Xt].getAttribute(this.attrName);if(!(hn===null||ut&&!(ut in hn)))return ut?hn[ut]:hn}var nn=ut?this.schema[ut].default:this.schema.default;return nn},recomputeProperty:function(ut,Ut){var Tt=ut?this.schema[ut]:this.schema;if(Ut!=null){this.attrValue===void 0&&this.isObjectBased&&(this.attrValue=this.objectPool.use());var Xt=ut?this.attrValue[ut]:this.attrValue;Xt=Tt.isCacheable?Pe(Ut,Tt,Xt):Ut,typeof Xt=="string"&&(Xt=Ut===""?void 0:Ut),ut?this.attrValue[ut]=Xt:this.attrValue=Xt}this.oldDataInUse&&(this.oldData=this.objectPool.use(),Re.objectPool.removeUnusedKeys(this.oldData,this.schema),this.storeOldData(),this.oldDataInUse=!1);var hn=ut?this.oldData[ut]:this.oldData,nn=ut?this.data[ut]:this.data,An=Pe(this.getComputedPropertyValue(ut),Tt,nn);return Tt.type==="array"&&!ut&&(An=Re.clone(An)),Tt.equals(An,hn)||(this.dataChanged=!0,Tt.schemaChange&&(this.schemaChangeRequired=!0)),ut?this.data[ut]=An:this.data=An,An},handleUnknownProperty:function(ut,Ut){this.attrValue===void 0&&(this.attrValue=this.objectPool.use()),this.attrValue[ut]=Ut,this.silenceUnknownPropertyWarnings||(this.deferUnknownPropertyWarnings?ze.push(ut):this.silenceUnknownPropertyWarnings||ke("Unknown property `"+ut+"` for component `"+this.name+"`."))},storeOldData:function(){if(!this.isObjectBased){this.oldData=this.data;return}if(this.isSingleProperty){this.oldData=Pe(this.data,this.schema,this.oldData);return}var ut;for(ut in this.schema)this.data[ut]!==void 0&&(this.data[ut]&&typeof this.data[ut]=="object"?this.oldData[ut]=Pe(this.data[ut],this.schema[ut],this.oldData[ut]):this.oldData[ut]=this.data[ut])},recomputeData:function(ut){var Ut;if(this.isSingleProperty){this.recomputeProperty(void 0,ut);return}if(ut&&typeof ut=="object")for(Ut in this.schema)this.attrValueProxy[Ut]=ut[Ut];else for(Ut in this.schema)this.attrValueProxy[Ut]=void 0;typeof ut=="string"&&Ne.parse(ut,this.attrValueProxy);for(Ut in this.attrValue)this.attrValue[Ut]!==void 0&&ze.indexOf(Ut)!==-1&&(Ut in this.schema||ke("Unknown property `"+Ut+"` for component `"+this.name+"`."))},eventsAttach:function(){var ut;this.eventsDetach();for(ut in this.events)this.el.addEventListener(ut,this.events[ut])},eventsDetach:function(){var ut;for(ut in this.events)this.el.removeEventListener(ut,this.events[ut])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.data),this.objectPool.recycle(this.oldData),this.attrValue=this.data=this.oldData=this.attrValueProxy=void 0}};function Rt(ut,Ut){var Tt;for(Tt in Ut)ut.events[Tt]=Ut[Tt].bind(ut)}if(window.debug)var Mt=pe.exports.registrationOrderWarnings={};pe.exports.registerComponent=function(ut,Ut){var Tt,Xt={},hn,nn;if(document.currentScript&&document.currentScript!==Ve&&me.forEach(function(Nn){Nn.hasLoaded||document.currentScript.compareDocumentPosition(Nn)!==Node.DOCUMENT_POSITION_FOLLOWING&&(ke("The component `"+ut+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(Mt[ut]=!0))}),Xe.test(ut)===!0&&ke("The component name `"+ut+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+ut.toLowerCase()+"`"),ut.indexOf("__")!==-1)throw new Error("The component name `"+ut+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(Ut).forEach(function(Cn){Xt[Cn]={value:Ut[Cn],writable:!0}}),be[ut])throw new Error("The component `"+ut+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");Tt=function(Cn,Nn,Qn){ft.call(this,Cn,Nn,Qn)},Tt.prototype=Object.create(ft.prototype,Xt),Tt.prototype.name=ut,Tt.prototype.isPositionRotationScale=ut==="position"||ut==="rotation"||ut==="scale",Tt.prototype.constructor=Tt,Tt.prototype.system=Te&&Te.systems[ut],Tt.prototype.play=Bt(Tt.prototype.play),Tt.prototype.pause=_t(Tt.prototype.pause),hn=Re.extend(Le(Tt.prototype.schema,Tt.prototype.name)),Tt.prototype.isSingleProperty=nn=xe(Tt.prototype.schema),Tt.prototype.isObjectBased=!nn||nn&&(dt(hn.default)||dt(Pe(void 0,hn))),$e[ut]=Re.objectPool.createPool(),be[ut]={Component:Tt,dependencies:Tt.prototype.dependencies,before:Tt.prototype.before,after:Tt.prototype.after,isSingleProperty:Tt.prototype.isSingleProperty,isObjectBased:Tt.prototype.isObjectBased,multiple:Tt.prototype.multiple,sceneOnly:Tt.prototype.sceneOnly,name:ut,schema:hn,stringify:Tt.prototype.stringify};for(var An=0;An<me.length;An++)me[An].emit("componentregistered",{name:ut},!1);return Tt};function Gt(ut){return ut.tick||ut.tock}function _t(ut){return function(){var Tt=this.el.sceneEl;this.isPlaying&&(ut.call(this),this.isPlaying=!1,this.eventsDetach(),Gt(this)&&Tt.removeBehavior(this))}}function Bt(ut){return function(){var Tt=this.el.sceneEl,Xt=this.el.isPlaying&&!this.isPlaying;!this.initialized||!Xt||(ut.call(this),this.isPlaying=!0,this.eventsAttach(),Gt(this)&&Tt.addBehavior(this))}}function dt(ut){return ut&&ut.constructor===Object&&!(ut instanceof window.HTMLElement)}},"./src/core/geometry.js":(pe,Me,ve)=>{var se=ve("./src/core/schema.js"),me=se.process,Te=pe.exports.geometries={},Re=pe.exports.geometryNames=[],be=ve("./src/lib/three.js"),Pe=pe.exports.Geometry=function(){};Pe.prototype={schema:{},init:function(Le){return this.geometry=new be.BufferGeometry,this.geometry},update:function(Le){}},pe.exports.registerGeometry=function(Le,xe){var Fe,Oe={};if(Object.keys(xe).forEach(function(ke){Oe[ke]={value:xe[ke],writable:!0}}),Te[Le])throw new Error("The geometry `"+Le+"` has been already registered");return Fe=function(){Pe.call(this)},Fe.prototype=Object.create(Pe.prototype,Oe),Fe.prototype.name=Le,Fe.prototype.constructor=Fe,Te[Le]={Geometry:Fe,schema:me(Fe.prototype.schema)},Re.push(Le),Fe}},"./src/core/propertyTypes.js":(pe,Me,ve)=>{var se=ve("./src/utils/coordinates.js"),me=ve("./node_modules/debug/src/browser.js"),Te=me("core:propertyTypes:warn"),Re=pe.exports.propertyTypes={},be=/[,> .[\]:]/,Pe=/url\((.+)\)/;Le("audio","",Ne),Le("array",[],xe,Fe,Oe),Le("asset","",Ne),Le("boolean",!1,$e),Le("color","#FFF"),Le("int",0,st),Le("number",0,ze),Le("map","",Ne),Le("model","",Ne),Le("selector",null,tt,Rt,Xe,!1),Le("selectorAll",null,ft,Mt,Oe,!1),Le("src","",Gt),Le("string",""),Le("time",0,st),Le("vec2",{x:0,y:0},_t,se.stringify,se.equals),Le("vec3",{x:0,y:0,z:0},_t,se.stringify,se.equals),Le("vec4",{x:0,y:0,z:0,w:1},_t,se.stringify,se.equals);function Le(ut,Ut,Tt,Xt,hn,nn){if(ut in Re)throw new Error("Property type "+ut+" is already registered.");Re[ut]={default:Ut,parse:Tt||ke,stringify:Xt||Ve,equals:hn||Xe,isCacheable:nn!==!1}}pe.exports.registerPropertyType=Le;function xe(ut){if(Array.isArray(ut))return ut;if(!ut||typeof ut!="string")return[];return ut.split(",").map(Ut);function Ut(Tt){return Tt.trim()}}function Fe(ut){return ut.join(", ")}function Oe(ut,Ut){if(!Array.isArray(ut)||!Array.isArray(Ut))return ut===Ut;if(ut.length!==Ut.length)return!1;for(var Tt=0;Tt<ut.length;Tt++)if(ut[Tt]!==Ut[Tt])return!1;return!0}function Ne(ut){var Ut,Tt;if(typeof ut!="string")return ut;if(Tt=ut.match(Pe),Tt)return Tt[1];if(ut.charAt(0)==="#"){if(Ut=document.getElementById(ut.substring(1)),Ut)return Ut.tagName==="CANVAS"||Ut.tagName==="VIDEO"||Ut.tagName==="IMG"?Ut:Ut.getAttribute("src");Te('"'+ut+'" asset not found.');return}return ut}function ke(ut){return ut}function Ve(ut){return ut===null?"null":ut.toString()}function Xe(ut,Ut){return ut===Ut}function $e(ut){return ut!=="false"&&ut!==!1}function st(ut){return parseInt(ut,10)}function ze(ut){return parseFloat(ut,10)}function tt(ut){return ut?typeof ut!="string"?ut:ut[0]==="#"&&!be.test(ut)?document.getElementById(ut.substring(1)):document.querySelector(ut):null}function ft(ut){return ut?typeof ut!="string"?ut:Array.prototype.slice.call(document.querySelectorAll(ut),0):null}function Rt(ut){return ut.getAttribute?"#"+ut.getAttribute("id"):Ve(ut)}function Mt(ut){return ut instanceof Array?ut.map(function(Ut){return"#"+Ut.getAttribute("id")}).join(", "):Ve(ut)}function Gt(ut){return Te("`src` property type is deprecated. Use `asset` instead."),Ne(ut)}function _t(ut,Ut,Tt){return se.parse(ut,Ut,Tt)}function Bt(ut,Ut){return ut==="audio"&&typeof Ut!="string"||ut==="array"&&!Array.isArray(Ut)||ut==="asset"&&typeof Ut!="string"||ut==="boolean"&&typeof Ut!="boolean"||ut==="color"&&typeof Ut!="string"||ut==="int"&&typeof Ut!="number"||ut==="number"&&typeof Ut!="number"||ut==="map"&&typeof Ut!="string"||ut==="model"&&typeof Ut!="string"||ut==="selector"&&typeof Ut!="string"&&Ut!==null||ut==="selectorAll"&&typeof Ut!="string"&&Ut!==null||ut==="src"&&typeof Ut!="string"||ut==="string"&&typeof Ut!="string"||ut==="time"&&typeof Ut!="number"?!1:ut==="vec2"?dt(Ut,2):ut==="vec3"?dt(Ut,3):ut==="vec4"?dt(Ut,4):!0}pe.exports.isValidDefaultValue=Bt;function dt(ut,Ut){if(ut===null)return!0;if(typeof ut!="object"||Object.keys(ut).length!==Ut)return!1;var Tt=ut.x,Xt=ut.y,hn=ut.z,nn=ut.w;return!(typeof Tt!="number"||typeof Xt!="number"||Ut>2&&typeof hn!="number"||Ut>3&&typeof nn!="number")}pe.exports.isValidDefaultCoordinate=dt},"./src/core/readyState.js":pe=>{pe.exports.canInitializeElements=!1;function Me(){if(document.readyState==="complete"){ve();return}document.addEventListener("readystatechange",function se(){document.readyState==="complete"&&(document.removeEventListener("readystatechange",se),ve())})}pe.exports.waitForDocumentReadyState=Me;function ve(){pe.exports.canInitializeElements||(pe.exports.canInitializeElements=!0,setTimeout(function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}pe.exports.emitReady=ve},"./src/core/scene/a-scene.js":(pe,Me,ve)=>{var se=ve("./src/core/scene/metaTags.js").inject,me=ve("./src/core/scene/wakelock.js"),Te=ve("./src/core/scene/loadingScreen.js"),Re=ve("./src/core/scene/scenes.js"),be=ve("./src/core/system.js").systems,Pe=ve("./src/core/component.js").components,Le=ve("./src/lib/three.js"),xe=ve("./src/utils/index.js"),Fe=xe.debug("core:a-scene:warn"),Oe=ve("./src/core/a-entity.js").AEntity,Ne=ve("./src/core/a-node.js").ANode,ke=ve("./src/core/scene/postMessage.js"),Ve=xe.device.isIOS(),Xe=xe.device.isMobile(),$e=xe.device.isWebXRAvailable;Ve&&ve("./src/utils/ios-orientationchange-blank-bug.js");class st extends Oe{constructor(){var dt;super(),dt=this,dt.clock=new Le.Clock,dt.isIOS=Ve,dt.isMobile=Xe,dt.hasWebXR=$e,dt.isAR=!1,dt.isScene=!0,dt.object3D=new Le.Scene,dt.object3D.onAfterRender=function(ut,Ut,Tt){dt.isPlaying&&dt.tock(dt.time,dt.delta,Tt)},dt.resize=dt.resize.bind(dt),dt.render=dt.render.bind(dt),dt.systems={},dt.systemNames=[],dt.time=dt.delta=0,dt.usedOfferSession=!1,dt.componentOrder=[],dt.behaviors={},dt.hasLoaded=!1,dt.isPlaying=!1,dt.originalHTML=dt.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var dt=this,ut=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.doConnectedCallback(),_t(this),this.setupRenderer(),Te.setup(this,ft),this.resize(),ut||this.addFullScreenStyles(),ke(this),se(this),me(this),this.onVRPresentChangeBound=this.onVRPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){dt.enterVR()},this.exitVRBound=function(){dt.exitVR()},this.exitVRTrueBound=function(){dt.exitVR(!0)},this.pointerRestrictedBound=function(){dt.pointerRestricted()},this.pointerUnrestrictedBound=function(){dt.pointerUnrestricted()},dt.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){dt.attachedCallbackPostCamera()}),this.initSystems(),this.componentOrder=ze(Pe,this.componentOrder),this.addEventListener("componentregistered",function(){dt.componentOrder=ze(Pe,dt.componentOrder)}),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){dt.enterVR()})}attachedCallbackPostCamera(){var dt,ut=this;window.addEventListener("load",dt),window.addEventListener("resize",function(){ut.isIOS?setTimeout(ut.resize,100):ut.resize()}),this.play(),Re.push(this)}initSystems(){var dt;this.initSystem("camera");for(dt in be)dt!=="camera"&&this.initSystem(dt)}initSystem(dt){this.systems[dt]||(this.systems[dt]=new be[dt](this),this.systemNames.push(dt))}disconnectedCallback(){var dt=Re.indexOf(this);super.disconnectedCallback(),Re.splice(dt,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(dt){var ut,Ut=this.behaviors[dt.name],Tt;Ut||(Ut=this.behaviors[dt.name]={tick:{inUse:!1,array:[],markedForRemoval:[]},tock:{inUse:!1,array:[],markedForRemoval:[]}});for(Tt in Ut)if(dt[Tt]){if(ut=Ut[Tt],ut.inUse){var Xt=ut.markedForRemoval.indexOf(dt);Xt!==-1&&ut.markedForRemoval.splice(Xt,1)}ut.array.indexOf(dt)===-1&&ut.array.push(dt)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return xe.device.checkHeadsetConnected()}enterAR(){var dt;if(!this.hasWebXR)throw dt="Failed to enter AR mode, WebXR not supported.",new Error(dt);if(!xe.device.checkARSupport())throw dt="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(dt);return this.enterVR(!0)}enterVR(dt,ut){var Ut=this,Tt,Xt=Ut.renderer.xr,hn;if(ut&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(Ut.usedOfferSession&&ut)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var nn=Ut.getAttribute("renderer");if(Xt.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var An=this.sceneEl.systems.webxr.sessionReferenceSpaceType;Xt.setReferenceSpaceType(An);var Cn=dt?"immersive-ar":"immersive-vr";return hn=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(hi,Qi){var Zi=ut?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);Ut.usedOfferSession|=ut,Zi(Cn,hn).then(function(Vr){ut&&(Ut.usedOfferSession=!1),Xt.layersEnabled=hn.requiredFeatures.indexOf("layers")!==-1,Xt.setSession(Vr).then(function(){Xt.setFoveation(nn.foveationLevel),Ut.xrSession=Vr,Ut.systems.renderer.setWebXRFrameRate(Vr),Vr.addEventListener("end",Ut.exitVRBound),Qn(hi)})},function(Vr){var Ir=Cn==="immersive-ar",Rr=Ir?"AR":"VR";Qi(new Error("Failed to enter "+Rr+" mode (`requestSession`)",{cause:Vr}))})})}else{if(Tt=xe.device.getVRDisplay(),Xt.setDevice(Tt),Tt.isPresenting&&!window.hasNativeWebVRImplementation)return Qn(),Promise.resolve();var Nn={highRefreshRate:nn.highRefreshRate};return Tt.requestPresent([{source:this.canvas,attributes:Nn}]).then(Qn,fi)}}return Qn(),Promise.resolve();function Qn(hi){var Qi;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Qi=new CustomEvent("vrdisplaypresentchange",{detail:{display:xe.device.getVRDisplay()}}),window.dispatchEvent(Qi)),dt?Ut.addState("ar-mode"):Ut.addState("vr-mode"),Ut.emit("enter-vr",{target:Ut}),!Ut.hasWebXR&&Ut.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),Ut.addFullScreenStyles(),!Ut.isMobile&&!Ut.checkHeadsetConnected()&&Mt(Ut.canvas),Ut.resize(),hi&&hi()}function fi(hi){throw Ut.removeState("vr-mode"),hi&&hi.message?new Error("Failed to enter VR mode (`requestPresent`): "+hi.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var dt=this,ut,Ut=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(Ut.enabled=!1,ut=xe.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(ut.isPresenting)return ut.exitPresent().then(Tt,Xt)}else Gt();return Tt(),Promise.resolve();function Tt(){dt.removeState("vr-mode"),dt.removeState("ar-mode"),dt.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),dt.hasAttribute("embedded")&&dt.removeFullScreenStyles(),dt.resize(),dt.isIOS&&xe.forceCanvasResizeSafariMobile(dt.canvas),dt.renderer.setPixelRatio(window.devicePixelRatio),dt.emit("exit-vr",{target:dt})}function Xt(hn){throw hn&&hn.message?new Error("Failed to exit VR mode (`exitPresent`): "+hn.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var dt=this.getPointerLockElement();dt&&dt!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var dt=this.getPointerLockElement();dt&&dt===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(dt){var ut=dt.display||dt.detail.display;if(ut&&ut.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(dt){var ut=this.systems[dt];return ut?ut.data:Oe.prototype.getAttribute.call(this,dt)}getDOMAttribute(dt){var ut=this.systems[dt];return ut?ut.data:Oe.prototype.getDOMAttribute.call(this,dt)}setAttribute(dt,ut,Ut){if(be[dt]){Ne.prototype.setAttribute.call(this,dt,ut);var Tt=this.systems[dt];Tt&&Tt.updateProperties(ut);return}Oe.prototype.setAttribute.call(this,dt,ut,Ut)}removeBehavior(dt){var ut,Ut,Tt=this.behaviors[dt.name],Xt;for(Ut in Tt)dt[Ut]&&(ut=Tt[Ut],Xt=ut.array.indexOf(dt),Xt!==-1&&(ut.inUse?ut.markedForRemoval.indexOf(dt)===-1&&ut.markedForRemoval.push(dt):(ut.array[Xt]=ut.array[ut.array.length-1],ut.array.pop())))}resize(){var dt=this.camera,ut=this.canvas,Ut,Tt,Xt,hn=this.renderer.xr.isPresenting;Tt=this.renderer.xr.enabled&&hn,!(!dt||!ut||this.is("vr-mode")&&(this.isMobile||Tt))&&(Ut=this.getAttribute("embedded")&&!this.is("vr-mode"),Xt=ft(ut,Ut,this.maxCanvasSize,this.is("vr-mode")),dt.aspect=Xt.width/Xt.height,dt.updateProjectionMatrix(),this.renderer.setSize(Xt.width,Xt.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var dt=this,ut,Ut,Tt,Xt;Xt={alpha:!0,antialias:!Xe,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:-1,width:-1},this.hasAttribute("renderer")&&(Tt=this.getAttribute("renderer"),Ut=xe.styleParser.parse(Tt),Ut.precision&&(Xt.precision=Ut.precision+"p"),Ut.antialias&&Ut.antialias!=="auto"&&(Xt.antialias=Ut.antialias==="true"),Ut.logarithmicDepthBuffer&&Ut.logarithmicDepthBuffer!=="auto"&&(Xt.logarithmicDepthBuffer=Ut.logarithmicDepthBuffer==="true"),Ut.alpha&&(Xt.alpha=Ut.alpha==="true"),Ut.stencil&&(Xt.stencil=Ut.stencil==="true"),Ut.multiviewStereo&&(Xt.multiviewStereo=Ut.multiviewStereo==="true"),this.maxCanvasSize={width:Ut.maxCanvasWidth?parseInt(Ut.maxCanvasWidth):this.maxCanvasSize.width,height:Ut.maxCanvasHeight?parseInt(Ut.maxCanvasHeight):this.maxCanvasSize.height}),ut=this.renderer=new Le.WebGLRenderer(Xt),ut.setPixelRatio(window.devicePixelRatio),this.camera&&ut.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){ut.xr.setPoseTarget(dt.camera.el.object3D)})}play(){var dt=this,ut=this;if(this.renderStarted){Oe.prototype.play.call(this);return}this.addEventListener("loaded",function(){var Ut=this.renderer,Tt,Xt=this.renderer.xr;Oe.prototype.play.call(this),!ut.renderStarted&&(ut.resize(),ut.renderer&&(window.performance&&window.performance.mark("render-started"),Te.remove(),Tt=xe.device.getVRDisplay(),Tt&&Tt.isPresenting&&(Xt.setDevice(Tt),Xt.enabled=!0,ut.enterVR()),Ut.setAnimationLoop(this.render),ut.renderStarted=!0,ut.emit("renderstart")))}),setTimeout(function(){Oe.prototype.load.call(dt)})}updateComponent(dt){dt in be||Oe.prototype.updateComponent.apply(this,arguments)}tick(dt,ut){var Ut,Tt=this.systems;for(this.callComponentBehaviors("tick",dt,ut),Ut=0;Ut<this.systemNames.length;Ut++)Tt[this.systemNames[Ut]].tick&&Tt[this.systemNames[Ut]].tick(dt,ut)}tock(dt,ut,Ut){var Tt,Xt=this.systems;for(this.callComponentBehaviors("tock",dt,ut),Tt=0;Tt<this.systemNames.length;Tt++)Xt[this.systemNames[Tt]].tock&&Xt[this.systemNames[Tt]].tock(dt,ut,Ut)}render(dt,ut){var Ut=this.renderer;this.frame=ut,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var Tt=null;this.is("ar-mode")&&(Tt=this.object3D.background,this.object3D.background=null),Ut.render(this.object3D,this.camera),Tt&&(this.object3D.background=Tt)}callComponentBehaviors(dt,ut,Ut){for(var Tt,Xt=0;Xt<this.componentOrder.length;Xt++){var hn=this.behaviors[this.componentOrder[Xt]];if(hn){var nn=hn[dt];for(nn.inUse=!0,Tt=0;Tt<nn.array.length;Tt++)nn.array[Tt].isPlaying&&nn.array[Tt][dt](ut,Ut);for(nn.inUse=!1,Tt=0;Tt<nn.markedForRemoval.length;Tt++)this.removeBehavior(nn.markedForRemoval[Tt]);nn.markedForRemoval.length=0}}}}function ze(Bt,dt){var ut={},Ut,Tt,Xt=dt||[];Xt.length=0;for(Tt in Bt){var hn=Bt[Tt];if(hn!==void 0){var nn=hn.before?hn.before.slice(0):[],An=hn.after?hn.after.slice(0):[];ut[Tt]={before:nn,after:An,visited:!1,done:!1}}}for(Tt in ut)for(Ut=0;Ut<ut[Tt].before.length;Ut++){var Cn=ut[Tt].before[Ut];if(!(Cn in ut)){Fe("Invalid ordering constraint, no component named `"+Cn+"` referenced by `"+Tt+"`");continue}ut[Cn].after.push(Tt)}function Nn(Qn){if(!(!(Qn in ut)||ut[Qn].done)){if(ut[Qn].visited){Fe("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");return}ut[Qn].visited=!0;for(var fi=0;fi<ut[Qn].after.length;fi++){var hi=ut[Qn].after[fi];hi in ut||Fe("Invalid before/after constraint, no component named `"+hi+"` referenced in `"+Qn+"`"),Nn(hi)}ut[Qn].done=!0,Xt.push(Qn)}}for(Tt in ut)ut[Tt].done||Nn(Tt);return Xt}pe.exports.determineComponentBehaviorOrder=ze;function tt(Bt,dt){var ut,Ut=window.devicePixelRatio;return!dt||dt.width===-1&&dt.height===-1||Bt.width*Ut<dt.width&&Bt.height*Ut<dt.height||(ut=Bt.width/Bt.height,Bt.width*Ut>dt.width&&dt.width!==-1&&(Bt.width=Math.round(dt.width/Ut),Bt.height=Math.round(dt.width/ut/Ut)),Bt.height*Ut>dt.height&&dt.height!==-1&&(Bt.height=Math.round(dt.height/Ut),Bt.width=Math.round(dt.height*ut/Ut))),Bt}customElements.define("a-scene",st);function ft(Bt,dt,ut,Ut){if(!Bt.parentElement)return{height:0,width:0};if(dt){var Tt;return Tt={height:Bt.parentElement.offsetHeight,width:Bt.parentElement.offsetWidth},tt(Tt,ut)}return Rt(ut,Ut)}function Rt(Bt,dt){var ut;return ut={height:document.body.offsetHeight,width:document.body.offsetWidth},dt?ut:tt(ut,Bt)}function Mt(Bt){var dt=Bt.requestFullscreen||Bt.webkitRequestFullscreen||Bt.mozRequestFullScreen||Bt.msRequestFullscreen;dt.apply(Bt,[{navigationUI:"hide"}])}function Gt(){var Bt=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;Bt&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function _t(Bt){var dt;dt=document.createElement("canvas"),dt.classList.add("a-canvas"),dt.dataset.aframeCanvas=!0,Bt.appendChild(dt),document.addEventListener("fullscreenchange",ut),document.addEventListener("mozfullscreenchange",ut),document.addEventListener("webkitfullscreenchange",ut),document.addEventListener("MSFullscreenChange",ut),dt.addEventListener("touchmove",function(Ut){Ut.preventDefault()},{passive:!1}),Bt.canvas=dt,Bt.emit("render-target-loaded",{target:dt}),setTimeout(Bt.resize.bind(Bt),0);function ut(){var Ut=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;Ut||Bt.exitVR(),document.activeElement.blur(),document.body.focus()}}pe.exports.setupCanvas=_t,pe.exports.AScene=st},"./src/core/scene/loadingScreen.js":(pe,Me,ve)=>{var se=ve("./src/utils/index.js"),me=se.styleParser,Te,Re,be,Pe="loading-screen",Le="a-loader-title";pe.exports.setup=function(Ne,ke){Te=Ne,be=ke;var Ve=Te.hasAttribute(Pe)?me.parse(Te.getAttribute(Pe)):void 0,Xe=Ve&&Ve.dotsColor||"white",$e=Ve&&Ve.backgroundColor||"#24CAFF",st=Ve===void 0||Ve.enabled==="true"||Ve.enabled===void 0,ze,tt,ft,Rt,Mt,Gt,_t,Bt,dt,ut;st&&(ze=new THREE.Scene,tt=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),ft=new THREE.MeshBasicMaterial({color:Xe}),Rt=new THREE.Mesh(tt,ft),Mt=Rt.clone(),Gt=Rt.clone(),_t=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),Bt=new THREE.Clock,dt=0,ut=function(){Te.renderer.render(ze,_t),dt=Bt.getElapsedTime()%4,Rt.visible=dt>=1,Mt.visible=dt>=2,Gt.visible=dt>=3},ze.background=new THREE.Color($e),ze.add(_t),Rt.position.set(-1,0,-15),Mt.position.set(0,0,-15),Gt.position.set(1,0,-15),_t.add(Rt),_t.add(Mt),_t.add(Gt),Fe(),setTimeout(function(){Te.hasLoaded||(xe(_t),Re.style.display="block",window.addEventListener("resize",function(){xe(_t)}),Te.renderer.setAnimationLoop(ut))},200))},pe.exports.remove=function(){window.removeEventListener("resize",xe),Re&&(Re.style.display="none")};function xe(Oe){var Ne=Te.hasAttribute("embedded"),ke=be(Te.canvas,Ne,Te.maxCanvasSize,Te.is("vr-mode"));Oe.aspect=ke.width/ke.height,Oe.updateProjectionMatrix(),Te.renderer.setSize(ke.width,ke.height,!1)}function Fe(){Re=document.createElement("div"),Re.className=Le,Re.innerHTML=document.title,Re.style.display="none",Te.appendChild(Re)}},"./src/core/scene/metaTags.js":(pe,Me,ve)=>{var se=ve("./src/constants/index.js"),me=ve("./src/utils/index.js").extend,Te=pe.exports.MOBILE_HEAD_TAGS=[be({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),be({name:"mobile-web-app-capable",content:"yes"}),be({name:"theme-color",content:"black"})],Re=[be({name:"apple-mobile-web-app-capable",content:"yes"}),be({name:"apple-mobile-web-app-status-bar-style",content:"black"}),Pe({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function be(xe){return{tagName:"meta",attributes:xe,exists:function(){return document.querySelector('meta[name="'+xe.name+'"]')}}}function Pe(xe){return{tagName:"link",attributes:xe,exists:function(){return document.querySelector('link[rel="'+xe.rel+'"]')}}}pe.exports.inject=function(Fe){var Oe=document.head,Ne=Oe.querySelector("script"),ke,Ve=[];return Te.forEach(Xe),Fe.isIOS&&Re.forEach(Xe),Ve;function Xe($e){!$e||$e.exists()||(ke=Le($e),ke&&(Ne?Ne.parentNode.insertBefore(ke,Ne):Oe.appendChild(ke),Ve.push(ke)))}};function Le(xe){if(!(!xe||!xe.tagName)){var Fe=document.createElement(xe.tagName);return Fe.setAttribute(se.AFRAME_INJECTED,""),me(Fe,xe.attributes)}}},"./src/core/scene/postMessage.js":(pe,Me,ve)=>{var se=ve("./src/utils/index.js").isIframed;pe.exports=function(Re){se()&&window.addEventListener("message",me.bind(Re))};function me(Te){var Re=this;if(Te.data)switch(Te.data.type){case"vr":switch(Te.data.data){case"enter":Re.enterVR();break;case"exit":Re.exitVR();break}}}},"./src/core/scene/scenes.js":pe=>{pe.exports=[]},"./src/core/scene/wakelock.js":(pe,Me,ve)=>{var se=ve("./vendor/wakelock/wakelock.js");pe.exports=function(Te){if(Te.isMobile){var Re=Te.wakelock=new se;Te.addEventListener("enter-vr",function(){Re.request()}),Te.addEventListener("exit-vr",function(){Re.release()})}}},"./src/core/schema.js":(pe,Me,ve)=>{var se=ve("./src/utils/index.js"),me=ve("./src/core/propertyTypes.js"),Te=se.debug,Re=me.isValidDefaultValue,be=me.propertyTypes,Pe=Te("core:schema:warn");function Le(Ne){return"type"in Ne?typeof Ne.type=="string":"default"in Ne}pe.exports.isSingleProperty=Le,pe.exports.process=function(Ne,ke){var Ve;if(Le(Ne))return xe(Ne,ke);for(Ve in Ne)Ne[Ve]=xe(Ne[Ve],ke);return Ne};function xe(Ne,ke){var Ve=Ne.default,Xe,$e,st=Ne.type;return Ne.type?Ne.type==="bool"?st="boolean":Ne.type==="float"&&(st="number"):Ve!==void 0&&(typeof Ve=="boolean"||typeof Ve=="number")?st=typeof Ve:Array.isArray(Ve)?st="array":st="string",$e=be[st],$e||Pe("Unknown property type for component `"+ke+"`: "+st),Xe=!!Ne.parse,Ne.parse=Ne.parse||$e.parse,Ne.stringify=Ne.stringify||$e.stringify,Ne.equals=Ne.equals||$e.equals,Ne.isCacheable=Ne.isCacheable===!0||$e.isCacheable,Ne.type=st,"default"in Ne?!Xe&&!Re(st,Ve)&&Pe("Default value `"+Ve+"` does not match type `"+st+"` in component `"+ke+"`"):Ne.default=$e.default,Ne}pe.exports.processPropertyDefinition=xe,pe.exports.parseProperties=function(){var Ne=[];return function(ke,Ve,Xe,$e,st){var ze,tt,ft,Rt;Ne.length=0;for(tt in Xe?ke:Ve)Xe&&ke[tt]===void 0||Ne.push(tt);if(ke===null||typeof ke!="object")return ke;for(tt in ke)ke[tt]!==void 0&&!Ve[tt]&&!st&&Pe("Unknown property `"+tt+"` for component/system `"+$e+"`.");for(ze=0;ze<Ne.length;ze++){if(tt=Ne[ze],ft=Ve[tt],Rt=ke[tt],!Ve[tt])return;ke[tt]=Fe(Rt,ft)}return ke}}();function Fe(Ne,ke,Ve){return(Ne==null||Ne==="")&&(Ne=ke.default,Array.isArray(Ne)&&(Ne=Ne.slice())),ke.parse(Ne,ke.default,Ve)}pe.exports.parseProperty=Fe,pe.exports.stringifyProperties=function(Ne,ke){var Ve,Xe,$e,st={},ze;for(Ve in Ne)Xe=ke[Ve],$e=Ne[Ve],ze=$e,typeof ze=="object"&&(ze=Oe($e,Xe),Xe||Pe("Unknown component property: "+Ve)),st[Ve]=ze;return st};function Oe(Ne,ke){return typeof Ne!="object"?Ne:!ke||Ne===null?JSON.stringify(Ne):ke.stringify(Ne)}pe.exports.stringifyProperty=Oe},"./src/core/shader.js":(pe,Me,ve)=>{var se=ve("./src/core/schema.js"),me=se.process,Te=pe.exports.shaders={},Re=pe.exports.shaderNames=[],be=ve("./src/lib/three.js"),Pe=ve("./src/utils/index.js"),Le={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},xe=pe.exports.Shader=function(){};xe.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(Fe){return this.uniforms=this.initUniforms(),this.material=new(this.raw?be.RawShaderMaterial:be.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw||this.glsl3?be.GLSL3:null,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initUniforms:function(){var Fe,Oe=this.schema,Ne={},ke;for(Fe in Oe)Oe[Fe].is==="uniform"&&(ke=Le[Oe[Fe].type],Ne[Fe]={type:ke,value:void 0});return Ne},update:function(Fe){var Oe,Ne,ke=this.schema,Ve=this.uniforms;for(Oe in Fe)if(!(!ke[Oe]||ke[Oe].is!=="uniform")){if(ke[Oe].type==="map"){if(!Ve[Oe]||Ve[Oe].value===Fe[Oe])continue;Ne="_texture_"+Oe,this.setMapOnTextureLoad(Ve,Oe,Ne),Pe.material.updateMapMaterialFromData(Ne,Oe,this,Fe);continue}Ve[Oe].value=this.parseValue(ke[Oe].type,Fe[Oe]),Ve[Oe].needsUpdate=!0}},parseValue:function(Fe,Oe){var Ne;switch(Fe){case"vec2":return new be.Vector2(Oe.x,Oe.y);case"vec3":return new be.Vector3(Oe.x,Oe.y,Oe.z);case"vec4":return new be.Vector4(Oe.x,Oe.y,Oe.z,Oe.w);case"color":return Ne=new be.Color(Oe),new be.Vector3(Ne.r,Ne.g,Ne.b);default:return Oe}},setMapOnTextureLoad:function(Fe,Oe,Ne){var ke=this;this.el.addEventListener("materialtextureloaded",function(){Fe[Oe].value=ke.material[Ne],Fe[Oe].needsUpdate=!0})}},pe.exports.registerShader=function(Fe,Oe){var Ne,ke={};if(Object.keys(Oe).forEach(function(Ve){ke[Ve]={value:Oe[Ve],writable:!0}}),Te[Fe])throw new Error("The shader "+Fe+" has already been registered");return Ne=function(){xe.call(this)},Ne.prototype=Object.create(xe.prototype,ke),Ne.prototype.name=Fe,Ne.prototype.constructor=Ne,Te[Fe]={Shader:Ne,schema:me(Ne.prototype.schema)},Re.push(Fe),Ne}},"./src/core/system.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js"),me=ve("./src/core/schema.js"),Te=ve("./src/utils/index.js"),Re=ve("./src/core/readyState.js"),be=me.parseProperties,Pe=me.parseProperty,Le=me.process,xe=me.isSingleProperty,Fe=Te.styleParser,Oe=pe.exports.systems={},Ne=pe.exports.System=function(ke){var Ve=se&&se.components[this.name];this.el=ke,this.sceneEl=ke,Ve&&(Ve.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};Ne.prototype={schema:{},init:function(){},update:function(ke){},updateProperties:function(ke){var Ve=this.data;Object.keys(me).length&&(this.buildData(ke),this.update(Ve))},buildData:function(ke){var Ve=this.schema;Object.keys(Ve).length&&(ke=ke||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),xe(Ve)?this.data=Pe(ke,Ve):this.data=be(Fe.parse(ke)||{},Ve,!1,this.name))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},pe.exports.registerSystem=function(ke,Ve){var Xe,$e,st={},ze=Te.findAllScenes(document);if(Object.keys(Ve).forEach(function(tt){st[tt]={value:Ve[tt],writable:!0}}),Oe[ke])throw new Error("The system `"+ke+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");if($e=function(tt){Ne.call(this,tt)},$e.prototype=Object.create(Ne.prototype,st),$e.prototype.name=ke,$e.prototype.constructor=$e,$e.prototype.schema=Te.extend(Le($e.prototype.schema)),Oe[ke]=$e,Re.canInitializeElements)for(Xe=0;Xe<ze.length;Xe++)ze[Xe].initSystem(ke)}},"./src/extras/components/index.js":(pe,Me,ve)=>{ve("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").registerComponent,me=ve("./src/lib/three.js"),Te=new me.Vector3,Re=new me.Vector3;se("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var be=this.data,Pe=this.el,Le=Pe.object3D.parent,xe=Pe.object3D,Fe=new me.Group;Te.copy(xe.position),Re.copy(xe.rotation),Le.remove(xe),Fe.add(xe),Le.add(Fe),Pe.object3D=Fe,xe.position.set(-1*be.x,-1*be.y,-1*be.z),Fe.position.set(be.x+Te.x,be.y+Te.y,be.z+Te.z),Fe.rotation.copy(xe.rotation),xe.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(pe,Me,ve)=>{var se=ve("./src/core/component.js").components,me=ve("./src/core/shader.js").shaders,Te=ve("./src/utils/index.js"),Re={};Object.keys(se.material.schema).forEach(be),Object.keys(me.standard.schema).forEach(be);function be(Pe){var Le=Pe.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();Pe==="fog"&&(Le="material-fog"),Pe==="visible"&&(Le="material-visible"),Re[Le]="material."+Pe}pe.exports=function(){return{defaultComponents:{material:{}},mappings:Te.extend({},Re)}}},"./src/extras/primitives/index.js":(pe,Me,ve)=>{ve("./src/extras/primitives/primitives/a-camera.js"),ve("./src/extras/primitives/primitives/a-cursor.js"),ve("./src/extras/primitives/primitives/a-curvedimage.js"),ve("./src/extras/primitives/primitives/a-gltf-model.js"),ve("./src/extras/primitives/primitives/a-image.js"),ve("./src/extras/primitives/primitives/a-light.js"),ve("./src/extras/primitives/primitives/a-link.js"),ve("./src/extras/primitives/primitives/a-obj-model.js"),ve("./src/extras/primitives/primitives/a-sky.js"),ve("./src/extras/primitives/primitives/a-sound.js"),ve("./src/extras/primitives/primitives/a-text.js"),ve("./src/extras/primitives/primitives/a-video.js"),ve("./src/extras/primitives/primitives/a-videosphere.js"),ve("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(pe,Me,ve)=>{var se=ve("./src/core/a-node.js").knownTags,me=ve("./src/core/a-entity.js").AEntity,Te=ve("./src/core/component.js").components,Re=ve("./src/utils/index.js"),be=Re.debug,Pe=Re.entity.setComponentProperty,Le=be("extras:primitives:debug"),xe=be("extras:primitives:warn"),Fe=be("extras:primitives:error"),Oe=pe.exports.primitives={};pe.exports.registerPrimitive=function($e,st){if($e=$e.toLowerCase(),se[$e]){Fe("Trying to register primitive "+$e+" that has been already previously registered");return}se[$e]=!0,Le("Registering <%s>",$e),st.defaultAttributes&&xe("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var ze=st.mappings||{},tt=class extends me{constructor(){super(),this.defaultComponentsFromPrimitive=st.defaultComponents||st.defaultAttributes||{},this.deprecated=st.deprecated||null,this.deprecatedMappings=st.deprecatedMappings||{},this.mappings=ze,st.deprecated&&console.warn(st.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var ft=this.mappings,Rt=this;Object.keys(ft).forEach(function(Gt){var _t;Gt!==Gt.toLowerCase()&&xe("Mapping keys should be specified in lower case. The mapping key "+Gt+" may not be recognized"),Te[Gt]&&(_t=ft[Gt].replace(".","-"),ft[_t]=ft[Gt],delete ft[Gt],console.warn("The primitive "+Rt.tagName.toLowerCase()+" has a mapping collision. The attribute "+Gt+" has the same name as a registered component and has been renamed to "+_t))})}getExtraComponents(){var ft,Rt,Mt,Gt,_t,Bt=this;for(Rt=Re.clone(this.defaultComponentsFromPrimitive),_t=this.getAttribute("mixin"),_t&&(_t=Re.split(_t.trim(),/\s+/),_t.forEach(function(hn){var nn=document.getElementById(hn);if(nn){var An=nn.rawAttributeCache,Cn=nn.componentCache;for(var Nn in An){if(Gt=Bt.mappings[Nn],Gt){Ne(Gt,An[Nn],Rt);return}Nn in Cn&&(Rt[Nn]=dt(Rt[Nn],Cn[Nn]))}}})),Mt=0;Mt<this.attributes.length;Mt++)ft=this.attributes[Mt],Gt=this.mappings[ft.name],Gt&&Ne(Gt,ft.value,Rt);return Rt;function dt(Xt,hn){return ut(Xt)?Ut(hn):ut(hn)?Ut(Xt):Tt(Xt)&&Tt(hn)?Re.extendDeep(Xt,hn):Ut(hn)}function ut(Xt){return typeof Xt>"u"}function Ut(Xt){return Tt(Xt)?Re.extendDeep({},Xt):Xt}function Tt(Xt){return Xt!==null&&Xt.constructor===Object}}attributeChangedCallback(ft,Rt,Mt){var Gt=this.mappings[ft];if(ft in this.deprecatedMappings&&console.warn(this.deprecatedMappings[ft]),!ft||!Gt){super.attributeChangedCallback(ft,Rt,Mt);return}Pe(this,Gt,Mt)}};return customElements.define($e,tt),tt.mappings=ze,Oe[$e]=tt,tt};function Ne(Xe,$e,st){var ze=Re.entity.getComponentPropertyPath(Xe);ze.constructor===Array?(st[ze[0]]=st[ze[0]]||{},st[ze[0]][ze[1]]=$e.trim()):st[ze]=$e.trim()}function ke(Xe,$e){var st=Te[Xe].schema;Object.keys(st).map(function(ze){var tt=ze.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();$e[tt]!==void 0&&(tt=Xe+"-"+ze),$e[tt]=Xe+"."+ze})}function Ve(Xe,$e,st){st=st||{},Object.keys($e).map(function(tt){ke(tt,st)}),pe.exports.registerPrimitive(Xe,Re.extendDeep({},null,{defaultComponents:$e,mappings:st}))}pe.exports.definePrimitive=Ve},"./src/extras/primitives/primitives/a-camera.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/primitives.js").registerPrimitive;se("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js");me("a-cursor",Te.extendDeep({},se(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js");me("a-curvedimage",Te.extendDeep({},se(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/primitives.js").registerPrimitive;se("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js");me("a-image",Te.extendDeep({},se(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/primitives.js").registerPrimitive;se("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/primitives.js").registerPrimitive;se("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js")(),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js");me("a-obj-model",Te.extendDeep({},se,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js"),Re=ve("./src/extras/primitives/primitives/meshPrimitives.js");me("a-sky",Te.extendDeep({},se(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:Te.extendDeep({},Re["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/primitives.js").registerPrimitive;se("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/primitives.js").definePrimitive;se("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js");me("a-video",Te.extendDeep({},se(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/extras/primitives/primitives.js").registerPrimitive,Te=ve("./src/utils/index.js");me("a-videosphere",Te.extendDeep({},se(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(pe,Me,ve)=>{var se=ve("./src/extras/primitives/getMeshMixin.js"),me=ve("./src/core/geometry.js").geometries,Te=ve("./src/core/geometry.js").geometryNames,Re=ve("./src/extras/primitives/primitives.js").registerPrimitive,be=ve("./src/utils/index.js"),Pe=pe.exports={};Te.forEach(function(Fe){var Oe=me[Fe],Ne=Le(Fe),ke={};Object.keys(Oe.schema).forEach(function(st){ke[Le(st)]="geometry."+st});var Ve="a-"+Ne,Xe=Re(Ve,be.extendDeep({},se(),{defaultComponents:{geometry:{primitive:Fe}},mappings:ke}));Pe[Ve]=Xe});function Le(xe){return xe.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(Te){this.geometry=new me.BoxGeometry(Te.width,Te.height,Te.depth,Te.segmentsWidth,Te.segmentsHeight,Te.segmentsDepth)}})},"./src/geometries/circle.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=me.MathUtils.degToRad;se("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(Re){this.geometry=new me.CircleGeometry(Re.radius,Re.segments,Te(Re.thetaStart),Te(Re.thetaLength))}})},"./src/geometries/cone.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=me.MathUtils.degToRad;se("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(Re){this.geometry=new me.CylinderGeometry(Re.radiusTop,Re.radiusBottom,Re.height,Re.segmentsRadial,Re.segmentsHeight,Re.openEnded,Te(Re.thetaStart),Te(Re.thetaLength))}})},"./src/geometries/cylinder.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=me.MathUtils.degToRad;se("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(Re){this.geometry=new me.CylinderGeometry(Re.radius,Re.radius,Re.height,Re.segmentsRadial,Re.segmentsHeight,Re.openEnded,Te(Re.thetaStart),Te(Re.thetaLength))}})},"./src/geometries/dodecahedron.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(Te){this.geometry=new me.DodecahedronGeometry(Te.radius,Te.detail)}})},"./src/geometries/icosahedron.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(Te){this.geometry=new me.IcosahedronGeometry(Te.radius,Te.detail)}})},"./src/geometries/index.js":(pe,Me,ve)=>{ve("./src/geometries/box.js"),ve("./src/geometries/circle.js"),ve("./src/geometries/cone.js"),ve("./src/geometries/cylinder.js"),ve("./src/geometries/dodecahedron.js"),ve("./src/geometries/icosahedron.js"),ve("./src/geometries/octahedron.js"),ve("./src/geometries/plane.js"),ve("./src/geometries/ring.js"),ve("./src/geometries/sphere.js"),ve("./src/geometries/tetrahedron.js"),ve("./src/geometries/torus.js"),ve("./src/geometries/torusKnot.js"),ve("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(Te){this.geometry=new me.OctahedronGeometry(Te.radius,Te.detail)}})},"./src/geometries/plane.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(Te){this.geometry=new me.PlaneGeometry(Te.width,Te.height,Te.segmentsWidth,Te.segmentsHeight)}})},"./src/geometries/ring.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=me.MathUtils.degToRad;se("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(Re){this.geometry=new me.RingGeometry(Re.radiusInner,Re.radiusOuter,Re.segmentsTheta,Re.segmentsPhi,Te(Re.thetaStart),Te(Re.thetaLength))}})},"./src/geometries/sphere.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=me.MathUtils.degToRad;se("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(Re){this.geometry=new me.SphereGeometry(Re.radius,Re.segmentsWidth,Re.segmentsHeight,Te(Re.phiStart),Te(Re.phiLength),Te(Re.thetaStart),Te(Re.thetaLength))}})},"./src/geometries/tetrahedron.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(Te){this.geometry=new me.TetrahedronGeometry(Te.radius,Te.detail)}})},"./src/geometries/torus.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=me.MathUtils.degToRad;se("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(Re){this.geometry=new me.TorusGeometry(Re.radius,Re.radiusTubular*2,Re.segmentsRadial,Re.segmentsTubular,Te(Re.arc))}})},"./src/geometries/torusKnot.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js");se("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(Te){this.geometry=new me.TorusKnotGeometry(Te.radius,Te.radiusTubular*2,Te.segmentsTubular,Te.segmentsRadial,Te.p,Te.q)}})},"./src/geometries/triangle.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").registerGeometry,me=ve("./src/lib/three.js"),Te=new me.Quaternion,Re=new me.Vector3(0,0,1),be=new me.Vector2,Pe=new me.Vector2,Le=new me.Vector2;se("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(xe){var Fe,Oe,Ne,ke,Ve,Xe,$e,st,ze;Ne=new me.Triangle,Ne.a.set(xe.vertexA.x,xe.vertexA.y,xe.vertexA.z),Ne.b.set(xe.vertexB.x,xe.vertexB.y,xe.vertexB.z),Ne.c.set(xe.vertexC.x,xe.vertexC.y,xe.vertexC.z),Oe=Ne.getNormal(new me.Vector3),Te.setFromUnitVectors(Oe,Re),ke=Ne.a.clone().applyQuaternion(Te),Ve=Ne.b.clone().applyQuaternion(Te),Xe=Ne.c.clone().applyQuaternion(Te),be.set(Math.min(ke.x,Ve.x,Xe.x),Math.min(ke.y,Ve.y,Xe.y)),Pe.set(Math.max(ke.x,Ve.x,Xe.x),Math.max(ke.y,Ve.y,Xe.y)),Le.set(0,0).subVectors(Pe,be),ke=new me.Vector2().subVectors(ke,be).divide(Le),Ve=new me.Vector2().subVectors(Ve,be).divide(Le),Xe=new me.Vector2().subVectors(Xe,be).divide(Le),Fe=this.geometry=new me.BufferGeometry,$e=[Ne.a.x,Ne.a.y,Ne.a.z,Ne.b.x,Ne.b.y,Ne.b.z,Ne.c.x,Ne.c.y,Ne.c.z],st=[Oe.x,Oe.y,Oe.z,Oe.x,Oe.y,Oe.z,Oe.x,Oe.y,Oe.z],ze=[ke.x,ke.y,Ve.x,Ve.y,Xe.x,Xe.y],Fe.setAttribute("position",new me.Float32BufferAttribute($e,3)),Fe.setAttribute("normal",new me.Float32BufferAttribute(st,3)),Fe.setAttribute("uv",new me.Float32BufferAttribute(ze,2))}})},"./src/index.js":(pe,Me,ve)=>{if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var se=ve("./src/utils/isIOSOlderThan10.js"),me=se(window.navigator.userAgent)?1/window.devicePixelRatio:1,Te=ve("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),Re={BUFFER_SCALE:me,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new Te(Re)}var be=ve("./src/utils/index.js"),Pe=be.debug,Le=Pe("A-Frame:error"),xe=Pe("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&xe("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&Le("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),be.device.isBrowserEnvironment&&(ve("./src/style/aframe.css"),ve("./src/style/rStats.css"));var Fe=ve("./src/core/scene/a-scene.js").AScene,Oe=ve("./src/core/component.js").components,Ne=ve("./src/core/component.js").registerComponent,ke=ve("./src/core/geometry.js").registerGeometry,Ve=ve("./src/extras/primitives/primitives.js").registerPrimitive,Xe=ve("./src/core/shader.js").registerShader,$e=ve("./src/core/system.js").registerSystem,st=ve("./src/core/shader.js").shaders,ze=ve("./src/core/system.js").systems,tt=window.THREE=ve("./src/lib/three.js"),ft=ve("./src/core/readyState.js"),Rt=ve("./package.json");ve("./src/components/index.js"),ve("./src/geometries/index.js"),ve("./src/shaders/index.js"),ve("./src/systems/index.js");var Mt=ve("./src/core/a-node.js").ANode,Gt=ve("./src/core/a-entity.js").AEntity;ve("./src/core/a-assets.js"),ve("./src/core/a-cubemap.js"),ve("./src/core/a-mixin.js"),ve("./src/extras/components/index.js"),ve("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.6.0 (Date 2024-05-23, Commit #e6c47761)"),console.log("THREE Version (https://github.com/supermedium/three.js):",tt.REVISION),console.log("WebVR Polyfill Version:",Rt.dependencies["webvr-polyfill"]),window.AFRAME_ASYNC||ft.waitForDocumentReadyState(),pe.exports=window.AFRAME={AComponent:ve("./src/core/component.js").Component,AEntity:Gt,ANode:Mt,ANIME:ve("./node_modules/super-animejs/lib/anime.es.js").default,AScene:Fe,components:Oe,coreComponents:Object.keys(Oe),geometries:ve("./src/core/geometry.js").geometries,registerComponent:Ne,registerGeometry:ke,registerPrimitive:Ve,registerShader:Xe,registerSystem:$e,primitives:{getMeshMixin:ve("./src/extras/primitives/getMeshMixin.js"),primitives:ve("./src/extras/primitives/primitives.js").primitives},scenes:ve("./src/core/scene/scenes.js"),schema:ve("./src/core/schema.js"),shaders:st,systems:ze,emitReady:ft.emitReady,THREE:tt,utils:be,version:Rt.version}},"./src/lib/rStatsAframe.js":pe=>{window.aframeStats=function(Me){var ve=null,se=Me,me={te:{caption:"Entities"},lt:{caption:"Load Time"}},Te=[{caption:"A-Frame",values:["te","lt"]}];function Re(){ve("te").set(be()),window.performance.getEntriesByName&&ve("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function be(){var Fe=se.querySelectorAll("*");return Array.prototype.slice.call(Fe).filter(function(Oe){return Oe.isEntity}),Fe.length}function Pe(){}function Le(){}function xe(Fe){ve=Fe}return{update:Re,start:Pe,end:Le,attach:xe,values:me,groups:Te,fractions:[]}},pe.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(pe,Me,ve)=>{var se=ve("./src/lib/three.mjs").default;ve.g.THREE=se,ve("./vendor/DeviceOrientationControls.js"),se.Cache&&(se.Cache.enabled=!0),pe.exports=se},"./src/shaders/flat.js":(pe,Me,ve)=>{var se=ve("./src/core/shader.js").registerShader,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js");pe.exports.Shader=se("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(be){this.materialData={color:new me.Color},Re(be,this.materialData),this.material=new me.MeshBasicMaterial(this.materialData)},update:function(be){this.updateMaterial(be),Te.material.updateMap(this,be)},updateMaterial:function(be){var Pe;Re(be,this.materialData);for(Pe in this.materialData)this.material[Pe]=this.materialData[Pe]}});function Re(be,Pe){return Pe.color.set(be.color),Pe.fog=be.fog,Pe.wireframe=be.wireframe,Pe.toneMapped=be.toneMapped,Pe.wireframeLinewidth=be.wireframeLinewidth,Pe}},"./src/shaders/index.js":(pe,Me,ve)=>{ve("./src/shaders/flat.js"),ve("./src/shaders/standard.js"),ve("./src/shaders/phong.js"),ve("./src/shaders/sdf.js"),ve("./src/shaders/msdf.js"),ve("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(pe,Me,ve)=>{var se=ve("./src/core/shader.js").registerShader,me=ve("./src/lib/three.js"),Te=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),Re=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);pe.exports.Shader=se("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},vertexShader:Te,fragmentShader:Re,init:function(){return this.uniforms=me.UniformsUtils.merge([me.UniformsLib.fog,this.initUniforms()]),this.material=new me.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/phong.js":(pe,Me,ve)=>{var se=ve("./src/core/shader.js").registerShader,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js");pe.exports.Shader=se("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(be){this.materialData={color:new me.Color,specular:new me.Color,emissive:new me.Color},Re(be,this.materialData),this.material=new me.MeshPhongMaterial(this.materialData);var Pe=this.el.sceneEl;Object.defineProperty(this.material,"envMap",{get:function(){return this._envMap||Pe.object3D.environment},set:function(Le){this._envMap=Le}})},update:function(be){this.updateMaterial(be),Te.material.updateMap(this,be),Te.material.updateDistortionMap("normal",this,be),Te.material.updateDistortionMap("displacement",this,be),Te.material.updateDistortionMap("ambientOcclusion",this,be),Te.material.updateDistortionMap("bump",this,be),Te.material.updateEnvMap(this,be)},updateMaterial:function(be){var Pe;Re(be,this.materialData);for(Pe in this.materialData)this.material[Pe]=this.materialData[Pe]}});function Re(be,Pe){switch(Pe.color.set(be.color),Pe.specular.set(be.specular),Pe.emissive.set(be.emissive),Pe.emissiveIntensity=be.emissiveIntensity,Pe.fog=be.fog,Pe.transparent=be.transparent,Pe.wireframe=be.wireframe,Pe.wireframeLinewidth=be.wireframeLinewidth,Pe.shininess=be.shininess,Pe.flatShading=be.flatShading,Pe.wireframe=be.wireframe,Pe.wireframeLinewidth=be.wireframeLinewidth,Pe.reflectivity=be.reflectivity,Pe.refractionRatio=be.refractionRatio,be.combine){case"mix":Pe.combine=me.MixOperation;break;case"multiply":Pe.combine=me.MultiplyOperation;break;case"add":Pe.combine=me.AddOperation;break}return be.normalMap&&(Pe.normalScale=be.normalScale),be.ambientOcclusionMap&&(Pe.aoMapIntensity=be.ambientOcclusionMapIntensity),be.bumpMap&&(Pe.bumpScale=be.bumpMapScale),be.displacementMap&&(Pe.displacementScale=be.displacementScale,Pe.displacementBias=be.displacementBias),Pe}},"./src/shaders/sdf.js":(pe,Me,ve)=>{var se=ve("./src/core/shader.js").registerShader,me=ve("./src/lib/three.js"),Te=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),Re=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);pe.exports.Shader=se("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:Te,fragmentShader:Re,init:function(){return this.uniforms=me.UniformsUtils.merge([me.UniformsLib.fog,this.initUniforms()]),this.material=new me.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/shadow.js":(pe,Me,ve)=>{var se=ve("./src/core/shader.js").registerShader,me=ve("./src/lib/three.js");pe.exports.Shader=se("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(Te){this.material=new me.ShadowMaterial},update:function(Te){this.material.opacity=Te.opacity,this.material.alphaToCoverage=Te.alphaToCoverage,this.material.transparent=Te.transparent}})},"./src/shaders/standard.js":(pe,Me,ve)=>{var se=ve("./src/core/shader.js").registerShader,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js");pe.exports.Shader=se("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(be){this.materialData={color:new me.Color,emissive:new me.Color},Re(be,this.materialData),this.material=new me.MeshStandardMaterial(this.materialData)},update:function(be){this.updateMaterial(be),Te.material.updateMap(this,be),Te.material.updateDistortionMap("normal",this,be),Te.material.updateDistortionMap("displacement",this,be),Te.material.updateDistortionMap("ambientOcclusion",this,be),Te.material.updateDistortionMap("metalness",this,be),Te.material.updateDistortionMap("roughness",this,be),Te.material.updateEnvMap(this,be)},updateMaterial:function(be){var Pe,Le=this.material;Re(be,this.materialData);for(Pe in this.materialData)Le[Pe]=this.materialData[Pe]}});function Re(be,Pe){return Pe.color.set(be.color),Pe.emissive.set(be.emissive),Pe.emissiveIntensity=be.emissiveIntensity,Pe.fog=be.fog,Pe.metalness=be.metalness,Pe.roughness=be.roughness,Pe.wireframe=be.wireframe,Pe.wireframeLinewidth=be.wireframeLinewidth,be.normalMap&&(Pe.normalScale=be.normalScale),be.ambientOcclusionMap&&(Pe.aoMapIntensity=be.ambientOcclusionMapIntensity),be.displacementMap&&(Pe.displacementScale=be.displacementScale,Pe.displacementBias=be.displacementBias),Pe}},"./src/systems/camera.js":(pe,Me,ve)=>{var se=ve("./src/constants/index.js"),me=ve("./src/core/system.js").registerSystem,Te="data-aframe-default-camera";pe.exports.System=me("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var be,Pe,Le=this.sceneEl,xe=this;if(Le.camera&&!Le.camera.el.getAttribute("camera").spectator){Le.emit("cameraready",{cameraEl:Le.camera.el});return}if(be=Le.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!be.length){this.createDefaultCamera();return}for(this.numUserCameras=be.length,Pe=0;Pe<be.length;Pe++)be[Pe].addEventListener("object3dset",function(Fe){Fe.detail.type==="camera"&&xe.checkUserCamera(this)}),be[Pe].isNode?be[Pe].load():be[Pe].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(be){var Pe,Le=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(Pe=be.getAttribute("camera"),!Pe.active||Pe.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,Le.camera=be.getObject3D("camera"),Le.emit("cameraready",{cameraEl:be})}},createDefaultCamera:function(){var be,Pe=this.sceneEl;be=document.createElement("a-entity"),be.setAttribute("camera",{active:!0}),be.setAttribute("position",{x:0,y:se.DEFAULT_CAMERA_HEIGHT,z:0}),be.setAttribute("wasd-controls",""),be.setAttribute("look-controls",""),be.setAttribute(se.AFRAME_INJECTED,""),be.addEventListener("object3dset",function(Le){Le.detail.type==="camera"&&(Pe.camera=Le.detail.object,Pe.emit("cameraready",{cameraEl:be}))}),Pe.appendChild(be)},disableActiveCamera:function(){var be,Pe;be=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),Pe=be[be.length-1],Pe.setAttribute("camera","active",!0)},setActiveCamera:function(be){var Pe,Le,xe,Fe,Oe=this.activeCameraEl,Ne=this.sceneEl;if(Fe=be.getObject3D("camera"),!(!Fe||be===this.activeCameraEl)){var ke=Ne.querySelector("["+Te+"]"),Ve=ke&&ke.querySelector(":not(a-mixin)[camera]");for(be!==Ve&&Re(Ne),this.activeCameraEl=be,this.activeCameraEl.play(),Ne.camera=Fe,Oe&&Oe.setAttribute("camera","active",!1),Le=Ne.querySelectorAll(":not(a-mixin)[camera]"),xe=0;xe<Le.length;xe++)Pe=Le[xe],!(!Pe.isEntity||be===Pe)&&(Pe.setAttribute("camera","active",!1),Pe.pause());Ne.emit("camera-set-active",{cameraEl:be})}},setSpectatorCamera:function(be){var Pe,Le=this.spectatorCameraEl,xe=this.sceneEl,Fe;Pe=be.getObject3D("camera"),!(!Pe||be===this.spectatorCameraEl)&&(Le&&Le.setAttribute("camera","spectator",!1),Fe=this.spectatorCameraEl=be,xe.addEventListener("enter-vr",this.wrapRender),xe.addEventListener("exit-vr",this.unwrapRender),Fe.setAttribute("camera","active",!1),Fe.play(),xe.emit("camera-set-spectator",{cameraEl:be}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(be,Pe){var Le,xe=this.sceneEl,Fe;Le=xe.renderer.xr.enabled,this.originalRender.call(xe.renderer,be,Pe),!(!this.spectatorCameraEl||xe.isMobile||!Le)&&(Fe=this.spectatorCameraEl.components.camera.camera,xe.renderer.xr.enabled=!1,this.originalRender.call(xe.renderer,be,Fe),xe.renderer.xr.enabled=Le)}});function Re(be){var Pe,Le=be.camera;Le&&(Pe=be.querySelector("["+Te+"]"),Pe&&be.removeChild(Pe))}},"./src/systems/geometry.js":(pe,Me,ve)=>{var se=ve("./src/core/geometry.js").geometries,me=ve("./src/core/system.js").registerSystem;pe.exports.System=me("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(Pe){var Le=this.cache,xe,Fe;return Pe.skipCache?Te(Pe):(Fe=this.hash(Pe),xe=Le[Fe],be(this.cacheCount,Fe),xe||(xe=Te(Pe),Le[Fe]=xe,xe))},unuseGeometry:function(Pe){var Le=this.cache,xe=this.cacheCount,Fe,Oe;Pe.skipCache||(Oe=this.hash(Pe),Le[Oe]&&(Re(xe,Oe),!(xe[Oe]>0)&&(Fe=Le[Oe],Fe.dispose(),delete Le[Oe],delete xe[Oe])))},hash:function(Pe){return JSON.stringify(Pe)}});function Te(Pe){var Le=Pe.primitive,xe=se[Le]&&se[Le].Geometry,Fe=new xe;if(!xe)throw new Error("Unknown geometry `"+Le+"`");return Fe.init(Pe),Fe.geometry}function Re(Pe,Le){Pe[Le]--}function be(Pe,Le){Pe[Le]=Pe[Le]===void 0?1:Pe[Le]+1}},"./src/systems/gltf-model.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/lib/three.js");function Te(Re){return new Promise(function(be,Pe){var Le=document.createElement("script");document.body.appendChild(Le),Le.onload=be,Le.onerror=Pe,Le.async=!0,Le.src=Re})}pe.exports.System=se("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var Re=this.data.dracoDecoderPath,be=this.data.basisTranscoderPath,Pe=this.data.meshoptDecoderPath;!this.dracoLoader&&Re&&(this.dracoLoader=new me.DRACOLoader,this.dracoLoader.setDecoderPath(Re)),!this.ktx2Loader&&be&&(this.ktx2Loader=new me.KTX2Loader,this.ktx2Loader.setTranscoderPath(be).detectSupport(this.el.renderer)),!this.meshoptDecoder&&Pe&&(this.meshoptDecoder=Te(Pe).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(pe,Me,ve)=>{ve("./src/systems/camera.js"),ve("./src/systems/geometry.js"),ve("./src/systems/gltf-model.js"),ve("./src/systems/light.js"),ve("./src/systems/material.js"),ve("./src/systems/obb-collider.js"),ve("./src/systems/renderer.js"),ve("./src/systems/shadow.js"),ve("./src/systems/tracked-controls-webvr.js"),ve("./src/systems/tracked-controls-webxr.js"),ve("./src/systems/webxr.js")},"./src/systems/light.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/constants/index.js"),Te="data-aframe-default-light";pe.exports.System=se("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",this.setupDefaultLights.bind(this))},registerLight:function(Re){Re.hasAttribute(Te)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var Re,be=this.sceneEl;if(this.defaultLights){Re=document.querySelectorAll("["+Te+"]");for(var Pe=0;Pe<Re.length;Pe++)be.removeChild(Re[Pe]);this.defaultLights=!1}},setupDefaultLights:function(){var Re=this.sceneEl,be,Pe;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(be=document.createElement("a-entity"),be.setAttribute("light",{color:"#BBB",type:"ambient"}),be.setAttribute(Te,""),be.setAttribute(me.AFRAME_INJECTED,""),Re.appendChild(be),Pe=document.createElement("a-entity"),Pe.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),Pe.setAttribute("position",{x:-.5,y:1,z:1}),Pe.setAttribute(Te,""),Pe.setAttribute(me.AFRAME_INJECTED,""),Re.appendChild(Pe),this.defaultLights=!0)}})},"./src/systems/material.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/lib/three.js"),Te=ve("./src/utils/index.js"),Re=ve("./src/utils/material.js").setTextureProperties,be=ve("./src/utils/material.js").createCompatibleTexture,Pe=Te.debug,Le=Pe("components:texture:error"),xe=Pe("components:texture:warn"),Fe=new me.ImageLoader;pe.exports.System=se("material",{init:function(){this.materials={},this.sourceCache={}},clearTextureSourceCache:function(){this.sourceCache={}},loadTexture:function(Ve,Xe,$e){this.loadTextureSource(Ve,function(ze){var tt=be(ze);Re(tt,Xe),$e(tt)})},loadTextureSource:function(Ve,Xe){var $e=this,st=this.sourceCache,ze=this.hash(Ve);if(st[ze]){st[ze].then(Xe);return}if(Ve.tagName==="CANVAS"){ft(new me.Source(Ve));return}ft(new Promise(tt));function tt(Rt,Mt){Te.srcLoader.validateSrc(Ve,Gt,_t);function Gt(Bt){$e.loadImage(Bt,Rt)}function _t(Bt){$e.loadVideo(Bt,Rt)}}function ft(Rt){st[ze]=Promise.resolve(Rt),st[ze].then(Xe)}},loadCubeMapTexture:function(Ve,Xe){var $e=this,st=0,ze=new me.CubeTexture;ze.colorSpace=me.SRGBColorSpace;function tt(Rt){$e.loadTextureSource(Ve[Rt],function(Mt){ze.images[Rt]=Mt,st++,st===6&&(ze.needsUpdate=!0,Xe(ze))})}if(Ve.length!==6){xe("Cube map texture requires exactly 6 sources, got only %s sources",Ve.length);return}for(var ft=0;ft<Ve.length;ft++)tt(ft)},loadImage:function(Ve,Xe){if(typeof Ve!="string"){Xe(new me.Source(Ve));return}Xe(Oe(Ve))},loadVideo:function(Ve,Xe){var $e;typeof Ve!="string"&&($e=Ve,ke($e)),$e=$e||Ne(Ve),Xe(new me.Source($e))},hash:function(Ve){return Ve.tagName&&(Ve.id||Ve.src)||Ve},registerMaterial:function(Ve){this.materials[Ve.uuid]=Ve},unregisterMaterial:function(Ve){delete this.materials[Ve.uuid]}});function Oe(Ve){return new Promise(Xe);function Xe($e,st){Fe.load(Ve,ze,function(){},function(tt){Le("`$s` could not be fetched (Error code: %s; Response: %s)",tt.status,tt.statusText)});function ze(tt){$e(new me.Source(tt))}}}function Ne(Ve){var Xe=document.createElement("video");return Xe.setAttribute("playsinline",""),Xe.setAttribute("webkit-playsinline",""),Xe.autoplay=!0,Xe.loop=!0,Xe.crossOrigin="anonymous",Xe.addEventListener("error",function(){xe("`%s` is not a valid video",Ve)},!0),Xe.src=Ve,Xe}function ke(Ve){return Ve.autoplay=Ve.hasAttribute("autoplay")&&Ve.getAttribute("autoplay")!=="false",Ve.controls=Ve.hasAttribute("controls")&&Ve.getAttribute("controls")!=="false",Ve.getAttribute("loop")==="false"&&Ve.removeAttribute("loop"),Ve.getAttribute("preload")==="false"&&(Ve.preload="none"),Ve.crossOrigin=Ve.crossOrigin||"anonymous",Ve.setAttribute("playsinline",""),Ve.setAttribute("webkit-playsinline",""),Ve}},"./src/systems/obb-collider.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem;se("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(me){this.colliderEls.push(me),this.data.showColliders?me.components["obb-collider"].showCollider():me.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(me){var Te=this.colliderEls,Re=Te.indexOf(me);me.components["obb-collider"].hideCollider(),Re>-1&&Te.splice(Re,1),Te.length===0&&(this.tick=void 0)},registerCollision:function(me,Te){var Re=this.collisions,be=!1,Pe=me.obb,Le=Te.obb,xe=me.renderColliderMesh,Fe=Te.renderColliderMesh;xe&&xe.material.color.set(16711680),Fe&&Fe.material.color.set(16711680);for(var Oe=0;Oe<Re.length;Oe++)if(Re[Oe].componentA.obb===Pe&&Re[Oe].componentB.obb===Le||Re[Oe].componentA.obb===Le&&Re[Oe].componentB.obb===Pe){be=!0,Re[Oe].detected=!0;break}be||(Re.push({componentA:me,componentB:Te,detected:!0}),me.el.emit("obbcollisionstarted",{trackedObject3D:me.trackedObject3D,withEl:Te.el}),Te.el.emit("obbcollisionstarted",{trackedObject3D:Te.trackedObject3D,withEl:me.el}))},resetCollisions:function(){for(var me=this.collisions,Te=0;Te<me.length;Te++)me[Te].detected=!1},clearCollisions:function(){for(var me=this.collisions,Te=[],Re,be,Pe,Le,xe=0;xe<me.length;xe++)me[xe].detected?Te.push(me[xe]):(Re=me[xe].componentA,be=me[xe].componentB,Pe=Re.renderColliderMesh,Le=be.renderColliderMesh,Pe&&Pe.material.color.set(65280),Re.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:be.el}),Le&&Le.material.color.set(65280),be.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:Re.el}));this.collisions=Te},detectCollisions:function(){var me,Te,Re,be,Pe=this.colliderEls;if(!(Pe.length<2)){this.resetCollisions();for(var Le=0;Le<Pe.length;Le++)if(Re=Pe[Le].components["obb-collider"],me=Pe[Le].components["obb-collider"].obb,!(me.halfSize.x===0||me.halfSize.y===0||me.halfSize.z===0))for(var xe=Le+1;xe<Pe.length;xe++)be=Pe[xe].components["obb-collider"],Te=be.obb,!(Te.halfSize.x===0||Te.halfSize.y===0||Te.halfSize.z===0)&&me.intersectsOBB(Te)&&this.registerCollision(Re,be);this.clearCollisions()}}})},"./src/systems/renderer.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/utils/index.js"),Te=ve("./src/lib/three.js"),Re=me.debug,be=Re("components:renderer:warn");pe.exports.System=se("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:me.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},stencil:{default:!1},foveationLevel:{default:1}},init:function(){var Fe=this.data,Oe=this.el,Ne=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),ke=Oe.renderer;Fe.physicallyCorrectLights||(ke.useLegacyLights=!Fe.physicallyCorrectLights),ke.toneMapping=Te[Ne+"ToneMapping"],Te.Texture.DEFAULT_ANISOTROPY=Fe.anisotropy,Te.ColorManagement.enabled=Fe.colorManagement,ke.outputColorSpace=Fe.colorManagement?Te.SRGBColorSpace:Te.LinearSRGBColorSpace,Oe.hasAttribute("antialias")&&be('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),Oe.hasAttribute("logarithmicDepthBuffer")&&be('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),ke.sortObjects=!0,ke.setOpaqueSort(Pe)},update:function(){var Fe=this.data,Oe=this.el,Ne=Oe.renderer,ke=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);Ne.toneMapping=Te[ke+"ToneMapping"],Ne.toneMappingExposure=Fe.exposure,Ne.xr.setFoveation(Fe.foveationLevel),Fe.sortObjects&&be('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),Fe.sortTransparentObjects?Ne.setTransparentSort(xe):Ne.setTransparentSort(Le)},applyColorCorrection:function(Fe){!this.data.colorManagement||!Fe||Fe.isTexture&&Fe.colorSpace!==Te.SRGBColorSpace&&(Fe.colorSpace=Te.SRGBColorSpace,Fe.needsUpdate=!0)},setWebXRFrameRate:function(Fe){var Oe=this.data,Ne=Fe.supportedFrameRates;if(Ne&&Fe.updateTargetFrameRate){var ke;Ne.includes(90)?ke=Oe.highRefreshRate?90:72:ke=Oe.highRefreshRate?72:60,Fe.updateTargetFrameRate(ke).catch(function(Ve){console.warn("failed to set target frame rate of "+ke+". Error info: "+Ve)})}}});function Pe(Fe,Oe){return Fe.groupOrder!==Oe.groupOrder?Fe.groupOrder-Oe.groupOrder:Fe.renderOrder!==Oe.renderOrder?Fe.renderOrder-Oe.renderOrder:Fe.z-Oe.z}function Le(Fe,Oe){return Fe.groupOrder!==Oe.groupOrder?Fe.groupOrder-Oe.groupOrder:Fe.renderOrder-Oe.renderOrder}function xe(Fe,Oe){return Fe.groupOrder!==Oe.groupOrder?Fe.groupOrder-Oe.groupOrder:Fe.renderOrder!==Oe.renderOrder?Fe.renderOrder-Oe.renderOrder:Oe.z-Fe.z}pe.exports.sortFrontToBack=Pe,pe.exports.sortRenderOrderOnly=Le,pe.exports.sortBackToFront=xe},"./src/systems/shadow.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/lib/three.js"),Te={basic:me.BasicShadowMap,pcf:me.PCFShadowMap,pcfsoft:me.PCFSoftShadowMap};pe.exports.System=se("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var be=this.sceneEl,Pe=this.data;this.shadowMapEnabled=!1,be.renderer.shadowMap.type=Te[Pe.type],be.renderer.shadowMap.autoUpdate=Pe.autoUpdate},update:function(be){be.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(be){var Pe=this.sceneEl,Le=this.sceneEl.renderer;this.shadowMapEnabled=be;var xe=this.data.enabled&&this.shadowMapEnabled;Le&&xe!==Le.shadowMap.enabled&&(Le.shadowMap.enabled=xe,Re(Pe))}});function Re(be){be.hasLoaded&&be.object3D.traverse(function(Pe){if(Pe.material)for(var Le=Array.isArray(Pe.material)?Pe.material:[Pe.material],xe=0;xe<Le.length;xe++)Le[xe].needsUpdate=!0})}},"./src/systems/tracked-controls-webvr.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/utils/index.js"),Te=me.device.isWebXRAvailable;pe.exports.System=se("tracked-controls-webvr",{init:function(){var Re=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=me.throttle(this.updateControllerList,500,this),!Te&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(be){be.length&&(Re.vrDisplay=be[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var Re=this.controllers,be,Pe,Le,xe;if(Pe=navigator.getGamepads&&navigator.getGamepads(),!!Pe){for(xe=Re.length,Re.length=0,Le=0;Le<Pe.length;++Le)be=Pe[Le],be&&be.pose&&Re.push(be);Re.length!==xe&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/utils/index.js");pe.exports.System=se("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=me.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var Te=this,Re=this.el.xrSession;if(!Re){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var be=Te.el.sceneEl.systems.webxr.sessionReferenceSpaceType;Re.requestReferenceSpace(be).then(function(Pe){Te.referenceSpace=Pe}).catch(function(Pe){throw Te.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(be,'tracked-controls-webxr uses reference space "'+be+'".'),Pe})},updateControllerList:function(){var Te=this.el.xrSession,Re=this.oldControllers,be;if(!Te){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(Te.inputSources){if(this.controllers=Te.inputSources,this.oldControllersLength===this.controllers.length){var Pe=!0;for(be=0;be<this.controllers.length;++be)if(!(this.controllers[be]===Re[be]&&this.controllers[be].gamepad===Re[be].gamepad)){Pe=!1;break}if(Pe)return}for(Re.length=0,be=0;be<this.controllers.length;be++)Re.push(this.controllers[be]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(pe,Me,ve)=>{var se=ve("./src/core/system.js").registerSystem,me=ve("./src/utils/index.js"),Te=me.debug("systems:webxr:warn");pe.exports.System=se("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var Re=this.data;this.sessionConfiguration={requiredFeatures:Re.requiredFeatures,optionalFeatures:Re.optionalFeatures},this.sessionReferenceSpaceType=Re.referenceSpaceType,Re.overlayElement&&(Re.overlayElement.classList.remove("a-dom-overlay"),Re.optionalFeatures.includes("dom-overlay")||(Re.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",Re)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:Re.overlayElement},Re.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(Re){return!!(Re==="viewer"||Re==="local"||this.sessionConfiguration.requiredFeatures.includes(Re)||this.sessionConfiguration.optionalFeatures.includes(Re))},warnIfFeatureNotRequested:function(Re,be){if(!this.wasFeatureRequested(Re)){var Pe='Please add the feature "'+Re+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;Te((be?be+" ":"")+Pe)}}})},"./src/utils/coordinates.js":(pe,Me,ve)=>{var se=ve("./src/utils/debug.js"),me=se("utils:coordinates:warn"),Te=["x","y","z","w"],Re=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;pe.exports.regex=Re;var be=/\s+/g;function Pe(Ne,ke,Ve){var Xe,$e,st,ze,tt=Ve&&typeof Ve=="object"?Ve:{},ft,Rt,Mt,Gt;if(Ne&&Ne instanceof Object)return ft=Ne.x===void 0?ke&&ke.x:Ne.x,Rt=Ne.y===void 0?ke&&ke.y:Ne.y,Mt=Ne.z===void 0?ke&&ke.z:Ne.z,Gt=Ne.w===void 0?ke&&ke.w:Ne.w,ft!=null&&(tt.x=Oe(ft)),Rt!=null&&(tt.y=Oe(Rt)),Mt!=null&&(tt.z=Oe(Mt)),Gt!=null&&(tt.w=Oe(Gt)),tt;if(Ne==null)return typeof ke=="object"?Object.assign(tt,ke):ke;for(Xe=Ne.trim().split(be),ze=0;ze<Te.length;ze++)if(st=Te[ze],Xe[ze])tt[st]=parseFloat(Xe[ze],10);else{if($e=ke&&ke[st],$e===void 0)continue;tt[st]=Oe($e)}return tt}pe.exports.parse=Pe;function Le(Ne){var ke;return typeof Ne!="object"?Ne:(ke=Ne.x+" "+Ne.y,Ne.z!=null&&(ke+=" "+Ne.z),Ne.w!=null&&(ke+=" "+Ne.w),ke)}pe.exports.stringify=Le;function xe(Ne,ke){return typeof Ne!="object"||typeof ke!="object"?Ne===ke:Ne.x===ke.x&&Ne.y===ke.y&&Ne.z===ke.z&&Ne.w===ke.w}pe.exports.equals=xe;function Fe(Ne){return Re.test(Ne)}pe.exports.isCoordinates=Fe,pe.exports.isCoordinate=function(Ne){return me("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),Fe(Ne)};function Oe(Ne){return Ne!=null&&Ne.constructor===String?parseFloat(Ne,10):Ne}pe.exports.toVector3=function(Ne){return new THREE.Vector3(Ne.x,Ne.y,Ne.z)}},"./src/utils/debug.js":(pe,Me,ve)=>{var se=ve("./node_modules/debug/src/browser.js"),me=ve("./src/utils/device.js").isBrowserEnvironment,Te={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};se.formatArgs=Re;function Re(Fe){if(Fe[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+Fe[0]+(this.useColors?"%c ":" "),!!this.useColors){this.color=Pe(this.namespace);var Oe="color: "+this.color;Fe.splice(1,0,Oe,"color: inherit");var Ne=0,ke=0;Fe[0].replace(/%[a-zA-Z%]/g,function(Ve){Ve!=="%%"&&(Ne++,Ve==="%c"&&(ke=Ne))}),Fe.splice(ke,0,Oe)}}function be(Fe){var Oe=Fe.split(":");return Oe[Oe.length-1]}function Pe(Fe){var Oe=be(Fe),Ne=Te.colors[Oe];return Ne||null}function Le(){try{return window.localStorage}catch{}}var xe=Le();xe&&(parseInt(xe.logs,10)||xe.logs==="true")?se.enable("*"):se.enable("*:error,*:info,*:warn"),me&&(window.logs=se),pe.exports=se},"./src/utils/device.js":(pe,Me,ve)=>{var se=ve("./node_modules/debug/src/browser.js")("device:error"),me,Te=!1,Re=!1,be=pe.exports.isWebXRAvailable=navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(Mt){var Gt;be||(Gt=document.createElement("canvas"),me=Mt.display,Gt.getContext("webgl",{}),me.requestPresent([{source:Gt}]).then(function(){},function(){}))}),be){var Pe=function(){var Mt=document.querySelector("a-scene");if(!Mt){window.addEventListener("DOMContentLoaded",Pe);return}Mt.hasLoaded?Mt.components["xr-mode-ui"].updateEnterInterfaces():Mt.addEventListener("loaded",Pe)},Le=function(Mt){se("WebXR session support error: "+Mt.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(Mt){Te=Mt,Pe()}).catch(Le),navigator.xr.isSessionSupported("immersive-ar").then(function(Mt){Re=Mt,Pe()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){Te=!0,Pe()}).catch(Le),navigator.xr.supportsSession("immersive-ar").then(function(){Re=!0,Pe()}).catch(function(){})):se("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(Mt){var Gt=document.querySelector("a-scene");me=Mt.length&&Mt[0],Gt&&Gt.emit("displayconnected",{vrDisplay:me})});function xe(){return me}pe.exports.getVRDisplay=xe;function Fe(){return Te||Re||!!xe()}pe.exports.checkHeadsetConnected=Fe;function Oe(){return Re}pe.exports.checkARSupport=Oe;function Ne(){return Te}pe.exports.checkVRSupport=Ne;var ke=function(){var Mt=!1;return function(Gt){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Gt)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Gt.substr(0,4)))&&(Mt=!0),($e()||Ve()||Rt())&&(Mt=!0),ft()&&(Mt=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return Mt}}();pe.exports.isMobile=ke;function Ve(Mt){var Gt=Mt||window.navigator.userAgent,_t=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(Gt);return _t||Xe()}pe.exports.isTablet=Ve;function Xe(Mt,Gt,_t){var Bt=Mt||window.navigator.userAgent,dt=Gt||window.navigator.platform,ut=_t||window.navigator.maxTouchPoints||0;return(dt==="iPad"||dt==="MacIntel")&&ut>0&&/Macintosh|Intel|iPad|ipad/i.test(Bt)&&!window.MSStream}pe.exports.isIpad=Xe;function $e(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}pe.exports.isIOS=$e;function st(){return!ke()&&!ft()&&window.orientation!==void 0}pe.exports.isMobileDeviceRequestingDesktopSite=st;function ze(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}pe.exports.isOculusBrowser=ze;function tt(){return/(Mobile VR)/i.test(window.navigator.userAgent)}pe.exports.isFirefoxReality=tt;function ft(){return ze()||tt()}pe.exports.isMobileVR=ft;function Rt(){return/R7 Build/.test(window.navigator.userAgent)}pe.exports.isR7=Rt,pe.exports.isLandscape=function(){var Mt=window.orientation;return Rt()&&(Mt+=90),Mt===90||Mt===-90},pe.exports.isBrowserEnvironment=typeof process>"u"||process.browser===!0,pe.exports.isNodeEnvironment=!pe.exports.isBrowserEnvironment},"./src/utils/entity.js":(pe,Me,ve)=>{var se=ve("./src/utils/split.js").split;function me(Te,Re){Re=Re||".";var be=se(Te,Re);return be.length===1?be[0]:be}pe.exports.getComponentPropertyPath=me,pe.exports.getComponentProperty=function(Te,Re,be){var Pe;return be=be||".",Re.indexOf(be)!==-1?(Pe=me(Re,be),Pe.constructor===String?Te.getAttribute(Pe):Te.getAttribute(Pe[0])[Pe[1]]):Te.getAttribute(Re)},pe.exports.setComponentProperty=function(Te,Re,be,Pe){var Le;if(Pe=Pe||".",Re.indexOf(Pe)!==-1){Le=me(Re,Pe),Le.constructor===String?Te.setAttribute(Le,be):Te.setAttribute(Le[0],Le[1],be);return}Te.setAttribute(Re,be)}},"./src/utils/forceCanvasResizeSafariMobile.js":pe=>{pe.exports=function(ve){var se=ve.style.width,me=ve.style.height;ve.style.width=parseInt(se,10)+1+"px",ve.style.height=parseInt(me,10)+1+"px",setTimeout(function(){ve.style.width=se,ve.style.height=me},200)}},"./src/utils/index.js":(pe,Me,ve)=>{var se=ve("./src/utils/debug.js"),me=ve("./node_modules/deep-assign/index.js"),Te=ve("./src/utils/device.js"),Re=ve("./src/utils/object-pool.js"),be=se("utils:warn");pe.exports.bind=function(Le){return Le.bind.apply(Le,Array.prototype.slice.call(arguments,1))},pe.exports.coordinates=ve("./src/utils/coordinates.js"),pe.exports.debug=se,pe.exports.device=Te,pe.exports.entity=ve("./src/utils/entity.js"),pe.exports.forceCanvasResizeSafariMobile=ve("./src/utils/forceCanvasResizeSafariMobile.js"),pe.exports.material=ve("./src/utils/material.js"),pe.exports.objectPool=Re,pe.exports.split=ve("./src/utils/split.js").split,pe.exports.styleParser=ve("./src/utils/styleParser.js"),pe.exports.trackedControls=ve("./src/utils/tracked-controls.js"),pe.exports.checkHeadsetConnected=function(){return be("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),Te.checkHeadsetConnected(arguments)},pe.exports.isGearVR=pe.exports.device.isGearVR=function(){be("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},pe.exports.isIOS=function(){return be("`utils.isIOS` has moved to `utils.device.isIOS`"),Te.isIOS(arguments)},pe.exports.isOculusGo=pe.exports.device.isOculusGo=function(){be("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},pe.exports.isMobile=function(){return be("`utils.isMobile has moved to `utils.device.isMobile`"),Te.isMobile(arguments)},pe.exports.throttle=function(Le,xe,Fe){var Oe;return Fe&&(Le=Le.bind(Fe)),function(){var Ne=Date.now(),ke=typeof Oe>"u"?xe:Ne-Oe;(typeof Oe>"u"||ke>=xe)&&(Oe=Ne,Le.apply(null,arguments))}},pe.exports.throttleLeadingAndTrailing=function(Le,xe,Fe){var Oe,Ne;Fe&&(Le=Le.bind(Fe));var ke,Ve=function(){Oe=Date.now(),Le.apply(this,ke),Ne=void 0};return function(){var Xe=Date.now(),$e=typeof Oe>"u"?xe:Xe-Oe;$e>=xe?(clearTimeout(Ne),Ne=void 0,Oe=Xe,Le.apply(null,arguments)):(Ne=Ne||setTimeout(Ve,xe-$e),ke=arguments)}},pe.exports.throttleTick=function(Le,xe,Fe){var Oe;return Fe&&(Le=Le.bind(Fe)),function(Ne,ke){var Ve=typeof Oe>"u"?ke:Ne-Oe;(typeof Oe>"u"||Ve>=xe)&&(Oe=Ne,Le(Ne,Ve))}},pe.exports.debounce=function(Le,xe,Fe){var Oe;return function(){var Ne=this,ke=arguments,Ve=function(){Oe=null,Fe||Le.apply(Ne,ke)},Xe=Fe&&!Oe;clearTimeout(Oe),Oe=setTimeout(Ve,xe),Xe&&Le.apply(Ne,ke)}},pe.exports.extend=Object.assign,pe.exports.extendDeep=me,pe.exports.clone=function(Le){return JSON.parse(JSON.stringify(Le))};var Pe=function(){var Le=Re.createPool(function(){return[]});return function(xe,Fe){var Oe,Ne,ke,Ve,Xe,$e;if(xe===void 0||Fe===void 0||xe===null||Fe===null||!(xe&&Fe&&xe.constructor===Object&&Fe.constructor===Object||xe.constructor===Array&&Fe.constructor===Array))return xe===Fe;Ne=Le.use(),ke=Le.use(),Ne.length=0,ke.length=0;for(Oe in xe)Ne.push(Oe);for(Oe in Fe)ke.push(Oe);if(Ne.length!==ke.length)return Le.recycle(Ne),Le.recycle(ke),!1;for(Ve=0;Ve<Ne.length;++Ve)if(Xe=xe[Ne[Ve]],$e=Fe[Ne[Ve]],typeof Xe=="object"||typeof $e=="object"||Array.isArray(Xe)&&Array.isArray($e)){if(Xe===$e)continue;if(!Pe(Xe,$e))return Le.recycle(Ne),Le.recycle(ke),!1}else if(Xe!==$e)return Le.recycle(Ne),Le.recycle(ke),!1;return Le.recycle(Ne),Le.recycle(ke),!0}}();pe.exports.deepEqual=Pe,pe.exports.diff=function(){var Le=[];return function(xe,Fe,Oe){var Ne,ke,Ve,Xe,$e,st,ze;Xe=Oe||{},Le.length=0;for($e in xe)Le.push($e);if(!Fe)return Xe;for(Ve in Fe)Le.indexOf(Ve)===-1&&Le.push(Ve);for(st=0;st<Le.length;st++)$e=Le[st],Ne=xe[$e],ke=Fe[$e],ze=Ne&&ke&&Ne.constructor===Object&&ke.constructor===Object,(ze&&!Pe(Ne,ke)||!ze&&Ne!==ke)&&(Xe[$e]=ke);return Xe}}(),pe.exports.shouldCaptureKeyEvent=function(Le){return Le.metaKey?!1:document.activeElement===document.body},pe.exports.splitString=function(Le,xe){typeof xe>"u"&&(xe=" ");var Fe=new RegExp(xe,"g");return Le=(Le||"").replace(Fe,xe),Le.split(xe)},pe.exports.getElData=function(Le,xe){xe=xe||{};var Fe={};Object.keys(xe).forEach(Oe);function Oe(Ne){Le.hasAttribute(Ne)&&(Fe[Ne]=Le.getAttribute(Ne))}return Fe},pe.exports.getUrlParameter=function(Le){Le=Le.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var xe=new RegExp("[\\?&]"+Le+"=([^&#]*)"),Fe=xe.exec(location.search);return Fe===null?"":decodeURIComponent(Fe[1].replace(/\+/g," "))},pe.exports.isIframed=function(){return window.top!==window.self},pe.exports.findAllScenes=function(Le){for(var xe=[],Fe=Le.getElementsByTagName("*"),Oe=0,Ne=Fe.length;Oe<Ne;Oe++)Fe[Oe].isScene&&xe.push(Fe[Oe]);return xe},pe.exports.srcLoader=ve("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/isIOSOlderThan10.js":pe=>{pe.exports=function(ve){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(ve)}},"./src/utils/material.js":(pe,Me,ve)=>{var se=ve("./src/lib/three.js"),me=ve("./src/utils/src-loader.js"),Te=ve("./src/utils/debug.js"),Re=Te("utils:material:warn"),be=new Set(["emissiveMap","envMap","map","specularMap"]);function Pe(Ne,ke){var Ve=ke.offset||{x:0,y:0},Xe=ke.repeat||{x:1,y:1},$e=ke.npot||!1,st=ke.anisotropy||se.Texture.DEFAULT_ANISOTROPY,ze=Ne.wrapS,tt=Ne.wrapT,ft=Ne.magFilter,Rt=Ne.minFilter;$e&&(ze=se.ClampToEdgeWrapping,tt=se.ClampToEdgeWrapping,ft=se.LinearFilter,Rt=se.LinearFilter),(Xe.x!==1||Xe.y!==1)&&(ze=se.RepeatWrapping,tt=se.RepeatWrapping),Ne.offset.set(Ve.x,Ve.y),Ne.repeat.set(Xe.x,Xe.y),(Ne.wrapS!==ze||Ne.wrapT!==tt||Ne.magFilter!==ft||Ne.minFilter!==Rt||Ne.anisotropy!==st)&&(Ne.wrapS=ze,Ne.wrapT=tt,Ne.magFilter=ft,Ne.minFilter=Rt,Ne.anisotropy=st,Ne.needsUpdate=!0)}pe.exports.setTextureProperties=Pe,pe.exports.updateMapMaterialFromData=function(Ne,ke,Ve,Xe){var $e=Ve.el,st=Ve.material,ze=$e.sceneEl.systems.renderer,tt=Xe[ke];if(Ve.materialSrcs||(Ve.materialSrcs={}),!tt){delete Ve.materialSrcs[Ne],Rt(null);return}if(tt===Ve.materialSrcs[Ne]&&st[Ne]){Pe(st[Ne],Xe);return}Ve.materialSrcs[Ne]=tt,tt instanceof se.Texture?Rt(tt):$e.sceneEl.systems.material.loadTextureSource(tt,ft);function ft(Mt){if(Ve.materialSrcs[Ne]===tt){var Gt=st[Ne];Gt&&(Mt===null||!Fe(Gt,Mt))&&(Gt=null),!Gt&&Mt&&(Gt=Oe(Mt)),Gt&&(Gt.source!==Mt&&(Gt.source=Mt,Gt.needsUpdate=!0),be.has(Ne)&&ze.applyColorCorrection(Gt),Pe(Gt,Xe)),Rt(Gt)}}function Rt(Mt){st[Ne]!==Mt&&(st[Ne]&&st[Ne].dispose(),st[Ne]=Mt,st.needsUpdate=!0,xe($e,Mt))}},pe.exports.updateMap=function(Ne,ke){return pe.exports.updateMapMaterialFromData("map","src",Ne,ke)},pe.exports.updateDistortionMap=function(Ne,ke,Ve){var Xe=Ne;Ne==="ambientOcclusion"&&(Xe="ao");var $e={};return $e.src=Ve[Ne+"Map"],$e.offset=Ve[Ne+"TextureOffset"],$e.repeat=Ve[Ne+"TextureRepeat"],$e.wrap=Ve[Ne+"TextureWrap"],pe.exports.updateMapMaterialFromData(Xe+"Map","src",ke,$e)};var Le={};pe.exports.updateEnvMap=function(Ne,ke){var Ve=Ne.material,Xe=Ne.el,$e="envMap",st=ke.envMap,ze=ke.sphericalEnvMap,tt=ke.refract;if(ze&&(st=ze,Re("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")),Ne.materialSrcs||(Ne.materialSrcs={}),!st){delete Ne.materialSrcs[$e],Ve.envMap=null,Ve.needsUpdate=!0;return}if(Ne.materialSrcs[$e]=st,Le[st]){Le[st].then(ft);return}Le[st]=new Promise(function(Rt){me.validateEnvMapSrc(st,function(Gt){Xe.sceneEl.systems.material.loadCubeMapTexture(Gt,function(_t){_t.mapping=tt?se.CubeRefractionMapping:se.CubeReflectionMapping,ft(_t),Rt(_t)})},function(Gt){Xe.sceneEl.systems.material.loadTexture(Gt,{src:Gt},function(_t){_t.mapping=tt?se.EquirectangularRefractionMapping:se.EquirectangularReflectionMapping,ft(_t),Rt(_t)})})});function ft(Rt){Ne.materialSrcs[$e]===st&&(Ve.envMap=Rt,Ve.needsUpdate=!0,xe(Xe,Rt))}};function xe(Ne,ke){if(!ke||(Ne.emit("materialtextureloaded",{src:ke.image,texture:ke}),!ke.image||ke.image.tagName!=="VIDEO"))return;ke.image.addEventListener("loadeddata",Ve),ke.image.addEventListener("ended",Xe);function Ve(){Ne.emit("materialvideoloadeddata",{src:ke.image,texture:ke})}function Xe(){Ne.emit("materialvideoended",{src:ke.image,texture:ke})}ke.addEventListener("dispose",function(){ke.image.removeEventListener("loadeddata",Ve),ke.image.removeEventListener("ended",Xe)})}pe.exports.handleTextureEvents=xe;function Fe(Ne,ke){return ke.data instanceof HTMLCanvasElement?Ne.isCanvasTexture:ke.data instanceof HTMLVideoElement?Ne.isVideoTexture&&Ne.source===ke:Ne.isTexture&&!Ne.isCanvasTexture&&!Ne.isVideoTexture}pe.exports.isCompatibleTexture=Fe;function Oe(Ne){var ke;return Ne.data instanceof HTMLCanvasElement?ke=new se.CanvasTexture:Ne.data instanceof HTMLVideoElement?ke=new se.VideoTexture(Ne.data):ke=new se.Texture,ke.source=Ne,ke.needsUpdate=!0,ke}pe.exports.createCompatibleTexture=Oe},"./src/utils/math.js":pe=>{function Me(se,me,Te){var Re=me.dot(se);return(Re-me.dot(Te))/me.length()}function ve(se,me,Te,Re){var be=Me(se,me,Te);return Re.copy(me),Re.multiplyScalar(be),Re.add(Te),Re}pe.exports.distanceOfPointFromPlane=Me,pe.exports.nearestPointInPlane=ve},"./src/utils/object-pool.js":pe=>{var Me=Object.freeze(Object.create(null));function ve(){return{}}pe.exports.createPool=function(Re){var be=[],Pe=null;Re=Re||ve;function Le(){var Ne;return(Pe===null||Pe===be.length)&&Fe(be.length||5),Ne=be[Pe],be[Pe++]=Me,se(Ne),Ne}function xe(Ne){if(Ne instanceof Object){if(Pe===null||Pe===-1){be[be.length]=Ne;return}be[--Pe]=Ne}}function Fe(Ne){var ke,Ve;if(Ne=Ne===void 0?be.length:Ne,Ne>0&&Pe==null&&(Pe=0),Ne>0)for(ke=be.length,be.length+=Number(Ne),Ve=ke;Ve<be.length;Ve++)be[Ve]=Re();return be.length}function Oe(){return be.length}return{grow:Fe,pool:be,recycle:xe,size:Oe,use:Le}};function se(Te){var Re;if(!(!Te||Te.constructor!==Object))for(Re in Te)Te[Re]=void 0}pe.exports.clearObject=se;function me(Te,Re){var be;if(!(!Te||Te.constructor!==Object))for(be in Te)be in Re||delete Te[be]}pe.exports.removeUnusedKeys=me},"./src/utils/split.js":pe=>{pe.exports.split=function(){var Me={};return function(ve,se){return se in Me||(Me[se]={}),ve in Me[se]||(Me[se][ve]=ve.split(se)),Me[se][ve]}}()},"./src/utils/src-loader.js":(pe,Me,ve)=>{var se=ve("./src/utils/debug.js"),me=se("utils:src-loader:warn");function Te(Oe,Ne,ke){Le(Oe,function(Xe){if(Xe){Ne(Oe);return}ke(Oe)})}function Re(Oe,Ne,ke){var Ve,Xe="",$e,st,ze=[];if(typeof Oe=="string"){let ft=function(Rt){ze.push(Rt),ze.length===6&&Ne(ze)};for($e=0;$e<5;$e++)Xe+="(url\\((?:[^\\)]+)\\),\\s*)";if(Xe+="(url\\((?:[^\\)]+)\\)\\s*)",st=Oe.match(new RegExp(Xe)),st){for($e=1;$e<7;$e++)Te(Pe(st[$e]),ft);return}if(!Oe.startsWith("#")){var tt=Pe(Oe);Te(tt||Oe,ke);return}}if(Oe.tagName?Ve=Oe:Ve=Fe(Oe),!!Ve){if(Ve.tagName==="A-CUBEMAP"&&Ve.srcs)return Ne(Ve.srcs);if(Ve.tagName==="IMG")return ke(Ve);me('Selector "%s" does not point to <a-cubemap> or <img>',Oe)}}function be(Oe,Ne){return Re(Oe,Ne,function(){me("Expected cubemap but got image")})}function Pe(Oe){var Ne=Oe.match(/url\((.+)\)/);if(Ne)return Ne[1]}function Le(Oe,Ne){var ke;if(Oe.tagName){Ne(Oe.tagName==="IMG");return}ke=new XMLHttpRequest,ke.open("HEAD",Oe),ke.addEventListener("load",function(Ve){var Xe;ke.status>=200&&ke.status<300?(Xe=ke.getResponseHeader("Content-Type"),Xe==null?xe(Oe,Ne):Xe.startsWith("image")?Ne(!0):Ne(!1)):xe(Oe,Ne),ke.abort()}),ke.send()}function xe(Oe,Ne){var ke=new Image;ke.addEventListener("load",Ve);function Ve(){Ne(!0)}ke.addEventListener("error",Xe);function Xe(){Ne(!1)}ke.src=Oe}function Fe(Oe){try{var Ne=document.querySelector(Oe);return Ne||me('No element was found matching the selector: "%s"',Oe),Ne}catch{me('"%s" is not a valid selector',Oe);return}}pe.exports={parseUrl:Pe,validateSrc:Te,validateCubemapSrc:be,validateEnvMapSrc:Re}},"./src/utils/styleParser.js":pe=>{var Me=/-([a-z])/g;pe.exports.parse=function(be,Pe){var Le;return typeof be!="string"||(Le=me(be,Pe),Le[""])?be:Le},pe.exports.stringify=function(be){return typeof be=="string"?be:Te(be)};function ve(be){return be.replace(Me,Re)}pe.exports.toCamelCase=ve;var se=function(){var be=[],Pe=/url\([^)]+$/;return function(xe){var Fe="",Oe,Ne=0,ke=";";for(be.length=0;Ne<xe.length;){if(Oe=xe.indexOf(ke,Ne),Oe===-1&&(Oe=xe.length),Fe+=xe.substring(Ne,Oe),Pe.test(Fe)){Fe+=";",Ne=Oe+1;continue}be.push(Fe.trim()),Fe="",Ne=Oe+1}return be}}();function me(be,Pe){var Le,xe,Fe,Oe,Ne,ke;for(Pe=Pe||{},Le=se(be),xe=0;xe<Le.length;xe++)Fe=Le[xe],Fe&&(Oe=Fe.indexOf(":"),Ne=Fe.substr(0,Oe).trim(),ke=Fe.substr(Oe+1).trim(),Pe[ve(Ne)]=ke);return Pe}function Te(be){var Pe,Le=0,xe=0,Fe="";for(Pe in be)Le++;for(Pe in be)Fe+=Pe+": "+be[Pe],xe<Le-1&&(Fe+="; "),xe++;return Fe}function Re(be){return be[1].toUpperCase()}},"./src/utils/tracked-controls.js":(pe,Me,ve)=>{var se=ve("./src/constants/index.js").DEFAULT_HANDEDNESS,me=["x","y","z","w"],Te=2;pe.exports.checkControllerPresentAndSetup=function(xe,Fe,Oe){var Ne=xe.el,ke,Ve=Ne.sceneEl.hasWebXR,Xe=Ve?be:Re,$e;if(ke=Xe(xe,Fe,Oe),$e=!!ke,xe.controllerPresent&&!xe.controllerEventsActive&&!Ve&&xe.addEventListeners(),$e===xe.controllerPresent)return $e;xe.controllerPresent=$e,$e?(xe.addEventListeners(),xe.injectTrackedControls(ke),Ne.emit("controllerconnected",{name:xe.name,component:xe})):(xe.removeEventListeners(),Ne.emit("controllerdisconnected",{name:xe.name,component:xe}))};function Re(xe,Fe,Oe){var Ne,ke=xe.el.sceneEl,Ve,Xe=Oe.index||0;return!Fe||(Ve=ke&&ke.systems["tracked-controls-webvr"],!Ve)||(Ne=Ve.controllers,!Ne.length)?!1:!!Pe(Ne,null,Fe,Oe.hand,Xe)}function be(xe,Fe,Oe){var Ne,ke=xe.el.sceneEl,Ve=ke&&ke.systems["tracked-controls-webxr"];return!Ve||(Ne=Ve.controllers,!Ne||!Ne.length)?!1:Le(Ne,Fe,Oe.hand,Oe.index,Oe.iterateControllerProfiles,Oe.handTracking)}pe.exports.isControllerPresentWebVR=Re,pe.exports.isControllerPresentWebXR=be;function Pe(xe,Fe,Oe,Ne,ke){var Ve,Xe,$e=0,st=ke>=0?ke:0;for(Xe=0;Xe<xe.length;Xe++)if(Ve=xe[Xe],!(Oe&&!Ve.id.startsWith(Oe))&&!(!Oe&&Ve.id!==Fe)&&!(Ne&&Ve.hand&&Ne!==Ve.hand)){if(Ne&&!Ve.hand)st=Te*ke+(Ne===se?0:1);else return Ve;if($e===st)return Ve;++$e}}function Le(xe,Fe,Oe,Ne,ke,Ve){var Xe,$e,st,ze=!1,tt,ft;for(Xe=0;Xe<xe.length;Xe++){if(st=xe[Xe],ft=st.profiles,Ve)ze=st.hand;else if(ke)for($e=0;$e<ft.length&&(ze=ft[$e].startsWith(Fe),!ze);$e++);else ze=ft.length>0&&ft[0].startsWith(Fe);if(ze){if(tt=st.handedness==="right"||st.handedness==="left",tt){if(st.handedness===Oe)return xe[Xe]}else if(Xe===Ne)return xe[Xe]}}}pe.exports.findMatchingControllerWebVR=Pe,pe.exports.findMatchingControllerWebXR=Le,pe.exports.emitIfAxesChanged=function(xe,Fe,Oe){var Ne,ke,Ve,Xe,$e;for(ke in Fe){for(Ne=Fe[ke],Ve=!1,$e=0;$e<Ne.length;$e++)Oe.detail.changed[Ne[$e]]&&(Ve=!0);if(Ve){for(Xe={},$e=0;$e<Ne.length;$e++)Xe[me[$e]]=Oe.detail.axis[Ne[$e]];xe.el.emit(ke+"moved",Xe)}}},pe.exports.onButtonEvent=function(xe,Fe,Oe,Ne){var ke=Ne?Oe.mapping[Ne]:Oe.mapping,Ve=ke.buttons[xe];Oe.el.emit(Ve+Fe),Oe.updateModel&&Oe.updateModel(Ve,Fe)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(pe){var Me=this;this.object=pe,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var ve=function(Te){Me.deviceOrientation=Te},se=function(){Me.screenOrientation=window.orientation||0},me=function(){var Te=new THREE.Vector3(0,0,1),Re=new THREE.Euler,be=new THREE.Quaternion,Pe=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(Le,xe,Fe,Oe,Ne){Re.set(Fe,xe,-Oe,"YXZ"),Le.setFromEuler(Re),Le.multiply(Pe),Le.multiply(be.setFromAxisAngle(Te,-Ne))}}();this.connect=function(){se(),window.addEventListener("orientationchange",se,!1),window.addEventListener("deviceorientation",ve,!1),Me.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",se,!1),window.removeEventListener("deviceorientation",ve,!1),Me.enabled=!1},this.update=function(){if(Me.enabled!==!1){var Te=Me.deviceOrientation;if(Te){var Re=Te.alpha?THREE.MathUtils.degToRad(Te.alpha)+Me.alphaOffset:0,be=Te.beta?THREE.MathUtils.degToRad(Te.beta):0,Pe=Te.gamma?THREE.MathUtils.degToRad(Te.gamma):0,Le=Me.screenOrientation?THREE.MathUtils.degToRad(Me.screenOrientation):0;me(Me.object.quaternion,Re,be,Pe,Le)}}},this.dispose=function(){Me.disconnect()},this.connect()}},"./vendor/rStats.extras.js":pe=>{window.glStats=function(){var Me=null,ve=0,se=0,me=0,Te=0,Re=0,be=0,Pe=0;function Le($e,st){return function(){st.apply(this,arguments),$e.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=Le(WebGLRenderingContext.prototype.drawArrays,function(){ve++,arguments[0]==this.POINTS?be+=arguments[2]:Re+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=Le(WebGLRenderingContext.prototype.drawElements,function(){se++,Te+=arguments[1]/3,Re+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=Le(WebGLRenderingContext.prototype.useProgram,function(){me++}),WebGLRenderingContext.prototype.bindTexture=Le(WebGLRenderingContext.prototype.bindTexture,function(){Pe++});var xe={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},Fe=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],Oe=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function Ne(){Me("allcalls").set(ve+se),Me("drawElements").set(se),Me("drawArrays").set(ve),Me("bindTexture").set(Pe),Me("useProgram").set(me),Me("glfaces").set(Te),Me("glvertices").set(Re),Me("glpoints").set(be)}function ke(){ve=0,se=0,me=0,Te=0,Re=0,be=0,Pe=0}function Ve(){}function Xe($e){Me=$e}return{update:Ne,start:ke,end:Ve,attach:Xe,values:xe,groups:Fe,fractions:Oe}},window.threeStats=function(Me){var ve=null,se={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},me=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],Te=[];function Re(){ve("renderer.info.memory.geometries").set(Me.info.memory.geometries),ve("renderer.info.programs").set(Me.info.programs.length),ve("renderer.info.memory.textures").set(Me.info.memory.textures),ve("renderer.info.render.calls").set(Me.info.render.calls),ve("renderer.info.render.triangles").set(Me.info.render.triangles),ve("renderer.info.render.points").set(Me.info.render.points)}function be(){}function Pe(){}function Le(xe){ve=xe}return{update:Re,start:be,end:Pe,attach:Le,values:se,groups:me,fractions:Te}},window.BrowserStats=function(){var Me=null,ve=0,se=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var me={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},Te=[{caption:"Browser",values:["memory","total"]}],Re=[{base:"total",steps:["memory"]}],be=Math.log(1024);function Pe(Ne){var ke=100,Ve=Math.floor(Math.log(Ne)/be);return Math.round(Ne*ke/Math.pow(1024,Ve))/ke}function Le(){ve=Pe(performance.memory.usedJSHeapSize),se=Pe(performance.memory.totalJSHeapSize),Me("memory").set(ve),Me("total").set(se)}function xe(){ve=0}function Fe(){}function Oe(Ne){Me=Ne}return{update:Le,start:xe,end:Fe,attach:Oe,values:me,groups:Te,fractions:Re}},pe.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":pe=>{(function(){"performance"in window||(window.performance={});var Me=window.performance;if(!("now"in Me)){var ve=Date.now();Me.timing&&Me.timing.navigationStart&&(ve=Me.timing.navigationStart),Me.now=function(){return Date.now()-ve}}Me.mark||(Me.mark=function(){}),Me.measure||(Me.measure=function(){})})(),window.rStats=function(ve){function se(ft,Rt){for(var Mt=Object.keys(ft),Gt=0,_t=Mt.length;Gt<_t;Gt++)Rt(Mt[Gt])}function me(ft){var Rt=document.createElement("link");Rt.href=ft,Rt.rel="stylesheet",Rt.type="text/css",document.getElementsByTagName("head")[0].appendChild(Rt)}var Te=ve||{},Re=Te.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],be="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",Pe=(Te.CSSPath?Te.CSSPath:"")+"rStats.css",Le=Te.css||[be,Pe];Le.forEach(function(ft){me(ft)}),Te.values||(Te.values={});var xe,Fe,Oe=10,Ne=200,ke={};function Ve(ft,Rt,Mt){var Gt=Mt||{},_t=document.createElement("canvas"),Bt=_t.getContext("2d"),dt=0,ut=0,Ut=Gt.color?Gt.color:"#666666",Tt=document.createElement("canvas"),Xt=Tt.getContext("2d");Tt.width=1,Tt.height=2*Oe,Xt.fillStyle="#444444",Xt.fillRect(0,0,1,2*Oe),Xt.fillStyle=Ut,Xt.fillRect(0,Oe,1,Oe),Xt.fillStyle="#ffffff",Xt.globalAlpha=.5,Xt.fillRect(0,Oe,1,1),Xt.globalAlpha=1;var hn=document.createElement("canvas"),nn=hn.getContext("2d");hn.width=1,hn.height=2*Oe,nn.fillStyle="#444444",nn.fillRect(0,0,1,2*Oe),nn.fillStyle="#b70000",nn.fillRect(0,Oe,1,Oe),nn.globalAlpha=.5,nn.fillStyle="#ffffff",nn.fillRect(0,Oe,1,1),nn.globalAlpha=1;function An(){_t.width=Ne,_t.height=Oe,_t.style.width=_t.width+"px",_t.style.height=_t.height+"px",_t.className="rs-canvas",ft.appendChild(_t),Bt.fillStyle="#444444",Bt.fillRect(0,0,_t.width,_t.height)}function Cn(Nn,Qn){ut+=(Nn-ut)*.1,dt*=.99,ut>dt&&(dt=ut),Bt.drawImage(_t,1,0,_t.width-1,_t.height,0,0,_t.width-1,_t.height),Qn?Bt.drawImage(hn,_t.width-1,_t.height-ut*_t.height/dt-Oe):Bt.drawImage(Tt,_t.width-1,_t.height-ut*_t.height/dt-Oe)}return An(),{draw:Cn}}function Xe(ft,Rt){var Mt=document.createElement("canvas"),Gt=Mt.getContext("2d");function _t(){Mt.width=Ne,Mt.height=Oe*Rt,Mt.style.width=Mt.width+"px",Mt.style.height=Mt.height+"px",Mt.className="rs-canvas",ft.appendChild(Mt),Gt.fillStyle="#444444",Gt.fillRect(0,0,Mt.width,Mt.height)}function Bt(dt){Gt.drawImage(Mt,1,0,Mt.width-1,Mt.height,0,0,Mt.width-1,Mt.height);var ut=0;se(dt,function(Ut){var Tt=dt[Ut]*Mt.height;Gt.fillStyle=Re[Ut],Gt.fillRect(Mt.width-1,ut,1,Tt),ut+=Tt})}return _t(),{draw:Bt}}function $e(ft,Rt){var Mt=ft,Gt,_t=0,Bt=0,dt=0,ut=0,Ut=performance.now(),Tt=0,Xt=document.createElement("div"),hn=document.createElement("span"),nn=document.createElement("div"),An=document.createTextNode(""),Cn=Te.values[Mt.toLowerCase()],Nn=new Ve(Xt,Mt,Cn),Qn=!1;hn.className="rs-counter-id",hn.textContent=Cn&&Cn.caption?Cn.caption:Mt,nn.className="rs-counter-value",nn.appendChild(An),Xt.appendChild(hn),Xt.appendChild(nn),Rt?Rt.div.appendChild(Xt):Fe.appendChild(Xt),Gt=performance.now();function fi(Rr){if(Cn&&Cn.average){ut+=Rr,Tt++;var ir=performance.now();ir-Ut>=(Cn.avgMs||1e3)&&(dt=ut/Tt,ut=0,Ut=ir,Tt=0)}}function hi(){Gt=performance.now(),Te.userTimingAPI&&performance.mark(Mt+"-start"),Qn=!0}function Qi(){_t=performance.now()-Gt,Te.userTimingAPI&&(performance.mark(Mt+"-end"),Qn&&performance.measure(Mt,Mt+"-start",Mt+"-end")),fi(_t)}function Zi(){Qi(),hi()}function Mn(){var Rr=Cn&&Cn.average?dt:_t;An.nodeValue=Math.round(Rr*100)/100;var ir=Cn&&(Cn.below&&_t<Cn.below||Cn.over&&_t>Cn.over);Nn.draw(_t,ir),Xt.className=ir?"rs-counter-base alarm":"rs-counter-base"}function Vr(){var Rr=performance.now(),ir=Rr-Gt;Bt++,ir>1e3&&(Cn&&Cn.interpolate===!1?_t=Bt:_t=Bt*1e3/ir,Bt=0,Gt=Rr,fi(_t))}function Ir(Rr){_t=Rr,fi(_t)}return{set:Ir,start:hi,tick:Zi,end:Qi,frame:Vr,value:function(){return _t},draw:Mn}}function st(ft){var Rt=ft.toLowerCase();if(Rt===void 0&&(Rt="default"),ke[Rt])return ke[Rt];var Mt=null;Te.groups&&se(Te.groups,function(_t){var Bt=Te.groups[parseInt(_t,10)];!Mt&&Bt.values.indexOf(Rt.toLowerCase())!==-1&&(Mt=Bt)});var Gt=new $e(Rt,Mt);return ke[Rt]=Gt,Gt}function ze(){if(Te.plugins){Te.values||(Te.values={}),Te.groups||(Te.groups=[]),Te.fractions||(Te.fractions=[]);for(var ft=0;ft<Te.plugins.length;ft++)Te.plugins[ft].attach(st),se(Te.plugins[ft].values,function(Rt){Te.values[Rt]=Te.plugins[ft].values[Rt]}),Te.groups=Te.groups.concat(Te.plugins[ft].groups),Te.fractions=Te.fractions.concat(Te.plugins[ft].fractions)}else Te.plugins={};xe=document.createElement("div"),xe.className="rs-base",Fe=document.createElement("div"),Fe.className="rs-container",Fe.style.height="auto",xe.appendChild(Fe),document.body.appendChild(xe),Te&&(Te.groups&&se(Te.groups,function(Rt){var Mt=Te.groups[parseInt(Rt,10)],Gt=document.createElement("div");Gt.className="rs-group",Mt.div=Gt;var _t=document.createElement("h1");_t.textContent=Mt.caption,_t.addEventListener("click",(function(Bt){this.classList.toggle("hidden"),Bt.preventDefault()}).bind(Gt)),Fe.appendChild(_t),Fe.appendChild(Gt)}),Te.fractions&&se(Te.fractions,function(Rt){var Mt=Te.fractions[parseInt(Rt,10)],Gt=document.createElement("div");Gt.className="rs-fraction";var _t=document.createElement("div");_t.className="rs-legend";var Bt=0;se(Te.fractions[Rt].steps,function(ut){var Ut=document.createElement("p");Ut.textContent=Te.fractions[Rt].steps[ut],Ut.style.color=Re[Bt],_t.appendChild(Ut),Bt++}),Gt.appendChild(_t),Gt.style.height=Bt*Oe+"px",Mt.div=Gt;var dt=new Xe(Gt,Bt);Mt.graph=dt,Fe.appendChild(Gt)}))}function tt(){se(Te.plugins,function(ft){Te.plugins[ft].update()}),se(ke,function(ft){ke[ft].draw()}),Te.fractions&&se(Te.fractions,function(ft){var Rt=Te.fractions[parseInt(ft,10)],Mt=[],Gt=ke[Rt.base.toLowerCase()];Gt&&(Gt=Gt.value(),se(Te.fractions[ft].steps,function(_t){var Bt=Te.fractions[ft].steps[parseInt(_t,10)].toLowerCase(),dt=ke[Bt];dt&&Mt.push(dt.value()/Gt)})),Rt.graph.draw(Mt)})}return ze(),function(ft){return ft?st(ft):{element:xe,update:tt}}},pe.exports=window.rStats},"./vendor/wakelock/util.js":pe=>{var Me={};Me.base64=function(ve,se){return"data:"+ve+";base64,"+se},Me.isMobile=function(){var ve=!1;return function(se){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(se)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(se.substr(0,4)))&&(ve=!0)}(navigator.userAgent||navigator.vendor||window.opera),ve},Me.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},Me.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},Me.appendQueryParameter=function(ve,se,me){var Te=ve.indexOf("?")<0?"?":"&";return ve+=Te+se+"="+me,ve},Me.getQueryParameter=function(ve){ve=ve.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var se=new RegExp("[\\?&]"+ve+"=([^&#]*)"),me=se.exec(location.search);return me===null?"":decodeURIComponent(me[1].replace(/\+/g," "))},Me.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},pe.exports=Me},"./vendor/wakelock/wakelock.js":(pe,Me,ve)=>{var se=ve("./vendor/wakelock/util.js");function me(){var be=document.createElement("video");be.addEventListener("ended",function(){be.play()}),this.request=function(){be.paused&&(be.src=se.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),be.play())},this.release=function(){be.pause(),be.src=""}}function Te(){var be=null;this.request=function(){be||(be=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){be&&(clearInterval(be),be=null)}}function Re(){var be=navigator.userAgent||navigator.vendor||window.opera;return be.match(/iPhone/i)||be.match(/iPod/i)?Te:me}pe.exports=Re()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{default:()=>tt});var se=ve("./node_modules/css-loader/dist/runtime/sourceMaps.js"),me=ve.n(se),Te=ve("./node_modules/css-loader/dist/runtime/api.js"),Re=ve.n(Te),be=ve("./node_modules/css-loader/dist/runtime/getUrl.js"),Pe=ve.n(be),Le=new URL(ve("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),ve.b),xe=new URL(ve("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),ve.b),Fe=new URL(ve("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),ve.b),Oe=new URL(ve("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),ve.b),Ne=new URL(ve("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),ve.b),ke=Re()(me()),Ve=Pe()(Le),Xe=Pe()(xe),$e=Pe()(Fe),st=Pe()(Oe),ze=Pe()(Ne);ke.push([pe.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+Ve+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+Xe+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+$e+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+st+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+ze+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);const tt=ke},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{default:()=>Pe});var se=ve("./node_modules/css-loader/dist/runtime/sourceMaps.js"),me=ve.n(se),Te=ve("./node_modules/css-loader/dist/runtime/api.js"),Re=ve.n(Te),be=Re()(me());be.push([pe.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);const Pe=be},"./src/style/aframe.css":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{default:()=>$e});var se=ve("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),me=ve.n(se),Te=ve("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),Re=ve.n(Te),be=ve("./node_modules/style-loader/dist/runtime/insertBySelector.js"),Pe=ve.n(be),Le=ve("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),xe=ve.n(Le),Fe=ve("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),Oe=ve.n(Fe),Ne=ve("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),ke=ve.n(Ne),Ve=ve("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),Xe={};Xe.styleTagTransform=ke(),Xe.setAttributes=xe(),Xe.insert=Pe().bind(null,"head"),Xe.domAPI=Re(),Xe.insertStyleElement=Oe(),me()(Ve.default,Xe);const $e=Ve.default&&Ve.default.locals?Ve.default.locals:void 0},"./src/style/rStats.css":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{default:()=>$e});var se=ve("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),me=ve.n(se),Te=ve("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),Re=ve.n(Te),be=ve("./node_modules/style-loader/dist/runtime/insertBySelector.js"),Pe=ve.n(be),Le=ve("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),xe=ve.n(Le),Fe=ve("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),Oe=ve.n(Fe),Ne=ve("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),ke=ve.n(Ne),Ve=ve("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),Xe={};Xe.styleTagTransform=ke(),Xe.setAttributes=xe(),Xe.insert=Pe().bind(null,"head"),Xe.domAPI=Re(),Xe.insertStyleElement=Oe(),me()(Ve.default,Xe);const $e=Ve.default&&Ve.default.locals?Ve.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":pe=>{var Me=[];function ve(Te){for(var Re=-1,be=0;be<Me.length;be++)if(Me[be].identifier===Te){Re=be;break}return Re}function se(Te,Re){for(var be={},Pe=[],Le=0;Le<Te.length;Le++){var xe=Te[Le],Fe=Re.base?xe[0]+Re.base:xe[0],Oe=be[Fe]||0,Ne="".concat(Fe," ").concat(Oe);be[Fe]=Oe+1;var ke=ve(Ne),Ve={css:xe[1],media:xe[2],sourceMap:xe[3],supports:xe[4],layer:xe[5]};if(ke!==-1)Me[ke].references++,Me[ke].updater(Ve);else{var Xe=me(Ve,Re);Re.byIndex=Le,Me.splice(Le,0,{identifier:Ne,updater:Xe,references:1})}Pe.push(Ne)}return Pe}function me(Te,Re){var be=Re.domAPI(Re);be.update(Te);var Pe=function(xe){if(xe){if(xe.css===Te.css&&xe.media===Te.media&&xe.sourceMap===Te.sourceMap&&xe.supports===Te.supports&&xe.layer===Te.layer)return;be.update(Te=xe)}else be.remove()};return Pe}pe.exports=function(Te,Re){Re=Re||{},Te=Te||[];var be=se(Te,Re);return function(Le){Le=Le||[];for(var xe=0;xe<be.length;xe++){var Fe=be[xe],Oe=ve(Fe);Me[Oe].references--}for(var Ne=se(Le,Re),ke=0;ke<be.length;ke++){var Ve=be[ke],Xe=ve(Ve);Me[Xe].references===0&&(Me[Xe].updater(),Me.splice(Xe,1))}be=Ne}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":pe=>{var Me={};function ve(me){if(typeof Me[me]>"u"){var Te=document.querySelector(me);if(window.HTMLIFrameElement&&Te instanceof window.HTMLIFrameElement)try{Te=Te.contentDocument.head}catch{Te=null}Me[me]=Te}return Me[me]}function se(me,Te){var Re=ve(me);if(!Re)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");Re.appendChild(Te)}pe.exports=se},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":pe=>{function Me(ve){var se=document.createElement("style");return ve.setAttributes(se,ve.attributes),ve.insert(se,ve.options),se}pe.exports=Me},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(pe,Me,ve)=>{function se(me){var Te=ve.nc;Te&&me.setAttribute("nonce",Te)}pe.exports=se},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":pe=>{function Me(me,Te,Re){var be="";Re.supports&&(be+="@supports (".concat(Re.supports,") {")),Re.media&&(be+="@media ".concat(Re.media," {"));var Pe=typeof Re.layer<"u";Pe&&(be+="@layer".concat(Re.layer.length>0?" ".concat(Re.layer):""," {")),be+=Re.css,Pe&&(be+="}"),Re.media&&(be+="}"),Re.supports&&(be+="}");var Le=Re.sourceMap;Le&&typeof btoa<"u"&&(be+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(Le))))," */")),Te.styleTagTransform(be,me,Te.options)}function ve(me){if(me.parentNode===null)return!1;me.parentNode.removeChild(me)}function se(me){if(typeof document>"u")return{update:function(){},remove:function(){}};var Te=me.insertStyleElement(me);return{update:function(be){Me(Te,me,be)},remove:function(){ve(Te)}}}pe.exports=se},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":pe=>{function Me(ve,se){if(se.styleSheet)se.styleSheet.cssText=ve;else{for(;se.firstChild;)se.removeChild(se.firstChild);se.appendChild(document.createTextNode(ve))}}pe.exports=Me},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":pe=>{pe.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":pe=>{pe.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":pe=>{pe.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":pe=>{pe.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":pe=>{pe.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.module.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{ACESFilmicToneMapping:()=>Bi,AddEquation:()=>Mt,AddOperation:()=>Ui,AdditiveAnimationBlendMode:()=>C0,AdditiveBlending:()=>ze,AgXToneMapping:()=>Yt,AlphaFormat:()=>di,AlwaysCompare:()=>bh,AlwaysDepth:()=>Ir,AlwaysStencilFunc:()=>Vu,AmbientLight:()=>jm,AnimationAction:()=>Ag,AnimationClip:()=>Op,AnimationLoader:()=>Z3,AnimationMixer:()=>bv,AnimationObjectGroup:()=>Sv,AnimationUtils:()=>K3,ArcCurve:()=>pm,ArrayCamera:()=>QA,ArrowHelper:()=>Yv,AttachedBindMode:()=>on,Audio:()=>dg,AudioAnalyser:()=>Av,AudioContext:()=>y2,AudioListener:()=>dv,AudioLoader:()=>cv,AxesHelper:()=>qv,BackSide:()=>Ve,BasicDepthPacking:()=>Tl,BasicShadowMap:()=>xe,BatchedMesh:()=>sm,Bone:()=>XA,BooleanKeyframeTrack:()=>B1,Box2:()=>Fv,Box3:()=>Rs,Box3Helper:()=>Xv,BoxGeometry:()=>il,BoxHelper:()=>$v,BufferAttribute:()=>So,BufferGeometry:()=>Ds,BufferGeometryLoader:()=>rg,ByteType:()=>Ia,Cache:()=>ph,Camera:()=>Kl,CameraHelper:()=>Wv,CanvasTexture:()=>v3,CapsuleGeometry:()=>uA,CatmullRomCurve3:()=>Am,CineonToneMapping:()=>fr,CircleGeometry:()=>hA,ClampToEdgeWrapping:()=>yn,Clock:()=>cg,Color:()=>Wr,ColorKeyframeTrack:()=>A2,ColorManagement:()=>To,CompressedArrayTexture:()=>m3,CompressedCubeTexture:()=>g3,CompressedTexture:()=>oA,CompressedTextureLoader:()=>j3,ConeGeometry:()=>dA,ConstantAlphaFactor:()=>Zi,ConstantColorFactor:()=>hi,CubeCamera:()=>Vh,CubeReflectionMapping:()=>Nt,CubeRefractionMapping:()=>ht,CubeTexture:()=>ba,CubeTextureLoader:()=>ev,CubeUVReflectionMapping:()=>Wt,CubicBezierCurve:()=>i2,CubicBezierCurve3:()=>gm,CubicInterpolant:()=>Hm,CullFaceBack:()=>be,CullFaceFront:()=>Pe,CullFaceFrontBack:()=>Le,CullFaceNone:()=>Re,Curve:()=>cu,CurvePath:()=>Em,CustomBlending:()=>Rt,CustomToneMapping:()=>Kt,CylinderGeometry:()=>Yf,Cylindrical:()=>Pv,Data3DTexture:()=>Fs,DataArrayTexture:()=>Rc,DataTexture:()=>hd,DataTextureLoader:()=>tv,DataUtils:()=>Hd,DecrementStencilOp:()=>Ed,DecrementWrapStencilOp:()=>Gu,DefaultLoadingManager:()=>Wm,DepthFormat:()=>Dn,DepthStencilFormat:()=>jn,DepthTexture:()=>ch,DetachedBindMode:()=>an,DirectionalLight:()=>Zm,DirectionalLightHelper:()=>zv,DiscreteInterpolant:()=>Vm,DisplayP3ColorSpace:()=>bc,DodecahedronGeometry:()=>fA,DoubleSide:()=>Xe,DstAlphaFactor:()=>An,DstColorFactor:()=>Nn,DynamicCopyUsage:()=>Rd,DynamicDrawUsage:()=>Sd,DynamicReadUsage:()=>Th,EdgesGeometry:()=>ym,EllipseCurve:()=>aA,EqualCompare:()=>xh,EqualDepth:()=>zr,EqualStencilFunc:()=>yd,EquirectangularReflectionMapping:()=>ot,EquirectangularRefractionMapping:()=>Vt,Euler:()=>S0,EventDispatcher:()=>La,ExtrudeGeometry:()=>_A,FileLoader:()=>mh,Float16BufferAttribute:()=>ra,Float32BufferAttribute:()=>$i,FloatType:()=>ko,Fog:()=>Vp,FogExp2:()=>Hp,FramebufferTexture:()=>A3,FrontSide:()=>ke,Frustum:()=>Cc,GLBufferAttribute:()=>Bv,GLSL1:()=>Ld,GLSL3:()=>zu,GreaterCompare:()=>wh,GreaterDepth:()=>kt,GreaterEqualCompare:()=>Mh,GreaterEqualDepth:()=>Br,GreaterEqualStencilFunc:()=>wd,GreaterStencilFunc:()=>xd,GridHelper:()=>Hv,Group:()=>w1,HalfFloatType:()=>Ts,HemisphereLight:()=>$m,HemisphereLightHelper:()=>Qv,IcosahedronGeometry:()=>yA,ImageBitmapLoader:()=>lv,ImageLoader:()=>Np,ImageUtils:()=>dc,IncrementStencilOp:()=>zc,IncrementWrapStencilOp:()=>ku,InstancedBufferAttribute:()=>$f,InstancedBufferGeometry:()=>ig,InstancedInterleavedBuffer:()=>Rv,InstancedMesh:()=>nm,Int16BufferAttribute:()=>yu,Int32BufferAttribute:()=>Vd,Int8BufferAttribute:()=>_u,IntType:()=>l0,InterleavedBuffer:()=>zp,InterleavedBufferAttribute:()=>M1,Interpolant:()=>Dp,InterpolateDiscrete:()=>pa,InterpolateLinear:()=>zo,InterpolateSmooth:()=>Aa,InvertStencilOp:()=>hu,KeepStencilOp:()=>P0,KeyframeTrack:()=>uu,LOD:()=>$2,LatheGeometry:()=>bp,Layers:()=>Ql,LessCompare:()=>Ch,LessDepth:()=>Rr,LessEqualCompare:()=>du,LessEqualDepth:()=>ir,LessEqualStencilFunc:()=>Cd,LessStencilFunc:()=>Eh,Light:()=>Ad,LightProbe:()=>ng,Line:()=>fd,Line3:()=>Ov,LineBasicMaterial:()=>bl,LineCurve:()=>r2,LineCurve3:()=>vm,LineDashedMaterial:()=>km,LineLoop:()=>um,LineSegments:()=>Fu,LinearDisplayP3ColorSpace:()=>Rl,LinearFilter:()=>Jr,LinearInterpolant:()=>p2,LinearMipMapLinearFilter:()=>Vo,LinearMipMapNearestFilter:()=>js,LinearMipmapLinearFilter:()=>Qs,LinearMipmapNearestFilter:()=>Ai,LinearSRGBColorSpace:()=>za,LinearToneMapping:()=>Nr,LinearTransfer:()=>Tc,Loader:()=>rc,LoaderUtils:()=>_2,LoadingManager:()=>m2,LoopOnce:()=>Po,LoopPingPong:()=>fa,LoopRepeat:()=>mo,LuminanceAlphaFormat:()=>Vn,LuminanceFormat:()=>xn,MOUSE:()=>me,Material:()=>Oo,MaterialLoader:()=>TA,MathUtils:()=>Ud,Matrix3:()=>gs,Matrix4:()=>kr,MaxEquation:()=>dt,Mesh:()=>Zo,MeshBasicMaterial:()=>Io,MeshDepthMaterial:()=>kA,MeshDistanceMaterial:()=>GA,MeshLambertMaterial:()=>Nm,MeshMatcapMaterial:()=>Um,MeshNormalMaterial:()=>Om,MeshPhongMaterial:()=>Pm,MeshPhysicalMaterial:()=>Dm,MeshStandardMaterial:()=>h2,MeshToonMaterial:()=>Fm,MinEquation:()=>Bt,MirroredRepeatWrapping:()=>ni,MixOperation:()=>ai,MultiplyBlending:()=>ft,MultiplyOperation:()=>Kn,NearestFilter:()=>ki,NearestMipMapLinearFilter:()=>Ws,NearestMipMapNearestFilter:()=>ji,NearestMipmapLinearFilter:()=>Xi,NearestMipmapNearestFilter:()=>Hi,NeutralToneMapping:()=>fn,NeverCompare:()=>yh,NeverDepth:()=>Vr,NeverStencilFunc:()=>Qu,NoBlending:()=>$e,NoColorSpace:()=>Ba,NoToneMapping:()=>yi,NormalAnimationBlendMode:()=>J0,NormalBlending:()=>st,NotEqualCompare:()=>Sh,NotEqualDepth:()=>rn,NotEqualStencilFunc:()=>Hu,NumberKeyframeTrack:()=>Pp,Object3D:()=>uo,ObjectLoader:()=>ov,ObjectSpaceNormalMap:()=>V0,OctahedronGeometry:()=>Bp,OneFactor:()=>Ut,OneMinusConstantAlphaFactor:()=>Mn,OneMinusConstantColorFactor:()=>Qi,OneMinusDstAlphaFactor:()=>Cn,OneMinusDstColorFactor:()=>Qn,OneMinusSrcAlphaFactor:()=>nn,OneMinusSrcColorFactor:()=>Xt,OrthographicCamera:()=>sh,P3Primaries:()=>Ic,PCFShadowMap:()=>Fe,PCFSoftShadowMap:()=>Oe,PMREMGenerator:()=>Ko,Path:()=>Mp,PerspectiveCamera:()=>jo,Plane:()=>ka,PlaneGeometry:()=>ql,PlaneHelper:()=>Kv,PointLight:()=>Jm,PointLightHelper:()=>kv,Points:()=>dm,PointsMaterial:()=>JA,PolarGridHelper:()=>Vv,PolyhedronGeometry:()=>pd,PositionalAudio:()=>pv,PropertyBinding:()=>Lo,PropertyMixer:()=>pg,QuadraticBezierCurve:()=>s2,QuadraticBezierCurve3:()=>o2,Quaternion:()=>to,QuaternionKeyframeTrack:()=>Jf,QuaternionLinearInterpolant:()=>zm,RED_GREEN_RGTC2_Format:()=>$s,RED_RGTC1_Format:()=>ys,REVISION:()=>se,RGBADepthPacking:()=>Il,RGBAFormat:()=>Jt,RGBAIntegerFormat:()=>yr,RGBA_ASTC_10x10_Format:()=>bi,RGBA_ASTC_10x5_Format:()=>xi,RGBA_ASTC_10x6_Format:()=>zi,RGBA_ASTC_10x8_Format:()=>ti,RGBA_ASTC_12x10_Format:()=>cr,RGBA_ASTC_12x12_Format:()=>Gr,RGBA_ASTC_4x4_Format:()=>Ns,RGBA_ASTC_5x4_Format:()=>It,RGBA_ASTC_5x5_Format:()=>Ot,RGBA_ASTC_6x5_Format:()=>zt,RGBA_ASTC_6x6_Format:()=>jt,RGBA_ASTC_8x5_Format:()=>mn,RGBA_ASTC_8x6_Format:()=>kn,RGBA_ASTC_8x8_Format:()=>Yn,RGBA_BPTC_Format:()=>Ki,RGBA_ETC2_EAC_Format:()=>bs,RGBA_PVRTC_2BPPV1_Format:()=>wo,RGBA_PVRTC_4BPPV1_Format:()=>eo,RGBA_S3TC_DXT1_Format:()=>Ur,RGBA_S3TC_DXT3_Format:()=>hs,RGBA_S3TC_DXT5_Format:()=>er,RGBFormat:()=>$t,RGB_BPTC_SIGNED_Format:()=>As,RGB_BPTC_UNSIGNED_Format:()=>Ls,RGB_ETC1_Format:()=>Er,RGB_ETC2_Format:()=>Ss,RGB_PVRTC_2BPPV1_Format:()=>Yr,RGB_PVRTC_4BPPV1_Format:()=>as,RGB_S3TC_DXT1_Format:()=>Sr,RGFormat:()=>Li,RGIntegerFormat:()=>vi,RawShaderMaterial:()=>Lm,Ray:()=>Jo,Raycaster:()=>Lv,Rec709Primaries:()=>Bl,RectAreaLight:()=>eg,RedFormat:()=>gi,RedIntegerFormat:()=>Wi,ReinhardToneMapping:()=>Ar,RenderTarget:()=>fc,RepeatWrapping:()=>sn,ReplaceStencilOp:()=>Uu,ReverseSubtractEquation:()=>_t,RingGeometry:()=>CA,SIGNED_RED_GREEN_RGTC2_Format:()=>Ao,SIGNED_RED_RGTC1_Format:()=>ds,SRGBColorSpace:()=>lo,SRGBTransfer:()=>bo,Scene:()=>G2,ShaderChunk:()=>vs,ShaderLib:()=>I0,ShaderMaterial:()=>k0,ShadowMaterial:()=>Bm,Shape:()=>T1,ShapeGeometry:()=>xA,ShapePath:()=>Jv,ShapeUtils:()=>Ou,ShortType:()=>Do,Skeleton:()=>qp,SkeletonHelper:()=>Uv,SkinnedMesh:()=>Z2,Source:()=>Wo,Sphere:()=>la,SphereGeometry:()=>Lp,Spherical:()=>Dv,SphericalHarmonics3:()=>tg,SplineCurve:()=>a2,SpotLight:()=>Ym,SpotLightHelper:()=>Nv,Sprite:()=>z2,SpriteMaterial:()=>VA,SrcAlphaFactor:()=>hn,SrcAlphaSaturateFactor:()=>fi,SrcColorFactor:()=>Tt,StaticCopyUsage:()=>Id,StaticDrawUsage:()=>sc,StaticReadUsage:()=>bd,StereoCamera:()=>uv,StreamCopyUsage:()=>Bd,StreamDrawUsage:()=>Md,StreamReadUsage:()=>Td,StringKeyframeTrack:()=>L1,SubtractEquation:()=>Gt,SubtractiveBlending:()=>tt,TOUCH:()=>Te,TangentSpaceNormalMap:()=>Va,TetrahedronGeometry:()=>wA,Texture:()=>Fo,TextureLoader:()=>nv,TorusGeometry:()=>SA,TorusKnotGeometry:()=>MA,Triangle:()=>Fa,TriangleFanDrawMode:()=>Z0,TriangleStripDrawMode:()=>D0,TrianglesDrawMode:()=>H0,TubeGeometry:()=>bA,UVMapping:()=>gn,Uint16BufferAttribute:()=>Cu,Uint32BufferAttribute:()=>vc,Uint8BufferAttribute:()=>Zu,Uint8ClampedBufferAttribute:()=>Nh,Uniform:()=>w2,UniformsGroup:()=>Iv,UniformsLib:()=>Or,UniformsUtils:()=>Qh,UnsignedByteType:()=>Mo,UnsignedInt248Type:()=>dn,UnsignedInt5999Type:()=>qn,UnsignedIntType:()=>Ra,UnsignedShort4444Type:()=>ta,UnsignedShort5551Type:()=>q0,UnsignedShortType:()=>Ca,VSMShadowMap:()=>Ne,Vector2:()=>qi,Vector3:()=>vn,Vector4:()=>go,VectorKeyframeTrack:()=>Fp,VideoTexture:()=>p3,WebGL3DRenderTarget:()=>co,WebGLArrayRenderTarget:()=>Kr,WebGLCoordinateSystem:()=>j0,WebGLCubeRenderTarget:()=>th,WebGLMultipleRenderTargets:()=>Zv,WebGLRenderTarget:()=>ga,WebGLRenderer:()=>s3,WebGLUtils:()=>F2,WebGPUCoordinateSystem:()=>oc,WireframeGeometry:()=>Tm,WrapAroundEnding:()=>L0,ZeroCurvatureEnding:()=>na,ZeroFactor:()=>ut,ZeroSlopeEnding:()=>ma,ZeroStencilOp:()=>x0,createCanvasElement:()=>mu});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const se="164",me={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Te={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Re=0,be=1,Pe=2,Le=3,xe=0,Fe=1,Oe=2,Ne=3,ke=0,Ve=1,Xe=2,$e=0,st=1,ze=2,tt=3,ft=4,Rt=5,Mt=100,Gt=101,_t=102,Bt=103,dt=104,ut=200,Ut=201,Tt=202,Xt=203,hn=204,nn=205,An=206,Cn=207,Nn=208,Qn=209,fi=210,hi=211,Qi=212,Zi=213,Mn=214,Vr=0,Ir=1,Rr=2,ir=3,zr=4,Br=5,kt=6,rn=7,Kn=0,ai=1,Ui=2,yi=0,Nr=1,Ar=2,fr=3,Bi=4,Kt=5,Yt=6,fn=7,on="attached",an="detached",gn=300,Nt=301,ht=302,ot=303,Vt=304,Wt=306,sn=1e3,yn=1001,ni=1002,ki=1003,Hi=1004,ji=1004,Xi=1005,Ws=1005,Jr=1006,Ai=1007,js=1007,Qs=1008,Vo=1008,Mo=1009,Ia=1010,Do=1011,Ca=1012,l0=1013,Ra=1014,ko=1015,Ts=1016,ta=1017,q0=1018,dn=1020,qn=35902,di=1021,$t=1022,Jt=1023,xn=1024,Vn=1025,Dn=1026,jn=1027,gi=1028,Wi=1029,Li=1030,vi=1031,yr=1033,Sr=33776,Ur=33777,hs=33778,er=33779,as=35840,Yr=35841,eo=35842,wo=35843,Er=36196,Ss=37492,bs=37496,Ns=37808,It=37809,Ot=37810,zt=37811,jt=37812,mn=37813,kn=37814,Yn=37815,xi=37816,zi=37817,ti=37818,bi=37819,cr=37820,Gr=37821,Ki=36492,As=36494,Ls=36495,ys=36283,ds=36284,$s=36285,Ao=36286,Po=2200,mo=2201,fa=2202,pa=2300,zo=2301,Aa=2302,na=2400,ma=2401,L0=2402,J0=2500,C0=2501,H0=0,D0=1,Z0=2,Tl=3200,Il=3201,Va=0,V0=1,Ba="",lo="srgb",za="srgb-linear",bc="display-p3",Rl="display-p3-linear",Tc="linear",bo="srgb",Bl="rec709",Ic="p3",x0=0,P0=7680,Uu=7681,zc=7682,Ed=7683,ku=34055,Gu=34056,hu=5386,Qu=512,Eh=513,yd=514,Cd=515,xd=516,Hu=517,wd=518,Vu=519,yh=512,Ch=513,xh=514,du=515,wh=516,Sh=517,Mh=518,bh=519,sc=35044,Sd=35048,Md=35040,bd=35045,Th=35049,Td=35041,Id=35046,Rd=35050,Bd=35042,Ld="100",zu="300 es",j0=2e3,oc=2001;class La{addEventListener(K,oe){this._listeners===void 0&&(this._listeners={});const de=this._listeners;de[K]===void 0&&(de[K]=[]),de[K].indexOf(oe)===-1&&de[K].push(oe)}hasEventListener(K,oe){if(this._listeners===void 0)return!1;const de=this._listeners;return de[K]!==void 0&&de[K].indexOf(oe)!==-1}removeEventListener(K,oe){if(this._listeners===void 0)return;const ye=this._listeners[K];if(ye!==void 0){const Ie=ye.indexOf(oe);Ie!==-1&&ye.splice(Ie,1)}}dispatchEvent(K){if(this._listeners===void 0)return;const de=this._listeners[K.type];if(de!==void 0){K.target=this;const ye=de.slice(0);for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++)ye[Ie].call(this,K);K.target=null}}}const Wa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Wu=1234567;const Ll=Math.PI/180,ac=180/Math.PI;function c0(){const Be=Math.random()*4294967295|0,K=Math.random()*4294967295|0,oe=Math.random()*4294967295|0,de=Math.random()*4294967295|0;return(Wa[Be&255]+Wa[Be>>8&255]+Wa[Be>>16&255]+Wa[Be>>24&255]+"-"+Wa[K&255]+Wa[K>>8&255]+"-"+Wa[K>>16&15|64]+Wa[K>>24&255]+"-"+Wa[oe&63|128]+Wa[oe>>8&255]+"-"+Wa[oe>>16&255]+Wa[oe>>24&255]+Wa[de&255]+Wa[de>>8&255]+Wa[de>>16&255]+Wa[de>>24&255]).toLowerCase()}function qo(Be,K,oe){return Math.max(K,Math.min(oe,Be))}function Dl(Be,K){return(Be%K+K)%K}function Dd(Be,K,oe,de,ye){return de+(Be-K)*(ye-de)/(oe-K)}function Pd(Be,K,oe){return Be!==K?(oe-Be)/(K-Be):0}function Wc(Be,K,oe){return(1-oe)*Be+oe*K}function Ih(Be,K,oe,de){return Wc(Be,K,1-Math.exp(-oe*de))}function Rh(Be,K=1){return K-Math.abs(Dl(Be,K*2)-K)}function $c(Be,K,oe){return Be<=K?0:Be>=oe?1:(Be=(Be-K)/(oe-K),Be*Be*(3-2*Be))}function Xc(Be,K,oe){return Be<=K?0:Be>=oe?1:(Be=(Be-K)/(oe-K),Be*Be*Be*(Be*(Be*6-15)+10))}function Fd(Be,K){return Be+Math.floor(Math.random()*(K-Be+1))}function fu(Be,K){return Be+Math.random()*(K-Be)}function Od(Be){return Be*(.5-Math.random())}function Bh(Be){Be!==void 0&&(Wu=Be);let K=Wu+=1831565813;return K=Math.imul(K^K>>>15,K|1),K^=K+Math.imul(K^K>>>7,K|61),((K^K>>>14)>>>0)/4294967296}function pu(Be){return Be*Ll}function $u(Be){return Be*ac}function Lh(Be){return(Be&Be-1)===0&&Be!==0}function Dh(Be){return Math.pow(2,Math.ceil(Math.log(Be)/Math.LN2))}function Ph(Be){return Math.pow(2,Math.floor(Math.log(Be)/Math.LN2))}function Nd(Be,K,oe,de,ye){const Ie=Math.cos,Ue=Math.sin,He=Ie(oe/2),Ke=Ue(oe/2),Ze=Ie((K+de)/2),at=Ue((K+de)/2),mt=Ie((K-de)/2),vt=Ue((K-de)/2),St=Ie((de-K)/2),Lt=Ue((de-K)/2);switch(ye){case"XYX":Be.set(He*at,Ke*mt,Ke*vt,He*Ze);break;case"YZY":Be.set(Ke*vt,He*at,Ke*mt,He*Ze);break;case"ZXZ":Be.set(Ke*mt,Ke*vt,He*at,He*Ze);break;case"XZX":Be.set(He*at,Ke*Lt,Ke*St,He*Ze);break;case"YXY":Be.set(Ke*St,He*at,Ke*Lt,He*Ze);break;case"ZYZ":Be.set(Ke*Lt,Ke*St,He*at,He*Ze);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+ye)}}function $a(Be,K){switch(K.constructor){case Float32Array:return Be;case Uint32Array:return Be/4294967295;case Uint16Array:return Be/65535;case Uint8Array:return Be/255;case Int32Array:return Math.max(Be/2147483647,-1);case Int16Array:return Math.max(Be/32767,-1);case Int8Array:return Math.max(Be/127,-1);default:throw new Error("Invalid component type.")}}function Us(Be,K){switch(K.constructor){case Float32Array:return Be;case Uint32Array:return Math.round(Be*4294967295);case Uint16Array:return Math.round(Be*65535);case Uint8Array:return Math.round(Be*255);case Int32Array:return Math.round(Be*2147483647);case Int16Array:return Math.round(Be*32767);case Int8Array:return Math.round(Be*127);default:throw new Error("Invalid component type.")}}const Ud={DEG2RAD:Ll,RAD2DEG:ac,generateUUID:c0,clamp:qo,euclideanModulo:Dl,mapLinear:Dd,inverseLerp:Pd,lerp:Wc,damp:Ih,pingpong:Rh,smoothstep:$c,smootherstep:Xc,randInt:Fd,randFloat:fu,randFloatSpread:Od,seededRandom:Bh,degToRad:pu,radToDeg:$u,isPowerOfTwo:Lh,ceilPowerOfTwo:Dh,floorPowerOfTwo:Ph,setQuaternionFromProperEuler:Nd,normalize:Us,denormalize:$a};class qi{constructor(K=0,oe=0){qi.prototype.isVector2=!0,this.x=K,this.y=oe}get width(){return this.x}set width(K){this.x=K}get height(){return this.y}set height(K){this.y=K}set(K,oe){return this.x=K,this.y=oe,this}setScalar(K){return this.x=K,this.y=K,this}setX(K){return this.x=K,this}setY(K){return this.y=K,this}setComponent(K,oe){switch(K){case 0:this.x=oe;break;case 1:this.y=oe;break;default:throw new Error("index is out of range: "+K)}return this}getComponent(K){switch(K){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+K)}}clone(){return new this.constructor(this.x,this.y)}copy(K){return this.x=K.x,this.y=K.y,this}add(K){return this.x+=K.x,this.y+=K.y,this}addScalar(K){return this.x+=K,this.y+=K,this}addVectors(K,oe){return this.x=K.x+oe.x,this.y=K.y+oe.y,this}addScaledVector(K,oe){return this.x+=K.x*oe,this.y+=K.y*oe,this}sub(K){return this.x-=K.x,this.y-=K.y,this}subScalar(K){return this.x-=K,this.y-=K,this}subVectors(K,oe){return this.x=K.x-oe.x,this.y=K.y-oe.y,this}multiply(K){return this.x*=K.x,this.y*=K.y,this}multiplyScalar(K){return this.x*=K,this.y*=K,this}divide(K){return this.x/=K.x,this.y/=K.y,this}divideScalar(K){return this.multiplyScalar(1/K)}applyMatrix3(K){const oe=this.x,de=this.y,ye=K.elements;return this.x=ye[0]*oe+ye[3]*de+ye[6],this.y=ye[1]*oe+ye[4]*de+ye[7],this}min(K){return this.x=Math.min(this.x,K.x),this.y=Math.min(this.y,K.y),this}max(K){return this.x=Math.max(this.x,K.x),this.y=Math.max(this.y,K.y),this}clamp(K,oe){return this.x=Math.max(K.x,Math.min(oe.x,this.x)),this.y=Math.max(K.y,Math.min(oe.y,this.y)),this}clampScalar(K,oe){return this.x=Math.max(K,Math.min(oe,this.x)),this.y=Math.max(K,Math.min(oe,this.y)),this}clampLength(K,oe){const de=this.length();return this.divideScalar(de||1).multiplyScalar(Math.max(K,Math.min(oe,de)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(K){return this.x*K.x+this.y*K.y}cross(K){return this.x*K.y-this.y*K.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(K){const oe=Math.sqrt(this.lengthSq()*K.lengthSq());if(oe===0)return Math.PI/2;const de=this.dot(K)/oe;return Math.acos(qo(de,-1,1))}distanceTo(K){return Math.sqrt(this.distanceToSquared(K))}distanceToSquared(K){const oe=this.x-K.x,de=this.y-K.y;return oe*oe+de*de}manhattanDistanceTo(K){return Math.abs(this.x-K.x)+Math.abs(this.y-K.y)}setLength(K){return this.normalize().multiplyScalar(K)}lerp(K,oe){return this.x+=(K.x-this.x)*oe,this.y+=(K.y-this.y)*oe,this}lerpVectors(K,oe,de){return this.x=K.x+(oe.x-K.x)*de,this.y=K.y+(oe.y-K.y)*de,this}equals(K){return K.x===this.x&&K.y===this.y}fromArray(K,oe=0){return this.x=K[oe],this.y=K[oe+1],this}toArray(K=[],oe=0){return K[oe]=this.x,K[oe+1]=this.y,K}fromBufferAttribute(K,oe){return this.x=K.getX(oe),this.y=K.getY(oe),this}rotateAround(K,oe){const de=Math.cos(oe),ye=Math.sin(oe),Ie=this.x-K.x,Ue=this.y-K.y;return this.x=Ie*de-Ue*ye+K.x,this.y=Ie*ye+Ue*de+K.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class gs{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze){gs.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],K!==void 0&&this.set(K,oe,de,ye,Ie,Ue,He,Ke,Ze)}set(K,oe,de,ye,Ie,Ue,He,Ke,Ze){const at=this.elements;return at[0]=K,at[1]=ye,at[2]=He,at[3]=oe,at[4]=Ie,at[5]=Ke,at[6]=de,at[7]=Ue,at[8]=Ze,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(K){const oe=this.elements,de=K.elements;return oe[0]=de[0],oe[1]=de[1],oe[2]=de[2],oe[3]=de[3],oe[4]=de[4],oe[5]=de[5],oe[6]=de[6],oe[7]=de[7],oe[8]=de[8],this}extractBasis(K,oe,de){return K.setFromMatrix3Column(this,0),oe.setFromMatrix3Column(this,1),de.setFromMatrix3Column(this,2),this}setFromMatrix4(K){const oe=K.elements;return this.set(oe[0],oe[4],oe[8],oe[1],oe[5],oe[9],oe[2],oe[6],oe[10]),this}multiply(K){return this.multiplyMatrices(this,K)}premultiply(K){return this.multiplyMatrices(K,this)}multiplyMatrices(K,oe){const de=K.elements,ye=oe.elements,Ie=this.elements,Ue=de[0],He=de[3],Ke=de[6],Ze=de[1],at=de[4],mt=de[7],vt=de[2],St=de[5],Lt=de[8],Ht=ye[0],Dt=ye[3],bt=ye[6],tn=ye[1],Zt=ye[4],qt=ye[7],Un=ye[2],_n=ye[5],bn=ye[8];return Ie[0]=Ue*Ht+He*tn+Ke*Un,Ie[3]=Ue*Dt+He*Zt+Ke*_n,Ie[6]=Ue*bt+He*qt+Ke*bn,Ie[1]=Ze*Ht+at*tn+mt*Un,Ie[4]=Ze*Dt+at*Zt+mt*_n,Ie[7]=Ze*bt+at*qt+mt*bn,Ie[2]=vt*Ht+St*tn+Lt*Un,Ie[5]=vt*Dt+St*Zt+Lt*_n,Ie[8]=vt*bt+St*qt+Lt*bn,this}multiplyScalar(K){const oe=this.elements;return oe[0]*=K,oe[3]*=K,oe[6]*=K,oe[1]*=K,oe[4]*=K,oe[7]*=K,oe[2]*=K,oe[5]*=K,oe[8]*=K,this}determinant(){const K=this.elements,oe=K[0],de=K[1],ye=K[2],Ie=K[3],Ue=K[4],He=K[5],Ke=K[6],Ze=K[7],at=K[8];return oe*Ue*at-oe*He*Ze-de*Ie*at+de*He*Ke+ye*Ie*Ze-ye*Ue*Ke}invert(){const K=this.elements,oe=K[0],de=K[1],ye=K[2],Ie=K[3],Ue=K[4],He=K[5],Ke=K[6],Ze=K[7],at=K[8],mt=at*Ue-He*Ze,vt=He*Ke-at*Ie,St=Ze*Ie-Ue*Ke,Lt=oe*mt+de*vt+ye*St;if(Lt===0)return this.set(0,0,0,0,0,0,0,0,0);const Ht=1/Lt;return K[0]=mt*Ht,K[1]=(ye*Ze-at*de)*Ht,K[2]=(He*de-ye*Ue)*Ht,K[3]=vt*Ht,K[4]=(at*oe-ye*Ke)*Ht,K[5]=(ye*Ie-He*oe)*Ht,K[6]=St*Ht,K[7]=(de*Ke-Ze*oe)*Ht,K[8]=(Ue*oe-de*Ie)*Ht,this}transpose(){let K;const oe=this.elements;return K=oe[1],oe[1]=oe[3],oe[3]=K,K=oe[2],oe[2]=oe[6],oe[6]=K,K=oe[5],oe[5]=oe[7],oe[7]=K,this}getNormalMatrix(K){return this.setFromMatrix4(K).invert().transpose()}transposeIntoArray(K){const oe=this.elements;return K[0]=oe[0],K[1]=oe[3],K[2]=oe[6],K[3]=oe[1],K[4]=oe[4],K[5]=oe[7],K[6]=oe[2],K[7]=oe[5],K[8]=oe[8],this}setUvTransform(K,oe,de,ye,Ie,Ue,He){const Ke=Math.cos(Ie),Ze=Math.sin(Ie);return this.set(de*Ke,de*Ze,-de*(Ke*Ue+Ze*He)+Ue+K,-ye*Ze,ye*Ke,-ye*(-Ze*Ue+Ke*He)+He+oe,0,0,1),this}scale(K,oe){return this.premultiply(Pl.makeScale(K,oe)),this}rotate(K){return this.premultiply(Pl.makeRotation(-K)),this}translate(K,oe){return this.premultiply(Pl.makeTranslation(K,oe)),this}makeTranslation(K,oe){return K.isVector2?this.set(1,0,K.x,0,1,K.y,0,0,1):this.set(1,0,K,0,1,oe,0,0,1),this}makeRotation(K){const oe=Math.cos(K),de=Math.sin(K);return this.set(oe,-de,0,de,oe,0,0,0,1),this}makeScale(K,oe){return this.set(K,0,0,0,oe,0,0,0,1),this}equals(K){const oe=this.elements,de=K.elements;for(let ye=0;ye<9;ye++)if(oe[ye]!==de[ye])return!1;return!0}fromArray(K,oe=0){for(let de=0;de<9;de++)this.elements[de]=K[de+oe];return this}toArray(K=[],oe=0){const de=this.elements;return K[oe]=de[0],K[oe+1]=de[1],K[oe+2]=de[2],K[oe+3]=de[3],K[oe+4]=de[4],K[oe+5]=de[5],K[oe+6]=de[6],K[oe+7]=de[7],K[oe+8]=de[8],K}clone(){return new this.constructor().fromArray(this.elements)}}const Pl=new gs;function Au(Be){for(let K=Be.length-1;K>=0;--K)if(Be[K]>=65535)return!0;return!1}const Xu={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fl(Be,K){return new Xu[Be](K)}function cc(Be){return document.createElementNS("http://www.w3.org/1999/xhtml",Be)}function mu(){const Be=cc("canvas");return Be.style.display="block",Be}const uc={};function oa(Be){Be in uc||(uc[Be]=!0,console.warn(Be))}const hc=new gs().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),gu=new gs().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ol={[za]:{transfer:Tc,primaries:Bl,toReference:Be=>Be,fromReference:Be=>Be},[lo]:{transfer:bo,primaries:Bl,toReference:Be=>Be.convertSRGBToLinear(),fromReference:Be=>Be.convertLinearToSRGB()},[Rl]:{transfer:Tc,primaries:Ic,toReference:Be=>Be.applyMatrix3(gu),fromReference:Be=>Be.applyMatrix3(hc)},[bc]:{transfer:bo,primaries:Ic,toReference:Be=>Be.convertSRGBToLinear().applyMatrix3(gu),fromReference:Be=>Be.applyMatrix3(hc).convertLinearToSRGB()}},Ku=new Set([za,Rl]),To={enabled:!0,_workingColorSpace:za,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(Be){if(!Ku.has(Be))throw new Error(`Unsupported working color space, "${Be}".`);this._workingColorSpace=Be},convert:function(Be,K,oe){if(this.enabled===!1||K===oe||!K||!oe)return Be;const de=Ol[K].toReference,ye=Ol[oe].fromReference;return ye(de(Be))},fromWorkingColorSpace:function(Be,K){return this.convert(Be,this._workingColorSpace,K)},toWorkingColorSpace:function(Be,K){return this.convert(Be,K,this._workingColorSpace)},getPrimaries:function(Be){return Ol[Be].primaries},getTransfer:function(Be){return Be===Ba?Tc:Ol[Be].transfer}};function Nl(Be){return Be<.04045?Be*.0773993808:Math.pow(Be*.9478672986+.0521327014,2.4)}function Ul(Be){return Be<.0031308?Be*12.92:1.055*Math.pow(Be,.41666)-.055}let cl;class dc{static getDataURL(K){if(/^data:/i.test(K.src)||typeof HTMLCanvasElement>"u")return K.src;let oe;if(K instanceof HTMLCanvasElement)oe=K;else{cl===void 0&&(cl=cc("canvas")),cl.width=K.width,cl.height=K.height;const de=cl.getContext("2d");K instanceof ImageData?de.putImageData(K,0,0):de.drawImage(K,0,0,K.width,K.height),oe=cl}return oe.width>2048||oe.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",K),oe.toDataURL("image/jpeg",.6)):oe.toDataURL("image/png")}static sRGBToLinear(K){if(typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&K instanceof ImageBitmap){const oe=cc("canvas");oe.width=K.width,oe.height=K.height;const de=oe.getContext("2d");de.drawImage(K,0,0,K.width,K.height);const ye=de.getImageData(0,0,K.width,K.height),Ie=ye.data;for(let Ue=0;Ue<Ie.length;Ue++)Ie[Ue]=Nl(Ie[Ue]/255)*255;return de.putImageData(ye,0,0),oe}else if(K.data){const oe=K.data.slice(0);for(let de=0;de<oe.length;de++)oe instanceof Uint8Array||oe instanceof Uint8ClampedArray?oe[de]=Math.floor(Nl(oe[de]/255)*255):oe[de]=Nl(oe[de]);return{data:oe,width:K.width,height:K.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),K}}let Kc=0;class Wo{constructor(K=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Kc++}),this.uuid=c0(),this.data=K,this.dataReady=!0,this.version=0}set needsUpdate(K){K===!0&&this.version++}toJSON(K){const oe=K===void 0||typeof K=="string";if(!oe&&K.images[this.uuid]!==void 0)return K.images[this.uuid];const de={uuid:this.uuid,url:""},ye=this.data;if(ye!==null){let Ie;if(Array.isArray(ye)){Ie=[];for(let Ue=0,He=ye.length;Ue<He;Ue++)ye[Ue].isDataTexture?Ie.push(Yc(ye[Ue].image)):Ie.push(Yc(ye[Ue]))}else Ie=Yc(ye);de.url=Ie}return oe||(K.images[this.uuid]=de),de}}function Yc(Be){return typeof HTMLImageElement<"u"&&Be instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Be instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Be instanceof ImageBitmap?dc.getDataURL(Be):Be.data?{data:Array.from(Be.data),width:Be.width,height:Be.height,type:Be.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Yu=0;class Fo extends La{constructor(K=Fo.DEFAULT_IMAGE,oe=Fo.DEFAULT_MAPPING,de=yn,ye=yn,Ie=Jr,Ue=Qs,He=Jt,Ke=Mo,Ze=Fo.DEFAULT_ANISOTROPY,at=Ba){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Yu++}),this.uuid=c0(),this.name="",this.source=new Wo(K),this.mipmaps=[],this.mapping=oe,this.channel=0,this.wrapS=de,this.wrapT=ye,this.magFilter=Ie,this.minFilter=Ue,this.anisotropy=Ze,this.format=He,this.internalFormat=null,this.type=Ke,this.offset=new qi(0,0),this.repeat=new qi(1,1),this.center=new qi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new gs,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=at,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(K=null){this.source.data=K}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(K){return this.name=K.name,this.source=K.source,this.mipmaps=K.mipmaps.slice(0),this.mapping=K.mapping,this.channel=K.channel,this.wrapS=K.wrapS,this.wrapT=K.wrapT,this.magFilter=K.magFilter,this.minFilter=K.minFilter,this.anisotropy=K.anisotropy,this.format=K.format,this.internalFormat=K.internalFormat,this.type=K.type,this.offset.copy(K.offset),this.repeat.copy(K.repeat),this.center.copy(K.center),this.rotation=K.rotation,this.matrixAutoUpdate=K.matrixAutoUpdate,this.matrix.copy(K.matrix),this.generateMipmaps=K.generateMipmaps,this.premultiplyAlpha=K.premultiplyAlpha,this.flipY=K.flipY,this.unpackAlignment=K.unpackAlignment,this.colorSpace=K.colorSpace,this.userData=JSON.parse(JSON.stringify(K.userData)),this.needsUpdate=!0,this}toJSON(K){const oe=K===void 0||typeof K=="string";if(!oe&&K.textures[this.uuid]!==void 0)return K.textures[this.uuid];const de={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(K).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(de.userData=this.userData),oe||(K.textures[this.uuid]=de),de}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(K){if(this.mapping!==gn)return K;if(K.applyMatrix3(this.matrix),K.x<0||K.x>1)switch(this.wrapS){case sn:K.x=K.x-Math.floor(K.x);break;case yn:K.x=K.x<0?0:1;break;case ni:Math.abs(Math.floor(K.x)%2)===1?K.x=Math.ceil(K.x)-K.x:K.x=K.x-Math.floor(K.x);break}if(K.y<0||K.y>1)switch(this.wrapT){case sn:K.y=K.y-Math.floor(K.y);break;case yn:K.y=K.y<0?0:1;break;case ni:Math.abs(Math.floor(K.y)%2)===1?K.y=Math.ceil(K.y)-K.y:K.y=K.y-Math.floor(K.y);break}return this.flipY&&(K.y=1-K.y),K}set needsUpdate(K){K===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(K){K===!0&&this.pmremVersion++}}Fo.DEFAULT_IMAGE=null,Fo.DEFAULT_MAPPING=gn,Fo.DEFAULT_ANISOTROPY=1;class go{constructor(K=0,oe=0,de=0,ye=1){go.prototype.isVector4=!0,this.x=K,this.y=oe,this.z=de,this.w=ye}get width(){return this.z}set width(K){this.z=K}get height(){return this.w}set height(K){this.w=K}set(K,oe,de,ye){return this.x=K,this.y=oe,this.z=de,this.w=ye,this}setScalar(K){return this.x=K,this.y=K,this.z=K,this.w=K,this}setX(K){return this.x=K,this}setY(K){return this.y=K,this}setZ(K){return this.z=K,this}setW(K){return this.w=K,this}setComponent(K,oe){switch(K){case 0:this.x=oe;break;case 1:this.y=oe;break;case 2:this.z=oe;break;case 3:this.w=oe;break;default:throw new Error("index is out of range: "+K)}return this}getComponent(K){switch(K){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+K)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(K){return this.x=K.x,this.y=K.y,this.z=K.z,this.w=K.w!==void 0?K.w:1,this}add(K){return this.x+=K.x,this.y+=K.y,this.z+=K.z,this.w+=K.w,this}addScalar(K){return this.x+=K,this.y+=K,this.z+=K,this.w+=K,this}addVectors(K,oe){return this.x=K.x+oe.x,this.y=K.y+oe.y,this.z=K.z+oe.z,this.w=K.w+oe.w,this}addScaledVector(K,oe){return this.x+=K.x*oe,this.y+=K.y*oe,this.z+=K.z*oe,this.w+=K.w*oe,this}sub(K){return this.x-=K.x,this.y-=K.y,this.z-=K.z,this.w-=K.w,this}subScalar(K){return this.x-=K,this.y-=K,this.z-=K,this.w-=K,this}subVectors(K,oe){return this.x=K.x-oe.x,this.y=K.y-oe.y,this.z=K.z-oe.z,this.w=K.w-oe.w,this}multiply(K){return this.x*=K.x,this.y*=K.y,this.z*=K.z,this.w*=K.w,this}multiplyScalar(K){return this.x*=K,this.y*=K,this.z*=K,this.w*=K,this}applyMatrix4(K){const oe=this.x,de=this.y,ye=this.z,Ie=this.w,Ue=K.elements;return this.x=Ue[0]*oe+Ue[4]*de+Ue[8]*ye+Ue[12]*Ie,this.y=Ue[1]*oe+Ue[5]*de+Ue[9]*ye+Ue[13]*Ie,this.z=Ue[2]*oe+Ue[6]*de+Ue[10]*ye+Ue[14]*Ie,this.w=Ue[3]*oe+Ue[7]*de+Ue[11]*ye+Ue[15]*Ie,this}divideScalar(K){return this.multiplyScalar(1/K)}setAxisAngleFromQuaternion(K){this.w=2*Math.acos(K.w);const oe=Math.sqrt(1-K.w*K.w);return oe<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=K.x/oe,this.y=K.y/oe,this.z=K.z/oe),this}setAxisAngleFromRotationMatrix(K){let oe,de,ye,Ie;const Ke=K.elements,Ze=Ke[0],at=Ke[4],mt=Ke[8],vt=Ke[1],St=Ke[5],Lt=Ke[9],Ht=Ke[2],Dt=Ke[6],bt=Ke[10];if(Math.abs(at-vt)<.01&&Math.abs(mt-Ht)<.01&&Math.abs(Lt-Dt)<.01){if(Math.abs(at+vt)<.1&&Math.abs(mt+Ht)<.1&&Math.abs(Lt+Dt)<.1&&Math.abs(Ze+St+bt-3)<.1)return this.set(1,0,0,0),this;oe=Math.PI;const Zt=(Ze+1)/2,qt=(St+1)/2,Un=(bt+1)/2,_n=(at+vt)/4,bn=(mt+Ht)/4,Fn=(Lt+Dt)/4;return Zt>qt&&Zt>Un?Zt<.01?(de=0,ye=.707106781,Ie=.707106781):(de=Math.sqrt(Zt),ye=_n/de,Ie=bn/de):qt>Un?qt<.01?(de=.707106781,ye=0,Ie=.707106781):(ye=Math.sqrt(qt),de=_n/ye,Ie=Fn/ye):Un<.01?(de=.707106781,ye=.707106781,Ie=0):(Ie=Math.sqrt(Un),de=bn/Ie,ye=Fn/Ie),this.set(de,ye,Ie,oe),this}let tn=Math.sqrt((Dt-Lt)*(Dt-Lt)+(mt-Ht)*(mt-Ht)+(vt-at)*(vt-at));return Math.abs(tn)<.001&&(tn=1),this.x=(Dt-Lt)/tn,this.y=(mt-Ht)/tn,this.z=(vt-at)/tn,this.w=Math.acos((Ze+St+bt-1)/2),this}min(K){return this.x=Math.min(this.x,K.x),this.y=Math.min(this.y,K.y),this.z=Math.min(this.z,K.z),this.w=Math.min(this.w,K.w),this}max(K){return this.x=Math.max(this.x,K.x),this.y=Math.max(this.y,K.y),this.z=Math.max(this.z,K.z),this.w=Math.max(this.w,K.w),this}clamp(K,oe){return this.x=Math.max(K.x,Math.min(oe.x,this.x)),this.y=Math.max(K.y,Math.min(oe.y,this.y)),this.z=Math.max(K.z,Math.min(oe.z,this.z)),this.w=Math.max(K.w,Math.min(oe.w,this.w)),this}clampScalar(K,oe){return this.x=Math.max(K,Math.min(oe,this.x)),this.y=Math.max(K,Math.min(oe,this.y)),this.z=Math.max(K,Math.min(oe,this.z)),this.w=Math.max(K,Math.min(oe,this.w)),this}clampLength(K,oe){const de=this.length();return this.divideScalar(de||1).multiplyScalar(Math.max(K,Math.min(oe,de)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(K){return this.x*K.x+this.y*K.y+this.z*K.z+this.w*K.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(K){return this.normalize().multiplyScalar(K)}lerp(K,oe){return this.x+=(K.x-this.x)*oe,this.y+=(K.y-this.y)*oe,this.z+=(K.z-this.z)*oe,this.w+=(K.w-this.w)*oe,this}lerpVectors(K,oe,de){return this.x=K.x+(oe.x-K.x)*de,this.y=K.y+(oe.y-K.y)*de,this.z=K.z+(oe.z-K.z)*de,this.w=K.w+(oe.w-K.w)*de,this}equals(K){return K.x===this.x&&K.y===this.y&&K.z===this.z&&K.w===this.w}fromArray(K,oe=0){return this.x=K[oe],this.y=K[oe+1],this.z=K[oe+2],this.w=K[oe+3],this}toArray(K=[],oe=0){return K[oe]=this.x,K[oe+1]=this.y,K[oe+2]=this.z,K[oe+3]=this.w,K}fromBufferAttribute(K,oe){return this.x=K.getX(oe),this.y=K.getY(oe),this.z=K.getZ(oe),this.w=K.getW(oe),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class fc extends La{constructor(K=1,oe=1,de={}){super(),this.isRenderTarget=!0,this.width=K,this.height=oe,this.depth=1,this.scissor=new go(0,0,K,oe),this.scissorTest=!1,this.viewport=new go(0,0,K,oe);const ye={width:K,height:oe,depth:1};de=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Jr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},de);const Ie=new Fo(ye,de.mapping,de.wrapS,de.wrapT,de.magFilter,de.minFilter,de.format,de.type,de.anisotropy,de.colorSpace);Ie.flipY=!1,Ie.generateMipmaps=de.generateMipmaps,Ie.internalFormat=de.internalFormat,this.textures=[];const Ue=de.count;for(let He=0;He<Ue;He++)this.textures[He]=Ie.clone(),this.textures[He].isRenderTargetTexture=!0;this.depthBuffer=de.depthBuffer,this.stencilBuffer=de.stencilBuffer,this.resolveDepthBuffer=de.resolveDepthBuffer,this.resolveStencilBuffer=de.resolveStencilBuffer,this.depthTexture=de.depthTexture,this.samples=de.samples}get texture(){return this.textures[0]}set texture(K){this.textures[0]=K}setSize(K,oe,de=1){if(this.width!==K||this.height!==oe||this.depth!==de){this.width=K,this.height=oe,this.depth=de;for(let ye=0,Ie=this.textures.length;ye<Ie;ye++)this.textures[ye].image.width=K,this.textures[ye].image.height=oe,this.textures[ye].image.depth=de;this.dispose()}this.viewport.set(0,0,K,oe),this.scissor.set(0,0,K,oe)}clone(){return new this.constructor().copy(this)}copy(K){this.width=K.width,this.height=K.height,this.depth=K.depth,this.scissor.copy(K.scissor),this.scissorTest=K.scissorTest,this.viewport.copy(K.viewport),this.textures.length=0;for(let de=0,ye=K.textures.length;de<ye;de++)this.textures[de]=K.textures[de].clone(),this.textures[de].isRenderTargetTexture=!0;const oe=Object.assign({},K.texture.image);return this.texture.source=new Wo(oe),this.depthBuffer=K.depthBuffer,this.stencilBuffer=K.stencilBuffer,this.resolveDepthBuffer=K.resolveDepthBuffer,this.resolveStencilBuffer=K.resolveStencilBuffer,K.depthTexture!==null&&(this.depthTexture=K.depthTexture.clone()),this.samples=K.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ga extends fc{constructor(K=1,oe=1,de={}){super(K,oe,de),this.isWebGLRenderTarget=!0}}class Rc extends Fo{constructor(K=null,oe=1,de=1,ye=1){super(null),this.isDataArrayTexture=!0,this.image={data:K,width:oe,height:de,depth:ye},this.magFilter=ki,this.minFilter=ki,this.wrapR=yn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Kr extends ga{constructor(K=1,oe=1,de=1,ye={}){super(K,oe,ye),this.isWebGLArrayRenderTarget=!0,this.depth=de,this.texture=new Rc(null,K,oe,de),this.texture.isRenderTargetTexture=!0}}class Fs extends Fo{constructor(K=null,oe=1,de=1,ye=1){super(null),this.isData3DTexture=!0,this.image={data:K,width:oe,height:de,depth:ye},this.magFilter=ki,this.minFilter=ki,this.wrapR=yn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class co extends ga{constructor(K=1,oe=1,de=1,ye={}){super(K,oe,ye),this.isWebGL3DRenderTarget=!0,this.depth=de,this.texture=new Fs(null,K,oe,de),this.texture.isRenderTargetTexture=!0}}class to{constructor(K=0,oe=0,de=0,ye=1){this.isQuaternion=!0,this._x=K,this._y=oe,this._z=de,this._w=ye}static slerpFlat(K,oe,de,ye,Ie,Ue,He){let Ke=de[ye+0],Ze=de[ye+1],at=de[ye+2],mt=de[ye+3];const vt=Ie[Ue+0],St=Ie[Ue+1],Lt=Ie[Ue+2],Ht=Ie[Ue+3];if(He===0){K[oe+0]=Ke,K[oe+1]=Ze,K[oe+2]=at,K[oe+3]=mt;return}if(He===1){K[oe+0]=vt,K[oe+1]=St,K[oe+2]=Lt,K[oe+3]=Ht;return}if(mt!==Ht||Ke!==vt||Ze!==St||at!==Lt){let Dt=1-He;const bt=Ke*vt+Ze*St+at*Lt+mt*Ht,tn=bt>=0?1:-1,Zt=1-bt*bt;if(Zt>Number.EPSILON){const Un=Math.sqrt(Zt),_n=Math.atan2(Un,bt*tn);Dt=Math.sin(Dt*_n)/Un,He=Math.sin(He*_n)/Un}const qt=He*tn;if(Ke=Ke*Dt+vt*qt,Ze=Ze*Dt+St*qt,at=at*Dt+Lt*qt,mt=mt*Dt+Ht*qt,Dt===1-He){const Un=1/Math.sqrt(Ke*Ke+Ze*Ze+at*at+mt*mt);Ke*=Un,Ze*=Un,at*=Un,mt*=Un}}K[oe]=Ke,K[oe+1]=Ze,K[oe+2]=at,K[oe+3]=mt}static multiplyQuaternionsFlat(K,oe,de,ye,Ie,Ue){const He=de[ye],Ke=de[ye+1],Ze=de[ye+2],at=de[ye+3],mt=Ie[Ue],vt=Ie[Ue+1],St=Ie[Ue+2],Lt=Ie[Ue+3];return K[oe]=He*Lt+at*mt+Ke*St-Ze*vt,K[oe+1]=Ke*Lt+at*vt+Ze*mt-He*St,K[oe+2]=Ze*Lt+at*St+He*vt-Ke*mt,K[oe+3]=at*Lt-He*mt-Ke*vt-Ze*St,K}get x(){return this._x}set x(K){this._x=K,this._onChangeCallback()}get y(){return this._y}set y(K){this._y=K,this._onChangeCallback()}get z(){return this._z}set z(K){this._z=K,this._onChangeCallback()}get w(){return this._w}set w(K){this._w=K,this._onChangeCallback()}set(K,oe,de,ye){return this._x=K,this._y=oe,this._z=de,this._w=ye,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(K){return this._x=K.x,this._y=K.y,this._z=K.z,this._w=K.w,this._onChangeCallback(),this}setFromEuler(K,oe=!0){const de=K._x,ye=K._y,Ie=K._z,Ue=K._order,He=Math.cos,Ke=Math.sin,Ze=He(de/2),at=He(ye/2),mt=He(Ie/2),vt=Ke(de/2),St=Ke(ye/2),Lt=Ke(Ie/2);switch(Ue){case"XYZ":this._x=vt*at*mt+Ze*St*Lt,this._y=Ze*St*mt-vt*at*Lt,this._z=Ze*at*Lt+vt*St*mt,this._w=Ze*at*mt-vt*St*Lt;break;case"YXZ":this._x=vt*at*mt+Ze*St*Lt,this._y=Ze*St*mt-vt*at*Lt,this._z=Ze*at*Lt-vt*St*mt,this._w=Ze*at*mt+vt*St*Lt;break;case"ZXY":this._x=vt*at*mt-Ze*St*Lt,this._y=Ze*St*mt+vt*at*Lt,this._z=Ze*at*Lt+vt*St*mt,this._w=Ze*at*mt-vt*St*Lt;break;case"ZYX":this._x=vt*at*mt-Ze*St*Lt,this._y=Ze*St*mt+vt*at*Lt,this._z=Ze*at*Lt-vt*St*mt,this._w=Ze*at*mt+vt*St*Lt;break;case"YZX":this._x=vt*at*mt+Ze*St*Lt,this._y=Ze*St*mt+vt*at*Lt,this._z=Ze*at*Lt-vt*St*mt,this._w=Ze*at*mt-vt*St*Lt;break;case"XZY":this._x=vt*at*mt-Ze*St*Lt,this._y=Ze*St*mt-vt*at*Lt,this._z=Ze*at*Lt+vt*St*mt,this._w=Ze*at*mt+vt*St*Lt;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+Ue)}return oe===!0&&this._onChangeCallback(),this}setFromAxisAngle(K,oe){const de=oe/2,ye=Math.sin(de);return this._x=K.x*ye,this._y=K.y*ye,this._z=K.z*ye,this._w=Math.cos(de),this._onChangeCallback(),this}setFromRotationMatrix(K){const oe=K.elements,de=oe[0],ye=oe[4],Ie=oe[8],Ue=oe[1],He=oe[5],Ke=oe[9],Ze=oe[2],at=oe[6],mt=oe[10],vt=de+He+mt;if(vt>0){const St=.5/Math.sqrt(vt+1);this._w=.25/St,this._x=(at-Ke)*St,this._y=(Ie-Ze)*St,this._z=(Ue-ye)*St}else if(de>He&&de>mt){const St=2*Math.sqrt(1+de-He-mt);this._w=(at-Ke)/St,this._x=.25*St,this._y=(ye+Ue)/St,this._z=(Ie+Ze)/St}else if(He>mt){const St=2*Math.sqrt(1+He-de-mt);this._w=(Ie-Ze)/St,this._x=(ye+Ue)/St,this._y=.25*St,this._z=(Ke+at)/St}else{const St=2*Math.sqrt(1+mt-de-He);this._w=(Ue-ye)/St,this._x=(Ie+Ze)/St,this._y=(Ke+at)/St,this._z=.25*St}return this._onChangeCallback(),this}setFromUnitVectors(K,oe){let de=K.dot(oe)+1;return de<Number.EPSILON?(de=0,Math.abs(K.x)>Math.abs(K.z)?(this._x=-K.y,this._y=K.x,this._z=0,this._w=de):(this._x=0,this._y=-K.z,this._z=K.y,this._w=de)):(this._x=K.y*oe.z-K.z*oe.y,this._y=K.z*oe.x-K.x*oe.z,this._z=K.x*oe.y-K.y*oe.x,this._w=de),this.normalize()}angleTo(K){return 2*Math.acos(Math.abs(qo(this.dot(K),-1,1)))}rotateTowards(K,oe){const de=this.angleTo(K);if(de===0)return this;const ye=Math.min(1,oe/de);return this.slerp(K,ye),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(K){return this._x*K._x+this._y*K._y+this._z*K._z+this._w*K._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let K=this.length();return K===0?(this._x=0,this._y=0,this._z=0,this._w=1):(K=1/K,this._x=this._x*K,this._y=this._y*K,this._z=this._z*K,this._w=this._w*K),this._onChangeCallback(),this}multiply(K){return this.multiplyQuaternions(this,K)}premultiply(K){return this.multiplyQuaternions(K,this)}multiplyQuaternions(K,oe){const de=K._x,ye=K._y,Ie=K._z,Ue=K._w,He=oe._x,Ke=oe._y,Ze=oe._z,at=oe._w;return this._x=de*at+Ue*He+ye*Ze-Ie*Ke,this._y=ye*at+Ue*Ke+Ie*He-de*Ze,this._z=Ie*at+Ue*Ze+de*Ke-ye*He,this._w=Ue*at-de*He-ye*Ke-Ie*Ze,this._onChangeCallback(),this}slerp(K,oe){if(oe===0)return this;if(oe===1)return this.copy(K);const de=this._x,ye=this._y,Ie=this._z,Ue=this._w;let He=Ue*K._w+de*K._x+ye*K._y+Ie*K._z;if(He<0?(this._w=-K._w,this._x=-K._x,this._y=-K._y,this._z=-K._z,He=-He):this.copy(K),He>=1)return this._w=Ue,this._x=de,this._y=ye,this._z=Ie,this;const Ke=1-He*He;if(Ke<=Number.EPSILON){const St=1-oe;return this._w=St*Ue+oe*this._w,this._x=St*de+oe*this._x,this._y=St*ye+oe*this._y,this._z=St*Ie+oe*this._z,this.normalize(),this}const Ze=Math.sqrt(Ke),at=Math.atan2(Ze,He),mt=Math.sin((1-oe)*at)/Ze,vt=Math.sin(oe*at)/Ze;return this._w=Ue*mt+this._w*vt,this._x=de*mt+this._x*vt,this._y=ye*mt+this._y*vt,this._z=Ie*mt+this._z*vt,this._onChangeCallback(),this}slerpQuaternions(K,oe,de){return this.copy(K).slerp(oe,de)}random(){const K=2*Math.PI*Math.random(),oe=2*Math.PI*Math.random(),de=Math.random(),ye=Math.sqrt(1-de),Ie=Math.sqrt(de);return this.set(ye*Math.sin(K),ye*Math.cos(K),Ie*Math.sin(oe),Ie*Math.cos(oe))}equals(K){return K._x===this._x&&K._y===this._y&&K._z===this._z&&K._w===this._w}fromArray(K,oe=0){return this._x=K[oe],this._y=K[oe+1],this._z=K[oe+2],this._w=K[oe+3],this._onChangeCallback(),this}toArray(K=[],oe=0){return K[oe]=this._x,K[oe+1]=this._y,K[oe+2]=this._z,K[oe+3]=this._w,K}fromBufferAttribute(K,oe){return this._x=K.getX(oe),this._y=K.getY(oe),this._z=K.getZ(oe),this._w=K.getW(oe),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(K){return this._onChangeCallback=K,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class vn{constructor(K=0,oe=0,de=0){vn.prototype.isVector3=!0,this.x=K,this.y=oe,this.z=de}set(K,oe,de){return de===void 0&&(de=this.z),this.x=K,this.y=oe,this.z=de,this}setScalar(K){return this.x=K,this.y=K,this.z=K,this}setX(K){return this.x=K,this}setY(K){return this.y=K,this}setZ(K){return this.z=K,this}setComponent(K,oe){switch(K){case 0:this.x=oe;break;case 1:this.y=oe;break;case 2:this.z=oe;break;default:throw new Error("index is out of range: "+K)}return this}getComponent(K){switch(K){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+K)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(K){return this.x=K.x,this.y=K.y,this.z=K.z,this}add(K){return this.x+=K.x,this.y+=K.y,this.z+=K.z,this}addScalar(K){return this.x+=K,this.y+=K,this.z+=K,this}addVectors(K,oe){return this.x=K.x+oe.x,this.y=K.y+oe.y,this.z=K.z+oe.z,this}addScaledVector(K,oe){return this.x+=K.x*oe,this.y+=K.y*oe,this.z+=K.z*oe,this}sub(K){return this.x-=K.x,this.y-=K.y,this.z-=K.z,this}subScalar(K){return this.x-=K,this.y-=K,this.z-=K,this}subVectors(K,oe){return this.x=K.x-oe.x,this.y=K.y-oe.y,this.z=K.z-oe.z,this}multiply(K){return this.x*=K.x,this.y*=K.y,this.z*=K.z,this}multiplyScalar(K){return this.x*=K,this.y*=K,this.z*=K,this}multiplyVectors(K,oe){return this.x=K.x*oe.x,this.y=K.y*oe.y,this.z=K.z*oe.z,this}applyEuler(K){return this.applyQuaternion($o.setFromEuler(K))}applyAxisAngle(K,oe){return this.applyQuaternion($o.setFromAxisAngle(K,oe))}applyMatrix3(K){const oe=this.x,de=this.y,ye=this.z,Ie=K.elements;return this.x=Ie[0]*oe+Ie[3]*de+Ie[6]*ye,this.y=Ie[1]*oe+Ie[4]*de+Ie[7]*ye,this.z=Ie[2]*oe+Ie[5]*de+Ie[8]*ye,this}applyNormalMatrix(K){return this.applyMatrix3(K).normalize()}applyMatrix4(K){const oe=this.x,de=this.y,ye=this.z,Ie=K.elements,Ue=1/(Ie[3]*oe+Ie[7]*de+Ie[11]*ye+Ie[15]);return this.x=(Ie[0]*oe+Ie[4]*de+Ie[8]*ye+Ie[12])*Ue,this.y=(Ie[1]*oe+Ie[5]*de+Ie[9]*ye+Ie[13])*Ue,this.z=(Ie[2]*oe+Ie[6]*de+Ie[10]*ye+Ie[14])*Ue,this}applyQuaternion(K){const oe=this.x,de=this.y,ye=this.z,Ie=K.x,Ue=K.y,He=K.z,Ke=K.w,Ze=2*(Ue*ye-He*de),at=2*(He*oe-Ie*ye),mt=2*(Ie*de-Ue*oe);return this.x=oe+Ke*Ze+Ue*mt-He*at,this.y=de+Ke*at+He*Ze-Ie*mt,this.z=ye+Ke*mt+Ie*at-Ue*Ze,this}project(K){return this.applyMatrix4(K.matrixWorldInverse).applyMatrix4(K.projectionMatrix)}unproject(K){return this.applyMatrix4(K.projectionMatrixInverse).applyMatrix4(K.matrixWorld)}transformDirection(K){const oe=this.x,de=this.y,ye=this.z,Ie=K.elements;return this.x=Ie[0]*oe+Ie[4]*de+Ie[8]*ye,this.y=Ie[1]*oe+Ie[5]*de+Ie[9]*ye,this.z=Ie[2]*oe+Ie[6]*de+Ie[10]*ye,this.normalize()}divide(K){return this.x/=K.x,this.y/=K.y,this.z/=K.z,this}divideScalar(K){return this.multiplyScalar(1/K)}min(K){return this.x=Math.min(this.x,K.x),this.y=Math.min(this.y,K.y),this.z=Math.min(this.z,K.z),this}max(K){return this.x=Math.max(this.x,K.x),this.y=Math.max(this.y,K.y),this.z=Math.max(this.z,K.z),this}clamp(K,oe){return this.x=Math.max(K.x,Math.min(oe.x,this.x)),this.y=Math.max(K.y,Math.min(oe.y,this.y)),this.z=Math.max(K.z,Math.min(oe.z,this.z)),this}clampScalar(K,oe){return this.x=Math.max(K,Math.min(oe,this.x)),this.y=Math.max(K,Math.min(oe,this.y)),this.z=Math.max(K,Math.min(oe,this.z)),this}clampLength(K,oe){const de=this.length();return this.divideScalar(de||1).multiplyScalar(Math.max(K,Math.min(oe,de)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(K){return this.x*K.x+this.y*K.y+this.z*K.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(K){return this.normalize().multiplyScalar(K)}lerp(K,oe){return this.x+=(K.x-this.x)*oe,this.y+=(K.y-this.y)*oe,this.z+=(K.z-this.z)*oe,this}lerpVectors(K,oe,de){return this.x=K.x+(oe.x-K.x)*de,this.y=K.y+(oe.y-K.y)*de,this.z=K.z+(oe.z-K.z)*de,this}cross(K){return this.crossVectors(this,K)}crossVectors(K,oe){const de=K.x,ye=K.y,Ie=K.z,Ue=oe.x,He=oe.y,Ke=oe.z;return this.x=ye*Ke-Ie*He,this.y=Ie*Ue-de*Ke,this.z=de*He-ye*Ue,this}projectOnVector(K){const oe=K.lengthSq();if(oe===0)return this.set(0,0,0);const de=K.dot(this)/oe;return this.copy(K).multiplyScalar(de)}projectOnPlane(K){return u0.copy(this).projectOnVector(K),this.sub(u0)}reflect(K){return this.sub(u0.copy(K).multiplyScalar(2*this.dot(K)))}angleTo(K){const oe=Math.sqrt(this.lengthSq()*K.lengthSq());if(oe===0)return Math.PI/2;const de=this.dot(K)/oe;return Math.acos(qo(de,-1,1))}distanceTo(K){return Math.sqrt(this.distanceToSquared(K))}distanceToSquared(K){const oe=this.x-K.x,de=this.y-K.y,ye=this.z-K.z;return oe*oe+de*de+ye*ye}manhattanDistanceTo(K){return Math.abs(this.x-K.x)+Math.abs(this.y-K.y)+Math.abs(this.z-K.z)}setFromSpherical(K){return this.setFromSphericalCoords(K.radius,K.phi,K.theta)}setFromSphericalCoords(K,oe,de){const ye=Math.sin(oe)*K;return this.x=ye*Math.sin(de),this.y=Math.cos(oe)*K,this.z=ye*Math.cos(de),this}setFromCylindrical(K){return this.setFromCylindricalCoords(K.radius,K.theta,K.y)}setFromCylindricalCoords(K,oe,de){return this.x=K*Math.sin(oe),this.y=de,this.z=K*Math.cos(oe),this}setFromMatrixPosition(K){const oe=K.elements;return this.x=oe[12],this.y=oe[13],this.z=oe[14],this}setFromMatrixScale(K){const oe=this.setFromMatrixColumn(K,0).length(),de=this.setFromMatrixColumn(K,1).length(),ye=this.setFromMatrixColumn(K,2).length();return this.x=oe,this.y=de,this.z=ye,this}setFromMatrixColumn(K,oe){return this.fromArray(K.elements,oe*4)}setFromMatrix3Column(K,oe){return this.fromArray(K.elements,oe*3)}setFromEuler(K){return this.x=K._x,this.y=K._y,this.z=K._z,this}setFromColor(K){return this.x=K.r,this.y=K.g,this.z=K.b,this}equals(K){return K.x===this.x&&K.y===this.y&&K.z===this.z}fromArray(K,oe=0){return this.x=K[oe],this.y=K[oe+1],this.z=K[oe+2],this}toArray(K=[],oe=0){return K[oe]=this.x,K[oe+1]=this.y,K[oe+2]=this.z,K}fromBufferAttribute(K,oe){return this.x=K.getX(oe),this.y=K.getY(oe),this.z=K.getZ(oe),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const K=Math.random()*Math.PI*2,oe=Math.random()*2-1,de=Math.sqrt(1-oe*oe);return this.x=de*Math.cos(K),this.y=oe,this.z=de*Math.sin(K),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const u0=new vn,$o=new to;class Rs{constructor(K=new vn(1/0,1/0,1/0),oe=new vn(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=K,this.max=oe}set(K,oe){return this.min.copy(K),this.max.copy(oe),this}setFromArray(K){this.makeEmpty();for(let oe=0,de=K.length;oe<de;oe+=3)this.expandByPoint(Da.fromArray(K,oe));return this}setFromBufferAttribute(K){this.makeEmpty();for(let oe=0,de=K.count;oe<de;oe++)this.expandByPoint(Da.fromBufferAttribute(K,oe));return this}setFromPoints(K){this.makeEmpty();for(let oe=0,de=K.length;oe<de;oe++)this.expandByPoint(K[oe]);return this}setFromCenterAndSize(K,oe){const de=Da.copy(oe).multiplyScalar(.5);return this.min.copy(K).sub(de),this.max.copy(K).add(de),this}setFromObject(K,oe=!1){return this.makeEmpty(),this.expandByObject(K,oe)}clone(){return new this.constructor().copy(this)}copy(K){return this.min.copy(K.min),this.max.copy(K.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(K){return this.isEmpty()?K.set(0,0,0):K.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(K){return this.isEmpty()?K.set(0,0,0):K.subVectors(this.max,this.min)}expandByPoint(K){return this.min.min(K),this.max.max(K),this}expandByVector(K){return this.min.sub(K),this.max.add(K),this}expandByScalar(K){return this.min.addScalar(-K),this.max.addScalar(K),this}expandByObject(K,oe=!1){K.updateWorldMatrix(!1,!1);const de=K.geometry;if(de!==void 0){const Ie=de.getAttribute("position");if(oe===!0&&Ie!==void 0&&K.isInstancedMesh!==!0)for(let Ue=0,He=Ie.count;Ue<He;Ue++)K.isMesh===!0?K.getVertexPosition(Ue,Da):Da.fromBufferAttribute(Ie,Ue),Da.applyMatrix4(K.matrixWorld),this.expandByPoint(Da);else K.boundingBox!==void 0?(K.boundingBox===null&&K.computeBoundingBox(),F0.copy(K.boundingBox)):(de.boundingBox===null&&de.computeBoundingBox(),F0.copy(de.boundingBox)),F0.applyMatrix4(K.matrixWorld),this.union(F0)}const ye=K.children;for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++)this.expandByObject(ye[Ie],oe);return this}containsPoint(K){return!(K.x<this.min.x||K.x>this.max.x||K.y<this.min.y||K.y>this.max.y||K.z<this.min.z||K.z>this.max.z)}containsBox(K){return this.min.x<=K.min.x&&K.max.x<=this.max.x&&this.min.y<=K.min.y&&K.max.y<=this.max.y&&this.min.z<=K.min.z&&K.max.z<=this.max.z}getParameter(K,oe){return oe.set((K.x-this.min.x)/(this.max.x-this.min.x),(K.y-this.min.y)/(this.max.y-this.min.y),(K.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(K){return!(K.max.x<this.min.x||K.min.x>this.max.x||K.max.y<this.min.y||K.min.y>this.max.y||K.max.z<this.min.z||K.min.z>this.max.z)}intersectsSphere(K){return this.clampPoint(K.center,Da),Da.distanceToSquared(K.center)<=K.radius*K.radius}intersectsPlane(K){let oe,de;return K.normal.x>0?(oe=K.normal.x*this.min.x,de=K.normal.x*this.max.x):(oe=K.normal.x*this.max.x,de=K.normal.x*this.min.x),K.normal.y>0?(oe+=K.normal.y*this.min.y,de+=K.normal.y*this.max.y):(oe+=K.normal.y*this.max.y,de+=K.normal.y*this.min.y),K.normal.z>0?(oe+=K.normal.z*this.min.z,de+=K.normal.z*this.max.z):(oe+=K.normal.z*this.max.z,de+=K.normal.z*this.min.z),oe<=-K.constant&&de>=-K.constant}intersectsTriangle(K){if(this.isEmpty())return!1;this.getCenter(vo),Xs.subVectors(this.max,vo),w0.subVectors(K.a,vo),xa.subVectors(K.b,vo),Ms.subVectors(K.c,vo),Is.subVectors(xa,w0),aa.subVectors(Ms,xa),Pa.subVectors(w0,Ms);let oe=[0,-Is.z,Is.y,0,-aa.z,aa.y,0,-Pa.z,Pa.y,Is.z,0,-Is.x,aa.z,0,-aa.x,Pa.z,0,-Pa.x,-Is.y,Is.x,0,-aa.y,aa.x,0,-Pa.y,Pa.x,0];return!Xa(oe,w0,xa,Ms,Xs)||(oe=[1,0,0,0,1,0,0,0,1],!Xa(oe,w0,xa,Ms,Xs))?!1:(Lr.crossVectors(Is,aa),oe=[Lr.x,Lr.y,Lr.z],Xa(oe,w0,xa,Ms,Xs))}clampPoint(K,oe){return oe.copy(K).clamp(this.min,this.max)}distanceToPoint(K){return this.clampPoint(K,Da).distanceTo(K)}getBoundingSphere(K){return this.isEmpty()?K.makeEmpty():(this.getCenter(K.center),K.radius=this.getSize(Da).length()*.5),K}intersect(K){return this.min.max(K.min),this.max.min(K.max),this.isEmpty()&&this.makeEmpty(),this}union(K){return this.min.min(K.min),this.max.max(K.max),this}applyMatrix4(K){return this.isEmpty()?this:(Zs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(K),Zs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(K),Zs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(K),Zs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(K),Zs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(K),Zs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(K),Zs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(K),Zs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(K),this.setFromPoints(Zs),this)}translate(K){return this.min.add(K),this.max.add(K),this}equals(K){return K.min.equals(this.min)&&K.max.equals(this.max)}}const Zs=[new vn,new vn,new vn,new vn,new vn,new vn,new vn,new vn],Da=new vn,F0=new Rs,w0=new vn,xa=new vn,Ms=new vn,Is=new vn,aa=new vn,Pa=new vn,vo=new vn,Xs=new vn,Lr=new vn,Hs=new vn;function Xa(Be,K,oe,de,ye){for(let Ie=0,Ue=Be.length-3;Ie<=Ue;Ie+=3){Hs.fromArray(Be,Ie);const He=ye.x*Math.abs(Hs.x)+ye.y*Math.abs(Hs.y)+ye.z*Math.abs(Hs.z),Ke=K.dot(Hs),Ze=oe.dot(Hs),at=de.dot(Hs);if(Math.max(-Math.max(Ke,Ze,at),Math.min(Ke,Ze,at))>He)return!1}return!0}const ul=new Rs,hl=new vn,pc=new vn;class la{constructor(K=new vn,oe=-1){this.isSphere=!0,this.center=K,this.radius=oe}set(K,oe){return this.center.copy(K),this.radius=oe,this}setFromPoints(K,oe){const de=this.center;oe!==void 0?de.copy(oe):ul.setFromPoints(K).getCenter(de);let ye=0;for(let Ie=0,Ue=K.length;Ie<Ue;Ie++)ye=Math.max(ye,de.distanceToSquared(K[Ie]));return this.radius=Math.sqrt(ye),this}copy(K){return this.center.copy(K.center),this.radius=K.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(K){return K.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(K){return K.distanceTo(this.center)-this.radius}intersectsSphere(K){const oe=this.radius+K.radius;return K.center.distanceToSquared(this.center)<=oe*oe}intersectsBox(K){return K.intersectsSphere(this)}intersectsPlane(K){return Math.abs(K.distanceToPoint(this.center))<=this.radius}clampPoint(K,oe){const de=this.center.distanceToSquared(K);return oe.copy(K),de>this.radius*this.radius&&(oe.sub(this.center).normalize(),oe.multiplyScalar(this.radius).add(this.center)),oe}getBoundingBox(K){return this.isEmpty()?(K.makeEmpty(),K):(K.set(this.center,this.center),K.expandByScalar(this.radius),K)}applyMatrix4(K){return this.center.applyMatrix4(K),this.radius=this.radius*K.getMaxScaleOnAxis(),this}translate(K){return this.center.add(K),this}expandByPoint(K){if(this.isEmpty())return this.center.copy(K),this.radius=0,this;hl.subVectors(K,this.center);const oe=hl.lengthSq();if(oe>this.radius*this.radius){const de=Math.sqrt(oe),ye=(de-this.radius)*.5;this.center.addScaledVector(hl,ye/de),this.radius+=ye}return this}union(K){return K.isEmpty()?this:this.isEmpty()?(this.copy(K),this):(this.center.equals(K.center)===!0?this.radius=Math.max(this.radius,K.radius):(pc.subVectors(K.center,this.center).setLength(K.radius),this.expandByPoint(hl.copy(K.center).add(pc)),this.expandByPoint(hl.copy(K.center).sub(pc))),this)}equals(K){return K.center.equals(this.center)&&K.radius===this.radius}clone(){return new this.constructor().copy(this)}}const el=new vn,kl=new vn,qc=new vn,Gl=new vn,Jc=new vn,z0=new vn,Zc=new vn;class Jo{constructor(K=new vn,oe=new vn(0,0,-1)){this.origin=K,this.direction=oe}set(K,oe){return this.origin.copy(K),this.direction.copy(oe),this}copy(K){return this.origin.copy(K.origin),this.direction.copy(K.direction),this}at(K,oe){return oe.copy(this.origin).addScaledVector(this.direction,K)}lookAt(K){return this.direction.copy(K).sub(this.origin).normalize(),this}recast(K){return this.origin.copy(this.at(K,el)),this}closestPointToPoint(K,oe){oe.subVectors(K,this.origin);const de=oe.dot(this.direction);return de<0?oe.copy(this.origin):oe.copy(this.origin).addScaledVector(this.direction,de)}distanceToPoint(K){return Math.sqrt(this.distanceSqToPoint(K))}distanceSqToPoint(K){const oe=el.subVectors(K,this.origin).dot(this.direction);return oe<0?this.origin.distanceToSquared(K):(el.copy(this.origin).addScaledVector(this.direction,oe),el.distanceToSquared(K))}distanceSqToSegment(K,oe,de,ye){kl.copy(K).add(oe).multiplyScalar(.5),qc.copy(oe).sub(K).normalize(),Gl.copy(this.origin).sub(kl);const Ie=K.distanceTo(oe)*.5,Ue=-this.direction.dot(qc),He=Gl.dot(this.direction),Ke=-Gl.dot(qc),Ze=Gl.lengthSq(),at=Math.abs(1-Ue*Ue);let mt,vt,St,Lt;if(at>0)if(mt=Ue*Ke-He,vt=Ue*He-Ke,Lt=Ie*at,mt>=0)if(vt>=-Lt)if(vt<=Lt){const Ht=1/at;mt*=Ht,vt*=Ht,St=mt*(mt+Ue*vt+2*He)+vt*(Ue*mt+vt+2*Ke)+Ze}else vt=Ie,mt=Math.max(0,-(Ue*vt+He)),St=-mt*mt+vt*(vt+2*Ke)+Ze;else vt=-Ie,mt=Math.max(0,-(Ue*vt+He)),St=-mt*mt+vt*(vt+2*Ke)+Ze;else vt<=-Lt?(mt=Math.max(0,-(-Ue*Ie+He)),vt=mt>0?-Ie:Math.min(Math.max(-Ie,-Ke),Ie),St=-mt*mt+vt*(vt+2*Ke)+Ze):vt<=Lt?(mt=0,vt=Math.min(Math.max(-Ie,-Ke),Ie),St=vt*(vt+2*Ke)+Ze):(mt=Math.max(0,-(Ue*Ie+He)),vt=mt>0?Ie:Math.min(Math.max(-Ie,-Ke),Ie),St=-mt*mt+vt*(vt+2*Ke)+Ze);else vt=Ue>0?-Ie:Ie,mt=Math.max(0,-(Ue*vt+He)),St=-mt*mt+vt*(vt+2*Ke)+Ze;return de&&de.copy(this.origin).addScaledVector(this.direction,mt),ye&&ye.copy(kl).addScaledVector(qc,vt),St}intersectSphere(K,oe){el.subVectors(K.center,this.origin);const de=el.dot(this.direction),ye=el.dot(el)-de*de,Ie=K.radius*K.radius;if(ye>Ie)return null;const Ue=Math.sqrt(Ie-ye),He=de-Ue,Ke=de+Ue;return Ke<0?null:He<0?this.at(Ke,oe):this.at(He,oe)}intersectsSphere(K){return this.distanceSqToPoint(K.center)<=K.radius*K.radius}distanceToPlane(K){const oe=K.normal.dot(this.direction);if(oe===0)return K.distanceToPoint(this.origin)===0?0:null;const de=-(this.origin.dot(K.normal)+K.constant)/oe;return de>=0?de:null}intersectPlane(K,oe){const de=this.distanceToPlane(K);return de===null?null:this.at(de,oe)}intersectsPlane(K){const oe=K.distanceToPoint(this.origin);return oe===0||K.normal.dot(this.direction)*oe<0}intersectBox(K,oe){let de,ye,Ie,Ue,He,Ke;const Ze=1/this.direction.x,at=1/this.direction.y,mt=1/this.direction.z,vt=this.origin;return Ze>=0?(de=(K.min.x-vt.x)*Ze,ye=(K.max.x-vt.x)*Ze):(de=(K.max.x-vt.x)*Ze,ye=(K.min.x-vt.x)*Ze),at>=0?(Ie=(K.min.y-vt.y)*at,Ue=(K.max.y-vt.y)*at):(Ie=(K.max.y-vt.y)*at,Ue=(K.min.y-vt.y)*at),de>Ue||Ie>ye||((Ie>de||isNaN(de))&&(de=Ie),(Ue<ye||isNaN(ye))&&(ye=Ue),mt>=0?(He=(K.min.z-vt.z)*mt,Ke=(K.max.z-vt.z)*mt):(He=(K.max.z-vt.z)*mt,Ke=(K.min.z-vt.z)*mt),de>Ke||He>ye)||((He>de||de!==de)&&(de=He),(Ke<ye||ye!==ye)&&(ye=Ke),ye<0)?null:this.at(de>=0?de:ye,oe)}intersectsBox(K){return this.intersectBox(K,el)!==null}intersectTriangle(K,oe,de,ye,Ie){Jc.subVectors(oe,K),z0.subVectors(de,K),Zc.crossVectors(Jc,z0);let Ue=this.direction.dot(Zc),He;if(Ue>0){if(ye)return null;He=1}else if(Ue<0)He=-1,Ue=-Ue;else return null;Gl.subVectors(this.origin,K);const Ke=He*this.direction.dot(z0.crossVectors(Gl,z0));if(Ke<0)return null;const Ze=He*this.direction.dot(Jc.cross(Gl));if(Ze<0||Ke+Ze>Ue)return null;const at=-He*Gl.dot(Zc);return at<0?null:this.at(at/Ue,Ie)}applyMatrix4(K){return this.origin.applyMatrix4(K),this.direction.transformDirection(K),this}equals(K){return K.origin.equals(this.origin)&&K.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class kr{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at,mt,vt,St,Lt,Ht,Dt){kr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K!==void 0&&this.set(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at,mt,vt,St,Lt,Ht,Dt)}set(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at,mt,vt,St,Lt,Ht,Dt){const bt=this.elements;return bt[0]=K,bt[4]=oe,bt[8]=de,bt[12]=ye,bt[1]=Ie,bt[5]=Ue,bt[9]=He,bt[13]=Ke,bt[2]=Ze,bt[6]=at,bt[10]=mt,bt[14]=vt,bt[3]=St,bt[7]=Lt,bt[11]=Ht,bt[15]=Dt,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new kr().fromArray(this.elements)}copy(K){const oe=this.elements,de=K.elements;return oe[0]=de[0],oe[1]=de[1],oe[2]=de[2],oe[3]=de[3],oe[4]=de[4],oe[5]=de[5],oe[6]=de[6],oe[7]=de[7],oe[8]=de[8],oe[9]=de[9],oe[10]=de[10],oe[11]=de[11],oe[12]=de[12],oe[13]=de[13],oe[14]=de[14],oe[15]=de[15],this}copyPosition(K){const oe=this.elements,de=K.elements;return oe[12]=de[12],oe[13]=de[13],oe[14]=de[14],this}setFromMatrix3(K){const oe=K.elements;return this.set(oe[0],oe[3],oe[6],0,oe[1],oe[4],oe[7],0,oe[2],oe[5],oe[8],0,0,0,0,1),this}extractBasis(K,oe,de){return K.setFromMatrixColumn(this,0),oe.setFromMatrixColumn(this,1),de.setFromMatrixColumn(this,2),this}makeBasis(K,oe,de){return this.set(K.x,oe.x,de.x,0,K.y,oe.y,de.y,0,K.z,oe.z,de.z,0,0,0,0,1),this}extractRotation(K){const oe=this.elements,de=K.elements,ye=1/ia.setFromMatrixColumn(K,0).length(),Ie=1/ia.setFromMatrixColumn(K,1).length(),Ue=1/ia.setFromMatrixColumn(K,2).length();return oe[0]=de[0]*ye,oe[1]=de[1]*ye,oe[2]=de[2]*ye,oe[3]=0,oe[4]=de[4]*Ie,oe[5]=de[5]*Ie,oe[6]=de[6]*Ie,oe[7]=0,oe[8]=de[8]*Ue,oe[9]=de[9]*Ue,oe[10]=de[10]*Ue,oe[11]=0,oe[12]=0,oe[13]=0,oe[14]=0,oe[15]=1,this}makeRotationFromEuler(K){const oe=this.elements,de=K.x,ye=K.y,Ie=K.z,Ue=Math.cos(de),He=Math.sin(de),Ke=Math.cos(ye),Ze=Math.sin(ye),at=Math.cos(Ie),mt=Math.sin(Ie);if(K.order==="XYZ"){const vt=Ue*at,St=Ue*mt,Lt=He*at,Ht=He*mt;oe[0]=Ke*at,oe[4]=-Ke*mt,oe[8]=Ze,oe[1]=St+Lt*Ze,oe[5]=vt-Ht*Ze,oe[9]=-He*Ke,oe[2]=Ht-vt*Ze,oe[6]=Lt+St*Ze,oe[10]=Ue*Ke}else if(K.order==="YXZ"){const vt=Ke*at,St=Ke*mt,Lt=Ze*at,Ht=Ze*mt;oe[0]=vt+Ht*He,oe[4]=Lt*He-St,oe[8]=Ue*Ze,oe[1]=Ue*mt,oe[5]=Ue*at,oe[9]=-He,oe[2]=St*He-Lt,oe[6]=Ht+vt*He,oe[10]=Ue*Ke}else if(K.order==="ZXY"){const vt=Ke*at,St=Ke*mt,Lt=Ze*at,Ht=Ze*mt;oe[0]=vt-Ht*He,oe[4]=-Ue*mt,oe[8]=Lt+St*He,oe[1]=St+Lt*He,oe[5]=Ue*at,oe[9]=Ht-vt*He,oe[2]=-Ue*Ze,oe[6]=He,oe[10]=Ue*Ke}else if(K.order==="ZYX"){const vt=Ue*at,St=Ue*mt,Lt=He*at,Ht=He*mt;oe[0]=Ke*at,oe[4]=Lt*Ze-St,oe[8]=vt*Ze+Ht,oe[1]=Ke*mt,oe[5]=Ht*Ze+vt,oe[9]=St*Ze-Lt,oe[2]=-Ze,oe[6]=He*Ke,oe[10]=Ue*Ke}else if(K.order==="YZX"){const vt=Ue*Ke,St=Ue*Ze,Lt=He*Ke,Ht=He*Ze;oe[0]=Ke*at,oe[4]=Ht-vt*mt,oe[8]=Lt*mt+St,oe[1]=mt,oe[5]=Ue*at,oe[9]=-He*at,oe[2]=-Ze*at,oe[6]=St*mt+Lt,oe[10]=vt-Ht*mt}else if(K.order==="XZY"){const vt=Ue*Ke,St=Ue*Ze,Lt=He*Ke,Ht=He*Ze;oe[0]=Ke*at,oe[4]=-mt,oe[8]=Ze*at,oe[1]=vt*mt+Ht,oe[5]=Ue*at,oe[9]=St*mt-Lt,oe[2]=Lt*mt-St,oe[6]=He*at,oe[10]=Ht*mt+vt}return oe[3]=0,oe[7]=0,oe[11]=0,oe[12]=0,oe[13]=0,oe[14]=0,oe[15]=1,this}makeRotationFromQuaternion(K){return this.compose(kd,K,Zf)}lookAt(K,oe,de){const ye=this.elements;return n0.subVectors(K,oe),n0.lengthSq()===0&&(n0.z=1),n0.normalize(),Bc.crossVectors(de,n0),Bc.lengthSq()===0&&(Math.abs(de.z)===1?n0.x+=1e-4:n0.z+=1e-4,n0.normalize(),Bc.crossVectors(de,n0)),Bc.normalize(),dl.crossVectors(n0,Bc),ye[0]=Bc.x,ye[4]=dl.x,ye[8]=n0.x,ye[1]=Bc.y,ye[5]=dl.y,ye[9]=n0.y,ye[2]=Bc.z,ye[6]=dl.z,ye[10]=n0.z,this}multiply(K){return this.multiplyMatrices(this,K)}premultiply(K){return this.multiplyMatrices(K,this)}multiplyMatrices(K,oe){const de=K.elements,ye=oe.elements,Ie=this.elements,Ue=de[0],He=de[4],Ke=de[8],Ze=de[12],at=de[1],mt=de[5],vt=de[9],St=de[13],Lt=de[2],Ht=de[6],Dt=de[10],bt=de[14],tn=de[3],Zt=de[7],qt=de[11],Un=de[15],_n=ye[0],bn=ye[4],Fn=ye[8],pn=ye[12],cn=ye[1],On=ye[5],Zn=ye[9],Xn=ye[13],ri=ye[2],wi=ye[6],Ji=ye[10],Dr=ye[14],Ri=ye[3],xr=ye[7],br=ye[11],us=ye[15];return Ie[0]=Ue*_n+He*cn+Ke*ri+Ze*Ri,Ie[4]=Ue*bn+He*On+Ke*wi+Ze*xr,Ie[8]=Ue*Fn+He*Zn+Ke*Ji+Ze*br,Ie[12]=Ue*pn+He*Xn+Ke*Dr+Ze*us,Ie[1]=at*_n+mt*cn+vt*ri+St*Ri,Ie[5]=at*bn+mt*On+vt*wi+St*xr,Ie[9]=at*Fn+mt*Zn+vt*Ji+St*br,Ie[13]=at*pn+mt*Xn+vt*Dr+St*us,Ie[2]=Lt*_n+Ht*cn+Dt*ri+bt*Ri,Ie[6]=Lt*bn+Ht*On+Dt*wi+bt*xr,Ie[10]=Lt*Fn+Ht*Zn+Dt*Ji+bt*br,Ie[14]=Lt*pn+Ht*Xn+Dt*Dr+bt*us,Ie[3]=tn*_n+Zt*cn+qt*ri+Un*Ri,Ie[7]=tn*bn+Zt*On+qt*wi+Un*xr,Ie[11]=tn*Fn+Zt*Zn+qt*Ji+Un*br,Ie[15]=tn*pn+Zt*Xn+qt*Dr+Un*us,this}multiplyScalar(K){const oe=this.elements;return oe[0]*=K,oe[4]*=K,oe[8]*=K,oe[12]*=K,oe[1]*=K,oe[5]*=K,oe[9]*=K,oe[13]*=K,oe[2]*=K,oe[6]*=K,oe[10]*=K,oe[14]*=K,oe[3]*=K,oe[7]*=K,oe[11]*=K,oe[15]*=K,this}determinant(){const K=this.elements,oe=K[0],de=K[4],ye=K[8],Ie=K[12],Ue=K[1],He=K[5],Ke=K[9],Ze=K[13],at=K[2],mt=K[6],vt=K[10],St=K[14],Lt=K[3],Ht=K[7],Dt=K[11],bt=K[15];return Lt*(+Ie*Ke*mt-ye*Ze*mt-Ie*He*vt+de*Ze*vt+ye*He*St-de*Ke*St)+Ht*(+oe*Ke*St-oe*Ze*vt+Ie*Ue*vt-ye*Ue*St+ye*Ze*at-Ie*Ke*at)+Dt*(+oe*Ze*mt-oe*He*St-Ie*Ue*mt+de*Ue*St+Ie*He*at-de*Ze*at)+bt*(-ye*He*at-oe*Ke*mt+oe*He*vt+ye*Ue*mt-de*Ue*vt+de*Ke*at)}transpose(){const K=this.elements;let oe;return oe=K[1],K[1]=K[4],K[4]=oe,oe=K[2],K[2]=K[8],K[8]=oe,oe=K[6],K[6]=K[9],K[9]=oe,oe=K[3],K[3]=K[12],K[12]=oe,oe=K[7],K[7]=K[13],K[13]=oe,oe=K[11],K[11]=K[14],K[14]=oe,this}setPosition(K,oe,de){const ye=this.elements;return K.isVector3?(ye[12]=K.x,ye[13]=K.y,ye[14]=K.z):(ye[12]=K,ye[13]=oe,ye[14]=de),this}invert(){const K=this.elements,oe=K[0],de=K[1],ye=K[2],Ie=K[3],Ue=K[4],He=K[5],Ke=K[6],Ze=K[7],at=K[8],mt=K[9],vt=K[10],St=K[11],Lt=K[12],Ht=K[13],Dt=K[14],bt=K[15],tn=mt*Dt*Ze-Ht*vt*Ze+Ht*Ke*St-He*Dt*St-mt*Ke*bt+He*vt*bt,Zt=Lt*vt*Ze-at*Dt*Ze-Lt*Ke*St+Ue*Dt*St+at*Ke*bt-Ue*vt*bt,qt=at*Ht*Ze-Lt*mt*Ze+Lt*He*St-Ue*Ht*St-at*He*bt+Ue*mt*bt,Un=Lt*mt*Ke-at*Ht*Ke-Lt*He*vt+Ue*Ht*vt+at*He*Dt-Ue*mt*Dt,_n=oe*tn+de*Zt+ye*qt+Ie*Un;if(_n===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const bn=1/_n;return K[0]=tn*bn,K[1]=(Ht*vt*Ie-mt*Dt*Ie-Ht*ye*St+de*Dt*St+mt*ye*bt-de*vt*bt)*bn,K[2]=(He*Dt*Ie-Ht*Ke*Ie+Ht*ye*Ze-de*Dt*Ze-He*ye*bt+de*Ke*bt)*bn,K[3]=(mt*Ke*Ie-He*vt*Ie-mt*ye*Ze+de*vt*Ze+He*ye*St-de*Ke*St)*bn,K[4]=Zt*bn,K[5]=(at*Dt*Ie-Lt*vt*Ie+Lt*ye*St-oe*Dt*St-at*ye*bt+oe*vt*bt)*bn,K[6]=(Lt*Ke*Ie-Ue*Dt*Ie-Lt*ye*Ze+oe*Dt*Ze+Ue*ye*bt-oe*Ke*bt)*bn,K[7]=(Ue*vt*Ie-at*Ke*Ie+at*ye*Ze-oe*vt*Ze-Ue*ye*St+oe*Ke*St)*bn,K[8]=qt*bn,K[9]=(Lt*mt*Ie-at*Ht*Ie-Lt*de*St+oe*Ht*St+at*de*bt-oe*mt*bt)*bn,K[10]=(Ue*Ht*Ie-Lt*He*Ie+Lt*de*Ze-oe*Ht*Ze-Ue*de*bt+oe*He*bt)*bn,K[11]=(at*He*Ie-Ue*mt*Ie-at*de*Ze+oe*mt*Ze+Ue*de*St-oe*He*St)*bn,K[12]=Un*bn,K[13]=(at*Ht*ye-Lt*mt*ye+Lt*de*vt-oe*Ht*vt-at*de*Dt+oe*mt*Dt)*bn,K[14]=(Lt*He*ye-Ue*Ht*ye-Lt*de*Ke+oe*Ht*Ke+Ue*de*Dt-oe*He*Dt)*bn,K[15]=(Ue*mt*ye-at*He*ye+at*de*Ke-oe*mt*Ke-Ue*de*vt+oe*He*vt)*bn,this}scale(K){const oe=this.elements,de=K.x,ye=K.y,Ie=K.z;return oe[0]*=de,oe[4]*=ye,oe[8]*=Ie,oe[1]*=de,oe[5]*=ye,oe[9]*=Ie,oe[2]*=de,oe[6]*=ye,oe[10]*=Ie,oe[3]*=de,oe[7]*=ye,oe[11]*=Ie,this}getMaxScaleOnAxis(){const K=this.elements,oe=K[0]*K[0]+K[1]*K[1]+K[2]*K[2],de=K[4]*K[4]+K[5]*K[5]+K[6]*K[6],ye=K[8]*K[8]+K[9]*K[9]+K[10]*K[10];return Math.sqrt(Math.max(oe,de,ye))}makeTranslation(K,oe,de){return K.isVector3?this.set(1,0,0,K.x,0,1,0,K.y,0,0,1,K.z,0,0,0,1):this.set(1,0,0,K,0,1,0,oe,0,0,1,de,0,0,0,1),this}makeRotationX(K){const oe=Math.cos(K),de=Math.sin(K);return this.set(1,0,0,0,0,oe,-de,0,0,de,oe,0,0,0,0,1),this}makeRotationY(K){const oe=Math.cos(K),de=Math.sin(K);return this.set(oe,0,de,0,0,1,0,0,-de,0,oe,0,0,0,0,1),this}makeRotationZ(K){const oe=Math.cos(K),de=Math.sin(K);return this.set(oe,-de,0,0,de,oe,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(K,oe){const de=Math.cos(oe),ye=Math.sin(oe),Ie=1-de,Ue=K.x,He=K.y,Ke=K.z,Ze=Ie*Ue,at=Ie*He;return this.set(Ze*Ue+de,Ze*He-ye*Ke,Ze*Ke+ye*He,0,Ze*He+ye*Ke,at*He+de,at*Ke-ye*Ue,0,Ze*Ke-ye*He,at*Ke+ye*Ue,Ie*Ke*Ke+de,0,0,0,0,1),this}makeScale(K,oe,de){return this.set(K,0,0,0,0,oe,0,0,0,0,de,0,0,0,0,1),this}makeShear(K,oe,de,ye,Ie,Ue){return this.set(1,de,Ie,0,K,1,Ue,0,oe,ye,1,0,0,0,0,1),this}compose(K,oe,de){const ye=this.elements,Ie=oe._x,Ue=oe._y,He=oe._z,Ke=oe._w,Ze=Ie+Ie,at=Ue+Ue,mt=He+He,vt=Ie*Ze,St=Ie*at,Lt=Ie*mt,Ht=Ue*at,Dt=Ue*mt,bt=He*mt,tn=Ke*Ze,Zt=Ke*at,qt=Ke*mt,Un=de.x,_n=de.y,bn=de.z;return ye[0]=(1-(Ht+bt))*Un,ye[1]=(St+qt)*Un,ye[2]=(Lt-Zt)*Un,ye[3]=0,ye[4]=(St-qt)*_n,ye[5]=(1-(vt+bt))*_n,ye[6]=(Dt+tn)*_n,ye[7]=0,ye[8]=(Lt+Zt)*bn,ye[9]=(Dt-tn)*bn,ye[10]=(1-(vt+Ht))*bn,ye[11]=0,ye[12]=K.x,ye[13]=K.y,ye[14]=K.z,ye[15]=1,this}decompose(K,oe,de){const ye=this.elements;let Ie=ia.set(ye[0],ye[1],ye[2]).length();const Ue=ia.set(ye[4],ye[5],ye[6]).length(),He=ia.set(ye[8],ye[9],ye[10]).length();this.determinant()<0&&(Ie=-Ie),K.x=ye[12],K.y=ye[13],K.z=ye[14],Eo.copy(this);const Ze=1/Ie,at=1/Ue,mt=1/He;return Eo.elements[0]*=Ze,Eo.elements[1]*=Ze,Eo.elements[2]*=Ze,Eo.elements[4]*=at,Eo.elements[5]*=at,Eo.elements[6]*=at,Eo.elements[8]*=mt,Eo.elements[9]*=mt,Eo.elements[10]*=mt,oe.setFromRotationMatrix(Eo),de.x=Ie,de.y=Ue,de.z=He,this}makePerspective(K,oe,de,ye,Ie,Ue,He=j0){const Ke=this.elements,Ze=2*Ie/(oe-K),at=2*Ie/(de-ye),mt=(oe+K)/(oe-K),vt=(de+ye)/(de-ye);let St,Lt;if(He===j0)St=-(Ue+Ie)/(Ue-Ie),Lt=-2*Ue*Ie/(Ue-Ie);else if(He===oc)St=-Ue/(Ue-Ie),Lt=-Ue*Ie/(Ue-Ie);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+He);return Ke[0]=Ze,Ke[4]=0,Ke[8]=mt,Ke[12]=0,Ke[1]=0,Ke[5]=at,Ke[9]=vt,Ke[13]=0,Ke[2]=0,Ke[6]=0,Ke[10]=St,Ke[14]=Lt,Ke[3]=0,Ke[7]=0,Ke[11]=-1,Ke[15]=0,this}makeOrthographic(K,oe,de,ye,Ie,Ue,He=j0){const Ke=this.elements,Ze=1/(oe-K),at=1/(de-ye),mt=1/(Ue-Ie),vt=(oe+K)*Ze,St=(de+ye)*at;let Lt,Ht;if(He===j0)Lt=(Ue+Ie)*mt,Ht=-2*mt;else if(He===oc)Lt=Ie*mt,Ht=-1*mt;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+He);return Ke[0]=2*Ze,Ke[4]=0,Ke[8]=0,Ke[12]=-vt,Ke[1]=0,Ke[5]=2*at,Ke[9]=0,Ke[13]=-St,Ke[2]=0,Ke[6]=0,Ke[10]=Ht,Ke[14]=-Lt,Ke[3]=0,Ke[7]=0,Ke[11]=0,Ke[15]=1,this}equals(K){const oe=this.elements,de=K.elements;for(let ye=0;ye<16;ye++)if(oe[ye]!==de[ye])return!1;return!0}fromArray(K,oe=0){for(let de=0;de<16;de++)this.elements[de]=K[de+oe];return this}toArray(K=[],oe=0){const de=this.elements;return K[oe]=de[0],K[oe+1]=de[1],K[oe+2]=de[2],K[oe+3]=de[3],K[oe+4]=de[4],K[oe+5]=de[5],K[oe+6]=de[6],K[oe+7]=de[7],K[oe+8]=de[8],K[oe+9]=de[9],K[oe+10]=de[10],K[oe+11]=de[11],K[oe+12]=de[12],K[oe+13]=de[13],K[oe+14]=de[14],K[oe+15]=de[15],K}}const ia=new vn,Eo=new kr,kd=new vn(0,0,0),Zf=new vn(1,1,1),Bc=new vn,dl=new vn,n0=new vn,jc=new kr,vu=new to;class S0{constructor(K=0,oe=0,de=0,ye=S0.DEFAULT_ORDER){this.isEuler=!0,this._x=K,this._y=oe,this._z=de,this._order=ye}get x(){return this._x}set x(K){this._x=K,this._onChangeCallback()}get y(){return this._y}set y(K){this._y=K,this._onChangeCallback()}get z(){return this._z}set z(K){this._z=K,this._onChangeCallback()}get order(){return this._order}set order(K){this._order=K,this._onChangeCallback()}set(K,oe,de,ye=this._order){return this._x=K,this._y=oe,this._z=de,this._order=ye,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(K){return this._x=K._x,this._y=K._y,this._z=K._z,this._order=K._order,this._onChangeCallback(),this}setFromRotationMatrix(K,oe=this._order,de=!0){const ye=K.elements,Ie=ye[0],Ue=ye[4],He=ye[8],Ke=ye[1],Ze=ye[5],at=ye[9],mt=ye[2],vt=ye[6],St=ye[10];switch(oe){case"XYZ":this._y=Math.asin(qo(He,-1,1)),Math.abs(He)<.9999999?(this._x=Math.atan2(-at,St),this._z=Math.atan2(-Ue,Ie)):(this._x=Math.atan2(vt,Ze),this._z=0);break;case"YXZ":this._x=Math.asin(-qo(at,-1,1)),Math.abs(at)<.9999999?(this._y=Math.atan2(He,St),this._z=Math.atan2(Ke,Ze)):(this._y=Math.atan2(-mt,Ie),this._z=0);break;case"ZXY":this._x=Math.asin(qo(vt,-1,1)),Math.abs(vt)<.9999999?(this._y=Math.atan2(-mt,St),this._z=Math.atan2(-Ue,Ze)):(this._y=0,this._z=Math.atan2(Ke,Ie));break;case"ZYX":this._y=Math.asin(-qo(mt,-1,1)),Math.abs(mt)<.9999999?(this._x=Math.atan2(vt,St),this._z=Math.atan2(Ke,Ie)):(this._x=0,this._z=Math.atan2(-Ue,Ze));break;case"YZX":this._z=Math.asin(qo(Ke,-1,1)),Math.abs(Ke)<.9999999?(this._x=Math.atan2(-at,Ze),this._y=Math.atan2(-mt,Ie)):(this._x=0,this._y=Math.atan2(He,St));break;case"XZY":this._z=Math.asin(-qo(Ue,-1,1)),Math.abs(Ue)<.9999999?(this._x=Math.atan2(vt,Ze),this._y=Math.atan2(He,Ie)):(this._x=Math.atan2(-at,St),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+oe)}return this._order=oe,de===!0&&this._onChangeCallback(),this}setFromQuaternion(K,oe,de){return jc.makeRotationFromQuaternion(K),this.setFromRotationMatrix(jc,oe,de)}setFromVector3(K,oe=this._order){return this.set(K.x,K.y,K.z,oe)}reorder(K){return vu.setFromEuler(this),this.setFromQuaternion(vu,K)}equals(K){return K._x===this._x&&K._y===this._y&&K._z===this._z&&K._order===this._order}fromArray(K){return this._x=K[0],this._y=K[1],this._z=K[2],K[3]!==void 0&&(this._order=K[3]),this._onChangeCallback(),this}toArray(K=[],oe=0){return K[oe]=this._x,K[oe+1]=this._y,K[oe+2]=this._z,K[oe+3]=this._order,K}_onChange(K){return this._onChangeCallback=K,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}S0.DEFAULT_ORDER="XYZ";class Ql{constructor(){this.mask=1}set(K){this.mask=(1<<K|0)>>>0}enable(K){this.mask|=1<<K|0}enableAll(){this.mask=-1}toggle(K){this.mask^=1<<K|0}disable(K){this.mask&=~(1<<K|0)}disableAll(){this.mask=0}test(K){return(this.mask&K.mask)!==0}isEnabled(K){return(this.mask&(1<<K|0))!==0}}let W0=0;const Xo=new vn,Co=new to,i0=new kr,va=new vn,Ka=new vn,Ac=new vn,mc=new to,M0=new vn(1,0,0),eu=new vn(0,1,0),Fh=new vn(0,0,1),Gd={type:"added"},qu={type:"removed"},Go={type:"childadded",child:null},pl={type:"childremoved",child:null};class uo extends La{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:W0++}),this.uuid=c0(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=uo.DEFAULT_UP.clone();const K=new vn,oe=new S0,de=new to,ye=new vn(1,1,1);function Ie(){de.setFromEuler(oe,!1)}function Ue(){oe.setFromQuaternion(de,void 0,!1)}oe._onChange(Ie),de._onChange(Ue),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:K},rotation:{configurable:!0,enumerable:!0,value:oe},quaternion:{configurable:!0,enumerable:!0,value:de},scale:{configurable:!0,enumerable:!0,value:ye},modelViewMatrix:{value:new kr},normalMatrix:{value:new gs}}),this.matrix=new kr,this.matrixWorld=new kr,this.matrixAutoUpdate=uo.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=uo.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ql,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(K){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(K),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(K){return this.quaternion.premultiply(K),this}setRotationFromAxisAngle(K,oe){this.quaternion.setFromAxisAngle(K,oe)}setRotationFromEuler(K){this.quaternion.setFromEuler(K,!0)}setRotationFromMatrix(K){this.quaternion.setFromRotationMatrix(K)}setRotationFromQuaternion(K){this.quaternion.copy(K)}rotateOnAxis(K,oe){return Co.setFromAxisAngle(K,oe),this.quaternion.multiply(Co),this}rotateOnWorldAxis(K,oe){return Co.setFromAxisAngle(K,oe),this.quaternion.premultiply(Co),this}rotateX(K){return this.rotateOnAxis(M0,K)}rotateY(K){return this.rotateOnAxis(eu,K)}rotateZ(K){return this.rotateOnAxis(Fh,K)}translateOnAxis(K,oe){return Xo.copy(K).applyQuaternion(this.quaternion),this.position.add(Xo.multiplyScalar(oe)),this}translateX(K){return this.translateOnAxis(M0,K)}translateY(K){return this.translateOnAxis(eu,K)}translateZ(K){return this.translateOnAxis(Fh,K)}localToWorld(K){return this.updateWorldMatrix(!0,!1),K.applyMatrix4(this.matrixWorld)}worldToLocal(K){return this.updateWorldMatrix(!0,!1),K.applyMatrix4(i0.copy(this.matrixWorld).invert())}lookAt(K,oe,de){K.isVector3?va.copy(K):va.set(K,oe,de);const ye=this.parent;this.updateWorldMatrix(!0,!1),Ka.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?i0.lookAt(Ka,va,this.up):i0.lookAt(va,Ka,this.up),this.quaternion.setFromRotationMatrix(i0),ye&&(i0.extractRotation(ye.matrixWorld),Co.setFromRotationMatrix(i0),this.quaternion.premultiply(Co.invert()))}add(K){if(arguments.length>1){for(let oe=0;oe<arguments.length;oe++)this.add(arguments[oe]);return this}return K===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",K),this):(K&&K.isObject3D?(K.removeFromParent(),K.parent=this,this.children.push(K),K.dispatchEvent(Gd),Go.child=K,this.dispatchEvent(Go),Go.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",K),this)}remove(K){if(arguments.length>1){for(let de=0;de<arguments.length;de++)this.remove(arguments[de]);return this}const oe=this.children.indexOf(K);return oe!==-1&&(K.parent=null,this.children.splice(oe,1),K.dispatchEvent(qu),pl.child=K,this.dispatchEvent(pl),pl.child=null),this}removeFromParent(){const K=this.parent;return K!==null&&K.remove(this),this}clear(){return this.remove(...this.children)}attach(K){return this.updateWorldMatrix(!0,!1),i0.copy(this.matrixWorld).invert(),K.parent!==null&&(K.parent.updateWorldMatrix(!0,!1),i0.multiply(K.parent.matrixWorld)),K.applyMatrix4(i0),K.removeFromParent(),K.parent=this,this.children.push(K),K.updateWorldMatrix(!1,!0),K.dispatchEvent(Gd),Go.child=K,this.dispatchEvent(Go),Go.child=null,this}getObjectById(K){return this.getObjectByProperty("id",K)}getObjectByName(K){return this.getObjectByProperty("name",K)}getObjectByProperty(K,oe){if(this[K]===oe)return this;for(let de=0,ye=this.children.length;de<ye;de++){const Ue=this.children[de].getObjectByProperty(K,oe);if(Ue!==void 0)return Ue}}getObjectsByProperty(K,oe,de=[]){this[K]===oe&&de.push(this);const ye=this.children;for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++)ye[Ie].getObjectsByProperty(K,oe,de);return de}getWorldPosition(K){return this.updateWorldMatrix(!0,!1),K.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(K){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ka,K,Ac),K}getWorldScale(K){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ka,mc,K),K}getWorldDirection(K){this.updateWorldMatrix(!0,!1);const oe=this.matrixWorld.elements;return K.set(oe[8],oe[9],oe[10]).normalize()}raycast(){}traverse(K){K(this);const oe=this.children;for(let de=0,ye=oe.length;de<ye;de++)oe[de].traverse(K)}traverseVisible(K){if(this.visible===!1)return;K(this);const oe=this.children;for(let de=0,ye=oe.length;de<ye;de++)oe[de].traverseVisible(K)}traverseAncestors(K){const oe=this.parent;oe!==null&&(K(oe),oe.traverseAncestors(K))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(K){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||K)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,K=!0);const oe=this.children;for(let de=0,ye=oe.length;de<ye;de++){const Ie=oe[de];(Ie.matrixWorldAutoUpdate===!0||K===!0)&&Ie.updateMatrixWorld(K)}}updateWorldMatrix(K,oe){const de=this.parent;if(K===!0&&de!==null&&de.matrixWorldAutoUpdate===!0&&de.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),oe===!0){const ye=this.children;for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++){const He=ye[Ie];He.matrixWorldAutoUpdate===!0&&He.updateWorldMatrix(!1,!0)}}}toJSON(K){const oe=K===void 0||typeof K=="string",de={};oe&&(K={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},de.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const ye={};ye.uuid=this.uuid,ye.type=this.type,this.name!==""&&(ye.name=this.name),this.castShadow===!0&&(ye.castShadow=!0),this.receiveShadow===!0&&(ye.receiveShadow=!0),this.visible===!1&&(ye.visible=!1),this.frustumCulled===!1&&(ye.frustumCulled=!1),this.renderOrder!==0&&(ye.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(ye.userData=this.userData),ye.layers=this.layers.mask,ye.matrix=this.matrix.toArray(),ye.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(ye.matrixAutoUpdate=!1),this.isInstancedMesh&&(ye.type="InstancedMesh",ye.count=this.count,ye.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(ye.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(ye.type="BatchedMesh",ye.perObjectFrustumCulled=this.perObjectFrustumCulled,ye.sortObjects=this.sortObjects,ye.drawRanges=this._drawRanges,ye.reservedRanges=this._reservedRanges,ye.visibility=this._visibility,ye.active=this._active,ye.bounds=this._bounds.map(He=>({boxInitialized:He.boxInitialized,boxMin:He.box.min.toArray(),boxMax:He.box.max.toArray(),sphereInitialized:He.sphereInitialized,sphereRadius:He.sphere.radius,sphereCenter:He.sphere.center.toArray()})),ye.maxGeometryCount=this._maxGeometryCount,ye.maxVertexCount=this._maxVertexCount,ye.maxIndexCount=this._maxIndexCount,ye.geometryInitialized=this._geometryInitialized,ye.geometryCount=this._geometryCount,ye.matricesTexture=this._matricesTexture.toJSON(K),this.boundingSphere!==null&&(ye.boundingSphere={center:ye.boundingSphere.center.toArray(),radius:ye.boundingSphere.radius}),this.boundingBox!==null&&(ye.boundingBox={min:ye.boundingBox.min.toArray(),max:ye.boundingBox.max.toArray()}));function Ie(He,Ke){return He[Ke.uuid]===void 0&&(He[Ke.uuid]=Ke.toJSON(K)),Ke.uuid}if(this.isScene)this.background&&(this.background.isColor?ye.background=this.background.toJSON():this.background.isTexture&&(ye.background=this.background.toJSON(K).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(ye.environment=this.environment.toJSON(K).uuid);else if(this.isMesh||this.isLine||this.isPoints){ye.geometry=Ie(K.geometries,this.geometry);const He=this.geometry.parameters;if(He!==void 0&&He.shapes!==void 0){const Ke=He.shapes;if(Array.isArray(Ke))for(let Ze=0,at=Ke.length;Ze<at;Ze++){const mt=Ke[Ze];Ie(K.shapes,mt)}else Ie(K.shapes,Ke)}}if(this.isSkinnedMesh&&(ye.bindMode=this.bindMode,ye.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(Ie(K.skeletons,this.skeleton),ye.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const He=[];for(let Ke=0,Ze=this.material.length;Ke<Ze;Ke++)He.push(Ie(K.materials,this.material[Ke]));ye.material=He}else ye.material=Ie(K.materials,this.material);if(this.children.length>0){ye.children=[];for(let He=0;He<this.children.length;He++)ye.children.push(this.children[He].toJSON(K).object)}if(this.animations.length>0){ye.animations=[];for(let He=0;He<this.animations.length;He++){const Ke=this.animations[He];ye.animations.push(Ie(K.animations,Ke))}}if(oe){const He=Ue(K.geometries),Ke=Ue(K.materials),Ze=Ue(K.textures),at=Ue(K.images),mt=Ue(K.shapes),vt=Ue(K.skeletons),St=Ue(K.animations),Lt=Ue(K.nodes);He.length>0&&(de.geometries=He),Ke.length>0&&(de.materials=Ke),Ze.length>0&&(de.textures=Ze),at.length>0&&(de.images=at),mt.length>0&&(de.shapes=mt),vt.length>0&&(de.skeletons=vt),St.length>0&&(de.animations=St),Lt.length>0&&(de.nodes=Lt)}return de.object=ye,de;function Ue(He){const Ke=[];for(const Ze in He){const at=He[Ze];delete at.metadata,Ke.push(at)}return Ke}}clone(K){return new this.constructor().copy(this,K)}copy(K,oe=!0){if(this.name=K.name,this.up.copy(K.up),this.position.copy(K.position),this.rotation.order=K.rotation.order,this.quaternion.copy(K.quaternion),this.scale.copy(K.scale),this.matrix.copy(K.matrix),this.matrixWorld.copy(K.matrixWorld),this.matrixAutoUpdate=K.matrixAutoUpdate,this.matrixWorldAutoUpdate=K.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=K.matrixWorldNeedsUpdate,this.layers.mask=K.layers.mask,this.visible=K.visible,this.castShadow=K.castShadow,this.receiveShadow=K.receiveShadow,this.frustumCulled=K.frustumCulled,this.renderOrder=K.renderOrder,this.animations=K.animations.slice(),this.userData=JSON.parse(JSON.stringify(K.userData)),oe===!0)for(let de=0;de<K.children.length;de++){const ye=K.children[de];this.add(ye.clone())}return this}}uo.DEFAULT_UP=new vn(0,1,0),uo.DEFAULT_MATRIX_AUTO_UPDATE=!0,uo.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ya=new vn,Hl=new vn,Qd=new vn,h0=new vn,tl=new vn,Al=new vn,Ju=new vn,Eu=new vn,qa=new vn,O0=new vn;class Fa{constructor(K=new vn,oe=new vn,de=new vn){this.a=K,this.b=oe,this.c=de}static getNormal(K,oe,de,ye){ye.subVectors(de,oe),Ya.subVectors(K,oe),ye.cross(Ya);const Ie=ye.lengthSq();return Ie>0?ye.multiplyScalar(1/Math.sqrt(Ie)):ye.set(0,0,0)}static getBarycoord(K,oe,de,ye,Ie){Ya.subVectors(ye,oe),Hl.subVectors(de,oe),Qd.subVectors(K,oe);const Ue=Ya.dot(Ya),He=Ya.dot(Hl),Ke=Ya.dot(Qd),Ze=Hl.dot(Hl),at=Hl.dot(Qd),mt=Ue*Ze-He*He;if(mt===0)return Ie.set(0,0,0),null;const vt=1/mt,St=(Ze*Ke-He*at)*vt,Lt=(Ue*at-He*Ke)*vt;return Ie.set(1-St-Lt,Lt,St)}static containsPoint(K,oe,de,ye){return this.getBarycoord(K,oe,de,ye,h0)===null?!1:h0.x>=0&&h0.y>=0&&h0.x+h0.y<=1}static getInterpolation(K,oe,de,ye,Ie,Ue,He,Ke){return this.getBarycoord(K,oe,de,ye,h0)===null?(Ke.x=0,Ke.y=0,"z"in Ke&&(Ke.z=0),"w"in Ke&&(Ke.w=0),null):(Ke.setScalar(0),Ke.addScaledVector(Ie,h0.x),Ke.addScaledVector(Ue,h0.y),Ke.addScaledVector(He,h0.z),Ke)}static isFrontFacing(K,oe,de,ye){return Ya.subVectors(de,oe),Hl.subVectors(K,oe),Ya.cross(Hl).dot(ye)<0}set(K,oe,de){return this.a.copy(K),this.b.copy(oe),this.c.copy(de),this}setFromPointsAndIndices(K,oe,de,ye){return this.a.copy(K[oe]),this.b.copy(K[de]),this.c.copy(K[ye]),this}setFromAttributeAndIndices(K,oe,de,ye){return this.a.fromBufferAttribute(K,oe),this.b.fromBufferAttribute(K,de),this.c.fromBufferAttribute(K,ye),this}clone(){return new this.constructor().copy(this)}copy(K){return this.a.copy(K.a),this.b.copy(K.b),this.c.copy(K.c),this}getArea(){return Ya.subVectors(this.c,this.b),Hl.subVectors(this.a,this.b),Ya.cross(Hl).length()*.5}getMidpoint(K){return K.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(K){return Fa.getNormal(this.a,this.b,this.c,K)}getPlane(K){return K.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(K,oe){return Fa.getBarycoord(K,this.a,this.b,this.c,oe)}getInterpolation(K,oe,de,ye,Ie){return Fa.getInterpolation(K,this.a,this.b,this.c,oe,de,ye,Ie)}containsPoint(K){return Fa.containsPoint(K,this.a,this.b,this.c)}isFrontFacing(K){return Fa.isFrontFacing(this.a,this.b,this.c,K)}intersectsBox(K){return K.intersectsTriangle(this)}closestPointToPoint(K,oe){const de=this.a,ye=this.b,Ie=this.c;let Ue,He;tl.subVectors(ye,de),Al.subVectors(Ie,de),Eu.subVectors(K,de);const Ke=tl.dot(Eu),Ze=Al.dot(Eu);if(Ke<=0&&Ze<=0)return oe.copy(de);qa.subVectors(K,ye);const at=tl.dot(qa),mt=Al.dot(qa);if(at>=0&&mt<=at)return oe.copy(ye);const vt=Ke*mt-at*Ze;if(vt<=0&&Ke>=0&&at<=0)return Ue=Ke/(Ke-at),oe.copy(de).addScaledVector(tl,Ue);O0.subVectors(K,Ie);const St=tl.dot(O0),Lt=Al.dot(O0);if(Lt>=0&&St<=Lt)return oe.copy(Ie);const Ht=St*Ze-Ke*Lt;if(Ht<=0&&Ze>=0&&Lt<=0)return He=Ze/(Ze-Lt),oe.copy(de).addScaledVector(Al,He);const Dt=at*Lt-St*mt;if(Dt<=0&&mt-at>=0&&St-Lt>=0)return Ju.subVectors(Ie,ye),He=(mt-at)/(mt-at+(St-Lt)),oe.copy(ye).addScaledVector(Ju,He);const bt=1/(Dt+Ht+vt);return Ue=Ht*bt,He=vt*bt,oe.copy(de).addScaledVector(tl,Ue).addScaledVector(Al,He)}equals(K){return K.a.equals(this.a)&&K.b.equals(this.b)&&K.c.equals(this.c)}}const Vl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wa={h:0,s:0,l:0},ml={h:0,s:0,l:0};function Oh(Be,K,oe){return oe<0&&(oe+=1),oe>1&&(oe-=1),oe<.16666666666666666?Be+(K-Be)*6*oe:oe<.5?K:oe<.6666666666666666?Be+(K-Be)*6*(.6666666666666666-oe):Be}class Wr{constructor(K,oe,de){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(K,oe,de)}set(K,oe,de){if(oe===void 0&&de===void 0){const ye=K;ye&&ye.isColor?this.copy(ye):typeof ye=="number"?this.setHex(ye):typeof ye=="string"&&this.setStyle(ye)}else this.setRGB(K,oe,de);return this}setScalar(K){return this.r=K,this.g=K,this.b=K,this}setHex(K,oe=lo){return K=Math.floor(K),this.r=(K>>16&255)/255,this.g=(K>>8&255)/255,this.b=(K&255)/255,To.toWorkingColorSpace(this,oe),this}setRGB(K,oe,de,ye=To.workingColorSpace){return this.r=K,this.g=oe,this.b=de,To.toWorkingColorSpace(this,ye),this}setHSL(K,oe,de,ye=To.workingColorSpace){if(K=Dl(K,1),oe=qo(oe,0,1),de=qo(de,0,1),oe===0)this.r=this.g=this.b=de;else{const Ie=de<=.5?de*(1+oe):de+oe-de*oe,Ue=2*de-Ie;this.r=Oh(Ue,Ie,K+.3333333333333333),this.g=Oh(Ue,Ie,K),this.b=Oh(Ue,Ie,K-.3333333333333333)}return To.toWorkingColorSpace(this,ye),this}setStyle(K,oe=lo){function de(Ie){Ie!==void 0&&parseFloat(Ie)<1&&console.warn("THREE.Color: Alpha component of "+K+" will be ignored.")}let ye;if(ye=/^(\w+)\(([^\)]*)\)/.exec(K)){let Ie;const Ue=ye[1],He=ye[2];switch(Ue){case"rgb":case"rgba":if(Ie=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(He))return de(Ie[4]),this.setRGB(Math.min(255,parseInt(Ie[1],10))/255,Math.min(255,parseInt(Ie[2],10))/255,Math.min(255,parseInt(Ie[3],10))/255,oe);if(Ie=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(He))return de(Ie[4]),this.setRGB(Math.min(100,parseInt(Ie[1],10))/100,Math.min(100,parseInt(Ie[2],10))/100,Math.min(100,parseInt(Ie[3],10))/100,oe);break;case"hsl":case"hsla":if(Ie=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(He))return de(Ie[4]),this.setHSL(parseFloat(Ie[1])/360,parseFloat(Ie[2])/100,parseFloat(Ie[3])/100,oe);break;default:console.warn("THREE.Color: Unknown color model "+K)}}else if(ye=/^\#([A-Fa-f\d]+)$/.exec(K)){const Ie=ye[1],Ue=Ie.length;if(Ue===3)return this.setRGB(parseInt(Ie.charAt(0),16)/15,parseInt(Ie.charAt(1),16)/15,parseInt(Ie.charAt(2),16)/15,oe);if(Ue===6)return this.setHex(parseInt(Ie,16),oe);console.warn("THREE.Color: Invalid hex color "+K)}else if(K&&K.length>0)return this.setColorName(K,oe);return this}setColorName(K,oe=lo){const de=Vl[K.toLowerCase()];return de!==void 0?this.setHex(de,oe):console.warn("THREE.Color: Unknown color "+K),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(K){return this.r=K.r,this.g=K.g,this.b=K.b,this}copySRGBToLinear(K){return this.r=Nl(K.r),this.g=Nl(K.g),this.b=Nl(K.b),this}copyLinearToSRGB(K){return this.r=Ul(K.r),this.g=Ul(K.g),this.b=Ul(K.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(K=lo){return To.fromWorkingColorSpace(Oa.copy(this),K),Math.round(qo(Oa.r*255,0,255))*65536+Math.round(qo(Oa.g*255,0,255))*256+Math.round(qo(Oa.b*255,0,255))}getHexString(K=lo){return("000000"+this.getHex(K).toString(16)).slice(-6)}getHSL(K,oe=To.workingColorSpace){To.fromWorkingColorSpace(Oa.copy(this),oe);const de=Oa.r,ye=Oa.g,Ie=Oa.b,Ue=Math.max(de,ye,Ie),He=Math.min(de,ye,Ie);let Ke,Ze;const at=(He+Ue)/2;if(He===Ue)Ke=0,Ze=0;else{const mt=Ue-He;switch(Ze=at<=.5?mt/(Ue+He):mt/(2-Ue-He),Ue){case de:Ke=(ye-Ie)/mt+(ye<Ie?6:0);break;case ye:Ke=(Ie-de)/mt+2;break;case Ie:Ke=(de-ye)/mt+4;break}Ke/=6}return K.h=Ke,K.s=Ze,K.l=at,K}getRGB(K,oe=To.workingColorSpace){return To.fromWorkingColorSpace(Oa.copy(this),oe),K.r=Oa.r,K.g=Oa.g,K.b=Oa.b,K}getStyle(K=lo){To.fromWorkingColorSpace(Oa.copy(this),K);const oe=Oa.r,de=Oa.g,ye=Oa.b;return K!==lo?`color(${K} ${oe.toFixed(3)} ${de.toFixed(3)} ${ye.toFixed(3)})`:`rgb(${Math.round(oe*255)},${Math.round(de*255)},${Math.round(ye*255)})`}offsetHSL(K,oe,de){return this.getHSL(wa),this.setHSL(wa.h+K,wa.s+oe,wa.l+de)}add(K){return this.r+=K.r,this.g+=K.g,this.b+=K.b,this}addColors(K,oe){return this.r=K.r+oe.r,this.g=K.g+oe.g,this.b=K.b+oe.b,this}addScalar(K){return this.r+=K,this.g+=K,this.b+=K,this}sub(K){return this.r=Math.max(0,this.r-K.r),this.g=Math.max(0,this.g-K.g),this.b=Math.max(0,this.b-K.b),this}multiply(K){return this.r*=K.r,this.g*=K.g,this.b*=K.b,this}multiplyScalar(K){return this.r*=K,this.g*=K,this.b*=K,this}lerp(K,oe){return this.r+=(K.r-this.r)*oe,this.g+=(K.g-this.g)*oe,this.b+=(K.b-this.b)*oe,this}lerpColors(K,oe,de){return this.r=K.r+(oe.r-K.r)*de,this.g=K.g+(oe.g-K.g)*de,this.b=K.b+(oe.b-K.b)*de,this}lerpHSL(K,oe){this.getHSL(wa),K.getHSL(ml);const de=Wc(wa.h,ml.h,oe),ye=Wc(wa.s,ml.s,oe),Ie=Wc(wa.l,ml.l,oe);return this.setHSL(de,ye,Ie),this}setFromVector3(K){return this.r=K.x,this.g=K.y,this.b=K.z,this}applyMatrix3(K){const oe=this.r,de=this.g,ye=this.b,Ie=K.elements;return this.r=Ie[0]*oe+Ie[3]*de+Ie[6]*ye,this.g=Ie[1]*oe+Ie[4]*de+Ie[7]*ye,this.b=Ie[2]*oe+Ie[5]*de+Ie[8]*ye,this}equals(K){return K.r===this.r&&K.g===this.g&&K.b===this.b}fromArray(K,oe=0){return this.r=K[oe],this.g=K[oe+1],this.b=K[oe+2],this}toArray(K=[],oe=0){return K[oe]=this.r,K[oe+1]=this.g,K[oe+2]=this.b,K}fromBufferAttribute(K,oe){return this.r=K.getX(oe),this.g=K.getY(oe),this.b=K.getZ(oe),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Oa=new Wr;Wr.NAMES=Vl;let Na=0;class Oo extends La{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Na++}),this.uuid=c0(),this.name="",this.type="Material",this.blending=st,this.side=ke,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=hn,this.blendDst=nn,this.blendEquation=Mt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Wr(0,0,0),this.blendAlpha=0,this.depthFunc=ir,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Vu,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=P0,this.stencilZFail=P0,this.stencilZPass=P0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(K){this._alphaTest>0!=K>0&&this.version++,this._alphaTest=K}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(K){if(K!==void 0)for(const oe in K){const de=K[oe];if(de===void 0){console.warn(`THREE.Material: parameter '${oe}' has value of undefined.`);continue}const ye=this[oe];if(ye===void 0){console.warn(`THREE.Material: '${oe}' is not a property of THREE.${this.type}.`);continue}ye&&ye.isColor?ye.set(de):ye&&ye.isVector3&&de&&de.isVector3?ye.copy(de):this[oe]=de}}toJSON(K){const oe=K===void 0||typeof K=="string";oe&&(K={textures:{},images:{}});const de={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};de.uuid=this.uuid,de.type=this.type,this.name!==""&&(de.name=this.name),this.color&&this.color.isColor&&(de.color=this.color.getHex()),this.roughness!==void 0&&(de.roughness=this.roughness),this.metalness!==void 0&&(de.metalness=this.metalness),this.sheen!==void 0&&(de.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(de.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(de.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(de.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(de.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(de.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(de.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(de.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(de.shininess=this.shininess),this.clearcoat!==void 0&&(de.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(de.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(de.clearcoatMap=this.clearcoatMap.toJSON(K).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(de.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(K).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(de.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(K).uuid,de.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(de.dispersion=this.dispersion),this.iridescence!==void 0&&(de.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(de.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(de.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(de.iridescenceMap=this.iridescenceMap.toJSON(K).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(de.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(K).uuid),this.anisotropy!==void 0&&(de.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(de.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(de.anisotropyMap=this.anisotropyMap.toJSON(K).uuid),this.map&&this.map.isTexture&&(de.map=this.map.toJSON(K).uuid),this.matcap&&this.matcap.isTexture&&(de.matcap=this.matcap.toJSON(K).uuid),this.alphaMap&&this.alphaMap.isTexture&&(de.alphaMap=this.alphaMap.toJSON(K).uuid),this.lightMap&&this.lightMap.isTexture&&(de.lightMap=this.lightMap.toJSON(K).uuid,de.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(de.aoMap=this.aoMap.toJSON(K).uuid,de.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(de.bumpMap=this.bumpMap.toJSON(K).uuid,de.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(de.normalMap=this.normalMap.toJSON(K).uuid,de.normalMapType=this.normalMapType,de.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(de.displacementMap=this.displacementMap.toJSON(K).uuid,de.displacementScale=this.displacementScale,de.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(de.roughnessMap=this.roughnessMap.toJSON(K).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(de.metalnessMap=this.metalnessMap.toJSON(K).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(de.emissiveMap=this.emissiveMap.toJSON(K).uuid),this.specularMap&&this.specularMap.isTexture&&(de.specularMap=this.specularMap.toJSON(K).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(de.specularIntensityMap=this.specularIntensityMap.toJSON(K).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(de.specularColorMap=this.specularColorMap.toJSON(K).uuid),this.envMap&&this.envMap.isTexture&&(de.envMap=this.envMap.toJSON(K).uuid,this.combine!==void 0&&(de.combine=this.combine)),this.envMapRotation!==void 0&&(de.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(de.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(de.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(de.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(de.gradientMap=this.gradientMap.toJSON(K).uuid),this.transmission!==void 0&&(de.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(de.transmissionMap=this.transmissionMap.toJSON(K).uuid),this.thickness!==void 0&&(de.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(de.thicknessMap=this.thicknessMap.toJSON(K).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(de.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(de.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(de.size=this.size),this.shadowSide!==null&&(de.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(de.sizeAttenuation=this.sizeAttenuation),this.blending!==st&&(de.blending=this.blending),this.side!==ke&&(de.side=this.side),this.vertexColors===!0&&(de.vertexColors=!0),this.opacity<1&&(de.opacity=this.opacity),this.transparent===!0&&(de.transparent=!0),this.blendSrc!==hn&&(de.blendSrc=this.blendSrc),this.blendDst!==nn&&(de.blendDst=this.blendDst),this.blendEquation!==Mt&&(de.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(de.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(de.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(de.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(de.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(de.blendAlpha=this.blendAlpha),this.depthFunc!==ir&&(de.depthFunc=this.depthFunc),this.depthTest===!1&&(de.depthTest=this.depthTest),this.depthWrite===!1&&(de.depthWrite=this.depthWrite),this.colorWrite===!1&&(de.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(de.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Vu&&(de.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(de.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(de.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==P0&&(de.stencilFail=this.stencilFail),this.stencilZFail!==P0&&(de.stencilZFail=this.stencilZFail),this.stencilZPass!==P0&&(de.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(de.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(de.rotation=this.rotation),this.polygonOffset===!0&&(de.polygonOffset=!0),this.polygonOffsetFactor!==0&&(de.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(de.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(de.linewidth=this.linewidth),this.dashSize!==void 0&&(de.dashSize=this.dashSize),this.gapSize!==void 0&&(de.gapSize=this.gapSize),this.scale!==void 0&&(de.scale=this.scale),this.dithering===!0&&(de.dithering=!0),this.alphaTest>0&&(de.alphaTest=this.alphaTest),this.alphaHash===!0&&(de.alphaHash=!0),this.alphaToCoverage===!0&&(de.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(de.premultipliedAlpha=!0),this.forceSinglePass===!0&&(de.forceSinglePass=!0),this.wireframe===!0&&(de.wireframe=!0),this.wireframeLinewidth>1&&(de.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(de.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(de.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(de.flatShading=!0),this.visible===!1&&(de.visible=!1),this.toneMapped===!1&&(de.toneMapped=!1),this.fog===!1&&(de.fog=!1),Object.keys(this.userData).length>0&&(de.userData=this.userData);function ye(Ie){const Ue=[];for(const He in Ie){const Ke=Ie[He];delete Ke.metadata,Ue.push(Ke)}return Ue}if(oe){const Ie=ye(K.textures),Ue=ye(K.images);Ie.length>0&&(de.textures=Ie),Ue.length>0&&(de.images=Ue)}return de}clone(){return new this.constructor().copy(this)}copy(K){this.name=K.name,this.blending=K.blending,this.side=K.side,this.vertexColors=K.vertexColors,this.opacity=K.opacity,this.transparent=K.transparent,this.blendSrc=K.blendSrc,this.blendDst=K.blendDst,this.blendEquation=K.blendEquation,this.blendSrcAlpha=K.blendSrcAlpha,this.blendDstAlpha=K.blendDstAlpha,this.blendEquationAlpha=K.blendEquationAlpha,this.blendColor.copy(K.blendColor),this.blendAlpha=K.blendAlpha,this.depthFunc=K.depthFunc,this.depthTest=K.depthTest,this.depthWrite=K.depthWrite,this.stencilWriteMask=K.stencilWriteMask,this.stencilFunc=K.stencilFunc,this.stencilRef=K.stencilRef,this.stencilFuncMask=K.stencilFuncMask,this.stencilFail=K.stencilFail,this.stencilZFail=K.stencilZFail,this.stencilZPass=K.stencilZPass,this.stencilWrite=K.stencilWrite;const oe=K.clippingPlanes;let de=null;if(oe!==null){const ye=oe.length;de=new Array(ye);for(let Ie=0;Ie!==ye;++Ie)de[Ie]=oe[Ie].clone()}return this.clippingPlanes=de,this.clipIntersection=K.clipIntersection,this.clipShadows=K.clipShadows,this.shadowSide=K.shadowSide,this.colorWrite=K.colorWrite,this.precision=K.precision,this.polygonOffset=K.polygonOffset,this.polygonOffsetFactor=K.polygonOffsetFactor,this.polygonOffsetUnits=K.polygonOffsetUnits,this.dithering=K.dithering,this.alphaTest=K.alphaTest,this.alphaHash=K.alphaHash,this.alphaToCoverage=K.alphaToCoverage,this.premultipliedAlpha=K.premultipliedAlpha,this.forceSinglePass=K.forceSinglePass,this.visible=K.visible,this.toneMapped=K.toneMapped,this.userData=JSON.parse(JSON.stringify(K.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(K){K===!0&&this.version++}}class Io extends Oo{constructor(K){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Wr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new S0,this.combine=Kn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.map=K.map,this.lightMap=K.lightMap,this.lightMapIntensity=K.lightMapIntensity,this.aoMap=K.aoMap,this.aoMapIntensity=K.aoMapIntensity,this.specularMap=K.specularMap,this.alphaMap=K.alphaMap,this.envMap=K.envMap,this.envMapRotation.copy(K.envMapRotation),this.combine=K.combine,this.reflectivity=K.reflectivity,this.refractionRatio=K.refractionRatio,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.wireframeLinecap=K.wireframeLinecap,this.wireframeLinejoin=K.wireframeLinejoin,this.fog=K.fog,this}}const Ua=k1();function k1(){const Be=new ArrayBuffer(4),K=new Float32Array(Be),oe=new Uint32Array(Be),de=new Uint32Array(512),ye=new Uint32Array(512);for(let Ke=0;Ke<256;++Ke){const Ze=Ke-127;Ze<-27?(de[Ke]=0,de[Ke|256]=32768,ye[Ke]=24,ye[Ke|256]=24):Ze<-14?(de[Ke]=1024>>-Ze-14,de[Ke|256]=1024>>-Ze-14|32768,ye[Ke]=-Ze-1,ye[Ke|256]=-Ze-1):Ze<=15?(de[Ke]=Ze+15<<10,de[Ke|256]=Ze+15<<10|32768,ye[Ke]=13,ye[Ke|256]=13):Ze<128?(de[Ke]=31744,de[Ke|256]=64512,ye[Ke]=24,ye[Ke|256]=24):(de[Ke]=31744,de[Ke|256]=64512,ye[Ke]=13,ye[Ke|256]=13)}const Ie=new Uint32Array(2048),Ue=new Uint32Array(64),He=new Uint32Array(64);for(let Ke=1;Ke<1024;++Ke){let Ze=Ke<<13,at=0;for(;!(Ze&8388608);)Ze<<=1,at-=8388608;Ze&=-8388609,at+=947912704,Ie[Ke]=Ze|at}for(let Ke=1024;Ke<2048;++Ke)Ie[Ke]=939524096+(Ke-1024<<13);for(let Ke=1;Ke<31;++Ke)Ue[Ke]=Ke<<23;Ue[31]=1199570944,Ue[32]=2147483648;for(let Ke=33;Ke<63;++Ke)Ue[Ke]=2147483648+(Ke-32<<23);Ue[63]=3347054592;for(let Ke=1;Ke<64;++Ke)Ke!==32&&(He[Ke]=1024);return{floatView:K,uint32View:oe,baseTable:de,shiftTable:ye,mantissaTable:Ie,exponentTable:Ue,offsetTable:He}}function d0(Be){Math.abs(Be)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),Be=qo(Be,-65504,65504),Ua.floatView[0]=Be;const K=Ua.uint32View[0],oe=K>>23&511;return Ua.baseTable[oe]+((K&8388607)>>Ua.shiftTable[oe])}function Lc(Be){const K=Be>>10;return Ua.uint32View[0]=Ua.mantissaTable[Ua.offsetTable[K]+(Be&1023)]+Ua.exponentTable[K],Ua.floatView[0]}const Hd={toHalfFloat:d0,fromHalfFloat:Lc},Ea=new vn,gc=new qi;class So{constructor(K,oe,de=!1){if(Array.isArray(K))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=K,this.itemSize=oe,this.count=K!==void 0?K.length/oe:0,this.normalized=de,this.usage=sc,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ko,this.version=0}onUploadCallback(){}set needsUpdate(K){K===!0&&this.version++}get updateRange(){return oa("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(K){return this.usage=K,this}addUpdateRange(K,oe){this.updateRanges.push({start:K,count:oe})}clearUpdateRanges(){this.updateRanges.length=0}copy(K){return this.name=K.name,this.array=new K.array.constructor(K.array),this.itemSize=K.itemSize,this.count=K.count,this.normalized=K.normalized,this.usage=K.usage,this.gpuType=K.gpuType,this}copyAt(K,oe,de){K*=this.itemSize,de*=oe.itemSize;for(let ye=0,Ie=this.itemSize;ye<Ie;ye++)this.array[K+ye]=oe.array[de+ye];return this}copyArray(K){return this.array.set(K),this}applyMatrix3(K){if(this.itemSize===2)for(let oe=0,de=this.count;oe<de;oe++)gc.fromBufferAttribute(this,oe),gc.applyMatrix3(K),this.setXY(oe,gc.x,gc.y);else if(this.itemSize===3)for(let oe=0,de=this.count;oe<de;oe++)Ea.fromBufferAttribute(this,oe),Ea.applyMatrix3(K),this.setXYZ(oe,Ea.x,Ea.y,Ea.z);return this}applyMatrix4(K){for(let oe=0,de=this.count;oe<de;oe++)Ea.fromBufferAttribute(this,oe),Ea.applyMatrix4(K),this.setXYZ(oe,Ea.x,Ea.y,Ea.z);return this}applyNormalMatrix(K){for(let oe=0,de=this.count;oe<de;oe++)Ea.fromBufferAttribute(this,oe),Ea.applyNormalMatrix(K),this.setXYZ(oe,Ea.x,Ea.y,Ea.z);return this}transformDirection(K){for(let oe=0,de=this.count;oe<de;oe++)Ea.fromBufferAttribute(this,oe),Ea.transformDirection(K),this.setXYZ(oe,Ea.x,Ea.y,Ea.z);return this}set(K,oe=0){return this.array.set(K,oe),this}getComponent(K,oe){let de=this.array[K*this.itemSize+oe];return this.normalized&&(de=$a(de,this.array)),de}setComponent(K,oe,de){return this.normalized&&(de=Us(de,this.array)),this.array[K*this.itemSize+oe]=de,this}getX(K){let oe=this.array[K*this.itemSize];return this.normalized&&(oe=$a(oe,this.array)),oe}setX(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize]=oe,this}getY(K){let oe=this.array[K*this.itemSize+1];return this.normalized&&(oe=$a(oe,this.array)),oe}setY(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize+1]=oe,this}getZ(K){let oe=this.array[K*this.itemSize+2];return this.normalized&&(oe=$a(oe,this.array)),oe}setZ(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize+2]=oe,this}getW(K){let oe=this.array[K*this.itemSize+3];return this.normalized&&(oe=$a(oe,this.array)),oe}setW(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize+3]=oe,this}setXY(K,oe,de){return K*=this.itemSize,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array)),this.array[K+0]=oe,this.array[K+1]=de,this}setXYZ(K,oe,de,ye){return K*=this.itemSize,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array),ye=Us(ye,this.array)),this.array[K+0]=oe,this.array[K+1]=de,this.array[K+2]=ye,this}setXYZW(K,oe,de,ye,Ie){return K*=this.itemSize,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array),ye=Us(ye,this.array),Ie=Us(Ie,this.array)),this.array[K+0]=oe,this.array[K+1]=de,this.array[K+2]=ye,this.array[K+3]=Ie,this}onUpload(K){return this.onUploadCallback=K,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const K={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(K.name=this.name),this.usage!==sc&&(K.usage=this.usage),K}}class _u extends So{constructor(K,oe,de){super(new Int8Array(K),oe,de)}}class Zu extends So{constructor(K,oe,de){super(new Uint8Array(K),oe,de)}}class Nh extends So{constructor(K,oe,de){super(new Uint8ClampedArray(K),oe,de)}}class yu extends So{constructor(K,oe,de){super(new Int16Array(K),oe,de)}}class Cu extends So{constructor(K,oe,de){super(new Uint16Array(K),oe,de)}}class Vd extends So{constructor(K,oe,de){super(new Int32Array(K),oe,de)}}class vc extends So{constructor(K,oe,de){super(new Uint32Array(K),oe,de)}}class ra extends So{constructor(K,oe,de){super(new Uint16Array(K),oe,de),this.isFloat16BufferAttribute=!0}getX(K){let oe=Lc(this.array[K*this.itemSize]);return this.normalized&&(oe=$a(oe,this.array)),oe}setX(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize]=d0(oe),this}getY(K){let oe=Lc(this.array[K*this.itemSize+1]);return this.normalized&&(oe=$a(oe,this.array)),oe}setY(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize+1]=d0(oe),this}getZ(K){let oe=Lc(this.array[K*this.itemSize+2]);return this.normalized&&(oe=$a(oe,this.array)),oe}setZ(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize+2]=d0(oe),this}getW(K){let oe=Lc(this.array[K*this.itemSize+3]);return this.normalized&&(oe=$a(oe,this.array)),oe}setW(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.array[K*this.itemSize+3]=d0(oe),this}setXY(K,oe,de){return K*=this.itemSize,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array)),this.array[K+0]=d0(oe),this.array[K+1]=d0(de),this}setXYZ(K,oe,de,ye){return K*=this.itemSize,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array),ye=Us(ye,this.array)),this.array[K+0]=d0(oe),this.array[K+1]=d0(de),this.array[K+2]=d0(ye),this}setXYZW(K,oe,de,ye,Ie){return K*=this.itemSize,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array),ye=Us(ye,this.array),Ie=Us(Ie,this.array)),this.array[K+0]=d0(oe),this.array[K+1]=d0(de),this.array[K+2]=d0(ye),this.array[K+3]=d0(Ie),this}}class $i extends So{constructor(K,oe,de){super(new Float32Array(K),oe,de)}}let Mr=0;const f0=new kr,zl=new uo,Dc=new vn,p0=new Rs,Wl=new Rs,Sa=new vn;class Ds extends La{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Mr++}),this.uuid=c0(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(K){return Array.isArray(K)?this.index=new(Au(K)?vc:Cu)(K,1):this.index=K,this}getAttribute(K){return this.attributes[K]}setAttribute(K,oe){return this.attributes[K]=oe,this}deleteAttribute(K){return delete this.attributes[K],this}hasAttribute(K){return this.attributes[K]!==void 0}addGroup(K,oe,de=0){this.groups.push({start:K,count:oe,materialIndex:de})}clearGroups(){this.groups=[]}setDrawRange(K,oe){this.drawRange.start=K,this.drawRange.count=oe}applyMatrix4(K){const oe=this.attributes.position;oe!==void 0&&(oe.applyMatrix4(K),oe.needsUpdate=!0);const de=this.attributes.normal;if(de!==void 0){const Ie=new gs().getNormalMatrix(K);de.applyNormalMatrix(Ie),de.needsUpdate=!0}const ye=this.attributes.tangent;return ye!==void 0&&(ye.transformDirection(K),ye.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(K){return f0.makeRotationFromQuaternion(K),this.applyMatrix4(f0),this}rotateX(K){return f0.makeRotationX(K),this.applyMatrix4(f0),this}rotateY(K){return f0.makeRotationY(K),this.applyMatrix4(f0),this}rotateZ(K){return f0.makeRotationZ(K),this.applyMatrix4(f0),this}translate(K,oe,de){return f0.makeTranslation(K,oe,de),this.applyMatrix4(f0),this}scale(K,oe,de){return f0.makeScale(K,oe,de),this.applyMatrix4(f0),this}lookAt(K){return zl.lookAt(K),zl.updateMatrix(),this.applyMatrix4(zl.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Dc).negate(),this.translate(Dc.x,Dc.y,Dc.z),this}setFromPoints(K){const oe=[];for(let de=0,ye=K.length;de<ye;de++){const Ie=K[de];oe.push(Ie.x,Ie.y,Ie.z||0)}return this.setAttribute("position",new $i(oe,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Rs);const K=this.attributes.position,oe=this.morphAttributes.position;if(K&&K.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new vn(-1/0,-1/0,-1/0),new vn(1/0,1/0,1/0));return}if(K!==void 0){if(this.boundingBox.setFromBufferAttribute(K),oe)for(let de=0,ye=oe.length;de<ye;de++){const Ie=oe[de];p0.setFromBufferAttribute(Ie),this.morphTargetsRelative?(Sa.addVectors(this.boundingBox.min,p0.min),this.boundingBox.expandByPoint(Sa),Sa.addVectors(this.boundingBox.max,p0.max),this.boundingBox.expandByPoint(Sa)):(this.boundingBox.expandByPoint(p0.min),this.boundingBox.expandByPoint(p0.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new la);const K=this.attributes.position,oe=this.morphAttributes.position;if(K&&K.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new vn,1/0);return}if(K){const de=this.boundingSphere.center;if(p0.setFromBufferAttribute(K),oe)for(let Ie=0,Ue=oe.length;Ie<Ue;Ie++){const He=oe[Ie];Wl.setFromBufferAttribute(He),this.morphTargetsRelative?(Sa.addVectors(p0.min,Wl.min),p0.expandByPoint(Sa),Sa.addVectors(p0.max,Wl.max),p0.expandByPoint(Sa)):(p0.expandByPoint(Wl.min),p0.expandByPoint(Wl.max))}p0.getCenter(de);let ye=0;for(let Ie=0,Ue=K.count;Ie<Ue;Ie++)Sa.fromBufferAttribute(K,Ie),ye=Math.max(ye,de.distanceToSquared(Sa));if(oe)for(let Ie=0,Ue=oe.length;Ie<Ue;Ie++){const He=oe[Ie],Ke=this.morphTargetsRelative;for(let Ze=0,at=He.count;Ze<at;Ze++)Sa.fromBufferAttribute(He,Ze),Ke&&(Dc.fromBufferAttribute(K,Ze),Sa.add(Dc)),ye=Math.max(ye,de.distanceToSquared(Sa))}this.boundingSphere.radius=Math.sqrt(ye),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const K=this.index,oe=this.attributes;if(K===null||oe.position===void 0||oe.normal===void 0||oe.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const de=oe.position,ye=oe.normal,Ie=oe.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new So(new Float32Array(4*de.count),4));const Ue=this.getAttribute("tangent"),He=[],Ke=[];for(let Fn=0;Fn<de.count;Fn++)He[Fn]=new vn,Ke[Fn]=new vn;const Ze=new vn,at=new vn,mt=new vn,vt=new qi,St=new qi,Lt=new qi,Ht=new vn,Dt=new vn;function bt(Fn,pn,cn){Ze.fromBufferAttribute(de,Fn),at.fromBufferAttribute(de,pn),mt.fromBufferAttribute(de,cn),vt.fromBufferAttribute(Ie,Fn),St.fromBufferAttribute(Ie,pn),Lt.fromBufferAttribute(Ie,cn),at.sub(Ze),mt.sub(Ze),St.sub(vt),Lt.sub(vt);const On=1/(St.x*Lt.y-Lt.x*St.y);isFinite(On)&&(Ht.copy(at).multiplyScalar(Lt.y).addScaledVector(mt,-St.y).multiplyScalar(On),Dt.copy(mt).multiplyScalar(St.x).addScaledVector(at,-Lt.x).multiplyScalar(On),He[Fn].add(Ht),He[pn].add(Ht),He[cn].add(Ht),Ke[Fn].add(Dt),Ke[pn].add(Dt),Ke[cn].add(Dt))}let tn=this.groups;tn.length===0&&(tn=[{start:0,count:K.count}]);for(let Fn=0,pn=tn.length;Fn<pn;++Fn){const cn=tn[Fn],On=cn.start,Zn=cn.count;for(let Xn=On,ri=On+Zn;Xn<ri;Xn+=3)bt(K.getX(Xn+0),K.getX(Xn+1),K.getX(Xn+2))}const Zt=new vn,qt=new vn,Un=new vn,_n=new vn;function bn(Fn){Un.fromBufferAttribute(ye,Fn),_n.copy(Un);const pn=He[Fn];Zt.copy(pn),Zt.sub(Un.multiplyScalar(Un.dot(pn))).normalize(),qt.crossVectors(_n,pn);const On=qt.dot(Ke[Fn])<0?-1:1;Ue.setXYZW(Fn,Zt.x,Zt.y,Zt.z,On)}for(let Fn=0,pn=tn.length;Fn<pn;++Fn){const cn=tn[Fn],On=cn.start,Zn=cn.count;for(let Xn=On,ri=On+Zn;Xn<ri;Xn+=3)bn(K.getX(Xn+0)),bn(K.getX(Xn+1)),bn(K.getX(Xn+2))}}computeVertexNormals(){const K=this.index,oe=this.getAttribute("position");if(oe!==void 0){let de=this.getAttribute("normal");if(de===void 0)de=new So(new Float32Array(oe.count*3),3),this.setAttribute("normal",de);else for(let vt=0,St=de.count;vt<St;vt++)de.setXYZ(vt,0,0,0);const ye=new vn,Ie=new vn,Ue=new vn,He=new vn,Ke=new vn,Ze=new vn,at=new vn,mt=new vn;if(K)for(let vt=0,St=K.count;vt<St;vt+=3){const Lt=K.getX(vt+0),Ht=K.getX(vt+1),Dt=K.getX(vt+2);ye.fromBufferAttribute(oe,Lt),Ie.fromBufferAttribute(oe,Ht),Ue.fromBufferAttribute(oe,Dt),at.subVectors(Ue,Ie),mt.subVectors(ye,Ie),at.cross(mt),He.fromBufferAttribute(de,Lt),Ke.fromBufferAttribute(de,Ht),Ze.fromBufferAttribute(de,Dt),He.add(at),Ke.add(at),Ze.add(at),de.setXYZ(Lt,He.x,He.y,He.z),de.setXYZ(Ht,Ke.x,Ke.y,Ke.z),de.setXYZ(Dt,Ze.x,Ze.y,Ze.z)}else for(let vt=0,St=oe.count;vt<St;vt+=3)ye.fromBufferAttribute(oe,vt+0),Ie.fromBufferAttribute(oe,vt+1),Ue.fromBufferAttribute(oe,vt+2),at.subVectors(Ue,Ie),mt.subVectors(ye,Ie),at.cross(mt),de.setXYZ(vt+0,at.x,at.y,at.z),de.setXYZ(vt+1,at.x,at.y,at.z),de.setXYZ(vt+2,at.x,at.y,at.z);this.normalizeNormals(),de.needsUpdate=!0}}normalizeNormals(){const K=this.attributes.normal;for(let oe=0,de=K.count;oe<de;oe++)Sa.fromBufferAttribute(K,oe),Sa.normalize(),K.setXYZ(oe,Sa.x,Sa.y,Sa.z)}toNonIndexed(){function K(He,Ke){const Ze=He.array,at=He.itemSize,mt=He.normalized,vt=new Ze.constructor(Ke.length*at);let St=0,Lt=0;for(let Ht=0,Dt=Ke.length;Ht<Dt;Ht++){He.isInterleavedBufferAttribute?St=Ke[Ht]*He.data.stride+He.offset:St=Ke[Ht]*at;for(let bt=0;bt<at;bt++)vt[Lt++]=Ze[St++]}return new So(vt,at,mt)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const oe=new Ds,de=this.index.array,ye=this.attributes;for(const He in ye){const Ke=ye[He],Ze=K(Ke,de);oe.setAttribute(He,Ze)}const Ie=this.morphAttributes;for(const He in Ie){const Ke=[],Ze=Ie[He];for(let at=0,mt=Ze.length;at<mt;at++){const vt=Ze[at],St=K(vt,de);Ke.push(St)}oe.morphAttributes[He]=Ke}oe.morphTargetsRelative=this.morphTargetsRelative;const Ue=this.groups;for(let He=0,Ke=Ue.length;He<Ke;He++){const Ze=Ue[He];oe.addGroup(Ze.start,Ze.count,Ze.materialIndex)}return oe}toJSON(){const K={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(K.uuid=this.uuid,K.type=this.type,this.name!==""&&(K.name=this.name),Object.keys(this.userData).length>0&&(K.userData=this.userData),this.parameters!==void 0){const Ke=this.parameters;for(const Ze in Ke)Ke[Ze]!==void 0&&(K[Ze]=Ke[Ze]);return K}K.data={attributes:{}};const oe=this.index;oe!==null&&(K.data.index={type:oe.array.constructor.name,array:Array.prototype.slice.call(oe.array)});const de=this.attributes;for(const Ke in de){const Ze=de[Ke];K.data.attributes[Ke]=Ze.toJSON(K.data)}const ye={};let Ie=!1;for(const Ke in this.morphAttributes){const Ze=this.morphAttributes[Ke],at=[];for(let mt=0,vt=Ze.length;mt<vt;mt++){const St=Ze[mt];at.push(St.toJSON(K.data))}at.length>0&&(ye[Ke]=at,Ie=!0)}Ie&&(K.data.morphAttributes=ye,K.data.morphTargetsRelative=this.morphTargetsRelative);const Ue=this.groups;Ue.length>0&&(K.data.groups=JSON.parse(JSON.stringify(Ue)));const He=this.boundingSphere;return He!==null&&(K.data.boundingSphere={center:He.center.toArray(),radius:He.radius}),K}clone(){return new this.constructor().copy(this)}copy(K){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const oe={};this.name=K.name;const de=K.index;de!==null&&this.setIndex(de.clone(oe));const ye=K.attributes;for(const Ze in ye){const at=ye[Ze];this.setAttribute(Ze,at.clone(oe))}const Ie=K.morphAttributes;for(const Ze in Ie){const at=[],mt=Ie[Ze];for(let vt=0,St=mt.length;vt<St;vt++)at.push(mt[vt].clone(oe));this.morphAttributes[Ze]=at}this.morphTargetsRelative=K.morphTargetsRelative;const Ue=K.groups;for(let Ze=0,at=Ue.length;Ze<at;Ze++){const mt=Ue[Ze];this.addGroup(mt.start,mt.count,mt.materialIndex)}const He=K.boundingBox;He!==null&&(this.boundingBox=He.clone());const Ke=K.boundingSphere;return Ke!==null&&(this.boundingSphere=Ke.clone()),this.drawRange.start=K.drawRange.start,this.drawRange.count=K.drawRange.count,this.userData=K.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const $0=new kr,N0=new Jo,xu=new la,Uh=new vn,U0=new vn,Jn=new vn,$l=new vn,kh=new vn,nl=new vn,gl=new qi,Ja=new qi,ju=new qi,Ec=new vn,Gh=new vn,wu=new vn,es=new vn,Xl=new vn;class Zo extends uo{constructor(K=new Ds,oe=new Io){super(),this.isMesh=!0,this.type="Mesh",this.geometry=K,this.material=oe,this.updateMorphTargets()}copy(K,oe){return super.copy(K,oe),K.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=K.morphTargetInfluences.slice()),K.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},K.morphTargetDictionary)),this.material=Array.isArray(K.material)?K.material.slice():K.material,this.geometry=K.geometry,this}updateMorphTargets(){const oe=this.geometry.morphAttributes,de=Object.keys(oe);if(de.length>0){const ye=oe[de[0]];if(ye!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++){const He=ye[Ie].name||String(Ie);this.morphTargetInfluences.push(0),this.morphTargetDictionary[He]=Ie}}}}getVertexPosition(K,oe){const de=this.geometry,ye=de.attributes.position,Ie=de.morphAttributes.position,Ue=de.morphTargetsRelative;oe.fromBufferAttribute(ye,K);const He=this.morphTargetInfluences;if(Ie&&He){nl.set(0,0,0);for(let Ke=0,Ze=Ie.length;Ke<Ze;Ke++){const at=He[Ke],mt=Ie[Ke];at!==0&&(kh.fromBufferAttribute(mt,K),Ue?nl.addScaledVector(kh,at):nl.addScaledVector(kh.sub(oe),at))}oe.add(nl)}return oe}raycast(K,oe){const de=this.geometry,ye=this.material,Ie=this.matrixWorld;ye!==void 0&&(de.boundingSphere===null&&de.computeBoundingSphere(),xu.copy(de.boundingSphere),xu.applyMatrix4(Ie),N0.copy(K.ray).recast(K.near),!(xu.containsPoint(N0.origin)===!1&&(N0.intersectSphere(xu,Uh)===null||N0.origin.distanceToSquared(Uh)>(K.far-K.near)**2))&&($0.copy(Ie).invert(),N0.copy(K.ray).applyMatrix4($0),!(de.boundingBox!==null&&N0.intersectsBox(de.boundingBox)===!1)&&this._computeIntersections(K,oe,N0)))}_computeIntersections(K,oe,de){let ye;const Ie=this.geometry,Ue=this.material,He=Ie.index,Ke=Ie.attributes.position,Ze=Ie.attributes.uv,at=Ie.attributes.uv1,mt=Ie.attributes.normal,vt=Ie.groups,St=Ie.drawRange;if(He!==null)if(Array.isArray(Ue))for(let Lt=0,Ht=vt.length;Lt<Ht;Lt++){const Dt=vt[Lt],bt=Ue[Dt.materialIndex],tn=Math.max(Dt.start,St.start),Zt=Math.min(He.count,Math.min(Dt.start+Dt.count,St.start+St.count));for(let qt=tn,Un=Zt;qt<Un;qt+=3){const _n=He.getX(qt),bn=He.getX(qt+1),Fn=He.getX(qt+2);ye=yc(this,bt,K,de,Ze,at,mt,_n,bn,Fn),ye&&(ye.faceIndex=Math.floor(qt/3),ye.face.materialIndex=Dt.materialIndex,oe.push(ye))}}else{const Lt=Math.max(0,St.start),Ht=Math.min(He.count,St.start+St.count);for(let Dt=Lt,bt=Ht;Dt<bt;Dt+=3){const tn=He.getX(Dt),Zt=He.getX(Dt+1),qt=He.getX(Dt+2);ye=yc(this,Ue,K,de,Ze,at,mt,tn,Zt,qt),ye&&(ye.faceIndex=Math.floor(Dt/3),oe.push(ye))}}else if(Ke!==void 0)if(Array.isArray(Ue))for(let Lt=0,Ht=vt.length;Lt<Ht;Lt++){const Dt=vt[Lt],bt=Ue[Dt.materialIndex],tn=Math.max(Dt.start,St.start),Zt=Math.min(Ke.count,Math.min(Dt.start+Dt.count,St.start+St.count));for(let qt=tn,Un=Zt;qt<Un;qt+=3){const _n=qt,bn=qt+1,Fn=qt+2;ye=yc(this,bt,K,de,Ze,at,mt,_n,bn,Fn),ye&&(ye.faceIndex=Math.floor(qt/3),ye.face.materialIndex=Dt.materialIndex,oe.push(ye))}}else{const Lt=Math.max(0,St.start),Ht=Math.min(Ke.count,St.start+St.count);for(let Dt=Lt,bt=Ht;Dt<bt;Dt+=3){const tn=Dt,Zt=Dt+1,qt=Dt+2;ye=yc(this,Ue,K,de,Ze,at,mt,tn,Zt,qt),ye&&(ye.faceIndex=Math.floor(Dt/3),oe.push(ye))}}}}function tu(Be,K,oe,de,ye,Ie,Ue,He){let Ke;if(K.side===Ve?Ke=de.intersectTriangle(Ue,Ie,ye,!0,He):Ke=de.intersectTriangle(ye,Ie,Ue,K.side===ke,He),Ke===null)return null;Xl.copy(He),Xl.applyMatrix4(Be.matrixWorld);const Ze=oe.ray.origin.distanceTo(Xl);return Ze<oe.near||Ze>oe.far?null:{distance:Ze,point:Xl.clone(),object:Be}}function yc(Be,K,oe,de,ye,Ie,Ue,He,Ke,Ze){Be.getVertexPosition(He,U0),Be.getVertexPosition(Ke,Jn),Be.getVertexPosition(Ze,$l);const at=tu(Be,K,oe,de,U0,Jn,$l,es);if(at){ye&&(gl.fromBufferAttribute(ye,He),Ja.fromBufferAttribute(ye,Ke),ju.fromBufferAttribute(ye,Ze),at.uv=Fa.getInterpolation(es,U0,Jn,$l,gl,Ja,ju,new qi)),Ie&&(gl.fromBufferAttribute(Ie,He),Ja.fromBufferAttribute(Ie,Ke),ju.fromBufferAttribute(Ie,Ze),at.uv1=Fa.getInterpolation(es,U0,Jn,$l,gl,Ja,ju,new qi)),Ue&&(Ec.fromBufferAttribute(Ue,He),Gh.fromBufferAttribute(Ue,Ke),wu.fromBufferAttribute(Ue,Ze),at.normal=Fa.getInterpolation(es,U0,Jn,$l,Ec,Gh,wu,new vn),at.normal.dot(de.direction)>0&&at.normal.multiplyScalar(-1));const mt={a:He,b:Ke,c:Ze,normal:new vn,materialIndex:0};Fa.getNormal(U0,Jn,$l,mt.normal),at.face=mt}return at}class il extends Ds{constructor(K=1,oe=1,de=1,ye=1,Ie=1,Ue=1){super(),this.type="BoxGeometry",this.parameters={width:K,height:oe,depth:de,widthSegments:ye,heightSegments:Ie,depthSegments:Ue};const He=this;ye=Math.floor(ye),Ie=Math.floor(Ie),Ue=Math.floor(Ue);const Ke=[],Ze=[],at=[],mt=[];let vt=0,St=0;Lt("z","y","x",-1,-1,de,oe,K,Ue,Ie,0),Lt("z","y","x",1,-1,de,oe,-K,Ue,Ie,1),Lt("x","z","y",1,1,K,de,oe,ye,Ue,2),Lt("x","z","y",1,-1,K,de,-oe,ye,Ue,3),Lt("x","y","z",1,-1,K,oe,de,ye,Ie,4),Lt("x","y","z",-1,-1,K,oe,-de,ye,Ie,5),this.setIndex(Ke),this.setAttribute("position",new $i(Ze,3)),this.setAttribute("normal",new $i(at,3)),this.setAttribute("uv",new $i(mt,2));function Lt(Ht,Dt,bt,tn,Zt,qt,Un,_n,bn,Fn,pn){const cn=qt/bn,On=Un/Fn,Zn=qt/2,Xn=Un/2,ri=_n/2,wi=bn+1,Ji=Fn+1;let Dr=0,Ri=0;const xr=new vn;for(let br=0;br<Ji;br++){const us=br*On-Xn;for(let oo=0;oo<wi;oo++){const Qo=oo*cn-Zn;xr[Ht]=Qo*tn,xr[Dt]=us*Zt,xr[bt]=ri,Ze.push(xr.x,xr.y,xr.z),xr[Ht]=0,xr[Dt]=0,xr[bt]=_n>0?1:-1,at.push(xr.x,xr.y,xr.z),mt.push(oo/bn),mt.push(1-br/Fn),Dr+=1}}for(let br=0;br<Fn;br++)for(let us=0;us<bn;us++){const oo=vt+us+wi*br,Qo=vt+us+wi*(br+1),ha=vt+(us+1)+wi*(br+1),No=vt+(us+1)+wi*br;Ke.push(oo,Qo,No),Ke.push(Qo,ha,No),Ri+=6}He.addGroup(St,Ri,pn),St+=Ri,vt+=Dr}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new il(K.width,K.height,K.depth,K.widthSegments,K.heightSegments,K.depthSegments)}}function nu(Be){const K={};for(const oe in Be){K[oe]={};for(const de in Be[oe]){const ye=Be[oe][de];ye&&(ye.isColor||ye.isMatrix3||ye.isMatrix4||ye.isVector2||ye.isVector3||ye.isVector4||ye.isTexture||ye.isQuaternion)?ye.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),K[oe][de]=null):K[oe][de]=ye.clone():Array.isArray(ye)?K[oe][de]=ye.slice():K[oe][de]=ye}}return K}function r0(Be){const K={};for(let oe=0;oe<Be.length;oe++){const de=nu(Be[oe]);for(const ye in de)K[ye]=de[ye]}return K}function sa(Be){const K=[];for(let oe=0;oe<Be.length;oe++)K.push(Be[oe].clone());return K}function eh(Be){const K=Be.getRenderTarget();return K===null?Be.outputColorSpace:K.isXRRenderTarget===!0?K.texture.colorSpace:To.workingColorSpace}const Qh={clone:nu,merge:r0};var Hh=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Pc=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class k0 extends Oo{constructor(K){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Hh,this.fragmentShader=Pc,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,K!==void 0&&this.setValues(K)}copy(K){return super.copy(K),this.fragmentShader=K.fragmentShader,this.vertexShader=K.vertexShader,this.uniforms=nu(K.uniforms),this.uniformsGroups=sa(K.uniformsGroups),this.defines=Object.assign({},K.defines),this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.fog=K.fog,this.lights=K.lights,this.clipping=K.clipping,this.extensions=Object.assign({},K.extensions),this.glslVersion=K.glslVersion,this}toJSON(K){const oe=super.toJSON(K);oe.glslVersion=this.glslVersion,oe.uniforms={};for(const ye in this.uniforms){const Ue=this.uniforms[ye].value;Ue&&Ue.isTexture?oe.uniforms[ye]={type:"t",value:Ue.toJSON(K).uuid}:Ue&&Ue.isColor?oe.uniforms[ye]={type:"c",value:Ue.getHex()}:Ue&&Ue.isVector2?oe.uniforms[ye]={type:"v2",value:Ue.toArray()}:Ue&&Ue.isVector3?oe.uniforms[ye]={type:"v3",value:Ue.toArray()}:Ue&&Ue.isVector4?oe.uniforms[ye]={type:"v4",value:Ue.toArray()}:Ue&&Ue.isMatrix3?oe.uniforms[ye]={type:"m3",value:Ue.toArray()}:Ue&&Ue.isMatrix4?oe.uniforms[ye]={type:"m4",value:Ue.toArray()}:oe.uniforms[ye]={value:Ue}}Object.keys(this.defines).length>0&&(oe.defines=this.defines),oe.vertexShader=this.vertexShader,oe.fragmentShader=this.fragmentShader,oe.lights=this.lights,oe.clipping=this.clipping;const de={};for(const ye in this.extensions)this.extensions[ye]===!0&&(de[ye]=!0);return Object.keys(de).length>0&&(oe.extensions=de),oe}}class Kl extends uo{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kr,this.projectionMatrix=new kr,this.projectionMatrixInverse=new kr,this.coordinateSystem=j0}copy(K,oe){return super.copy(K,oe),this.matrixWorldInverse.copy(K.matrixWorldInverse),this.projectionMatrix.copy(K.projectionMatrix),this.projectionMatrixInverse.copy(K.projectionMatrixInverse),this.coordinateSystem=K.coordinateSystem,this}getWorldDirection(K){return super.getWorldDirection(K).negate()}updateMatrixWorld(K){super.updateMatrixWorld(K),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(K,oe){super.updateWorldMatrix(K,oe),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ro=new vn,Ks=new qi,Ma=new qi;class jo extends Kl{constructor(K=50,oe=1,de=.1,ye=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=K,this.zoom=1,this.near=de,this.far=ye,this.focus=10,this.aspect=oe,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(K,oe){return super.copy(K,oe),this.fov=K.fov,this.zoom=K.zoom,this.near=K.near,this.far=K.far,this.focus=K.focus,this.aspect=K.aspect,this.view=K.view===null?null:Object.assign({},K.view),this.filmGauge=K.filmGauge,this.filmOffset=K.filmOffset,this}setFocalLength(K){const oe=.5*this.getFilmHeight()/K;this.fov=ac*2*Math.atan(oe),this.updateProjectionMatrix()}getFocalLength(){const K=Math.tan(Ll*.5*this.fov);return .5*this.getFilmHeight()/K}getEffectiveFOV(){return ac*2*Math.atan(Math.tan(Ll*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(K,oe,de){Ro.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),oe.set(Ro.x,Ro.y).multiplyScalar(-K/Ro.z),Ro.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),de.set(Ro.x,Ro.y).multiplyScalar(-K/Ro.z)}getViewSize(K,oe){return this.getViewBounds(K,Ks,Ma),oe.subVectors(Ma,Ks)}setViewOffset(K,oe,de,ye,Ie,Ue){this.aspect=K/oe,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=K,this.view.fullHeight=oe,this.view.offsetX=de,this.view.offsetY=ye,this.view.width=Ie,this.view.height=Ue,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const K=this.near;let oe=K*Math.tan(Ll*.5*this.fov)/this.zoom,de=2*oe,ye=this.aspect*de,Ie=-.5*ye;const Ue=this.view;if(this.view!==null&&this.view.enabled){const Ke=Ue.fullWidth,Ze=Ue.fullHeight;Ie+=Ue.offsetX*ye/Ke,oe-=Ue.offsetY*de/Ze,ye*=Ue.width/Ke,de*=Ue.height/Ze}const He=this.filmOffset;He!==0&&(Ie+=K*He/this.getFilmWidth()),this.projectionMatrix.makePerspective(Ie,Ie+ye,oe,oe-de,K,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(K){const oe=super.toJSON(K);return oe.object.fov=this.fov,oe.object.zoom=this.zoom,oe.object.near=this.near,oe.object.far=this.far,oe.object.focus=this.focus,oe.object.aspect=this.aspect,this.view!==null&&(oe.object.view=Object.assign({},this.view)),oe.object.filmGauge=this.filmGauge,oe.object.filmOffset=this.filmOffset,oe}}const b0=-90,Yl=1;class Vh extends uo{constructor(K,oe,de){super(),this.type="CubeCamera",this.renderTarget=de,this.coordinateSystem=null,this.activeMipmapLevel=0;const ye=new jo(b0,Yl,K,oe);ye.layers=this.layers,this.add(ye);const Ie=new jo(b0,Yl,K,oe);Ie.layers=this.layers,this.add(Ie);const Ue=new jo(b0,Yl,K,oe);Ue.layers=this.layers,this.add(Ue);const He=new jo(b0,Yl,K,oe);He.layers=this.layers,this.add(He);const Ke=new jo(b0,Yl,K,oe);Ke.layers=this.layers,this.add(Ke);const Ze=new jo(b0,Yl,K,oe);Ze.layers=this.layers,this.add(Ze)}updateCoordinateSystem(){const K=this.coordinateSystem,oe=this.children.concat(),[de,ye,Ie,Ue,He,Ke]=oe;for(const Ze of oe)this.remove(Ze);if(K===j0)de.up.set(0,1,0),de.lookAt(1,0,0),ye.up.set(0,1,0),ye.lookAt(-1,0,0),Ie.up.set(0,0,-1),Ie.lookAt(0,1,0),Ue.up.set(0,0,1),Ue.lookAt(0,-1,0),He.up.set(0,1,0),He.lookAt(0,0,1),Ke.up.set(0,1,0),Ke.lookAt(0,0,-1);else if(K===oc)de.up.set(0,-1,0),de.lookAt(-1,0,0),ye.up.set(0,-1,0),ye.lookAt(1,0,0),Ie.up.set(0,0,1),Ie.lookAt(0,1,0),Ue.up.set(0,0,-1),Ue.lookAt(0,-1,0),He.up.set(0,-1,0),He.lookAt(0,0,1),Ke.up.set(0,-1,0),Ke.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+K);for(const Ze of oe)this.add(Ze),Ze.updateMatrixWorld()}update(K,oe){this.parent===null&&this.updateMatrixWorld();const{renderTarget:de,activeMipmapLevel:ye}=this;this.coordinateSystem!==K.coordinateSystem&&(this.coordinateSystem=K.coordinateSystem,this.updateCoordinateSystem());const[Ie,Ue,He,Ke,Ze,at]=this.children,mt=K.getRenderTarget(),vt=K.getActiveCubeFace(),St=K.getActiveMipmapLevel(),Lt=K.xr.enabled;K.xr.enabled=!1;const Ht=de.texture.generateMipmaps;de.texture.generateMipmaps=!1,K.setRenderTarget(de,0,ye),K.render(oe,Ie),K.setRenderTarget(de,1,ye),K.render(oe,Ue),K.setRenderTarget(de,2,ye),K.render(oe,He),K.setRenderTarget(de,3,ye),K.render(oe,Ke),K.setRenderTarget(de,4,ye),K.render(oe,Ze),de.texture.generateMipmaps=Ht,K.setRenderTarget(de,5,ye),K.render(oe,at),K.setRenderTarget(mt,vt,St),K.xr.enabled=Lt,de.texture.needsPMREMUpdate=!0}}class ba extends Fo{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at){K=K!==void 0?K:[],oe=oe!==void 0?oe:Nt,super(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(K){this.image=K}}class th extends ga{constructor(K=1,oe={}){super(K,K,oe),this.isWebGLCubeRenderTarget=!0;const de={width:K,height:K,depth:1},ye=[de,de,de,de,de,de];this.texture=new ba(ye,oe.mapping,oe.wrapS,oe.wrapT,oe.magFilter,oe.minFilter,oe.format,oe.type,oe.anisotropy,oe.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=oe.generateMipmaps!==void 0?oe.generateMipmaps:!1,this.texture.minFilter=oe.minFilter!==void 0?oe.minFilter:Jr}fromEquirectangularTexture(K,oe){this.texture.type=oe.type,this.texture.colorSpace=oe.colorSpace,this.texture.generateMipmaps=oe.generateMipmaps,this.texture.minFilter=oe.minFilter,this.texture.magFilter=oe.magFilter;const de={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},ye=new il(5,5,5),Ie=new k0({name:"CubemapFromEquirect",uniforms:nu(de.uniforms),vertexShader:de.vertexShader,fragmentShader:de.fragmentShader,side:Ve,blending:$e});Ie.uniforms.tEquirect.value=oe;const Ue=new Zo(ye,Ie),He=oe.minFilter;return oe.minFilter===Qs&&(oe.minFilter=Jr),new Vh(1,10,this).update(K,Ue),oe.minFilter=He,Ue.geometry.dispose(),Ue.material.dispose(),this}clear(K,oe,de,ye){const Ie=K.getRenderTarget();for(let Ue=0;Ue<6;Ue++)K.setRenderTarget(this,Ue),K.clear(oe,de,ye);K.setRenderTarget(Ie)}}const Su=new vn,zh=new vn,vl=new gs;class ka{constructor(K=new vn(1,0,0),oe=0){this.isPlane=!0,this.normal=K,this.constant=oe}set(K,oe){return this.normal.copy(K),this.constant=oe,this}setComponents(K,oe,de,ye){return this.normal.set(K,oe,de),this.constant=ye,this}setFromNormalAndCoplanarPoint(K,oe){return this.normal.copy(K),this.constant=-oe.dot(this.normal),this}setFromCoplanarPoints(K,oe,de){const ye=Su.subVectors(de,oe).cross(zh.subVectors(K,oe)).normalize();return this.setFromNormalAndCoplanarPoint(ye,K),this}copy(K){return this.normal.copy(K.normal),this.constant=K.constant,this}normalize(){const K=1/this.normal.length();return this.normal.multiplyScalar(K),this.constant*=K,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(K){return this.normal.dot(K)+this.constant}distanceToSphere(K){return this.distanceToPoint(K.center)-K.radius}projectPoint(K,oe){return oe.copy(K).addScaledVector(this.normal,-this.distanceToPoint(K))}intersectLine(K,oe){const de=K.delta(Su),ye=this.normal.dot(de);if(ye===0)return this.distanceToPoint(K.start)===0?oe.copy(K.start):null;const Ie=-(K.start.dot(this.normal)+this.constant)/ye;return Ie<0||Ie>1?null:oe.copy(K.start).addScaledVector(de,Ie)}intersectsLine(K){const oe=this.distanceToPoint(K.start),de=this.distanceToPoint(K.end);return oe<0&&de>0||de<0&&oe>0}intersectsBox(K){return K.intersectsPlane(this)}intersectsSphere(K){return K.intersectsPlane(this)}coplanarPoint(K){return K.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(K,oe){const de=oe||vl.getNormalMatrix(K),ye=this.coplanarPoint(Su).applyMatrix4(K),Ie=this.normal.applyMatrix3(de).normalize();return this.constant=-ye.dot(Ie),this}translate(K){return this.constant-=K.dot(this.normal),this}equals(K){return K.normal.equals(this.normal)&&K.constant===this.constant}clone(){return new this.constructor().copy(this)}}const El=new la,X0=new vn;class Cc{constructor(K=new ka,oe=new ka,de=new ka,ye=new ka,Ie=new ka,Ue=new ka){this.planes=[K,oe,de,ye,Ie,Ue]}set(K,oe,de,ye,Ie,Ue){const He=this.planes;return He[0].copy(K),He[1].copy(oe),He[2].copy(de),He[3].copy(ye),He[4].copy(Ie),He[5].copy(Ue),this}copy(K){const oe=this.planes;for(let de=0;de<6;de++)oe[de].copy(K.planes[de]);return this}setFromProjectionMatrix(K,oe=j0){const de=this.planes,ye=K.elements,Ie=ye[0],Ue=ye[1],He=ye[2],Ke=ye[3],Ze=ye[4],at=ye[5],mt=ye[6],vt=ye[7],St=ye[8],Lt=ye[9],Ht=ye[10],Dt=ye[11],bt=ye[12],tn=ye[13],Zt=ye[14],qt=ye[15];if(de[0].setComponents(Ke-Ie,vt-Ze,Dt-St,qt-bt).normalize(),de[1].setComponents(Ke+Ie,vt+Ze,Dt+St,qt+bt).normalize(),de[2].setComponents(Ke+Ue,vt+at,Dt+Lt,qt+tn).normalize(),de[3].setComponents(Ke-Ue,vt-at,Dt-Lt,qt-tn).normalize(),de[4].setComponents(Ke-He,vt-mt,Dt-Ht,qt-Zt).normalize(),oe===j0)de[5].setComponents(Ke+He,vt+mt,Dt+Ht,qt+Zt).normalize();else if(oe===oc)de[5].setComponents(He,mt,Ht,Zt).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+oe);return this}intersectsObject(K){if(K.boundingSphere!==void 0)K.boundingSphere===null&&K.computeBoundingSphere(),El.copy(K.boundingSphere).applyMatrix4(K.matrixWorld);else{const oe=K.geometry;oe.boundingSphere===null&&oe.computeBoundingSphere(),El.copy(oe.boundingSphere).applyMatrix4(K.matrixWorld)}return this.intersectsSphere(El)}intersectsSprite(K){return El.center.set(0,0,0),El.radius=.7071067811865476,El.applyMatrix4(K.matrixWorld),this.intersectsSphere(El)}intersectsSphere(K){const oe=this.planes,de=K.center,ye=-K.radius;for(let Ie=0;Ie<6;Ie++)if(oe[Ie].distanceToPoint(de)<ye)return!1;return!0}intersectsBox(K){const oe=this.planes;for(let de=0;de<6;de++){const ye=oe[de];if(X0.x=ye.normal.x>0?K.max.x:K.min.x,X0.y=ye.normal.y>0?K.max.y:K.min.y,X0.z=ye.normal.z>0?K.max.z:K.min.z,ye.distanceToPoint(X0)<0)return!1}return!0}containsPoint(K){const oe=this.planes;for(let de=0;de<6;de++)if(oe[de].distanceToPoint(K)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Mu(){let Be=null,K=!1,oe=null,de=null;function ye(Ie,Ue){oe(Ie,Ue),de=Be.requestAnimationFrame(ye)}return{start:function(){K!==!0&&oe!==null&&(de=Be.requestAnimationFrame(ye),K=!0)},stop:function(){Be.cancelAnimationFrame(de),K=!1},setAnimationLoop:function(Ie){oe=Ie},setContext:function(Ie){Be=Ie}}}function G1(Be){const K=new WeakMap;function oe(He,Ke){const Ze=He.array,at=He.usage,mt=Ze.byteLength,vt=Be.createBuffer();Be.bindBuffer(Ke,vt),Be.bufferData(Ke,Ze,at),He.onUploadCallback();let St;if(Ze instanceof Float32Array)St=Be.FLOAT;else if(Ze instanceof Uint16Array)He.isFloat16BufferAttribute?St=Be.HALF_FLOAT:St=Be.UNSIGNED_SHORT;else if(Ze instanceof Int16Array)St=Be.SHORT;else if(Ze instanceof Uint32Array)St=Be.UNSIGNED_INT;else if(Ze instanceof Int32Array)St=Be.INT;else if(Ze instanceof Int8Array)St=Be.BYTE;else if(Ze instanceof Uint8Array)St=Be.UNSIGNED_BYTE;else if(Ze instanceof Uint8ClampedArray)St=Be.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Ze);return{buffer:vt,type:St,bytesPerElement:Ze.BYTES_PER_ELEMENT,version:He.version,size:mt}}function de(He,Ke,Ze){const at=Ke.array,mt=Ke._updateRange,vt=Ke.updateRanges;if(Be.bindBuffer(Ze,He),mt.count===-1&&vt.length===0&&Be.bufferSubData(Ze,0,at),vt.length!==0){for(let St=0,Lt=vt.length;St<Lt;St++){const Ht=vt[St];Be.bufferSubData(Ze,Ht.start*at.BYTES_PER_ELEMENT,at,Ht.start,Ht.count)}Ke.clearUpdateRanges()}mt.count!==-1&&(Be.bufferSubData(Ze,mt.offset*at.BYTES_PER_ELEMENT,at,mt.offset,mt.count),mt.count=-1),Ke.onUploadCallback()}function ye(He){return He.isInterleavedBufferAttribute&&(He=He.data),K.get(He)}function Ie(He){He.isInterleavedBufferAttribute&&(He=He.data);const Ke=K.get(He);Ke&&(Be.deleteBuffer(Ke.buffer),K.delete(He))}function Ue(He,Ke){if(He.isGLBufferAttribute){const at=K.get(He);(!at||at.version<He.version)&&K.set(He,{buffer:He.buffer,type:He.type,bytesPerElement:He.elementSize,version:He.version});return}He.isInterleavedBufferAttribute&&(He=He.data);const Ze=K.get(He);if(Ze===void 0)K.set(He,oe(He,Ke));else if(Ze.version<He.version){if(Ze.size!==He.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");de(Ze.buffer,He,Ke),Ze.version=He.version}}return{get:ye,remove:Ie,update:Ue}}class ql extends Ds{constructor(K=1,oe=1,de=1,ye=1){super(),this.type="PlaneGeometry",this.parameters={width:K,height:oe,widthSegments:de,heightSegments:ye};const Ie=K/2,Ue=oe/2,He=Math.floor(de),Ke=Math.floor(ye),Ze=He+1,at=Ke+1,mt=K/He,vt=oe/Ke,St=[],Lt=[],Ht=[],Dt=[];for(let bt=0;bt<at;bt++){const tn=bt*vt-Ue;for(let Zt=0;Zt<Ze;Zt++){const qt=Zt*mt-Ie;Lt.push(qt,-tn,0),Ht.push(0,0,1),Dt.push(Zt/He),Dt.push(1-bt/Ke)}}for(let bt=0;bt<Ke;bt++)for(let tn=0;tn<He;tn++){const Zt=tn+Ze*bt,qt=tn+Ze*(bt+1),Un=tn+1+Ze*(bt+1),_n=tn+1+Ze*bt;St.push(Zt,qt,_n),St.push(qt,Un,_n)}this.setIndex(St),this.setAttribute("position",new $i(Lt,3)),this.setAttribute("normal",new $i(Ht,3)),this.setAttribute("uv",new $i(Dt,2))}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new ql(K.width,K.height,K.widthSegments,K.heightSegments)}}var Q1=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,H1=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,V1=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,z1=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,W1=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,bu=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,$1=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Fc=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Wh=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,X1=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,zd=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Wd=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,K1=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Y1=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,q1=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,$d=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,J1=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Z1=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,j1=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,jf=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ef=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,ep=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,tp=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,tf=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,nf=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,rf=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,$h=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,np=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,ip=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,rp=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,yl="gl_FragColor = linearToOutputTexel( gl_FragColor );",Xd=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,Xh=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,sf=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,of=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,af=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Kd=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Tu=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Yd=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,qd=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Jd=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,lf=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,cf=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,uf=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,hf=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,df=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,sp=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,G0=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,T0=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ff=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,pf=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Af=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,mf=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ys=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,qs=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,gf=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Iu=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Zd=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,jd=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,e1=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,iu=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,K0=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Kh=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,xc=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,op=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,vf=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,t1=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,n1=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Ru=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Q0=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,ap=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Yh=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,i1=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Ef=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yf=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,nh=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,A0=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,lp=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,cp=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,qh=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,m0=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,up=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ts=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Bu=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,r1=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Cf=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,hp=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Lu=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Jh=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,s1=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,xf=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,wf=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Sf=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,o1=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,a1=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,s0=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Cl=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Oc=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Mf=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,bf=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,xl=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Tf=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Jl=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,dp=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,If=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Rf=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Bf=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vs={alphahash_fragment:Q1,alphahash_pars_fragment:H1,alphamap_fragment:V1,alphamap_pars_fragment:z1,alphatest_fragment:W1,alphatest_pars_fragment:bu,aomap_fragment:$1,aomap_pars_fragment:Fc,batching_pars_vertex:Wh,batching_vertex:X1,begin_vertex:zd,beginnormal_vertex:Wd,bsdfs:K1,iridescence_fragment:Y1,bumpmap_pars_fragment:q1,clipping_planes_fragment:$d,clipping_planes_pars_fragment:J1,clipping_planes_pars_vertex:Z1,clipping_planes_vertex:j1,color_fragment:jf,color_pars_fragment:ef,color_pars_vertex:ep,color_vertex:tp,common:tf,cube_uv_reflection_fragment:nf,defaultnormal_vertex:rf,displacementmap_pars_vertex:$h,displacementmap_vertex:np,emissivemap_fragment:ip,emissivemap_pars_fragment:rp,colorspace_fragment:yl,colorspace_pars_fragment:Xd,envmap_fragment:Xh,envmap_common_pars_fragment:sf,envmap_pars_fragment:of,envmap_pars_vertex:af,envmap_physical_pars_fragment:sp,envmap_vertex:Kd,fog_vertex:Tu,fog_pars_vertex:Yd,fog_fragment:qd,fog_pars_fragment:Jd,gradientmap_pars_fragment:lf,lightmap_pars_fragment:cf,lights_lambert_fragment:uf,lights_lambert_pars_fragment:hf,lights_pars_begin:df,lights_toon_fragment:G0,lights_toon_pars_fragment:T0,lights_phong_fragment:ff,lights_phong_pars_fragment:pf,lights_physical_fragment:Af,lights_physical_pars_fragment:mf,lights_fragment_begin:Ys,lights_fragment_maps:qs,lights_fragment_end:gf,logdepthbuf_fragment:Iu,logdepthbuf_pars_fragment:Zd,logdepthbuf_pars_vertex:jd,logdepthbuf_vertex:e1,map_fragment:iu,map_pars_fragment:K0,map_particle_fragment:Kh,map_particle_pars_fragment:xc,metalnessmap_fragment:op,metalnessmap_pars_fragment:vf,morphinstance_vertex:t1,morphcolor_vertex:n1,morphnormal_vertex:Ru,morphtarget_pars_vertex:Q0,morphtarget_vertex:ap,normal_fragment_begin:Yh,normal_fragment_maps:i1,normal_pars_fragment:Ef,normal_pars_vertex:yf,normal_vertex:nh,normalmap_pars_fragment:A0,clearcoat_normal_fragment_begin:lp,clearcoat_normal_fragment_maps:cp,clearcoat_pars_fragment:qh,iridescence_pars_fragment:m0,opaque_fragment:up,packing:ts,premultiplied_alpha_fragment:Bu,project_vertex:r1,dithering_fragment:Cf,dithering_pars_fragment:hp,roughnessmap_fragment:Lu,roughnessmap_pars_fragment:Jh,shadowmap_pars_fragment:s1,shadowmap_pars_vertex:xf,shadowmap_vertex:wf,shadowmask_pars_fragment:Sf,skinbase_vertex:o1,skinning_pars_vertex:a1,skinning_vertex:s0,skinnormal_vertex:Cl,specularmap_fragment:Oc,specularmap_pars_fragment:Mf,tonemapping_fragment:bf,tonemapping_pars_fragment:xl,transmission_fragment:Tf,transmission_pars_fragment:Jl,uv_pars_fragment:dp,uv_pars_vertex:If,uv_vertex:Rf,worldpos_vertex:Bf,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Or={common:{diffuse:{value:new Wr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new gs},alphaMap:{value:null},alphaMapTransform:{value:new gs},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new gs}},envmap:{envMap:{value:null},envMapRotation:{value:new gs},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new gs}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new gs}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new gs},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new gs},normalScale:{value:new qi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new gs},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new gs}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new gs}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new gs}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Wr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Wr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new gs},alphaTest:{value:0},uvTransform:{value:new gs}},sprite:{diffuse:{value:new Wr(16777215)},opacity:{value:1},center:{value:new qi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new gs},alphaMap:{value:null},alphaMapTransform:{value:new gs},alphaTest:{value:0}}},I0={basic:{uniforms:r0([Or.common,Or.specularmap,Or.envmap,Or.aomap,Or.lightmap,Or.fog]),vertexShader:vs.meshbasic_vert,fragmentShader:vs.meshbasic_frag},lambert:{uniforms:r0([Or.common,Or.specularmap,Or.envmap,Or.aomap,Or.lightmap,Or.emissivemap,Or.bumpmap,Or.normalmap,Or.displacementmap,Or.fog,Or.lights,{emissive:{value:new Wr(0)}}]),vertexShader:vs.meshlambert_vert,fragmentShader:vs.meshlambert_frag},phong:{uniforms:r0([Or.common,Or.specularmap,Or.envmap,Or.aomap,Or.lightmap,Or.emissivemap,Or.bumpmap,Or.normalmap,Or.displacementmap,Or.fog,Or.lights,{emissive:{value:new Wr(0)},specular:{value:new Wr(1118481)},shininess:{value:30}}]),vertexShader:vs.meshphong_vert,fragmentShader:vs.meshphong_frag},standard:{uniforms:r0([Or.common,Or.envmap,Or.aomap,Or.lightmap,Or.emissivemap,Or.bumpmap,Or.normalmap,Or.displacementmap,Or.roughnessmap,Or.metalnessmap,Or.fog,Or.lights,{emissive:{value:new Wr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:vs.meshphysical_vert,fragmentShader:vs.meshphysical_frag},toon:{uniforms:r0([Or.common,Or.aomap,Or.lightmap,Or.emissivemap,Or.bumpmap,Or.normalmap,Or.displacementmap,Or.gradientmap,Or.fog,Or.lights,{emissive:{value:new Wr(0)}}]),vertexShader:vs.meshtoon_vert,fragmentShader:vs.meshtoon_frag},matcap:{uniforms:r0([Or.common,Or.bumpmap,Or.normalmap,Or.displacementmap,Or.fog,{matcap:{value:null}}]),vertexShader:vs.meshmatcap_vert,fragmentShader:vs.meshmatcap_frag},points:{uniforms:r0([Or.points,Or.fog]),vertexShader:vs.points_vert,fragmentShader:vs.points_frag},dashed:{uniforms:r0([Or.common,Or.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:vs.linedashed_vert,fragmentShader:vs.linedashed_frag},depth:{uniforms:r0([Or.common,Or.displacementmap]),vertexShader:vs.depth_vert,fragmentShader:vs.depth_frag},normal:{uniforms:r0([Or.common,Or.bumpmap,Or.normalmap,Or.displacementmap,{opacity:{value:1}}]),vertexShader:vs.meshnormal_vert,fragmentShader:vs.meshnormal_frag},sprite:{uniforms:r0([Or.sprite,Or.fog]),vertexShader:vs.sprite_vert,fragmentShader:vs.sprite_frag},background:{uniforms:{uvTransform:{value:new gs},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:vs.background_vert,fragmentShader:vs.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new gs}},vertexShader:vs.backgroundCube_vert,fragmentShader:vs.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:vs.cube_vert,fragmentShader:vs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:vs.equirect_vert,fragmentShader:vs.equirect_frag},distanceRGBA:{uniforms:r0([Or.common,Or.displacementmap,{referencePosition:{value:new vn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:vs.distanceRGBA_vert,fragmentShader:vs.distanceRGBA_frag},shadow:{uniforms:r0([Or.lights,Or.fog,{color:{value:new Wr(0)},opacity:{value:1}}]),vertexShader:vs.shadow_vert,fragmentShader:vs.shadow_frag}};I0.physical={uniforms:r0([I0.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new gs},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new gs},clearcoatNormalScale:{value:new qi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new gs},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new gs},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new gs},sheen:{value:0},sheenColor:{value:new Wr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new gs},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new gs},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new gs},transmissionSamplerSize:{value:new qi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new gs},attenuationDistance:{value:0},attenuationColor:{value:new Wr(0)},specularColor:{value:new Wr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new gs},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new gs},anisotropyVector:{value:new qi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new gs}}]),vertexShader:vs.meshphysical_vert,fragmentShader:vs.meshphysical_frag};const Pu={r:0,b:0,g:0},ou=new S0,kc=new kr;function Of(Be,K,oe,de,ye,Ie,Ue){const He=new Wr(0);let Ke=Ie===!0?0:1,Ze,at,mt=null,vt=0,St=null;function Lt(tn){let Zt=tn.isScene===!0?tn.background:null;return Zt&&Zt.isTexture&&(Zt=(tn.backgroundBlurriness>0?oe:K).get(Zt)),Zt}function Ht(tn){let Zt=!1;const qt=Lt(tn);qt===null?bt(He,Ke):qt&&qt.isColor&&(bt(qt,1),Zt=!0);const Un=Be.xr.getEnvironmentBlendMode();Un==="additive"?de.buffers.color.setClear(0,0,0,1,Ue):Un==="alpha-blend"&&de.buffers.color.setClear(0,0,0,0,Ue),(Be.autoClear||Zt)&&Be.clear(Be.autoClearColor,Be.autoClearDepth,Be.autoClearStencil)}function Dt(tn,Zt){const qt=Lt(Zt);qt&&(qt.isCubeTexture||qt.mapping===Wt)?(at===void 0&&(at=new Zo(new il(1e4,1e4,1e4),new k0({name:"BackgroundCubeMaterial",uniforms:nu(I0.backgroundCube.uniforms),vertexShader:I0.backgroundCube.vertexShader,fragmentShader:I0.backgroundCube.fragmentShader,side:Ve,depthTest:!1,depthWrite:!1,fog:!1})),at.geometry.deleteAttribute("normal"),at.geometry.deleteAttribute("uv"),at.onBeforeRender=function(Un,_n,bn){this.matrixWorld.copyPosition(bn.matrixWorld)},Object.defineProperty(at.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),ye.update(at)),ou.copy(Zt.backgroundRotation),ou.x*=-1,ou.y*=-1,ou.z*=-1,qt.isCubeTexture&&qt.isRenderTargetTexture===!1&&(ou.y*=-1,ou.z*=-1),at.material.uniforms.envMap.value=qt,at.material.uniforms.flipEnvMap.value=qt.isCubeTexture&&qt.isRenderTargetTexture===!1?-1:1,at.material.uniforms.backgroundBlurriness.value=Zt.backgroundBlurriness,at.material.uniforms.backgroundIntensity.value=Zt.backgroundIntensity,at.material.uniforms.backgroundRotation.value.setFromMatrix4(kc.makeRotationFromEuler(ou)),at.material.toneMapped=To.getTransfer(qt.colorSpace)!==bo,(mt!==qt||vt!==qt.version||St!==Be.toneMapping)&&(at.material.needsUpdate=!0,mt=qt,vt=qt.version,St=Be.toneMapping),at.layers.enableAll(),tn.unshift(at,at.geometry,at.material,0,0,null)):qt&&qt.isTexture&&(Ze===void 0&&(Ze=new Zo(new ql(2,2),new k0({name:"BackgroundMaterial",uniforms:nu(I0.background.uniforms),vertexShader:I0.background.vertexShader,fragmentShader:I0.background.fragmentShader,side:ke,depthTest:!1,depthWrite:!1,fog:!1})),Ze.geometry.deleteAttribute("normal"),Object.defineProperty(Ze.material,"map",{get:function(){return this.uniforms.t2D.value}}),ye.update(Ze)),Ze.material.uniforms.t2D.value=qt,Ze.material.uniforms.backgroundIntensity.value=Zt.backgroundIntensity,Ze.material.toneMapped=To.getTransfer(qt.colorSpace)!==bo,qt.matrixAutoUpdate===!0&&qt.updateMatrix(),Ze.material.uniforms.uvTransform.value.copy(qt.matrix),(mt!==qt||vt!==qt.version||St!==Be.toneMapping)&&(Ze.material.needsUpdate=!0,mt=qt,vt=qt.version,St=Be.toneMapping),Ze.layers.enableAll(),tn.unshift(Ze,Ze.geometry,Ze.material,0,0,null))}function bt(tn,Zt){tn.getRGB(Pu,eh(Be)),de.buffers.color.setClear(Pu.r,Pu.g,Pu.b,Zt,Ue)}return{getClearColor:function(){return He},setClearColor:function(tn,Zt=1){He.set(tn),Ke=Zt,bt(He,Ke)},getClearAlpha:function(){return Ke},setClearAlpha:function(tn){Ke=tn,bt(He,Ke)},render:Ht,addToRenderList:Dt}}function f1(Be,K){const oe=Be.getParameter(Be.MAX_VERTEX_ATTRIBS),de={},ye=vt(null);let Ie=ye,Ue=!1;function He(cn,On,Zn,Xn,ri){let wi=!1;const Ji=mt(Xn,Zn,On);Ie!==Ji&&(Ie=Ji,Ze(Ie.object)),wi=St(cn,Xn,Zn,ri),wi&&Lt(cn,Xn,Zn,ri),ri!==null&&K.update(ri,Be.ELEMENT_ARRAY_BUFFER),(wi||Ue)&&(Ue=!1,qt(cn,On,Zn,Xn),ri!==null&&Be.bindBuffer(Be.ELEMENT_ARRAY_BUFFER,K.get(ri).buffer))}function Ke(){return Be.createVertexArray()}function Ze(cn){return Be.bindVertexArray(cn)}function at(cn){return Be.deleteVertexArray(cn)}function mt(cn,On,Zn){const Xn=Zn.wireframe===!0;let ri=de[cn.id];ri===void 0&&(ri={},de[cn.id]=ri);let wi=ri[On.id];wi===void 0&&(wi={},ri[On.id]=wi);let Ji=wi[Xn];return Ji===void 0&&(Ji=vt(Ke()),wi[Xn]=Ji),Ji}function vt(cn){const On=[],Zn=[],Xn=[];for(let ri=0;ri<oe;ri++)On[ri]=0,Zn[ri]=0,Xn[ri]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:On,enabledAttributes:Zn,attributeDivisors:Xn,object:cn,attributes:{},index:null}}function St(cn,On,Zn,Xn){const ri=Ie.attributes,wi=On.attributes;let Ji=0;const Dr=Zn.getAttributes();for(const Ri in Dr)if(Dr[Ri].location>=0){const br=ri[Ri];let us=wi[Ri];if(us===void 0&&(Ri==="instanceMatrix"&&cn.instanceMatrix&&(us=cn.instanceMatrix),Ri==="instanceColor"&&cn.instanceColor&&(us=cn.instanceColor)),br===void 0||br.attribute!==us||us&&br.data!==us.data)return!0;Ji++}return Ie.attributesNum!==Ji||Ie.index!==Xn}function Lt(cn,On,Zn,Xn){const ri={},wi=On.attributes;let Ji=0;const Dr=Zn.getAttributes();for(const Ri in Dr)if(Dr[Ri].location>=0){let br=wi[Ri];br===void 0&&(Ri==="instanceMatrix"&&cn.instanceMatrix&&(br=cn.instanceMatrix),Ri==="instanceColor"&&cn.instanceColor&&(br=cn.instanceColor));const us={};us.attribute=br,br&&br.data&&(us.data=br.data),ri[Ri]=us,Ji++}Ie.attributes=ri,Ie.attributesNum=Ji,Ie.index=Xn}function Ht(){const cn=Ie.newAttributes;for(let On=0,Zn=cn.length;On<Zn;On++)cn[On]=0}function Dt(cn){bt(cn,0)}function bt(cn,On){const Zn=Ie.newAttributes,Xn=Ie.enabledAttributes,ri=Ie.attributeDivisors;Zn[cn]=1,Xn[cn]===0&&(Be.enableVertexAttribArray(cn),Xn[cn]=1),ri[cn]!==On&&(Be.vertexAttribDivisor(cn,On),ri[cn]=On)}function tn(){const cn=Ie.newAttributes,On=Ie.enabledAttributes;for(let Zn=0,Xn=On.length;Zn<Xn;Zn++)On[Zn]!==cn[Zn]&&(Be.disableVertexAttribArray(Zn),On[Zn]=0)}function Zt(cn,On,Zn,Xn,ri,wi,Ji){Ji===!0?Be.vertexAttribIPointer(cn,On,Zn,ri,wi):Be.vertexAttribPointer(cn,On,Zn,Xn,ri,wi)}function qt(cn,On,Zn,Xn){Ht();const ri=Xn.attributes,wi=Zn.getAttributes(),Ji=On.defaultAttributeValues;for(const Dr in wi){const Ri=wi[Dr];if(Ri.location>=0){let xr=ri[Dr];if(xr===void 0&&(Dr==="instanceMatrix"&&cn.instanceMatrix&&(xr=cn.instanceMatrix),Dr==="instanceColor"&&cn.instanceColor&&(xr=cn.instanceColor)),xr!==void 0){const br=xr.normalized,us=xr.itemSize,oo=K.get(xr);if(oo===void 0)continue;const Qo=oo.buffer,ha=oo.type,No=oo.bytesPerElement,ea=ha===Be.INT||ha===Be.UNSIGNED_INT||xr.gpuType===l0;if(xr.isInterleavedBufferAttribute){const ps=xr.data,sr=ps.stride,Fr=xr.offset;if(ps.isInstancedInterleavedBuffer){for(let Qr=0;Qr<Ri.locationSize;Qr++)bt(Ri.location+Qr,ps.meshPerAttribute);cn.isInstancedMesh!==!0&&Xn._maxInstanceCount===void 0&&(Xn._maxInstanceCount=ps.meshPerAttribute*ps.count)}else for(let Qr=0;Qr<Ri.locationSize;Qr++)Dt(Ri.location+Qr);Be.bindBuffer(Be.ARRAY_BUFFER,Qo);for(let Qr=0;Qr<Ri.locationSize;Qr++)Zt(Ri.location+Qr,us/Ri.locationSize,ha,br,sr*No,(Fr+us/Ri.locationSize*Qr)*No,ea)}else{if(xr.isInstancedBufferAttribute){for(let ps=0;ps<Ri.locationSize;ps++)bt(Ri.location+ps,xr.meshPerAttribute);cn.isInstancedMesh!==!0&&Xn._maxInstanceCount===void 0&&(Xn._maxInstanceCount=xr.meshPerAttribute*xr.count)}else for(let ps=0;ps<Ri.locationSize;ps++)Dt(Ri.location+ps);Be.bindBuffer(Be.ARRAY_BUFFER,Qo);for(let ps=0;ps<Ri.locationSize;ps++)Zt(Ri.location+ps,us/Ri.locationSize,ha,br,us*No,us/Ri.locationSize*ps*No,ea)}}else if(Ji!==void 0){const br=Ji[Dr];if(br!==void 0)switch(br.length){case 2:Be.vertexAttrib2fv(Ri.location,br);break;case 3:Be.vertexAttrib3fv(Ri.location,br);break;case 4:Be.vertexAttrib4fv(Ri.location,br);break;default:Be.vertexAttrib1fv(Ri.location,br)}}}}tn()}function Un(){Fn();for(const cn in de){const On=de[cn];for(const Zn in On){const Xn=On[Zn];for(const ri in Xn)at(Xn[ri].object),delete Xn[ri];delete On[Zn]}delete de[cn]}}function _n(cn){if(de[cn.id]===void 0)return;const On=de[cn.id];for(const Zn in On){const Xn=On[Zn];for(const ri in Xn)at(Xn[ri].object),delete Xn[ri];delete On[Zn]}delete de[cn.id]}function bn(cn){for(const On in de){const Zn=de[On];if(Zn[cn.id]===void 0)continue;const Xn=Zn[cn.id];for(const ri in Xn)at(Xn[ri].object),delete Xn[ri];delete Zn[cn.id]}}function Fn(){pn(),Ue=!0,Ie!==ye&&(Ie=ye,Ze(Ie.object))}function pn(){ye.geometry=null,ye.program=null,ye.wireframe=!1}return{setup:He,reset:Fn,resetDefaultState:pn,dispose:Un,releaseStatesOfGeometry:_n,releaseStatesOfProgram:bn,initAttributes:Ht,enableAttribute:Dt,disableUnusedAttributes:tn}}function wc(Be,K,oe){let de;function ye(Ze){de=Ze}function Ie(Ze,at){Be.drawArrays(de,Ze,at),oe.update(at,de,1)}function Ue(Ze,at,mt){mt!==0&&(Be.drawArraysInstanced(de,Ze,at,mt),oe.update(at,de,mt))}function He(Ze,at,mt){if(mt===0)return;const vt=K.get("WEBGL_multi_draw");if(vt===null)for(let St=0;St<mt;St++)this.render(Ze[St],at[St]);else{vt.multiDrawArraysWEBGL(de,Ze,0,at,0,mt);let St=0;for(let Lt=0;Lt<mt;Lt++)St+=at[Lt];oe.update(St,de,1)}}function Ke(Ze,at,mt,vt){if(mt===0)return;const St=K.get("WEBGL_multi_draw");if(St===null)for(let Lt=0;Lt<Ze.length;Lt++)Ue(Ze[Lt],at[Lt],vt[Lt]);else{St.multiDrawArraysInstancedWEBGL(de,Ze,0,at,0,vt,0,mt);let Lt=0;for(let Ht=0;Ht<mt;Ht++)Lt+=at[Ht];for(let Ht=0;Ht<vt.length;Ht++)oe.update(Lt,de,vt[Ht])}}this.setMode=ye,this.render=Ie,this.renderInstances=Ue,this.renderMultiDraw=He,this.renderMultiDrawInstances=Ke}function p1(Be,K,oe,de){let ye;function Ie(){if(ye!==void 0)return ye;if(K.has("EXT_texture_filter_anisotropic")===!0){const _n=K.get("EXT_texture_filter_anisotropic");ye=Be.getParameter(_n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else ye=0;return ye}function Ue(_n){return!(_n!==Jt&&de.convert(_n)!==Be.getParameter(Be.IMPLEMENTATION_COLOR_READ_FORMAT))}function He(_n){const bn=_n===Ts&&(K.has("EXT_color_buffer_half_float")||K.has("EXT_color_buffer_float"));return!(_n!==Mo&&de.convert(_n)!==Be.getParameter(Be.IMPLEMENTATION_COLOR_READ_TYPE)&&_n!==ko&&!bn)}function Ke(_n){if(_n==="highp"){if(Be.getShaderPrecisionFormat(Be.VERTEX_SHADER,Be.HIGH_FLOAT).precision>0&&Be.getShaderPrecisionFormat(Be.FRAGMENT_SHADER,Be.HIGH_FLOAT).precision>0)return"highp";_n="mediump"}return _n==="mediump"&&Be.getShaderPrecisionFormat(Be.VERTEX_SHADER,Be.MEDIUM_FLOAT).precision>0&&Be.getShaderPrecisionFormat(Be.FRAGMENT_SHADER,Be.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let Ze=oe.precision!==void 0?oe.precision:"highp";const at=Ke(Ze);at!==Ze&&(console.warn("THREE.WebGLRenderer:",Ze,"not supported, using",at,"instead."),Ze=at);const mt=oe.logarithmicDepthBuffer===!0,vt=Be.getParameter(Be.MAX_TEXTURE_IMAGE_UNITS),St=Be.getParameter(Be.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Lt=Be.getParameter(Be.MAX_TEXTURE_SIZE),Ht=Be.getParameter(Be.MAX_CUBE_MAP_TEXTURE_SIZE),Dt=Be.getParameter(Be.MAX_VERTEX_ATTRIBS),bt=Be.getParameter(Be.MAX_VERTEX_UNIFORM_VECTORS),tn=Be.getParameter(Be.MAX_VARYING_VECTORS),Zt=Be.getParameter(Be.MAX_FRAGMENT_UNIFORM_VECTORS),qt=St>0,Un=Be.getParameter(Be.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:Ie,getMaxPrecision:Ke,textureFormatReadable:Ue,textureTypeReadable:He,precision:Ze,logarithmicDepthBuffer:mt,maxTextures:vt,maxVertexTextures:St,maxTextureSize:Lt,maxCubemapSize:Ht,maxAttributes:Dt,maxVertexUniforms:bt,maxVaryings:tn,maxFragmentUniforms:Zt,vertexTextures:qt,maxSamples:Un}}function au(Be){const K=this;let oe=null,de=0,ye=!1,Ie=!1;const Ue=new ka,He=new gs,Ke={value:null,needsUpdate:!1};this.uniform=Ke,this.numPlanes=0,this.numIntersection=0,this.init=function(mt,vt){const St=mt.length!==0||vt||de!==0||ye;return ye=vt,de=mt.length,St},this.beginShadows=function(){Ie=!0,at(null)},this.endShadows=function(){Ie=!1},this.setGlobalState=function(mt,vt){oe=at(mt,vt,0)},this.setState=function(mt,vt,St){const Lt=mt.clippingPlanes,Ht=mt.clipIntersection,Dt=mt.clipShadows,bt=Be.get(mt);if(!ye||Lt===null||Lt.length===0||Ie&&!Dt)Ie?at(null):Ze();else{const tn=Ie?0:de,Zt=tn*4;let qt=bt.clippingState||null;Ke.value=qt,qt=at(Lt,vt,Zt,St);for(let Un=0;Un!==Zt;++Un)qt[Un]=oe[Un];bt.clippingState=qt,this.numIntersection=Ht?this.numPlanes:0,this.numPlanes+=tn}};function Ze(){Ke.value!==oe&&(Ke.value=oe,Ke.needsUpdate=de>0),K.numPlanes=de,K.numIntersection=0}function at(mt,vt,St,Lt){const Ht=mt!==null?mt.length:0;let Dt=null;if(Ht!==0){if(Dt=Ke.value,Lt!==!0||Dt===null){const bt=St+Ht*4,tn=vt.matrixWorldInverse;He.getNormalMatrix(tn),(Dt===null||Dt.length<bt)&&(Dt=new Float32Array(bt));for(let Zt=0,qt=St;Zt!==Ht;++Zt,qt+=4)Ue.copy(mt[Zt]).applyMatrix4(tn,He),Ue.normal.toArray(Dt,qt),Dt[qt+3]=Ue.constant}Ke.value=Dt,Ke.needsUpdate=!0}return K.numPlanes=Ht,K.numIntersection=0,Dt}}function Nf(Be){let K=new WeakMap;function oe(Ue,He){return He===ot?Ue.mapping=Nt:He===Vt&&(Ue.mapping=ht),Ue}function de(Ue){if(Ue&&Ue.isTexture){const He=Ue.mapping;if(He===ot||He===Vt)if(K.has(Ue)){const Ke=K.get(Ue).texture;return oe(Ke,Ue.mapping)}else{const Ke=Ue.image;if(Ke&&Ke.height>0){const Ze=new th(Ke.height);return Ze.fromEquirectangularTexture(Be,Ue),K.set(Ue,Ze),Ue.addEventListener("dispose",ye),oe(Ze.texture,Ue.mapping)}else return null}}return Ue}function ye(Ue){const He=Ue.target;He.removeEventListener("dispose",ye);const Ke=K.get(He);Ke!==void 0&&(K.delete(He),Ke.dispose())}function Ie(){K=new WeakMap}return{get:de,dispose:Ie}}class sh extends Kl{constructor(K=-1,oe=1,de=1,ye=-1,Ie=.1,Ue=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=K,this.right=oe,this.top=de,this.bottom=ye,this.near=Ie,this.far=Ue,this.updateProjectionMatrix()}copy(K,oe){return super.copy(K,oe),this.left=K.left,this.right=K.right,this.top=K.top,this.bottom=K.bottom,this.near=K.near,this.far=K.far,this.zoom=K.zoom,this.view=K.view===null?null:Object.assign({},K.view),this}setViewOffset(K,oe,de,ye,Ie,Ue){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=K,this.view.fullHeight=oe,this.view.offsetX=de,this.view.offsetY=ye,this.view.width=Ie,this.view.height=Ue,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const K=(this.right-this.left)/(2*this.zoom),oe=(this.top-this.bottom)/(2*this.zoom),de=(this.right+this.left)/2,ye=(this.top+this.bottom)/2;let Ie=de-K,Ue=de+K,He=ye+oe,Ke=ye-oe;if(this.view!==null&&this.view.enabled){const Ze=(this.right-this.left)/this.view.fullWidth/this.zoom,at=(this.top-this.bottom)/this.view.fullHeight/this.zoom;Ie+=Ze*this.view.offsetX,Ue=Ie+Ze*this.view.width,He-=at*this.view.offsetY,Ke=He-at*this.view.height}this.projectionMatrix.makeOrthographic(Ie,Ue,He,Ke,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(K){const oe=super.toJSON(K);return oe.object.zoom=this.zoom,oe.object.left=this.left,oe.object.right=this.right,oe.object.top=this.top,oe.object.bottom=this.bottom,oe.object.near=this.near,oe.object.far=this.far,this.view!==null&&(oe.object.view=Object.assign({},this.view)),oe}}const jl=4,oh=[.125,.215,.35,.446,.526,.582],tc=20,id=new sh,A1=new Wr;let ah=null,Sc=0,o0=0,ii=!1;const Bo=(1+Math.sqrt(5))/2,Bs=1/Bo,nc=[new vn(-Bo,Bs,0),new vn(Bo,Bs,0),new vn(-Bs,0,Bo),new vn(Bs,0,Bo),new vn(0,Bo,-Bs),new vn(0,Bo,Bs),new vn(-1,1,-1),new vn(1,1,-1),new vn(-1,1,1),new vn(1,1,1)];class Ko{constructor(K){this._renderer=K,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(K,oe=0,de=.1,ye=100){ah=this._renderer.getRenderTarget(),Sc=this._renderer.getActiveCubeFace(),o0=this._renderer.getActiveMipmapLevel(),ii=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const Ie=this._allocateTargets();return Ie.depthBuffer=!0,this._sceneToCubeUV(K,de,ye,Ie),oe>0&&this._blur(Ie,0,0,oe),this._applyPMREM(Ie),this._cleanup(Ie),Ie}fromEquirectangular(K,oe=null){return this._fromTexture(K,oe)}fromCubemap(K,oe=null){return this._fromTexture(K,oe)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=E0(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Ap(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(K){this._lodMax=Math.floor(Math.log2(K)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let K=0;K<this._lodPlanes.length;K++)this._lodPlanes[K].dispose()}_cleanup(K){this._renderer.setRenderTarget(ah,Sc,o0),this._renderer.xr.enabled=ii,K.scissorTest=!1,lh(K,0,0,K.width,K.height)}_fromTexture(K,oe){K.mapping===Nt||K.mapping===ht?this._setSize(K.image.length===0?16:K.image[0].width||K.image[0].image.width):this._setSize(K.image.width/4),ah=this._renderer.getRenderTarget(),Sc=this._renderer.getActiveCubeFace(),o0=this._renderer.getActiveMipmapLevel(),ii=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const de=oe||this._allocateTargets();return this._textureToCubeUV(K,de),this._applyPMREM(de),this._cleanup(de),de}_allocateTargets(){const K=3*Math.max(this._cubeSize,112),oe=4*this._cubeSize,de={magFilter:Jr,minFilter:Jr,generateMipmaps:!1,type:Ts,format:Jt,colorSpace:za,depthBuffer:!1},ye=m1(K,oe,de);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==K||this._pingPongRenderTarget.height!==oe){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=m1(K,oe,de);const{_lodMax:Ie}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Qp(Ie)),this._blurMaterial=pp(Ie,K,oe)}return ye}_compileMaterial(K){const oe=new Zo(this._lodPlanes[0],K);this._renderer.compile(oe,id)}_sceneToCubeUV(K,oe,de,ye){const He=new jo(90,1,oe,de),Ke=[1,-1,1,1,1,1],Ze=[1,1,1,-1,-1,-1],at=this._renderer,mt=at.autoClear,vt=at.toneMapping;at.getClearColor(A1),at.toneMapping=yi,at.autoClear=!1;const St=new Io({name:"PMREM.Background",side:Ve,depthWrite:!1,depthTest:!1}),Lt=new Zo(new il,St);let Ht=!1;const Dt=K.background;Dt?Dt.isColor&&(St.color.copy(Dt),K.background=null,Ht=!0):(St.color.copy(A1),Ht=!0);for(let bt=0;bt<6;bt++){const tn=bt%3;tn===0?(He.up.set(0,Ke[bt],0),He.lookAt(Ze[bt],0,0)):tn===1?(He.up.set(0,0,Ke[bt]),He.lookAt(0,Ze[bt],0)):(He.up.set(0,Ke[bt],0),He.lookAt(0,0,Ze[bt]));const Zt=this._cubeSize;lh(ye,tn*Zt,bt>2?Zt:0,Zt,Zt),at.setRenderTarget(ye),Ht&&at.render(Lt,He),at.render(K,He)}Lt.geometry.dispose(),Lt.material.dispose(),at.toneMapping=vt,at.autoClear=mt,K.background=Dt}_textureToCubeUV(K,oe){const de=this._renderer,ye=K.mapping===Nt||K.mapping===ht;ye?(this._cubemapMaterial===null&&(this._cubemapMaterial=E0()),this._cubemapMaterial.uniforms.flipEnvMap.value=K.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Ap());const Ie=ye?this._cubemapMaterial:this._equirectMaterial,Ue=new Zo(this._lodPlanes[0],Ie),He=Ie.uniforms;He.envMap.value=K;const Ke=this._cubeSize;lh(oe,0,0,3*Ke,2*Ke),de.setRenderTarget(oe),de.render(Ue,id)}_applyPMREM(K){const oe=this._renderer,de=oe.autoClear;oe.autoClear=!1;const ye=this._lodPlanes.length;for(let Ie=1;Ie<ye;Ie++){const Ue=Math.sqrt(this._sigmas[Ie]*this._sigmas[Ie]-this._sigmas[Ie-1]*this._sigmas[Ie-1]),He=nc[(ye-Ie-1)%nc.length];this._blur(K,Ie-1,Ie,Ue,He)}oe.autoClear=de}_blur(K,oe,de,ye,Ie){const Ue=this._pingPongRenderTarget;this._halfBlur(K,Ue,oe,de,ye,"latitudinal",Ie),this._halfBlur(Ue,K,de,de,ye,"longitudinal",Ie)}_halfBlur(K,oe,de,ye,Ie,Ue,He){const Ke=this._renderer,Ze=this._blurMaterial;Ue!=="latitudinal"&&Ue!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const at=3,mt=new Zo(this._lodPlanes[ye],Ze),vt=Ze.uniforms,St=this._sizeLods[de]-1,Lt=isFinite(Ie)?Math.PI/(2*St):2*Math.PI/(2*tc-1),Ht=Ie/Lt,Dt=isFinite(Ie)?1+Math.floor(at*Ht):tc;Dt>tc&&console.warn(`sigmaRadians, ${Ie}, is too large and will clip, as it requested ${Dt} samples when the maximum is set to ${tc}`);const bt=[];let tn=0;for(let bn=0;bn<tc;++bn){const Fn=bn/Ht,pn=Math.exp(-Fn*Fn/2);bt.push(pn),bn===0?tn+=pn:bn<Dt&&(tn+=2*pn)}for(let bn=0;bn<bt.length;bn++)bt[bn]=bt[bn]/tn;vt.envMap.value=K.texture,vt.samples.value=Dt,vt.weights.value=bt,vt.latitudinal.value=Ue==="latitudinal",He&&(vt.poleAxis.value=He);const{_lodMax:Zt}=this;vt.dTheta.value=Lt,vt.mipInt.value=Zt-de;const qt=this._sizeLods[ye],Un=3*qt*(ye>Zt-jl?ye-Zt+jl:0),_n=4*(this._cubeSize-qt);lh(oe,Un,_n,3*qt,2*qt),Ke.setRenderTarget(oe),Ke.render(mt,id)}}function Qp(Be){const K=[],oe=[],de=[];let ye=Be;const Ie=Be-jl+1+oh.length;for(let Ue=0;Ue<Ie;Ue++){const He=Math.pow(2,ye);oe.push(He);let Ke=1/He;Ue>Be-jl?Ke=oh[Ue-Be+jl-1]:Ue===0&&(Ke=0),de.push(Ke);const Ze=1/(He-2),at=-Ze,mt=1+Ze,vt=[at,at,mt,at,mt,mt,at,at,mt,mt,at,mt],St=6,Lt=6,Ht=3,Dt=2,bt=1,tn=new Float32Array(Ht*Lt*St),Zt=new Float32Array(Dt*Lt*St),qt=new Float32Array(bt*Lt*St);for(let _n=0;_n<St;_n++){const bn=_n%3*2/3-1,Fn=_n>2?0:-1,pn=[bn,Fn,0,bn+2/3,Fn,0,bn+2/3,Fn+1,0,bn,Fn,0,bn+2/3,Fn+1,0,bn,Fn+1,0];tn.set(pn,Ht*Lt*_n),Zt.set(vt,Dt*Lt*_n);const cn=[_n,_n,_n,_n,_n,_n];qt.set(cn,bt*Lt*_n)}const Un=new Ds;Un.setAttribute("position",new So(tn,Ht)),Un.setAttribute("uv",new So(Zt,Dt)),Un.setAttribute("faceIndex",new So(qt,bt)),K.push(Un),ye>jl&&ye--}return{lodPlanes:K,sizeLods:oe,sigmas:de}}function m1(Be,K,oe){const de=new ga(Be,K,oe);return de.texture.mapping=Wt,de.texture.name="PMREM.cubeUv",de.scissorTest=!0,de}function lh(Be,K,oe,de,ye){Be.viewport.set(K,oe,de,ye),Be.scissor.set(K,oe,de,ye)}function pp(Be,K,oe){const de=new Float32Array(tc),ye=new vn(0,1,0);return new k0({name:"SphericalGaussianBlur",defines:{n:tc,CUBEUV_TEXEL_WIDTH:1/K,CUBEUV_TEXEL_HEIGHT:1/oe,CUBEUV_MAX_MIP:`${Be}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:de},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:ye}},vertexShader:Gc(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$e,depthTest:!1,depthWrite:!1})}function Ap(){return new k0({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Gc(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$e,depthTest:!1,depthWrite:!1})}function E0(){return new k0({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Gc(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$e,depthTest:!1,depthWrite:!1})}function Gc(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function g1(Be){let K=new WeakMap,oe=null;function de(He){if(He&&He.isTexture){const Ke=He.mapping,Ze=Ke===ot||Ke===Vt,at=Ke===Nt||Ke===ht;if(Ze||at){let mt=K.get(He);const vt=mt!==void 0?mt.texture.pmremVersion:0;if(He.isRenderTargetTexture&&He.pmremVersion!==vt)return oe===null&&(oe=new Ko(Be)),mt=Ze?oe.fromEquirectangular(He,mt):oe.fromCubemap(He,mt),mt.texture.pmremVersion=He.pmremVersion,K.set(He,mt),mt.texture;if(mt!==void 0)return mt.texture;{const St=He.image;return Ze&&St&&St.height>0||at&&St&&ye(St)?(oe===null&&(oe=new Ko(Be)),mt=Ze?oe.fromEquirectangular(He):oe.fromCubemap(He),mt.texture.pmremVersion=He.pmremVersion,K.set(He,mt),He.addEventListener("dispose",Ie),mt.texture):null}}}return He}function ye(He){let Ke=0;const Ze=6;for(let at=0;at<Ze;at++)He[at]!==void 0&&Ke++;return Ke===Ze}function Ie(He){const Ke=He.target;Ke.removeEventListener("dispose",Ie);const Ze=K.get(Ke);Ze!==void 0&&(K.delete(Ke),Ze.dispose())}function Ue(){K=new WeakMap,oe!==null&&(oe.dispose(),oe=null)}return{get:de,dispose:Ue}}function Sl(Be){const K={};function oe(de){if(K[de]!==void 0)return K[de];let ye;switch(de){case"WEBGL_depth_texture":ye=Be.getExtension("WEBGL_depth_texture")||Be.getExtension("MOZ_WEBGL_depth_texture")||Be.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":ye=Be.getExtension("EXT_texture_filter_anisotropic")||Be.getExtension("MOZ_EXT_texture_filter_anisotropic")||Be.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":ye=Be.getExtension("WEBGL_compressed_texture_s3tc")||Be.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||Be.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":ye=Be.getExtension("WEBGL_compressed_texture_pvrtc")||Be.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:ye=Be.getExtension(de)}return K[de]=ye,ye}return{has:function(de){return oe(de)!==null},init:function(){oe("EXT_color_buffer_float"),oe("WEBGL_clip_cull_distance"),oe("OES_texture_float_linear"),oe("EXT_color_buffer_half_float"),oe("WEBGL_multisampled_render_to_texture"),oe("WEBGL_render_shared_exponent")},get:function(de){const ye=oe(de);return ye===null&&console.warn("THREE.WebGLRenderer: "+de+" extension not supported."),ye}}}function rd(Be,K,oe,de){const ye={},Ie=new WeakMap;function Ue(mt){const vt=mt.target;vt.index!==null&&K.remove(vt.index);for(const Lt in vt.attributes)K.remove(vt.attributes[Lt]);for(const Lt in vt.morphAttributes){const Ht=vt.morphAttributes[Lt];for(let Dt=0,bt=Ht.length;Dt<bt;Dt++)K.remove(Ht[Dt])}vt.removeEventListener("dispose",Ue),delete ye[vt.id];const St=Ie.get(vt);St&&(K.remove(St),Ie.delete(vt)),de.releaseStatesOfGeometry(vt),vt.isInstancedBufferGeometry===!0&&delete vt._maxInstanceCount,oe.memory.geometries--}function He(mt,vt){return ye[vt.id]===!0||(vt.addEventListener("dispose",Ue),ye[vt.id]=!0,oe.memory.geometries++),vt}function Ke(mt){const vt=mt.attributes;for(const Lt in vt)K.update(vt[Lt],Be.ARRAY_BUFFER);const St=mt.morphAttributes;for(const Lt in St){const Ht=St[Lt];for(let Dt=0,bt=Ht.length;Dt<bt;Dt++)K.update(Ht[Dt],Be.ARRAY_BUFFER)}}function Ze(mt){const vt=[],St=mt.index,Lt=mt.attributes.position;let Ht=0;if(St!==null){const tn=St.array;Ht=St.version;for(let Zt=0,qt=tn.length;Zt<qt;Zt+=3){const Un=tn[Zt+0],_n=tn[Zt+1],bn=tn[Zt+2];vt.push(Un,_n,_n,bn,bn,Un)}}else if(Lt!==void 0){const tn=Lt.array;Ht=Lt.version;for(let Zt=0,qt=tn.length/3-1;Zt<qt;Zt+=3){const Un=Zt+0,_n=Zt+1,bn=Zt+2;vt.push(Un,_n,_n,bn,bn,Un)}}else return;const Dt=new(Au(vt)?vc:Cu)(vt,1);Dt.version=Ht;const bt=Ie.get(mt);bt&&K.remove(bt),Ie.set(mt,Dt)}function at(mt){const vt=Ie.get(mt);if(vt){const St=mt.index;St!==null&&vt.version<St.version&&Ze(mt)}else Ze(mt);return Ie.get(mt)}return{get:He,update:Ke,getWireframeAttribute:at}}function lu(Be,K,oe){let de;function ye(vt){de=vt}let Ie,Ue;function He(vt){Ie=vt.type,Ue=vt.bytesPerElement}function Ke(vt,St){Be.drawElements(de,St,Ie,vt*Ue),oe.update(St,de,1)}function Ze(vt,St,Lt){Lt!==0&&(Be.drawElementsInstanced(de,St,Ie,vt*Ue,Lt),oe.update(St,de,Lt))}function at(vt,St,Lt){if(Lt===0)return;const Ht=K.get("WEBGL_multi_draw");if(Ht===null)for(let Dt=0;Dt<Lt;Dt++)this.render(vt[Dt]/Ue,St[Dt]);else{Ht.multiDrawElementsWEBGL(de,St,0,Ie,vt,0,Lt);let Dt=0;for(let bt=0;bt<Lt;bt++)Dt+=St[bt];oe.update(Dt,de,1)}}function mt(vt,St,Lt,Ht){if(Lt===0)return;const Dt=K.get("WEBGL_multi_draw");if(Dt===null)for(let bt=0;bt<vt.length;bt++)Ze(vt[bt]/Ue,St[bt],Ht[bt]);else{Dt.multiDrawElementsInstancedWEBGL(de,St,0,Ie,vt,0,Ht,0,Lt);let bt=0;for(let tn=0;tn<Lt;tn++)bt+=St[tn];for(let tn=0;tn<Ht.length;tn++)oe.update(bt,de,Ht[tn])}}this.setMode=ye,this.setIndex=He,this.render=Ke,this.renderInstances=Ze,this.renderMultiDraw=at,this.renderMultiDrawInstances=mt}function sd(Be){const K={geometries:0,textures:0},oe={frame:0,calls:0,triangles:0,points:0,lines:0};function de(Ie,Ue,He){switch(oe.calls++,Ue){case Be.TRIANGLES:oe.triangles+=He*(Ie/3);break;case Be.LINES:oe.lines+=He*(Ie/2);break;case Be.LINE_STRIP:oe.lines+=He*(Ie-1);break;case Be.LINE_LOOP:oe.lines+=He*Ie;break;case Be.POINTS:oe.points+=He*Ie;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",Ue);break}}function ye(){oe.calls=0,oe.triangles=0,oe.points=0,oe.lines=0}return{memory:K,render:oe,programs:null,autoReset:!0,reset:ye,update:de}}function v1(Be,K,oe){const de=new WeakMap,ye=new go;function Ie(Ue,He,Ke){const Ze=Ue.morphTargetInfluences,at=He.morphAttributes.position||He.morphAttributes.normal||He.morphAttributes.color,mt=at!==void 0?at.length:0;let vt=de.get(He);if(vt===void 0||vt.count!==mt){let St=function(){Fn.dispose(),de.delete(He),He.removeEventListener("dispose",St)};vt!==void 0&&vt.texture.dispose();const Lt=He.morphAttributes.position!==void 0,Ht=He.morphAttributes.normal!==void 0,Dt=He.morphAttributes.color!==void 0,bt=He.morphAttributes.position||[],tn=He.morphAttributes.normal||[],Zt=He.morphAttributes.color||[];let qt=0;Lt===!0&&(qt=1),Ht===!0&&(qt=2),Dt===!0&&(qt=3);let Un=He.attributes.position.count*qt,_n=1;Un>K.maxTextureSize&&(_n=Math.ceil(Un/K.maxTextureSize),Un=K.maxTextureSize);const bn=new Float32Array(Un*_n*4*mt),Fn=new Rc(bn,Un,_n,mt);Fn.type=ko,Fn.needsUpdate=!0;const pn=qt*4;for(let cn=0;cn<mt;cn++){const On=bt[cn],Zn=tn[cn],Xn=Zt[cn],ri=Un*_n*4*cn;for(let wi=0;wi<On.count;wi++){const Ji=wi*pn;Lt===!0&&(ye.fromBufferAttribute(On,wi),bn[ri+Ji+0]=ye.x,bn[ri+Ji+1]=ye.y,bn[ri+Ji+2]=ye.z,bn[ri+Ji+3]=0),Ht===!0&&(ye.fromBufferAttribute(Zn,wi),bn[ri+Ji+4]=ye.x,bn[ri+Ji+5]=ye.y,bn[ri+Ji+6]=ye.z,bn[ri+Ji+7]=0),Dt===!0&&(ye.fromBufferAttribute(Xn,wi),bn[ri+Ji+8]=ye.x,bn[ri+Ji+9]=ye.y,bn[ri+Ji+10]=ye.z,bn[ri+Ji+11]=Xn.itemSize===4?ye.w:1)}}vt={count:mt,texture:Fn,size:new qi(Un,_n)},de.set(He,vt),He.addEventListener("dispose",St)}if(Ue.isInstancedMesh===!0&&Ue.morphTexture!==null)Ke.getUniforms().setValue(Be,"morphTexture",Ue.morphTexture,oe);else{let St=0;for(let Ht=0;Ht<Ze.length;Ht++)St+=Ze[Ht];const Lt=He.morphTargetsRelative?1:1-St;Ke.getUniforms().setValue(Be,"morphTargetBaseInfluence",Lt),Ke.getUniforms().setValue(Be,"morphTargetInfluences",Ze)}Ke.getUniforms().setValue(Be,"morphTargetsTexture",vt.texture,oe),Ke.getUniforms().setValue(Be,"morphTargetsTextureSize",vt.size)}return{update:Ie}}class E1{constructor(K,oe,de){if(this.renderer=K,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=de,this.extensions=oe,this.available=this.extensions.has("OCULUS_multiview"),this.available){const Ie=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(Ie.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var ye=0;ye<this.maxNumViews;ye++)this.mat4[ye]=new kr,this.mat3[ye]=new gs}}getCameraArray(K){return K.isArrayCamera?K.cameras:(this.cameraArray[0]=K,this.cameraArray)}updateCameraProjectionMatricesUniform(K,oe){for(var de=this.getCameraArray(K),ye=0;ye<de.length;ye++)this.mat4[ye].copy(de[ye].projectionMatrix);oe.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(K,oe){for(var de=this.getCameraArray(K),ye=0;ye<de.length;ye++)this.mat4[ye].copy(de[ye].matrixWorldInverse);oe.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(K,oe,de){for(var ye=this.getCameraArray(oe),Ie=0;Ie<ye.length;Ie++)this.mat4[Ie].multiplyMatrices(ye[Ie].matrixWorldInverse,K.matrixWorld),this.mat3[Ie].getNormalMatrix(this.mat4[Ie]);de.setValue(this.gl,"modelViewMatrices",this.mat4),de.setValue(this.gl,"normalMatrices",this.mat3)}}function mp(Be,K,oe,de){let ye=new WeakMap;function Ie(Ke){const Ze=de.render.frame,at=Ke.geometry,mt=K.get(Ke,at);if(ye.get(mt)!==Ze&&(K.update(mt),ye.set(mt,Ze)),Ke.isInstancedMesh&&(Ke.hasEventListener("dispose",He)===!1&&Ke.addEventListener("dispose",He),ye.get(Ke)!==Ze&&(oe.update(Ke.instanceMatrix,Be.ARRAY_BUFFER),Ke.instanceColor!==null&&oe.update(Ke.instanceColor,Be.ARRAY_BUFFER),ye.set(Ke,Ze))),Ke.isSkinnedMesh){const vt=Ke.skeleton;ye.get(vt)!==Ze&&(vt.update(),ye.set(vt,Ze))}return mt}function Ue(){ye=new WeakMap}function He(Ke){const Ze=Ke.target;Ze.removeEventListener("dispose",He),oe.remove(Ze.instanceMatrix),Ze.instanceColor!==null&&oe.remove(Ze.instanceColor)}return{update:Ie,dispose:Ue}}class ch extends Fo{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at){if(at=at!==void 0?at:Dn,at!==Dn&&at!==jn)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");de===void 0&&at===Dn&&(de=Ra),de===void 0&&at===jn&&(de=dn),super(null,ye,Ie,Ue,He,Ke,at,de,Ze),this.isDepthTexture=!0,this.image={width:K,height:oe},this.magFilter=He!==void 0?He:ki,this.minFilter=Ke!==void 0?Ke:ki,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(K){return super.copy(K),this.compareFunction=K.compareFunction,this}toJSON(K){const oe=super.toJSON(K);return this.compareFunction!==null&&(oe.compareFunction=this.compareFunction),oe}}const Uf=new Fo,_1=new ch(1,1);_1.compareFunction=du;const y1=new Rc,uh=new Fs,hh=new ba,C1=[],od=[],x1=new Float32Array(16),ad=new Float32Array(9),dh=new Float32Array(4);function Qc(Be,K,oe){const de=Be[0];if(de<=0||de>0)return Be;const ye=K*oe;let Ie=C1[ye];if(Ie===void 0&&(Ie=new Float32Array(ye),C1[ye]=Ie),K!==0){de.toArray(Ie,0);for(let Ue=1,He=0;Ue!==K;++Ue)He+=oe,Be[Ue].toArray(Ie,He)}return Ie}function ca(Be,K){if(Be.length!==K.length)return!1;for(let oe=0,de=Be.length;oe<de;oe++)if(Be[oe]!==K[oe])return!1;return!0}function Ta(Be,K){for(let oe=0,de=K.length;oe<de;oe++)Be[oe]=K[oe]}function ld(Be,K){let oe=od[K];oe===void 0&&(oe=new Int32Array(K),od[K]=oe);for(let de=0;de!==K;++de)oe[de]=Be.allocateTextureUnit();return oe}function cd(Be,K){const oe=this.cache;oe[0]!==K&&(Be.uniform1f(this.addr,K),oe[0]=K)}function kf(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y)&&(Be.uniform2f(this.addr,K.x,K.y),oe[0]=K.x,oe[1]=K.y);else{if(ca(oe,K))return;Be.uniform2fv(this.addr,K),Ta(oe,K)}}function fh(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y||oe[2]!==K.z)&&(Be.uniform3f(this.addr,K.x,K.y,K.z),oe[0]=K.x,oe[1]=K.y,oe[2]=K.z);else if(K.r!==void 0)(oe[0]!==K.r||oe[1]!==K.g||oe[2]!==K.b)&&(Be.uniform3f(this.addr,K.r,K.g,K.b),oe[0]=K.r,oe[1]=K.g,oe[2]=K.b);else{if(ca(oe,K))return;Be.uniform3fv(this.addr,K),Ta(oe,K)}}function _0(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y||oe[2]!==K.z||oe[3]!==K.w)&&(Be.uniform4f(this.addr,K.x,K.y,K.z,K.w),oe[0]=K.x,oe[1]=K.y,oe[2]=K.z,oe[3]=K.w);else{if(ca(oe,K))return;Be.uniform4fv(this.addr,K),Ta(oe,K)}}function ud(Be,K){const oe=this.cache,de=K.elements;if(de===void 0){if(ca(oe,K))return;Be.uniformMatrix2fv(this.addr,!1,K),Ta(oe,K)}else{if(ca(oe,de))return;dh.set(de),Be.uniformMatrix2fv(this.addr,!1,dh),Ta(oe,de)}}function Ee(Be,K){const oe=this.cache,de=K.elements;if(de===void 0){if(ca(oe,K))return;Be.uniformMatrix3fv(this.addr,!1,K),Ta(oe,K)}else{if(ca(oe,de))return;ad.set(de),Be.uniformMatrix3fv(this.addr,!1,ad),Ta(oe,de)}}function Se(Be,K){const oe=this.cache,de=K.elements;if(de===void 0){if(ca(oe,K))return;Be.uniformMatrix4fv(this.addr,!1,K),Ta(oe,K)}else{if(ca(oe,de))return;x1.set(de),Be.uniformMatrix4fv(this.addr,!1,x1),Ta(oe,de)}}function Ge(Be,K){const oe=this.cache;oe[0]!==K&&(Be.uniform1i(this.addr,K),oe[0]=K)}function nt(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y)&&(Be.uniform2i(this.addr,K.x,K.y),oe[0]=K.x,oe[1]=K.y);else{if(ca(oe,K))return;Be.uniform2iv(this.addr,K),Ta(oe,K)}}function gt(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y||oe[2]!==K.z)&&(Be.uniform3i(this.addr,K.x,K.y,K.z),oe[0]=K.x,oe[1]=K.y,oe[2]=K.z);else{if(ca(oe,K))return;Be.uniform3iv(this.addr,K),Ta(oe,K)}}function Pt(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y||oe[2]!==K.z||oe[3]!==K.w)&&(Be.uniform4i(this.addr,K.x,K.y,K.z,K.w),oe[0]=K.x,oe[1]=K.y,oe[2]=K.z,oe[3]=K.w);else{if(ca(oe,K))return;Be.uniform4iv(this.addr,K),Ta(oe,K)}}function en(Be,K){const oe=this.cache;oe[0]!==K&&(Be.uniform1ui(this.addr,K),oe[0]=K)}function Tn(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y)&&(Be.uniform2ui(this.addr,K.x,K.y),oe[0]=K.x,oe[1]=K.y);else{if(ca(oe,K))return;Be.uniform2uiv(this.addr,K),Ta(oe,K)}}function Hn(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y||oe[2]!==K.z)&&(Be.uniform3ui(this.addr,K.x,K.y,K.z),oe[0]=K.x,oe[1]=K.y,oe[2]=K.z);else{if(ca(oe,K))return;Be.uniform3uiv(this.addr,K),Ta(oe,K)}}function Ei(Be,K){const oe=this.cache;if(K.x!==void 0)(oe[0]!==K.x||oe[1]!==K.y||oe[2]!==K.z||oe[3]!==K.w)&&(Be.uniform4ui(this.addr,K.x,K.y,K.z,K.w),oe[0]=K.x,oe[1]=K.y,oe[2]=K.z,oe[3]=K.w);else{if(ca(oe,K))return;Be.uniform4uiv(this.addr,K),Ta(oe,K)}}function ur(Be,K,oe){const de=this.cache,ye=oe.allocateTextureUnit();de[0]!==ye&&(Be.uniform1i(this.addr,ye),de[0]=ye);const Ie=this.type===Be.SAMPLER_2D_SHADOW?_1:Uf;oe.setTexture2D(K||Ie,ye)}function pr(Be,K,oe){const de=this.cache,ye=oe.allocateTextureUnit();de[0]!==ye&&(Be.uniform1i(this.addr,ye),de[0]=ye),oe.setTexture3D(K||uh,ye)}function rr(Be,K,oe){const de=this.cache,ye=oe.allocateTextureUnit();de[0]!==ye&&(Be.uniform1i(this.addr,ye),de[0]=ye),oe.setTextureCube(K||hh,ye)}function Hr(Be,K,oe){const de=this.cache,ye=oe.allocateTextureUnit();de[0]!==ye&&(Be.uniform1i(this.addr,ye),de[0]=ye),oe.setTexture2DArray(K||y1,ye)}function Zr(Be){switch(Be){case 5126:return cd;case 35664:return kf;case 35665:return fh;case 35666:return _0;case 35674:return ud;case 35675:return Ee;case 35676:return Se;case 5124:case 35670:return Ge;case 35667:case 35671:return nt;case 35668:case 35672:return gt;case 35669:case 35673:return Pt;case 5125:return en;case 36294:return Tn;case 36295:return Hn;case 36296:return Ei;case 35678:case 36198:case 36298:case 36306:case 35682:return ur;case 35679:case 36299:case 36307:return pr;case 35680:case 36300:case 36308:case 36293:return rr;case 36289:case 36303:case 36311:case 36292:return Hr}}function cs(Be,K){Be.uniform1fv(this.addr,K)}function ua(Be,K){const oe=Qc(K,this.size,2);Be.uniform2fv(this.addr,oe)}function li(Be,K){const oe=Qc(K,this.size,3);Be.uniform3fv(this.addr,oe)}function $n(Be,K){const oe=Qc(K,this.size,4);Be.uniform4fv(this.addr,oe)}function ui(Be,K){const oe=Qc(K,this.size,4);Be.uniformMatrix2fv(this.addr,!1,oe)}function dr(Be,K){const oe=Qc(K,this.size,9);Be.uniformMatrix3fv(this.addr,!1,oe)}function ls(Be,K){const oe=Qc(K,this.size,16);Be.uniformMatrix4fv(this.addr,!1,oe)}function W(Be,K){Be.uniform1iv(this.addr,K)}function q(Be,K){Be.uniform2iv(this.addr,K)}function j(Be,K){Be.uniform3iv(this.addr,K)}function X(Be,K){Be.uniform4iv(this.addr,K)}function G(Be,K){Be.uniform1uiv(this.addr,K)}function O(Be,K){Be.uniform2uiv(this.addr,K)}function ee(Be,K){Be.uniform3uiv(this.addr,K)}function J(Be,K){Be.uniform4uiv(this.addr,K)}function le(Be,K,oe){const de=this.cache,ye=K.length,Ie=ld(oe,ye);ca(de,Ie)||(Be.uniform1iv(this.addr,Ie),Ta(de,Ie));for(let Ue=0;Ue!==ye;++Ue)oe.setTexture2D(K[Ue]||Uf,Ie[Ue])}function ce(Be,K,oe){const de=this.cache,ye=K.length,Ie=ld(oe,ye);ca(de,Ie)||(Be.uniform1iv(this.addr,Ie),Ta(de,Ie));for(let Ue=0;Ue!==ye;++Ue)oe.setTexture3D(K[Ue]||uh,Ie[Ue])}function he(Be,K,oe){const de=this.cache,ye=K.length,Ie=ld(oe,ye);ca(de,Ie)||(Be.uniform1iv(this.addr,Ie),Ta(de,Ie));for(let Ue=0;Ue!==ye;++Ue)oe.setTextureCube(K[Ue]||hh,Ie[Ue])}function Ce(Be,K,oe){const de=this.cache,ye=K.length,Ie=ld(oe,ye);ca(de,Ie)||(Be.uniform1iv(this.addr,Ie),Ta(de,Ie));for(let Ue=0;Ue!==ye;++Ue)oe.setTexture2DArray(K[Ue]||y1,Ie[Ue])}function De(Be){switch(Be){case 5126:return cs;case 35664:return ua;case 35665:return li;case 35666:return $n;case 35674:return ui;case 35675:return dr;case 35676:return ls;case 5124:case 35670:return W;case 35667:case 35671:return q;case 35668:case 35672:return j;case 35669:case 35673:return X;case 5125:return G;case 36294:return O;case 36295:return ee;case 36296:return J;case 35678:case 36198:case 36298:case 36306:case 35682:return le;case 35679:case 36299:case 36307:return ce;case 35680:case 36300:case 36308:case 36293:return he;case 36289:case 36303:case 36311:case 36292:return Ce}}class Qe{constructor(K,oe,de){this.id=K,this.addr=de,this.cache=[],this.type=oe.type,this.setValue=Zr(oe.type)}}class We{constructor(K,oe,de){this.id=K,this.addr=de,this.cache=[],this.type=oe.type,this.size=oe.size,this.setValue=De(oe.type)}}class pt{constructor(K){this.id=K,this.seq=[],this.map={}}setValue(K,oe,de){const ye=this.seq;for(let Ie=0,Ue=ye.length;Ie!==Ue;++Ie){const He=ye[Ie];He.setValue(K,oe[He.id],de)}}}const rt=/(\w+)(\])?(\[|\.)?/g;function qe(Be,K){Be.seq.push(K),Be.map[K.id]=K}function Je(Be,K,oe){const de=Be.name,ye=de.length;for(rt.lastIndex=0;;){const Ie=rt.exec(de),Ue=rt.lastIndex;let He=Ie[1];const Ke=Ie[2]==="]",Ze=Ie[3];if(Ke&&(He=He|0),Ze===void 0||Ze==="["&&Ue+2===ye){qe(oe,Ze===void 0?new Qe(He,Be,K):new We(He,Be,K));break}else{let mt=oe.map[He];mt===void 0&&(mt=new pt(He),qe(oe,mt)),oe=mt}}}class lt{constructor(K,oe){this.seq=[],this.map={};const de=K.getProgramParameter(oe,K.ACTIVE_UNIFORMS);for(let ye=0;ye<de;++ye){const Ie=K.getActiveUniform(oe,ye),Ue=K.getUniformLocation(oe,Ie.name);Je(Ie,Ue,this)}}setValue(K,oe,de,ye){const Ie=this.map[oe];Ie!==void 0&&Ie.setValue(K,de,ye)}setOptional(K,oe,de){const ye=oe[de];ye!==void 0&&this.setValue(K,de,ye)}static upload(K,oe,de,ye){for(let Ie=0,Ue=oe.length;Ie!==Ue;++Ie){const He=oe[Ie],Ke=de[He.id];Ke.needsUpdate!==!1&&He.setValue(K,Ke.value,ye)}}static seqWithValue(K,oe){const de=[];for(let ye=0,Ie=K.length;ye!==Ie;++ye){const Ue=K[ye];Ue.id in oe&&de.push(Ue)}return de}}function Et(Be,K,oe){const de=Be.createShader(K);return Be.shaderSource(de,oe),Be.compileShader(de),de}const At=37297;let je=0;function Ye(Be,K){const oe=Be.split(`
`),de=[],ye=Math.max(K-6,0),Ie=Math.min(K+6,oe.length);for(let Ue=ye;Ue<Ie;Ue++){const He=Ue+1;de.push(`${He===K?">":" "} ${He}: ${oe[Ue]}`)}return de.join(`
`)}function Qt(Be){const K=To.getPrimaries(To.workingColorSpace),oe=To.getPrimaries(Be);let de;switch(K===oe?de="":K===Ic&&oe===Bl?de="LinearDisplayP3ToLinearSRGB":K===Bl&&oe===Ic&&(de="LinearSRGBToLinearDisplayP3"),Be){case za:case Rl:return[de,"LinearTransferOETF"];case lo:case bc:return[de,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",Be),[de,"LinearTransferOETF"]}}function Bn(Be,K,oe){const de=Be.getShaderParameter(K,Be.COMPILE_STATUS),ye=Be.getShaderInfoLog(K).trim();if(de&&ye==="")return"";const Ie=/ERROR: 0:(\d+)/.exec(ye);if(Ie){const Ue=parseInt(Ie[1]);return oe.toUpperCase()+`

`+ye+`

`+Ye(Be.getShaderSource(K),Ue)}else return ye}function Gn(Be,K){const oe=Qt(K);return`vec4 ${Be}( vec4 value ) { return ${oe[0]}( ${oe[1]}( value ) ); }`}function Wn(Be,K){let oe;switch(K){case Nr:oe="Linear";break;case Ar:oe="Reinhard";break;case fr:oe="OptimizedCineon";break;case Bi:oe="ACESFilmic";break;case Yt:oe="AgX";break;case fn:oe="Neutral";break;case Kt:oe="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",K),oe="Linear"}return"vec3 "+Be+"( vec3 color ) { return "+oe+"ToneMapping( color ); }"}function ei(Be){return[Be.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",Be.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(mi).join(`
`)}function Pn(Be){const K=[];for(const oe in Be){const de=Be[oe];de!==!1&&K.push("#define "+oe+" "+de)}return K.join(`
`)}function Yi(Be,K){const oe={},de=Be.getProgramParameter(K,Be.ACTIVE_ATTRIBUTES);for(let ye=0;ye<de;ye++){const Ie=Be.getActiveAttrib(K,ye),Ue=Ie.name;let He=1;Ie.type===Be.FLOAT_MAT2&&(He=2),Ie.type===Be.FLOAT_MAT3&&(He=3),Ie.type===Be.FLOAT_MAT4&&(He=4),oe[Ue]={type:Ie.type,location:Be.getAttribLocation(K,Ue),locationSize:He}}return oe}function mi(Be){return Be!==""}function Gi(Be,K){const oe=K.numSpotLightShadows+K.numSpotLightMaps-K.numSpotLightShadowsWithMaps;return Be.replace(/NUM_DIR_LIGHTS/g,K.numDirLights).replace(/NUM_SPOT_LIGHTS/g,K.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,K.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,oe).replace(/NUM_RECT_AREA_LIGHTS/g,K.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,K.numPointLights).replace(/NUM_HEMI_LIGHTS/g,K.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,K.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,K.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,K.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,K.numPointLightShadows)}function tr(Be,K){return Be.replace(/NUM_CLIPPING_PLANES/g,K.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,K.numClippingPlanes-K.numClipIntersection)}const Di=/^[ \t]*#include +<([\w\d./]+)>/gm;function wn(Be){return Be.replace(Di,Rn)}const ci=new Map;function Rn(Be,K){let oe=vs[K];if(oe===void 0){const de=ci.get(K);if(de!==void 0)oe=vs[de],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',K,de);else throw new Error("Can not resolve #include <"+K+">")}return wn(oe)}const jr=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wr(Be){return Be.replace(jr,ks)}function ks(Be,K,oe,de){let ye="";for(let Ie=parseInt(K);Ie<parseInt(oe);Ie++)ye+=de.replace(/\[\s*i\s*\]/g,"[ "+Ie+" ]").replace(/UNROLLED_LOOP_INDEX/g,Ie);return ye}function ho(Be){let K=`precision ${Be.precision} float;
	precision ${Be.precision} int;
	precision ${Be.precision} sampler2D;
	precision ${Be.precision} samplerCube;
	precision ${Be.precision} sampler3D;
	precision ${Be.precision} sampler2DArray;
	precision ${Be.precision} sampler2DShadow;
	precision ${Be.precision} samplerCubeShadow;
	precision ${Be.precision} sampler2DArrayShadow;
	precision ${Be.precision} isampler2D;
	precision ${Be.precision} isampler3D;
	precision ${Be.precision} isamplerCube;
	precision ${Be.precision} isampler2DArray;
	precision ${Be.precision} usampler2D;
	precision ${Be.precision} usampler3D;
	precision ${Be.precision} usamplerCube;
	precision ${Be.precision} usampler2DArray;
	`;return Be.precision==="highp"?K+=`
#define HIGH_PRECISION`:Be.precision==="mediump"?K+=`
#define MEDIUM_PRECISION`:Be.precision==="lowp"&&(K+=`
#define LOW_PRECISION`),K}function zs(Be){let K="SHADOWMAP_TYPE_BASIC";return Be.shadowMapType===Fe?K="SHADOWMAP_TYPE_PCF":Be.shadowMapType===Oe?K="SHADOWMAP_TYPE_PCF_SOFT":Be.shadowMapType===Ne&&(K="SHADOWMAP_TYPE_VSM"),K}function Fi(Be){let K="ENVMAP_TYPE_CUBE";if(Be.envMap)switch(Be.envMapMode){case Nt:case ht:K="ENVMAP_TYPE_CUBE";break;case Wt:K="ENVMAP_TYPE_CUBE_UV";break}return K}function ar(Be){let K="ENVMAP_MODE_REFLECTION";if(Be.envMap)switch(Be.envMapMode){case ht:K="ENVMAP_MODE_REFRACTION";break}return K}function Cr(Be){let K="ENVMAP_BLENDING_NONE";if(Be.envMap)switch(Be.combine){case Kn:K="ENVMAP_BLENDING_MULTIPLY";break;case ai:K="ENVMAP_BLENDING_MIX";break;case Ui:K="ENVMAP_BLENDING_ADD";break}return K}function no(Be){const K=Be.envMapCubeUVHeight;if(K===null)return null;const oe=Math.log2(K)-2,de=1/K;return{texelWidth:1/(3*Math.max(Math.pow(2,oe),7*16)),texelHeight:de,maxMip:oe}}function ms(Be,K,oe,de){const ye=Be.getContext(),Ie=oe.defines;let Ue=oe.vertexShader,He=oe.fragmentShader;const Ke=zs(oe),Ze=Fi(oe),at=ar(oe),mt=Cr(oe),vt=no(oe),St=ei(oe),Lt=Pn(Ie),Ht=ye.createProgram();let Dt,bt,tn=oe.glslVersion?"#version "+oe.glslVersion+`
`:"";const Zt=oe.numMultiviewViews;oe.isRawShaderMaterial?(Dt=["#define SHADER_TYPE "+oe.shaderType,"#define SHADER_NAME "+oe.shaderName,Lt].filter(mi).join(`
`),Dt.length>0&&(Dt+=`
`),bt=["#define SHADER_TYPE "+oe.shaderType,"#define SHADER_NAME "+oe.shaderName,Lt].filter(mi).join(`
`),bt.length>0&&(bt+=`
`)):(Dt=[ho(oe),"#define SHADER_TYPE "+oe.shaderType,"#define SHADER_NAME "+oe.shaderName,Lt,oe.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",oe.batching?"#define USE_BATCHING":"",oe.instancing?"#define USE_INSTANCING":"",oe.instancingColor?"#define USE_INSTANCING_COLOR":"",oe.instancingMorph?"#define USE_INSTANCING_MORPH":"",oe.useFog&&oe.fog?"#define USE_FOG":"",oe.useFog&&oe.fogExp2?"#define FOG_EXP2":"",oe.map?"#define USE_MAP":"",oe.envMap?"#define USE_ENVMAP":"",oe.envMap?"#define "+at:"",oe.lightMap?"#define USE_LIGHTMAP":"",oe.aoMap?"#define USE_AOMAP":"",oe.bumpMap?"#define USE_BUMPMAP":"",oe.normalMap?"#define USE_NORMALMAP":"",oe.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",oe.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",oe.displacementMap?"#define USE_DISPLACEMENTMAP":"",oe.emissiveMap?"#define USE_EMISSIVEMAP":"",oe.anisotropy?"#define USE_ANISOTROPY":"",oe.anisotropyMap?"#define USE_ANISOTROPYMAP":"",oe.clearcoatMap?"#define USE_CLEARCOATMAP":"",oe.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",oe.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",oe.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",oe.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",oe.specularMap?"#define USE_SPECULARMAP":"",oe.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",oe.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",oe.roughnessMap?"#define USE_ROUGHNESSMAP":"",oe.metalnessMap?"#define USE_METALNESSMAP":"",oe.alphaMap?"#define USE_ALPHAMAP":"",oe.alphaHash?"#define USE_ALPHAHASH":"",oe.transmission?"#define USE_TRANSMISSION":"",oe.transmissionMap?"#define USE_TRANSMISSIONMAP":"",oe.thicknessMap?"#define USE_THICKNESSMAP":"",oe.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",oe.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",oe.mapUv?"#define MAP_UV "+oe.mapUv:"",oe.alphaMapUv?"#define ALPHAMAP_UV "+oe.alphaMapUv:"",oe.lightMapUv?"#define LIGHTMAP_UV "+oe.lightMapUv:"",oe.aoMapUv?"#define AOMAP_UV "+oe.aoMapUv:"",oe.emissiveMapUv?"#define EMISSIVEMAP_UV "+oe.emissiveMapUv:"",oe.bumpMapUv?"#define BUMPMAP_UV "+oe.bumpMapUv:"",oe.normalMapUv?"#define NORMALMAP_UV "+oe.normalMapUv:"",oe.displacementMapUv?"#define DISPLACEMENTMAP_UV "+oe.displacementMapUv:"",oe.metalnessMapUv?"#define METALNESSMAP_UV "+oe.metalnessMapUv:"",oe.roughnessMapUv?"#define ROUGHNESSMAP_UV "+oe.roughnessMapUv:"",oe.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+oe.anisotropyMapUv:"",oe.clearcoatMapUv?"#define CLEARCOATMAP_UV "+oe.clearcoatMapUv:"",oe.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+oe.clearcoatNormalMapUv:"",oe.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+oe.clearcoatRoughnessMapUv:"",oe.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+oe.iridescenceMapUv:"",oe.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+oe.iridescenceThicknessMapUv:"",oe.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+oe.sheenColorMapUv:"",oe.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+oe.sheenRoughnessMapUv:"",oe.specularMapUv?"#define SPECULARMAP_UV "+oe.specularMapUv:"",oe.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+oe.specularColorMapUv:"",oe.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+oe.specularIntensityMapUv:"",oe.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+oe.transmissionMapUv:"",oe.thicknessMapUv?"#define THICKNESSMAP_UV "+oe.thicknessMapUv:"",oe.vertexTangents&&oe.flatShading===!1?"#define USE_TANGENT":"",oe.vertexColors?"#define USE_COLOR":"",oe.vertexAlphas?"#define USE_COLOR_ALPHA":"",oe.vertexUv1s?"#define USE_UV1":"",oe.vertexUv2s?"#define USE_UV2":"",oe.vertexUv3s?"#define USE_UV3":"",oe.pointsUvs?"#define USE_POINTS_UV":"",oe.flatShading?"#define FLAT_SHADED":"",oe.skinning?"#define USE_SKINNING":"",oe.morphTargets?"#define USE_MORPHTARGETS":"",oe.morphNormals&&oe.flatShading===!1?"#define USE_MORPHNORMALS":"",oe.morphColors?"#define USE_MORPHCOLORS":"",oe.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",oe.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+oe.morphTextureStride:"",oe.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+oe.morphTargetsCount:"",oe.doubleSided?"#define DOUBLE_SIDED":"",oe.flipSided?"#define FLIP_SIDED":"",oe.shadowMapEnabled?"#define USE_SHADOWMAP":"",oe.shadowMapEnabled?"#define "+Ke:"",oe.sizeAttenuation?"#define USE_SIZEATTENUATION":"",oe.numLightProbes>0?"#define USE_LIGHT_PROBES":"",oe.useLegacyLights?"#define LEGACY_LIGHTS":"",oe.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(mi).join(`
`),bt=[ho(oe),"#define SHADER_TYPE "+oe.shaderType,"#define SHADER_NAME "+oe.shaderName,Lt,oe.useFog&&oe.fog?"#define USE_FOG":"",oe.useFog&&oe.fogExp2?"#define FOG_EXP2":"",oe.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",oe.map?"#define USE_MAP":"",oe.matcap?"#define USE_MATCAP":"",oe.envMap?"#define USE_ENVMAP":"",oe.envMap?"#define "+Ze:"",oe.envMap?"#define "+at:"",oe.envMap?"#define "+mt:"",vt?"#define CUBEUV_TEXEL_WIDTH "+vt.texelWidth:"",vt?"#define CUBEUV_TEXEL_HEIGHT "+vt.texelHeight:"",vt?"#define CUBEUV_MAX_MIP "+vt.maxMip+".0":"",oe.lightMap?"#define USE_LIGHTMAP":"",oe.aoMap?"#define USE_AOMAP":"",oe.bumpMap?"#define USE_BUMPMAP":"",oe.normalMap?"#define USE_NORMALMAP":"",oe.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",oe.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",oe.emissiveMap?"#define USE_EMISSIVEMAP":"",oe.anisotropy?"#define USE_ANISOTROPY":"",oe.anisotropyMap?"#define USE_ANISOTROPYMAP":"",oe.clearcoat?"#define USE_CLEARCOAT":"",oe.clearcoatMap?"#define USE_CLEARCOATMAP":"",oe.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",oe.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",oe.dispersion?"#define USE_DISPERSION":"",oe.iridescence?"#define USE_IRIDESCENCE":"",oe.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",oe.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",oe.specularMap?"#define USE_SPECULARMAP":"",oe.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",oe.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",oe.roughnessMap?"#define USE_ROUGHNESSMAP":"",oe.metalnessMap?"#define USE_METALNESSMAP":"",oe.alphaMap?"#define USE_ALPHAMAP":"",oe.alphaTest?"#define USE_ALPHATEST":"",oe.alphaHash?"#define USE_ALPHAHASH":"",oe.sheen?"#define USE_SHEEN":"",oe.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",oe.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",oe.transmission?"#define USE_TRANSMISSION":"",oe.transmissionMap?"#define USE_TRANSMISSIONMAP":"",oe.thicknessMap?"#define USE_THICKNESSMAP":"",oe.vertexTangents&&oe.flatShading===!1?"#define USE_TANGENT":"",oe.vertexColors||oe.instancingColor?"#define USE_COLOR":"",oe.vertexAlphas?"#define USE_COLOR_ALPHA":"",oe.vertexUv1s?"#define USE_UV1":"",oe.vertexUv2s?"#define USE_UV2":"",oe.vertexUv3s?"#define USE_UV3":"",oe.pointsUvs?"#define USE_POINTS_UV":"",oe.gradientMap?"#define USE_GRADIENTMAP":"",oe.flatShading?"#define FLAT_SHADED":"",oe.doubleSided?"#define DOUBLE_SIDED":"",oe.flipSided?"#define FLIP_SIDED":"",oe.shadowMapEnabled?"#define USE_SHADOWMAP":"",oe.shadowMapEnabled?"#define "+Ke:"",oe.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",oe.numLightProbes>0?"#define USE_LIGHT_PROBES":"",oe.useLegacyLights?"#define LEGACY_LIGHTS":"",oe.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",oe.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",oe.toneMapping!==yi?"#define TONE_MAPPING":"",oe.toneMapping!==yi?vs.tonemapping_pars_fragment:"",oe.toneMapping!==yi?Wn("toneMapping",oe.toneMapping):"",oe.dithering?"#define DITHERING":"",oe.opaque?"#define OPAQUE":"",vs.colorspace_pars_fragment,Gn("linearToOutputTexel",oe.outputColorSpace),oe.useDepthPacking?"#define DEPTH_PACKING "+oe.depthPacking:"",`
`].filter(mi).join(`
`)),Ue=wn(Ue),Ue=Gi(Ue,oe),Ue=tr(Ue,oe),He=wn(He),He=Gi(He,oe),He=tr(He,oe),Ue=wr(Ue),He=wr(He),oe.isRawShaderMaterial!==!0&&(tn=`#version 300 es
`,Dt=[St,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Dt,bt=["#define varying in",oe.glslVersion===zu?"":"layout(location = 0) out highp vec4 pc_fragColor;",oe.glslVersion===zu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+bt,Zt>0&&(Dt=["#extension GL_OVR_multiview : require","layout(num_views = "+Zt+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+Dt,Dt=Dt.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+Zt+"];","uniform mat4 projectionMatrices["+Zt+"];","uniform mat4 viewMatrices["+Zt+"];","uniform mat3 normalMatrices["+Zt+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),bt=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+bt,bt=bt.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+Zt+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));const qt=tn+Dt+Ue,Un=tn+bt+He,_n=Et(ye,ye.VERTEX_SHADER,qt),bn=Et(ye,ye.FRAGMENT_SHADER,Un);ye.attachShader(Ht,_n),ye.attachShader(Ht,bn),oe.index0AttributeName!==void 0?ye.bindAttribLocation(Ht,0,oe.index0AttributeName):oe.morphTargets===!0&&ye.bindAttribLocation(Ht,0,"position"),ye.linkProgram(Ht);function Fn(Zn){if(Be.debug.checkShaderErrors){const Xn=ye.getProgramInfoLog(Ht).trim(),ri=ye.getShaderInfoLog(_n).trim(),wi=ye.getShaderInfoLog(bn).trim();let Ji=!0,Dr=!0;if(ye.getProgramParameter(Ht,ye.LINK_STATUS)===!1)if(Ji=!1,typeof Be.debug.onShaderError=="function")Be.debug.onShaderError(ye,Ht,_n,bn);else{const Ri=Bn(ye,_n,"vertex"),xr=Bn(ye,bn,"fragment");console.error("THREE.WebGLProgram: Shader Error "+ye.getError()+" - VALIDATE_STATUS "+ye.getProgramParameter(Ht,ye.VALIDATE_STATUS)+`

Material Name: `+Zn.name+`
Material Type: `+Zn.type+`

Program Info Log: `+Xn+`
`+Ri+`
`+xr)}else Xn!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Xn):(ri===""||wi==="")&&(Dr=!1);Dr&&(Zn.diagnostics={runnable:Ji,programLog:Xn,vertexShader:{log:ri,prefix:Dt},fragmentShader:{log:wi,prefix:bt}})}ye.deleteShader(_n),ye.deleteShader(bn),pn=new lt(ye,Ht),cn=Yi(ye,Ht)}let pn;this.getUniforms=function(){return pn===void 0&&Fn(this),pn};let cn;this.getAttributes=function(){return cn===void 0&&Fn(this),cn};let On=oe.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return On===!1&&(On=ye.getProgramParameter(Ht,At)),On},this.destroy=function(){de.releaseStatesOfProgram(this),ye.deleteProgram(Ht),this.program=void 0},this.type=oe.shaderType,this.name=oe.shaderName,this.id=je++,this.cacheKey=K,this.usedTimes=1,this.program=Ht,this.vertexShader=_n,this.fragmentShader=bn,this.numMultiviewViews=Zt,this}let ic=0;class ol{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(K){const oe=K.vertexShader,de=K.fragmentShader,ye=this._getShaderStage(oe),Ie=this._getShaderStage(de),Ue=this._getShaderCacheForMaterial(K);return Ue.has(ye)===!1&&(Ue.add(ye),ye.usedTimes++),Ue.has(Ie)===!1&&(Ue.add(Ie),Ie.usedTimes++),this}remove(K){const oe=this.materialCache.get(K);for(const de of oe)de.usedTimes--,de.usedTimes===0&&this.shaderCache.delete(de.code);return this.materialCache.delete(K),this}getVertexShaderID(K){return this._getShaderStage(K.vertexShader).id}getFragmentShaderID(K){return this._getShaderStage(K.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(K){const oe=this.materialCache;let de=oe.get(K);return de===void 0&&(de=new Set,oe.set(K,de)),de}_getShaderStage(K){const oe=this.shaderCache;let de=oe.get(K);return de===void 0&&(de=new Gf(K),oe.set(K,de)),de}}class Gf{constructor(K){this.id=ic++,this.code=K,this.usedTimes=0}}function Qf(Be,K,oe,de,ye,Ie,Ue){const He=new Ql,Ke=new ol,Ze=new Set,at=[],mt=ye.logarithmicDepthBuffer,vt=ye.vertexTextures;let St=ye.precision;const Lt={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Ht(pn){return Ze.add(pn),pn===0?"uv":`uv${pn}`}function Dt(pn,cn,On,Zn,Xn){const ri=Zn.fog,wi=Xn.geometry,Ji=pn.isMeshStandardMaterial?Zn.environment:null,Dr=(pn.isMeshStandardMaterial?oe:K).get(pn.envMap||Ji),Ri=Dr&&Dr.mapping===Wt?Dr.image.height:null,xr=Lt[pn.type];pn.precision!==null&&(St=ye.getMaxPrecision(pn.precision),St!==pn.precision&&console.warn("THREE.WebGLProgram.getParameters:",pn.precision,"not supported, using",St,"instead."));const br=wi.morphAttributes.position||wi.morphAttributes.normal||wi.morphAttributes.color,us=br!==void 0?br.length:0;let oo=0;wi.morphAttributes.position!==void 0&&(oo=1),wi.morphAttributes.normal!==void 0&&(oo=2),wi.morphAttributes.color!==void 0&&(oo=3);let Qo,ha,No,ea;if(xr){const R0=I0[xr];Qo=R0.vertexShader,ha=R0.fragmentShader}else Qo=pn.vertexShader,ha=pn.fragmentShader,Ke.update(pn),No=Ke.getVertexShaderID(pn),ea=Ke.getFragmentShaderID(pn);const ps=Be.getRenderTarget(),sr=ps&&ps.isWebGLMultiviewRenderTarget?ps.numViews:0,Fr=Xn.isInstancedMesh===!0,Qr=Xn.isBatchedMesh===!0,si=!!pn.map,or=!!pn.matcap,Vi=!!Dr,_r=!!pn.aoMap,vr=!!pn.lightMap,mr=!!pn.bumpMap,$r=!!pn.normalMap,rs=!!pn.displacementMap,Vs=!!pn.emissiveMap,Js=!!pn.metalnessMap,Uo=!!pn.roughnessMap,Ha=pn.anisotropy>0,da=pn.clearcoat>0,Ln=pn.dispersion>0,un=pn.iridescence>0,Ni=pn.sheen>0,nr=pn.transmission>0,hr=Ha&&!!pn.anisotropyMap,lr=da&&!!pn.clearcoatMap,Es=da&&!!pn.clearcoatNormalMap,Pr=da&&!!pn.clearcoatRoughnessMap,ss=un&&!!pn.iridescenceMap,Yo=un&&!!pn.iridescenceThicknessMap,os=Ni&&!!pn.sheenColorMap,Cs=Ni&&!!pn.sheenRoughnessMap,ro=!!pn.specularMap,Ps=!!pn.specularColorMap,zn=!!pn.specularIntensityMap,gr=nr&&!!pn.transmissionMap,Tr=nr&&!!pn.thicknessMap,_s=!!pn.gradientMap,ns=!!pn.alphaMap,so=pn.alphaTest>0,is=!!pn.alphaHash,Xr=!!pn.extensions;let fo=yi;pn.toneMapped&&(ps===null||ps.isXRRenderTarget===!0)&&(fo=Be.toneMapping);const Os={shaderID:xr,shaderType:pn.type,shaderName:pn.name,vertexShader:Qo,fragmentShader:ha,defines:pn.defines,customVertexShaderID:No,customFragmentShaderID:ea,isRawShaderMaterial:pn.isRawShaderMaterial===!0,glslVersion:pn.glslVersion,precision:St,batching:Qr,instancing:Fr,instancingColor:Fr&&Xn.instanceColor!==null,instancingMorph:Fr&&Xn.morphTexture!==null,supportsVertexTextures:vt,numMultiviewViews:sr,outputColorSpace:ps===null?Be.outputColorSpace:ps.isXRRenderTarget===!0?ps.texture.colorSpace:za,alphaToCoverage:!!pn.alphaToCoverage,map:si,matcap:or,envMap:Vi,envMapMode:Vi&&Dr.mapping,envMapCubeUVHeight:Ri,aoMap:_r,lightMap:vr,bumpMap:mr,normalMap:$r,displacementMap:vt&&rs,emissiveMap:Vs,normalMapObjectSpace:$r&&pn.normalMapType===V0,normalMapTangentSpace:$r&&pn.normalMapType===Va,metalnessMap:Js,roughnessMap:Uo,anisotropy:Ha,anisotropyMap:hr,clearcoat:da,clearcoatMap:lr,clearcoatNormalMap:Es,clearcoatRoughnessMap:Pr,dispersion:Ln,iridescence:un,iridescenceMap:ss,iridescenceThicknessMap:Yo,sheen:Ni,sheenColorMap:os,sheenRoughnessMap:Cs,specularMap:ro,specularColorMap:Ps,specularIntensityMap:zn,transmission:nr,transmissionMap:gr,thicknessMap:Tr,gradientMap:_s,opaque:pn.transparent===!1&&pn.blending===st&&pn.alphaToCoverage===!1,alphaMap:ns,alphaTest:so,alphaHash:is,combine:pn.combine,mapUv:si&&Ht(pn.map.channel),aoMapUv:_r&&Ht(pn.aoMap.channel),lightMapUv:vr&&Ht(pn.lightMap.channel),bumpMapUv:mr&&Ht(pn.bumpMap.channel),normalMapUv:$r&&Ht(pn.normalMap.channel),displacementMapUv:rs&&Ht(pn.displacementMap.channel),emissiveMapUv:Vs&&Ht(pn.emissiveMap.channel),metalnessMapUv:Js&&Ht(pn.metalnessMap.channel),roughnessMapUv:Uo&&Ht(pn.roughnessMap.channel),anisotropyMapUv:hr&&Ht(pn.anisotropyMap.channel),clearcoatMapUv:lr&&Ht(pn.clearcoatMap.channel),clearcoatNormalMapUv:Es&&Ht(pn.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Pr&&Ht(pn.clearcoatRoughnessMap.channel),iridescenceMapUv:ss&&Ht(pn.iridescenceMap.channel),iridescenceThicknessMapUv:Yo&&Ht(pn.iridescenceThicknessMap.channel),sheenColorMapUv:os&&Ht(pn.sheenColorMap.channel),sheenRoughnessMapUv:Cs&&Ht(pn.sheenRoughnessMap.channel),specularMapUv:ro&&Ht(pn.specularMap.channel),specularColorMapUv:Ps&&Ht(pn.specularColorMap.channel),specularIntensityMapUv:zn&&Ht(pn.specularIntensityMap.channel),transmissionMapUv:gr&&Ht(pn.transmissionMap.channel),thicknessMapUv:Tr&&Ht(pn.thicknessMap.channel),alphaMapUv:ns&&Ht(pn.alphaMap.channel),vertexTangents:!!wi.attributes.tangent&&($r||Ha),vertexColors:pn.vertexColors,vertexAlphas:pn.vertexColors===!0&&!!wi.attributes.color&&wi.attributes.color.itemSize===4,pointsUvs:Xn.isPoints===!0&&!!wi.attributes.uv&&(si||ns),fog:!!ri,useFog:pn.fog===!0,fogExp2:!!ri&&ri.isFogExp2,flatShading:pn.flatShading===!0,sizeAttenuation:pn.sizeAttenuation===!0,logarithmicDepthBuffer:mt,skinning:Xn.isSkinnedMesh===!0,morphTargets:wi.morphAttributes.position!==void 0,morphNormals:wi.morphAttributes.normal!==void 0,morphColors:wi.morphAttributes.color!==void 0,morphTargetsCount:us,morphTextureStride:oo,numDirLights:cn.directional.length,numPointLights:cn.point.length,numSpotLights:cn.spot.length,numSpotLightMaps:cn.spotLightMap.length,numRectAreaLights:cn.rectArea.length,numHemiLights:cn.hemi.length,numDirLightShadows:cn.directionalShadowMap.length,numPointLightShadows:cn.pointShadowMap.length,numSpotLightShadows:cn.spotShadowMap.length,numSpotLightShadowsWithMaps:cn.numSpotLightShadowsWithMaps,numLightProbes:cn.numLightProbes,numClippingPlanes:Ue.numPlanes,numClipIntersection:Ue.numIntersection,dithering:pn.dithering,shadowMapEnabled:Be.shadowMap.enabled&&On.length>0,shadowMapType:Be.shadowMap.type,toneMapping:fo,useLegacyLights:Be._useLegacyLights,decodeVideoTexture:si&&pn.map.isVideoTexture===!0&&To.getTransfer(pn.map.colorSpace)===bo,premultipliedAlpha:pn.premultipliedAlpha,doubleSided:pn.side===Xe,flipSided:pn.side===Ve,useDepthPacking:pn.depthPacking>=0,depthPacking:pn.depthPacking||0,index0AttributeName:pn.index0AttributeName,extensionClipCullDistance:Xr&&pn.extensions.clipCullDistance===!0&&de.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Xr&&pn.extensions.multiDraw===!0&&de.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:de.has("KHR_parallel_shader_compile"),customProgramCacheKey:pn.customProgramCacheKey()};return Os.vertexUv1s=Ze.has(1),Os.vertexUv2s=Ze.has(2),Os.vertexUv3s=Ze.has(3),Ze.clear(),Os}function bt(pn){const cn=[];if(pn.shaderID?cn.push(pn.shaderID):(cn.push(pn.customVertexShaderID),cn.push(pn.customFragmentShaderID)),pn.defines!==void 0)for(const On in pn.defines)cn.push(On),cn.push(pn.defines[On]);return pn.isRawShaderMaterial===!1&&(tn(cn,pn),Zt(cn,pn),cn.push(Be.outputColorSpace)),cn.push(pn.customProgramCacheKey),cn.join()}function tn(pn,cn){pn.push(cn.precision),pn.push(cn.outputColorSpace),pn.push(cn.envMapMode),pn.push(cn.envMapCubeUVHeight),pn.push(cn.mapUv),pn.push(cn.alphaMapUv),pn.push(cn.lightMapUv),pn.push(cn.aoMapUv),pn.push(cn.bumpMapUv),pn.push(cn.normalMapUv),pn.push(cn.displacementMapUv),pn.push(cn.emissiveMapUv),pn.push(cn.metalnessMapUv),pn.push(cn.roughnessMapUv),pn.push(cn.anisotropyMapUv),pn.push(cn.clearcoatMapUv),pn.push(cn.clearcoatNormalMapUv),pn.push(cn.clearcoatRoughnessMapUv),pn.push(cn.iridescenceMapUv),pn.push(cn.iridescenceThicknessMapUv),pn.push(cn.sheenColorMapUv),pn.push(cn.sheenRoughnessMapUv),pn.push(cn.specularMapUv),pn.push(cn.specularColorMapUv),pn.push(cn.specularIntensityMapUv),pn.push(cn.transmissionMapUv),pn.push(cn.thicknessMapUv),pn.push(cn.combine),pn.push(cn.fogExp2),pn.push(cn.sizeAttenuation),pn.push(cn.morphTargetsCount),pn.push(cn.morphAttributeCount),pn.push(cn.numDirLights),pn.push(cn.numPointLights),pn.push(cn.numSpotLights),pn.push(cn.numSpotLightMaps),pn.push(cn.numHemiLights),pn.push(cn.numRectAreaLights),pn.push(cn.numDirLightShadows),pn.push(cn.numPointLightShadows),pn.push(cn.numSpotLightShadows),pn.push(cn.numSpotLightShadowsWithMaps),pn.push(cn.numLightProbes),pn.push(cn.shadowMapType),pn.push(cn.toneMapping),pn.push(cn.numClippingPlanes),pn.push(cn.numClipIntersection),pn.push(cn.depthPacking)}function Zt(pn,cn){He.disableAll(),cn.supportsVertexTextures&&He.enable(0),cn.instancing&&He.enable(1),cn.instancingColor&&He.enable(2),cn.instancingMorph&&He.enable(3),cn.matcap&&He.enable(4),cn.envMap&&He.enable(5),cn.normalMapObjectSpace&&He.enable(6),cn.normalMapTangentSpace&&He.enable(7),cn.clearcoat&&He.enable(8),cn.iridescence&&He.enable(9),cn.alphaTest&&He.enable(10),cn.vertexColors&&He.enable(11),cn.vertexAlphas&&He.enable(12),cn.vertexUv1s&&He.enable(13),cn.vertexUv2s&&He.enable(14),cn.vertexUv3s&&He.enable(15),cn.vertexTangents&&He.enable(16),cn.anisotropy&&He.enable(17),cn.alphaHash&&He.enable(18),cn.batching&&He.enable(19),cn.dispersion&&He.enable(20),pn.push(He.mask),He.disableAll(),cn.fog&&He.enable(0),cn.useFog&&He.enable(1),cn.flatShading&&He.enable(2),cn.logarithmicDepthBuffer&&He.enable(3),cn.skinning&&He.enable(4),cn.morphTargets&&He.enable(5),cn.morphNormals&&He.enable(6),cn.morphColors&&He.enable(7),cn.premultipliedAlpha&&He.enable(8),cn.shadowMapEnabled&&He.enable(9),cn.useLegacyLights&&He.enable(10),cn.doubleSided&&He.enable(11),cn.flipSided&&He.enable(12),cn.useDepthPacking&&He.enable(13),cn.dithering&&He.enable(14),cn.transmission&&He.enable(15),cn.sheen&&He.enable(16),cn.opaque&&He.enable(17),cn.pointsUvs&&He.enable(18),cn.decodeVideoTexture&&He.enable(19),cn.alphaToCoverage&&He.enable(20),cn.numMultiviewViews&&He.enable(21),pn.push(He.mask)}function qt(pn){const cn=Lt[pn.type];let On;if(cn){const Zn=I0[cn];On=Qh.clone(Zn.uniforms)}else On=pn.uniforms;return On}function Un(pn,cn){let On;for(let Zn=0,Xn=at.length;Zn<Xn;Zn++){const ri=at[Zn];if(ri.cacheKey===cn){On=ri,++On.usedTimes;break}}return On===void 0&&(On=new ms(Be,cn,pn,Ie),at.push(On)),On}function _n(pn){if(--pn.usedTimes===0){const cn=at.indexOf(pn);at[cn]=at[at.length-1],at.pop(),pn.destroy()}}function bn(pn){Ke.remove(pn)}function Fn(){Ke.dispose()}return{getParameters:Dt,getProgramCacheKey:bt,getUniforms:qt,acquireProgram:Un,releaseProgram:_n,releaseShaderCache:bn,programs:at,dispose:Fn}}function Hc(){let Be=new WeakMap;function K(Ie){let Ue=Be.get(Ie);return Ue===void 0&&(Ue={},Be.set(Ie,Ue)),Ue}function oe(Ie){Be.delete(Ie)}function de(Ie,Ue,He){Be.get(Ie)[Ue]=He}function ye(){Be=new WeakMap}return{get:K,remove:oe,update:de,dispose:ye}}function Ng(Be,K){return Be.groupOrder!==K.groupOrder?Be.groupOrder-K.groupOrder:Be.renderOrder!==K.renderOrder?Be.renderOrder-K.renderOrder:Be.material.id!==K.material.id?Be.material.id-K.material.id:Be.z!==K.z?Be.z-K.z:Be.id-K.id}function L2(Be,K){return Be.groupOrder!==K.groupOrder?Be.groupOrder-K.groupOrder:Be.renderOrder!==K.renderOrder?Be.renderOrder-K.renderOrder:Be.z!==K.z?K.z-Be.z:Be.id-K.id}function D2(){const Be=[];let K=0;const oe=[],de=[],ye=[];function Ie(){K=0,oe.length=0,de.length=0,ye.length=0}function Ue(mt,vt,St,Lt,Ht,Dt){let bt=Be[K];return bt===void 0?(bt={id:mt.id,object:mt,geometry:vt,material:St,groupOrder:Lt,renderOrder:mt.renderOrder,z:Ht,group:Dt},Be[K]=bt):(bt.id=mt.id,bt.object=mt,bt.geometry=vt,bt.material=St,bt.groupOrder=Lt,bt.renderOrder=mt.renderOrder,bt.z=Ht,bt.group=Dt),K++,bt}function He(mt,vt,St,Lt,Ht,Dt){const bt=Ue(mt,vt,St,Lt,Ht,Dt);St.transmission>0?de.push(bt):St.transparent===!0?ye.push(bt):oe.push(bt)}function Ke(mt,vt,St,Lt,Ht,Dt){const bt=Ue(mt,vt,St,Lt,Ht,Dt);St.transmission>0?de.unshift(bt):St.transparent===!0?ye.unshift(bt):oe.unshift(bt)}function Ze(mt,vt){oe.length>1&&oe.sort(mt||Ng),de.length>1&&de.sort(vt||L2),ye.length>1&&ye.sort(vt||L2)}function at(){for(let mt=K,vt=Be.length;mt<vt;mt++){const St=Be[mt];if(St.id===null)break;St.id=null,St.object=null,St.geometry=null,St.material=null,St.group=null}}return{opaque:oe,transmissive:de,transparent:ye,init:Ie,push:He,unshift:Ke,finish:at,sort:Ze}}function Ug(){let Be=new WeakMap;function K(de,ye){const Ie=Be.get(de);let Ue;return Ie===void 0?(Ue=new D2,Be.set(de,[Ue])):ye>=Ie.length?(Ue=new D2,Ie.push(Ue)):Ue=Ie[ye],Ue}function oe(){Be=new WeakMap}return{get:K,dispose:oe}}function kg(){const Be={};return{get:function(K){if(Be[K.id]!==void 0)return Be[K.id];let oe;switch(K.type){case"DirectionalLight":oe={direction:new vn,color:new Wr};break;case"SpotLight":oe={position:new vn,direction:new vn,color:new Wr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":oe={position:new vn,color:new Wr,distance:0,decay:0};break;case"HemisphereLight":oe={direction:new vn,skyColor:new Wr,groundColor:new Wr};break;case"RectAreaLight":oe={color:new Wr,position:new vn,halfWidth:new vn,halfHeight:new vn};break}return Be[K.id]=oe,oe}}}function Gg(){const Be={};return{get:function(K){if(Be[K.id]!==void 0)return Be[K.id];let oe;switch(K.type){case"DirectionalLight":oe={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qi};break;case"SpotLight":oe={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qi};break;case"PointLight":oe={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qi,shadowCameraNear:1,shadowCameraFar:1e3};break}return Be[K.id]=oe,oe}}}let Qg=0;function Hg(Be,K){return(K.castShadow?2:0)-(Be.castShadow?2:0)+(K.map?1:0)-(Be.map?1:0)}function Vg(Be){const K=new kg,oe=Gg(),de={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let Ze=0;Ze<9;Ze++)de.probe.push(new vn);const ye=new vn,Ie=new kr,Ue=new kr;function He(Ze,at){let mt=0,vt=0,St=0;for(let On=0;On<9;On++)de.probe[On].set(0,0,0);let Lt=0,Ht=0,Dt=0,bt=0,tn=0,Zt=0,qt=0,Un=0,_n=0,bn=0,Fn=0;Ze.sort(Hg);const pn=at===!0?Math.PI:1;for(let On=0,Zn=Ze.length;On<Zn;On++){const Xn=Ze[On],ri=Xn.color,wi=Xn.intensity,Ji=Xn.distance,Dr=Xn.shadow&&Xn.shadow.map?Xn.shadow.map.texture:null;if(Xn.isAmbientLight)mt+=ri.r*wi*pn,vt+=ri.g*wi*pn,St+=ri.b*wi*pn;else if(Xn.isLightProbe){for(let Ri=0;Ri<9;Ri++)de.probe[Ri].addScaledVector(Xn.sh.coefficients[Ri],wi);Fn++}else if(Xn.isDirectionalLight){const Ri=K.get(Xn);if(Ri.color.copy(Xn.color).multiplyScalar(Xn.intensity*pn),Xn.castShadow){const xr=Xn.shadow,br=oe.get(Xn);br.shadowBias=xr.bias,br.shadowNormalBias=xr.normalBias,br.shadowRadius=xr.radius,br.shadowMapSize=xr.mapSize,de.directionalShadow[Lt]=br,de.directionalShadowMap[Lt]=Dr,de.directionalShadowMatrix[Lt]=Xn.shadow.matrix,Zt++}de.directional[Lt]=Ri,Lt++}else if(Xn.isSpotLight){const Ri=K.get(Xn);Ri.position.setFromMatrixPosition(Xn.matrixWorld),Ri.color.copy(ri).multiplyScalar(wi*pn),Ri.distance=Ji,Ri.coneCos=Math.cos(Xn.angle),Ri.penumbraCos=Math.cos(Xn.angle*(1-Xn.penumbra)),Ri.decay=Xn.decay,de.spot[Dt]=Ri;const xr=Xn.shadow;if(Xn.map&&(de.spotLightMap[_n]=Xn.map,_n++,xr.updateMatrices(Xn),Xn.castShadow&&bn++),de.spotLightMatrix[Dt]=xr.matrix,Xn.castShadow){const br=oe.get(Xn);br.shadowBias=xr.bias,br.shadowNormalBias=xr.normalBias,br.shadowRadius=xr.radius,br.shadowMapSize=xr.mapSize,de.spotShadow[Dt]=br,de.spotShadowMap[Dt]=Dr,Un++}Dt++}else if(Xn.isRectAreaLight){const Ri=K.get(Xn);Ri.color.copy(ri).multiplyScalar(wi),Ri.halfWidth.set(Xn.width*.5,0,0),Ri.halfHeight.set(0,Xn.height*.5,0),de.rectArea[bt]=Ri,bt++}else if(Xn.isPointLight){const Ri=K.get(Xn);if(Ri.color.copy(Xn.color).multiplyScalar(Xn.intensity*pn),Ri.distance=Xn.distance,Ri.decay=Xn.decay,Xn.castShadow){const xr=Xn.shadow,br=oe.get(Xn);br.shadowBias=xr.bias,br.shadowNormalBias=xr.normalBias,br.shadowRadius=xr.radius,br.shadowMapSize=xr.mapSize,br.shadowCameraNear=xr.camera.near,br.shadowCameraFar=xr.camera.far,de.pointShadow[Ht]=br,de.pointShadowMap[Ht]=Dr,de.pointShadowMatrix[Ht]=Xn.shadow.matrix,qt++}de.point[Ht]=Ri,Ht++}else if(Xn.isHemisphereLight){const Ri=K.get(Xn);Ri.skyColor.copy(Xn.color).multiplyScalar(wi*pn),Ri.groundColor.copy(Xn.groundColor).multiplyScalar(wi*pn),de.hemi[tn]=Ri,tn++}}bt>0&&(Be.has("OES_texture_float_linear")===!0?(de.rectAreaLTC1=Or.LTC_FLOAT_1,de.rectAreaLTC2=Or.LTC_FLOAT_2):(de.rectAreaLTC1=Or.LTC_HALF_1,de.rectAreaLTC2=Or.LTC_HALF_2)),de.ambient[0]=mt,de.ambient[1]=vt,de.ambient[2]=St;const cn=de.hash;(cn.directionalLength!==Lt||cn.pointLength!==Ht||cn.spotLength!==Dt||cn.rectAreaLength!==bt||cn.hemiLength!==tn||cn.numDirectionalShadows!==Zt||cn.numPointShadows!==qt||cn.numSpotShadows!==Un||cn.numSpotMaps!==_n||cn.numLightProbes!==Fn)&&(de.directional.length=Lt,de.spot.length=Dt,de.rectArea.length=bt,de.point.length=Ht,de.hemi.length=tn,de.directionalShadow.length=Zt,de.directionalShadowMap.length=Zt,de.pointShadow.length=qt,de.pointShadowMap.length=qt,de.spotShadow.length=Un,de.spotShadowMap.length=Un,de.directionalShadowMatrix.length=Zt,de.pointShadowMatrix.length=qt,de.spotLightMatrix.length=Un+_n-bn,de.spotLightMap.length=_n,de.numSpotLightShadowsWithMaps=bn,de.numLightProbes=Fn,cn.directionalLength=Lt,cn.pointLength=Ht,cn.spotLength=Dt,cn.rectAreaLength=bt,cn.hemiLength=tn,cn.numDirectionalShadows=Zt,cn.numPointShadows=qt,cn.numSpotShadows=Un,cn.numSpotMaps=_n,cn.numLightProbes=Fn,de.version=Qg++)}function Ke(Ze,at){let mt=0,vt=0,St=0,Lt=0,Ht=0;const Dt=at.matrixWorldInverse;for(let bt=0,tn=Ze.length;bt<tn;bt++){const Zt=Ze[bt];if(Zt.isDirectionalLight){const qt=de.directional[mt];qt.direction.setFromMatrixPosition(Zt.matrixWorld),ye.setFromMatrixPosition(Zt.target.matrixWorld),qt.direction.sub(ye),qt.direction.transformDirection(Dt),mt++}else if(Zt.isSpotLight){const qt=de.spot[St];qt.position.setFromMatrixPosition(Zt.matrixWorld),qt.position.applyMatrix4(Dt),qt.direction.setFromMatrixPosition(Zt.matrixWorld),ye.setFromMatrixPosition(Zt.target.matrixWorld),qt.direction.sub(ye),qt.direction.transformDirection(Dt),St++}else if(Zt.isRectAreaLight){const qt=de.rectArea[Lt];qt.position.setFromMatrixPosition(Zt.matrixWorld),qt.position.applyMatrix4(Dt),Ue.identity(),Ie.copy(Zt.matrixWorld),Ie.premultiply(Dt),Ue.extractRotation(Ie),qt.halfWidth.set(Zt.width*.5,0,0),qt.halfHeight.set(0,Zt.height*.5,0),qt.halfWidth.applyMatrix4(Ue),qt.halfHeight.applyMatrix4(Ue),Lt++}else if(Zt.isPointLight){const qt=de.point[vt];qt.position.setFromMatrixPosition(Zt.matrixWorld),qt.position.applyMatrix4(Dt),vt++}else if(Zt.isHemisphereLight){const qt=de.hemi[Ht];qt.direction.setFromMatrixPosition(Zt.matrixWorld),qt.direction.transformDirection(Dt),Ht++}}}return{setup:He,setupView:Ke,state:de}}function P2(Be){const K=new Vg(Be),oe=[],de=[];function ye(at){Ze.camera=at,oe.length=0,de.length=0}function Ie(at){oe.push(at)}function Ue(at){de.push(at)}function He(at){K.setup(oe,at)}function Ke(at){K.setupView(oe,at)}const Ze={lightsArray:oe,shadowsArray:de,camera:null,lights:K,transmissionRenderTarget:{}};return{init:ye,state:Ze,setupLights:He,setupLightsView:Ke,pushLight:Ie,pushShadow:Ue}}function zg(Be){let K=new WeakMap;function oe(ye,Ie=0){const Ue=K.get(ye);let He;return Ue===void 0?(He=new P2(Be),K.set(ye,[He])):Ie>=Ue.length?(He=new P2(Be),Ue.push(He)):He=Ue[Ie],He}function de(){K=new WeakMap}return{get:oe,dispose:de}}class kA extends Oo{constructor(K){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Tl,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(K)}copy(K){return super.copy(K),this.depthPacking=K.depthPacking,this.map=K.map,this.alphaMap=K.alphaMap,this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this}}class GA extends Oo{constructor(K){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(K)}copy(K){return super.copy(K),this.map=K.map,this.alphaMap=K.alphaMap,this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this}}const Wg=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,$g=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Xg(Be,K,oe){let de=new Cc;const ye=new qi,Ie=new qi,Ue=new go,He=new kA({depthPacking:Il}),Ke=new GA,Ze={},at=oe.maxTextureSize,mt={[ke]:Ve,[Ve]:ke,[Xe]:Xe},vt=new k0({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new qi},radius:{value:4}},vertexShader:Wg,fragmentShader:$g}),St=vt.clone();St.defines.HORIZONTAL_PASS=1;const Lt=new Ds;Lt.setAttribute("position",new So(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Ht=new Zo(Lt,vt),Dt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Fe;let bt=this.type;this.render=function(_n,bn,Fn){if(Dt.enabled===!1||Dt.autoUpdate===!1&&Dt.needsUpdate===!1||_n.length===0)return;const pn=Be.getRenderTarget(),cn=Be.getActiveCubeFace(),On=Be.getActiveMipmapLevel(),Zn=Be.state;Zn.setBlending($e),Zn.buffers.color.setClear(1,1,1,1),Zn.buffers.depth.setTest(!0),Zn.setScissorTest(!1);const Xn=bt!==Ne&&this.type===Ne,ri=bt===Ne&&this.type!==Ne;for(let wi=0,Ji=_n.length;wi<Ji;wi++){const Dr=_n[wi],Ri=Dr.shadow;if(Ri===void 0){console.warn("THREE.WebGLShadowMap:",Dr,"has no shadow.");continue}if(Ri.autoUpdate===!1&&Ri.needsUpdate===!1)continue;ye.copy(Ri.mapSize);const xr=Ri.getFrameExtents();if(ye.multiply(xr),Ie.copy(Ri.mapSize),(ye.x>at||ye.y>at)&&(ye.x>at&&(Ie.x=Math.floor(at/xr.x),ye.x=Ie.x*xr.x,Ri.mapSize.x=Ie.x),ye.y>at&&(Ie.y=Math.floor(at/xr.y),ye.y=Ie.y*xr.y,Ri.mapSize.y=Ie.y)),Ri.map===null||Xn===!0||ri===!0){const us=this.type!==Ne?{minFilter:ki,magFilter:ki}:{};Ri.map!==null&&Ri.map.dispose(),Ri.map=new ga(ye.x,ye.y,us),Ri.map.texture.name=Dr.name+".shadowMap",Ri.camera.updateProjectionMatrix()}Be.setRenderTarget(Ri.map),Be.clear();const br=Ri.getViewportCount();for(let us=0;us<br;us++){const oo=Ri.getViewport(us);Ue.set(Ie.x*oo.x,Ie.y*oo.y,Ie.x*oo.z,Ie.y*oo.w),Zn.viewport(Ue),Ri.updateMatrices(Dr,us),de=Ri.getFrustum(),qt(bn,Fn,Ri.camera,Dr,this.type)}Ri.isPointLightShadow!==!0&&this.type===Ne&&tn(Ri,Fn),Ri.needsUpdate=!1}bt=this.type,Dt.needsUpdate=!1,Be.setRenderTarget(pn,cn,On)};function tn(_n,bn){const Fn=K.update(Ht);vt.defines.VSM_SAMPLES!==_n.blurSamples&&(vt.defines.VSM_SAMPLES=_n.blurSamples,St.defines.VSM_SAMPLES=_n.blurSamples,vt.needsUpdate=!0,St.needsUpdate=!0),_n.mapPass===null&&(_n.mapPass=new ga(ye.x,ye.y)),vt.uniforms.shadow_pass.value=_n.map.texture,vt.uniforms.resolution.value=_n.mapSize,vt.uniforms.radius.value=_n.radius,Be.setRenderTarget(_n.mapPass),Be.clear(),Be.renderBufferDirect(bn,null,Fn,vt,Ht,null),St.uniforms.shadow_pass.value=_n.mapPass.texture,St.uniforms.resolution.value=_n.mapSize,St.uniforms.radius.value=_n.radius,Be.setRenderTarget(_n.map),Be.clear(),Be.renderBufferDirect(bn,null,Fn,St,Ht,null)}function Zt(_n,bn,Fn,pn){let cn=null;const On=Fn.isPointLight===!0?_n.customDistanceMaterial:_n.customDepthMaterial;if(On!==void 0)cn=On;else if(cn=Fn.isPointLight===!0?Ke:He,Be.localClippingEnabled&&bn.clipShadows===!0&&Array.isArray(bn.clippingPlanes)&&bn.clippingPlanes.length!==0||bn.displacementMap&&bn.displacementScale!==0||bn.alphaMap&&bn.alphaTest>0||bn.map&&bn.alphaTest>0){const Zn=cn.uuid,Xn=bn.uuid;let ri=Ze[Zn];ri===void 0&&(ri={},Ze[Zn]=ri);let wi=ri[Xn];wi===void 0&&(wi=cn.clone(),ri[Xn]=wi,bn.addEventListener("dispose",Un)),cn=wi}if(cn.visible=bn.visible,cn.wireframe=bn.wireframe,pn===Ne?cn.side=bn.shadowSide!==null?bn.shadowSide:bn.side:cn.side=bn.shadowSide!==null?bn.shadowSide:mt[bn.side],cn.alphaMap=bn.alphaMap,cn.alphaTest=bn.alphaTest,cn.map=bn.map,cn.clipShadows=bn.clipShadows,cn.clippingPlanes=bn.clippingPlanes,cn.clipIntersection=bn.clipIntersection,cn.displacementMap=bn.displacementMap,cn.displacementScale=bn.displacementScale,cn.displacementBias=bn.displacementBias,cn.wireframeLinewidth=bn.wireframeLinewidth,cn.linewidth=bn.linewidth,Fn.isPointLight===!0&&cn.isMeshDistanceMaterial===!0){const Zn=Be.properties.get(cn);Zn.light=Fn}return cn}function qt(_n,bn,Fn,pn,cn){if(_n.visible===!1)return;if(_n.layers.test(bn.layers)&&(_n.isMesh||_n.isLine||_n.isPoints)&&(_n.castShadow||_n.receiveShadow&&cn===Ne)&&(!_n.frustumCulled||de.intersectsObject(_n))){_n.modelViewMatrix.multiplyMatrices(Fn.matrixWorldInverse,_n.matrixWorld);const Xn=K.update(_n),ri=_n.material;if(Array.isArray(ri)){const wi=Xn.groups;for(let Ji=0,Dr=wi.length;Ji<Dr;Ji++){const Ri=wi[Ji],xr=ri[Ri.materialIndex];if(xr&&xr.visible){const br=Zt(_n,xr,pn,cn);_n.onBeforeShadow(Be,_n,bn,Fn,Xn,br,Ri),Be.renderBufferDirect(Fn,null,Xn,br,_n,Ri),_n.onAfterShadow(Be,_n,bn,Fn,Xn,br,Ri)}}}else if(ri.visible){const wi=Zt(_n,ri,pn,cn);_n.onBeforeShadow(Be,_n,bn,Fn,Xn,wi,null),Be.renderBufferDirect(Fn,null,Xn,wi,_n,null),_n.onAfterShadow(Be,_n,bn,Fn,Xn,wi,null)}}const Zn=_n.children;for(let Xn=0,ri=Zn.length;Xn<ri;Xn++)qt(Zn[Xn],bn,Fn,pn,cn)}function Un(_n){_n.target.removeEventListener("dispose",Un);for(const Fn in Ze){const pn=Ze[Fn],cn=_n.target.uuid;cn in pn&&(pn[cn].dispose(),delete pn[cn])}}}function Kg(Be){function K(){let zn=!1;const gr=new go;let Tr=null;const _s=new go(0,0,0,0);return{setMask:function(ns){Tr!==ns&&!zn&&(Be.colorMask(ns,ns,ns,ns),Tr=ns)},setLocked:function(ns){zn=ns},setClear:function(ns,so,is,Xr,fo){fo===!0&&(ns*=Xr,so*=Xr,is*=Xr),gr.set(ns,so,is,Xr),_s.equals(gr)===!1&&(Be.clearColor(ns,so,is,Xr),_s.copy(gr))},reset:function(){zn=!1,Tr=null,_s.set(-1,0,0,0)}}}function oe(){let zn=!1,gr=null,Tr=null,_s=null;return{setTest:function(ns){ns?ea(Be.DEPTH_TEST):ps(Be.DEPTH_TEST)},setMask:function(ns){gr!==ns&&!zn&&(Be.depthMask(ns),gr=ns)},setFunc:function(ns){if(Tr!==ns){switch(ns){case Vr:Be.depthFunc(Be.NEVER);break;case Ir:Be.depthFunc(Be.ALWAYS);break;case Rr:Be.depthFunc(Be.LESS);break;case ir:Be.depthFunc(Be.LEQUAL);break;case zr:Be.depthFunc(Be.EQUAL);break;case Br:Be.depthFunc(Be.GEQUAL);break;case kt:Be.depthFunc(Be.GREATER);break;case rn:Be.depthFunc(Be.NOTEQUAL);break;default:Be.depthFunc(Be.LEQUAL)}Tr=ns}},setLocked:function(ns){zn=ns},setClear:function(ns){_s!==ns&&(Be.clearDepth(ns),_s=ns)},reset:function(){zn=!1,gr=null,Tr=null,_s=null}}}function de(){let zn=!1,gr=null,Tr=null,_s=null,ns=null,so=null,is=null,Xr=null,fo=null;return{setTest:function(Os){zn||(Os?ea(Be.STENCIL_TEST):ps(Be.STENCIL_TEST))},setMask:function(Os){gr!==Os&&!zn&&(Be.stencilMask(Os),gr=Os)},setFunc:function(Os,R0,Nu){(Tr!==Os||_s!==R0||ns!==Nu)&&(Be.stencilFunc(Os,R0,Nu),Tr=Os,_s=R0,ns=Nu)},setOp:function(Os,R0,Nu){(so!==Os||is!==R0||Xr!==Nu)&&(Be.stencilOp(Os,R0,Nu),so=Os,is=R0,Xr=Nu)},setLocked:function(Os){zn=Os},setClear:function(Os){fo!==Os&&(Be.clearStencil(Os),fo=Os)},reset:function(){zn=!1,gr=null,Tr=null,_s=null,ns=null,so=null,is=null,Xr=null,fo=null}}}const ye=new K,Ie=new oe,Ue=new de,He=new WeakMap,Ke=new WeakMap;let Ze={},at={},mt=new WeakMap,vt=[],St=null,Lt=!1,Ht=null,Dt=null,bt=null,tn=null,Zt=null,qt=null,Un=null,_n=new Wr(0,0,0),bn=0,Fn=!1,pn=null,cn=null,On=null,Zn=null,Xn=null;const ri=Be.getParameter(Be.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let wi=!1,Ji=0;const Dr=Be.getParameter(Be.VERSION);Dr.indexOf("WebGL")!==-1?(Ji=parseFloat(/^WebGL (\d)/.exec(Dr)[1]),wi=Ji>=1):Dr.indexOf("OpenGL ES")!==-1&&(Ji=parseFloat(/^OpenGL ES (\d)/.exec(Dr)[1]),wi=Ji>=2);let Ri=null,xr={};const br=Be.getParameter(Be.SCISSOR_BOX),us=Be.getParameter(Be.VIEWPORT),oo=new go().fromArray(br),Qo=new go().fromArray(us);function ha(zn,gr,Tr,_s){const ns=new Uint8Array(4),so=Be.createTexture();Be.bindTexture(zn,so),Be.texParameteri(zn,Be.TEXTURE_MIN_FILTER,Be.NEAREST),Be.texParameteri(zn,Be.TEXTURE_MAG_FILTER,Be.NEAREST);for(let is=0;is<Tr;is++)zn===Be.TEXTURE_3D||zn===Be.TEXTURE_2D_ARRAY?Be.texImage3D(gr,0,Be.RGBA,1,1,_s,0,Be.RGBA,Be.UNSIGNED_BYTE,ns):Be.texImage2D(gr+is,0,Be.RGBA,1,1,0,Be.RGBA,Be.UNSIGNED_BYTE,ns);return so}const No={};No[Be.TEXTURE_2D]=ha(Be.TEXTURE_2D,Be.TEXTURE_2D,1),No[Be.TEXTURE_CUBE_MAP]=ha(Be.TEXTURE_CUBE_MAP,Be.TEXTURE_CUBE_MAP_POSITIVE_X,6),No[Be.TEXTURE_2D_ARRAY]=ha(Be.TEXTURE_2D_ARRAY,Be.TEXTURE_2D_ARRAY,1,1),No[Be.TEXTURE_3D]=ha(Be.TEXTURE_3D,Be.TEXTURE_3D,1,1),ye.setClear(0,0,0,1),Ie.setClear(1),Ue.setClear(0),ea(Be.DEPTH_TEST),Ie.setFunc(ir),vr(!1),mr(be),ea(Be.CULL_FACE),Vi($e);function ea(zn){Ze[zn]!==!0&&(Be.enable(zn),Ze[zn]=!0)}function ps(zn){Ze[zn]!==!1&&(Be.disable(zn),Ze[zn]=!1)}function sr(zn,gr){return at[zn]!==gr?(Be.bindFramebuffer(zn,gr),at[zn]=gr,zn===Be.DRAW_FRAMEBUFFER&&(at[Be.FRAMEBUFFER]=gr),zn===Be.FRAMEBUFFER&&(at[Be.DRAW_FRAMEBUFFER]=gr),!0):!1}function Fr(zn,gr){let Tr=vt,_s=!1;if(zn){Tr=mt.get(gr),Tr===void 0&&(Tr=[],mt.set(gr,Tr));const ns=zn.textures;if(Tr.length!==ns.length||Tr[0]!==Be.COLOR_ATTACHMENT0){for(let so=0,is=ns.length;so<is;so++)Tr[so]=Be.COLOR_ATTACHMENT0+so;Tr.length=ns.length,_s=!0}}else Tr[0]!==Be.BACK&&(Tr[0]=Be.BACK,_s=!0);_s&&Be.drawBuffers(Tr)}function Qr(zn){return St!==zn?(Be.useProgram(zn),St=zn,!0):!1}const si={[Mt]:Be.FUNC_ADD,[Gt]:Be.FUNC_SUBTRACT,[_t]:Be.FUNC_REVERSE_SUBTRACT};si[Bt]=Be.MIN,si[dt]=Be.MAX;const or={[ut]:Be.ZERO,[Ut]:Be.ONE,[Tt]:Be.SRC_COLOR,[hn]:Be.SRC_ALPHA,[fi]:Be.SRC_ALPHA_SATURATE,[Nn]:Be.DST_COLOR,[An]:Be.DST_ALPHA,[Xt]:Be.ONE_MINUS_SRC_COLOR,[nn]:Be.ONE_MINUS_SRC_ALPHA,[Qn]:Be.ONE_MINUS_DST_COLOR,[Cn]:Be.ONE_MINUS_DST_ALPHA,[hi]:Be.CONSTANT_COLOR,[Qi]:Be.ONE_MINUS_CONSTANT_COLOR,[Zi]:Be.CONSTANT_ALPHA,[Mn]:Be.ONE_MINUS_CONSTANT_ALPHA};function Vi(zn,gr,Tr,_s,ns,so,is,Xr,fo,Os){if(zn===$e){Lt===!0&&(ps(Be.BLEND),Lt=!1);return}if(Lt===!1&&(ea(Be.BLEND),Lt=!0),zn!==Rt){if(zn!==Ht||Os!==Fn){if((Dt!==Mt||Zt!==Mt)&&(Be.blendEquation(Be.FUNC_ADD),Dt=Mt,Zt=Mt),Os)switch(zn){case st:Be.blendFuncSeparate(Be.ONE,Be.ONE_MINUS_SRC_ALPHA,Be.ONE,Be.ONE_MINUS_SRC_ALPHA);break;case ze:Be.blendFunc(Be.ONE,Be.ONE);break;case tt:Be.blendFuncSeparate(Be.ZERO,Be.ONE_MINUS_SRC_COLOR,Be.ZERO,Be.ONE);break;case ft:Be.blendFuncSeparate(Be.ZERO,Be.SRC_COLOR,Be.ZERO,Be.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",zn);break}else switch(zn){case st:Be.blendFuncSeparate(Be.SRC_ALPHA,Be.ONE_MINUS_SRC_ALPHA,Be.ONE,Be.ONE_MINUS_SRC_ALPHA);break;case ze:Be.blendFunc(Be.SRC_ALPHA,Be.ONE);break;case tt:Be.blendFuncSeparate(Be.ZERO,Be.ONE_MINUS_SRC_COLOR,Be.ZERO,Be.ONE);break;case ft:Be.blendFunc(Be.ZERO,Be.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",zn);break}bt=null,tn=null,qt=null,Un=null,_n.set(0,0,0),bn=0,Ht=zn,Fn=Os}return}ns=ns||gr,so=so||Tr,is=is||_s,(gr!==Dt||ns!==Zt)&&(Be.blendEquationSeparate(si[gr],si[ns]),Dt=gr,Zt=ns),(Tr!==bt||_s!==tn||so!==qt||is!==Un)&&(Be.blendFuncSeparate(or[Tr],or[_s],or[so],or[is]),bt=Tr,tn=_s,qt=so,Un=is),(Xr.equals(_n)===!1||fo!==bn)&&(Be.blendColor(Xr.r,Xr.g,Xr.b,fo),_n.copy(Xr),bn=fo),Ht=zn,Fn=!1}function _r(zn,gr){zn.side===Xe?ps(Be.CULL_FACE):ea(Be.CULL_FACE);let Tr=zn.side===Ve;gr&&(Tr=!Tr),vr(Tr),zn.blending===st&&zn.transparent===!1?Vi($e):Vi(zn.blending,zn.blendEquation,zn.blendSrc,zn.blendDst,zn.blendEquationAlpha,zn.blendSrcAlpha,zn.blendDstAlpha,zn.blendColor,zn.blendAlpha,zn.premultipliedAlpha),Ie.setFunc(zn.depthFunc),Ie.setTest(zn.depthTest),Ie.setMask(zn.depthWrite),ye.setMask(zn.colorWrite);const _s=zn.stencilWrite;Ue.setTest(_s),_s&&(Ue.setMask(zn.stencilWriteMask),Ue.setFunc(zn.stencilFunc,zn.stencilRef,zn.stencilFuncMask),Ue.setOp(zn.stencilFail,zn.stencilZFail,zn.stencilZPass)),rs(zn.polygonOffset,zn.polygonOffsetFactor,zn.polygonOffsetUnits),zn.alphaToCoverage===!0?ea(Be.SAMPLE_ALPHA_TO_COVERAGE):ps(Be.SAMPLE_ALPHA_TO_COVERAGE)}function vr(zn){pn!==zn&&(zn?Be.frontFace(Be.CW):Be.frontFace(Be.CCW),pn=zn)}function mr(zn){zn!==Re?(ea(Be.CULL_FACE),zn!==cn&&(zn===be?Be.cullFace(Be.BACK):zn===Pe?Be.cullFace(Be.FRONT):Be.cullFace(Be.FRONT_AND_BACK))):ps(Be.CULL_FACE),cn=zn}function $r(zn){zn!==On&&(wi&&Be.lineWidth(zn),On=zn)}function rs(zn,gr,Tr){zn?(ea(Be.POLYGON_OFFSET_FILL),(Zn!==gr||Xn!==Tr)&&(Be.polygonOffset(gr,Tr),Zn=gr,Xn=Tr)):ps(Be.POLYGON_OFFSET_FILL)}function Vs(zn){zn?ea(Be.SCISSOR_TEST):ps(Be.SCISSOR_TEST)}function Js(zn){zn===void 0&&(zn=Be.TEXTURE0+ri-1),Ri!==zn&&(Be.activeTexture(zn),Ri=zn)}function Uo(zn,gr,Tr){Tr===void 0&&(Ri===null?Tr=Be.TEXTURE0+ri-1:Tr=Ri);let _s=xr[Tr];_s===void 0&&(_s={type:void 0,texture:void 0},xr[Tr]=_s),(_s.type!==zn||_s.texture!==gr)&&(Ri!==Tr&&(Be.activeTexture(Tr),Ri=Tr),Be.bindTexture(zn,gr||No[zn]),_s.type=zn,_s.texture=gr)}function Ha(){const zn=xr[Ri];zn!==void 0&&zn.type!==void 0&&(Be.bindTexture(zn.type,null),zn.type=void 0,zn.texture=void 0)}function da(){try{Be.compressedTexImage2D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function Ln(){try{Be.compressedTexImage3D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function un(){try{Be.texSubImage2D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function Ni(){try{Be.texSubImage3D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function nr(){try{Be.compressedTexSubImage2D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function hr(){try{Be.compressedTexSubImage3D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function lr(){try{Be.texStorage2D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function Es(){try{Be.texStorage3D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function Pr(){try{Be.texImage2D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function ss(){try{Be.texImage3D.apply(Be,arguments)}catch(zn){console.error("THREE.WebGLState:",zn)}}function Yo(zn){oo.equals(zn)===!1&&(Be.scissor(zn.x,zn.y,zn.z,zn.w),oo.copy(zn))}function os(zn){Qo.equals(zn)===!1&&(Be.viewport(zn.x,zn.y,zn.z,zn.w),Qo.copy(zn))}function Cs(zn,gr){let Tr=Ke.get(gr);Tr===void 0&&(Tr=new WeakMap,Ke.set(gr,Tr));let _s=Tr.get(zn);_s===void 0&&(_s=Be.getUniformBlockIndex(gr,zn.name),Tr.set(zn,_s))}function ro(zn,gr){const _s=Ke.get(gr).get(zn);He.get(gr)!==_s&&(Be.uniformBlockBinding(gr,_s,zn.__bindingPointIndex),He.set(gr,_s))}function Ps(){Be.disable(Be.BLEND),Be.disable(Be.CULL_FACE),Be.disable(Be.DEPTH_TEST),Be.disable(Be.POLYGON_OFFSET_FILL),Be.disable(Be.SCISSOR_TEST),Be.disable(Be.STENCIL_TEST),Be.disable(Be.SAMPLE_ALPHA_TO_COVERAGE),Be.blendEquation(Be.FUNC_ADD),Be.blendFunc(Be.ONE,Be.ZERO),Be.blendFuncSeparate(Be.ONE,Be.ZERO,Be.ONE,Be.ZERO),Be.blendColor(0,0,0,0),Be.colorMask(!0,!0,!0,!0),Be.clearColor(0,0,0,0),Be.depthMask(!0),Be.depthFunc(Be.LESS),Be.clearDepth(1),Be.stencilMask(4294967295),Be.stencilFunc(Be.ALWAYS,0,4294967295),Be.stencilOp(Be.KEEP,Be.KEEP,Be.KEEP),Be.clearStencil(0),Be.cullFace(Be.BACK),Be.frontFace(Be.CCW),Be.polygonOffset(0,0),Be.activeTexture(Be.TEXTURE0),Be.bindFramebuffer(Be.FRAMEBUFFER,null),Be.bindFramebuffer(Be.DRAW_FRAMEBUFFER,null),Be.bindFramebuffer(Be.READ_FRAMEBUFFER,null),Be.useProgram(null),Be.lineWidth(1),Be.scissor(0,0,Be.canvas.width,Be.canvas.height),Be.viewport(0,0,Be.canvas.width,Be.canvas.height),Ze={},Ri=null,xr={},at={},mt=new WeakMap,vt=[],St=null,Lt=!1,Ht=null,Dt=null,bt=null,tn=null,Zt=null,qt=null,Un=null,_n=new Wr(0,0,0),bn=0,Fn=!1,pn=null,cn=null,On=null,Zn=null,Xn=null,oo.set(0,0,Be.canvas.width,Be.canvas.height),Qo.set(0,0,Be.canvas.width,Be.canvas.height),ye.reset(),Ie.reset(),Ue.reset()}return{buffers:{color:ye,depth:Ie,stencil:Ue},enable:ea,disable:ps,bindFramebuffer:sr,drawBuffers:Fr,useProgram:Qr,setBlending:Vi,setMaterial:_r,setFlipSided:vr,setCullFace:mr,setLineWidth:$r,setPolygonOffset:rs,setScissorTest:Vs,activeTexture:Js,bindTexture:Uo,unbindTexture:Ha,compressedTexImage2D:da,compressedTexImage3D:Ln,texImage2D:Pr,texImage3D:ss,updateUBOMapping:Cs,uniformBlockBinding:ro,texStorage2D:lr,texStorage3D:Es,texSubImage2D:un,texSubImage3D:Ni,compressedTexSubImage2D:nr,compressedTexSubImage3D:hr,scissor:Yo,viewport:os,reset:Ps}}function Yg(Be,K,oe,de,ye,Ie,Ue){const He=K.has("WEBGL_multisampled_render_to_texture")?K.get("WEBGL_multisampled_render_to_texture"):null,Ke=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),Ze=K.has("OCULUS_multiview")?K.get("OCULUS_multiview"):null,at=new qi,mt=new WeakMap;let vt;const St=new WeakMap;let Lt=[],Ht=!1,Dt=!1;try{Dt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function bt(Ln,un){return Dt?new OffscreenCanvas(Ln,un):cc("canvas")}function tn(Ln,un,Ni){let nr=1;const hr=da(Ln);if((hr.width>Ni||hr.height>Ni)&&(nr=Ni/Math.max(hr.width,hr.height)),nr<1)if(typeof HTMLImageElement<"u"&&Ln instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ln instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ln instanceof ImageBitmap||typeof VideoFrame<"u"&&Ln instanceof VideoFrame){const lr=Math.floor(nr*hr.width),Es=Math.floor(nr*hr.height);vt===void 0&&(vt=bt(lr,Es));const Pr=un?bt(lr,Es):vt;return Pr.width=lr,Pr.height=Es,Pr.getContext("2d").drawImage(Ln,0,0,lr,Es),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+hr.width+"x"+hr.height+") to ("+lr+"x"+Es+")."),Pr}else return"data"in Ln&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+hr.width+"x"+hr.height+")."),Ln;return Ln}function Zt(Ln){return Ln.generateMipmaps&&Ln.minFilter!==ki&&Ln.minFilter!==Jr}function qt(Ln){Be.generateMipmap(Ln)}function Un(Ln,un,Ni,nr,hr=!1){if(Ln!==null){if(Be[Ln]!==void 0)return Be[Ln];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ln+"'")}let lr=un;if(un===Be.RED&&(Ni===Be.FLOAT&&(lr=Be.R32F),Ni===Be.HALF_FLOAT&&(lr=Be.R16F),Ni===Be.UNSIGNED_BYTE&&(lr=Be.R8)),un===Be.RED_INTEGER&&(Ni===Be.UNSIGNED_BYTE&&(lr=Be.R8UI),Ni===Be.UNSIGNED_SHORT&&(lr=Be.R16UI),Ni===Be.UNSIGNED_INT&&(lr=Be.R32UI),Ni===Be.BYTE&&(lr=Be.R8I),Ni===Be.SHORT&&(lr=Be.R16I),Ni===Be.INT&&(lr=Be.R32I)),un===Be.RG&&(Ni===Be.FLOAT&&(lr=Be.RG32F),Ni===Be.HALF_FLOAT&&(lr=Be.RG16F),Ni===Be.UNSIGNED_BYTE&&(lr=Be.RG8)),un===Be.RG_INTEGER&&(Ni===Be.UNSIGNED_BYTE&&(lr=Be.RG8UI),Ni===Be.UNSIGNED_SHORT&&(lr=Be.RG16UI),Ni===Be.UNSIGNED_INT&&(lr=Be.RG32UI),Ni===Be.BYTE&&(lr=Be.RG8I),Ni===Be.SHORT&&(lr=Be.RG16I),Ni===Be.INT&&(lr=Be.RG32I)),un===Be.RGB&&Ni===Be.UNSIGNED_INT_5_9_9_9_REV&&(lr=Be.RGB9_E5),un===Be.RGBA){const Es=hr?Tc:To.getTransfer(nr);Ni===Be.FLOAT&&(lr=Be.RGBA32F),Ni===Be.HALF_FLOAT&&(lr=Be.RGBA16F),Ni===Be.UNSIGNED_BYTE&&(lr=Es===bo?Be.SRGB8_ALPHA8:Be.RGBA8),Ni===Be.UNSIGNED_SHORT_4_4_4_4&&(lr=Be.RGBA4),Ni===Be.UNSIGNED_SHORT_5_5_5_1&&(lr=Be.RGB5_A1)}return(lr===Be.R16F||lr===Be.R32F||lr===Be.RG16F||lr===Be.RG32F||lr===Be.RGBA16F||lr===Be.RGBA32F)&&K.get("EXT_color_buffer_float"),lr}function _n(Ln,un){return Zt(Ln)===!0||Ln.isFramebufferTexture&&Ln.minFilter!==ki&&Ln.minFilter!==Jr?Math.log2(Math.max(un.width,un.height))+1:Ln.mipmaps!==void 0&&Ln.mipmaps.length>0?Ln.mipmaps.length:Ln.isCompressedTexture&&Array.isArray(Ln.image)?un.mipmaps.length:1}function bn(Ln){const un=Ln.target;un.removeEventListener("dispose",bn),pn(un),un.isVideoTexture&&mt.delete(un)}function Fn(Ln){const un=Ln.target;un.removeEventListener("dispose",Fn),On(un)}function pn(Ln){const un=de.get(Ln);if(un.__webglInit===void 0)return;const Ni=Ln.source,nr=St.get(Ni);if(nr){const hr=nr[un.__cacheKey];hr.usedTimes--,hr.usedTimes===0&&cn(Ln),Object.keys(nr).length===0&&St.delete(Ni)}de.remove(Ln)}function cn(Ln){const un=de.get(Ln);Be.deleteTexture(un.__webglTexture);const Ni=Ln.source,nr=St.get(Ni);delete nr[un.__cacheKey],Ue.memory.textures--}function On(Ln){const un=de.get(Ln);if(Ln.depthTexture&&Ln.depthTexture.dispose(),Ln.isWebGLCubeRenderTarget)for(let nr=0;nr<6;nr++){if(Array.isArray(un.__webglFramebuffer[nr]))for(let hr=0;hr<un.__webglFramebuffer[nr].length;hr++)Be.deleteFramebuffer(un.__webglFramebuffer[nr][hr]);else Be.deleteFramebuffer(un.__webglFramebuffer[nr]);un.__webglDepthbuffer&&Be.deleteRenderbuffer(un.__webglDepthbuffer[nr])}else{if(Array.isArray(un.__webglFramebuffer))for(let nr=0;nr<un.__webglFramebuffer.length;nr++)Be.deleteFramebuffer(un.__webglFramebuffer[nr]);else Be.deleteFramebuffer(un.__webglFramebuffer);if(un.__webglDepthbuffer&&Be.deleteRenderbuffer(un.__webglDepthbuffer),un.__webglMultisampledFramebuffer&&Be.deleteFramebuffer(un.__webglMultisampledFramebuffer),un.__webglColorRenderbuffer)for(let nr=0;nr<un.__webglColorRenderbuffer.length;nr++)un.__webglColorRenderbuffer[nr]&&Be.deleteRenderbuffer(un.__webglColorRenderbuffer[nr]);un.__webglDepthRenderbuffer&&Be.deleteRenderbuffer(un.__webglDepthRenderbuffer)}const Ni=Ln.textures;for(let nr=0,hr=Ni.length;nr<hr;nr++){const lr=de.get(Ni[nr]);lr.__webglTexture&&(Be.deleteTexture(lr.__webglTexture),Ue.memory.textures--),de.remove(Ni[nr])}de.remove(Ln)}let Zn=0;function Xn(){Zn=0}function ri(){const Ln=Zn;return Ln>=ye.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ln+" texture units while this GPU supports only "+ye.maxTextures),Zn+=1,Ln}function wi(Ln){const un=[];return un.push(Ln.wrapS),un.push(Ln.wrapT),un.push(Ln.wrapR||0),un.push(Ln.magFilter),un.push(Ln.minFilter),un.push(Ln.anisotropy),un.push(Ln.internalFormat),un.push(Ln.format),un.push(Ln.type),un.push(Ln.generateMipmaps),un.push(Ln.premultiplyAlpha),un.push(Ln.flipY),un.push(Ln.unpackAlignment),un.push(Ln.colorSpace),un.join()}function Ji(Ln,un){const Ni=de.get(Ln);if(Ln.isVideoTexture&&Uo(Ln),Ln.isRenderTargetTexture===!1&&Ln.version>0&&Ni.__version!==Ln.version){const nr=Ln.image;if(nr===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(nr.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(ps(Ni,Ln,un))return}oe.bindTexture(Be.TEXTURE_2D,Ni.__webglTexture,Be.TEXTURE0+un)}function Dr(Ln,un){const Ni=de.get(Ln);if(Ln.version>0&&Ni.__version!==Ln.version){ps(Ni,Ln,un);return}oe.bindTexture(Be.TEXTURE_2D_ARRAY,Ni.__webglTexture,Be.TEXTURE0+un)}function Ri(Ln,un){const Ni=de.get(Ln);if(Ln.version>0&&Ni.__version!==Ln.version){ps(Ni,Ln,un);return}oe.bindTexture(Be.TEXTURE_3D,Ni.__webglTexture,Be.TEXTURE0+un)}function xr(Ln,un){const Ni=de.get(Ln);if(Ln.version>0&&Ni.__version!==Ln.version){sr(Ni,Ln,un);return}oe.bindTexture(Be.TEXTURE_CUBE_MAP,Ni.__webglTexture,Be.TEXTURE0+un)}const br={[sn]:Be.REPEAT,[yn]:Be.CLAMP_TO_EDGE,[ni]:Be.MIRRORED_REPEAT},us={[ki]:Be.NEAREST,[Hi]:Be.NEAREST_MIPMAP_NEAREST,[Xi]:Be.NEAREST_MIPMAP_LINEAR,[Jr]:Be.LINEAR,[Ai]:Be.LINEAR_MIPMAP_NEAREST,[Qs]:Be.LINEAR_MIPMAP_LINEAR},oo={[yh]:Be.NEVER,[bh]:Be.ALWAYS,[Ch]:Be.LESS,[du]:Be.LEQUAL,[xh]:Be.EQUAL,[Mh]:Be.GEQUAL,[wh]:Be.GREATER,[Sh]:Be.NOTEQUAL};function Qo(Ln,un){if(un.type===ko&&K.has("OES_texture_float_linear")===!1&&(un.magFilter===Jr||un.magFilter===Ai||un.magFilter===Xi||un.magFilter===Qs||un.minFilter===Jr||un.minFilter===Ai||un.minFilter===Xi||un.minFilter===Qs)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),Be.texParameteri(Ln,Be.TEXTURE_WRAP_S,br[un.wrapS]),Be.texParameteri(Ln,Be.TEXTURE_WRAP_T,br[un.wrapT]),(Ln===Be.TEXTURE_3D||Ln===Be.TEXTURE_2D_ARRAY)&&Be.texParameteri(Ln,Be.TEXTURE_WRAP_R,br[un.wrapR]),Be.texParameteri(Ln,Be.TEXTURE_MAG_FILTER,us[un.magFilter]),Be.texParameteri(Ln,Be.TEXTURE_MIN_FILTER,us[un.minFilter]),un.compareFunction&&(Be.texParameteri(Ln,Be.TEXTURE_COMPARE_MODE,Be.COMPARE_REF_TO_TEXTURE),Be.texParameteri(Ln,Be.TEXTURE_COMPARE_FUNC,oo[un.compareFunction])),K.has("EXT_texture_filter_anisotropic")===!0){if(un.magFilter===ki||un.minFilter!==Xi&&un.minFilter!==Qs||un.type===ko&&K.has("OES_texture_float_linear")===!1)return;if(un.anisotropy>1||de.get(un).__currentAnisotropy){const Ni=K.get("EXT_texture_filter_anisotropic");Be.texParameterf(Ln,Ni.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(un.anisotropy,ye.getMaxAnisotropy())),de.get(un).__currentAnisotropy=un.anisotropy}}}function ha(Ln,un){let Ni=!1;Ln.__webglInit===void 0&&(Ln.__webglInit=!0,un.addEventListener("dispose",bn));const nr=un.source;let hr=St.get(nr);hr===void 0&&(hr={},St.set(nr,hr));const lr=wi(un);if(lr!==Ln.__cacheKey){hr[lr]===void 0&&(hr[lr]={texture:Be.createTexture(),usedTimes:0},Ue.memory.textures++,Ni=!0),hr[lr].usedTimes++;const Es=hr[Ln.__cacheKey];Es!==void 0&&(hr[Ln.__cacheKey].usedTimes--,Es.usedTimes===0&&cn(un)),Ln.__cacheKey=lr,Ln.__webglTexture=hr[lr].texture}return Ni}function No(Ln){Ht=Ln}function ea(){const Ln=Ht;Ht=!1;for(const un of Lt)ps(un.textureProperties,un.texture,un.slot),un.texture.isPendingDeferredUpload=!1;Lt=[],Ht=Ln}function ps(Ln,un,Ni){if(Ht)return un.isPendingDeferredUpload||(un.isPendingDeferredUpload=!0,Lt.push({textureProperties:Ln,texture:un,slot:Ni})),!1;let nr=Be.TEXTURE_2D;(un.isDataArrayTexture||un.isCompressedArrayTexture)&&(nr=Be.TEXTURE_2D_ARRAY),un.isData3DTexture&&(nr=Be.TEXTURE_3D);const hr=ha(Ln,un),lr=un.source;oe.bindTexture(nr,Ln.__webglTexture,Be.TEXTURE0+Ni);const Es=de.get(lr);if(lr.version!==Es.__version||hr===!0){oe.activeTexture(Be.TEXTURE0+Ni);const Pr=To.getPrimaries(To.workingColorSpace),ss=un.colorSpace===Ba?null:To.getPrimaries(un.colorSpace),Yo=un.colorSpace===Ba||Pr===ss?Be.NONE:Be.BROWSER_DEFAULT_WEBGL;Be.pixelStorei(Be.UNPACK_FLIP_Y_WEBGL,un.flipY),Be.pixelStorei(Be.UNPACK_PREMULTIPLY_ALPHA_WEBGL,un.premultiplyAlpha),Be.pixelStorei(Be.UNPACK_ALIGNMENT,un.unpackAlignment),Be.pixelStorei(Be.UNPACK_COLORSPACE_CONVERSION_WEBGL,Yo);let os=tn(un.image,!1,ye.maxTextureSize);os=Ha(un,os);const Cs=Ie.convert(un.format,un.colorSpace),ro=Ie.convert(un.type);let Ps=Un(un.internalFormat,Cs,ro,un.colorSpace,un.isVideoTexture);Qo(nr,un);let zn;const gr=un.mipmaps,Tr=un.isVideoTexture!==!0,_s=Es.__version===void 0||hr===!0,ns=lr.dataReady,so=_n(un,os);if(un.isDepthTexture)Ps=Be.DEPTH_COMPONENT16,un.type===ko?Ps=Be.DEPTH_COMPONENT32F:un.type===Ra?Ps=Be.DEPTH_COMPONENT24:un.type===dn&&(Ps=Be.DEPTH24_STENCIL8),_s&&(Tr?oe.texStorage2D(Be.TEXTURE_2D,1,Ps,os.width,os.height):oe.texImage2D(Be.TEXTURE_2D,0,Ps,os.width,os.height,0,Cs,ro,null));else if(un.isDataTexture)if(gr.length>0){Tr&&_s&&oe.texStorage2D(Be.TEXTURE_2D,so,Ps,gr[0].width,gr[0].height);for(let is=0,Xr=gr.length;is<Xr;is++)zn=gr[is],Tr?ns&&oe.texSubImage2D(Be.TEXTURE_2D,is,0,0,zn.width,zn.height,Cs,ro,zn.data):oe.texImage2D(Be.TEXTURE_2D,is,Ps,zn.width,zn.height,0,Cs,ro,zn.data);un.generateMipmaps=!1}else Tr?(_s&&oe.texStorage2D(Be.TEXTURE_2D,so,Ps,os.width,os.height),ns&&oe.texSubImage2D(Be.TEXTURE_2D,0,0,0,os.width,os.height,Cs,ro,os.data)):oe.texImage2D(Be.TEXTURE_2D,0,Ps,os.width,os.height,0,Cs,ro,os.data);else if(un.isCompressedTexture)if(un.isCompressedArrayTexture){Tr&&_s&&oe.texStorage3D(Be.TEXTURE_2D_ARRAY,so,Ps,gr[0].width,gr[0].height,os.depth);for(let is=0,Xr=gr.length;is<Xr;is++)zn=gr[is],un.format!==Jt?Cs!==null?Tr?ns&&oe.compressedTexSubImage3D(Be.TEXTURE_2D_ARRAY,is,0,0,0,zn.width,zn.height,os.depth,Cs,zn.data,0,0):oe.compressedTexImage3D(Be.TEXTURE_2D_ARRAY,is,Ps,zn.width,zn.height,os.depth,0,zn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Tr?ns&&oe.texSubImage3D(Be.TEXTURE_2D_ARRAY,is,0,0,0,zn.width,zn.height,os.depth,Cs,ro,zn.data):oe.texImage3D(Be.TEXTURE_2D_ARRAY,is,Ps,zn.width,zn.height,os.depth,0,Cs,ro,zn.data)}else{Tr&&_s&&oe.texStorage2D(Be.TEXTURE_2D,so,Ps,gr[0].width,gr[0].height);for(let is=0,Xr=gr.length;is<Xr;is++)zn=gr[is],un.format!==Jt?Cs!==null?Tr?ns&&oe.compressedTexSubImage2D(Be.TEXTURE_2D,is,0,0,zn.width,zn.height,Cs,zn.data):oe.compressedTexImage2D(Be.TEXTURE_2D,is,Ps,zn.width,zn.height,0,zn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Tr?ns&&oe.texSubImage2D(Be.TEXTURE_2D,is,0,0,zn.width,zn.height,Cs,ro,zn.data):oe.texImage2D(Be.TEXTURE_2D,is,Ps,zn.width,zn.height,0,Cs,ro,zn.data)}else if(un.isDataArrayTexture)Tr?(_s&&oe.texStorage3D(Be.TEXTURE_2D_ARRAY,so,Ps,os.width,os.height,os.depth),ns&&oe.texSubImage3D(Be.TEXTURE_2D_ARRAY,0,0,0,0,os.width,os.height,os.depth,Cs,ro,os.data)):oe.texImage3D(Be.TEXTURE_2D_ARRAY,0,Ps,os.width,os.height,os.depth,0,Cs,ro,os.data);else if(un.isData3DTexture)Tr?(_s&&oe.texStorage3D(Be.TEXTURE_3D,so,Ps,os.width,os.height,os.depth),ns&&oe.texSubImage3D(Be.TEXTURE_3D,0,0,0,0,os.width,os.height,os.depth,Cs,ro,os.data)):oe.texImage3D(Be.TEXTURE_3D,0,Ps,os.width,os.height,os.depth,0,Cs,ro,os.data);else if(un.isFramebufferTexture){if(_s)if(Tr)oe.texStorage2D(Be.TEXTURE_2D,so,Ps,os.width,os.height);else{let is=os.width,Xr=os.height;for(let fo=0;fo<so;fo++)oe.texImage2D(Be.TEXTURE_2D,fo,Ps,is,Xr,0,Cs,ro,null),is>>=1,Xr>>=1}}else if(gr.length>0){if(Tr&&_s){const is=da(gr[0]);oe.texStorage2D(Be.TEXTURE_2D,so,Ps,is.width,is.height)}for(let is=0,Xr=gr.length;is<Xr;is++)zn=gr[is],Tr?ns&&oe.texSubImage2D(Be.TEXTURE_2D,is,0,0,Cs,ro,zn):oe.texImage2D(Be.TEXTURE_2D,is,Ps,Cs,ro,zn);un.generateMipmaps=!1}else if(Tr){if(_s){const is=da(os);oe.texStorage2D(Be.TEXTURE_2D,so,Ps,is.width,is.height)}ns&&oe.texSubImage2D(Be.TEXTURE_2D,0,0,0,Cs,ro,os)}else oe.texImage2D(Be.TEXTURE_2D,0,Ps,Cs,ro,os);Zt(un)&&qt(nr),Es.__version=lr.version,un.onUpdate&&un.onUpdate(un)}return Ln.__version=un.version,!0}function sr(Ln,un,Ni){if(un.image.length!==6)return;const nr=ha(Ln,un),hr=un.source;oe.bindTexture(Be.TEXTURE_CUBE_MAP,Ln.__webglTexture,Be.TEXTURE0+Ni);const lr=de.get(hr);if(hr.version!==lr.__version||nr===!0){oe.activeTexture(Be.TEXTURE0+Ni);const Es=To.getPrimaries(To.workingColorSpace),Pr=un.colorSpace===Ba?null:To.getPrimaries(un.colorSpace),ss=un.colorSpace===Ba||Es===Pr?Be.NONE:Be.BROWSER_DEFAULT_WEBGL;Be.pixelStorei(Be.UNPACK_FLIP_Y_WEBGL,un.flipY),Be.pixelStorei(Be.UNPACK_PREMULTIPLY_ALPHA_WEBGL,un.premultiplyAlpha),Be.pixelStorei(Be.UNPACK_ALIGNMENT,un.unpackAlignment),Be.pixelStorei(Be.UNPACK_COLORSPACE_CONVERSION_WEBGL,ss);const Yo=un.isCompressedTexture||un.image[0].isCompressedTexture,os=un.image[0]&&un.image[0].isDataTexture,Cs=[];for(let Xr=0;Xr<6;Xr++)!Yo&&!os?Cs[Xr]=tn(un.image[Xr],!0,ye.maxCubemapSize):Cs[Xr]=os?un.image[Xr].image:un.image[Xr],Cs[Xr]=Ha(un,Cs[Xr]);const ro=Cs[0],Ps=Ie.convert(un.format,un.colorSpace),zn=Ie.convert(un.type),gr=Un(un.internalFormat,Ps,zn,un.colorSpace),Tr=un.isVideoTexture!==!0,_s=lr.__version===void 0||nr===!0,ns=hr.dataReady;let so=_n(un,ro);Qo(Be.TEXTURE_CUBE_MAP,un);let is;if(Yo){Tr&&_s&&oe.texStorage2D(Be.TEXTURE_CUBE_MAP,so,gr,ro.width,ro.height);for(let Xr=0;Xr<6;Xr++){is=Cs[Xr].mipmaps;for(let fo=0;fo<is.length;fo++){const Os=is[fo];un.format!==Jt?Ps!==null?Tr?ns&&oe.compressedTexSubImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo,0,0,Os.width,Os.height,Ps,Os.data):oe.compressedTexImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo,gr,Os.width,Os.height,0,Os.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Tr?ns&&oe.texSubImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo,0,0,Os.width,Os.height,Ps,zn,Os.data):oe.texImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo,gr,Os.width,Os.height,0,Ps,zn,Os.data)}}}else{if(is=un.mipmaps,Tr&&_s){is.length>0&&so++;const Xr=da(Cs[0]);oe.texStorage2D(Be.TEXTURE_CUBE_MAP,so,gr,Xr.width,Xr.height)}for(let Xr=0;Xr<6;Xr++)if(os){Tr?ns&&oe.texSubImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,0,0,0,Cs[Xr].width,Cs[Xr].height,Ps,zn,Cs[Xr].data):oe.texImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,0,gr,Cs[Xr].width,Cs[Xr].height,0,Ps,zn,Cs[Xr].data);for(let fo=0;fo<is.length;fo++){const R0=is[fo].image[Xr].image;Tr?ns&&oe.texSubImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo+1,0,0,R0.width,R0.height,Ps,zn,R0.data):oe.texImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo+1,gr,R0.width,R0.height,0,Ps,zn,R0.data)}}else{Tr?ns&&oe.texSubImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,0,0,0,Ps,zn,Cs[Xr]):oe.texImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,0,gr,Ps,zn,Cs[Xr]);for(let fo=0;fo<is.length;fo++){const Os=is[fo];Tr?ns&&oe.texSubImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo+1,0,0,Ps,zn,Os.image[Xr]):oe.texImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+Xr,fo+1,gr,Ps,zn,Os.image[Xr])}}}Zt(un)&&qt(Be.TEXTURE_CUBE_MAP),lr.__version=hr.version,un.onUpdate&&un.onUpdate(un)}Ln.__version=un.version}function Fr(Ln,un,Ni,nr,hr,lr){const Es=Ie.convert(Ni.format,Ni.colorSpace),Pr=Ie.convert(Ni.type),ss=Un(Ni.internalFormat,Es,Pr,Ni.colorSpace);if(!de.get(un).__hasExternalTextures){const Cs=Math.max(1,un.width>>lr),ro=Math.max(1,un.height>>lr);un.isWebGLMultiviewRenderTarget===!0?oe.texStorage3D(Be.TEXTURE_2D_ARRAY,0,ss,un.width,un.height,un.numViews):hr===Be.TEXTURE_3D||hr===Be.TEXTURE_2D_ARRAY?oe.texImage3D(hr,lr,ss,Cs,ro,un.depth,0,Es,Pr,null):oe.texImage2D(hr,lr,ss,Cs,ro,0,Es,Pr,null)}oe.bindFramebuffer(Be.FRAMEBUFFER,Ln);const os=Js(un);un.isWebGLMultiviewRenderTarget===!0?os?Ze.framebufferTextureMultisampleMultiviewOVR(Be.FRAMEBUFFER,Be.COLOR_ATTACHMENT0,de.get(Ni).__webglTexture,0,Vs(un),0,un.numViews):Ze.framebufferTextureMultiviewOVR(Be.FRAMEBUFFER,Be.COLOR_ATTACHMENT0,de.get(Ni).__webglTexture,0,0,un.numViews):(hr===Be.TEXTURE_2D||hr>=Be.TEXTURE_CUBE_MAP_POSITIVE_X&&hr<=Be.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(os?He.framebufferTexture2DMultisampleEXT(Be.FRAMEBUFFER,nr,hr,de.get(Ni).__webglTexture,0,Vs(un)):Be.framebufferTexture2D(Be.FRAMEBUFFER,nr,hr,de.get(Ni).__webglTexture,lr)),oe.bindFramebuffer(Be.FRAMEBUFFER,null)}function Qr(Ln,un,Ni){if(Be.bindRenderbuffer(Be.RENDERBUFFER,Ln),un.isWebGLMultiviewRenderTarget===!0){const nr=Js(un),hr=un.numViews,lr=un.depthTexture;let Es=Be.DEPTH_COMPONENT24,Pr=Be.DEPTH_ATTACHMENT;lr&&lr.isDepthTexture&&(lr.type===ko?Es=Be.DEPTH_COMPONENT32F:lr.type===dn&&(Es=Be.DEPTH24_STENCIL8,Pr=Be.DEPTH_STENCIL_ATTACHMENT));let ss=de.get(un.depthTexture).__webglTexture;ss===void 0&&(ss=Be.createTexture(),Be.bindTexture(Be.TEXTURE_2D_ARRAY,ss),Be.texStorage3D(Be.TEXTURE_2D_ARRAY,1,Es,un.width,un.height,hr)),nr?Ze.framebufferTextureMultisampleMultiviewOVR(Be.FRAMEBUFFER,Pr,ss,0,Vs(un),0,hr):Ze.framebufferTextureMultiviewOVR(Be.FRAMEBUFFER,Pr,ss,0,0,hr)}else if(un.depthBuffer&&!un.stencilBuffer){let nr=Be.DEPTH_COMPONENT24;if(Ni||Js(un)){const hr=un.depthTexture;hr&&hr.isDepthTexture&&(hr.type===ko?nr=Be.DEPTH_COMPONENT32F:hr.type===Ra&&(nr=Be.DEPTH_COMPONENT24));const lr=Vs(un);Js(un)?He.renderbufferStorageMultisampleEXT(Be.RENDERBUFFER,lr,nr,un.width,un.height):Be.renderbufferStorageMultisample(Be.RENDERBUFFER,lr,nr,un.width,un.height)}else Be.renderbufferStorage(Be.RENDERBUFFER,nr,un.width,un.height);Be.framebufferRenderbuffer(Be.FRAMEBUFFER,Be.DEPTH_ATTACHMENT,Be.RENDERBUFFER,Ln)}else if(un.depthBuffer&&un.stencilBuffer){const nr=Vs(un);Ni&&Js(un)===!1?Be.renderbufferStorageMultisample(Be.RENDERBUFFER,nr,Be.DEPTH24_STENCIL8,un.width,un.height):Js(un)?He.renderbufferStorageMultisampleEXT(Be.RENDERBUFFER,nr,Be.DEPTH24_STENCIL8,un.width,un.height):Be.renderbufferStorage(Be.RENDERBUFFER,Be.DEPTH_STENCIL,un.width,un.height),Be.framebufferRenderbuffer(Be.FRAMEBUFFER,Be.DEPTH_STENCIL_ATTACHMENT,Be.RENDERBUFFER,Ln)}else{const nr=un.textures;for(let hr=0;hr<nr.length;hr++){const lr=nr[hr],Es=Ie.convert(lr.format,lr.colorSpace),Pr=Ie.convert(lr.type),ss=Un(lr.internalFormat,Es,Pr,lr.colorSpace),Yo=Vs(un);Ni&&Js(un)===!1?Be.renderbufferStorageMultisample(Be.RENDERBUFFER,Yo,ss,un.width,un.height):Js(un)?He.renderbufferStorageMultisampleEXT(Be.RENDERBUFFER,Yo,ss,un.width,un.height):Be.renderbufferStorage(Be.RENDERBUFFER,ss,un.width,un.height)}}Be.bindRenderbuffer(Be.RENDERBUFFER,null)}function si(Ln,un){if(un&&un.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(oe.bindFramebuffer(Be.FRAMEBUFFER,Ln),!(un.depthTexture&&un.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!de.get(un.depthTexture).__webglTexture||un.depthTexture.image.width!==un.width||un.depthTexture.image.height!==un.height)&&(un.depthTexture.image.width=un.width,un.depthTexture.image.height=un.height,un.depthTexture.needsUpdate=!0),Ji(un.depthTexture,0),un.depthTexture.image.depth!=1?Dr(un.depthTexture,0):Ji(un.depthTexture,0);const nr=de.get(un.depthTexture).__webglTexture,hr=Vs(un);if(un.isWebGLMultiviewRenderTarget===!0){const lr=Js(un),Es=un.numViews;if(un.depthTexture.format===Dn)lr?Ze.framebufferTextureMultisampleMultiviewOVR(Be.FRAMEBUFFER,Be.DEPTH_ATTACHMENT,nr,0,hr,0,Es):Ze.framebufferTextureMultiviewOVR(Be.FRAMEBUFFER,Be.DEPTH_ATTACHMENT,nr,0,0,Es);else if(un.depthTexture.format===jn)lr?Ze.framebufferTextureMultisampleMultiviewOVR(Be.FRAMEBUFFER,Be.DEPTH_STENCIL_ATTACHMENT,nr,0,hr,0,Es):Ze.framebufferTextureMultiviewOVR(Be.FRAMEBUFFER,Be.DEPTH_STENCIL_ATTACHMENT,nr,0,0,Es);else throw new Error("Unknown depthTexture format")}else if(un.depthTexture.format===Dn)Js(un)?He.framebufferTexture2DMultisampleEXT(Be.FRAMEBUFFER,Be.DEPTH_ATTACHMENT,Be.TEXTURE_2D,nr,0,hr):Be.framebufferTexture2D(Be.FRAMEBUFFER,Be.DEPTH_ATTACHMENT,Be.TEXTURE_2D,nr,0);else if(un.depthTexture.format===jn)Js(un)?He.framebufferTexture2DMultisampleEXT(Be.FRAMEBUFFER,Be.DEPTH_STENCIL_ATTACHMENT,Be.TEXTURE_2D,nr,0,hr):Be.framebufferTexture2D(Be.FRAMEBUFFER,Be.DEPTH_STENCIL_ATTACHMENT,Be.TEXTURE_2D,nr,0);else throw new Error("Unknown depthTexture format")}function or(Ln){const un=de.get(Ln),Ni=Ln.isWebGLCubeRenderTarget===!0;if(Ln.depthTexture&&!un.__autoAllocateDepthBuffer){if(Ni)throw new Error("target.depthTexture not supported in Cube render targets");si(un.__webglFramebuffer,Ln)}else if(Ni){un.__webglDepthbuffer=[];for(let nr=0;nr<6;nr++)oe.bindFramebuffer(Be.FRAMEBUFFER,un.__webglFramebuffer[nr]),un.__webglDepthbuffer[nr]=Be.createRenderbuffer(),Qr(un.__webglDepthbuffer[nr],Ln,!1)}else oe.bindFramebuffer(Be.FRAMEBUFFER,un.__webglFramebuffer),un.__webglDepthbuffer=Be.createRenderbuffer(),Qr(un.__webglDepthbuffer,Ln,!1);oe.bindFramebuffer(Be.FRAMEBUFFER,null)}function Vi(Ln,un,Ni){const nr=de.get(Ln);un!==void 0&&Fr(nr.__webglFramebuffer,Ln,Ln.texture,Be.COLOR_ATTACHMENT0,Be.TEXTURE_2D,0),Ni!==void 0&&or(Ln)}function _r(Ln){const un=Ln.texture,Ni=de.get(Ln),nr=de.get(un);Ln.addEventListener("dispose",Fn);const hr=Ln.textures,lr=Ln.isWebGLCubeRenderTarget===!0,Es=hr.length>1;if(Es||(nr.__webglTexture===void 0&&(nr.__webglTexture=Be.createTexture()),nr.__version=un.version,Ue.memory.textures++),lr){Ni.__webglFramebuffer=[];for(let Pr=0;Pr<6;Pr++)if(un.mipmaps&&un.mipmaps.length>0){Ni.__webglFramebuffer[Pr]=[];for(let ss=0;ss<un.mipmaps.length;ss++)Ni.__webglFramebuffer[Pr][ss]=Be.createFramebuffer()}else Ni.__webglFramebuffer[Pr]=Be.createFramebuffer()}else{if(un.mipmaps&&un.mipmaps.length>0){Ni.__webglFramebuffer=[];for(let Pr=0;Pr<un.mipmaps.length;Pr++)Ni.__webglFramebuffer[Pr]=Be.createFramebuffer()}else Ni.__webglFramebuffer=Be.createFramebuffer();if(Es)for(let Pr=0,ss=hr.length;Pr<ss;Pr++){const Yo=de.get(hr[Pr]);Yo.__webglTexture===void 0&&(Yo.__webglTexture=Be.createTexture(),Ue.memory.textures++)}if(Ln.samples>0&&Js(Ln)===!1){Ni.__webglMultisampledFramebuffer=Be.createFramebuffer(),Ni.__webglColorRenderbuffer=[],oe.bindFramebuffer(Be.FRAMEBUFFER,Ni.__webglMultisampledFramebuffer);for(let Pr=0;Pr<hr.length;Pr++){const ss=hr[Pr];Ni.__webglColorRenderbuffer[Pr]=Be.createRenderbuffer(),Be.bindRenderbuffer(Be.RENDERBUFFER,Ni.__webglColorRenderbuffer[Pr]);const Yo=Ie.convert(ss.format,ss.colorSpace),os=Ie.convert(ss.type),Cs=Un(ss.internalFormat,Yo,os,ss.colorSpace,Ln.isXRRenderTarget===!0),ro=Vs(Ln);Be.renderbufferStorageMultisample(Be.RENDERBUFFER,ro,Cs,Ln.width,Ln.height),Be.framebufferRenderbuffer(Be.FRAMEBUFFER,Be.COLOR_ATTACHMENT0+Pr,Be.RENDERBUFFER,Ni.__webglColorRenderbuffer[Pr])}Be.bindRenderbuffer(Be.RENDERBUFFER,null),Ln.depthBuffer&&(Ni.__webglDepthRenderbuffer=Be.createRenderbuffer(),Qr(Ni.__webglDepthRenderbuffer,Ln,!0)),oe.bindFramebuffer(Be.FRAMEBUFFER,null)}}if(lr){oe.bindTexture(Be.TEXTURE_CUBE_MAP,nr.__webglTexture),Qo(Be.TEXTURE_CUBE_MAP,un);for(let Pr=0;Pr<6;Pr++)if(un.mipmaps&&un.mipmaps.length>0)for(let ss=0;ss<un.mipmaps.length;ss++)Fr(Ni.__webglFramebuffer[Pr][ss],Ln,un,Be.COLOR_ATTACHMENT0,Be.TEXTURE_CUBE_MAP_POSITIVE_X+Pr,ss);else Fr(Ni.__webglFramebuffer[Pr],Ln,un,Be.COLOR_ATTACHMENT0,Be.TEXTURE_CUBE_MAP_POSITIVE_X+Pr,0);Zt(un)&&qt(Be.TEXTURE_CUBE_MAP),oe.unbindTexture()}else if(Es){for(let Pr=0,ss=hr.length;Pr<ss;Pr++){const Yo=hr[Pr],os=de.get(Yo);oe.bindTexture(Be.TEXTURE_2D,os.__webglTexture),Qo(Be.TEXTURE_2D,Yo),Fr(Ni.__webglFramebuffer,Ln,Yo,Be.COLOR_ATTACHMENT0+Pr,Be.TEXTURE_2D,0),Zt(Yo)&&qt(Be.TEXTURE_2D)}oe.unbindTexture()}else{let Pr=Be.TEXTURE_2D;if((Ln.isWebGL3DRenderTarget||Ln.isWebGLArrayRenderTarget)&&(Pr=Ln.isWebGL3DRenderTarget?Be.TEXTURE_3D:Be.TEXTURE_2D_ARRAY),Ln.isWebGLMultiviewRenderTarget===!0&&(Pr=Be.TEXTURE_2D_ARRAY),oe.bindTexture(Pr,nr.__webglTexture),Qo(Pr,un),un.mipmaps&&un.mipmaps.length>0)for(let ss=0;ss<un.mipmaps.length;ss++)Fr(Ni.__webglFramebuffer[ss],Ln,un,Be.COLOR_ATTACHMENT0,Pr,ss);else Fr(Ni.__webglFramebuffer,Ln,un,Be.COLOR_ATTACHMENT0,Pr,0);Zt(un)&&qt(Pr),oe.unbindTexture()}(Ln.depthBuffer||Ln.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(Ln)}function vr(Ln){const un=Ln.textures;for(let Ni=0,nr=un.length;Ni<nr;Ni++){const hr=un[Ni];if(Zt(hr)){const lr=Ln.isWebGLCubeRenderTarget?Be.TEXTURE_CUBE_MAP:Be.TEXTURE_2D,Es=de.get(hr).__webglTexture;oe.bindTexture(lr,Es),qt(lr),oe.unbindTexture()}}}const mr=[],$r=[];function rs(Ln){if(Ln.samples>0){if(Js(Ln)===!1){const un=Ln.textures,Ni=Ln.width,nr=Ln.height;let hr=Be.COLOR_BUFFER_BIT;const lr=Ln.stencilBuffer?Be.DEPTH_STENCIL_ATTACHMENT:Be.DEPTH_ATTACHMENT,Es=de.get(Ln),Pr=un.length>1;if(Pr)for(let ss=0;ss<un.length;ss++)oe.bindFramebuffer(Be.FRAMEBUFFER,Es.__webglMultisampledFramebuffer),Be.framebufferRenderbuffer(Be.FRAMEBUFFER,Be.COLOR_ATTACHMENT0+ss,Be.RENDERBUFFER,null),oe.bindFramebuffer(Be.FRAMEBUFFER,Es.__webglFramebuffer),Be.framebufferTexture2D(Be.DRAW_FRAMEBUFFER,Be.COLOR_ATTACHMENT0+ss,Be.TEXTURE_2D,null,0);oe.bindFramebuffer(Be.READ_FRAMEBUFFER,Es.__webglMultisampledFramebuffer),oe.bindFramebuffer(Be.DRAW_FRAMEBUFFER,Es.__webglFramebuffer);for(let ss=0;ss<un.length;ss++){if(Ln.resolveDepthBuffer&&(Ln.depthBuffer&&(hr|=Be.DEPTH_BUFFER_BIT),Ln.stencilBuffer&&Ln.resolveStencilBuffer&&(hr|=Be.STENCIL_BUFFER_BIT)),Pr){Be.framebufferRenderbuffer(Be.READ_FRAMEBUFFER,Be.COLOR_ATTACHMENT0,Be.RENDERBUFFER,Es.__webglColorRenderbuffer[ss]);const Yo=de.get(un[ss]).__webglTexture;Be.framebufferTexture2D(Be.DRAW_FRAMEBUFFER,Be.COLOR_ATTACHMENT0,Be.TEXTURE_2D,Yo,0)}Be.blitFramebuffer(0,0,Ni,nr,0,0,Ni,nr,hr,Be.NEAREST),Ke===!0&&(mr.length=0,$r.length=0,mr.push(Be.COLOR_ATTACHMENT0+ss),Ln.depthBuffer&&Ln.resolveDepthBuffer===!1&&(mr.push(lr),$r.push(lr),Be.invalidateFramebuffer(Be.DRAW_FRAMEBUFFER,$r)),Be.invalidateFramebuffer(Be.READ_FRAMEBUFFER,mr))}if(oe.bindFramebuffer(Be.READ_FRAMEBUFFER,null),oe.bindFramebuffer(Be.DRAW_FRAMEBUFFER,null),Pr)for(let ss=0;ss<un.length;ss++){oe.bindFramebuffer(Be.FRAMEBUFFER,Es.__webglMultisampledFramebuffer),Be.framebufferRenderbuffer(Be.FRAMEBUFFER,Be.COLOR_ATTACHMENT0+ss,Be.RENDERBUFFER,Es.__webglColorRenderbuffer[ss]);const Yo=de.get(un[ss]).__webglTexture;oe.bindFramebuffer(Be.FRAMEBUFFER,Es.__webglFramebuffer),Be.framebufferTexture2D(Be.DRAW_FRAMEBUFFER,Be.COLOR_ATTACHMENT0+ss,Be.TEXTURE_2D,Yo,0)}oe.bindFramebuffer(Be.DRAW_FRAMEBUFFER,Es.__webglMultisampledFramebuffer)}else if(Ln.depthBuffer&&Ln.resolveDepthBuffer===!1&&Ke){const un=Ln.stencilBuffer?Be.DEPTH_STENCIL_ATTACHMENT:Be.DEPTH_ATTACHMENT;Be.invalidateFramebuffer(Be.DRAW_FRAMEBUFFER,[un])}}}function Vs(Ln){return Math.min(ye.maxSamples,Ln.samples)}function Js(Ln){const un=de.get(Ln);return Ln.samples>0&&K.has("WEBGL_multisampled_render_to_texture")===!0&&un.__useRenderToTexture!==!1}function Uo(Ln){const un=Ue.render.frame;mt.get(Ln)!==un&&(mt.set(Ln,un),Ln.update())}function Ha(Ln,un){const Ni=Ln.colorSpace,nr=Ln.format,hr=Ln.type;return Ln.isCompressedTexture===!0||Ln.isVideoTexture===!0||Ni!==za&&Ni!==Ba&&(To.getTransfer(Ni)===bo?(nr!==Jt||hr!==Mo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ni)),un}function da(Ln){return typeof HTMLImageElement<"u"&&Ln instanceof HTMLImageElement?(at.width=Ln.naturalWidth||Ln.width,at.height=Ln.naturalHeight||Ln.height):typeof VideoFrame<"u"&&Ln instanceof VideoFrame?(at.width=Ln.displayWidth,at.height=Ln.displayHeight):(at.width=Ln.width,at.height=Ln.height),at}this.allocateTextureUnit=ri,this.resetTextureUnits=Xn,this.setTexture2D=Ji,this.setTexture2DArray=Dr,this.setTexture3D=Ri,this.setTextureCube=xr,this.rebindTextures=Vi,this.uploadTexture=ps,this.setupRenderTarget=_r,this.updateRenderTargetMipmap=vr,this.updateMultisampleRenderTarget=rs,this.setupDepthTexture=si,this.setupDepthRenderbuffer=or,this.setupFrameBufferTexture=Fr,this.useMultisampledRTT=Js,this.runDeferredUploads=ea,this.setDeferTextureUploads=No}function F2(Be,K){function oe(de,ye=Ba){let Ie;const Ue=To.getTransfer(ye);if(de===Mo)return Be.UNSIGNED_BYTE;if(de===ta)return Be.UNSIGNED_SHORT_4_4_4_4;if(de===q0)return Be.UNSIGNED_SHORT_5_5_5_1;if(de===qn)return Be.UNSIGNED_INT_5_9_9_9_REV;if(de===Ia)return Be.BYTE;if(de===Do)return Be.SHORT;if(de===Ca)return Be.UNSIGNED_SHORT;if(de===l0)return Be.INT;if(de===Ra)return Be.UNSIGNED_INT;if(de===ko)return Be.FLOAT;if(de===Ts)return Be.HALF_FLOAT;if(de===di)return Be.ALPHA;if(de===$t)return Be.RGB;if(de===Jt)return Be.RGBA;if(de===xn)return Be.LUMINANCE;if(de===Vn)return Be.LUMINANCE_ALPHA;if(de===Dn)return Be.DEPTH_COMPONENT;if(de===jn)return Be.DEPTH_STENCIL;if(de===gi)return Be.RED;if(de===Wi)return Be.RED_INTEGER;if(de===Li)return Be.RG;if(de===vi)return Be.RG_INTEGER;if(de===yr)return Be.RGBA_INTEGER;if(de===Sr||de===Ur||de===hs||de===er)if(Ue===bo)if(Ie=K.get("WEBGL_compressed_texture_s3tc_srgb"),Ie!==null){if(de===Sr)return Ie.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(de===Ur)return Ie.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(de===hs)return Ie.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(de===er)return Ie.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(Ie=K.get("WEBGL_compressed_texture_s3tc"),Ie!==null){if(de===Sr)return Ie.COMPRESSED_RGB_S3TC_DXT1_EXT;if(de===Ur)return Ie.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(de===hs)return Ie.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(de===er)return Ie.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(de===as||de===Yr||de===eo||de===wo)if(Ie=K.get("WEBGL_compressed_texture_pvrtc"),Ie!==null){if(de===as)return Ie.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(de===Yr)return Ie.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(de===eo)return Ie.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(de===wo)return Ie.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(de===Er||de===Ss||de===bs)if(Ie=K.get("WEBGL_compressed_texture_etc"),Ie!==null){if(de===Er||de===Ss)return Ue===bo?Ie.COMPRESSED_SRGB8_ETC2:Ie.COMPRESSED_RGB8_ETC2;if(de===bs)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:Ie.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(de===Ns||de===It||de===Ot||de===zt||de===jt||de===mn||de===kn||de===Yn||de===xi||de===zi||de===ti||de===bi||de===cr||de===Gr)if(Ie=K.get("WEBGL_compressed_texture_astc"),Ie!==null){if(de===Ns)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:Ie.COMPRESSED_RGBA_ASTC_4x4_KHR;if(de===It)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:Ie.COMPRESSED_RGBA_ASTC_5x4_KHR;if(de===Ot)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:Ie.COMPRESSED_RGBA_ASTC_5x5_KHR;if(de===zt)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:Ie.COMPRESSED_RGBA_ASTC_6x5_KHR;if(de===jt)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:Ie.COMPRESSED_RGBA_ASTC_6x6_KHR;if(de===mn)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:Ie.COMPRESSED_RGBA_ASTC_8x5_KHR;if(de===kn)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:Ie.COMPRESSED_RGBA_ASTC_8x6_KHR;if(de===Yn)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:Ie.COMPRESSED_RGBA_ASTC_8x8_KHR;if(de===xi)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:Ie.COMPRESSED_RGBA_ASTC_10x5_KHR;if(de===zi)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:Ie.COMPRESSED_RGBA_ASTC_10x6_KHR;if(de===ti)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:Ie.COMPRESSED_RGBA_ASTC_10x8_KHR;if(de===bi)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:Ie.COMPRESSED_RGBA_ASTC_10x10_KHR;if(de===cr)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:Ie.COMPRESSED_RGBA_ASTC_12x10_KHR;if(de===Gr)return Ue===bo?Ie.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:Ie.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(de===Ki||de===As||de===Ls)if(Ie=K.get("EXT_texture_compression_bptc"),Ie!==null){if(de===Ki)return Ue===bo?Ie.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:Ie.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(de===As)return Ie.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(de===Ls)return Ie.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(de===ys||de===ds||de===$s||de===Ao)if(Ie=K.get("EXT_texture_compression_rgtc"),Ie!==null){if(de===Ki)return Ie.COMPRESSED_RED_RGTC1_EXT;if(de===ds)return Ie.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(de===$s)return Ie.COMPRESSED_RED_GREEN_RGTC2_EXT;if(de===Ao)return Ie.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return de===dn?Be.UNSIGNED_INT_24_8:Be[de]!==void 0?Be[de]:null}return{convert:oe}}class w1 extends uo{constructor(){super(),this.isGroup=!0,this.type="Group"}}class QA extends jo{constructor(K=[]){super(),this.isArrayCamera=!0,this.cameras=K}}var O2=new vn,N2=new vn;function qg(Be,K,oe){O2.setFromMatrixPosition(K.matrixWorld),N2.setFromMatrixPosition(oe.matrixWorld);var de=O2.distanceTo(N2),ye=K.projectionMatrix.elements,Ie=oe.projectionMatrix.elements,Ue=ye[14]/(ye[10]-1),He=ye[14]/(ye[10]+1),Ke=(ye[9]+1)/ye[5],Ze=(ye[9]-1)/ye[5],at=(ye[8]-1)/ye[0],mt=(Ie[8]+1)/Ie[0],vt=Ue*at,St=Ue*mt,Lt=de/(-at+mt),Ht=Lt*-at;K.matrixWorld.decompose(Be.position,Be.quaternion,Be.scale),Be.translateX(Ht),Be.translateZ(Lt),Be.matrixWorld.compose(Be.position,Be.quaternion,Be.scale),Be.matrixWorldInverse.copy(Be.matrixWorld).invert();var Dt=Ue+Lt,bt=He+Lt,tn=vt-Ht,Zt=St+(de-Ht),qt=Ke*He/bt*Dt,Un=Ze*He/bt*Dt;Be.projectionMatrix.makePerspective(tn,Zt,qt,Un,Dt,bt)}function U2(Be){var K,oe,de=this,ye=null,Ie=null,Ue=null,He=[],Ke=new kr,Ze=new kr,at=1,mt="local-floor";typeof window<"u"&&"VRFrameData"in window&&(Ie=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",qt,!1));var vt=new kr,St=new to,Lt=new vn,Ht=new jo;Ht.viewport=new go,Ht.layers.enable(1);var Dt=new jo;Dt.viewport=new go,Dt.layers.enable(2);var bt=new QA([Ht,Dt]);bt.layers.enable(1),bt.layers.enable(2);var tn=new qi,Zt;function qt(){var On=de.isPresenting=ye!==null&&ye.isPresenting===!0;if(On){var Zn=ye.getEyeParameters("left");K=2*Zn.renderWidth*at,oe=Zn.renderHeight*at,Zt=Be.getPixelRatio(),Be.getSize(tn),Be.setDrawingBufferSize(K,oe,1),Ht.viewport.set(0,0,K/2,oe),Dt.viewport.set(K/2,0,K/2,oe),cn.start(),de.dispatchEvent({type:"sessionstart"})}else de.enabled&&Be.setDrawingBufferSize(tn.width,tn.height,Zt),cn.stop(),de.dispatchEvent({type:"sessionend"})}var Un=[],_n=[];function bn(On){for(var Zn=navigator.getGamepads&&navigator.getGamepads(),Xn=0,ri=Zn.length;Xn<ri;Xn++){var wi=Zn[Xn];if(wi&&(wi.id==="Daydream Controller"||wi.id==="Gear VR Controller"||wi.id==="Oculus Go Controller"||wi.id==="OpenVR Gamepad"||wi.id.startsWith("Oculus Touch")||wi.id.startsWith("HTC Vive Focus")||wi.id.startsWith("Spatial Controller"))){var Ji=wi.hand;if(On===0&&(Ji===""||Ji==="right")||On===1&&Ji==="left")return wi}}}function Fn(){for(var On=0;On<He.length;On++){var Zn=He[On],Xn=bn(On);if(Xn!==void 0&&Xn.pose!==void 0){if(Xn.pose===null)return;var ri=Xn.pose;ri.hasPosition===!1&&Zn.position.set(.2,-.6,-.05),ri.position!==null&&Zn.position.fromArray(ri.position),ri.orientation!==null&&Zn.quaternion.fromArray(ri.orientation),Zn.matrix.compose(Zn.position,Zn.quaternion,Zn.scale),Zn.matrix.premultiply(Ke),Zn.matrix.decompose(Zn.position,Zn.quaternion,Zn.scale),Zn.matrixWorldNeedsUpdate=!0,Zn.visible=!0;var wi=Xn.id==="Daydream Controller"?0:1;Un[On]===void 0&&(Un[On]=!1),Un[On]!==Xn.buttons[wi].pressed&&(Un[On]=Xn.buttons[wi].pressed,Un[On]===!0?Zn.dispatchEvent({type:"selectstart"}):(Zn.dispatchEvent({type:"selectend"}),Zn.dispatchEvent({type:"select"}))),wi=2,_n[On]===void 0&&(_n[On]=!1),Xn.buttons[wi]!==void 0&&_n[On]!==Xn.buttons[wi].pressed&&(_n[On]=Xn.buttons[wi].pressed,_n[On]===!0?Zn.dispatchEvent({type:"squeezestart"}):(Zn.dispatchEvent({type:"squeezeend"}),Zn.dispatchEvent({type:"squeeze"})))}else Zn.visible=!1}}function pn(On,Zn){Zn!==null&&Zn.length===4&&On.set(Zn[0]*K,Zn[1]*oe,Zn[2]*K,Zn[3]*oe)}this.enabled=!1,this.getController=function(On){var Zn=He[On];return Zn===void 0&&(Zn=new w1,Zn.matrixAutoUpdate=!1,Zn.visible=!1,He[On]=Zn),Zn},this.getDevice=function(){return ye},this.setDevice=function(On){On!==void 0&&(ye=On),cn.setContext(On)},this.setFramebufferScaleFactor=function(On){at=On},this.setReferenceSpaceType=function(On){mt=On},this.setPoseTarget=function(On){On!==void 0&&(Ue=On)},this.cameraAutoUpdate=!0,this.updateCamera=function(On){var Zn=mt==="local-floor"?1.6:0;if(ye.depthNear=On.near,ye.depthFar=On.far,ye.getFrameData(Ie),mt==="local-floor"){var Xn=ye.stageParameters;Xn?Ke.fromArray(Xn.sittingToStandingTransform):Ke.makeTranslation(0,Zn,0)}var ri=Ie.pose,wi=Ue!==null?Ue:On;wi.matrix.copy(Ke),wi.matrix.decompose(wi.position,wi.quaternion,wi.scale),ri.orientation!==null&&(St.fromArray(ri.orientation),wi.quaternion.multiply(St)),ri.position!==null&&(St.setFromRotationMatrix(Ke),Lt.fromArray(ri.position),Lt.applyQuaternion(St),wi.position.add(Lt)),wi.updateMatrixWorld();for(var Ji=wi.children,Dr=0,Ri=Ji.length;Dr<Ri;Dr++)Ji[Dr].updateMatrixWorld(!0);Ht.near=On.near,Dt.near=On.near,Ht.far=On.far,Dt.far=On.far,Ht.matrixWorldInverse.fromArray(Ie.leftViewMatrix),Dt.matrixWorldInverse.fromArray(Ie.rightViewMatrix),Ze.copy(Ke).invert(),mt==="local-floor"&&(Ht.matrixWorldInverse.multiply(Ze),Dt.matrixWorldInverse.multiply(Ze));var xr=wi.parent;xr!==null&&(vt.copy(xr.matrixWorld).invert(),Ht.matrixWorldInverse.multiply(vt),Dt.matrixWorldInverse.multiply(vt)),Ht.matrixWorld.copy(Ht.matrixWorldInverse).invert(),Dt.matrixWorld.copy(Dt.matrixWorldInverse).invert(),Ht.projectionMatrix.fromArray(Ie.leftProjectionMatrix),Dt.projectionMatrix.fromArray(Ie.rightProjectionMatrix),qg(bt,Ht,Dt);var br=ye.getLayers();if(br.length){var us=br[0];pn(Ht.viewport,us.leftBounds),pn(Dt.viewport,us.rightBounds)}return Fn(),bt},this.getCamera=function(){return bt},this.getFoveation=function(){return 1},this.setFoveation=function(On){On!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(de.isPresenting)return"opaque"},this.getStandingMatrix=function(){return Ke},this.isPresenting=!1;var cn=new Mu;this.setAnimationLoop=function(On){cn.setAnimationLoop(On),this.isPresenting&&cn.start()},this.submitFrame=function(){this.isPresenting&&ye.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",qt)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(U2.prototype,{addEventListener:La.prototype.addEventListener,hasEventListener:La.prototype.hasEventListener,removeEventListener:La.prototype.removeEventListener,dispatchEvent:La.prototype.dispatchEvent});class k2 extends ga{constructor(K,oe,de,ye={}){super(K,oe,ye),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=de}copy(K){return super.copy(K),this.numViews=K.numViews,this}}k2.prototype.isWebGLMultiviewRenderTarget=!0;const Jg={type:"move"};class HA{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new w1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new w1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new vn,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new vn),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new w1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new vn,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new vn),this._grip}dispatchEvent(K){return this._targetRay!==null&&this._targetRay.dispatchEvent(K),this._grip!==null&&this._grip.dispatchEvent(K),this._hand!==null&&this._hand.dispatchEvent(K),this}connect(K){if(K&&K.hand){const oe=this._hand;if(oe)for(const de of K.hand.values())this._getHandJoint(oe,de)}return this.dispatchEvent({type:"connected",data:K}),this}disconnect(K){return this.dispatchEvent({type:"disconnected",data:K}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(K,oe,de){let ye=null,Ie=null,Ue=null;const He=this._targetRay,Ke=this._grip,Ze=this._hand;if(K&&oe.session.visibilityState!=="visible-blurred"){if(Ze&&K.hand){Ue=!0;for(const Ht of K.hand.values()){const Dt=oe.getJointPose(Ht,de),bt=this._getHandJoint(Ze,Ht);Dt!==null&&(bt.matrix.fromArray(Dt.transform.matrix),bt.matrix.decompose(bt.position,bt.rotation,bt.scale),bt.matrixWorldNeedsUpdate=!0,bt.jointRadius=Dt.radius),bt.visible=Dt!==null}const at=Ze.joints["index-finger-tip"],mt=Ze.joints["thumb-tip"],vt=at.position.distanceTo(mt.position),St=.02,Lt=.005;Ze.inputState.pinching&&vt>St+Lt?(Ze.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:K.handedness,target:this})):!Ze.inputState.pinching&&vt<=St-Lt&&(Ze.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:K.handedness,target:this}))}else Ke!==null&&K.gripSpace&&(Ie=oe.getPose(K.gripSpace,de),Ie!==null&&(Ke.matrix.fromArray(Ie.transform.matrix),Ke.matrix.decompose(Ke.position,Ke.rotation,Ke.scale),Ke.matrixWorldNeedsUpdate=!0,Ie.linearVelocity?(Ke.hasLinearVelocity=!0,Ke.linearVelocity.copy(Ie.linearVelocity)):Ke.hasLinearVelocity=!1,Ie.angularVelocity?(Ke.hasAngularVelocity=!0,Ke.angularVelocity.copy(Ie.angularVelocity)):Ke.hasAngularVelocity=!1));He!==null&&(ye=oe.getPose(K.targetRaySpace,de),ye===null&&Ie!==null&&(ye=Ie),ye!==null&&(He.matrix.fromArray(ye.transform.matrix),He.matrix.decompose(He.position,He.rotation,He.scale),He.matrixWorldNeedsUpdate=!0,ye.linearVelocity?(He.hasLinearVelocity=!0,He.linearVelocity.copy(ye.linearVelocity)):He.hasLinearVelocity=!1,ye.angularVelocity?(He.hasAngularVelocity=!0,He.angularVelocity.copy(ye.angularVelocity)):He.hasAngularVelocity=!1,this.dispatchEvent(Jg)))}return He!==null&&(He.visible=ye!==null),Ke!==null&&(Ke.visible=Ie!==null),Ze!==null&&(Ze.visible=Ue!==null),this}_getHandJoint(K,oe){if(K.joints[oe.jointName]===void 0){const de=new w1;de.matrixAutoUpdate=!1,de.visible=!1,K.joints[oe.jointName]=de,K.add(de)}return K.joints[oe.jointName]}}const Zg=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,jg=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class e3{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(K,oe,de){if(this.texture===null){const ye=new Fo,Ie=K.properties.get(ye);Ie.__webglTexture=oe.texture,(oe.depthNear!=de.depthNear||oe.depthFar!=de.depthFar)&&(this.depthNear=oe.depthNear,this.depthFar=oe.depthFar),this.texture=ye}}render(K,oe){if(this.texture!==null){if(this.mesh===null){const de=oe.cameras[0].viewport,ye=new k0({vertexShader:Zg,fragmentShader:jg,uniforms:{depthColor:{value:this.texture},depthWidth:{value:de.z},depthHeight:{value:de.w}}});this.mesh=new Zo(new ql(20,20),ye)}K.render(this.mesh,oe)}}reset(){this.texture=null,this.mesh=null}}class t3 extends La{constructor(K,oe,de,ye){super();const Ie=this;let Ue=null,He=1;var Ke=null;let Ze=null,at="local-floor",mt=1,vt=null,St=null;var Lt=[];let Ht=null,Dt=null,bt=null,tn=null;const Zt=new e3,qt=oe.getContextAttributes();let Un=null,_n=null;const bn=[],Fn=[],pn=new qi;let cn=null;const On=new jo;On.layers.enable(1),On.viewport=new go;const Zn=new jo;Zn.layers.enable(2),Zn.viewport=new go;const Xn=[On,Zn],ri=new QA;ri.layers.enable(1),ri.layers.enable(2);let wi=null,Ji=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return St},this.getController=function(sr){let Fr=bn[sr];return Fr===void 0&&(Fr=new HA,bn[sr]=Fr),Fr.getTargetRaySpace()},this.getControllerGrip=function(sr){let Fr=bn[sr];return Fr===void 0&&(Fr=new HA,bn[sr]=Fr),Fr.getGripSpace()},this.getHand=function(sr){let Fr=bn[sr];return Fr===void 0&&(Fr=new HA,bn[sr]=Fr),Fr.getHandSpace()};function Dr(sr){const Fr=Fn.indexOf(sr.inputSource);if(Fr===-1)return;const Qr=bn[Fr];Qr!==void 0&&(Qr.update(sr.inputSource,sr.frame,vt||Ze),Qr.dispatchEvent({type:sr.type,data:sr.inputSource}))}function Ri(){Ue.removeEventListener("select",Dr),Ue.removeEventListener("selectstart",Dr),Ue.removeEventListener("selectend",Dr),Ue.removeEventListener("squeeze",Dr),Ue.removeEventListener("squeezestart",Dr),Ue.removeEventListener("squeezeend",Dr),Ue.removeEventListener("end",Ri),Ue.removeEventListener("inputsourceschange",xr);for(let sr=0;sr<bn.length;sr++){const Fr=Fn[sr];Fr!==null&&(Fn[sr]=null,bn[sr].disconnect(Fr))}wi=null,Ji=null,Zt.reset(),K.setRenderTarget(Un),bt=null,Dt=null,Ht=null,Ue=null,_n=null,ps.stop(),Ie.isPresenting=!1,K.setPixelRatio(cn),K.setSize(pn.width,pn.height,!1),Ie.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(sr){He=sr,Ie.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(sr){at=sr,Ie.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return vt||Ze},this.setReferenceSpace=function(sr){vt=sr},this.getBaseLayer=function(){return Dt!==null?Dt:bt},this.getBinding=function(){return Ht},this.getFrame=function(){return tn},this.getSession=function(){return Ue},this.setSession=async function(sr){if(Ue=sr,Ue!==null){if(Un=K.getRenderTarget(),Ue.addEventListener("select",Dr),Ue.addEventListener("selectstart",Dr),Ue.addEventListener("selectend",Dr),Ue.addEventListener("squeeze",Dr),Ue.addEventListener("squeezestart",Dr),Ue.addEventListener("squeezeend",Dr),Ue.addEventListener("end",Ri),Ue.addEventListener("inputsourceschange",xr),qt.xrCompatible!==!0&&await oe.makeXRCompatible(),cn=K.getPixelRatio(),K.getSize(pn),Ue.renderState.layers===void 0){const Fr={antialias:qt.antialias,alpha:!0,depth:qt.depth,stencil:qt.stencil,framebufferScaleFactor:He};bt=new XRWebGLLayer(Ue,oe,Fr),Ue.updateRenderState({baseLayer:bt}),K.setPixelRatio(1),K.setSize(bt.framebufferWidth,bt.framebufferHeight,!1),_n=new ga(bt.framebufferWidth,bt.framebufferHeight,{format:Jt,type:Mo,colorSpace:K.outputColorSpace,stencilBuffer:qt.stencil})}else{let Fr=null,Qr=null,si=null;qt.depth&&(si=qt.stencil?oe.DEPTH24_STENCIL8:oe.DEPTH_COMPONENT24,Fr=qt.stencil?jn:Dn,Qr=qt.stencil?dn:Ra),Ie.isMultiview=ye&&de.has("OCULUS_multiview");const or={colorFormat:oe.RGBA8,depthFormat:si,scaleFactor:He};Ie.isMultiview&&(or.textureType="texture-array"),Ht=new XRWebGLBinding(Ue,oe),Dt=Ht.createProjectionLayer(or),Ue.updateRenderState({layers:[Dt]}),K.setPixelRatio(1),K.setSize(Dt.textureWidth,Dt.textureHeight,!1);const Vi={format:Jt,type:Mo,depthTexture:new ch(Dt.textureWidth,Dt.textureHeight,Qr,void 0,void 0,void 0,void 0,void 0,void 0,Fr),stencilBuffer:qt.stencil,colorSpace:K.outputColorSpace,samples:qt.antialias?4:0,resolveDepthBuffer:Dt.ignoreDepthValues===!1};if(Ie.isMultiview){const _r=de.get("OCULUS_multiview");this.maxNumViews=oe.getParameter(_r.MAX_VIEWS_OVR),_n=new k2(Dt.textureWidth,Dt.textureHeight,2,Vi)}else _n=new ga(Dt.textureWidth,Dt.textureHeight,Vi)}_n.isXRRenderTarget=!0,this.setFoveation(mt),vt=null,Ze=await Ue.requestReferenceSpace(at),ps.setContext(Ue),ps.start(),Ie.isPresenting=!0,Ie.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(Ue!==null)return Ue.environmentBlendMode},this.addLayer=function(sr){!window.XRWebGLBinding||!this.layersEnabled||!Ue||(Lt.push(sr),this.updateLayers())},this.removeLayer=function(sr){Lt.splice(Lt.indexOf(sr),1),!(!window.XRWebGLBinding||!this.layersEnabled||!Ue)&&this.updateLayers()},this.updateLayers=function(){var sr=Lt.map(function(Fr){return Fr});sr.unshift(Ue.renderState.layers[0]),Ue.updateRenderState({layers:sr})};function xr(sr){for(let Fr=0;Fr<sr.removed.length;Fr++){const Qr=sr.removed[Fr],si=Fn.indexOf(Qr);si>=0&&(Fn[si]=null,bn[si].disconnect(Qr))}for(let Fr=0;Fr<sr.added.length;Fr++){const Qr=sr.added[Fr];let si=Fn.indexOf(Qr);if(si===-1){for(let Vi=0;Vi<bn.length;Vi++)if(Vi>=Fn.length){Fn.push(Qr),si=Vi;break}else if(Fn[Vi]===null){Fn[Vi]=Qr,si=Vi;break}if(si===-1)break}const or=bn[si];or&&or.connect(Qr)}}const br=new vn,us=new vn;function oo(sr,Fr,Qr){br.setFromMatrixPosition(Fr.matrixWorld),us.setFromMatrixPosition(Qr.matrixWorld);const si=br.distanceTo(us),or=Fr.projectionMatrix.elements,Vi=Qr.projectionMatrix.elements,_r=or[14]/(or[10]-1),vr=or[14]/(or[10]+1),mr=(or[9]+1)/or[5],$r=(or[9]-1)/or[5],rs=(or[8]-1)/or[0],Vs=(Vi[8]+1)/Vi[0],Js=_r*rs,Uo=_r*Vs,Ha=si/(-rs+Vs),da=Ha*-rs;Fr.matrixWorld.decompose(sr.position,sr.quaternion,sr.scale),sr.translateX(da),sr.translateZ(Ha),sr.matrixWorld.compose(sr.position,sr.quaternion,sr.scale),sr.matrixWorldInverse.copy(sr.matrixWorld).invert();const Ln=_r+Ha,un=vr+Ha,Ni=Js-da,nr=Uo+(si-da),hr=mr*vr/un*Ln,lr=$r*vr/un*Ln;sr.projectionMatrix.makePerspective(Ni,nr,hr,lr,Ln,un),sr.projectionMatrixInverse.copy(sr.projectionMatrix).invert()}function Qo(sr,Fr){Fr===null?sr.matrixWorld.copy(sr.matrix):sr.matrixWorld.multiplyMatrices(Fr.matrixWorld,sr.matrix),sr.matrixWorldInverse.copy(sr.matrixWorld).invert()}this.setPoseTarget=function(sr){sr!==void 0&&(Ke=sr)},this.updateCamera=function(sr){if(Ue===null)return;Zt.texture!==null&&(sr.near=Zt.depthNear,sr.far=Zt.depthFar),ri.near=Zn.near=On.near=sr.near,ri.far=Zn.far=On.far=sr.far,(wi!==ri.near||Ji!==ri.far)&&(Ue.updateRenderState({depthNear:ri.near,depthFar:ri.far}),wi=ri.near,Ji=ri.far,On.near=wi,On.far=Ji,Zn.near=wi,Zn.far=Ji,On.updateProjectionMatrix(),Zn.updateProjectionMatrix(),sr.updateProjectionMatrix());const Fr=ri.cameras;var Qr=Ke||sr;const si=Qr.parent;Qo(ri,si);for(let or=0;or<Fr.length;or++)Qo(Fr[or],si);Fr.length===2?oo(ri,On,Zn):ri.projectionMatrix.copy(On.projectionMatrix),ha(sr,ri,Qr)};function ha(sr,Fr,Qr){Fr.matrixWorld.decompose(Fr.position,Fr.quaternion,Fr.scale),Qr.parent===null?Qr.matrix.copy(Fr.matrixWorld):(Qr.matrix.copy(Qr.parent.matrixWorld),Qr.matrix.invert(),Qr.matrix.multiply(Fr.matrixWorld)),Qr.matrix.decompose(Qr.position,Qr.quaternion,Qr.scale),Qr.updateMatrixWorld(!0),sr.projectionMatrix.copy(Fr.projectionMatrix),sr.projectionMatrixInverse.copy(Fr.projectionMatrixInverse),sr.isPerspectiveCamera&&(sr.fov=ac*2*Math.atan(1/sr.projectionMatrix.elements[5]),sr.zoom=1)}this.getCamera=function(){return ri},this.getFoveation=function(){if(!(Dt===null&&bt===null))return mt},this.setFoveation=function(sr){mt=sr,Dt!==null&&(Dt.fixedFoveation=sr),bt!==null&&bt.fixedFoveation!==void 0&&(bt.fixedFoveation=sr)},this.hasDepthSensing=function(){return Zt.texture!==null};let No=null;function ea(sr,Fr){if(St=Fr.getViewerPose(vt||Ze),tn=Fr,St!==null){const Qr=St.views;bt!==null&&(K.setRenderTargetFramebuffer(_n,bt.framebuffer),K.setRenderTarget(_n));let si=!1;Qr.length!==ri.cameras.length&&(ri.cameras.length=0,si=!0);for(let Vi=0;Vi<Qr.length;Vi++){const _r=Qr[Vi];let vr=null;if(bt!==null)vr=bt.getViewport(_r);else{const $r=Ht.getViewSubImage(Dt,_r);vr=$r.viewport,Vi===0&&(K.setRenderTargetTextures(_n,$r.colorTexture,Dt.ignoreDepthValues?void 0:$r.depthStencilTexture),K.setRenderTarget(_n))}let mr=Xn[Vi];mr===void 0&&(mr=new jo,mr.layers.enable(Vi),mr.viewport=new go,Xn[Vi]=mr),mr.matrix.fromArray(_r.transform.matrix),mr.matrix.decompose(mr.position,mr.quaternion,mr.scale),mr.projectionMatrix.fromArray(_r.projectionMatrix),mr.projectionMatrixInverse.copy(mr.projectionMatrix).invert(),mr.viewport.set(vr.x,vr.y,vr.width,vr.height),Vi===0&&(ri.matrix.copy(mr.matrix),ri.matrix.decompose(ri.position,ri.quaternion,ri.scale)),si===!0&&ri.cameras.push(mr)}const or=Ue.enabledFeatures;if(or&&or.includes("depth-sensing")){const Vi=Ht.getDepthInformation(Qr[0]);Vi&&Vi.isValid&&Vi.texture&&Zt.init(K,Vi,Ue.renderState)}}for(let Qr=0;Qr<bn.length;Qr++){const si=Fn[Qr],or=bn[Qr];si!==null&&or!==void 0&&or.update(si,Fr,vt||Ze)}Zt.render(K,ri),No&&No(sr,Fr),Fr.detectedPlanes&&Ie.dispatchEvent({type:"planesdetected",data:Fr}),tn=null}const ps=new Mu;ps.setAnimationLoop(ea),this.setAnimationLoop=function(sr){No=sr},this.dispose=function(){}}}const S1=new S0,n3=new kr;function i3(Be,K){function oe(Dt,bt){Dt.matrixAutoUpdate===!0&&Dt.updateMatrix(),bt.value.copy(Dt.matrix)}function de(Dt,bt){bt.color.getRGB(Dt.fogColor.value,eh(Be)),bt.isFog?(Dt.fogNear.value=bt.near,Dt.fogFar.value=bt.far):bt.isFogExp2&&(Dt.fogDensity.value=bt.density)}function ye(Dt,bt,tn,Zt,qt){bt.isMeshBasicMaterial||bt.isMeshLambertMaterial?Ie(Dt,bt):bt.isMeshToonMaterial?(Ie(Dt,bt),mt(Dt,bt)):bt.isMeshPhongMaterial?(Ie(Dt,bt),at(Dt,bt)):bt.isMeshStandardMaterial?(Ie(Dt,bt),vt(Dt,bt),bt.isMeshPhysicalMaterial&&St(Dt,bt,qt)):bt.isMeshMatcapMaterial?(Ie(Dt,bt),Lt(Dt,bt)):bt.isMeshDepthMaterial?Ie(Dt,bt):bt.isMeshDistanceMaterial?(Ie(Dt,bt),Ht(Dt,bt)):bt.isMeshNormalMaterial?Ie(Dt,bt):bt.isLineBasicMaterial?(Ue(Dt,bt),bt.isLineDashedMaterial&&He(Dt,bt)):bt.isPointsMaterial?Ke(Dt,bt,tn,Zt):bt.isSpriteMaterial?Ze(Dt,bt):bt.isShadowMaterial?(Dt.color.value.copy(bt.color),Dt.opacity.value=bt.opacity):bt.isShaderMaterial&&(bt.uniformsNeedUpdate=!1)}function Ie(Dt,bt){Dt.opacity.value=bt.opacity,bt.color&&Dt.diffuse.value.copy(bt.color),bt.emissive&&Dt.emissive.value.copy(bt.emissive).multiplyScalar(bt.emissiveIntensity),bt.map&&(Dt.map.value=bt.map,oe(bt.map,Dt.mapTransform)),bt.alphaMap&&(Dt.alphaMap.value=bt.alphaMap,oe(bt.alphaMap,Dt.alphaMapTransform)),bt.bumpMap&&(Dt.bumpMap.value=bt.bumpMap,oe(bt.bumpMap,Dt.bumpMapTransform),Dt.bumpScale.value=bt.bumpScale,bt.side===Ve&&(Dt.bumpScale.value*=-1)),bt.normalMap&&(Dt.normalMap.value=bt.normalMap,oe(bt.normalMap,Dt.normalMapTransform),Dt.normalScale.value.copy(bt.normalScale),bt.side===Ve&&Dt.normalScale.value.negate()),bt.displacementMap&&(Dt.displacementMap.value=bt.displacementMap,oe(bt.displacementMap,Dt.displacementMapTransform),Dt.displacementScale.value=bt.displacementScale,Dt.displacementBias.value=bt.displacementBias),bt.emissiveMap&&(Dt.emissiveMap.value=bt.emissiveMap,oe(bt.emissiveMap,Dt.emissiveMapTransform)),bt.specularMap&&(Dt.specularMap.value=bt.specularMap,oe(bt.specularMap,Dt.specularMapTransform)),bt.alphaTest>0&&(Dt.alphaTest.value=bt.alphaTest);const tn=K.get(bt),Zt=tn.envMap,qt=tn.envMapRotation;if(Zt&&(Dt.envMap.value=Zt,S1.copy(qt),S1.x*=-1,S1.y*=-1,S1.z*=-1,Zt.isCubeTexture&&Zt.isRenderTargetTexture===!1&&(S1.y*=-1,S1.z*=-1),Dt.envMapRotation.value.setFromMatrix4(n3.makeRotationFromEuler(S1)),Dt.flipEnvMap.value=Zt.isCubeTexture&&Zt.isRenderTargetTexture===!1?-1:1,Dt.reflectivity.value=bt.reflectivity,Dt.ior.value=bt.ior,Dt.refractionRatio.value=bt.refractionRatio),bt.lightMap){Dt.lightMap.value=bt.lightMap;const Un=Be._useLegacyLights===!0?Math.PI:1;Dt.lightMapIntensity.value=bt.lightMapIntensity*Un,oe(bt.lightMap,Dt.lightMapTransform)}bt.aoMap&&(Dt.aoMap.value=bt.aoMap,Dt.aoMapIntensity.value=bt.aoMapIntensity,oe(bt.aoMap,Dt.aoMapTransform))}function Ue(Dt,bt){Dt.diffuse.value.copy(bt.color),Dt.opacity.value=bt.opacity,bt.map&&(Dt.map.value=bt.map,oe(bt.map,Dt.mapTransform))}function He(Dt,bt){Dt.dashSize.value=bt.dashSize,Dt.totalSize.value=bt.dashSize+bt.gapSize,Dt.scale.value=bt.scale}function Ke(Dt,bt,tn,Zt){Dt.diffuse.value.copy(bt.color),Dt.opacity.value=bt.opacity,Dt.size.value=bt.size*tn,Dt.scale.value=Zt*.5,bt.map&&(Dt.map.value=bt.map,oe(bt.map,Dt.uvTransform)),bt.alphaMap&&(Dt.alphaMap.value=bt.alphaMap,oe(bt.alphaMap,Dt.alphaMapTransform)),bt.alphaTest>0&&(Dt.alphaTest.value=bt.alphaTest)}function Ze(Dt,bt){Dt.diffuse.value.copy(bt.color),Dt.opacity.value=bt.opacity,Dt.rotation.value=bt.rotation,bt.map&&(Dt.map.value=bt.map,oe(bt.map,Dt.mapTransform)),bt.alphaMap&&(Dt.alphaMap.value=bt.alphaMap,oe(bt.alphaMap,Dt.alphaMapTransform)),bt.alphaTest>0&&(Dt.alphaTest.value=bt.alphaTest)}function at(Dt,bt){Dt.specular.value.copy(bt.specular),Dt.shininess.value=Math.max(bt.shininess,1e-4)}function mt(Dt,bt){bt.gradientMap&&(Dt.gradientMap.value=bt.gradientMap)}function vt(Dt,bt){Dt.metalness.value=bt.metalness,bt.metalnessMap&&(Dt.metalnessMap.value=bt.metalnessMap,oe(bt.metalnessMap,Dt.metalnessMapTransform)),Dt.roughness.value=bt.roughness,bt.roughnessMap&&(Dt.roughnessMap.value=bt.roughnessMap,oe(bt.roughnessMap,Dt.roughnessMapTransform)),bt.envMap&&(Dt.envMapIntensity.value=bt.envMapIntensity)}function St(Dt,bt,tn){Dt.ior.value=bt.ior,bt.sheen>0&&(Dt.sheenColor.value.copy(bt.sheenColor).multiplyScalar(bt.sheen),Dt.sheenRoughness.value=bt.sheenRoughness,bt.sheenColorMap&&(Dt.sheenColorMap.value=bt.sheenColorMap,oe(bt.sheenColorMap,Dt.sheenColorMapTransform)),bt.sheenRoughnessMap&&(Dt.sheenRoughnessMap.value=bt.sheenRoughnessMap,oe(bt.sheenRoughnessMap,Dt.sheenRoughnessMapTransform))),bt.clearcoat>0&&(Dt.clearcoat.value=bt.clearcoat,Dt.clearcoatRoughness.value=bt.clearcoatRoughness,bt.clearcoatMap&&(Dt.clearcoatMap.value=bt.clearcoatMap,oe(bt.clearcoatMap,Dt.clearcoatMapTransform)),bt.clearcoatRoughnessMap&&(Dt.clearcoatRoughnessMap.value=bt.clearcoatRoughnessMap,oe(bt.clearcoatRoughnessMap,Dt.clearcoatRoughnessMapTransform)),bt.clearcoatNormalMap&&(Dt.clearcoatNormalMap.value=bt.clearcoatNormalMap,oe(bt.clearcoatNormalMap,Dt.clearcoatNormalMapTransform),Dt.clearcoatNormalScale.value.copy(bt.clearcoatNormalScale),bt.side===Ve&&Dt.clearcoatNormalScale.value.negate())),bt.dispersion>0&&(Dt.dispersion.value=bt.dispersion),bt.iridescence>0&&(Dt.iridescence.value=bt.iridescence,Dt.iridescenceIOR.value=bt.iridescenceIOR,Dt.iridescenceThicknessMinimum.value=bt.iridescenceThicknessRange[0],Dt.iridescenceThicknessMaximum.value=bt.iridescenceThicknessRange[1],bt.iridescenceMap&&(Dt.iridescenceMap.value=bt.iridescenceMap,oe(bt.iridescenceMap,Dt.iridescenceMapTransform)),bt.iridescenceThicknessMap&&(Dt.iridescenceThicknessMap.value=bt.iridescenceThicknessMap,oe(bt.iridescenceThicknessMap,Dt.iridescenceThicknessMapTransform))),bt.transmission>0&&(Dt.transmission.value=bt.transmission,Dt.transmissionSamplerMap.value=tn.texture,Dt.transmissionSamplerSize.value.set(tn.width,tn.height),bt.transmissionMap&&(Dt.transmissionMap.value=bt.transmissionMap,oe(bt.transmissionMap,Dt.transmissionMapTransform)),Dt.thickness.value=bt.thickness,bt.thicknessMap&&(Dt.thicknessMap.value=bt.thicknessMap,oe(bt.thicknessMap,Dt.thicknessMapTransform)),Dt.attenuationDistance.value=bt.attenuationDistance,Dt.attenuationColor.value.copy(bt.attenuationColor)),bt.anisotropy>0&&(Dt.anisotropyVector.value.set(bt.anisotropy*Math.cos(bt.anisotropyRotation),bt.anisotropy*Math.sin(bt.anisotropyRotation)),bt.anisotropyMap&&(Dt.anisotropyMap.value=bt.anisotropyMap,oe(bt.anisotropyMap,Dt.anisotropyMapTransform))),Dt.specularIntensity.value=bt.specularIntensity,Dt.specularColor.value.copy(bt.specularColor),bt.specularColorMap&&(Dt.specularColorMap.value=bt.specularColorMap,oe(bt.specularColorMap,Dt.specularColorMapTransform)),bt.specularIntensityMap&&(Dt.specularIntensityMap.value=bt.specularIntensityMap,oe(bt.specularIntensityMap,Dt.specularIntensityMapTransform))}function Lt(Dt,bt){bt.matcap&&(Dt.matcap.value=bt.matcap)}function Ht(Dt,bt){const tn=K.get(bt).light;Dt.referencePosition.value.setFromMatrixPosition(tn.matrixWorld),Dt.nearDistance.value=tn.shadow.camera.near,Dt.farDistance.value=tn.shadow.camera.far}return{refreshFogUniforms:de,refreshMaterialUniforms:ye}}function r3(Be,K,oe,de){let ye={},Ie={},Ue=[];const He=Be.getParameter(Be.MAX_UNIFORM_BUFFER_BINDINGS);function Ke(tn,Zt){const qt=Zt.program;de.uniformBlockBinding(tn,qt)}function Ze(tn,Zt){let qt=ye[tn.id];qt===void 0&&(Lt(tn),qt=at(tn),ye[tn.id]=qt,tn.addEventListener("dispose",Dt));const Un=Zt.program;de.updateUBOMapping(tn,Un);const _n=K.render.frame;Ie[tn.id]!==_n&&(vt(tn),Ie[tn.id]=_n)}function at(tn){const Zt=mt();tn.__bindingPointIndex=Zt;const qt=Be.createBuffer(),Un=tn.__size,_n=tn.usage;return Be.bindBuffer(Be.UNIFORM_BUFFER,qt),Be.bufferData(Be.UNIFORM_BUFFER,Un,_n),Be.bindBuffer(Be.UNIFORM_BUFFER,null),Be.bindBufferBase(Be.UNIFORM_BUFFER,Zt,qt),qt}function mt(){for(let tn=0;tn<He;tn++)if(Ue.indexOf(tn)===-1)return Ue.push(tn),tn;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function vt(tn){const Zt=ye[tn.id],qt=tn.uniforms,Un=tn.__cache;Be.bindBuffer(Be.UNIFORM_BUFFER,Zt);for(let _n=0,bn=qt.length;_n<bn;_n++){const Fn=Array.isArray(qt[_n])?qt[_n]:[qt[_n]];for(let pn=0,cn=Fn.length;pn<cn;pn++){const On=Fn[pn];if(St(On,_n,pn,Un)===!0){const Zn=On.__offset,Xn=Array.isArray(On.value)?On.value:[On.value];let ri=0;for(let wi=0;wi<Xn.length;wi++){const Ji=Xn[wi],Dr=Ht(Ji);typeof Ji=="number"||typeof Ji=="boolean"?(On.__data[0]=Ji,Be.bufferSubData(Be.UNIFORM_BUFFER,Zn+ri,On.__data)):Ji.isMatrix3?(On.__data[0]=Ji.elements[0],On.__data[1]=Ji.elements[1],On.__data[2]=Ji.elements[2],On.__data[3]=0,On.__data[4]=Ji.elements[3],On.__data[5]=Ji.elements[4],On.__data[6]=Ji.elements[5],On.__data[7]=0,On.__data[8]=Ji.elements[6],On.__data[9]=Ji.elements[7],On.__data[10]=Ji.elements[8],On.__data[11]=0):(Ji.toArray(On.__data,ri),ri+=Dr.storage/Float32Array.BYTES_PER_ELEMENT)}Be.bufferSubData(Be.UNIFORM_BUFFER,Zn,On.__data)}}}Be.bindBuffer(Be.UNIFORM_BUFFER,null)}function St(tn,Zt,qt,Un){const _n=tn.value,bn=Zt+"_"+qt;if(Un[bn]===void 0)return typeof _n=="number"||typeof _n=="boolean"?Un[bn]=_n:Un[bn]=_n.clone(),!0;{const Fn=Un[bn];if(typeof _n=="number"||typeof _n=="boolean"){if(Fn!==_n)return Un[bn]=_n,!0}else if(Fn.equals(_n)===!1)return Fn.copy(_n),!0}return!1}function Lt(tn){const Zt=tn.uniforms;let qt=0;const Un=16;for(let bn=0,Fn=Zt.length;bn<Fn;bn++){const pn=Array.isArray(Zt[bn])?Zt[bn]:[Zt[bn]];for(let cn=0,On=pn.length;cn<On;cn++){const Zn=pn[cn],Xn=Array.isArray(Zn.value)?Zn.value:[Zn.value];for(let ri=0,wi=Xn.length;ri<wi;ri++){const Ji=Xn[ri],Dr=Ht(Ji),Ri=qt%Un;Ri!==0&&Un-Ri<Dr.boundary&&(qt+=Un-Ri),Zn.__data=new Float32Array(Dr.storage/Float32Array.BYTES_PER_ELEMENT),Zn.__offset=qt,qt+=Dr.storage}}}const _n=qt%Un;return _n>0&&(qt+=Un-_n),tn.__size=qt,tn.__cache={},this}function Ht(tn){const Zt={boundary:0,storage:0};return typeof tn=="number"||typeof tn=="boolean"?(Zt.boundary=4,Zt.storage=4):tn.isVector2?(Zt.boundary=8,Zt.storage=8):tn.isVector3||tn.isColor?(Zt.boundary=16,Zt.storage=12):tn.isVector4?(Zt.boundary=16,Zt.storage=16):tn.isMatrix3?(Zt.boundary=48,Zt.storage=48):tn.isMatrix4?(Zt.boundary=64,Zt.storage=64):tn.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",tn),Zt}function Dt(tn){const Zt=tn.target;Zt.removeEventListener("dispose",Dt);const qt=Ue.indexOf(Zt.__bindingPointIndex);Ue.splice(qt,1),Be.deleteBuffer(ye[Zt.id]),delete ye[Zt.id],delete Ie[Zt.id]}function bt(){for(const tn in ye)Be.deleteBuffer(ye[tn]);Ue=[],ye={},Ie={}}return{bind:Ke,update:Ze,dispose:bt}}class s3{constructor(K={}){const{canvas:oe=mu(),context:de=null,depth:ye=!0,stencil:Ie=!1,alpha:Ue=!1,antialias:He=!1,premultipliedAlpha:Ke=!0,preserveDrawingBuffer:Ze=!1,powerPreference:at="default",failIfMajorPerformanceCaveat:mt=!1,multiviewStereo:vt=!1}=K;this.isWebGLRenderer=!0;let St;if(de!==null){if(typeof WebGLRenderingContext<"u"&&de instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");St=de.getContextAttributes().alpha}else St=Ue;const Lt=new Uint32Array(4),Ht=new Int32Array(4);let Dt=null,bt=null;const tn=[],Zt=[];this.domElement=oe,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=lo,this._useLegacyLights=!1,this.toneMapping=yi,this.toneMappingExposure=1;const qt=this;let Un=!1,_n=0,bn=0,Fn=null,pn=-1,cn=null;const On=new go,Zn=new go;let Xn=null;const ri=new Wr(0);let wi=0,Ji=oe.width,Dr=oe.height,Ri=1,xr=null,br=null;const us=new go(0,0,Ji,Dr),oo=new go(0,0,Ji,Dr);let Qo=!1;const ha=new Cc;let No=!1,ea=!1;const ps=new kr,sr=new vn,Fr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Qr(){return Fn===null?Ri:1}let si=de;function or(En,oi){return oe.getContext(En,oi)}try{const En={alpha:!0,depth:ye,stencil:Ie,antialias:He,premultipliedAlpha:Ke,preserveDrawingBuffer:Ze,powerPreference:at,failIfMajorPerformanceCaveat:mt};if("setAttribute"in oe&&oe.setAttribute("data-engine",`three.js r${se}`),oe.addEventListener("webglcontextlost",Tr,!1),oe.addEventListener("webglcontextrestored",_s,!1),oe.addEventListener("webglcontextcreationerror",ns,!1),si===null){const oi="webgl2";if(si=or(oi,En),si===null)throw or(oi)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(En){throw console.error("THREE.WebGLRenderer: "+En.message),En}let Vi,_r,vr,mr,$r,rs,Vs,Js,Uo,Ha,da,Ln,un,Ni,nr,hr,lr,Es,Pr,ss,Yo,os,Cs,ro,Ps;function zn(){Vi=new Sl(si),Vi.init(),Cs=new F2(si,Vi),_r=new p1(si,Vi,K,Cs),vr=new Kg(si),mr=new sd(si),$r=new Hc,rs=new Yg(si,Vi,vr,$r,_r,Cs,mr),Vs=new Nf(qt),Js=new g1(qt),Uo=new G1(si),ro=new f1(si,Uo),Ha=new rd(si,Uo,mr,ro),da=new mp(si,Ha,Uo,mr),ss=new v1(si,_r,rs),hr=new au($r),Ln=new Qf(qt,Vs,Js,Vi,_r,ro,hr),un=new i3(qt,$r),Ni=new Ug,nr=new zg(Vi),Pr=new Of(qt,Vs,Js,vr,da,St,Ke),Es=new E1(qt,Vi,si),lr=new Xg(qt,da,_r),Ps=new r3(si,mr,_r,vr),Yo=new wc(si,Vi,mr),os=new lu(si,Vi,mr),mr.programs=Ln.programs,qt.capabilities=_r,qt.extensions=Vi,qt.properties=$r,qt.renderLists=Ni,qt.shadowMap=lr,qt.state=vr,qt.info=mr}zn();const gr=typeof navigator<"u"&&"xr"in navigator?new t3(qt,si,Vi,vt):new U2(qt);this.xr=gr,this.getContext=function(){return si},this.getContextAttributes=function(){return si.getContextAttributes()},this.forceContextLoss=function(){const En=Vi.get("WEBGL_lose_context");En&&En.loseContext()},this.forceContextRestore=function(){const En=Vi.get("WEBGL_lose_context");En&&En.restoreContext()},this.getPixelRatio=function(){return Ri},this.setPixelRatio=function(En){En!==void 0&&(Ri=En,this.setSize(Ji,Dr,!1))},this.getSize=function(En){return En.set(Ji,Dr)},this.setSize=function(En,oi,Mi=!0){if(gr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ji=En,Dr=oi,oe.width=Math.floor(En*Ri),oe.height=Math.floor(oi*Ri),Mi===!0&&(oe.style.width=En+"px",oe.style.height=oi+"px"),this.setViewport(0,0,En,oi)},this.getDrawingBufferSize=function(En){return En.set(Ji*Ri,Dr*Ri).floor()},this.setDrawingBufferSize=function(En,oi,Mi){Ji=En,Dr=oi,Ri=Mi,oe.width=Math.floor(En*Mi),oe.height=Math.floor(oi*Mi),this.setViewport(0,0,En,oi)},this.getCurrentViewport=function(En){return En.copy(On)},this.getViewport=function(En){return En.copy(us)},this.setViewport=function(En,oi,Mi,_i){En.isVector4?us.set(En.x,En.y,En.z,En.w):us.set(En,oi,Mi,_i),vr.viewport(On.copy(us).multiplyScalar(Ri).round())},this.getScissor=function(En){return En.copy(oo)},this.setScissor=function(En,oi,Mi,_i){En.isVector4?oo.set(En.x,En.y,En.z,En.w):oo.set(En,oi,Mi,_i),vr.scissor(Zn.copy(oo).multiplyScalar(Ri).round())},this.getScissorTest=function(){return Qo},this.setScissorTest=function(En){vr.setScissorTest(Qo=En)},this.setOpaqueSort=function(En){xr=En},this.setTransparentSort=function(En){br=En},this.getClearColor=function(En){return En.copy(Pr.getClearColor())},this.setClearColor=function(){Pr.setClearColor.apply(Pr,arguments)},this.getClearAlpha=function(){return Pr.getClearAlpha()},this.setClearAlpha=function(){Pr.setClearAlpha.apply(Pr,arguments)},this.clear=function(En=!0,oi=!0,Mi=!0){let _i=0;if(En){let Ci=!1;if(Fn!==null){const qr=Fn.texture.format;Ci=qr===yr||qr===vi||qr===Wi}if(Ci){const qr=Fn.texture.type,xs=qr===Mo||qr===Ra||qr===Ca||qr===dn||qr===ta||qr===q0,ws=Pr.getClearColor(),Gs=Pr.getClearAlpha(),io=ws.r,ao=ws.g,yo=ws.b;xs?(Lt[0]=io,Lt[1]=ao,Lt[2]=yo,Lt[3]=Gs,si.clearBufferuiv(si.COLOR,0,Lt)):(Ht[0]=io,Ht[1]=ao,Ht[2]=yo,Ht[3]=Gs,si.clearBufferiv(si.COLOR,0,Ht))}else _i|=si.COLOR_BUFFER_BIT}oi&&(_i|=si.DEPTH_BUFFER_BIT),Mi&&(_i|=si.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),si.clear(_i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){oe.removeEventListener("webglcontextlost",Tr,!1),oe.removeEventListener("webglcontextrestored",_s,!1),oe.removeEventListener("webglcontextcreationerror",ns,!1),Ni.dispose(),nr.dispose(),$r.dispose(),Vs.dispose(),Js.dispose(),da.dispose(),ro.dispose(),Ps.dispose(),Ln.dispose(),gr.dispose(),gr.removeEventListener("sessionstart",Nu),gr.removeEventListener("sessionend",Tg),U1.stop()};function Tr(En){En.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Un=!0}function _s(){console.log("THREE.WebGLRenderer: Context Restored."),Un=!1;const En=mr.autoReset,oi=lr.enabled,Mi=lr.autoUpdate,_i=lr.needsUpdate,Ci=lr.type;zn(),mr.autoReset=En,lr.enabled=oi,lr.autoUpdate=Mi,lr.needsUpdate=_i,lr.type=Ci}function ns(En){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",En.statusMessage)}function so(En){const oi=En.target;oi.removeEventListener("dispose",so),is(oi)}function is(En){Xr(En),$r.remove(En)}function Xr(En){const oi=$r.get(En).programs;oi!==void 0&&(oi.forEach(function(Mi){Ln.releaseProgram(Mi)}),En.isShaderMaterial&&Ln.releaseShaderCache(En))}this.renderBufferDirect=function(En,oi,Mi,_i,Ci,qr){oi===null&&(oi=Fr);const xs=Ci.isMesh&&Ci.matrixWorld.determinant()<0,ws=jv(En,oi,Mi,_i,Ci);vr.setMaterial(_i,xs);let Gs=Mi.index,io=1;if(_i.wireframe===!0){if(Gs=Ha.getWireframeAttribute(Mi),Gs===void 0)return;io=2}const ao=Mi.drawRange,yo=Mi.attributes.position;let y0=ao.start*io,ll=(ao.start+ao.count)*io;qr!==null&&(y0=Math.max(y0,qr.start*io),ll=Math.min(ll,(qr.start+qr.count)*io)),Gs!==null?(y0=Math.max(y0,0),ll=Math.min(ll,Gs.count)):yo!=null&&(y0=Math.max(y0,0),ll=Math.min(ll,yo.count));const Mc=ll-y0;if(Mc<0||Mc===1/0)return;ro.setup(Ci,_i,ws,Mi,Gs);let gd,Ho=Yo;if(Gs!==null&&(gd=Uo.get(Gs),Ho=os,Ho.setIndex(gd)),Ci.isMesh)_i.wireframe===!0?(vr.setLineWidth(_i.wireframeLinewidth*Qr()),Ho.setMode(si.LINES)):Ho.setMode(si.TRIANGLES);else if(Ci.isLine){let gh=_i.linewidth;gh===void 0&&(gh=1),vr.setLineWidth(gh*Qr()),Ci.isLineSegments?Ho.setMode(si.LINES):Ci.isLineLoop?Ho.setMode(si.LINE_LOOP):Ho.setMode(si.LINE_STRIP)}else Ci.isPoints?Ho.setMode(si.POINTS):Ci.isSprite&&Ho.setMode(si.TRIANGLES);if(Ci.isBatchedMesh)Ci._multiDrawInstances!==null?Ho.renderMultiDrawInstances(Ci._multiDrawStarts,Ci._multiDrawCounts,Ci._multiDrawCount,Ci._multiDrawInstances):Ho.renderMultiDraw(Ci._multiDrawStarts,Ci._multiDrawCounts,Ci._multiDrawCount);else if(Ci.isInstancedMesh)Ho.renderInstances(y0,Mc,Ci.count);else if(Mi.isInstancedBufferGeometry){const gh=Mi._maxInstanceCount!==void 0?Mi._maxInstanceCount:1/0,po=Math.min(Mi.instanceCount,gh);Ho.renderInstances(y0,Mc,po)}else Ho.render(y0,Mc)};function fo(En,oi,Mi){En.transparent===!0&&En.side===Xe&&En.forceSinglePass===!1?(En.side=Ve,En.needsUpdate=!0,NA(En,oi,Mi),En.side=ke,En.needsUpdate=!0,NA(En,oi,Mi),En.side=Xe):NA(En,oi,Mi)}this.compile=function(En,oi,Mi=null){Mi===null&&(Mi=En),bt=nr.get(Mi),bt.init(oi),Zt.push(bt),Mi.traverseVisible(function(Ci){Ci.isLight&&Ci.layers.test(oi.layers)&&(bt.pushLight(Ci),Ci.castShadow&&bt.pushShadow(Ci))}),En!==Mi&&En.traverseVisible(function(Ci){Ci.isLight&&Ci.layers.test(oi.layers)&&(bt.pushLight(Ci),Ci.castShadow&&bt.pushShadow(Ci))}),bt.setupLights(qt._useLegacyLights);const _i=new Set;return En.traverse(function(Ci){const qr=Ci.material;if(qr)if(Array.isArray(qr))for(let xs=0;xs<qr.length;xs++){const ws=qr[xs];fo(ws,Mi,Ci),_i.add(ws)}else fo(qr,Mi,Ci),_i.add(qr)}),Zt.pop(),bt=null,_i},this.compileAsync=function(En,oi,Mi=null){const _i=this.compile(En,oi,Mi);return new Promise(Ci=>{function qr(){if(_i.forEach(function(xs){$r.get(xs).currentProgram.isReady()&&_i.delete(xs)}),_i.size===0){Ci(En);return}setTimeout(qr,10)}Vi.get("KHR_parallel_shader_compile")!==null?qr():setTimeout(qr,10)})};let Os=null;function R0(En){Os&&Os(En)}function Nu(){U1.stop()}function Tg(){U1.start()}const U1=new Mu;U1.setAnimationLoop(R0),typeof self<"u"&&U1.setContext(self),this.setAnimationLoop=function(En){Os=En,gr.setAnimationLoop(En),En===null?U1.stop():U1.start()},gr.addEventListener("sessionstart",Nu),gr.addEventListener("sessionend",Tg),this.render=function(En,oi){if(oi!==void 0&&oi.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Un===!0)return;En.matrixWorldAutoUpdate===!0&&En.updateMatrixWorld(),oi.parent===null&&oi.matrixWorldAutoUpdate===!0&&oi.updateMatrixWorld(),gr.enabled===!0&&gr.isPresenting===!0&&(gr.cameraAutoUpdate===!0&&gr.updateCamera(oi),oi=gr.getCamera()),En.isScene===!0&&En.onBeforeRender(qt,En,oi,Fn),bt=nr.get(En,Zt.length),bt.init(oi),Zt.push(bt),ps.multiplyMatrices(oi.projectionMatrix,oi.matrixWorldInverse),ha.setFromProjectionMatrix(ps),ea=this.localClippingEnabled,No=hr.init(this.clippingPlanes,ea),Dt=Ni.get(En,tn.length),Dt.init(),tn.push(Dt),Ig(En,oi,0,qt.sortObjects),Dt.finish(),qt.sortObjects===!0&&Dt.sort(xr,br);const Mi=gr.enabled===!1||gr.isPresenting===!1||gr.hasDepthSensing()===!1;Mi&&Pr.addToRenderList(Dt,En),this.info.render.frame++,No===!0&&hr.beginShadows();const _i=bt.state.shadowsArray;lr.render(_i,En,oi),No===!0&&hr.endShadows(),this.info.autoReset===!0&&this.info.reset();const Ci=Dt.opaque,qr=Dt.transmissive;if(bt.setupLights(qt._useLegacyLights),oi.isArrayCamera){const xs=oi.cameras;if(qr.length>0)for(let ws=0,Gs=xs.length;ws<Gs;ws++){const io=xs[ws];Rg(Ci,qr,En,io)}if(Mi&&Pr.render(En),gr.enabled&&gr.isMultiview)rs.setDeferTextureUploads(!0),T2(Dt,En,oi,oi.cameras[0].viewport);else for(let ws=0,Gs=xs.length;ws<Gs;ws++){const io=xs[ws];T2(Dt,En,io,io.viewport)}}else qr.length>0&&Rg(Ci,qr,En,oi),Mi&&Pr.render(En),T2(Dt,En,oi);Fn!==null&&(rs.updateMultisampleRenderTarget(Fn),rs.updateRenderTargetMipmap(Fn)),En.isScene===!0&&En.onAfterRender(qt,En,oi),rs.runDeferredUploads(),gr.enabled&&gr.submitFrame&&gr.submitFrame(),ro.resetDefaultState(),pn=-1,cn=null,Zt.pop(),Zt.length>0?(bt=Zt[Zt.length-1],No===!0&&hr.setGlobalState(qt.clippingPlanes,bt.state.camera)):bt=null,tn.pop(),tn.length>0?Dt=tn[tn.length-1]:Dt=null};function Ig(En,oi,Mi,_i){if(En.visible===!1)return;if(En.layers.test(oi.layers)){if(En.isGroup)Mi=En.renderOrder;else if(En.isLOD)En.autoUpdate===!0&&En.update(oi);else if(En.isLight)bt.pushLight(En),En.castShadow&&bt.pushShadow(En);else if(En.isSprite){if(!En.frustumCulled||ha.intersectsSprite(En)){_i&&sr.setFromMatrixPosition(En.matrixWorld).applyMatrix4(ps);const xs=da.update(En),ws=En.material;ws.visible&&Dt.push(En,xs,ws,Mi,sr.z,null)}}else if((En.isMesh||En.isLine||En.isPoints)&&(!En.frustumCulled||ha.intersectsObject(En))){const xs=da.update(En),ws=En.material;if(_i&&(En.boundingSphere!==void 0?(En.boundingSphere===null&&En.computeBoundingSphere(),sr.copy(En.boundingSphere.center)):(xs.boundingSphere===null&&xs.computeBoundingSphere(),sr.copy(xs.boundingSphere.center)),sr.applyMatrix4(En.matrixWorld).applyMatrix4(ps)),Array.isArray(ws)){const Gs=xs.groups;for(let io=0,ao=Gs.length;io<ao;io++){const yo=Gs[io],y0=ws[yo.materialIndex];y0&&y0.visible&&Dt.push(En,xs,y0,Mi,sr.z,yo)}}else ws.visible&&Dt.push(En,xs,ws,Mi,sr.z,null)}}const qr=En.children;for(let xs=0,ws=qr.length;xs<ws;xs++)Ig(qr[xs],oi,Mi,_i)}function T2(En,oi,Mi,_i){const Ci=En.opaque,qr=En.transmissive,xs=En.transparent;bt.setupLightsView(Mi),No===!0&&hr.setGlobalState(qt.clippingPlanes,Mi),_i&&vr.viewport(On.copy(_i)),Ci.length>0&&OA(Ci,oi,Mi),qr.length>0&&OA(qr,oi,Mi),xs.length>0&&OA(xs,oi,Mi),vr.buffers.depth.setTest(!0),vr.buffers.depth.setMask(!0),vr.buffers.color.setMask(!0),vr.setPolygonOffset(!1)}function Rg(En,oi,Mi,_i){if((Mi.isScene===!0?Mi.overrideMaterial:null)!==null)return;bt.state.transmissionRenderTarget[_i.id]===void 0&&(bt.state.transmissionRenderTarget[_i.id]=new ga(1,1,{generateMipmaps:!0,type:Vi.has("EXT_color_buffer_half_float")||Vi.has("EXT_color_buffer_float")?Ts:Mo,minFilter:Qs,samples:4,stencilBuffer:Ie,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const qr=bt.state.transmissionRenderTarget[_i.id],xs=_i.viewport||On;qr.setSize(xs.z,xs.w);const ws=qt.getRenderTarget();qt.setRenderTarget(qr),qt.getClearColor(ri),wi=qt.getClearAlpha(),wi<1&&qt.setClearColor(16777215,.5),qt.clear();const Gs=qt.toneMapping;qt.toneMapping=yi;const io=_i.viewport;if(_i.viewport!==void 0&&(_i.viewport=void 0),bt.setupLightsView(_i),No===!0&&hr.setGlobalState(qt.clippingPlanes,_i),OA(En,Mi,_i),rs.updateMultisampleRenderTarget(qr),rs.updateRenderTargetMipmap(qr),Vi.has("WEBGL_multisampled_render_to_texture")===!1){let ao=!1;for(let yo=0,y0=oi.length;yo<y0;yo++){const ll=oi[yo],Mc=ll.object,gd=ll.geometry,Ho=ll.material,gh=ll.group;if(Ho.side===Xe&&Mc.layers.test(_i.layers)){const po=Ho.side;Ho.side=Ve,Ho.needsUpdate=!0,Bg(Mc,Mi,_i,gd,Ho,gh),Ho.side=po,Ho.needsUpdate=!0,ao=!0}}ao===!0&&(rs.updateMultisampleRenderTarget(qr),rs.updateRenderTargetMipmap(qr))}qt.setRenderTarget(ws),qt.setClearColor(ri,wi),io!==void 0&&(_i.viewport=io),qt.toneMapping=Gs}function OA(En,oi,Mi){const _i=oi.isScene===!0?oi.overrideMaterial:null;for(let Ci=0,qr=En.length;Ci<qr;Ci++){const xs=En[Ci],ws=xs.object,Gs=xs.geometry,io=_i===null?xs.material:_i,ao=xs.group;ws.layers.test(Mi.layers)&&Bg(ws,oi,Mi,Gs,io,ao)}}function Bg(En,oi,Mi,_i,Ci,qr){En.onBeforeRender(qt,oi,Mi,_i,Ci,qr),En.modelViewMatrix.multiplyMatrices(Mi.matrixWorldInverse,En.matrixWorld),En.normalMatrix.getNormalMatrix(En.modelViewMatrix),Ci.onBeforeRender(qt,oi,Mi,_i,En,qr),Ci.transparent===!0&&Ci.side===Xe&&Ci.forceSinglePass===!1?(Ci.side=Ve,Ci.needsUpdate=!0,qt.renderBufferDirect(Mi,oi,_i,Ci,En,qr),Ci.side=ke,Ci.needsUpdate=!0,qt.renderBufferDirect(Mi,oi,_i,Ci,En,qr),Ci.side=Xe):qt.renderBufferDirect(Mi,oi,_i,Ci,En,qr),En.onAfterRender(qt,oi,Mi,_i,Ci,qr)}function NA(En,oi,Mi){oi.isScene!==!0&&(oi=Fr);const _i=$r.get(En),Ci=bt.state.lights,qr=bt.state.shadowsArray,xs=Ci.state.version,ws=Ln.getParameters(En,Ci.state,qr,oi,Mi),Gs=Ln.getProgramCacheKey(ws);let io=_i.programs;_i.environment=En.isMeshStandardMaterial?oi.environment:null,_i.fog=oi.fog,_i.envMap=(En.isMeshStandardMaterial?Js:Vs).get(En.envMap||_i.environment),_i.envMapRotation=_i.environment!==null&&En.envMap===null?oi.environmentRotation:En.envMapRotation,io===void 0&&(En.addEventListener("dispose",so),io=new Map,_i.programs=io);let ao=io.get(Gs);if(ao!==void 0){if(_i.currentProgram===ao&&_i.lightsStateVersion===xs)return Dg(En,ws),ao}else ws.uniforms=Ln.getUniforms(En),En.onBuild(Mi,ws,qt),En.onBeforeCompile(ws,qt),ao=Ln.acquireProgram(ws,Gs),io.set(Gs,ao),_i.uniforms=ws.uniforms;const yo=_i.uniforms;return(!En.isShaderMaterial&&!En.isRawShaderMaterial||En.clipping===!0)&&(yo.clippingPlanes=hr.uniform),Dg(En,ws),_i.needsLights=tE(En),_i.lightsStateVersion=xs,_i.needsLights&&(yo.ambientLightColor.value=Ci.state.ambient,yo.lightProbe.value=Ci.state.probe,yo.directionalLights.value=Ci.state.directional,yo.directionalLightShadows.value=Ci.state.directionalShadow,yo.spotLights.value=Ci.state.spot,yo.spotLightShadows.value=Ci.state.spotShadow,yo.rectAreaLights.value=Ci.state.rectArea,yo.ltc_1.value=Ci.state.rectAreaLTC1,yo.ltc_2.value=Ci.state.rectAreaLTC2,yo.pointLights.value=Ci.state.point,yo.pointLightShadows.value=Ci.state.pointShadow,yo.hemisphereLights.value=Ci.state.hemi,yo.directionalShadowMap.value=Ci.state.directionalShadowMap,yo.directionalShadowMatrix.value=Ci.state.directionalShadowMatrix,yo.spotShadowMap.value=Ci.state.spotShadowMap,yo.spotLightMatrix.value=Ci.state.spotLightMatrix,yo.spotLightMap.value=Ci.state.spotLightMap,yo.pointShadowMap.value=Ci.state.pointShadowMap,yo.pointShadowMatrix.value=Ci.state.pointShadowMatrix),_i.currentProgram=ao,_i.uniformsList=null,ao}function Lg(En){if(En.uniformsList===null){const oi=En.currentProgram.getUniforms();En.uniformsList=lt.seqWithValue(oi.seq,En.uniforms)}return En.uniformsList}function Dg(En,oi){const Mi=$r.get(En);Mi.outputColorSpace=oi.outputColorSpace,Mi.batching=oi.batching,Mi.instancing=oi.instancing,Mi.instancingColor=oi.instancingColor,Mi.instancingMorph=oi.instancingMorph,Mi.skinning=oi.skinning,Mi.morphTargets=oi.morphTargets,Mi.morphNormals=oi.morphNormals,Mi.morphColors=oi.morphColors,Mi.morphTargetsCount=oi.morphTargetsCount,Mi.numClippingPlanes=oi.numClippingPlanes,Mi.numIntersection=oi.numClipIntersection,Mi.vertexAlphas=oi.vertexAlphas,Mi.vertexTangents=oi.vertexTangents,Mi.toneMapping=oi.toneMapping,Mi.numMultiviewViews=oi.numMultiviewViews}function jv(En,oi,Mi,_i,Ci){oi.isScene!==!0&&(oi=Fr),rs.resetTextureUnits();const qr=oi.fog,xs=_i.isMeshStandardMaterial?oi.environment:null,ws=Fn===null?qt.outputColorSpace:Fn.isXRRenderTarget===!0?Fn.texture.colorSpace:za,Gs=(_i.isMeshStandardMaterial?Js:Vs).get(_i.envMap||xs),io=_i.vertexColors===!0&&!!Mi.attributes.color&&Mi.attributes.color.itemSize===4,ao=!!Mi.attributes.tangent&&(!!_i.normalMap||_i.anisotropy>0),yo=!!Mi.morphAttributes.position,y0=!!Mi.morphAttributes.normal,ll=!!Mi.morphAttributes.color;let Mc=yi;_i.toneMapped&&(Fn===null||Fn.isXRRenderTarget===!0)&&(Mc=qt.toneMapping);const gd=Fn&&Fn.isWebGLMultiviewRenderTarget?Fn.numViews:0,Ho=Mi.morphAttributes.position||Mi.morphAttributes.normal||Mi.morphAttributes.color,gh=Ho!==void 0?Ho.length:0,po=$r.get(_i),nE=bt.state.lights;if(No===!0&&(ea===!0||En!==cn)){const Vc=En===cn&&_i.id===pn;hr.setState(_i,En,Vc)}let ya=!1;_i.version===po.__version?(po.needsLights&&po.lightsStateVersion!==nE.state.version||po.outputColorSpace!==ws||Ci.isBatchedMesh&&po.batching===!1||!Ci.isBatchedMesh&&po.batching===!0||Ci.isInstancedMesh&&po.instancing===!1||!Ci.isInstancedMesh&&po.instancing===!0||Ci.isSkinnedMesh&&po.skinning===!1||!Ci.isSkinnedMesh&&po.skinning===!0||Ci.isInstancedMesh&&po.instancingColor===!0&&Ci.instanceColor===null||Ci.isInstancedMesh&&po.instancingColor===!1&&Ci.instanceColor!==null||Ci.isInstancedMesh&&po.instancingMorph===!0&&Ci.morphTexture===null||Ci.isInstancedMesh&&po.instancingMorph===!1&&Ci.morphTexture!==null||po.envMap!==Gs||_i.fog===!0&&po.fog!==qr||po.numClippingPlanes!==void 0&&(po.numClippingPlanes!==hr.numPlanes||po.numIntersection!==hr.numIntersection)||po.vertexAlphas!==io||po.vertexTangents!==ao||po.morphTargets!==yo||po.morphNormals!==y0||po.morphColors!==ll||po.toneMapping!==Mc||po.morphTargetsCount!==gh||po.numMultiviewViews!==gd)&&(ya=!0):(ya=!0,po.__version=_i.version);let vh=po.currentProgram;ya===!0&&(vh=NA(_i,oi,Ci));let Pg=!1,kp=!1,I2=!1;const B0=vh.getUniforms(),vd=po.uniforms;if(vr.useProgram(vh.program)&&(Pg=!0,kp=!0,I2=!0),_i.id!==pn&&(pn=_i.id,kp=!0),Pg||cn!==En){vh.numMultiviewViews>0?(Es.updateCameraProjectionMatricesUniform(En,B0),Es.updateCameraViewMatricesUniform(En,B0)):(B0.setValue(si,"projectionMatrix",En.projectionMatrix),B0.setValue(si,"viewMatrix",En.matrixWorldInverse));const Vc=B0.map.cameraPosition;Vc!==void 0&&Vc.setValue(si,sr.setFromMatrixPosition(En.matrixWorld)),_r.logarithmicDepthBuffer&&B0.setValue(si,"logDepthBufFC",2/(Math.log(En.far+1)/Math.LN2)),(_i.isMeshPhongMaterial||_i.isMeshToonMaterial||_i.isMeshLambertMaterial||_i.isMeshBasicMaterial||_i.isMeshStandardMaterial||_i.isShaderMaterial)&&B0.setValue(si,"isOrthographic",En.isOrthographicCamera===!0),cn!==En&&(cn=En,kp=!0,I2=!0)}if(Ci.isSkinnedMesh){B0.setOptional(si,Ci,"bindMatrix"),B0.setOptional(si,Ci,"bindMatrixInverse");const Vc=Ci.skeleton;Vc&&(Vc.boneTexture===null&&Vc.computeBoneTexture(),B0.setValue(si,"boneTexture",Vc.boneTexture,rs))}Ci.isBatchedMesh&&(B0.setOptional(si,Ci,"batchingTexture"),B0.setValue(si,"batchingTexture",Ci._matricesTexture,rs));const R2=Mi.morphAttributes;if((R2.position!==void 0||R2.normal!==void 0||R2.color!==void 0)&&ss.update(Ci,Mi,vh),(kp||po.receiveShadow!==Ci.receiveShadow)&&(po.receiveShadow=Ci.receiveShadow,B0.setValue(si,"receiveShadow",Ci.receiveShadow)),_i.isMeshGouraudMaterial&&_i.envMap!==null&&(vd.envMap.value=Gs,vd.flipEnvMap.value=Gs.isCubeTexture&&Gs.isRenderTargetTexture===!1?-1:1),_i.isMeshStandardMaterial&&_i.envMap===null&&oi.environment!==null&&(vd.envMapIntensity.value=oi.environmentIntensity),kp&&(B0.setValue(si,"toneMappingExposure",qt.toneMappingExposure),po.needsLights&&eE(vd,I2),qr&&_i.fog===!0&&un.refreshFogUniforms(vd,qr),un.refreshMaterialUniforms(vd,_i,Ri,Dr,bt.state.transmissionRenderTarget[En.id]),lt.upload(si,Lg(po),vd,rs)),_i.isShaderMaterial&&_i.uniformsNeedUpdate===!0&&(lt.upload(si,Lg(po),vd,rs),_i.uniformsNeedUpdate=!1),_i.isSpriteMaterial&&B0.setValue(si,"center",Ci.center),vh.numMultiviewViews>0?Es.updateObjectMatricesUniforms(Ci,En,B0):(B0.setValue(si,"modelViewMatrix",Ci.modelViewMatrix),B0.setValue(si,"normalMatrix",Ci.normalMatrix)),B0.setValue(si,"modelMatrix",Ci.matrixWorld),_i.isShaderMaterial||_i.isRawShaderMaterial){const Vc=_i.uniformsGroups;for(let B2=0,iE=Vc.length;B2<iE;B2++){const Fg=Vc[B2];Ps.update(Fg,vh),Ps.bind(Fg,vh)}}return vh}function eE(En,oi){En.ambientLightColor.needsUpdate=oi,En.lightProbe.needsUpdate=oi,En.directionalLights.needsUpdate=oi,En.directionalLightShadows.needsUpdate=oi,En.pointLights.needsUpdate=oi,En.pointLightShadows.needsUpdate=oi,En.spotLights.needsUpdate=oi,En.spotLightShadows.needsUpdate=oi,En.rectAreaLights.needsUpdate=oi,En.hemisphereLights.needsUpdate=oi}function tE(En){return En.isMeshLambertMaterial||En.isMeshToonMaterial||En.isMeshPhongMaterial||En.isMeshStandardMaterial||En.isShadowMaterial||En.isShaderMaterial&&En.lights===!0}this.setTexture2D=function(){var En=!1;return function(Mi,_i){Mi&&Mi.isWebGLRenderTarget&&(En||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),En=!0),Mi=Mi.texture),rs.setTexture2D(Mi,_i)}}(),this.getActiveCubeFace=function(){return _n},this.getActiveMipmapLevel=function(){return bn},this.getRenderTarget=function(){return Fn},this.setRenderTargetTextures=function(En,oi,Mi){$r.get(En.texture).__webglTexture=oi,$r.get(En.depthTexture).__webglTexture=Mi;const _i=$r.get(En);_i.__hasExternalTextures=!0,_i.__autoAllocateDepthBuffer=Mi===void 0,!_i.__autoAllocateDepthBuffer&&(!Fn||!Fn.isWebGLMultiviewRenderTarget)&&Vi.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),_i.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(En,oi){const Mi=$r.get(En);Mi.__webglFramebuffer=oi,Mi.__useDefaultFramebuffer=oi===void 0},this.setRenderTarget=function(En,oi=0,Mi=0){Fn=En,_n=oi,bn=Mi;let _i=!0,Ci=null,qr=!1,xs=!1;if(En){const Gs=$r.get(En);Gs.__useDefaultFramebuffer!==void 0?(vr.bindFramebuffer(si.FRAMEBUFFER,null),_i=!1):Gs.__webglFramebuffer===void 0?rs.setupRenderTarget(En):Gs.__hasExternalTextures&&rs.rebindTextures(En,$r.get(En.texture).__webglTexture,$r.get(En.depthTexture).__webglTexture);const io=En.texture;(io.isData3DTexture||io.isDataArrayTexture||io.isCompressedArrayTexture)&&(xs=!0);const ao=$r.get(En).__webglFramebuffer;En.isWebGLCubeRenderTarget?(Array.isArray(ao[oi])?Ci=ao[oi][Mi]:Ci=ao[oi],qr=!0):En.samples>0&&rs.useMultisampledRTT(En)===!1?Ci=$r.get(En).__webglMultisampledFramebuffer:Array.isArray(ao)?Ci=ao[Mi]:Ci=ao,On.copy(En.viewport),Zn.copy(En.scissor),Xn=En.scissorTest}else On.copy(us).multiplyScalar(Ri).floor(),Zn.copy(oo).multiplyScalar(Ri).floor(),Xn=Qo;if(vr.bindFramebuffer(si.FRAMEBUFFER,Ci)&&_i&&vr.drawBuffers(En,Ci),vr.viewport(On),vr.scissor(Zn),vr.setScissorTest(Xn),qr){const Gs=$r.get(En.texture);si.framebufferTexture2D(si.FRAMEBUFFER,si.COLOR_ATTACHMENT0,si.TEXTURE_CUBE_MAP_POSITIVE_X+oi,Gs.__webglTexture,Mi)}else if(xs){const Gs=$r.get(En.texture),io=oi||0;si.framebufferTextureLayer(si.FRAMEBUFFER,si.COLOR_ATTACHMENT0,Gs.__webglTexture,Mi||0,io)}pn=-1},this.readRenderTargetPixels=function(En,oi,Mi,_i,Ci,qr,xs){if(!(En&&En.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ws=$r.get(En).__webglFramebuffer;if(En.isWebGLCubeRenderTarget&&xs!==void 0&&(ws=ws[xs]),ws){vr.bindFramebuffer(si.FRAMEBUFFER,ws);try{const Gs=En.texture,io=Gs.format,ao=Gs.type;if(!_r.textureFormatReadable(io)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!_r.textureTypeReadable(ao)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}oi>=0&&oi<=En.width-_i&&Mi>=0&&Mi<=En.height-Ci&&si.readPixels(oi,Mi,_i,Ci,Cs.convert(io),Cs.convert(ao),qr)}finally{const Gs=Fn!==null?$r.get(Fn).__webglFramebuffer:null;vr.bindFramebuffer(si.FRAMEBUFFER,Gs)}}},this.copyFramebufferToTexture=function(En,oi,Mi=0){const _i=Math.pow(2,-Mi),Ci=Math.floor(oi.image.width*_i),qr=Math.floor(oi.image.height*_i);rs.setTexture2D(oi,0),si.copyTexSubImage2D(si.TEXTURE_2D,Mi,0,0,En.x,En.y,Ci,qr),vr.unbindTexture()},this.copyTextureToTexture=function(En,oi,Mi,_i=0){const Ci=oi.image.width,qr=oi.image.height,xs=Cs.convert(Mi.format),ws=Cs.convert(Mi.type);rs.setTexture2D(Mi,0),si.pixelStorei(si.UNPACK_FLIP_Y_WEBGL,Mi.flipY),si.pixelStorei(si.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Mi.premultiplyAlpha),si.pixelStorei(si.UNPACK_ALIGNMENT,Mi.unpackAlignment),oi.isDataTexture?si.texSubImage2D(si.TEXTURE_2D,_i,En.x,En.y,Ci,qr,xs,ws,oi.image.data):oi.isCompressedTexture?si.compressedTexSubImage2D(si.TEXTURE_2D,_i,En.x,En.y,oi.mipmaps[0].width,oi.mipmaps[0].height,xs,oi.mipmaps[0].data):si.texSubImage2D(si.TEXTURE_2D,_i,En.x,En.y,xs,ws,oi.image),_i===0&&Mi.generateMipmaps&&si.generateMipmap(si.TEXTURE_2D),vr.unbindTexture()},this.copyTextureToTexture3D=function(En,oi,Mi,_i,Ci=0){const qr=En.max.x-En.min.x,xs=En.max.y-En.min.y,ws=En.max.z-En.min.z,Gs=Cs.convert(_i.format),io=Cs.convert(_i.type);let ao;if(_i.isData3DTexture)rs.setTexture3D(_i,0),ao=si.TEXTURE_3D;else if(_i.isDataArrayTexture||_i.isCompressedArrayTexture)rs.setTexture2DArray(_i,0),ao=si.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}si.pixelStorei(si.UNPACK_FLIP_Y_WEBGL,_i.flipY),si.pixelStorei(si.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_i.premultiplyAlpha),si.pixelStorei(si.UNPACK_ALIGNMENT,_i.unpackAlignment);const yo=si.getParameter(si.UNPACK_ROW_LENGTH),y0=si.getParameter(si.UNPACK_IMAGE_HEIGHT),ll=si.getParameter(si.UNPACK_SKIP_PIXELS),Mc=si.getParameter(si.UNPACK_SKIP_ROWS),gd=si.getParameter(si.UNPACK_SKIP_IMAGES),Ho=Mi.isCompressedTexture?Mi.mipmaps[Ci]:Mi.image;si.pixelStorei(si.UNPACK_ROW_LENGTH,Ho.width),si.pixelStorei(si.UNPACK_IMAGE_HEIGHT,Ho.height),si.pixelStorei(si.UNPACK_SKIP_PIXELS,En.min.x),si.pixelStorei(si.UNPACK_SKIP_ROWS,En.min.y),si.pixelStorei(si.UNPACK_SKIP_IMAGES,En.min.z),Mi.isDataTexture||Mi.isData3DTexture?si.texSubImage3D(ao,Ci,oi.x,oi.y,oi.z,qr,xs,ws,Gs,io,Ho.data):_i.isCompressedArrayTexture?si.compressedTexSubImage3D(ao,Ci,oi.x,oi.y,oi.z,qr,xs,ws,Gs,Ho.data):si.texSubImage3D(ao,Ci,oi.x,oi.y,oi.z,qr,xs,ws,Gs,io,Ho),si.pixelStorei(si.UNPACK_ROW_LENGTH,yo),si.pixelStorei(si.UNPACK_IMAGE_HEIGHT,y0),si.pixelStorei(si.UNPACK_SKIP_PIXELS,ll),si.pixelStorei(si.UNPACK_SKIP_ROWS,Mc),si.pixelStorei(si.UNPACK_SKIP_IMAGES,gd),Ci===0&&_i.generateMipmaps&&si.generateMipmap(ao),vr.unbindTexture()},this.initTexture=function(En){En.isCubeTexture?rs.setTextureCube(En,0):En.isData3DTexture?rs.setTexture3D(En,0):En.isDataArrayTexture||En.isCompressedArrayTexture?rs.setTexture2DArray(En,0):rs.setTexture2D(En,0),vr.unbindTexture()},this.resetState=function(){_n=0,bn=0,Fn=null,vr.reset(),ro.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return j0}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(K){this._outputColorSpace=K;const oe=this.getContext();oe.drawingBufferColorSpace=K===bc?"display-p3":"srgb",oe.unpackColorSpace=To.workingColorSpace===Rl?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(K){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=K}}class Hp{constructor(K,oe=25e-5){this.isFogExp2=!0,this.name="",this.color=new Wr(K),this.density=oe}clone(){return new Hp(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Vp{constructor(K,oe=1,de=1e3){this.isFog=!0,this.name="",this.color=new Wr(K),this.near=oe,this.far=de}clone(){return new Vp(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class G2 extends uo{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new S0,this.environmentIntensity=1,this.environmentRotation=new S0,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(K,oe){return super.copy(K,oe),K.background!==null&&(this.background=K.background.clone()),K.environment!==null&&(this.environment=K.environment.clone()),K.fog!==null&&(this.fog=K.fog.clone()),this.backgroundBlurriness=K.backgroundBlurriness,this.backgroundIntensity=K.backgroundIntensity,this.backgroundRotation.copy(K.backgroundRotation),this.environmentIntensity=K.environmentIntensity,this.environmentRotation.copy(K.environmentRotation),K.overrideMaterial!==null&&(this.overrideMaterial=K.overrideMaterial.clone()),this.matrixAutoUpdate=K.matrixAutoUpdate,this}toJSON(K){const oe=super.toJSON(K);return this.fog!==null&&(oe.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(oe.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(oe.object.backgroundIntensity=this.backgroundIntensity),oe.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(oe.object.environmentIntensity=this.environmentIntensity),oe.object.environmentRotation=this.environmentRotation.toArray(),oe}}class zp{constructor(K,oe){this.isInterleavedBuffer=!0,this.array=K,this.stride=oe,this.count=K!==void 0?K.length/oe:0,this.usage=sc,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=c0()}onUploadCallback(){}set needsUpdate(K){K===!0&&this.version++}get updateRange(){return oa("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(K){return this.usage=K,this}addUpdateRange(K,oe){this.updateRanges.push({start:K,count:oe})}clearUpdateRanges(){this.updateRanges.length=0}copy(K){return this.array=new K.array.constructor(K.array),this.count=K.count,this.stride=K.stride,this.usage=K.usage,this}copyAt(K,oe,de){K*=this.stride,de*=oe.stride;for(let ye=0,Ie=this.stride;ye<Ie;ye++)this.array[K+ye]=oe.array[de+ye];return this}set(K,oe=0){return this.array.set(K,oe),this}clone(K){K.arrayBuffers===void 0&&(K.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=c0()),K.arrayBuffers[this.array.buffer._uuid]===void 0&&(K.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const oe=new this.array.constructor(K.arrayBuffers[this.array.buffer._uuid]),de=new this.constructor(oe,this.stride);return de.setUsage(this.usage),de}onUpload(K){return this.onUploadCallback=K,this}toJSON(K){return K.arrayBuffers===void 0&&(K.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=c0()),K.arrayBuffers[this.array.buffer._uuid]===void 0&&(K.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ml=new vn;class M1{constructor(K,oe,de,ye=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=K,this.itemSize=oe,this.offset=de,this.normalized=ye}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(K){this.data.needsUpdate=K}applyMatrix4(K){for(let oe=0,de=this.data.count;oe<de;oe++)Ml.fromBufferAttribute(this,oe),Ml.applyMatrix4(K),this.setXYZ(oe,Ml.x,Ml.y,Ml.z);return this}applyNormalMatrix(K){for(let oe=0,de=this.count;oe<de;oe++)Ml.fromBufferAttribute(this,oe),Ml.applyNormalMatrix(K),this.setXYZ(oe,Ml.x,Ml.y,Ml.z);return this}transformDirection(K){for(let oe=0,de=this.count;oe<de;oe++)Ml.fromBufferAttribute(this,oe),Ml.transformDirection(K),this.setXYZ(oe,Ml.x,Ml.y,Ml.z);return this}getComponent(K,oe){let de=this.array[K*this.data.stride+this.offset+oe];return this.normalized&&(de=$a(de,this.array)),de}setComponent(K,oe,de){return this.normalized&&(de=Us(de,this.array)),this.data.array[K*this.data.stride+this.offset+oe]=de,this}setX(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.data.array[K*this.data.stride+this.offset]=oe,this}setY(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.data.array[K*this.data.stride+this.offset+1]=oe,this}setZ(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.data.array[K*this.data.stride+this.offset+2]=oe,this}setW(K,oe){return this.normalized&&(oe=Us(oe,this.array)),this.data.array[K*this.data.stride+this.offset+3]=oe,this}getX(K){let oe=this.data.array[K*this.data.stride+this.offset];return this.normalized&&(oe=$a(oe,this.array)),oe}getY(K){let oe=this.data.array[K*this.data.stride+this.offset+1];return this.normalized&&(oe=$a(oe,this.array)),oe}getZ(K){let oe=this.data.array[K*this.data.stride+this.offset+2];return this.normalized&&(oe=$a(oe,this.array)),oe}getW(K){let oe=this.data.array[K*this.data.stride+this.offset+3];return this.normalized&&(oe=$a(oe,this.array)),oe}setXY(K,oe,de){return K=K*this.data.stride+this.offset,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array)),this.data.array[K+0]=oe,this.data.array[K+1]=de,this}setXYZ(K,oe,de,ye){return K=K*this.data.stride+this.offset,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array),ye=Us(ye,this.array)),this.data.array[K+0]=oe,this.data.array[K+1]=de,this.data.array[K+2]=ye,this}setXYZW(K,oe,de,ye,Ie){return K=K*this.data.stride+this.offset,this.normalized&&(oe=Us(oe,this.array),de=Us(de,this.array),ye=Us(ye,this.array),Ie=Us(Ie,this.array)),this.data.array[K+0]=oe,this.data.array[K+1]=de,this.data.array[K+2]=ye,this.data.array[K+3]=Ie,this}clone(K){if(K===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const oe=[];for(let de=0;de<this.count;de++){const ye=de*this.data.stride+this.offset;for(let Ie=0;Ie<this.itemSize;Ie++)oe.push(this.data.array[ye+Ie])}return new So(new this.array.constructor(oe),this.itemSize,this.normalized)}else return K.interleavedBuffers===void 0&&(K.interleavedBuffers={}),K.interleavedBuffers[this.data.uuid]===void 0&&(K.interleavedBuffers[this.data.uuid]=this.data.clone(K)),new M1(K.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(K){if(K===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const oe=[];for(let de=0;de<this.count;de++){const ye=de*this.data.stride+this.offset;for(let Ie=0;Ie<this.itemSize;Ie++)oe.push(this.data.array[ye+Ie])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:oe,normalized:this.normalized}}else return K.interleavedBuffers===void 0&&(K.interleavedBuffers={}),K.interleavedBuffers[this.data.uuid]===void 0&&(K.interleavedBuffers[this.data.uuid]=this.data.toJSON(K)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class VA extends Oo{constructor(K){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Wr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.map=K.map,this.alphaMap=K.alphaMap,this.rotation=K.rotation,this.sizeAttenuation=K.sizeAttenuation,this.fog=K.fog,this}}let Hf;const gp=new vn,Vf=new vn,zf=new vn,Wf=new qi,vp=new qi,Q2=new kr,Wp=new vn,Ep=new vn,$p=new vn,H2=new qi,zA=new qi,V2=new qi;class z2 extends uo{constructor(K=new VA){if(super(),this.isSprite=!0,this.type="Sprite",Hf===void 0){Hf=new Ds;const oe=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),de=new zp(oe,5);Hf.setIndex([0,1,2,0,2,3]),Hf.setAttribute("position",new M1(de,3,0,!1)),Hf.setAttribute("uv",new M1(de,2,3,!1))}this.geometry=Hf,this.material=K,this.center=new qi(.5,.5)}raycast(K,oe){K.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Vf.setFromMatrixScale(this.matrixWorld),Q2.copy(K.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(K.camera.matrixWorldInverse,this.matrixWorld),zf.setFromMatrixPosition(this.modelViewMatrix),K.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Vf.multiplyScalar(-zf.z);const de=this.material.rotation;let ye,Ie;de!==0&&(Ie=Math.cos(de),ye=Math.sin(de));const Ue=this.center;Xp(Wp.set(-.5,-.5,0),zf,Ue,Vf,ye,Ie),Xp(Ep.set(.5,-.5,0),zf,Ue,Vf,ye,Ie),Xp($p.set(.5,.5,0),zf,Ue,Vf,ye,Ie),H2.set(0,0),zA.set(1,0),V2.set(1,1);let He=K.ray.intersectTriangle(Wp,Ep,$p,!1,gp);if(He===null&&(Xp(Ep.set(-.5,.5,0),zf,Ue,Vf,ye,Ie),zA.set(0,1),He=K.ray.intersectTriangle(Wp,$p,Ep,!1,gp),He===null))return;const Ke=K.ray.origin.distanceTo(gp);Ke<K.near||Ke>K.far||oe.push({distance:Ke,point:gp.clone(),uv:Fa.getInterpolation(gp,Wp,Ep,$p,H2,zA,V2,new qi),face:null,object:this})}copy(K,oe){return super.copy(K,oe),K.center!==void 0&&this.center.copy(K.center),this.material=K.material,this}}function Xp(Be,K,oe,de,ye,Ie){Wf.subVectors(Be,oe).addScalar(.5).multiply(de),ye!==void 0?(vp.x=Ie*Wf.x-ye*Wf.y,vp.y=ye*Wf.x+Ie*Wf.y):vp.copy(Wf),Be.copy(K),Be.x+=vp.x,Be.y+=vp.y,Be.applyMatrix4(Q2)}const Kp=new vn,W2=new vn;class $2 extends uo{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(K){super.copy(K,!1);const oe=K.levels;for(let de=0,ye=oe.length;de<ye;de++){const Ie=oe[de];this.addLevel(Ie.object.clone(),Ie.distance,Ie.hysteresis)}return this.autoUpdate=K.autoUpdate,this}addLevel(K,oe=0,de=0){oe=Math.abs(oe);const ye=this.levels;let Ie;for(Ie=0;Ie<ye.length&&!(oe<ye[Ie].distance);Ie++);return ye.splice(Ie,0,{distance:oe,hysteresis:de,object:K}),this.add(K),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(K){const oe=this.levels;if(oe.length>0){let de,ye;for(de=1,ye=oe.length;de<ye;de++){let Ie=oe[de].distance;if(oe[de].object.visible&&(Ie-=Ie*oe[de].hysteresis),K<Ie)break}return oe[de-1].object}return null}raycast(K,oe){if(this.levels.length>0){Kp.setFromMatrixPosition(this.matrixWorld);const ye=K.ray.origin.distanceTo(Kp);this.getObjectForDistance(ye).raycast(K,oe)}}update(K){const oe=this.levels;if(oe.length>1){Kp.setFromMatrixPosition(K.matrixWorld),W2.setFromMatrixPosition(this.matrixWorld);const de=Kp.distanceTo(W2)/K.zoom;oe[0].object.visible=!0;let ye,Ie;for(ye=1,Ie=oe.length;ye<Ie;ye++){let Ue=oe[ye].distance;if(oe[ye].object.visible&&(Ue-=Ue*oe[ye].hysteresis),de>=Ue)oe[ye-1].object.visible=!1,oe[ye].object.visible=!0;else break}for(this._currentLevel=ye-1;ye<Ie;ye++)oe[ye].object.visible=!1}}toJSON(K){const oe=super.toJSON(K);this.autoUpdate===!1&&(oe.object.autoUpdate=!1),oe.object.levels=[];const de=this.levels;for(let ye=0,Ie=de.length;ye<Ie;ye++){const Ue=de[ye];oe.object.levels.push({object:Ue.object.uuid,distance:Ue.distance,hysteresis:Ue.hysteresis})}return oe}}const X2=new vn,K2=new go,Y2=new go,o3=new vn,q2=new kr,Yp=new vn,WA=new la,J2=new kr,$A=new Jo;class Z2 extends Zo{constructor(K,oe){super(K,oe),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=on,this.bindMatrix=new kr,this.bindMatrixInverse=new kr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const K=this.geometry;this.boundingBox===null&&(this.boundingBox=new Rs),this.boundingBox.makeEmpty();const oe=K.getAttribute("position");for(let de=0;de<oe.count;de++)this.getVertexPosition(de,Yp),this.boundingBox.expandByPoint(Yp)}computeBoundingSphere(){const K=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new la),this.boundingSphere.makeEmpty();const oe=K.getAttribute("position");for(let de=0;de<oe.count;de++)this.getVertexPosition(de,Yp),this.boundingSphere.expandByPoint(Yp)}copy(K,oe){return super.copy(K,oe),this.bindMode=K.bindMode,this.bindMatrix.copy(K.bindMatrix),this.bindMatrixInverse.copy(K.bindMatrixInverse),this.skeleton=K.skeleton,K.boundingBox!==null&&(this.boundingBox=K.boundingBox.clone()),K.boundingSphere!==null&&(this.boundingSphere=K.boundingSphere.clone()),this}raycast(K,oe){const de=this.material,ye=this.matrixWorld;de!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),WA.copy(this.boundingSphere),WA.applyMatrix4(ye),K.ray.intersectsSphere(WA)!==!1&&(J2.copy(ye).invert(),$A.copy(K.ray).applyMatrix4(J2),!(this.boundingBox!==null&&$A.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(K,oe,$A)))}getVertexPosition(K,oe){return super.getVertexPosition(K,oe),this.applyBoneTransform(K,oe),oe}bind(K,oe){this.skeleton=K,oe===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),oe=this.matrixWorld),this.bindMatrix.copy(oe),this.bindMatrixInverse.copy(oe).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const K=new go,oe=this.geometry.attributes.skinWeight;for(let de=0,ye=oe.count;de<ye;de++){K.fromBufferAttribute(oe,de);const Ie=1/K.manhattanLength();Ie!==1/0?K.multiplyScalar(Ie):K.set(1,0,0,0),oe.setXYZW(de,K.x,K.y,K.z,K.w)}}updateMatrixWorld(K){super.updateMatrixWorld(K),this.bindMode===on?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===an?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(K,oe){const de=this.skeleton,ye=this.geometry;K2.fromBufferAttribute(ye.attributes.skinIndex,K),Y2.fromBufferAttribute(ye.attributes.skinWeight,K),X2.copy(oe).applyMatrix4(this.bindMatrix),oe.set(0,0,0);for(let Ie=0;Ie<4;Ie++){const Ue=Y2.getComponent(Ie);if(Ue!==0){const He=K2.getComponent(Ie);q2.multiplyMatrices(de.bones[He].matrixWorld,de.boneInverses[He]),oe.addScaledVector(o3.copy(X2).applyMatrix4(q2),Ue)}}return oe.applyMatrix4(this.bindMatrixInverse)}}class XA extends uo{constructor(){super(),this.isBone=!0,this.type="Bone"}}class hd extends Fo{constructor(K=null,oe=1,de=1,ye,Ie,Ue,He,Ke,Ze=ki,at=ki,mt,vt){super(null,Ue,He,Ke,Ze,at,ye,Ie,mt,vt),this.isDataTexture=!0,this.image={data:K,width:oe,height:de},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const j2=new kr,a3=new kr;class qp{constructor(K=[],oe=[]){this.uuid=c0(),this.bones=K.slice(0),this.boneInverses=oe,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const K=this.bones,oe=this.boneInverses;if(this.boneMatrices=new Float32Array(K.length*16),oe.length===0)this.calculateInverses();else if(K.length!==oe.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let de=0,ye=this.bones.length;de<ye;de++)this.boneInverses.push(new kr)}}calculateInverses(){this.boneInverses.length=0;for(let K=0,oe=this.bones.length;K<oe;K++){const de=new kr;this.bones[K]&&de.copy(this.bones[K].matrixWorld).invert(),this.boneInverses.push(de)}}pose(){for(let K=0,oe=this.bones.length;K<oe;K++){const de=this.bones[K];de&&de.matrixWorld.copy(this.boneInverses[K]).invert()}for(let K=0,oe=this.bones.length;K<oe;K++){const de=this.bones[K];de&&(de.parent&&de.parent.isBone?(de.matrix.copy(de.parent.matrixWorld).invert(),de.matrix.multiply(de.matrixWorld)):de.matrix.copy(de.matrixWorld),de.matrix.decompose(de.position,de.quaternion,de.scale))}}update(){const K=this.bones,oe=this.boneInverses,de=this.boneMatrices,ye=this.boneTexture;for(let Ie=0,Ue=K.length;Ie<Ue;Ie++){const He=K[Ie]?K[Ie].matrixWorld:a3;j2.multiplyMatrices(He,oe[Ie]),j2.toArray(de,Ie*16)}ye!==null&&(ye.needsUpdate=!0)}clone(){return new qp(this.bones,this.boneInverses)}computeBoneTexture(){let K=Math.sqrt(this.bones.length*4);K=Math.ceil(K/4)*4,K=Math.max(K,4);const oe=new Float32Array(K*K*4);oe.set(this.boneMatrices);const de=new hd(oe,K,K,Jt,ko);return de.needsUpdate=!0,this.boneMatrices=oe,this.boneTexture=de,this}getBoneByName(K){for(let oe=0,de=this.bones.length;oe<de;oe++){const ye=this.bones[oe];if(ye.name===K)return ye}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(K,oe){this.uuid=K.uuid;for(let de=0,ye=K.bones.length;de<ye;de++){const Ie=K.bones[de];let Ue=oe[Ie];Ue===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",Ie),Ue=new XA),this.bones.push(Ue),this.boneInverses.push(new kr().fromArray(K.boneInverses[de]))}return this.init(),this}toJSON(){const K={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};K.uuid=this.uuid;const oe=this.bones,de=this.boneInverses;for(let ye=0,Ie=oe.length;ye<Ie;ye++){const Ue=oe[ye];K.bones.push(Ue.uuid);const He=de[ye];K.boneInverses.push(He.toArray())}return K}}class $f extends So{constructor(K,oe,de,ye=1){super(K,oe,de),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=ye}copy(K){return super.copy(K),this.meshPerAttribute=K.meshPerAttribute,this}toJSON(){const K=super.toJSON();return K.meshPerAttribute=this.meshPerAttribute,K.isInstancedBufferAttribute=!0,K}}const Xf=new kr,em=new kr,Jp=[],tm=new Rs,l3=new kr,_p=new Zo,yp=new la;class nm extends Zo{constructor(K,oe,de){super(K,oe),this.isInstancedMesh=!0,this.instanceMatrix=new $f(new Float32Array(de*16),16),this.instanceColor=null,this.morphTexture=null,this.count=de,this.boundingBox=null,this.boundingSphere=null;for(let ye=0;ye<de;ye++)this.setMatrixAt(ye,l3)}computeBoundingBox(){const K=this.geometry,oe=this.count;this.boundingBox===null&&(this.boundingBox=new Rs),K.boundingBox===null&&K.computeBoundingBox(),this.boundingBox.makeEmpty();for(let de=0;de<oe;de++)this.getMatrixAt(de,Xf),tm.copy(K.boundingBox).applyMatrix4(Xf),this.boundingBox.union(tm)}computeBoundingSphere(){const K=this.geometry,oe=this.count;this.boundingSphere===null&&(this.boundingSphere=new la),K.boundingSphere===null&&K.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let de=0;de<oe;de++)this.getMatrixAt(de,Xf),yp.copy(K.boundingSphere).applyMatrix4(Xf),this.boundingSphere.union(yp)}copy(K,oe){return super.copy(K,oe),this.instanceMatrix.copy(K.instanceMatrix),K.morphTexture!==null&&(this.morphTexture=K.morphTexture.clone()),K.instanceColor!==null&&(this.instanceColor=K.instanceColor.clone()),this.count=K.count,K.boundingBox!==null&&(this.boundingBox=K.boundingBox.clone()),K.boundingSphere!==null&&(this.boundingSphere=K.boundingSphere.clone()),this}getColorAt(K,oe){oe.fromArray(this.instanceColor.array,K*3)}getMatrixAt(K,oe){oe.fromArray(this.instanceMatrix.array,K*16)}getMorphAt(K,oe){const de=oe.morphTargetInfluences,ye=this.morphTexture.source.data.data,Ie=de.length+1,Ue=K*Ie+1;for(let He=0;He<de.length;He++)de[He]=ye[Ue+He]}raycast(K,oe){const de=this.matrixWorld,ye=this.count;if(_p.geometry=this.geometry,_p.material=this.material,_p.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),yp.copy(this.boundingSphere),yp.applyMatrix4(de),K.ray.intersectsSphere(yp)!==!1))for(let Ie=0;Ie<ye;Ie++){this.getMatrixAt(Ie,Xf),em.multiplyMatrices(de,Xf),_p.matrixWorld=em,_p.raycast(K,Jp);for(let Ue=0,He=Jp.length;Ue<He;Ue++){const Ke=Jp[Ue];Ke.instanceId=Ie,Ke.object=this,oe.push(Ke)}Jp.length=0}}setColorAt(K,oe){this.instanceColor===null&&(this.instanceColor=new $f(new Float32Array(this.instanceMatrix.count*3),3)),oe.toArray(this.instanceColor.array,K*3)}setMatrixAt(K,oe){oe.toArray(this.instanceMatrix.array,K*16)}setMorphAt(K,oe){const de=oe.morphTargetInfluences,ye=de.length+1;this.morphTexture===null&&(this.morphTexture=new hd(new Float32Array(ye*this.count),ye,this.count,gi,ko));const Ie=this.morphTexture.source.data.data;let Ue=0;for(let Ze=0;Ze<de.length;Ze++)Ue+=de[Ze];const He=this.geometry.morphTargetsRelative?1:1-Ue,Ke=ye*K;Ie[Ke]=He,Ie.set(de,Ke+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function c3(Be,K){return Be.z-K.z}function u3(Be,K){return K.z-Be.z}class h3{constructor(){this.index=0,this.pool=[],this.list=[]}push(K,oe){const de=this.pool,ye=this.list;this.index>=de.length&&de.push({start:-1,count:-1,z:-1});const Ie=de[this.index];ye.push(Ie),this.index++,Ie.start=K.start,Ie.count=K.count,Ie.z=oe}reset(){this.list.length=0,this.index=0}}const Kf="batchId",dd=new kr,im=new kr,d3=new kr,rm=new kr,KA=new Cc,Zp=new Rs,b1=new la,Cp=new vn,YA=new h3,al=new Zo,jp=[];function f3(Be,K,oe=0){const de=K.itemSize;if(Be.isInterleavedBufferAttribute||Be.array.constructor!==K.array.constructor){const ye=Be.count;for(let Ie=0;Ie<ye;Ie++)for(let Ue=0;Ue<de;Ue++)K.setComponent(Ie+oe,Ue,Be.getComponent(Ie,Ue))}else K.array.set(Be.array,oe*de);K.needsUpdate=!0}class sm extends Zo{get maxGeometryCount(){return this._maxGeometryCount}constructor(K,oe,de=oe*2,ye){super(new Ds,ye),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=K,this._maxVertexCount=oe,this._maxIndexCount=de,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(K),this._multiDrawStarts=new Int32Array(K),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let K=Math.sqrt(this._maxGeometryCount*4);K=Math.ceil(K/4)*4,K=Math.max(K,4);const oe=new Float32Array(K*K*4),de=new hd(oe,K,K,Jt,ko);this._matricesTexture=de}_initializeGeometry(K){const oe=this.geometry,de=this._maxVertexCount,ye=this._maxGeometryCount,Ie=this._maxIndexCount;if(this._geometryInitialized===!1){for(const He in K.attributes){const Ke=K.getAttribute(He),{array:Ze,itemSize:at,normalized:mt}=Ke,vt=new Ze.constructor(de*at),St=new So(vt,at,mt);oe.setAttribute(He,St)}if(K.getIndex()!==null){const He=de>65536?new Uint32Array(Ie):new Uint16Array(Ie);oe.setIndex(new So(He,1))}const Ue=ye>65536?new Uint32Array(de):new Uint16Array(de);oe.setAttribute(Kf,new So(Ue,1)),this._geometryInitialized=!0}}_validateGeometry(K){if(K.getAttribute(Kf))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Kf}"`);const oe=this.geometry;if(!!K.getIndex()!=!!oe.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const de in oe.attributes){if(de===Kf)continue;if(!K.hasAttribute(de))throw new Error(`BatchedMesh: Added geometry missing "${de}". All geometries must have consistent attributes.`);const ye=K.getAttribute(de),Ie=oe.getAttribute(de);if(ye.itemSize!==Ie.itemSize||ye.normalized!==Ie.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(K){return this.customSort=K,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Rs);const K=this._geometryCount,oe=this.boundingBox,de=this._active;oe.makeEmpty();for(let ye=0;ye<K;ye++)de[ye]!==!1&&(this.getMatrixAt(ye,dd),this.getBoundingBoxAt(ye,Zp).applyMatrix4(dd),oe.union(Zp))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new la);const K=this._geometryCount,oe=this.boundingSphere,de=this._active;oe.makeEmpty();for(let ye=0;ye<K;ye++)de[ye]!==!1&&(this.getMatrixAt(ye,dd),this.getBoundingSphereAt(ye,b1).applyMatrix4(dd),oe.union(b1))}addGeometry(K,oe=-1,de=-1){if(this._initializeGeometry(K),this._validateGeometry(K),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const ye={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let Ie=null;const Ue=this._reservedRanges,He=this._drawRanges,Ke=this._bounds;this._geometryCount!==0&&(Ie=Ue[Ue.length-1]),oe===-1?ye.vertexCount=K.getAttribute("position").count:ye.vertexCount=oe,Ie===null?ye.vertexStart=0:ye.vertexStart=Ie.vertexStart+Ie.vertexCount;const Ze=K.getIndex(),at=Ze!==null;if(at&&(de===-1?ye.indexCount=Ze.count:ye.indexCount=de,Ie===null?ye.indexStart=0:ye.indexStart=Ie.indexStart+Ie.indexCount),ye.indexStart!==-1&&ye.indexStart+ye.indexCount>this._maxIndexCount||ye.vertexStart+ye.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const mt=this._visibility,vt=this._active,St=this._matricesTexture,Lt=this._matricesTexture.image.data;mt.push(!0),vt.push(!0);const Ht=this._geometryCount;this._geometryCount++,d3.toArray(Lt,Ht*16),St.needsUpdate=!0,Ue.push(ye),He.push({start:at?ye.indexStart:ye.vertexStart,count:-1}),Ke.push({boxInitialized:!1,box:new Rs,sphereInitialized:!1,sphere:new la});const Dt=this.geometry.getAttribute(Kf);for(let bt=0;bt<ye.vertexCount;bt++)Dt.setX(ye.vertexStart+bt,Ht);return Dt.needsUpdate=!0,this.setGeometryAt(Ht,K),Ht}setGeometryAt(K,oe){if(K>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(oe);const de=this.geometry,ye=de.getIndex()!==null,Ie=de.getIndex(),Ue=oe.getIndex(),He=this._reservedRanges[K];if(ye&&Ue.count>He.indexCount||oe.attributes.position.count>He.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const Ke=He.vertexStart,Ze=He.vertexCount;for(const St in de.attributes){if(St===Kf)continue;const Lt=oe.getAttribute(St),Ht=de.getAttribute(St);f3(Lt,Ht,Ke);const Dt=Lt.itemSize;for(let bt=Lt.count,tn=Ze;bt<tn;bt++){const Zt=Ke+bt;for(let qt=0;qt<Dt;qt++)Ht.setComponent(Zt,qt,0)}Ht.needsUpdate=!0,Ht.addUpdateRange(Ke*Dt,Ze*Dt)}if(ye){const St=He.indexStart;for(let Lt=0;Lt<Ue.count;Lt++)Ie.setX(St+Lt,Ke+Ue.getX(Lt));for(let Lt=Ue.count,Ht=He.indexCount;Lt<Ht;Lt++)Ie.setX(St+Lt,Ke);Ie.needsUpdate=!0,Ie.addUpdateRange(St,He.indexCount)}const at=this._bounds[K];oe.boundingBox!==null?(at.box.copy(oe.boundingBox),at.boxInitialized=!0):at.boxInitialized=!1,oe.boundingSphere!==null?(at.sphere.copy(oe.boundingSphere),at.sphereInitialized=!0):at.sphereInitialized=!1;const mt=this._drawRanges[K],vt=oe.getAttribute("position");return mt.count=ye?Ue.count:vt.count,this._visibilityChanged=!0,K}deleteGeometry(K){const oe=this._active;return K>=oe.length||oe[K]===!1?this:(oe[K]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(K){return this._multiDrawInstances===null?null:this._multiDrawInstances[K]}setInstanceCountAt(K,oe){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[K]=oe,K}getBoundingBoxAt(K,oe){if(this._active[K]===!1)return null;const ye=this._bounds[K],Ie=ye.box,Ue=this.geometry;if(ye.boxInitialized===!1){Ie.makeEmpty();const He=Ue.index,Ke=Ue.attributes.position,Ze=this._drawRanges[K];for(let at=Ze.start,mt=Ze.start+Ze.count;at<mt;at++){let vt=at;He&&(vt=He.getX(vt)),Ie.expandByPoint(Cp.fromBufferAttribute(Ke,vt))}ye.boxInitialized=!0}return oe.copy(Ie),oe}getBoundingSphereAt(K,oe){if(this._active[K]===!1)return null;const ye=this._bounds[K],Ie=ye.sphere,Ue=this.geometry;if(ye.sphereInitialized===!1){Ie.makeEmpty(),this.getBoundingBoxAt(K,Zp),Zp.getCenter(Ie.center);const He=Ue.index,Ke=Ue.attributes.position,Ze=this._drawRanges[K];let at=0;for(let mt=Ze.start,vt=Ze.start+Ze.count;mt<vt;mt++){let St=mt;He&&(St=He.getX(St)),Cp.fromBufferAttribute(Ke,St),at=Math.max(at,Ie.center.distanceToSquared(Cp))}Ie.radius=Math.sqrt(at),ye.sphereInitialized=!0}return oe.copy(Ie),oe}setMatrixAt(K,oe){const de=this._active,ye=this._matricesTexture,Ie=this._matricesTexture.image.data,Ue=this._geometryCount;return K>=Ue||de[K]===!1?this:(oe.toArray(Ie,K*16),ye.needsUpdate=!0,this)}getMatrixAt(K,oe){const de=this._active,ye=this._matricesTexture.image.data,Ie=this._geometryCount;return K>=Ie||de[K]===!1?null:oe.fromArray(ye,K*16)}setVisibleAt(K,oe){const de=this._visibility,ye=this._active,Ie=this._geometryCount;return K>=Ie||ye[K]===!1||de[K]===oe?this:(de[K]=oe,this._visibilityChanged=!0,this)}getVisibleAt(K){const oe=this._visibility,de=this._active,ye=this._geometryCount;return K>=ye||de[K]===!1?!1:oe[K]}raycast(K,oe){const de=this._visibility,ye=this._active,Ie=this._drawRanges,Ue=this._geometryCount,He=this.matrixWorld,Ke=this.geometry;al.material=this.material,al.geometry.index=Ke.index,al.geometry.attributes=Ke.attributes,al.geometry.boundingBox===null&&(al.geometry.boundingBox=new Rs),al.geometry.boundingSphere===null&&(al.geometry.boundingSphere=new la);for(let Ze=0;Ze<Ue;Ze++){if(!de[Ze]||!ye[Ze])continue;const at=Ie[Ze];al.geometry.setDrawRange(at.start,at.count),this.getMatrixAt(Ze,al.matrixWorld).premultiply(He),this.getBoundingBoxAt(Ze,al.geometry.boundingBox),this.getBoundingSphereAt(Ze,al.geometry.boundingSphere),al.raycast(K,jp);for(let mt=0,vt=jp.length;mt<vt;mt++){const St=jp[mt];St.object=this,St.batchId=Ze,oe.push(St)}jp.length=0}al.material=null,al.geometry.index=null,al.geometry.attributes={},al.geometry.setDrawRange(0,1/0)}copy(K){return super.copy(K),this.geometry=K.geometry.clone(),this.perObjectFrustumCulled=K.perObjectFrustumCulled,this.sortObjects=K.sortObjects,this.boundingBox=K.boundingBox!==null?K.boundingBox.clone():null,this.boundingSphere=K.boundingSphere!==null?K.boundingSphere.clone():null,this._drawRanges=K._drawRanges.map(oe=>({...oe})),this._reservedRanges=K._reservedRanges.map(oe=>({...oe})),this._visibility=K._visibility.slice(),this._active=K._active.slice(),this._bounds=K._bounds.map(oe=>({boxInitialized:oe.boxInitialized,box:oe.box.clone(),sphereInitialized:oe.sphereInitialized,sphere:oe.sphere.clone()})),this._maxGeometryCount=K._maxGeometryCount,this._maxVertexCount=K._maxVertexCount,this._maxIndexCount=K._maxIndexCount,this._geometryInitialized=K._geometryInitialized,this._geometryCount=K._geometryCount,this._multiDrawCounts=K._multiDrawCounts.slice(),this._multiDrawStarts=K._multiDrawStarts.slice(),this._matricesTexture=K._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(K,oe,de,ye,Ie){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const Ue=ye.getIndex(),He=Ue===null?1:Ue.array.BYTES_PER_ELEMENT,Ke=this._active,Ze=this._visibility,at=this._multiDrawStarts,mt=this._multiDrawCounts,vt=this._drawRanges,St=this.perObjectFrustumCulled;St&&(rm.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse).multiply(this.matrixWorld),KA.setFromProjectionMatrix(rm,K.coordinateSystem));let Lt=0;if(this.sortObjects){im.copy(this.matrixWorld).invert(),Cp.setFromMatrixPosition(de.matrixWorld).applyMatrix4(im);for(let bt=0,tn=Ze.length;bt<tn;bt++)if(Ze[bt]&&Ke[bt]){this.getMatrixAt(bt,dd),this.getBoundingSphereAt(bt,b1).applyMatrix4(dd);let Zt=!1;if(St&&(Zt=!KA.intersectsSphere(b1)),!Zt){const qt=Cp.distanceTo(b1.center);YA.push(vt[bt],qt)}}const Ht=YA.list,Dt=this.customSort;Dt===null?Ht.sort(Ie.transparent?u3:c3):Dt.call(this,Ht,de);for(let bt=0,tn=Ht.length;bt<tn;bt++){const Zt=Ht[bt];at[Lt]=Zt.start*He,mt[Lt]=Zt.count,Lt++}YA.reset()}else for(let Ht=0,Dt=Ze.length;Ht<Dt;Ht++)if(Ze[Ht]&&Ke[Ht]){let bt=!1;if(St&&(this.getMatrixAt(Ht,dd),this.getBoundingSphereAt(Ht,b1).applyMatrix4(dd),bt=!KA.intersectsSphere(b1)),!bt){const tn=vt[Ht];at[Lt]=tn.start*He,mt[Lt]=tn.count,Lt++}}this._multiDrawCount=Lt,this._visibilityChanged=!1}onBeforeShadow(K,oe,de,ye,Ie,Ue){this.onBeforeRender(K,null,ye,Ie,Ue)}}class bl extends Oo{constructor(K){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Wr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.map=K.map,this.linewidth=K.linewidth,this.linecap=K.linecap,this.linejoin=K.linejoin,this.fog=K.fog,this}}const eA=new vn,tA=new vn,om=new kr,xp=new Jo,nA=new la,qA=new vn,am=new vn;class fd extends uo{constructor(K=new Ds,oe=new bl){super(),this.isLine=!0,this.type="Line",this.geometry=K,this.material=oe,this.updateMorphTargets()}copy(K,oe){return super.copy(K,oe),this.material=Array.isArray(K.material)?K.material.slice():K.material,this.geometry=K.geometry,this}computeLineDistances(){const K=this.geometry;if(K.index===null){const oe=K.attributes.position,de=[0];for(let ye=1,Ie=oe.count;ye<Ie;ye++)eA.fromBufferAttribute(oe,ye-1),tA.fromBufferAttribute(oe,ye),de[ye]=de[ye-1],de[ye]+=eA.distanceTo(tA);K.setAttribute("lineDistance",new $i(de,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(K,oe){const de=this.geometry,ye=this.matrixWorld,Ie=K.params.Line.threshold,Ue=de.drawRange;if(de.boundingSphere===null&&de.computeBoundingSphere(),nA.copy(de.boundingSphere),nA.applyMatrix4(ye),nA.radius+=Ie,K.ray.intersectsSphere(nA)===!1)return;om.copy(ye).invert(),xp.copy(K.ray).applyMatrix4(om);const He=Ie/((this.scale.x+this.scale.y+this.scale.z)/3),Ke=He*He,Ze=this.isLineSegments?2:1,at=de.index,vt=de.attributes.position;if(at!==null){const St=Math.max(0,Ue.start),Lt=Math.min(at.count,Ue.start+Ue.count);for(let Ht=St,Dt=Lt-1;Ht<Dt;Ht+=Ze){const bt=at.getX(Ht),tn=at.getX(Ht+1),Zt=iA(this,K,xp,Ke,bt,tn);Zt&&oe.push(Zt)}if(this.isLineLoop){const Ht=at.getX(Lt-1),Dt=at.getX(St),bt=iA(this,K,xp,Ke,Ht,Dt);bt&&oe.push(bt)}}else{const St=Math.max(0,Ue.start),Lt=Math.min(vt.count,Ue.start+Ue.count);for(let Ht=St,Dt=Lt-1;Ht<Dt;Ht+=Ze){const bt=iA(this,K,xp,Ke,Ht,Ht+1);bt&&oe.push(bt)}if(this.isLineLoop){const Ht=iA(this,K,xp,Ke,Lt-1,St);Ht&&oe.push(Ht)}}}updateMorphTargets(){const oe=this.geometry.morphAttributes,de=Object.keys(oe);if(de.length>0){const ye=oe[de[0]];if(ye!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++){const He=ye[Ie].name||String(Ie);this.morphTargetInfluences.push(0),this.morphTargetDictionary[He]=Ie}}}}}function iA(Be,K,oe,de,ye,Ie){const Ue=Be.geometry.attributes.position;if(eA.fromBufferAttribute(Ue,ye),tA.fromBufferAttribute(Ue,Ie),oe.distanceSqToSegment(eA,tA,qA,am)>de)return;qA.applyMatrix4(Be.matrixWorld);const Ke=K.ray.origin.distanceTo(qA);if(!(Ke<K.near||Ke>K.far))return{distance:Ke,point:am.clone().applyMatrix4(Be.matrixWorld),index:ye,face:null,faceIndex:null,object:Be}}const lm=new vn,cm=new vn;class Fu extends fd{constructor(K,oe){super(K,oe),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const K=this.geometry;if(K.index===null){const oe=K.attributes.position,de=[];for(let ye=0,Ie=oe.count;ye<Ie;ye+=2)lm.fromBufferAttribute(oe,ye),cm.fromBufferAttribute(oe,ye+1),de[ye]=ye===0?0:de[ye-1],de[ye+1]=de[ye]+lm.distanceTo(cm);K.setAttribute("lineDistance",new $i(de,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class um extends fd{constructor(K,oe){super(K,oe),this.isLineLoop=!0,this.type="LineLoop"}}class JA extends Oo{constructor(K){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Wr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.map=K.map,this.alphaMap=K.alphaMap,this.size=K.size,this.sizeAttenuation=K.sizeAttenuation,this.fog=K.fog,this}}const hm=new kr,ZA=new Jo,rA=new la,sA=new vn;class dm extends uo{constructor(K=new Ds,oe=new JA){super(),this.isPoints=!0,this.type="Points",this.geometry=K,this.material=oe,this.updateMorphTargets()}copy(K,oe){return super.copy(K,oe),this.material=Array.isArray(K.material)?K.material.slice():K.material,this.geometry=K.geometry,this}raycast(K,oe){const de=this.geometry,ye=this.matrixWorld,Ie=K.params.Points.threshold,Ue=de.drawRange;if(de.boundingSphere===null&&de.computeBoundingSphere(),rA.copy(de.boundingSphere),rA.applyMatrix4(ye),rA.radius+=Ie,K.ray.intersectsSphere(rA)===!1)return;hm.copy(ye).invert(),ZA.copy(K.ray).applyMatrix4(hm);const He=Ie/((this.scale.x+this.scale.y+this.scale.z)/3),Ke=He*He,Ze=de.index,mt=de.attributes.position;if(Ze!==null){const vt=Math.max(0,Ue.start),St=Math.min(Ze.count,Ue.start+Ue.count);for(let Lt=vt,Ht=St;Lt<Ht;Lt++){const Dt=Ze.getX(Lt);sA.fromBufferAttribute(mt,Dt),fm(sA,Dt,Ke,ye,K,oe,this)}}else{const vt=Math.max(0,Ue.start),St=Math.min(mt.count,Ue.start+Ue.count);for(let Lt=vt,Ht=St;Lt<Ht;Lt++)sA.fromBufferAttribute(mt,Lt),fm(sA,Lt,Ke,ye,K,oe,this)}}updateMorphTargets(){const oe=this.geometry.morphAttributes,de=Object.keys(oe);if(de.length>0){const ye=oe[de[0]];if(ye!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++){const He=ye[Ie].name||String(Ie);this.morphTargetInfluences.push(0),this.morphTargetDictionary[He]=Ie}}}}}function fm(Be,K,oe,de,ye,Ie,Ue){const He=ZA.distanceSqToPoint(Be);if(He<oe){const Ke=new vn;ZA.closestPointToPoint(Be,Ke),Ke.applyMatrix4(de);const Ze=ye.ray.origin.distanceTo(Ke);if(Ze<ye.near||Ze>ye.far)return;Ie.push({distance:Ze,distanceToRay:Math.sqrt(He),point:Ke,index:K,face:null,object:Ue})}}class p3 extends Fo{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze){super(K,oe,de,ye,Ie,Ue,He,Ke,Ze),this.isVideoTexture=!0,this.minFilter=Ue!==void 0?Ue:Jr,this.magFilter=Ie!==void 0?Ie:Jr,this.generateMipmaps=!1;const at=this;function mt(){at.needsUpdate=!0,K.requestVideoFrameCallback(mt)}"requestVideoFrameCallback"in K&&K.requestVideoFrameCallback(mt)}clone(){return new this.constructor(this.image).copy(this)}update(){const K=this.image;"requestVideoFrameCallback"in K===!1&&K.readyState>=K.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class A3 extends Fo{constructor(K,oe){super({width:K,height:oe}),this.isFramebufferTexture=!0,this.magFilter=ki,this.minFilter=ki,this.generateMipmaps=!1,this.needsUpdate=!0}}class oA extends Fo{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze,at,mt,vt){super(null,Ue,He,Ke,Ze,at,ye,Ie,mt,vt),this.isCompressedTexture=!0,this.image={width:oe,height:de},this.mipmaps=K,this.flipY=!1,this.generateMipmaps=!1}}class m3 extends oA{constructor(K,oe,de,ye,Ie,Ue){super(K,oe,de,Ie,Ue),this.isCompressedArrayTexture=!0,this.image.depth=ye,this.wrapR=yn}}class g3 extends oA{constructor(K,oe,de){super(void 0,K[0].width,K[0].height,oe,de,Nt),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=K}}class v3 extends Fo{constructor(K,oe,de,ye,Ie,Ue,He,Ke,Ze){super(K,oe,de,ye,Ie,Ue,He,Ke,Ze),this.isCanvasTexture=!0,this.needsUpdate=!0}}class cu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(K,oe){const de=this.getUtoTmapping(K);return this.getPoint(de,oe)}getPoints(K=5){const oe=[];for(let de=0;de<=K;de++)oe.push(this.getPoint(de/K));return oe}getSpacedPoints(K=5){const oe=[];for(let de=0;de<=K;de++)oe.push(this.getPointAt(de/K));return oe}getLength(){const K=this.getLengths();return K[K.length-1]}getLengths(K=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===K+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const oe=[];let de,ye=this.getPoint(0),Ie=0;oe.push(0);for(let Ue=1;Ue<=K;Ue++)de=this.getPoint(Ue/K),Ie+=de.distanceTo(ye),oe.push(Ie),ye=de;return this.cacheArcLengths=oe,oe}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(K,oe){const de=this.getLengths();let ye=0;const Ie=de.length;let Ue;oe?Ue=oe:Ue=K*de[Ie-1];let He=0,Ke=Ie-1,Ze;for(;He<=Ke;)if(ye=Math.floor(He+(Ke-He)/2),Ze=de[ye]-Ue,Ze<0)He=ye+1;else if(Ze>0)Ke=ye-1;else{Ke=ye;break}if(ye=Ke,de[ye]===Ue)return ye/(Ie-1);const at=de[ye],vt=de[ye+1]-at,St=(Ue-at)/vt;return(ye+St)/(Ie-1)}getTangent(K,oe){let ye=K-1e-4,Ie=K+1e-4;ye<0&&(ye=0),Ie>1&&(Ie=1);const Ue=this.getPoint(ye),He=this.getPoint(Ie),Ke=oe||(Ue.isVector2?new qi:new vn);return Ke.copy(He).sub(Ue).normalize(),Ke}getTangentAt(K,oe){const de=this.getUtoTmapping(K);return this.getTangent(de,oe)}computeFrenetFrames(K,oe){const de=new vn,ye=[],Ie=[],Ue=[],He=new vn,Ke=new kr;for(let St=0;St<=K;St++){const Lt=St/K;ye[St]=this.getTangentAt(Lt,new vn)}Ie[0]=new vn,Ue[0]=new vn;let Ze=Number.MAX_VALUE;const at=Math.abs(ye[0].x),mt=Math.abs(ye[0].y),vt=Math.abs(ye[0].z);at<=Ze&&(Ze=at,de.set(1,0,0)),mt<=Ze&&(Ze=mt,de.set(0,1,0)),vt<=Ze&&de.set(0,0,1),He.crossVectors(ye[0],de).normalize(),Ie[0].crossVectors(ye[0],He),Ue[0].crossVectors(ye[0],Ie[0]);for(let St=1;St<=K;St++){if(Ie[St]=Ie[St-1].clone(),Ue[St]=Ue[St-1].clone(),He.crossVectors(ye[St-1],ye[St]),He.length()>Number.EPSILON){He.normalize();const Lt=Math.acos(qo(ye[St-1].dot(ye[St]),-1,1));Ie[St].applyMatrix4(Ke.makeRotationAxis(He,Lt))}Ue[St].crossVectors(ye[St],Ie[St])}if(oe===!0){let St=Math.acos(qo(Ie[0].dot(Ie[K]),-1,1));St/=K,ye[0].dot(He.crossVectors(Ie[0],Ie[K]))>0&&(St=-St);for(let Lt=1;Lt<=K;Lt++)Ie[Lt].applyMatrix4(Ke.makeRotationAxis(ye[Lt],St*Lt)),Ue[Lt].crossVectors(ye[Lt],Ie[Lt])}return{tangents:ye,normals:Ie,binormals:Ue}}clone(){return new this.constructor().copy(this)}copy(K){return this.arcLengthDivisions=K.arcLengthDivisions,this}toJSON(){const K={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return K.arcLengthDivisions=this.arcLengthDivisions,K.type=this.type,K}fromJSON(K){return this.arcLengthDivisions=K.arcLengthDivisions,this}}class aA extends cu{constructor(K=0,oe=0,de=1,ye=1,Ie=0,Ue=Math.PI*2,He=!1,Ke=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=K,this.aY=oe,this.xRadius=de,this.yRadius=ye,this.aStartAngle=Ie,this.aEndAngle=Ue,this.aClockwise=He,this.aRotation=Ke}getPoint(K,oe=new qi){const de=oe,ye=Math.PI*2;let Ie=this.aEndAngle-this.aStartAngle;const Ue=Math.abs(Ie)<Number.EPSILON;for(;Ie<0;)Ie+=ye;for(;Ie>ye;)Ie-=ye;Ie<Number.EPSILON&&(Ue?Ie=0:Ie=ye),this.aClockwise===!0&&!Ue&&(Ie===ye?Ie=-ye:Ie=Ie-ye);const He=this.aStartAngle+K*Ie;let Ke=this.aX+this.xRadius*Math.cos(He),Ze=this.aY+this.yRadius*Math.sin(He);if(this.aRotation!==0){const at=Math.cos(this.aRotation),mt=Math.sin(this.aRotation),vt=Ke-this.aX,St=Ze-this.aY;Ke=vt*at-St*mt+this.aX,Ze=vt*mt+St*at+this.aY}return de.set(Ke,Ze)}copy(K){return super.copy(K),this.aX=K.aX,this.aY=K.aY,this.xRadius=K.xRadius,this.yRadius=K.yRadius,this.aStartAngle=K.aStartAngle,this.aEndAngle=K.aEndAngle,this.aClockwise=K.aClockwise,this.aRotation=K.aRotation,this}toJSON(){const K=super.toJSON();return K.aX=this.aX,K.aY=this.aY,K.xRadius=this.xRadius,K.yRadius=this.yRadius,K.aStartAngle=this.aStartAngle,K.aEndAngle=this.aEndAngle,K.aClockwise=this.aClockwise,K.aRotation=this.aRotation,K}fromJSON(K){return super.fromJSON(K),this.aX=K.aX,this.aY=K.aY,this.xRadius=K.xRadius,this.yRadius=K.yRadius,this.aStartAngle=K.aStartAngle,this.aEndAngle=K.aEndAngle,this.aClockwise=K.aClockwise,this.aRotation=K.aRotation,this}}class pm extends aA{constructor(K,oe,de,ye,Ie,Ue){super(K,oe,de,de,ye,Ie,Ue),this.isArcCurve=!0,this.type="ArcCurve"}}function jA(){let Be=0,K=0,oe=0,de=0;function ye(Ie,Ue,He,Ke){Be=Ie,K=He,oe=-3*Ie+3*Ue-2*He-Ke,de=2*Ie-2*Ue+He+Ke}return{initCatmullRom:function(Ie,Ue,He,Ke,Ze){ye(Ue,He,Ze*(He-Ie),Ze*(Ke-Ue))},initNonuniformCatmullRom:function(Ie,Ue,He,Ke,Ze,at,mt){let vt=(Ue-Ie)/Ze-(He-Ie)/(Ze+at)+(He-Ue)/at,St=(He-Ue)/at-(Ke-Ue)/(at+mt)+(Ke-He)/mt;vt*=at,St*=at,ye(Ue,He,vt,St)},calc:function(Ie){const Ue=Ie*Ie,He=Ue*Ie;return Be+K*Ie+oe*Ue+de*He}}}const lA=new vn,e2=new jA,t2=new jA,n2=new jA;class Am extends cu{constructor(K=[],oe=!1,de="centripetal",ye=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=K,this.closed=oe,this.curveType=de,this.tension=ye}getPoint(K,oe=new vn){const de=oe,ye=this.points,Ie=ye.length,Ue=(Ie-(this.closed?0:1))*K;let He=Math.floor(Ue),Ke=Ue-He;this.closed?He+=He>0?0:(Math.floor(Math.abs(He)/Ie)+1)*Ie:Ke===0&&He===Ie-1&&(He=Ie-2,Ke=1);let Ze,at;this.closed||He>0?Ze=ye[(He-1)%Ie]:(lA.subVectors(ye[0],ye[1]).add(ye[0]),Ze=lA);const mt=ye[He%Ie],vt=ye[(He+1)%Ie];if(this.closed||He+2<Ie?at=ye[(He+2)%Ie]:(lA.subVectors(ye[Ie-1],ye[Ie-2]).add(ye[Ie-1]),at=lA),this.curveType==="centripetal"||this.curveType==="chordal"){const St=this.curveType==="chordal"?.5:.25;let Lt=Math.pow(Ze.distanceToSquared(mt),St),Ht=Math.pow(mt.distanceToSquared(vt),St),Dt=Math.pow(vt.distanceToSquared(at),St);Ht<1e-4&&(Ht=1),Lt<1e-4&&(Lt=Ht),Dt<1e-4&&(Dt=Ht),e2.initNonuniformCatmullRom(Ze.x,mt.x,vt.x,at.x,Lt,Ht,Dt),t2.initNonuniformCatmullRom(Ze.y,mt.y,vt.y,at.y,Lt,Ht,Dt),n2.initNonuniformCatmullRom(Ze.z,mt.z,vt.z,at.z,Lt,Ht,Dt)}else this.curveType==="catmullrom"&&(e2.initCatmullRom(Ze.x,mt.x,vt.x,at.x,this.tension),t2.initCatmullRom(Ze.y,mt.y,vt.y,at.y,this.tension),n2.initCatmullRom(Ze.z,mt.z,vt.z,at.z,this.tension));return de.set(e2.calc(Ke),t2.calc(Ke),n2.calc(Ke)),de}copy(K){super.copy(K),this.points=[];for(let oe=0,de=K.points.length;oe<de;oe++){const ye=K.points[oe];this.points.push(ye.clone())}return this.closed=K.closed,this.curveType=K.curveType,this.tension=K.tension,this}toJSON(){const K=super.toJSON();K.points=[];for(let oe=0,de=this.points.length;oe<de;oe++){const ye=this.points[oe];K.points.push(ye.toArray())}return K.closed=this.closed,K.curveType=this.curveType,K.tension=this.tension,K}fromJSON(K){super.fromJSON(K),this.points=[];for(let oe=0,de=K.points.length;oe<de;oe++){const ye=K.points[oe];this.points.push(new vn().fromArray(ye))}return this.closed=K.closed,this.curveType=K.curveType,this.tension=K.tension,this}}function mm(Be,K,oe,de,ye){const Ie=(de-K)*.5,Ue=(ye-oe)*.5,He=Be*Be,Ke=Be*He;return(2*oe-2*de+Ie+Ue)*Ke+(-3*oe+3*de-2*Ie-Ue)*He+Ie*Be+oe}function E3(Be,K){const oe=1-Be;return oe*oe*K}function _3(Be,K){return 2*(1-Be)*Be*K}function y3(Be,K){return Be*Be*K}function wp(Be,K,oe,de){return E3(Be,K)+_3(Be,oe)+y3(Be,de)}function C3(Be,K){const oe=1-Be;return oe*oe*oe*K}function x3(Be,K){const oe=1-Be;return 3*oe*oe*Be*K}function w3(Be,K){return 3*(1-Be)*Be*Be*K}function S3(Be,K){return Be*Be*Be*K}function Sp(Be,K,oe,de,ye){return C3(Be,K)+x3(Be,oe)+w3(Be,de)+S3(Be,ye)}class i2 extends cu{constructor(K=new qi,oe=new qi,de=new qi,ye=new qi){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=K,this.v1=oe,this.v2=de,this.v3=ye}getPoint(K,oe=new qi){const de=oe,ye=this.v0,Ie=this.v1,Ue=this.v2,He=this.v3;return de.set(Sp(K,ye.x,Ie.x,Ue.x,He.x),Sp(K,ye.y,Ie.y,Ue.y,He.y)),de}copy(K){return super.copy(K),this.v0.copy(K.v0),this.v1.copy(K.v1),this.v2.copy(K.v2),this.v3.copy(K.v3),this}toJSON(){const K=super.toJSON();return K.v0=this.v0.toArray(),K.v1=this.v1.toArray(),K.v2=this.v2.toArray(),K.v3=this.v3.toArray(),K}fromJSON(K){return super.fromJSON(K),this.v0.fromArray(K.v0),this.v1.fromArray(K.v1),this.v2.fromArray(K.v2),this.v3.fromArray(K.v3),this}}class gm extends cu{constructor(K=new vn,oe=new vn,de=new vn,ye=new vn){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=K,this.v1=oe,this.v2=de,this.v3=ye}getPoint(K,oe=new vn){const de=oe,ye=this.v0,Ie=this.v1,Ue=this.v2,He=this.v3;return de.set(Sp(K,ye.x,Ie.x,Ue.x,He.x),Sp(K,ye.y,Ie.y,Ue.y,He.y),Sp(K,ye.z,Ie.z,Ue.z,He.z)),de}copy(K){return super.copy(K),this.v0.copy(K.v0),this.v1.copy(K.v1),this.v2.copy(K.v2),this.v3.copy(K.v3),this}toJSON(){const K=super.toJSON();return K.v0=this.v0.toArray(),K.v1=this.v1.toArray(),K.v2=this.v2.toArray(),K.v3=this.v3.toArray(),K}fromJSON(K){return super.fromJSON(K),this.v0.fromArray(K.v0),this.v1.fromArray(K.v1),this.v2.fromArray(K.v2),this.v3.fromArray(K.v3),this}}class r2 extends cu{constructor(K=new qi,oe=new qi){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=K,this.v2=oe}getPoint(K,oe=new qi){const de=oe;return K===1?de.copy(this.v2):(de.copy(this.v2).sub(this.v1),de.multiplyScalar(K).add(this.v1)),de}getPointAt(K,oe){return this.getPoint(K,oe)}getTangent(K,oe=new qi){return oe.subVectors(this.v2,this.v1).normalize()}getTangentAt(K,oe){return this.getTangent(K,oe)}copy(K){return super.copy(K),this.v1.copy(K.v1),this.v2.copy(K.v2),this}toJSON(){const K=super.toJSON();return K.v1=this.v1.toArray(),K.v2=this.v2.toArray(),K}fromJSON(K){return super.fromJSON(K),this.v1.fromArray(K.v1),this.v2.fromArray(K.v2),this}}class vm extends cu{constructor(K=new vn,oe=new vn){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=K,this.v2=oe}getPoint(K,oe=new vn){const de=oe;return K===1?de.copy(this.v2):(de.copy(this.v2).sub(this.v1),de.multiplyScalar(K).add(this.v1)),de}getPointAt(K,oe){return this.getPoint(K,oe)}getTangent(K,oe=new vn){return oe.subVectors(this.v2,this.v1).normalize()}getTangentAt(K,oe){return this.getTangent(K,oe)}copy(K){return super.copy(K),this.v1.copy(K.v1),this.v2.copy(K.v2),this}toJSON(){const K=super.toJSON();return K.v1=this.v1.toArray(),K.v2=this.v2.toArray(),K}fromJSON(K){return super.fromJSON(K),this.v1.fromArray(K.v1),this.v2.fromArray(K.v2),this}}class s2 extends cu{constructor(K=new qi,oe=new qi,de=new qi){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=K,this.v1=oe,this.v2=de}getPoint(K,oe=new qi){const de=oe,ye=this.v0,Ie=this.v1,Ue=this.v2;return de.set(wp(K,ye.x,Ie.x,Ue.x),wp(K,ye.y,Ie.y,Ue.y)),de}copy(K){return super.copy(K),this.v0.copy(K.v0),this.v1.copy(K.v1),this.v2.copy(K.v2),this}toJSON(){const K=super.toJSON();return K.v0=this.v0.toArray(),K.v1=this.v1.toArray(),K.v2=this.v2.toArray(),K}fromJSON(K){return super.fromJSON(K),this.v0.fromArray(K.v0),this.v1.fromArray(K.v1),this.v2.fromArray(K.v2),this}}class o2 extends cu{constructor(K=new vn,oe=new vn,de=new vn){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=K,this.v1=oe,this.v2=de}getPoint(K,oe=new vn){const de=oe,ye=this.v0,Ie=this.v1,Ue=this.v2;return de.set(wp(K,ye.x,Ie.x,Ue.x),wp(K,ye.y,Ie.y,Ue.y),wp(K,ye.z,Ie.z,Ue.z)),de}copy(K){return super.copy(K),this.v0.copy(K.v0),this.v1.copy(K.v1),this.v2.copy(K.v2),this}toJSON(){const K=super.toJSON();return K.v0=this.v0.toArray(),K.v1=this.v1.toArray(),K.v2=this.v2.toArray(),K}fromJSON(K){return super.fromJSON(K),this.v0.fromArray(K.v0),this.v1.fromArray(K.v1),this.v2.fromArray(K.v2),this}}class a2 extends cu{constructor(K=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=K}getPoint(K,oe=new qi){const de=oe,ye=this.points,Ie=(ye.length-1)*K,Ue=Math.floor(Ie),He=Ie-Ue,Ke=ye[Ue===0?Ue:Ue-1],Ze=ye[Ue],at=ye[Ue>ye.length-2?ye.length-1:Ue+1],mt=ye[Ue>ye.length-3?ye.length-1:Ue+2];return de.set(mm(He,Ke.x,Ze.x,at.x,mt.x),mm(He,Ke.y,Ze.y,at.y,mt.y)),de}copy(K){super.copy(K),this.points=[];for(let oe=0,de=K.points.length;oe<de;oe++){const ye=K.points[oe];this.points.push(ye.clone())}return this}toJSON(){const K=super.toJSON();K.points=[];for(let oe=0,de=this.points.length;oe<de;oe++){const ye=this.points[oe];K.points.push(ye.toArray())}return K}fromJSON(K){super.fromJSON(K),this.points=[];for(let oe=0,de=K.points.length;oe<de;oe++){const ye=K.points[oe];this.points.push(new qi().fromArray(ye))}return this}}var cA=Object.freeze({__proto__:null,ArcCurve:pm,CatmullRomCurve3:Am,CubicBezierCurve:i2,CubicBezierCurve3:gm,EllipseCurve:aA,LineCurve:r2,LineCurve3:vm,QuadraticBezierCurve:s2,QuadraticBezierCurve3:o2,SplineCurve:a2});class Em extends cu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(K){this.curves.push(K)}closePath(){const K=this.curves[0].getPoint(0),oe=this.curves[this.curves.length-1].getPoint(1);if(!K.equals(oe)){const de=K.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new cA[de](oe,K))}return this}getPoint(K,oe){const de=K*this.getLength(),ye=this.getCurveLengths();let Ie=0;for(;Ie<ye.length;){if(ye[Ie]>=de){const Ue=ye[Ie]-de,He=this.curves[Ie],Ke=He.getLength(),Ze=Ke===0?0:1-Ue/Ke;return He.getPointAt(Ze,oe)}Ie++}return null}getLength(){const K=this.getCurveLengths();return K[K.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const K=[];let oe=0;for(let de=0,ye=this.curves.length;de<ye;de++)oe+=this.curves[de].getLength(),K.push(oe);return this.cacheLengths=K,K}getSpacedPoints(K=40){const oe=[];for(let de=0;de<=K;de++)oe.push(this.getPoint(de/K));return this.autoClose&&oe.push(oe[0]),oe}getPoints(K=12){const oe=[];let de;for(let ye=0,Ie=this.curves;ye<Ie.length;ye++){const Ue=Ie[ye],He=Ue.isEllipseCurve?K*2:Ue.isLineCurve||Ue.isLineCurve3?1:Ue.isSplineCurve?K*Ue.points.length:K,Ke=Ue.getPoints(He);for(let Ze=0;Ze<Ke.length;Ze++){const at=Ke[Ze];de&&de.equals(at)||(oe.push(at),de=at)}}return this.autoClose&&oe.length>1&&!oe[oe.length-1].equals(oe[0])&&oe.push(oe[0]),oe}copy(K){super.copy(K),this.curves=[];for(let oe=0,de=K.curves.length;oe<de;oe++){const ye=K.curves[oe];this.curves.push(ye.clone())}return this.autoClose=K.autoClose,this}toJSON(){const K=super.toJSON();K.autoClose=this.autoClose,K.curves=[];for(let oe=0,de=this.curves.length;oe<de;oe++){const ye=this.curves[oe];K.curves.push(ye.toJSON())}return K}fromJSON(K){super.fromJSON(K),this.autoClose=K.autoClose,this.curves=[];for(let oe=0,de=K.curves.length;oe<de;oe++){const ye=K.curves[oe];this.curves.push(new cA[ye.type]().fromJSON(ye))}return this}}class Mp extends Em{constructor(K){super(),this.type="Path",this.currentPoint=new qi,K&&this.setFromPoints(K)}setFromPoints(K){this.moveTo(K[0].x,K[0].y);for(let oe=1,de=K.length;oe<de;oe++)this.lineTo(K[oe].x,K[oe].y);return this}moveTo(K,oe){return this.currentPoint.set(K,oe),this}lineTo(K,oe){const de=new r2(this.currentPoint.clone(),new qi(K,oe));return this.curves.push(de),this.currentPoint.set(K,oe),this}quadraticCurveTo(K,oe,de,ye){const Ie=new s2(this.currentPoint.clone(),new qi(K,oe),new qi(de,ye));return this.curves.push(Ie),this.currentPoint.set(de,ye),this}bezierCurveTo(K,oe,de,ye,Ie,Ue){const He=new i2(this.currentPoint.clone(),new qi(K,oe),new qi(de,ye),new qi(Ie,Ue));return this.curves.push(He),this.currentPoint.set(Ie,Ue),this}splineThru(K){const oe=[this.currentPoint.clone()].concat(K),de=new a2(oe);return this.curves.push(de),this.currentPoint.copy(K[K.length-1]),this}arc(K,oe,de,ye,Ie,Ue){const He=this.currentPoint.x,Ke=this.currentPoint.y;return this.absarc(K+He,oe+Ke,de,ye,Ie,Ue),this}absarc(K,oe,de,ye,Ie,Ue){return this.absellipse(K,oe,de,de,ye,Ie,Ue),this}ellipse(K,oe,de,ye,Ie,Ue,He,Ke){const Ze=this.currentPoint.x,at=this.currentPoint.y;return this.absellipse(K+Ze,oe+at,de,ye,Ie,Ue,He,Ke),this}absellipse(K,oe,de,ye,Ie,Ue,He,Ke){const Ze=new aA(K,oe,de,ye,Ie,Ue,He,Ke);if(this.curves.length>0){const mt=Ze.getPoint(0);mt.equals(this.currentPoint)||this.lineTo(mt.x,mt.y)}this.curves.push(Ze);const at=Ze.getPoint(1);return this.currentPoint.copy(at),this}copy(K){return super.copy(K),this.currentPoint.copy(K.currentPoint),this}toJSON(){const K=super.toJSON();return K.currentPoint=this.currentPoint.toArray(),K}fromJSON(K){return super.fromJSON(K),this.currentPoint.fromArray(K.currentPoint),this}}class bp extends Ds{constructor(K=[new qi(0,-.5),new qi(.5,0),new qi(0,.5)],oe=12,de=0,ye=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:K,segments:oe,phiStart:de,phiLength:ye},oe=Math.floor(oe),ye=qo(ye,0,Math.PI*2);const Ie=[],Ue=[],He=[],Ke=[],Ze=[],at=1/oe,mt=new vn,vt=new qi,St=new vn,Lt=new vn,Ht=new vn;let Dt=0,bt=0;for(let tn=0;tn<=K.length-1;tn++)switch(tn){case 0:Dt=K[tn+1].x-K[tn].x,bt=K[tn+1].y-K[tn].y,St.x=bt*1,St.y=-Dt,St.z=bt*0,Ht.copy(St),St.normalize(),Ke.push(St.x,St.y,St.z);break;case K.length-1:Ke.push(Ht.x,Ht.y,Ht.z);break;default:Dt=K[tn+1].x-K[tn].x,bt=K[tn+1].y-K[tn].y,St.x=bt*1,St.y=-Dt,St.z=bt*0,Lt.copy(St),St.x+=Ht.x,St.y+=Ht.y,St.z+=Ht.z,St.normalize(),Ke.push(St.x,St.y,St.z),Ht.copy(Lt)}for(let tn=0;tn<=oe;tn++){const Zt=de+tn*at*ye,qt=Math.sin(Zt),Un=Math.cos(Zt);for(let _n=0;_n<=K.length-1;_n++){mt.x=K[_n].x*qt,mt.y=K[_n].y,mt.z=K[_n].x*Un,Ue.push(mt.x,mt.y,mt.z),vt.x=tn/oe,vt.y=_n/(K.length-1),He.push(vt.x,vt.y);const bn=Ke[3*_n+0]*qt,Fn=Ke[3*_n+1],pn=Ke[3*_n+0]*Un;Ze.push(bn,Fn,pn)}}for(let tn=0;tn<oe;tn++)for(let Zt=0;Zt<K.length-1;Zt++){const qt=Zt+tn*K.length,Un=qt,_n=qt+K.length,bn=qt+K.length+1,Fn=qt+1;Ie.push(Un,_n,Fn),Ie.push(bn,Fn,_n)}this.setIndex(Ie),this.setAttribute("position",new $i(Ue,3)),this.setAttribute("uv",new $i(He,2)),this.setAttribute("normal",new $i(Ze,3))}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new bp(K.points,K.segments,K.phiStart,K.phiLength)}}class uA extends bp{constructor(K=1,oe=1,de=4,ye=8){const Ie=new Mp;Ie.absarc(0,-oe/2,K,Math.PI*1.5,0),Ie.absarc(0,oe/2,K,0,Math.PI*.5),super(Ie.getPoints(de),ye),this.type="CapsuleGeometry",this.parameters={radius:K,length:oe,capSegments:de,radialSegments:ye}}static fromJSON(K){return new uA(K.radius,K.length,K.capSegments,K.radialSegments)}}class hA extends Ds{constructor(K=1,oe=32,de=0,ye=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:K,segments:oe,thetaStart:de,thetaLength:ye},oe=Math.max(3,oe);const Ie=[],Ue=[],He=[],Ke=[],Ze=new vn,at=new qi;Ue.push(0,0,0),He.push(0,0,1),Ke.push(.5,.5);for(let mt=0,vt=3;mt<=oe;mt++,vt+=3){const St=de+mt/oe*ye;Ze.x=K*Math.cos(St),Ze.y=K*Math.sin(St),Ue.push(Ze.x,Ze.y,Ze.z),He.push(0,0,1),at.x=(Ue[vt]/K+1)/2,at.y=(Ue[vt+1]/K+1)/2,Ke.push(at.x,at.y)}for(let mt=1;mt<=oe;mt++)Ie.push(mt,mt+1,0);this.setIndex(Ie),this.setAttribute("position",new $i(Ue,3)),this.setAttribute("normal",new $i(He,3)),this.setAttribute("uv",new $i(Ke,2))}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new hA(K.radius,K.segments,K.thetaStart,K.thetaLength)}}class Yf extends Ds{constructor(K=1,oe=1,de=1,ye=32,Ie=1,Ue=!1,He=0,Ke=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:K,radiusBottom:oe,height:de,radialSegments:ye,heightSegments:Ie,openEnded:Ue,thetaStart:He,thetaLength:Ke};const Ze=this;ye=Math.floor(ye),Ie=Math.floor(Ie);const at=[],mt=[],vt=[],St=[];let Lt=0;const Ht=[],Dt=de/2;let bt=0;tn(),Ue===!1&&(K>0&&Zt(!0),oe>0&&Zt(!1)),this.setIndex(at),this.setAttribute("position",new $i(mt,3)),this.setAttribute("normal",new $i(vt,3)),this.setAttribute("uv",new $i(St,2));function tn(){const qt=new vn,Un=new vn;let _n=0;const bn=(oe-K)/de;for(let Fn=0;Fn<=Ie;Fn++){const pn=[],cn=Fn/Ie,On=cn*(oe-K)+K;for(let Zn=0;Zn<=ye;Zn++){const Xn=Zn/ye,ri=Xn*Ke+He,wi=Math.sin(ri),Ji=Math.cos(ri);Un.x=On*wi,Un.y=-cn*de+Dt,Un.z=On*Ji,mt.push(Un.x,Un.y,Un.z),qt.set(wi,bn,Ji).normalize(),vt.push(qt.x,qt.y,qt.z),St.push(Xn,1-cn),pn.push(Lt++)}Ht.push(pn)}for(let Fn=0;Fn<ye;Fn++)for(let pn=0;pn<Ie;pn++){const cn=Ht[pn][Fn],On=Ht[pn+1][Fn],Zn=Ht[pn+1][Fn+1],Xn=Ht[pn][Fn+1];at.push(cn,On,Xn),at.push(On,Zn,Xn),_n+=6}Ze.addGroup(bt,_n,0),bt+=_n}function Zt(qt){const Un=Lt,_n=new qi,bn=new vn;let Fn=0;const pn=qt===!0?K:oe,cn=qt===!0?1:-1;for(let Zn=1;Zn<=ye;Zn++)mt.push(0,Dt*cn,0),vt.push(0,cn,0),St.push(.5,.5),Lt++;const On=Lt;for(let Zn=0;Zn<=ye;Zn++){const ri=Zn/ye*Ke+He,wi=Math.cos(ri),Ji=Math.sin(ri);bn.x=pn*Ji,bn.y=Dt*cn,bn.z=pn*wi,mt.push(bn.x,bn.y,bn.z),vt.push(0,cn,0),_n.x=wi*.5+.5,_n.y=Ji*.5*cn+.5,St.push(_n.x,_n.y),Lt++}for(let Zn=0;Zn<ye;Zn++){const Xn=Un+Zn,ri=On+Zn;qt===!0?at.push(ri,ri+1,Xn):at.push(ri+1,ri,Xn),Fn+=3}Ze.addGroup(bt,Fn,qt===!0?1:2),bt+=Fn}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new Yf(K.radiusTop,K.radiusBottom,K.height,K.radialSegments,K.heightSegments,K.openEnded,K.thetaStart,K.thetaLength)}}class dA extends Yf{constructor(K=1,oe=1,de=32,ye=1,Ie=!1,Ue=0,He=Math.PI*2){super(0,K,oe,de,ye,Ie,Ue,He),this.type="ConeGeometry",this.parameters={radius:K,height:oe,radialSegments:de,heightSegments:ye,openEnded:Ie,thetaStart:Ue,thetaLength:He}}static fromJSON(K){return new dA(K.radius,K.height,K.radialSegments,K.heightSegments,K.openEnded,K.thetaStart,K.thetaLength)}}class pd extends Ds{constructor(K=[],oe=[],de=1,ye=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:K,indices:oe,radius:de,detail:ye};const Ie=[],Ue=[];He(ye),Ze(de),at(),this.setAttribute("position",new $i(Ie,3)),this.setAttribute("normal",new $i(Ie.slice(),3)),this.setAttribute("uv",new $i(Ue,2)),ye===0?this.computeVertexNormals():this.normalizeNormals();function He(tn){const Zt=new vn,qt=new vn,Un=new vn;for(let _n=0;_n<oe.length;_n+=3)St(oe[_n+0],Zt),St(oe[_n+1],qt),St(oe[_n+2],Un),Ke(Zt,qt,Un,tn)}function Ke(tn,Zt,qt,Un){const _n=Un+1,bn=[];for(let Fn=0;Fn<=_n;Fn++){bn[Fn]=[];const pn=tn.clone().lerp(qt,Fn/_n),cn=Zt.clone().lerp(qt,Fn/_n),On=_n-Fn;for(let Zn=0;Zn<=On;Zn++)Zn===0&&Fn===_n?bn[Fn][Zn]=pn:bn[Fn][Zn]=pn.clone().lerp(cn,Zn/On)}for(let Fn=0;Fn<_n;Fn++)for(let pn=0;pn<2*(_n-Fn)-1;pn++){const cn=Math.floor(pn/2);pn%2===0?(vt(bn[Fn][cn+1]),vt(bn[Fn+1][cn]),vt(bn[Fn][cn])):(vt(bn[Fn][cn+1]),vt(bn[Fn+1][cn+1]),vt(bn[Fn+1][cn]))}}function Ze(tn){const Zt=new vn;for(let qt=0;qt<Ie.length;qt+=3)Zt.x=Ie[qt+0],Zt.y=Ie[qt+1],Zt.z=Ie[qt+2],Zt.normalize().multiplyScalar(tn),Ie[qt+0]=Zt.x,Ie[qt+1]=Zt.y,Ie[qt+2]=Zt.z}function at(){const tn=new vn;for(let Zt=0;Zt<Ie.length;Zt+=3){tn.x=Ie[Zt+0],tn.y=Ie[Zt+1],tn.z=Ie[Zt+2];const qt=Dt(tn)/2/Math.PI+.5,Un=bt(tn)/Math.PI+.5;Ue.push(qt,1-Un)}Lt(),mt()}function mt(){for(let tn=0;tn<Ue.length;tn+=6){const Zt=Ue[tn+0],qt=Ue[tn+2],Un=Ue[tn+4],_n=Math.max(Zt,qt,Un),bn=Math.min(Zt,qt,Un);_n>.9&&bn<.1&&(Zt<.2&&(Ue[tn+0]+=1),qt<.2&&(Ue[tn+2]+=1),Un<.2&&(Ue[tn+4]+=1))}}function vt(tn){Ie.push(tn.x,tn.y,tn.z)}function St(tn,Zt){const qt=tn*3;Zt.x=K[qt+0],Zt.y=K[qt+1],Zt.z=K[qt+2]}function Lt(){const tn=new vn,Zt=new vn,qt=new vn,Un=new vn,_n=new qi,bn=new qi,Fn=new qi;for(let pn=0,cn=0;pn<Ie.length;pn+=9,cn+=6){tn.set(Ie[pn+0],Ie[pn+1],Ie[pn+2]),Zt.set(Ie[pn+3],Ie[pn+4],Ie[pn+5]),qt.set(Ie[pn+6],Ie[pn+7],Ie[pn+8]),_n.set(Ue[cn+0],Ue[cn+1]),bn.set(Ue[cn+2],Ue[cn+3]),Fn.set(Ue[cn+4],Ue[cn+5]),Un.copy(tn).add(Zt).add(qt).divideScalar(3);const On=Dt(Un);Ht(_n,cn+0,tn,On),Ht(bn,cn+2,Zt,On),Ht(Fn,cn+4,qt,On)}}function Ht(tn,Zt,qt,Un){Un<0&&tn.x===1&&(Ue[Zt]=tn.x-1),qt.x===0&&qt.z===0&&(Ue[Zt]=Un/2/Math.PI+.5)}function Dt(tn){return Math.atan2(tn.z,-tn.x)}function bt(tn){return Math.atan2(-tn.y,Math.sqrt(tn.x*tn.x+tn.z*tn.z))}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new pd(K.vertices,K.indices,K.radius,K.details)}}class fA extends pd{constructor(K=1,oe=0){const de=(1+Math.sqrt(5))/2,ye=1/de,Ie=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-ye,-de,0,-ye,de,0,ye,-de,0,ye,de,-ye,-de,0,-ye,de,0,ye,-de,0,ye,de,0,-de,0,-ye,de,0,-ye,-de,0,ye,de,0,ye],Ue=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(Ie,Ue,K,oe),this.type="DodecahedronGeometry",this.parameters={radius:K,detail:oe}}static fromJSON(K){return new fA(K.radius,K.detail)}}const pA=new vn,AA=new vn,l2=new vn,mA=new Fa;class ym extends Ds{constructor(K=null,oe=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:K,thresholdAngle:oe},K!==null){const ye=Math.pow(10,4),Ie=Math.cos(Ll*oe),Ue=K.getIndex(),He=K.getAttribute("position"),Ke=Ue?Ue.count:He.count,Ze=[0,0,0],at=["a","b","c"],mt=new Array(3),vt={},St=[];for(let Lt=0;Lt<Ke;Lt+=3){Ue?(Ze[0]=Ue.getX(Lt),Ze[1]=Ue.getX(Lt+1),Ze[2]=Ue.getX(Lt+2)):(Ze[0]=Lt,Ze[1]=Lt+1,Ze[2]=Lt+2);const{a:Ht,b:Dt,c:bt}=mA;if(Ht.fromBufferAttribute(He,Ze[0]),Dt.fromBufferAttribute(He,Ze[1]),bt.fromBufferAttribute(He,Ze[2]),mA.getNormal(l2),mt[0]=`${Math.round(Ht.x*ye)},${Math.round(Ht.y*ye)},${Math.round(Ht.z*ye)}`,mt[1]=`${Math.round(Dt.x*ye)},${Math.round(Dt.y*ye)},${Math.round(Dt.z*ye)}`,mt[2]=`${Math.round(bt.x*ye)},${Math.round(bt.y*ye)},${Math.round(bt.z*ye)}`,!(mt[0]===mt[1]||mt[1]===mt[2]||mt[2]===mt[0]))for(let tn=0;tn<3;tn++){const Zt=(tn+1)%3,qt=mt[tn],Un=mt[Zt],_n=mA[at[tn]],bn=mA[at[Zt]],Fn=`${qt}_${Un}`,pn=`${Un}_${qt}`;pn in vt&&vt[pn]?(l2.dot(vt[pn].normal)<=Ie&&(St.push(_n.x,_n.y,_n.z),St.push(bn.x,bn.y,bn.z)),vt[pn]=null):Fn in vt||(vt[Fn]={index0:Ze[tn],index1:Ze[Zt],normal:l2.clone()})}}for(const Lt in vt)if(vt[Lt]){const{index0:Ht,index1:Dt}=vt[Lt];pA.fromBufferAttribute(He,Ht),AA.fromBufferAttribute(He,Dt),St.push(pA.x,pA.y,pA.z),St.push(AA.x,AA.y,AA.z)}this.setAttribute("position",new $i(St,3))}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}}class T1 extends Mp{constructor(K){super(K),this.uuid=c0(),this.type="Shape",this.holes=[]}getPointsHoles(K){const oe=[];for(let de=0,ye=this.holes.length;de<ye;de++)oe[de]=this.holes[de].getPoints(K);return oe}extractPoints(K){return{shape:this.getPoints(K),holes:this.getPointsHoles(K)}}copy(K){super.copy(K),this.holes=[];for(let oe=0,de=K.holes.length;oe<de;oe++){const ye=K.holes[oe];this.holes.push(ye.clone())}return this}toJSON(){const K=super.toJSON();K.uuid=this.uuid,K.holes=[];for(let oe=0,de=this.holes.length;oe<de;oe++){const ye=this.holes[oe];K.holes.push(ye.toJSON())}return K}fromJSON(K){super.fromJSON(K),this.uuid=K.uuid,this.holes=[];for(let oe=0,de=K.holes.length;oe<de;oe++){const ye=K.holes[oe];this.holes.push(new Mp().fromJSON(ye))}return this}}const M3={triangulate:function(Be,K,oe=2){const de=K&&K.length,ye=de?K[0]*oe:Be.length;let Ie=Cm(Be,0,ye,oe,!0);const Ue=[];if(!Ie||Ie.next===Ie.prev)return Ue;let He,Ke,Ze,at,mt,vt,St;if(de&&(Ie=B3(Be,K,Ie,oe)),Be.length>80*oe){He=Ze=Be[0],Ke=at=Be[1];for(let Lt=oe;Lt<ye;Lt+=oe)mt=Be[Lt],vt=Be[Lt+1],mt<He&&(He=mt),vt<Ke&&(Ke=vt),mt>Ze&&(Ze=mt),vt>at&&(at=vt);St=Math.max(Ze-He,at-Ke),St=St!==0?32767/St:0}return Tp(Ie,Ue,oe,He,Ke,St,0),Ue}};function Cm(Be,K,oe,de,ye){let Ie,Ue;if(ye===H3(Be,K,oe,de)>0)for(Ie=K;Ie<oe;Ie+=de)Ue=Sm(Ie,Be[Ie],Be[Ie+1],Ue);else for(Ie=oe-de;Ie>=K;Ie-=de)Ue=Sm(Ie,Be[Ie],Be[Ie+1],Ue);return Ue&&gA(Ue,Ue.next)&&(Rp(Ue),Ue=Ue.next),Ue}function I1(Be,K){if(!Be)return Be;K||(K=Be);let oe=Be,de;do if(de=!1,!oe.steiner&&(gA(oe,oe.next)||Qa(oe.prev,oe,oe.next)===0)){if(Rp(oe),oe=K=oe.prev,oe===oe.next)break;de=!0}else oe=oe.next;while(de||oe!==K);return K}function Tp(Be,K,oe,de,ye,Ie,Ue){if(!Be)return;!Ue&&Ie&&O3(Be,de,ye,Ie);let He=Be,Ke,Ze;for(;Be.prev!==Be.next;){if(Ke=Be.prev,Ze=Be.next,Ie?T3(Be,de,ye,Ie):b3(Be)){K.push(Ke.i/oe|0),K.push(Be.i/oe|0),K.push(Ze.i/oe|0),Rp(Be),Be=Ze.next,He=Ze.next;continue}if(Be=Ze,Be===He){Ue?Ue===1?(Be=I3(I1(Be),K,oe),Tp(Be,K,oe,de,ye,Ie,2)):Ue===2&&R3(Be,K,oe,de,ye,Ie):Tp(I1(Be),K,oe,de,ye,Ie,1);break}}}function b3(Be){const K=Be.prev,oe=Be,de=Be.next;if(Qa(K,oe,de)>=0)return!1;const ye=K.x,Ie=oe.x,Ue=de.x,He=K.y,Ke=oe.y,Ze=de.y,at=ye<Ie?ye<Ue?ye:Ue:Ie<Ue?Ie:Ue,mt=He<Ke?He<Ze?He:Ze:Ke<Ze?Ke:Ze,vt=ye>Ie?ye>Ue?ye:Ue:Ie>Ue?Ie:Ue,St=He>Ke?He>Ze?He:Ze:Ke>Ze?Ke:Ze;let Lt=de.next;for(;Lt!==K;){if(Lt.x>=at&&Lt.x<=vt&&Lt.y>=mt&&Lt.y<=St&&qf(ye,He,Ie,Ke,Ue,Ze,Lt.x,Lt.y)&&Qa(Lt.prev,Lt,Lt.next)>=0)return!1;Lt=Lt.next}return!0}function T3(Be,K,oe,de){const ye=Be.prev,Ie=Be,Ue=Be.next;if(Qa(ye,Ie,Ue)>=0)return!1;const He=ye.x,Ke=Ie.x,Ze=Ue.x,at=ye.y,mt=Ie.y,vt=Ue.y,St=He<Ke?He<Ze?He:Ze:Ke<Ze?Ke:Ze,Lt=at<mt?at<vt?at:vt:mt<vt?mt:vt,Ht=He>Ke?He>Ze?He:Ze:Ke>Ze?Ke:Ze,Dt=at>mt?at>vt?at:vt:mt>vt?mt:vt,bt=c2(St,Lt,K,oe,de),tn=c2(Ht,Dt,K,oe,de);let Zt=Be.prevZ,qt=Be.nextZ;for(;Zt&&Zt.z>=bt&&qt&&qt.z<=tn;){if(Zt.x>=St&&Zt.x<=Ht&&Zt.y>=Lt&&Zt.y<=Dt&&Zt!==ye&&Zt!==Ue&&qf(He,at,Ke,mt,Ze,vt,Zt.x,Zt.y)&&Qa(Zt.prev,Zt,Zt.next)>=0||(Zt=Zt.prevZ,qt.x>=St&&qt.x<=Ht&&qt.y>=Lt&&qt.y<=Dt&&qt!==ye&&qt!==Ue&&qf(He,at,Ke,mt,Ze,vt,qt.x,qt.y)&&Qa(qt.prev,qt,qt.next)>=0))return!1;qt=qt.nextZ}for(;Zt&&Zt.z>=bt;){if(Zt.x>=St&&Zt.x<=Ht&&Zt.y>=Lt&&Zt.y<=Dt&&Zt!==ye&&Zt!==Ue&&qf(He,at,Ke,mt,Ze,vt,Zt.x,Zt.y)&&Qa(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.prevZ}for(;qt&&qt.z<=tn;){if(qt.x>=St&&qt.x<=Ht&&qt.y>=Lt&&qt.y<=Dt&&qt!==ye&&qt!==Ue&&qf(He,at,Ke,mt,Ze,vt,qt.x,qt.y)&&Qa(qt.prev,qt,qt.next)>=0)return!1;qt=qt.nextZ}return!0}function I3(Be,K,oe){let de=Be;do{const ye=de.prev,Ie=de.next.next;!gA(ye,Ie)&&xm(ye,de,de.next,Ie)&&Ip(ye,Ie)&&Ip(Ie,ye)&&(K.push(ye.i/oe|0),K.push(de.i/oe|0),K.push(Ie.i/oe|0),Rp(de),Rp(de.next),de=Be=Ie),de=de.next}while(de!==Be);return I1(de)}function R3(Be,K,oe,de,ye,Ie){let Ue=Be;do{let He=Ue.next.next;for(;He!==Ue.prev;){if(Ue.i!==He.i&&k3(Ue,He)){let Ke=wm(Ue,He);Ue=I1(Ue,Ue.next),Ke=I1(Ke,Ke.next),Tp(Ue,K,oe,de,ye,Ie,0),Tp(Ke,K,oe,de,ye,Ie,0);return}He=He.next}Ue=Ue.next}while(Ue!==Be)}function B3(Be,K,oe,de){const ye=[];let Ie,Ue,He,Ke,Ze;for(Ie=0,Ue=K.length;Ie<Ue;Ie++)He=K[Ie]*de,Ke=Ie<Ue-1?K[Ie+1]*de:Be.length,Ze=Cm(Be,He,Ke,de,!1),Ze===Ze.next&&(Ze.steiner=!0),ye.push(U3(Ze));for(ye.sort(L3),Ie=0;Ie<ye.length;Ie++)oe=D3(ye[Ie],oe);return oe}function L3(Be,K){return Be.x-K.x}function D3(Be,K){const oe=P3(Be,K);if(!oe)return K;const de=wm(oe,Be);return I1(de,de.next),I1(oe,oe.next)}function P3(Be,K){let oe=K,de=-1/0,ye;const Ie=Be.x,Ue=Be.y;do{if(Ue<=oe.y&&Ue>=oe.next.y&&oe.next.y!==oe.y){const vt=oe.x+(Ue-oe.y)*(oe.next.x-oe.x)/(oe.next.y-oe.y);if(vt<=Ie&&vt>de&&(de=vt,ye=oe.x<oe.next.x?oe:oe.next,vt===Ie))return ye}oe=oe.next}while(oe!==K);if(!ye)return null;const He=ye,Ke=ye.x,Ze=ye.y;let at=1/0,mt;oe=ye;do Ie>=oe.x&&oe.x>=Ke&&Ie!==oe.x&&qf(Ue<Ze?Ie:de,Ue,Ke,Ze,Ue<Ze?de:Ie,Ue,oe.x,oe.y)&&(mt=Math.abs(Ue-oe.y)/(Ie-oe.x),Ip(oe,Be)&&(mt<at||mt===at&&(oe.x>ye.x||oe.x===ye.x&&F3(ye,oe)))&&(ye=oe,at=mt)),oe=oe.next;while(oe!==He);return ye}function F3(Be,K){return Qa(Be.prev,Be,K.prev)<0&&Qa(K.next,Be,Be.next)<0}function O3(Be,K,oe,de){let ye=Be;do ye.z===0&&(ye.z=c2(ye.x,ye.y,K,oe,de)),ye.prevZ=ye.prev,ye.nextZ=ye.next,ye=ye.next;while(ye!==Be);ye.prevZ.nextZ=null,ye.prevZ=null,N3(ye)}function N3(Be){let K,oe,de,ye,Ie,Ue,He,Ke,Ze=1;do{for(oe=Be,Be=null,Ie=null,Ue=0;oe;){for(Ue++,de=oe,He=0,K=0;K<Ze&&(He++,de=de.nextZ,!!de);K++);for(Ke=Ze;He>0||Ke>0&&de;)He!==0&&(Ke===0||!de||oe.z<=de.z)?(ye=oe,oe=oe.nextZ,He--):(ye=de,de=de.nextZ,Ke--),Ie?Ie.nextZ=ye:Be=ye,ye.prevZ=Ie,Ie=ye;oe=de}Ie.nextZ=null,Ze*=2}while(Ue>1);return Be}function c2(Be,K,oe,de,ye){return Be=(Be-oe)*ye|0,K=(K-de)*ye|0,Be=(Be|Be<<8)&16711935,Be=(Be|Be<<4)&252645135,Be=(Be|Be<<2)&858993459,Be=(Be|Be<<1)&1431655765,K=(K|K<<8)&16711935,K=(K|K<<4)&252645135,K=(K|K<<2)&858993459,K=(K|K<<1)&1431655765,Be|K<<1}function U3(Be){let K=Be,oe=Be;do(K.x<oe.x||K.x===oe.x&&K.y<oe.y)&&(oe=K),K=K.next;while(K!==Be);return oe}function qf(Be,K,oe,de,ye,Ie,Ue,He){return(ye-Ue)*(K-He)>=(Be-Ue)*(Ie-He)&&(Be-Ue)*(de-He)>=(oe-Ue)*(K-He)&&(oe-Ue)*(Ie-He)>=(ye-Ue)*(de-He)}function k3(Be,K){return Be.next.i!==K.i&&Be.prev.i!==K.i&&!G3(Be,K)&&(Ip(Be,K)&&Ip(K,Be)&&Q3(Be,K)&&(Qa(Be.prev,Be,K.prev)||Qa(Be,K.prev,K))||gA(Be,K)&&Qa(Be.prev,Be,Be.next)>0&&Qa(K.prev,K,K.next)>0)}function Qa(Be,K,oe){return(K.y-Be.y)*(oe.x-K.x)-(K.x-Be.x)*(oe.y-K.y)}function gA(Be,K){return Be.x===K.x&&Be.y===K.y}function xm(Be,K,oe,de){const ye=EA(Qa(Be,K,oe)),Ie=EA(Qa(Be,K,de)),Ue=EA(Qa(oe,de,Be)),He=EA(Qa(oe,de,K));return!!(ye!==Ie&&Ue!==He||ye===0&&vA(Be,oe,K)||Ie===0&&vA(Be,de,K)||Ue===0&&vA(oe,Be,de)||He===0&&vA(oe,K,de))}function vA(Be,K,oe){return K.x<=Math.max(Be.x,oe.x)&&K.x>=Math.min(Be.x,oe.x)&&K.y<=Math.max(Be.y,oe.y)&&K.y>=Math.min(Be.y,oe.y)}function EA(Be){return Be>0?1:Be<0?-1:0}function G3(Be,K){let oe=Be;do{if(oe.i!==Be.i&&oe.next.i!==Be.i&&oe.i!==K.i&&oe.next.i!==K.i&&xm(oe,oe.next,Be,K))return!0;oe=oe.next}while(oe!==Be);return!1}function Ip(Be,K){return Qa(Be.prev,Be,Be.next)<0?Qa(Be,K,Be.next)>=0&&Qa(Be,Be.prev,K)>=0:Qa(Be,K,Be.prev)<0||Qa(Be,Be.next,K)<0}function Q3(Be,K){let oe=Be,de=!1;const ye=(Be.x+K.x)/2,Ie=(Be.y+K.y)/2;do oe.y>Ie!=oe.next.y>Ie&&oe.next.y!==oe.y&&ye<(oe.next.x-oe.x)*(Ie-oe.y)/(oe.next.y-oe.y)+oe.x&&(de=!de),oe=oe.next;while(oe!==Be);return de}function wm(Be,K){const oe=new u2(Be.i,Be.x,Be.y),de=new u2(K.i,K.x,K.y),ye=Be.next,Ie=K.prev;return Be.next=K,K.prev=Be,oe.next=ye,ye.prev=oe,de.next=oe,oe.prev=de,Ie.next=de,de.prev=Ie,de}function Sm(Be,K,oe,de){const ye=new u2(Be,K,oe);return de?(ye.next=de.next,ye.prev=de,de.next.prev=ye,de.next=ye):(ye.prev=ye,ye.next=ye),ye}function Rp(Be){Be.next.prev=Be.prev,Be.prev.next=Be.next,Be.prevZ&&(Be.prevZ.nextZ=Be.nextZ),Be.nextZ&&(Be.nextZ.prevZ=Be.prevZ)}function u2(Be,K,oe){this.i=Be,this.x=K,this.y=oe,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function H3(Be,K,oe,de){let ye=0;for(let Ie=K,Ue=oe-de;Ie<oe;Ie+=de)ye+=(Be[Ue]-Be[Ie])*(Be[Ie+1]+Be[Ue+1]),Ue=Ie;return ye}class Ou{static area(K){const oe=K.length;let de=0;for(let ye=oe-1,Ie=0;Ie<oe;ye=Ie++)de+=K[ye].x*K[Ie].y-K[Ie].x*K[ye].y;return de*.5}static isClockWise(K){return Ou.area(K)<0}static triangulateShape(K,oe){const de=[],ye=[],Ie=[];Mm(K),bm(de,K);let Ue=K.length;oe.forEach(Mm);for(let Ke=0;Ke<oe.length;Ke++)ye.push(Ue),Ue+=oe[Ke].length,bm(de,oe[Ke]);const He=M3.triangulate(de,ye);for(let Ke=0;Ke<He.length;Ke+=3)Ie.push(He.slice(Ke,Ke+3));return Ie}}function Mm(Be){const K=Be.length;K>2&&Be[K-1].equals(Be[0])&&Be.pop()}function bm(Be,K){for(let oe=0;oe<K.length;oe++)Be.push(K[oe].x),Be.push(K[oe].y)}class _A extends Ds{constructor(K=new T1([new qi(.5,.5),new qi(-.5,.5),new qi(-.5,-.5),new qi(.5,-.5)]),oe={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:K,options:oe},K=Array.isArray(K)?K:[K];const de=this,ye=[],Ie=[];for(let He=0,Ke=K.length;He<Ke;He++){const Ze=K[He];Ue(Ze)}this.setAttribute("position",new $i(ye,3)),this.setAttribute("uv",new $i(Ie,2)),this.computeVertexNormals();function Ue(He){const Ke=[],Ze=oe.curveSegments!==void 0?oe.curveSegments:12,at=oe.steps!==void 0?oe.steps:1,mt=oe.depth!==void 0?oe.depth:1;let vt=oe.bevelEnabled!==void 0?oe.bevelEnabled:!0,St=oe.bevelThickness!==void 0?oe.bevelThickness:.2,Lt=oe.bevelSize!==void 0?oe.bevelSize:St-.1,Ht=oe.bevelOffset!==void 0?oe.bevelOffset:0,Dt=oe.bevelSegments!==void 0?oe.bevelSegments:3;const bt=oe.extrudePath,tn=oe.UVGenerator!==void 0?oe.UVGenerator:V3;let Zt,qt=!1,Un,_n,bn,Fn;bt&&(Zt=bt.getSpacedPoints(at),qt=!0,vt=!1,Un=bt.computeFrenetFrames(at,!1),_n=new vn,bn=new vn,Fn=new vn),vt||(Dt=0,St=0,Lt=0,Ht=0);const pn=He.extractPoints(Ze);let cn=pn.shape;const On=pn.holes;if(!Ou.isClockWise(cn)){cn=cn.reverse();for(let or=0,Vi=On.length;or<Vi;or++){const _r=On[or];Ou.isClockWise(_r)&&(On[or]=_r.reverse())}}const Xn=Ou.triangulateShape(cn,On),ri=cn;for(let or=0,Vi=On.length;or<Vi;or++){const _r=On[or];cn=cn.concat(_r)}function wi(or,Vi,_r){return Vi||console.error("THREE.ExtrudeGeometry: vec does not exist"),or.clone().addScaledVector(Vi,_r)}const Ji=cn.length,Dr=Xn.length;function Ri(or,Vi,_r){let vr,mr,$r;const rs=or.x-Vi.x,Vs=or.y-Vi.y,Js=_r.x-or.x,Uo=_r.y-or.y,Ha=rs*rs+Vs*Vs,da=rs*Uo-Vs*Js;if(Math.abs(da)>Number.EPSILON){const Ln=Math.sqrt(Ha),un=Math.sqrt(Js*Js+Uo*Uo),Ni=Vi.x-Vs/Ln,nr=Vi.y+rs/Ln,hr=_r.x-Uo/un,lr=_r.y+Js/un,Es=((hr-Ni)*Uo-(lr-nr)*Js)/(rs*Uo-Vs*Js);vr=Ni+rs*Es-or.x,mr=nr+Vs*Es-or.y;const Pr=vr*vr+mr*mr;if(Pr<=2)return new qi(vr,mr);$r=Math.sqrt(Pr/2)}else{let Ln=!1;rs>Number.EPSILON?Js>Number.EPSILON&&(Ln=!0):rs<-Number.EPSILON?Js<-Number.EPSILON&&(Ln=!0):Math.sign(Vs)===Math.sign(Uo)&&(Ln=!0),Ln?(vr=-Vs,mr=rs,$r=Math.sqrt(Ha)):(vr=rs,mr=Vs,$r=Math.sqrt(Ha/2))}return new qi(vr/$r,mr/$r)}const xr=[];for(let or=0,Vi=ri.length,_r=Vi-1,vr=or+1;or<Vi;or++,_r++,vr++)_r===Vi&&(_r=0),vr===Vi&&(vr=0),xr[or]=Ri(ri[or],ri[_r],ri[vr]);const br=[];let us,oo=xr.concat();for(let or=0,Vi=On.length;or<Vi;or++){const _r=On[or];us=[];for(let vr=0,mr=_r.length,$r=mr-1,rs=vr+1;vr<mr;vr++,$r++,rs++)$r===mr&&($r=0),rs===mr&&(rs=0),us[vr]=Ri(_r[vr],_r[$r],_r[rs]);br.push(us),oo=oo.concat(us)}for(let or=0;or<Dt;or++){const Vi=or/Dt,_r=St*Math.cos(Vi*Math.PI/2),vr=Lt*Math.sin(Vi*Math.PI/2)+Ht;for(let mr=0,$r=ri.length;mr<$r;mr++){const rs=wi(ri[mr],xr[mr],vr);ps(rs.x,rs.y,-_r)}for(let mr=0,$r=On.length;mr<$r;mr++){const rs=On[mr];us=br[mr];for(let Vs=0,Js=rs.length;Vs<Js;Vs++){const Uo=wi(rs[Vs],us[Vs],vr);ps(Uo.x,Uo.y,-_r)}}}const Qo=Lt+Ht;for(let or=0;or<Ji;or++){const Vi=vt?wi(cn[or],oo[or],Qo):cn[or];qt?(bn.copy(Un.normals[0]).multiplyScalar(Vi.x),_n.copy(Un.binormals[0]).multiplyScalar(Vi.y),Fn.copy(Zt[0]).add(bn).add(_n),ps(Fn.x,Fn.y,Fn.z)):ps(Vi.x,Vi.y,0)}for(let or=1;or<=at;or++)for(let Vi=0;Vi<Ji;Vi++){const _r=vt?wi(cn[Vi],oo[Vi],Qo):cn[Vi];qt?(bn.copy(Un.normals[or]).multiplyScalar(_r.x),_n.copy(Un.binormals[or]).multiplyScalar(_r.y),Fn.copy(Zt[or]).add(bn).add(_n),ps(Fn.x,Fn.y,Fn.z)):ps(_r.x,_r.y,mt/at*or)}for(let or=Dt-1;or>=0;or--){const Vi=or/Dt,_r=St*Math.cos(Vi*Math.PI/2),vr=Lt*Math.sin(Vi*Math.PI/2)+Ht;for(let mr=0,$r=ri.length;mr<$r;mr++){const rs=wi(ri[mr],xr[mr],vr);ps(rs.x,rs.y,mt+_r)}for(let mr=0,$r=On.length;mr<$r;mr++){const rs=On[mr];us=br[mr];for(let Vs=0,Js=rs.length;Vs<Js;Vs++){const Uo=wi(rs[Vs],us[Vs],vr);qt?ps(Uo.x,Uo.y+Zt[at-1].y,Zt[at-1].x+_r):ps(Uo.x,Uo.y,mt+_r)}}}ha(),No();function ha(){const or=ye.length/3;if(vt){let Vi=0,_r=Ji*Vi;for(let vr=0;vr<Dr;vr++){const mr=Xn[vr];sr(mr[2]+_r,mr[1]+_r,mr[0]+_r)}Vi=at+Dt*2,_r=Ji*Vi;for(let vr=0;vr<Dr;vr++){const mr=Xn[vr];sr(mr[0]+_r,mr[1]+_r,mr[2]+_r)}}else{for(let Vi=0;Vi<Dr;Vi++){const _r=Xn[Vi];sr(_r[2],_r[1],_r[0])}for(let Vi=0;Vi<Dr;Vi++){const _r=Xn[Vi];sr(_r[0]+Ji*at,_r[1]+Ji*at,_r[2]+Ji*at)}}de.addGroup(or,ye.length/3-or,0)}function No(){const or=ye.length/3;let Vi=0;ea(ri,Vi),Vi+=ri.length;for(let _r=0,vr=On.length;_r<vr;_r++){const mr=On[_r];ea(mr,Vi),Vi+=mr.length}de.addGroup(or,ye.length/3-or,1)}function ea(or,Vi){let _r=or.length;for(;--_r>=0;){const vr=_r;let mr=_r-1;mr<0&&(mr=or.length-1);for(let $r=0,rs=at+Dt*2;$r<rs;$r++){const Vs=Ji*$r,Js=Ji*($r+1),Uo=Vi+vr+Vs,Ha=Vi+mr+Vs,da=Vi+mr+Js,Ln=Vi+vr+Js;Fr(Uo,Ha,da,Ln)}}}function ps(or,Vi,_r){Ke.push(or),Ke.push(Vi),Ke.push(_r)}function sr(or,Vi,_r){Qr(or),Qr(Vi),Qr(_r);const vr=ye.length/3,mr=tn.generateTopUV(de,ye,vr-3,vr-2,vr-1);si(mr[0]),si(mr[1]),si(mr[2])}function Fr(or,Vi,_r,vr){Qr(or),Qr(Vi),Qr(vr),Qr(Vi),Qr(_r),Qr(vr);const mr=ye.length/3,$r=tn.generateSideWallUV(de,ye,mr-6,mr-3,mr-2,mr-1);si($r[0]),si($r[1]),si($r[3]),si($r[1]),si($r[2]),si($r[3])}function Qr(or){ye.push(Ke[or*3+0]),ye.push(Ke[or*3+1]),ye.push(Ke[or*3+2])}function si(or){Ie.push(or.x),Ie.push(or.y)}}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}toJSON(){const K=super.toJSON(),oe=this.parameters.shapes,de=this.parameters.options;return z3(oe,de,K)}static fromJSON(K,oe){const de=[];for(let Ie=0,Ue=K.shapes.length;Ie<Ue;Ie++){const He=oe[K.shapes[Ie]];de.push(He)}const ye=K.options.extrudePath;return ye!==void 0&&(K.options.extrudePath=new cA[ye.type]().fromJSON(ye)),new _A(de,K.options)}}const V3={generateTopUV:function(Be,K,oe,de,ye){const Ie=K[oe*3],Ue=K[oe*3+1],He=K[de*3],Ke=K[de*3+1],Ze=K[ye*3],at=K[ye*3+1];return[new qi(Ie,Ue),new qi(He,Ke),new qi(Ze,at)]},generateSideWallUV:function(Be,K,oe,de,ye,Ie){const Ue=K[oe*3],He=K[oe*3+1],Ke=K[oe*3+2],Ze=K[de*3],at=K[de*3+1],mt=K[de*3+2],vt=K[ye*3],St=K[ye*3+1],Lt=K[ye*3+2],Ht=K[Ie*3],Dt=K[Ie*3+1],bt=K[Ie*3+2];return Math.abs(He-at)<Math.abs(Ue-Ze)?[new qi(Ue,1-Ke),new qi(Ze,1-mt),new qi(vt,1-Lt),new qi(Ht,1-bt)]:[new qi(He,1-Ke),new qi(at,1-mt),new qi(St,1-Lt),new qi(Dt,1-bt)]}};function z3(Be,K,oe){if(oe.shapes=[],Array.isArray(Be))for(let de=0,ye=Be.length;de<ye;de++){const Ie=Be[de];oe.shapes.push(Ie.uuid)}else oe.shapes.push(Be.uuid);return oe.options=Object.assign({},K),K.extrudePath!==void 0&&(oe.options.extrudePath=K.extrudePath.toJSON()),oe}class yA extends pd{constructor(K=1,oe=0){const de=(1+Math.sqrt(5))/2,ye=[-1,de,0,1,de,0,-1,-de,0,1,-de,0,0,-1,de,0,1,de,0,-1,-de,0,1,-de,de,0,-1,de,0,1,-de,0,-1,-de,0,1],Ie=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(ye,Ie,K,oe),this.type="IcosahedronGeometry",this.parameters={radius:K,detail:oe}}static fromJSON(K){return new yA(K.radius,K.detail)}}class Bp extends pd{constructor(K=1,oe=0){const de=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],ye=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(de,ye,K,oe),this.type="OctahedronGeometry",this.parameters={radius:K,detail:oe}}static fromJSON(K){return new Bp(K.radius,K.detail)}}class CA extends Ds{constructor(K=.5,oe=1,de=32,ye=1,Ie=0,Ue=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:K,outerRadius:oe,thetaSegments:de,phiSegments:ye,thetaStart:Ie,thetaLength:Ue},de=Math.max(3,de),ye=Math.max(1,ye);const He=[],Ke=[],Ze=[],at=[];let mt=K;const vt=(oe-K)/ye,St=new vn,Lt=new qi;for(let Ht=0;Ht<=ye;Ht++){for(let Dt=0;Dt<=de;Dt++){const bt=Ie+Dt/de*Ue;St.x=mt*Math.cos(bt),St.y=mt*Math.sin(bt),Ke.push(St.x,St.y,St.z),Ze.push(0,0,1),Lt.x=(St.x/oe+1)/2,Lt.y=(St.y/oe+1)/2,at.push(Lt.x,Lt.y)}mt+=vt}for(let Ht=0;Ht<ye;Ht++){const Dt=Ht*(de+1);for(let bt=0;bt<de;bt++){const tn=bt+Dt,Zt=tn,qt=tn+de+1,Un=tn+de+2,_n=tn+1;He.push(Zt,qt,_n),He.push(qt,Un,_n)}}this.setIndex(He),this.setAttribute("position",new $i(Ke,3)),this.setAttribute("normal",new $i(Ze,3)),this.setAttribute("uv",new $i(at,2))}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new CA(K.innerRadius,K.outerRadius,K.thetaSegments,K.phiSegments,K.thetaStart,K.thetaLength)}}class xA extends Ds{constructor(K=new T1([new qi(0,.5),new qi(-.5,-.5),new qi(.5,-.5)]),oe=12){super(),this.type="ShapeGeometry",this.parameters={shapes:K,curveSegments:oe};const de=[],ye=[],Ie=[],Ue=[];let He=0,Ke=0;if(Array.isArray(K)===!1)Ze(K);else for(let at=0;at<K.length;at++)Ze(K[at]),this.addGroup(He,Ke,at),He+=Ke,Ke=0;this.setIndex(de),this.setAttribute("position",new $i(ye,3)),this.setAttribute("normal",new $i(Ie,3)),this.setAttribute("uv",new $i(Ue,2));function Ze(at){const mt=ye.length/3,vt=at.extractPoints(oe);let St=vt.shape;const Lt=vt.holes;Ou.isClockWise(St)===!1&&(St=St.reverse());for(let Dt=0,bt=Lt.length;Dt<bt;Dt++){const tn=Lt[Dt];Ou.isClockWise(tn)===!0&&(Lt[Dt]=tn.reverse())}const Ht=Ou.triangulateShape(St,Lt);for(let Dt=0,bt=Lt.length;Dt<bt;Dt++){const tn=Lt[Dt];St=St.concat(tn)}for(let Dt=0,bt=St.length;Dt<bt;Dt++){const tn=St[Dt];ye.push(tn.x,tn.y,0),Ie.push(0,0,1),Ue.push(tn.x,tn.y)}for(let Dt=0,bt=Ht.length;Dt<bt;Dt++){const tn=Ht[Dt],Zt=tn[0]+mt,qt=tn[1]+mt,Un=tn[2]+mt;de.push(Zt,qt,Un),Ke+=3}}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}toJSON(){const K=super.toJSON(),oe=this.parameters.shapes;return W3(oe,K)}static fromJSON(K,oe){const de=[];for(let ye=0,Ie=K.shapes.length;ye<Ie;ye++){const Ue=oe[K.shapes[ye]];de.push(Ue)}return new xA(de,K.curveSegments)}}function W3(Be,K){if(K.shapes=[],Array.isArray(Be))for(let oe=0,de=Be.length;oe<de;oe++){const ye=Be[oe];K.shapes.push(ye.uuid)}else K.shapes.push(Be.uuid);return K}class Lp extends Ds{constructor(K=1,oe=32,de=16,ye=0,Ie=Math.PI*2,Ue=0,He=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:K,widthSegments:oe,heightSegments:de,phiStart:ye,phiLength:Ie,thetaStart:Ue,thetaLength:He},oe=Math.max(3,Math.floor(oe)),de=Math.max(2,Math.floor(de));const Ke=Math.min(Ue+He,Math.PI);let Ze=0;const at=[],mt=new vn,vt=new vn,St=[],Lt=[],Ht=[],Dt=[];for(let bt=0;bt<=de;bt++){const tn=[],Zt=bt/de;let qt=0;bt===0&&Ue===0?qt=.5/oe:bt===de&&Ke===Math.PI&&(qt=-.5/oe);for(let Un=0;Un<=oe;Un++){const _n=Un/oe;mt.x=-K*Math.cos(ye+_n*Ie)*Math.sin(Ue+Zt*He),mt.y=K*Math.cos(Ue+Zt*He),mt.z=K*Math.sin(ye+_n*Ie)*Math.sin(Ue+Zt*He),Lt.push(mt.x,mt.y,mt.z),vt.copy(mt).normalize(),Ht.push(vt.x,vt.y,vt.z),Dt.push(_n+qt,1-Zt),tn.push(Ze++)}at.push(tn)}for(let bt=0;bt<de;bt++)for(let tn=0;tn<oe;tn++){const Zt=at[bt][tn+1],qt=at[bt][tn],Un=at[bt+1][tn],_n=at[bt+1][tn+1];(bt!==0||Ue>0)&&St.push(Zt,qt,_n),(bt!==de-1||Ke<Math.PI)&&St.push(qt,Un,_n)}this.setIndex(St),this.setAttribute("position",new $i(Lt,3)),this.setAttribute("normal",new $i(Ht,3)),this.setAttribute("uv",new $i(Dt,2))}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new Lp(K.radius,K.widthSegments,K.heightSegments,K.phiStart,K.phiLength,K.thetaStart,K.thetaLength)}}class wA extends pd{constructor(K=1,oe=0){const de=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],ye=[2,1,0,0,3,2,1,3,0,2,3,1];super(de,ye,K,oe),this.type="TetrahedronGeometry",this.parameters={radius:K,detail:oe}}static fromJSON(K){return new wA(K.radius,K.detail)}}class SA extends Ds{constructor(K=1,oe=.4,de=12,ye=48,Ie=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:K,tube:oe,radialSegments:de,tubularSegments:ye,arc:Ie},de=Math.floor(de),ye=Math.floor(ye);const Ue=[],He=[],Ke=[],Ze=[],at=new vn,mt=new vn,vt=new vn;for(let St=0;St<=de;St++)for(let Lt=0;Lt<=ye;Lt++){const Ht=Lt/ye*Ie,Dt=St/de*Math.PI*2;mt.x=(K+oe*Math.cos(Dt))*Math.cos(Ht),mt.y=(K+oe*Math.cos(Dt))*Math.sin(Ht),mt.z=oe*Math.sin(Dt),He.push(mt.x,mt.y,mt.z),at.x=K*Math.cos(Ht),at.y=K*Math.sin(Ht),vt.subVectors(mt,at).normalize(),Ke.push(vt.x,vt.y,vt.z),Ze.push(Lt/ye),Ze.push(St/de)}for(let St=1;St<=de;St++)for(let Lt=1;Lt<=ye;Lt++){const Ht=(ye+1)*St+Lt-1,Dt=(ye+1)*(St-1)+Lt-1,bt=(ye+1)*(St-1)+Lt,tn=(ye+1)*St+Lt;Ue.push(Ht,Dt,tn),Ue.push(Dt,bt,tn)}this.setIndex(Ue),this.setAttribute("position",new $i(He,3)),this.setAttribute("normal",new $i(Ke,3)),this.setAttribute("uv",new $i(Ze,2))}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new SA(K.radius,K.tube,K.radialSegments,K.tubularSegments,K.arc)}}class MA extends Ds{constructor(K=1,oe=.4,de=64,ye=8,Ie=2,Ue=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:K,tube:oe,tubularSegments:de,radialSegments:ye,p:Ie,q:Ue},de=Math.floor(de),ye=Math.floor(ye);const He=[],Ke=[],Ze=[],at=[],mt=new vn,vt=new vn,St=new vn,Lt=new vn,Ht=new vn,Dt=new vn,bt=new vn;for(let Zt=0;Zt<=de;++Zt){const qt=Zt/de*Ie*Math.PI*2;tn(qt,Ie,Ue,K,St),tn(qt+.01,Ie,Ue,K,Lt),Dt.subVectors(Lt,St),bt.addVectors(Lt,St),Ht.crossVectors(Dt,bt),bt.crossVectors(Ht,Dt),Ht.normalize(),bt.normalize();for(let Un=0;Un<=ye;++Un){const _n=Un/ye*Math.PI*2,bn=-oe*Math.cos(_n),Fn=oe*Math.sin(_n);mt.x=St.x+(bn*bt.x+Fn*Ht.x),mt.y=St.y+(bn*bt.y+Fn*Ht.y),mt.z=St.z+(bn*bt.z+Fn*Ht.z),Ke.push(mt.x,mt.y,mt.z),vt.subVectors(mt,St).normalize(),Ze.push(vt.x,vt.y,vt.z),at.push(Zt/de),at.push(Un/ye)}}for(let Zt=1;Zt<=de;Zt++)for(let qt=1;qt<=ye;qt++){const Un=(ye+1)*(Zt-1)+(qt-1),_n=(ye+1)*Zt+(qt-1),bn=(ye+1)*Zt+qt,Fn=(ye+1)*(Zt-1)+qt;He.push(Un,_n,Fn),He.push(_n,bn,Fn)}this.setIndex(He),this.setAttribute("position",new $i(Ke,3)),this.setAttribute("normal",new $i(Ze,3)),this.setAttribute("uv",new $i(at,2));function tn(Zt,qt,Un,_n,bn){const Fn=Math.cos(Zt),pn=Math.sin(Zt),cn=Un/qt*Zt,On=Math.cos(cn);bn.x=_n*(2+On)*.5*Fn,bn.y=_n*(2+On)*pn*.5,bn.z=_n*Math.sin(cn)*.5}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}static fromJSON(K){return new MA(K.radius,K.tube,K.tubularSegments,K.radialSegments,K.p,K.q)}}class bA extends Ds{constructor(K=new o2(new vn(-1,-1,0),new vn(-1,1,0),new vn(1,1,0)),oe=64,de=1,ye=8,Ie=!1){super(),this.type="TubeGeometry",this.parameters={path:K,tubularSegments:oe,radius:de,radialSegments:ye,closed:Ie};const Ue=K.computeFrenetFrames(oe,Ie);this.tangents=Ue.tangents,this.normals=Ue.normals,this.binormals=Ue.binormals;const He=new vn,Ke=new vn,Ze=new qi;let at=new vn;const mt=[],vt=[],St=[],Lt=[];Ht(),this.setIndex(Lt),this.setAttribute("position",new $i(mt,3)),this.setAttribute("normal",new $i(vt,3)),this.setAttribute("uv",new $i(St,2));function Ht(){for(let Zt=0;Zt<oe;Zt++)Dt(Zt);Dt(Ie===!1?oe:0),tn(),bt()}function Dt(Zt){at=K.getPointAt(Zt/oe,at);const qt=Ue.normals[Zt],Un=Ue.binormals[Zt];for(let _n=0;_n<=ye;_n++){const bn=_n/ye*Math.PI*2,Fn=Math.sin(bn),pn=-Math.cos(bn);Ke.x=pn*qt.x+Fn*Un.x,Ke.y=pn*qt.y+Fn*Un.y,Ke.z=pn*qt.z+Fn*Un.z,Ke.normalize(),vt.push(Ke.x,Ke.y,Ke.z),He.x=at.x+de*Ke.x,He.y=at.y+de*Ke.y,He.z=at.z+de*Ke.z,mt.push(He.x,He.y,He.z)}}function bt(){for(let Zt=1;Zt<=oe;Zt++)for(let qt=1;qt<=ye;qt++){const Un=(ye+1)*(Zt-1)+(qt-1),_n=(ye+1)*Zt+(qt-1),bn=(ye+1)*Zt+qt,Fn=(ye+1)*(Zt-1)+qt;Lt.push(Un,_n,Fn),Lt.push(_n,bn,Fn)}}function tn(){for(let Zt=0;Zt<=oe;Zt++)for(let qt=0;qt<=ye;qt++)Ze.x=Zt/oe,Ze.y=qt/ye,St.push(Ze.x,Ze.y)}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}toJSON(){const K=super.toJSON();return K.path=this.parameters.path.toJSON(),K}static fromJSON(K){return new bA(new cA[K.path.type]().fromJSON(K.path),K.tubularSegments,K.radius,K.radialSegments,K.closed)}}class Tm extends Ds{constructor(K=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:K},K!==null){const oe=[],de=new Set,ye=new vn,Ie=new vn;if(K.index!==null){const Ue=K.attributes.position,He=K.index;let Ke=K.groups;Ke.length===0&&(Ke=[{start:0,count:He.count,materialIndex:0}]);for(let Ze=0,at=Ke.length;Ze<at;++Ze){const mt=Ke[Ze],vt=mt.start,St=mt.count;for(let Lt=vt,Ht=vt+St;Lt<Ht;Lt+=3)for(let Dt=0;Dt<3;Dt++){const bt=He.getX(Lt+Dt),tn=He.getX(Lt+(Dt+1)%3);ye.fromBufferAttribute(Ue,bt),Ie.fromBufferAttribute(Ue,tn),Im(ye,Ie,de)===!0&&(oe.push(ye.x,ye.y,ye.z),oe.push(Ie.x,Ie.y,Ie.z))}}}else{const Ue=K.attributes.position;for(let He=0,Ke=Ue.count/3;He<Ke;He++)for(let Ze=0;Ze<3;Ze++){const at=3*He+Ze,mt=3*He+(Ze+1)%3;ye.fromBufferAttribute(Ue,at),Ie.fromBufferAttribute(Ue,mt),Im(ye,Ie,de)===!0&&(oe.push(ye.x,ye.y,ye.z),oe.push(Ie.x,Ie.y,Ie.z))}}this.setAttribute("position",new $i(oe,3))}}copy(K){return super.copy(K),this.parameters=Object.assign({},K.parameters),this}}function Im(Be,K,oe){const de=`${Be.x},${Be.y},${Be.z}-${K.x},${K.y},${K.z}`,ye=`${K.x},${K.y},${K.z}-${Be.x},${Be.y},${Be.z}`;return oe.has(de)===!0||oe.has(ye)===!0?!1:(oe.add(de),oe.add(ye),!0)}var Rm=Object.freeze({__proto__:null,BoxGeometry:il,CapsuleGeometry:uA,CircleGeometry:hA,ConeGeometry:dA,CylinderGeometry:Yf,DodecahedronGeometry:fA,EdgesGeometry:ym,ExtrudeGeometry:_A,IcosahedronGeometry:yA,LatheGeometry:bp,OctahedronGeometry:Bp,PlaneGeometry:ql,PolyhedronGeometry:pd,RingGeometry:CA,ShapeGeometry:xA,SphereGeometry:Lp,TetrahedronGeometry:wA,TorusGeometry:SA,TorusKnotGeometry:MA,TubeGeometry:bA,WireframeGeometry:Tm});class Bm extends Oo{constructor(K){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Wr(0),this.transparent=!0,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.fog=K.fog,this}}class Lm extends k0{constructor(K){super(K),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class h2 extends Oo{constructor(K){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Wr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Va,this.normalScale=new qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new S0,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.defines={STANDARD:""},this.color.copy(K.color),this.roughness=K.roughness,this.metalness=K.metalness,this.map=K.map,this.lightMap=K.lightMap,this.lightMapIntensity=K.lightMapIntensity,this.aoMap=K.aoMap,this.aoMapIntensity=K.aoMapIntensity,this.emissive.copy(K.emissive),this.emissiveMap=K.emissiveMap,this.emissiveIntensity=K.emissiveIntensity,this.bumpMap=K.bumpMap,this.bumpScale=K.bumpScale,this.normalMap=K.normalMap,this.normalMapType=K.normalMapType,this.normalScale.copy(K.normalScale),this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.roughnessMap=K.roughnessMap,this.metalnessMap=K.metalnessMap,this.alphaMap=K.alphaMap,this.envMap=K.envMap,this.envMapRotation.copy(K.envMapRotation),this.envMapIntensity=K.envMapIntensity,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.wireframeLinecap=K.wireframeLinecap,this.wireframeLinejoin=K.wireframeLinejoin,this.flatShading=K.flatShading,this.fog=K.fog,this}}class Dm extends h2{constructor(K){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qi(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return qo(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(oe){this.ior=(1+.4*oe)/(1-.4*oe)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Wr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Wr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Wr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(K)}get anisotropy(){return this._anisotropy}set anisotropy(K){this._anisotropy>0!=K>0&&this.version++,this._anisotropy=K}get clearcoat(){return this._clearcoat}set clearcoat(K){this._clearcoat>0!=K>0&&this.version++,this._clearcoat=K}get iridescence(){return this._iridescence}set iridescence(K){this._iridescence>0!=K>0&&this.version++,this._iridescence=K}get dispersion(){return this._dispersion}set dispersion(K){this._dispersion>0!=K>0&&this.version++,this._dispersion=K}get sheen(){return this._sheen}set sheen(K){this._sheen>0!=K>0&&this.version++,this._sheen=K}get transmission(){return this._transmission}set transmission(K){this._transmission>0!=K>0&&this.version++,this._transmission=K}copy(K){return super.copy(K),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=K.anisotropy,this.anisotropyRotation=K.anisotropyRotation,this.anisotropyMap=K.anisotropyMap,this.clearcoat=K.clearcoat,this.clearcoatMap=K.clearcoatMap,this.clearcoatRoughness=K.clearcoatRoughness,this.clearcoatRoughnessMap=K.clearcoatRoughnessMap,this.clearcoatNormalMap=K.clearcoatNormalMap,this.clearcoatNormalScale.copy(K.clearcoatNormalScale),this.dispersion=K.dispersion,this.ior=K.ior,this.iridescence=K.iridescence,this.iridescenceMap=K.iridescenceMap,this.iridescenceIOR=K.iridescenceIOR,this.iridescenceThicknessRange=[...K.iridescenceThicknessRange],this.iridescenceThicknessMap=K.iridescenceThicknessMap,this.sheen=K.sheen,this.sheenColor.copy(K.sheenColor),this.sheenColorMap=K.sheenColorMap,this.sheenRoughness=K.sheenRoughness,this.sheenRoughnessMap=K.sheenRoughnessMap,this.transmission=K.transmission,this.transmissionMap=K.transmissionMap,this.thickness=K.thickness,this.thicknessMap=K.thicknessMap,this.attenuationDistance=K.attenuationDistance,this.attenuationColor.copy(K.attenuationColor),this.specularIntensity=K.specularIntensity,this.specularIntensityMap=K.specularIntensityMap,this.specularColor.copy(K.specularColor),this.specularColorMap=K.specularColorMap,this}}class Pm extends Oo{constructor(K){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Wr(16777215),this.specular=new Wr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Va,this.normalScale=new qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new S0,this.combine=Kn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.specular.copy(K.specular),this.shininess=K.shininess,this.map=K.map,this.lightMap=K.lightMap,this.lightMapIntensity=K.lightMapIntensity,this.aoMap=K.aoMap,this.aoMapIntensity=K.aoMapIntensity,this.emissive.copy(K.emissive),this.emissiveMap=K.emissiveMap,this.emissiveIntensity=K.emissiveIntensity,this.bumpMap=K.bumpMap,this.bumpScale=K.bumpScale,this.normalMap=K.normalMap,this.normalMapType=K.normalMapType,this.normalScale.copy(K.normalScale),this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.specularMap=K.specularMap,this.alphaMap=K.alphaMap,this.envMap=K.envMap,this.envMapRotation.copy(K.envMapRotation),this.combine=K.combine,this.reflectivity=K.reflectivity,this.refractionRatio=K.refractionRatio,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.wireframeLinecap=K.wireframeLinecap,this.wireframeLinejoin=K.wireframeLinejoin,this.flatShading=K.flatShading,this.fog=K.fog,this}}class Fm extends Oo{constructor(K){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Wr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Va,this.normalScale=new qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.map=K.map,this.gradientMap=K.gradientMap,this.lightMap=K.lightMap,this.lightMapIntensity=K.lightMapIntensity,this.aoMap=K.aoMap,this.aoMapIntensity=K.aoMapIntensity,this.emissive.copy(K.emissive),this.emissiveMap=K.emissiveMap,this.emissiveIntensity=K.emissiveIntensity,this.bumpMap=K.bumpMap,this.bumpScale=K.bumpScale,this.normalMap=K.normalMap,this.normalMapType=K.normalMapType,this.normalScale.copy(K.normalScale),this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.alphaMap=K.alphaMap,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.wireframeLinecap=K.wireframeLinecap,this.wireframeLinejoin=K.wireframeLinejoin,this.fog=K.fog,this}}class Om extends Oo{constructor(K){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Va,this.normalScale=new qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(K)}copy(K){return super.copy(K),this.bumpMap=K.bumpMap,this.bumpScale=K.bumpScale,this.normalMap=K.normalMap,this.normalMapType=K.normalMapType,this.normalScale.copy(K.normalScale),this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.flatShading=K.flatShading,this}}class Nm extends Oo{constructor(K){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Wr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Va,this.normalScale=new qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new S0,this.combine=Kn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.color.copy(K.color),this.map=K.map,this.lightMap=K.lightMap,this.lightMapIntensity=K.lightMapIntensity,this.aoMap=K.aoMap,this.aoMapIntensity=K.aoMapIntensity,this.emissive.copy(K.emissive),this.emissiveMap=K.emissiveMap,this.emissiveIntensity=K.emissiveIntensity,this.bumpMap=K.bumpMap,this.bumpScale=K.bumpScale,this.normalMap=K.normalMap,this.normalMapType=K.normalMapType,this.normalScale.copy(K.normalScale),this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.specularMap=K.specularMap,this.alphaMap=K.alphaMap,this.envMap=K.envMap,this.envMapRotation.copy(K.envMapRotation),this.combine=K.combine,this.reflectivity=K.reflectivity,this.refractionRatio=K.refractionRatio,this.wireframe=K.wireframe,this.wireframeLinewidth=K.wireframeLinewidth,this.wireframeLinecap=K.wireframeLinecap,this.wireframeLinejoin=K.wireframeLinejoin,this.flatShading=K.flatShading,this.fog=K.fog,this}}class Um extends Oo{constructor(K){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Wr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Va,this.normalScale=new qi(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(K)}copy(K){return super.copy(K),this.defines={MATCAP:""},this.color.copy(K.color),this.matcap=K.matcap,this.map=K.map,this.bumpMap=K.bumpMap,this.bumpScale=K.bumpScale,this.normalMap=K.normalMap,this.normalMapType=K.normalMapType,this.normalScale.copy(K.normalScale),this.displacementMap=K.displacementMap,this.displacementScale=K.displacementScale,this.displacementBias=K.displacementBias,this.alphaMap=K.alphaMap,this.flatShading=K.flatShading,this.fog=K.fog,this}}class km extends bl{constructor(K){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(K)}copy(K){return super.copy(K),this.scale=K.scale,this.dashSize=K.dashSize,this.gapSize=K.gapSize,this}}function R1(Be,K,oe){return!Be||!oe&&Be.constructor===K?Be:typeof K.BYTES_PER_ELEMENT=="number"?new K(Be):Array.prototype.slice.call(Be)}function Gm(Be){return ArrayBuffer.isView(Be)&&!(Be instanceof DataView)}function Qm(Be){function K(ye,Ie){return Be[ye]-Be[Ie]}const oe=Be.length,de=new Array(oe);for(let ye=0;ye!==oe;++ye)de[ye]=ye;return de.sort(K),de}function d2(Be,K,oe){const de=Be.length,ye=new Be.constructor(de);for(let Ie=0,Ue=0;Ue!==de;++Ie){const He=oe[Ie]*K;for(let Ke=0;Ke!==K;++Ke)ye[Ue++]=Be[He+Ke]}return ye}function f2(Be,K,oe,de){let ye=1,Ie=Be[0];for(;Ie!==void 0&&Ie[de]===void 0;)Ie=Be[ye++];if(Ie===void 0)return;let Ue=Ie[de];if(Ue!==void 0)if(Array.isArray(Ue))do Ue=Ie[de],Ue!==void 0&&(K.push(Ie.time),oe.push.apply(oe,Ue)),Ie=Be[ye++];while(Ie!==void 0);else if(Ue.toArray!==void 0)do Ue=Ie[de],Ue!==void 0&&(K.push(Ie.time),Ue.toArray(oe,oe.length)),Ie=Be[ye++];while(Ie!==void 0);else do Ue=Ie[de],Ue!==void 0&&(K.push(Ie.time),oe.push(Ue)),Ie=Be[ye++];while(Ie!==void 0)}function $3(Be,K,oe,de,ye=30){const Ie=Be.clone();Ie.name=K;const Ue=[];for(let Ke=0;Ke<Ie.tracks.length;++Ke){const Ze=Ie.tracks[Ke],at=Ze.getValueSize(),mt=[],vt=[];for(let St=0;St<Ze.times.length;++St){const Lt=Ze.times[St]*ye;if(!(Lt<oe||Lt>=de)){mt.push(Ze.times[St]);for(let Ht=0;Ht<at;++Ht)vt.push(Ze.values[St*at+Ht])}}mt.length!==0&&(Ze.times=R1(mt,Ze.times.constructor),Ze.values=R1(vt,Ze.values.constructor),Ue.push(Ze))}Ie.tracks=Ue;let He=1/0;for(let Ke=0;Ke<Ie.tracks.length;++Ke)He>Ie.tracks[Ke].times[0]&&(He=Ie.tracks[Ke].times[0]);for(let Ke=0;Ke<Ie.tracks.length;++Ke)Ie.tracks[Ke].shift(-1*He);return Ie.resetDuration(),Ie}function X3(Be,K=0,oe=Be,de=30){de<=0&&(de=30);const ye=oe.tracks.length,Ie=K/de;for(let Ue=0;Ue<ye;++Ue){const He=oe.tracks[Ue],Ke=He.ValueTypeName;if(Ke==="bool"||Ke==="string")continue;const Ze=Be.tracks.find(function(bt){return bt.name===He.name&&bt.ValueTypeName===Ke});if(Ze===void 0)continue;let at=0;const mt=He.getValueSize();He.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(at=mt/3);let vt=0;const St=Ze.getValueSize();Ze.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(vt=St/3);const Lt=He.times.length-1;let Ht;if(Ie<=He.times[0]){const bt=at,tn=mt-at;Ht=He.values.slice(bt,tn)}else if(Ie>=He.times[Lt]){const bt=Lt*mt+at,tn=bt+mt-at;Ht=He.values.slice(bt,tn)}else{const bt=He.createInterpolant(),tn=at,Zt=mt-at;bt.evaluate(Ie),Ht=bt.resultBuffer.slice(tn,Zt)}Ke==="quaternion"&&new to().fromArray(Ht).normalize().conjugate().toArray(Ht);const Dt=Ze.times.length;for(let bt=0;bt<Dt;++bt){const tn=bt*St+vt;if(Ke==="quaternion")to.multiplyQuaternionsFlat(Ze.values,tn,Ht,0,Ze.values,tn);else{const Zt=St-vt*2;for(let qt=0;qt<Zt;++qt)Ze.values[tn+qt]-=Ht[qt]}}}return Be.blendMode=C0,Be}const K3={convertArray:R1,isTypedArray:Gm,getKeyframeOrder:Qm,sortedArray:d2,flattenJSON:f2,subclip:$3,makeClipAdditive:X3};class Dp{constructor(K,oe,de,ye){this.parameterPositions=K,this._cachedIndex=0,this.resultBuffer=ye!==void 0?ye:new oe.constructor(de),this.sampleValues=oe,this.valueSize=de,this.settings=null,this.DefaultSettings_={}}evaluate(K){const oe=this.parameterPositions;let de=this._cachedIndex,ye=oe[de],Ie=oe[de-1];e:{t:{let Ue;n:{r:if(!(K<ye)){for(let He=de+2;;){if(ye===void 0){if(K<Ie)break r;return de=oe.length,this._cachedIndex=de,this.copySampleValue_(de-1)}if(de===He)break;if(Ie=ye,ye=oe[++de],K<ye)break t}Ue=oe.length;break n}if(!(K>=Ie)){const He=oe[1];K<He&&(de=2,Ie=He);for(let Ke=de-2;;){if(Ie===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(de===Ke)break;if(ye=Ie,Ie=oe[--de-1],K>=Ie)break t}Ue=de,de=0;break n}break e}for(;de<Ue;){const He=de+Ue>>>1;K<oe[He]?Ue=He:de=He+1}if(ye=oe[de],Ie=oe[de-1],Ie===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(ye===void 0)return de=oe.length,this._cachedIndex=de,this.copySampleValue_(de-1)}this._cachedIndex=de,this.intervalChanged_(de,Ie,ye)}return this.interpolate_(de,Ie,K,ye)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(K){const oe=this.resultBuffer,de=this.sampleValues,ye=this.valueSize,Ie=K*ye;for(let Ue=0;Ue!==ye;++Ue)oe[Ue]=de[Ie+Ue];return oe}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Hm extends Dp{constructor(K,oe,de,ye){super(K,oe,de,ye),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:na,endingEnd:na}}intervalChanged_(K,oe,de){const ye=this.parameterPositions;let Ie=K-2,Ue=K+1,He=ye[Ie],Ke=ye[Ue];if(He===void 0)switch(this.getSettings_().endingStart){case ma:Ie=K,He=2*oe-de;break;case L0:Ie=ye.length-2,He=oe+ye[Ie]-ye[Ie+1];break;default:Ie=K,He=de}if(Ke===void 0)switch(this.getSettings_().endingEnd){case ma:Ue=K,Ke=2*de-oe;break;case L0:Ue=1,Ke=de+ye[1]-ye[0];break;default:Ue=K-1,Ke=oe}const Ze=(de-oe)*.5,at=this.valueSize;this._weightPrev=Ze/(oe-He),this._weightNext=Ze/(Ke-de),this._offsetPrev=Ie*at,this._offsetNext=Ue*at}interpolate_(K,oe,de,ye){const Ie=this.resultBuffer,Ue=this.sampleValues,He=this.valueSize,Ke=K*He,Ze=Ke-He,at=this._offsetPrev,mt=this._offsetNext,vt=this._weightPrev,St=this._weightNext,Lt=(de-oe)/(ye-oe),Ht=Lt*Lt,Dt=Ht*Lt,bt=-vt*Dt+2*vt*Ht-vt*Lt,tn=(1+vt)*Dt+(-1.5-2*vt)*Ht+(-.5+vt)*Lt+1,Zt=(-1-St)*Dt+(1.5+St)*Ht+.5*Lt,qt=St*Dt-St*Ht;for(let Un=0;Un!==He;++Un)Ie[Un]=bt*Ue[at+Un]+tn*Ue[Ze+Un]+Zt*Ue[Ke+Un]+qt*Ue[mt+Un];return Ie}}class p2 extends Dp{constructor(K,oe,de,ye){super(K,oe,de,ye)}interpolate_(K,oe,de,ye){const Ie=this.resultBuffer,Ue=this.sampleValues,He=this.valueSize,Ke=K*He,Ze=Ke-He,at=(de-oe)/(ye-oe),mt=1-at;for(let vt=0;vt!==He;++vt)Ie[vt]=Ue[Ze+vt]*mt+Ue[Ke+vt]*at;return Ie}}class Vm extends Dp{constructor(K,oe,de,ye){super(K,oe,de,ye)}interpolate_(K){return this.copySampleValue_(K-1)}}class uu{constructor(K,oe,de,ye){if(K===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(oe===void 0||oe.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+K);this.name=K,this.times=R1(oe,this.TimeBufferType),this.values=R1(de,this.ValueBufferType),this.setInterpolation(ye||this.DefaultInterpolation)}static toJSON(K){const oe=K.constructor;let de;if(oe.toJSON!==this.toJSON)de=oe.toJSON(K);else{de={name:K.name,times:R1(K.times,Array),values:R1(K.values,Array)};const ye=K.getInterpolation();ye!==K.DefaultInterpolation&&(de.interpolation=ye)}return de.type=K.ValueTypeName,de}InterpolantFactoryMethodDiscrete(K){return new Vm(this.times,this.values,this.getValueSize(),K)}InterpolantFactoryMethodLinear(K){return new p2(this.times,this.values,this.getValueSize(),K)}InterpolantFactoryMethodSmooth(K){return new Hm(this.times,this.values,this.getValueSize(),K)}setInterpolation(K){let oe;switch(K){case pa:oe=this.InterpolantFactoryMethodDiscrete;break;case zo:oe=this.InterpolantFactoryMethodLinear;break;case Aa:oe=this.InterpolantFactoryMethodSmooth;break}if(oe===void 0){const de="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(K!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(de);return console.warn("THREE.KeyframeTrack:",de),this}return this.createInterpolant=oe,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pa;case this.InterpolantFactoryMethodLinear:return zo;case this.InterpolantFactoryMethodSmooth:return Aa}}getValueSize(){return this.values.length/this.times.length}shift(K){if(K!==0){const oe=this.times;for(let de=0,ye=oe.length;de!==ye;++de)oe[de]+=K}return this}scale(K){if(K!==1){const oe=this.times;for(let de=0,ye=oe.length;de!==ye;++de)oe[de]*=K}return this}trim(K,oe){const de=this.times,ye=de.length;let Ie=0,Ue=ye-1;for(;Ie!==ye&&de[Ie]<K;)++Ie;for(;Ue!==-1&&de[Ue]>oe;)--Ue;if(++Ue,Ie!==0||Ue!==ye){Ie>=Ue&&(Ue=Math.max(Ue,1),Ie=Ue-1);const He=this.getValueSize();this.times=de.slice(Ie,Ue),this.values=this.values.slice(Ie*He,Ue*He)}return this}validate(){let K=!0;const oe=this.getValueSize();oe-Math.floor(oe)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),K=!1);const de=this.times,ye=this.values,Ie=de.length;Ie===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),K=!1);let Ue=null;for(let He=0;He!==Ie;He++){const Ke=de[He];if(typeof Ke=="number"&&isNaN(Ke)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,He,Ke),K=!1;break}if(Ue!==null&&Ue>Ke){console.error("THREE.KeyframeTrack: Out of order keys.",this,He,Ke,Ue),K=!1;break}Ue=Ke}if(ye!==void 0&&Gm(ye))for(let He=0,Ke=ye.length;He!==Ke;++He){const Ze=ye[He];if(isNaN(Ze)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,He,Ze),K=!1;break}}return K}optimize(){const K=this.times.slice(),oe=this.values.slice(),de=this.getValueSize(),ye=this.getInterpolation()===Aa,Ie=K.length-1;let Ue=1;for(let He=1;He<Ie;++He){let Ke=!1;const Ze=K[He],at=K[He+1];if(Ze!==at&&(He!==1||Ze!==K[0]))if(ye)Ke=!0;else{const mt=He*de,vt=mt-de,St=mt+de;for(let Lt=0;Lt!==de;++Lt){const Ht=oe[mt+Lt];if(Ht!==oe[vt+Lt]||Ht!==oe[St+Lt]){Ke=!0;break}}}if(Ke){if(He!==Ue){K[Ue]=K[He];const mt=He*de,vt=Ue*de;for(let St=0;St!==de;++St)oe[vt+St]=oe[mt+St]}++Ue}}if(Ie>0){K[Ue]=K[Ie];for(let He=Ie*de,Ke=Ue*de,Ze=0;Ze!==de;++Ze)oe[Ke+Ze]=oe[He+Ze];++Ue}return Ue!==K.length?(this.times=K.slice(0,Ue),this.values=oe.slice(0,Ue*de)):(this.times=K,this.values=oe),this}clone(){const K=this.times.slice(),oe=this.values.slice(),de=this.constructor,ye=new de(this.name,K,oe);return ye.createInterpolant=this.createInterpolant,ye}}uu.prototype.TimeBufferType=Float32Array,uu.prototype.ValueBufferType=Float32Array,uu.prototype.DefaultInterpolation=zo;class B1 extends uu{}B1.prototype.ValueTypeName="bool",B1.prototype.ValueBufferType=Array,B1.prototype.DefaultInterpolation=pa,B1.prototype.InterpolantFactoryMethodLinear=void 0,B1.prototype.InterpolantFactoryMethodSmooth=void 0;class A2 extends uu{}A2.prototype.ValueTypeName="color";class Pp extends uu{}Pp.prototype.ValueTypeName="number";class zm extends Dp{constructor(K,oe,de,ye){super(K,oe,de,ye)}interpolate_(K,oe,de,ye){const Ie=this.resultBuffer,Ue=this.sampleValues,He=this.valueSize,Ke=(de-oe)/(ye-oe);let Ze=K*He;for(let at=Ze+He;Ze!==at;Ze+=4)to.slerpFlat(Ie,0,Ue,Ze-He,Ue,Ze,Ke);return Ie}}class Jf extends uu{InterpolantFactoryMethodLinear(K){return new zm(this.times,this.values,this.getValueSize(),K)}}Jf.prototype.ValueTypeName="quaternion",Jf.prototype.DefaultInterpolation=zo,Jf.prototype.InterpolantFactoryMethodSmooth=void 0;class L1 extends uu{}L1.prototype.ValueTypeName="string",L1.prototype.ValueBufferType=Array,L1.prototype.DefaultInterpolation=pa,L1.prototype.InterpolantFactoryMethodLinear=void 0,L1.prototype.InterpolantFactoryMethodSmooth=void 0;class Fp extends uu{}Fp.prototype.ValueTypeName="vector";class Op{constructor(K="",oe=-1,de=[],ye=J0){this.name=K,this.tracks=de,this.duration=oe,this.blendMode=ye,this.uuid=c0(),this.duration<0&&this.resetDuration()}static parse(K){const oe=[],de=K.tracks,ye=1/(K.fps||1);for(let Ue=0,He=de.length;Ue!==He;++Ue)oe.push(q3(de[Ue]).scale(ye));const Ie=new this(K.name,K.duration,oe,K.blendMode);return Ie.uuid=K.uuid,Ie}static toJSON(K){const oe=[],de=K.tracks,ye={name:K.name,duration:K.duration,tracks:oe,uuid:K.uuid,blendMode:K.blendMode};for(let Ie=0,Ue=de.length;Ie!==Ue;++Ie)oe.push(uu.toJSON(de[Ie]));return ye}static CreateFromMorphTargetSequence(K,oe,de,ye){const Ie=oe.length,Ue=[];for(let He=0;He<Ie;He++){let Ke=[],Ze=[];Ke.push((He+Ie-1)%Ie,He,(He+1)%Ie),Ze.push(0,1,0);const at=Qm(Ke);Ke=d2(Ke,1,at),Ze=d2(Ze,1,at),!ye&&Ke[0]===0&&(Ke.push(Ie),Ze.push(Ze[0])),Ue.push(new Pp(".morphTargetInfluences["+oe[He].name+"]",Ke,Ze).scale(1/de))}return new this(K,-1,Ue)}static findByName(K,oe){let de=K;if(!Array.isArray(K)){const ye=K;de=ye.geometry&&ye.geometry.animations||ye.animations}for(let ye=0;ye<de.length;ye++)if(de[ye].name===oe)return de[ye];return null}static CreateClipsFromMorphTargetSequences(K,oe,de){const ye={},Ie=/^([\w-]*?)([\d]+)$/;for(let He=0,Ke=K.length;He<Ke;He++){const Ze=K[He],at=Ze.name.match(Ie);if(at&&at.length>1){const mt=at[1];let vt=ye[mt];vt||(ye[mt]=vt=[]),vt.push(Ze)}}const Ue=[];for(const He in ye)Ue.push(this.CreateFromMorphTargetSequence(He,ye[He],oe,de));return Ue}static parseAnimation(K,oe){if(!K)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const de=function(mt,vt,St,Lt,Ht){if(St.length!==0){const Dt=[],bt=[];f2(St,Dt,bt,Lt),Dt.length!==0&&Ht.push(new mt(vt,Dt,bt))}},ye=[],Ie=K.name||"default",Ue=K.fps||30,He=K.blendMode;let Ke=K.length||-1;const Ze=K.hierarchy||[];for(let mt=0;mt<Ze.length;mt++){const vt=Ze[mt].keys;if(!(!vt||vt.length===0))if(vt[0].morphTargets){const St={};let Lt;for(Lt=0;Lt<vt.length;Lt++)if(vt[Lt].morphTargets)for(let Ht=0;Ht<vt[Lt].morphTargets.length;Ht++)St[vt[Lt].morphTargets[Ht]]=-1;for(const Ht in St){const Dt=[],bt=[];for(let tn=0;tn!==vt[Lt].morphTargets.length;++tn){const Zt=vt[Lt];Dt.push(Zt.time),bt.push(Zt.morphTarget===Ht?1:0)}ye.push(new Pp(".morphTargetInfluence["+Ht+"]",Dt,bt))}Ke=St.length*Ue}else{const St=".bones["+oe[mt].name+"]";de(Fp,St+".position",vt,"pos",ye),de(Jf,St+".quaternion",vt,"rot",ye),de(Fp,St+".scale",vt,"scl",ye)}}return ye.length===0?null:new this(Ie,Ke,ye,He)}resetDuration(){const K=this.tracks;let oe=0;for(let de=0,ye=K.length;de!==ye;++de){const Ie=this.tracks[de];oe=Math.max(oe,Ie.times[Ie.times.length-1])}return this.duration=oe,this}trim(){for(let K=0;K<this.tracks.length;K++)this.tracks[K].trim(0,this.duration);return this}validate(){let K=!0;for(let oe=0;oe<this.tracks.length;oe++)K=K&&this.tracks[oe].validate();return K}optimize(){for(let K=0;K<this.tracks.length;K++)this.tracks[K].optimize();return this}clone(){const K=[];for(let oe=0;oe<this.tracks.length;oe++)K.push(this.tracks[oe].clone());return new this.constructor(this.name,this.duration,K,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Y3(Be){switch(Be.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Pp;case"vector":case"vector2":case"vector3":case"vector4":return Fp;case"color":return A2;case"quaternion":return Jf;case"bool":case"boolean":return B1;case"string":return L1}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+Be)}function q3(Be){if(Be.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const K=Y3(Be.type);if(Be.times===void 0){const oe=[],de=[];f2(Be.keys,oe,de,"value"),Be.times=oe,Be.values=de}return K.parse!==void 0?K.parse(Be):new K(Be.name,Be.times,Be.values,Be.interpolation)}const ph={enabled:!1,files:{},add:function(Be,K){this.enabled!==!1&&(this.files[Be]=K)},get:function(Be){if(this.enabled!==!1)return this.files[Be]},remove:function(Be){delete this.files[Be]},clear:function(){this.files={}}};class m2{constructor(K,oe,de){const ye=this;let Ie=!1,Ue=0,He=0,Ke;const Ze=[];this.onStart=void 0,this.onLoad=K,this.onProgress=oe,this.onError=de,this.itemStart=function(at){He++,Ie===!1&&ye.onStart!==void 0&&ye.onStart(at,Ue,He),Ie=!0},this.itemEnd=function(at){Ue++,ye.onProgress!==void 0&&ye.onProgress(at,Ue,He),Ue===He&&(Ie=!1,ye.onLoad!==void 0&&ye.onLoad())},this.itemError=function(at){ye.onError!==void 0&&ye.onError(at)},this.resolveURL=function(at){return Ke?Ke(at):at},this.setURLModifier=function(at){return Ke=at,this},this.addHandler=function(at,mt){return Ze.push(at,mt),this},this.removeHandler=function(at){const mt=Ze.indexOf(at);return mt!==-1&&Ze.splice(mt,2),this},this.getHandler=function(at){for(let mt=0,vt=Ze.length;mt<vt;mt+=2){const St=Ze[mt],Lt=Ze[mt+1];if(St.global&&(St.lastIndex=0),St.test(at))return Lt}return null}}}const Wm=new m2;class rc{constructor(K){this.manager=K!==void 0?K:Wm,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(K,oe){const de=this;return new Promise(function(ye,Ie){de.load(K,ye,oe,Ie)})}parse(){}setCrossOrigin(K){return this.crossOrigin=K,this}setWithCredentials(K){return this.withCredentials=K,this}setPath(K){return this.path=K,this}setResourcePath(K){return this.resourcePath=K,this}setRequestHeader(K){return this.requestHeader=K,this}}rc.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ah={};class J3 extends Error{constructor(K,oe){super(K),this.response=oe}}class mh extends rc{constructor(K){super(K)}load(K,oe,de,ye){K===void 0&&(K=""),this.path!==void 0&&(K=this.path+K),K=this.manager.resolveURL(K);const Ie=ph.get(K);if(Ie!==void 0)return this.manager.itemStart(K),setTimeout(()=>{oe&&oe(Ie),this.manager.itemEnd(K)},0),Ie;if(Ah[K]!==void 0){Ah[K].push({onLoad:oe,onProgress:de,onError:ye});return}Ah[K]=[],Ah[K].push({onLoad:oe,onProgress:de,onError:ye});const Ue=new Request(K,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),He=this.mimeType,Ke=this.responseType;fetch(Ue).then(Ze=>{if(Ze.status===200||Ze.status===0){if(Ze.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||Ze.body===void 0||Ze.body.getReader===void 0)return Ze;const at=Ah[K],mt=Ze.body.getReader(),vt=Ze.headers.get("X-File-Size")||Ze.headers.get("Content-Length"),St=vt?parseInt(vt):0,Lt=St!==0;let Ht=0;const Dt=new ReadableStream({start(bt){tn();function tn(){mt.read().then(({done:Zt,value:qt})=>{if(Zt)bt.close();else{Ht+=qt.byteLength;const Un=new ProgressEvent("progress",{lengthComputable:Lt,loaded:Ht,total:St});for(let _n=0,bn=at.length;_n<bn;_n++){const Fn=at[_n];Fn.onProgress&&Fn.onProgress(Un)}bt.enqueue(qt),tn()}})}}});return new Response(Dt)}else throw new J3(`fetch for "${Ze.url}" responded with ${Ze.status}: ${Ze.statusText}`,Ze)}).then(Ze=>{switch(Ke){case"arraybuffer":return Ze.arrayBuffer();case"blob":return Ze.blob();case"document":return Ze.text().then(at=>new DOMParser().parseFromString(at,He));case"json":return Ze.json();default:if(He===void 0)return Ze.text();{const mt=/charset="?([^;"\s]*)"?/i.exec(He),vt=mt&&mt[1]?mt[1].toLowerCase():void 0,St=new TextDecoder(vt);return Ze.arrayBuffer().then(Lt=>St.decode(Lt))}}}).then(Ze=>{ph.add(K,Ze);const at=Ah[K];delete Ah[K];for(let mt=0,vt=at.length;mt<vt;mt++){const St=at[mt];St.onLoad&&St.onLoad(Ze)}}).catch(Ze=>{const at=Ah[K];if(at===void 0)throw this.manager.itemError(K),Ze;delete Ah[K];for(let mt=0,vt=at.length;mt<vt;mt++){const St=at[mt];St.onError&&St.onError(Ze)}this.manager.itemError(K)}).finally(()=>{this.manager.itemEnd(K)}),this.manager.itemStart(K)}setResponseType(K){return this.responseType=K,this}setMimeType(K){return this.mimeType=K,this}}class Z3 extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=this,Ue=new mh(this.manager);Ue.setPath(this.path),Ue.setRequestHeader(this.requestHeader),Ue.setWithCredentials(this.withCredentials),Ue.load(K,function(He){try{oe(Ie.parse(JSON.parse(He)))}catch(Ke){ye?ye(Ke):console.error(Ke),Ie.manager.itemError(K)}},de,ye)}parse(K){const oe=[];for(let de=0;de<K.length;de++){const ye=Op.parse(K[de]);oe.push(ye)}return oe}}class j3 extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=this,Ue=[],He=new oA,Ke=new mh(this.manager);Ke.setPath(this.path),Ke.setResponseType("arraybuffer"),Ke.setRequestHeader(this.requestHeader),Ke.setWithCredentials(Ie.withCredentials);let Ze=0;function at(mt){Ke.load(K[mt],function(vt){const St=Ie.parse(vt,!0);Ue[mt]={width:St.width,height:St.height,format:St.format,mipmaps:St.mipmaps},Ze+=1,Ze===6&&(St.mipmapCount===1&&(He.minFilter=Jr),He.image=Ue,He.format=St.format,He.needsUpdate=!0,oe&&oe(He))},de,ye)}if(Array.isArray(K))for(let mt=0,vt=K.length;mt<vt;++mt)at(mt);else Ke.load(K,function(mt){const vt=Ie.parse(mt,!0);if(vt.isCubemap){const St=vt.mipmaps.length/vt.mipmapCount;for(let Lt=0;Lt<St;Lt++){Ue[Lt]={mipmaps:[]};for(let Ht=0;Ht<vt.mipmapCount;Ht++)Ue[Lt].mipmaps.push(vt.mipmaps[Lt*vt.mipmapCount+Ht]),Ue[Lt].format=vt.format,Ue[Lt].width=vt.width,Ue[Lt].height=vt.height}He.image=Ue}else He.image.width=vt.width,He.image.height=vt.height,He.mipmaps=vt.mipmaps;vt.mipmapCount===1&&(He.minFilter=Jr),He.format=vt.format,He.needsUpdate=!0,oe&&oe(He)},de,ye);return He}}class Np extends rc{constructor(K){super(K)}load(K,oe,de,ye){this.path!==void 0&&(K=this.path+K),K=this.manager.resolveURL(K);const Ie=this,Ue=ph.get(K);if(Ue!==void 0)return Ie.manager.itemStart(K),setTimeout(function(){oe&&oe(Ue),Ie.manager.itemEnd(K)},0),Ue;const He=cc("img");function Ke(){at(),ph.add(K,this),oe&&oe(this),Ie.manager.itemEnd(K)}function Ze(mt){at(),ye&&ye(mt),Ie.manager.itemError(K),Ie.manager.itemEnd(K)}function at(){He.removeEventListener("load",Ke,!1),He.removeEventListener("error",Ze,!1)}return He.addEventListener("load",Ke,!1),He.addEventListener("error",Ze,!1),K.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(He.crossOrigin=this.crossOrigin),Ie.manager.itemStart(K),He.src=K,He}}class ev extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=new ba;Ie.colorSpace=lo;const Ue=new Np(this.manager);Ue.setCrossOrigin(this.crossOrigin),Ue.setPath(this.path);let He=0;function Ke(Ze){Ue.load(K[Ze],function(at){Ie.images[Ze]=at,He++,He===6&&(Ie.needsUpdate=!0,oe&&oe(Ie))},void 0,ye)}for(let Ze=0;Ze<K.length;++Ze)Ke(Ze);return Ie}}class tv extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=this,Ue=new hd,He=new mh(this.manager);return He.setResponseType("arraybuffer"),He.setRequestHeader(this.requestHeader),He.setPath(this.path),He.setWithCredentials(Ie.withCredentials),He.load(K,function(Ke){let Ze;try{Ze=Ie.parse(Ke)}catch(at){if(ye!==void 0)ye(at);else{console.error(at);return}}Ze.image!==void 0?Ue.image=Ze.image:Ze.data!==void 0&&(Ue.image.width=Ze.width,Ue.image.height=Ze.height,Ue.image.data=Ze.data),Ue.wrapS=Ze.wrapS!==void 0?Ze.wrapS:yn,Ue.wrapT=Ze.wrapT!==void 0?Ze.wrapT:yn,Ue.magFilter=Ze.magFilter!==void 0?Ze.magFilter:Jr,Ue.minFilter=Ze.minFilter!==void 0?Ze.minFilter:Jr,Ue.anisotropy=Ze.anisotropy!==void 0?Ze.anisotropy:1,Ze.colorSpace!==void 0&&(Ue.colorSpace=Ze.colorSpace),Ze.flipY!==void 0&&(Ue.flipY=Ze.flipY),Ze.format!==void 0&&(Ue.format=Ze.format),Ze.type!==void 0&&(Ue.type=Ze.type),Ze.mipmaps!==void 0&&(Ue.mipmaps=Ze.mipmaps,Ue.minFilter=Qs),Ze.mipmapCount===1&&(Ue.minFilter=Jr),Ze.generateMipmaps!==void 0&&(Ue.generateMipmaps=Ze.generateMipmaps),Ue.needsUpdate=!0,oe&&oe(Ue,Ze)},de,ye),Ue}}class nv extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=new Fo,Ue=new Np(this.manager);return Ue.setCrossOrigin(this.crossOrigin),Ue.setPath(this.path),Ue.load(K,function(He){Ie.image=He,Ie.needsUpdate=!0,oe!==void 0&&oe(Ie)},de,ye),Ie}}class Ad extends uo{constructor(K,oe=1){super(),this.isLight=!0,this.type="Light",this.color=new Wr(K),this.intensity=oe}dispose(){}copy(K,oe){return super.copy(K,oe),this.color.copy(K.color),this.intensity=K.intensity,this}toJSON(K){const oe=super.toJSON(K);return oe.object.color=this.color.getHex(),oe.object.intensity=this.intensity,this.groundColor!==void 0&&(oe.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(oe.object.distance=this.distance),this.angle!==void 0&&(oe.object.angle=this.angle),this.decay!==void 0&&(oe.object.decay=this.decay),this.penumbra!==void 0&&(oe.object.penumbra=this.penumbra),this.shadow!==void 0&&(oe.object.shadow=this.shadow.toJSON()),oe}}class $m extends Ad{constructor(K,oe,de){super(K,de),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(uo.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Wr(oe)}copy(K,oe){return super.copy(K,oe),this.groundColor.copy(K.groundColor),this}}const g2=new kr,Xm=new vn,Km=new vn;class v2{constructor(K){this.camera=K,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new qi(512,512),this.map=null,this.mapPass=null,this.matrix=new kr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Cc,this._frameExtents=new qi(1,1),this._viewportCount=1,this._viewports=[new go(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(K){const oe=this.camera,de=this.matrix;Xm.setFromMatrixPosition(K.matrixWorld),oe.position.copy(Xm),Km.setFromMatrixPosition(K.target.matrixWorld),oe.lookAt(Km),oe.updateMatrixWorld(),g2.multiplyMatrices(oe.projectionMatrix,oe.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g2),de.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),de.multiply(g2)}getViewport(K){return this._viewports[K]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(K){return this.camera=K.camera.clone(),this.bias=K.bias,this.radius=K.radius,this.mapSize.copy(K.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const K={};return this.bias!==0&&(K.bias=this.bias),this.normalBias!==0&&(K.normalBias=this.normalBias),this.radius!==1&&(K.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(K.mapSize=this.mapSize.toArray()),K.camera=this.camera.toJSON(!1).object,delete K.camera.matrix,K}}class iv extends v2{constructor(){super(new jo(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(K){const oe=this.camera,de=ac*2*K.angle*this.focus,ye=this.mapSize.width/this.mapSize.height,Ie=K.distance||oe.far;(de!==oe.fov||ye!==oe.aspect||Ie!==oe.far)&&(oe.fov=de,oe.aspect=ye,oe.far=Ie,oe.updateProjectionMatrix()),super.updateMatrices(K)}copy(K){return super.copy(K),this.focus=K.focus,this}}class Ym extends Ad{constructor(K,oe,de=0,ye=Math.PI/3,Ie=0,Ue=2){super(K,oe),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(uo.DEFAULT_UP),this.updateMatrix(),this.target=new uo,this.distance=de,this.angle=ye,this.penumbra=Ie,this.decay=Ue,this.map=null,this.shadow=new iv}get power(){return this.intensity*Math.PI}set power(K){this.intensity=K/Math.PI}dispose(){this.shadow.dispose()}copy(K,oe){return super.copy(K,oe),this.distance=K.distance,this.angle=K.angle,this.penumbra=K.penumbra,this.decay=K.decay,this.target=K.target.clone(),this.shadow=K.shadow.clone(),this}}const qm=new kr,Up=new vn,E2=new vn;class rv extends v2{constructor(){super(new jo(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new qi(4,2),this._viewportCount=6,this._viewports=[new go(2,1,1,1),new go(0,1,1,1),new go(3,1,1,1),new go(1,1,1,1),new go(3,0,1,1),new go(1,0,1,1)],this._cubeDirections=[new vn(1,0,0),new vn(-1,0,0),new vn(0,0,1),new vn(0,0,-1),new vn(0,1,0),new vn(0,-1,0)],this._cubeUps=[new vn(0,1,0),new vn(0,1,0),new vn(0,1,0),new vn(0,1,0),new vn(0,0,1),new vn(0,0,-1)]}updateMatrices(K,oe=0){const de=this.camera,ye=this.matrix,Ie=K.distance||de.far;Ie!==de.far&&(de.far=Ie,de.updateProjectionMatrix()),Up.setFromMatrixPosition(K.matrixWorld),de.position.copy(Up),E2.copy(de.position),E2.add(this._cubeDirections[oe]),de.up.copy(this._cubeUps[oe]),de.lookAt(E2),de.updateMatrixWorld(),ye.makeTranslation(-Up.x,-Up.y,-Up.z),qm.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qm)}}class Jm extends Ad{constructor(K,oe,de=0,ye=2){super(K,oe),this.isPointLight=!0,this.type="PointLight",this.distance=de,this.decay=ye,this.shadow=new rv}get power(){return this.intensity*4*Math.PI}set power(K){this.intensity=K/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(K,oe){return super.copy(K,oe),this.distance=K.distance,this.decay=K.decay,this.shadow=K.shadow.clone(),this}}class sv extends v2{constructor(){super(new sh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Zm extends Ad{constructor(K,oe){super(K,oe),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(uo.DEFAULT_UP),this.updateMatrix(),this.target=new uo,this.shadow=new sv}dispose(){this.shadow.dispose()}copy(K){return super.copy(K),this.target=K.target.clone(),this.shadow=K.shadow.clone(),this}}class jm extends Ad{constructor(K,oe){super(K,oe),this.isAmbientLight=!0,this.type="AmbientLight"}}class eg extends Ad{constructor(K,oe,de=10,ye=10){super(K,oe),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=de,this.height=ye}get power(){return this.intensity*this.width*this.height*Math.PI}set power(K){this.intensity=K/(this.width*this.height*Math.PI)}copy(K){return super.copy(K),this.width=K.width,this.height=K.height,this}toJSON(K){const oe=super.toJSON(K);return oe.object.width=this.width,oe.object.height=this.height,oe}}class tg{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let K=0;K<9;K++)this.coefficients.push(new vn)}set(K){for(let oe=0;oe<9;oe++)this.coefficients[oe].copy(K[oe]);return this}zero(){for(let K=0;K<9;K++)this.coefficients[K].set(0,0,0);return this}getAt(K,oe){const de=K.x,ye=K.y,Ie=K.z,Ue=this.coefficients;return oe.copy(Ue[0]).multiplyScalar(.282095),oe.addScaledVector(Ue[1],.488603*ye),oe.addScaledVector(Ue[2],.488603*Ie),oe.addScaledVector(Ue[3],.488603*de),oe.addScaledVector(Ue[4],1.092548*(de*ye)),oe.addScaledVector(Ue[5],1.092548*(ye*Ie)),oe.addScaledVector(Ue[6],.315392*(3*Ie*Ie-1)),oe.addScaledVector(Ue[7],1.092548*(de*Ie)),oe.addScaledVector(Ue[8],.546274*(de*de-ye*ye)),oe}getIrradianceAt(K,oe){const de=K.x,ye=K.y,Ie=K.z,Ue=this.coefficients;return oe.copy(Ue[0]).multiplyScalar(.886227),oe.addScaledVector(Ue[1],1.023328*ye),oe.addScaledVector(Ue[2],1.023328*Ie),oe.addScaledVector(Ue[3],1.023328*de),oe.addScaledVector(Ue[4],.858086*de*ye),oe.addScaledVector(Ue[5],.858086*ye*Ie),oe.addScaledVector(Ue[6],.743125*Ie*Ie-.247708),oe.addScaledVector(Ue[7],.858086*de*Ie),oe.addScaledVector(Ue[8],.429043*(de*de-ye*ye)),oe}add(K){for(let oe=0;oe<9;oe++)this.coefficients[oe].add(K.coefficients[oe]);return this}addScaledSH(K,oe){for(let de=0;de<9;de++)this.coefficients[de].addScaledVector(K.coefficients[de],oe);return this}scale(K){for(let oe=0;oe<9;oe++)this.coefficients[oe].multiplyScalar(K);return this}lerp(K,oe){for(let de=0;de<9;de++)this.coefficients[de].lerp(K.coefficients[de],oe);return this}equals(K){for(let oe=0;oe<9;oe++)if(!this.coefficients[oe].equals(K.coefficients[oe]))return!1;return!0}copy(K){return this.set(K.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(K,oe=0){const de=this.coefficients;for(let ye=0;ye<9;ye++)de[ye].fromArray(K,oe+ye*3);return this}toArray(K=[],oe=0){const de=this.coefficients;for(let ye=0;ye<9;ye++)de[ye].toArray(K,oe+ye*3);return K}static getBasisAt(K,oe){const de=K.x,ye=K.y,Ie=K.z;oe[0]=.282095,oe[1]=.488603*ye,oe[2]=.488603*Ie,oe[3]=.488603*de,oe[4]=1.092548*de*ye,oe[5]=1.092548*ye*Ie,oe[6]=.315392*(3*Ie*Ie-1),oe[7]=1.092548*de*Ie,oe[8]=.546274*(de*de-ye*ye)}}class ng extends Ad{constructor(K=new tg,oe=1){super(void 0,oe),this.isLightProbe=!0,this.sh=K}copy(K){return super.copy(K),this.sh.copy(K.sh),this}fromJSON(K){return this.intensity=K.intensity,this.sh.fromArray(K.sh),this}toJSON(K){const oe=super.toJSON(K);return oe.object.sh=this.sh.toArray(),oe}}class TA extends rc{constructor(K){super(K),this.textures={}}load(K,oe,de,ye){const Ie=this,Ue=new mh(Ie.manager);Ue.setPath(Ie.path),Ue.setRequestHeader(Ie.requestHeader),Ue.setWithCredentials(Ie.withCredentials),Ue.load(K,function(He){try{oe(Ie.parse(JSON.parse(He)))}catch(Ke){ye?ye(Ke):console.error(Ke),Ie.manager.itemError(K)}},de,ye)}parse(K){const oe=this.textures;function de(Ie){return oe[Ie]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",Ie),oe[Ie]}const ye=TA.createMaterialFromType(K.type);if(K.uuid!==void 0&&(ye.uuid=K.uuid),K.name!==void 0&&(ye.name=K.name),K.color!==void 0&&ye.color!==void 0&&ye.color.setHex(K.color),K.roughness!==void 0&&(ye.roughness=K.roughness),K.metalness!==void 0&&(ye.metalness=K.metalness),K.sheen!==void 0&&(ye.sheen=K.sheen),K.sheenColor!==void 0&&(ye.sheenColor=new Wr().setHex(K.sheenColor)),K.sheenRoughness!==void 0&&(ye.sheenRoughness=K.sheenRoughness),K.emissive!==void 0&&ye.emissive!==void 0&&ye.emissive.setHex(K.emissive),K.specular!==void 0&&ye.specular!==void 0&&ye.specular.setHex(K.specular),K.specularIntensity!==void 0&&(ye.specularIntensity=K.specularIntensity),K.specularColor!==void 0&&ye.specularColor!==void 0&&ye.specularColor.setHex(K.specularColor),K.shininess!==void 0&&(ye.shininess=K.shininess),K.clearcoat!==void 0&&(ye.clearcoat=K.clearcoat),K.clearcoatRoughness!==void 0&&(ye.clearcoatRoughness=K.clearcoatRoughness),K.dispersion!==void 0&&(ye.dispersion=K.dispersion),K.iridescence!==void 0&&(ye.iridescence=K.iridescence),K.iridescenceIOR!==void 0&&(ye.iridescenceIOR=K.iridescenceIOR),K.iridescenceThicknessRange!==void 0&&(ye.iridescenceThicknessRange=K.iridescenceThicknessRange),K.transmission!==void 0&&(ye.transmission=K.transmission),K.thickness!==void 0&&(ye.thickness=K.thickness),K.attenuationDistance!==void 0&&(ye.attenuationDistance=K.attenuationDistance),K.attenuationColor!==void 0&&ye.attenuationColor!==void 0&&ye.attenuationColor.setHex(K.attenuationColor),K.anisotropy!==void 0&&(ye.anisotropy=K.anisotropy),K.anisotropyRotation!==void 0&&(ye.anisotropyRotation=K.anisotropyRotation),K.fog!==void 0&&(ye.fog=K.fog),K.flatShading!==void 0&&(ye.flatShading=K.flatShading),K.blending!==void 0&&(ye.blending=K.blending),K.combine!==void 0&&(ye.combine=K.combine),K.side!==void 0&&(ye.side=K.side),K.shadowSide!==void 0&&(ye.shadowSide=K.shadowSide),K.opacity!==void 0&&(ye.opacity=K.opacity),K.transparent!==void 0&&(ye.transparent=K.transparent),K.alphaTest!==void 0&&(ye.alphaTest=K.alphaTest),K.alphaHash!==void 0&&(ye.alphaHash=K.alphaHash),K.depthFunc!==void 0&&(ye.depthFunc=K.depthFunc),K.depthTest!==void 0&&(ye.depthTest=K.depthTest),K.depthWrite!==void 0&&(ye.depthWrite=K.depthWrite),K.colorWrite!==void 0&&(ye.colorWrite=K.colorWrite),K.blendSrc!==void 0&&(ye.blendSrc=K.blendSrc),K.blendDst!==void 0&&(ye.blendDst=K.blendDst),K.blendEquation!==void 0&&(ye.blendEquation=K.blendEquation),K.blendSrcAlpha!==void 0&&(ye.blendSrcAlpha=K.blendSrcAlpha),K.blendDstAlpha!==void 0&&(ye.blendDstAlpha=K.blendDstAlpha),K.blendEquationAlpha!==void 0&&(ye.blendEquationAlpha=K.blendEquationAlpha),K.blendColor!==void 0&&ye.blendColor!==void 0&&ye.blendColor.setHex(K.blendColor),K.blendAlpha!==void 0&&(ye.blendAlpha=K.blendAlpha),K.stencilWriteMask!==void 0&&(ye.stencilWriteMask=K.stencilWriteMask),K.stencilFunc!==void 0&&(ye.stencilFunc=K.stencilFunc),K.stencilRef!==void 0&&(ye.stencilRef=K.stencilRef),K.stencilFuncMask!==void 0&&(ye.stencilFuncMask=K.stencilFuncMask),K.stencilFail!==void 0&&(ye.stencilFail=K.stencilFail),K.stencilZFail!==void 0&&(ye.stencilZFail=K.stencilZFail),K.stencilZPass!==void 0&&(ye.stencilZPass=K.stencilZPass),K.stencilWrite!==void 0&&(ye.stencilWrite=K.stencilWrite),K.wireframe!==void 0&&(ye.wireframe=K.wireframe),K.wireframeLinewidth!==void 0&&(ye.wireframeLinewidth=K.wireframeLinewidth),K.wireframeLinecap!==void 0&&(ye.wireframeLinecap=K.wireframeLinecap),K.wireframeLinejoin!==void 0&&(ye.wireframeLinejoin=K.wireframeLinejoin),K.rotation!==void 0&&(ye.rotation=K.rotation),K.linewidth!==void 0&&(ye.linewidth=K.linewidth),K.dashSize!==void 0&&(ye.dashSize=K.dashSize),K.gapSize!==void 0&&(ye.gapSize=K.gapSize),K.scale!==void 0&&(ye.scale=K.scale),K.polygonOffset!==void 0&&(ye.polygonOffset=K.polygonOffset),K.polygonOffsetFactor!==void 0&&(ye.polygonOffsetFactor=K.polygonOffsetFactor),K.polygonOffsetUnits!==void 0&&(ye.polygonOffsetUnits=K.polygonOffsetUnits),K.dithering!==void 0&&(ye.dithering=K.dithering),K.alphaToCoverage!==void 0&&(ye.alphaToCoverage=K.alphaToCoverage),K.premultipliedAlpha!==void 0&&(ye.premultipliedAlpha=K.premultipliedAlpha),K.forceSinglePass!==void 0&&(ye.forceSinglePass=K.forceSinglePass),K.visible!==void 0&&(ye.visible=K.visible),K.toneMapped!==void 0&&(ye.toneMapped=K.toneMapped),K.userData!==void 0&&(ye.userData=K.userData),K.vertexColors!==void 0&&(typeof K.vertexColors=="number"?ye.vertexColors=K.vertexColors>0:ye.vertexColors=K.vertexColors),K.uniforms!==void 0)for(const Ie in K.uniforms){const Ue=K.uniforms[Ie];switch(ye.uniforms[Ie]={},Ue.type){case"t":ye.uniforms[Ie].value=de(Ue.value);break;case"c":ye.uniforms[Ie].value=new Wr().setHex(Ue.value);break;case"v2":ye.uniforms[Ie].value=new qi().fromArray(Ue.value);break;case"v3":ye.uniforms[Ie].value=new vn().fromArray(Ue.value);break;case"v4":ye.uniforms[Ie].value=new go().fromArray(Ue.value);break;case"m3":ye.uniforms[Ie].value=new gs().fromArray(Ue.value);break;case"m4":ye.uniforms[Ie].value=new kr().fromArray(Ue.value);break;default:ye.uniforms[Ie].value=Ue.value}}if(K.defines!==void 0&&(ye.defines=K.defines),K.vertexShader!==void 0&&(ye.vertexShader=K.vertexShader),K.fragmentShader!==void 0&&(ye.fragmentShader=K.fragmentShader),K.glslVersion!==void 0&&(ye.glslVersion=K.glslVersion),K.extensions!==void 0)for(const Ie in K.extensions)ye.extensions[Ie]=K.extensions[Ie];if(K.lights!==void 0&&(ye.lights=K.lights),K.clipping!==void 0&&(ye.clipping=K.clipping),K.size!==void 0&&(ye.size=K.size),K.sizeAttenuation!==void 0&&(ye.sizeAttenuation=K.sizeAttenuation),K.map!==void 0&&(ye.map=de(K.map)),K.matcap!==void 0&&(ye.matcap=de(K.matcap)),K.alphaMap!==void 0&&(ye.alphaMap=de(K.alphaMap)),K.bumpMap!==void 0&&(ye.bumpMap=de(K.bumpMap)),K.bumpScale!==void 0&&(ye.bumpScale=K.bumpScale),K.normalMap!==void 0&&(ye.normalMap=de(K.normalMap)),K.normalMapType!==void 0&&(ye.normalMapType=K.normalMapType),K.normalScale!==void 0){let Ie=K.normalScale;Array.isArray(Ie)===!1&&(Ie=[Ie,Ie]),ye.normalScale=new qi().fromArray(Ie)}return K.displacementMap!==void 0&&(ye.displacementMap=de(K.displacementMap)),K.displacementScale!==void 0&&(ye.displacementScale=K.displacementScale),K.displacementBias!==void 0&&(ye.displacementBias=K.displacementBias),K.roughnessMap!==void 0&&(ye.roughnessMap=de(K.roughnessMap)),K.metalnessMap!==void 0&&(ye.metalnessMap=de(K.metalnessMap)),K.emissiveMap!==void 0&&(ye.emissiveMap=de(K.emissiveMap)),K.emissiveIntensity!==void 0&&(ye.emissiveIntensity=K.emissiveIntensity),K.specularMap!==void 0&&(ye.specularMap=de(K.specularMap)),K.specularIntensityMap!==void 0&&(ye.specularIntensityMap=de(K.specularIntensityMap)),K.specularColorMap!==void 0&&(ye.specularColorMap=de(K.specularColorMap)),K.envMap!==void 0&&(ye.envMap=de(K.envMap)),K.envMapRotation!==void 0&&ye.envMapRotation.fromArray(K.envMapRotation),K.envMapIntensity!==void 0&&(ye.envMapIntensity=K.envMapIntensity),K.reflectivity!==void 0&&(ye.reflectivity=K.reflectivity),K.refractionRatio!==void 0&&(ye.refractionRatio=K.refractionRatio),K.lightMap!==void 0&&(ye.lightMap=de(K.lightMap)),K.lightMapIntensity!==void 0&&(ye.lightMapIntensity=K.lightMapIntensity),K.aoMap!==void 0&&(ye.aoMap=de(K.aoMap)),K.aoMapIntensity!==void 0&&(ye.aoMapIntensity=K.aoMapIntensity),K.gradientMap!==void 0&&(ye.gradientMap=de(K.gradientMap)),K.clearcoatMap!==void 0&&(ye.clearcoatMap=de(K.clearcoatMap)),K.clearcoatRoughnessMap!==void 0&&(ye.clearcoatRoughnessMap=de(K.clearcoatRoughnessMap)),K.clearcoatNormalMap!==void 0&&(ye.clearcoatNormalMap=de(K.clearcoatNormalMap)),K.clearcoatNormalScale!==void 0&&(ye.clearcoatNormalScale=new qi().fromArray(K.clearcoatNormalScale)),K.iridescenceMap!==void 0&&(ye.iridescenceMap=de(K.iridescenceMap)),K.iridescenceThicknessMap!==void 0&&(ye.iridescenceThicknessMap=de(K.iridescenceThicknessMap)),K.transmissionMap!==void 0&&(ye.transmissionMap=de(K.transmissionMap)),K.thicknessMap!==void 0&&(ye.thicknessMap=de(K.thicknessMap)),K.anisotropyMap!==void 0&&(ye.anisotropyMap=de(K.anisotropyMap)),K.sheenColorMap!==void 0&&(ye.sheenColorMap=de(K.sheenColorMap)),K.sheenRoughnessMap!==void 0&&(ye.sheenRoughnessMap=de(K.sheenRoughnessMap)),ye}setTextures(K){return this.textures=K,this}static createMaterialFromType(K){const oe={ShadowMaterial:Bm,SpriteMaterial:VA,RawShaderMaterial:Lm,ShaderMaterial:k0,PointsMaterial:JA,MeshPhysicalMaterial:Dm,MeshStandardMaterial:h2,MeshPhongMaterial:Pm,MeshToonMaterial:Fm,MeshNormalMaterial:Om,MeshLambertMaterial:Nm,MeshDepthMaterial:kA,MeshDistanceMaterial:GA,MeshBasicMaterial:Io,MeshMatcapMaterial:Um,LineDashedMaterial:km,LineBasicMaterial:bl,Material:Oo};return new oe[K]}}class _2{static decodeText(K){if(typeof TextDecoder<"u")return new TextDecoder().decode(K);let oe="";for(let de=0,ye=K.length;de<ye;de++)oe+=String.fromCharCode(K[de]);try{return decodeURIComponent(escape(oe))}catch{return oe}}static extractUrlBase(K){const oe=K.lastIndexOf("/");return oe===-1?"./":K.slice(0,oe+1)}static resolveURL(K,oe){return typeof K!="string"||K===""?"":(/^https?:\/\//i.test(oe)&&/^\//.test(K)&&(oe=oe.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(K)||/^data:.*,.*$/i.test(K)||/^blob:.*$/i.test(K)?K:oe+K)}}class ig extends Ds{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(K){return super.copy(K),this.instanceCount=K.instanceCount,this}toJSON(){const K=super.toJSON();return K.instanceCount=this.instanceCount,K.isInstancedBufferGeometry=!0,K}}class rg extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=this,Ue=new mh(Ie.manager);Ue.setPath(Ie.path),Ue.setRequestHeader(Ie.requestHeader),Ue.setWithCredentials(Ie.withCredentials),Ue.load(K,function(He){try{oe(Ie.parse(JSON.parse(He)))}catch(Ke){ye?ye(Ke):console.error(Ke),Ie.manager.itemError(K)}},de,ye)}parse(K){const oe={},de={};function ye(St,Lt){if(oe[Lt]!==void 0)return oe[Lt];const Dt=St.interleavedBuffers[Lt],bt=Ie(St,Dt.buffer),tn=Fl(Dt.type,bt),Zt=new zp(tn,Dt.stride);return Zt.uuid=Dt.uuid,oe[Lt]=Zt,Zt}function Ie(St,Lt){if(de[Lt]!==void 0)return de[Lt];const Dt=St.arrayBuffers[Lt],bt=new Uint32Array(Dt).buffer;return de[Lt]=bt,bt}const Ue=K.isInstancedBufferGeometry?new ig:new Ds,He=K.data.index;if(He!==void 0){const St=Fl(He.type,He.array);Ue.setIndex(new So(St,1))}const Ke=K.data.attributes;for(const St in Ke){const Lt=Ke[St];let Ht;if(Lt.isInterleavedBufferAttribute){const Dt=ye(K.data,Lt.data);Ht=new M1(Dt,Lt.itemSize,Lt.offset,Lt.normalized)}else{const Dt=Fl(Lt.type,Lt.array),bt=Lt.isInstancedBufferAttribute?$f:So;Ht=new bt(Dt,Lt.itemSize,Lt.normalized)}Lt.name!==void 0&&(Ht.name=Lt.name),Lt.usage!==void 0&&Ht.setUsage(Lt.usage),Ue.setAttribute(St,Ht)}const Ze=K.data.morphAttributes;if(Ze)for(const St in Ze){const Lt=Ze[St],Ht=[];for(let Dt=0,bt=Lt.length;Dt<bt;Dt++){const tn=Lt[Dt];let Zt;if(tn.isInterleavedBufferAttribute){const qt=ye(K.data,tn.data);Zt=new M1(qt,tn.itemSize,tn.offset,tn.normalized)}else{const qt=Fl(tn.type,tn.array);Zt=new So(qt,tn.itemSize,tn.normalized)}tn.name!==void 0&&(Zt.name=tn.name),Ht.push(Zt)}Ue.morphAttributes[St]=Ht}K.data.morphTargetsRelative&&(Ue.morphTargetsRelative=!0);const mt=K.data.groups||K.data.drawcalls||K.data.offsets;if(mt!==void 0)for(let St=0,Lt=mt.length;St!==Lt;++St){const Ht=mt[St];Ue.addGroup(Ht.start,Ht.count,Ht.materialIndex)}const vt=K.data.boundingSphere;if(vt!==void 0){const St=new vn;vt.center!==void 0&&St.fromArray(vt.center),Ue.boundingSphere=new la(St,vt.radius)}return K.name&&(Ue.name=K.name),K.userData&&(Ue.userData=K.userData),Ue}}class ov extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=this,Ue=this.path===""?_2.extractUrlBase(K):this.path;this.resourcePath=this.resourcePath||Ue;const He=new mh(this.manager);He.setPath(this.path),He.setRequestHeader(this.requestHeader),He.setWithCredentials(this.withCredentials),He.load(K,function(Ke){let Ze=null;try{Ze=JSON.parse(Ke)}catch(mt){ye!==void 0&&ye(mt),console.error("THREE:ObjectLoader: Can't parse "+K+".",mt.message);return}const at=Ze.metadata;if(at===void 0||at.type===void 0||at.type.toLowerCase()==="geometry"){ye!==void 0&&ye(new Error("THREE.ObjectLoader: Can't load "+K)),console.error("THREE.ObjectLoader: Can't load "+K);return}Ie.parse(Ze,oe)},de,ye)}async loadAsync(K,oe){const de=this,ye=this.path===""?_2.extractUrlBase(K):this.path;this.resourcePath=this.resourcePath||ye;const Ie=new mh(this.manager);Ie.setPath(this.path),Ie.setRequestHeader(this.requestHeader),Ie.setWithCredentials(this.withCredentials);const Ue=await Ie.loadAsync(K,oe),He=JSON.parse(Ue),Ke=He.metadata;if(Ke===void 0||Ke.type===void 0||Ke.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+K);return await de.parseAsync(He)}parse(K,oe){const de=this.parseAnimations(K.animations),ye=this.parseShapes(K.shapes),Ie=this.parseGeometries(K.geometries,ye),Ue=this.parseImages(K.images,function(){oe!==void 0&&oe(Ze)}),He=this.parseTextures(K.textures,Ue),Ke=this.parseMaterials(K.materials,He),Ze=this.parseObject(K.object,Ie,Ke,He,de),at=this.parseSkeletons(K.skeletons,Ze);if(this.bindSkeletons(Ze,at),oe!==void 0){let mt=!1;for(const vt in Ue)if(Ue[vt].data instanceof HTMLImageElement){mt=!0;break}mt===!1&&oe(Ze)}return Ze}async parseAsync(K){const oe=this.parseAnimations(K.animations),de=this.parseShapes(K.shapes),ye=this.parseGeometries(K.geometries,de),Ie=await this.parseImagesAsync(K.images),Ue=this.parseTextures(K.textures,Ie),He=this.parseMaterials(K.materials,Ue),Ke=this.parseObject(K.object,ye,He,Ue,oe),Ze=this.parseSkeletons(K.skeletons,Ke);return this.bindSkeletons(Ke,Ze),Ke}parseShapes(K){const oe={};if(K!==void 0)for(let de=0,ye=K.length;de<ye;de++){const Ie=new T1().fromJSON(K[de]);oe[Ie.uuid]=Ie}return oe}parseSkeletons(K,oe){const de={},ye={};if(oe.traverse(function(Ie){Ie.isBone&&(ye[Ie.uuid]=Ie)}),K!==void 0)for(let Ie=0,Ue=K.length;Ie<Ue;Ie++){const He=new qp().fromJSON(K[Ie],ye);de[He.uuid]=He}return de}parseGeometries(K,oe){const de={};if(K!==void 0){const Ie=new rg;for(let Ue=0,He=K.length;Ue<He;Ue++){let Ke;const Ze=K[Ue];switch(Ze.type){case"BufferGeometry":case"InstancedBufferGeometry":Ke=Ie.parse(Ze);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var ye=new THREE.LegacyJSONLoader;Ke=ye.parse(Ze,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:Ze.type in Rm?Ke=Rm[Ze.type].fromJSON(Ze,oe):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${Ze.type}"`)}Ke.uuid=Ze.uuid,Ze.name!==void 0&&(Ke.name=Ze.name),Ze.userData!==void 0&&(Ke.userData=Ze.userData),de[Ze.uuid]=Ke}}return de}parseMaterials(K,oe){const de={},ye={};if(K!==void 0){const Ie=new TA;Ie.setTextures(oe);for(let Ue=0,He=K.length;Ue<He;Ue++){const Ke=K[Ue];de[Ke.uuid]===void 0&&(de[Ke.uuid]=Ie.parse(Ke)),ye[Ke.uuid]=de[Ke.uuid]}}return ye}parseAnimations(K){const oe={};if(K!==void 0)for(let de=0;de<K.length;de++){const ye=K[de],Ie=Op.parse(ye);oe[Ie.uuid]=Ie}return oe}parseImages(K,oe){const de=this,ye={};let Ie;function Ue(Ke){return de.manager.itemStart(Ke),Ie.load(Ke,function(){de.manager.itemEnd(Ke)},void 0,function(){de.manager.itemError(Ke),de.manager.itemEnd(Ke)})}function He(Ke){if(typeof Ke=="string"){const Ze=Ke,at=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Ze)?Ze:de.resourcePath+Ze;return Ue(at)}else return Ke.data?{data:Fl(Ke.type,Ke.data),width:Ke.width,height:Ke.height}:null}if(K!==void 0&&K.length>0){const Ke=new m2(oe);Ie=new Np(Ke),Ie.setCrossOrigin(this.crossOrigin);for(let Ze=0,at=K.length;Ze<at;Ze++){const mt=K[Ze],vt=mt.url;if(Array.isArray(vt)){const St=[];for(let Lt=0,Ht=vt.length;Lt<Ht;Lt++){const Dt=vt[Lt],bt=He(Dt);bt!==null&&(bt instanceof HTMLImageElement?St.push(bt):St.push(new hd(bt.data,bt.width,bt.height)))}ye[mt.uuid]=new Wo(St)}else{const St=He(mt.url);ye[mt.uuid]=new Wo(St)}}}return ye}async parseImagesAsync(K){const oe=this,de={};let ye;async function Ie(Ue){if(typeof Ue=="string"){const He=Ue,Ke=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(He)?He:oe.resourcePath+He;return await ye.loadAsync(Ke)}else return Ue.data?{data:Fl(Ue.type,Ue.data),width:Ue.width,height:Ue.height}:null}if(K!==void 0&&K.length>0){ye=new Np(this.manager),ye.setCrossOrigin(this.crossOrigin);for(let Ue=0,He=K.length;Ue<He;Ue++){const Ke=K[Ue],Ze=Ke.url;if(Array.isArray(Ze)){const at=[];for(let mt=0,vt=Ze.length;mt<vt;mt++){const St=Ze[mt],Lt=await Ie(St);Lt!==null&&(Lt instanceof HTMLImageElement?at.push(Lt):at.push(new hd(Lt.data,Lt.width,Lt.height)))}de[Ke.uuid]=new Wo(at)}else{const at=await Ie(Ke.url);de[Ke.uuid]=new Wo(at)}}}return de}parseTextures(K,oe){function de(Ie,Ue){return typeof Ie=="number"?Ie:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",Ie),Ue[Ie])}const ye={};if(K!==void 0)for(let Ie=0,Ue=K.length;Ie<Ue;Ie++){const He=K[Ie];He.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',He.uuid),oe[He.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",He.image);const Ke=oe[He.image],Ze=Ke.data;let at;Array.isArray(Ze)?(at=new ba,Ze.length===6&&(at.needsUpdate=!0)):(Ze&&Ze.data?at=new hd:at=new Fo,Ze&&(at.needsUpdate=!0)),at.source=Ke,at.uuid=He.uuid,He.name!==void 0&&(at.name=He.name),He.mapping!==void 0&&(at.mapping=de(He.mapping,av)),He.channel!==void 0&&(at.channel=He.channel),He.offset!==void 0&&at.offset.fromArray(He.offset),He.repeat!==void 0&&at.repeat.fromArray(He.repeat),He.center!==void 0&&at.center.fromArray(He.center),He.rotation!==void 0&&(at.rotation=He.rotation),He.wrap!==void 0&&(at.wrapS=de(He.wrap[0],sg),at.wrapT=de(He.wrap[1],sg)),He.format!==void 0&&(at.format=He.format),He.internalFormat!==void 0&&(at.internalFormat=He.internalFormat),He.type!==void 0&&(at.type=He.type),He.colorSpace!==void 0&&(at.colorSpace=He.colorSpace),He.minFilter!==void 0&&(at.minFilter=de(He.minFilter,og)),He.magFilter!==void 0&&(at.magFilter=de(He.magFilter,og)),He.anisotropy!==void 0&&(at.anisotropy=He.anisotropy),He.flipY!==void 0&&(at.flipY=He.flipY),He.generateMipmaps!==void 0&&(at.generateMipmaps=He.generateMipmaps),He.premultiplyAlpha!==void 0&&(at.premultiplyAlpha=He.premultiplyAlpha),He.unpackAlignment!==void 0&&(at.unpackAlignment=He.unpackAlignment),He.compareFunction!==void 0&&(at.compareFunction=He.compareFunction),He.userData!==void 0&&(at.userData=He.userData),ye[He.uuid]=at}return ye}parseObject(K,oe,de,ye,Ie){let Ue;function He(vt){return oe[vt]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",vt),oe[vt]}function Ke(vt){if(vt!==void 0){if(Array.isArray(vt)){const St=[];for(let Lt=0,Ht=vt.length;Lt<Ht;Lt++){const Dt=vt[Lt];de[Dt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Dt),St.push(de[Dt])}return St}return de[vt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",vt),de[vt]}}function Ze(vt){return ye[vt]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",vt),ye[vt]}let at,mt;switch(K.type){case"Scene":Ue=new G2,K.background!==void 0&&(Number.isInteger(K.background)?Ue.background=new Wr(K.background):Ue.background=Ze(K.background)),K.environment!==void 0&&(Ue.environment=Ze(K.environment)),K.fog!==void 0&&(K.fog.type==="Fog"?Ue.fog=new Vp(K.fog.color,K.fog.near,K.fog.far):K.fog.type==="FogExp2"&&(Ue.fog=new Hp(K.fog.color,K.fog.density)),K.fog.name!==""&&(Ue.fog.name=K.fog.name)),K.backgroundBlurriness!==void 0&&(Ue.backgroundBlurriness=K.backgroundBlurriness),K.backgroundIntensity!==void 0&&(Ue.backgroundIntensity=K.backgroundIntensity),K.backgroundRotation!==void 0&&Ue.backgroundRotation.fromArray(K.backgroundRotation),K.environmentIntensity!==void 0&&(Ue.environmentIntensity=K.environmentIntensity),K.environmentRotation!==void 0&&Ue.environmentRotation.fromArray(K.environmentRotation);break;case"PerspectiveCamera":Ue=new jo(K.fov,K.aspect,K.near,K.far),K.focus!==void 0&&(Ue.focus=K.focus),K.zoom!==void 0&&(Ue.zoom=K.zoom),K.filmGauge!==void 0&&(Ue.filmGauge=K.filmGauge),K.filmOffset!==void 0&&(Ue.filmOffset=K.filmOffset),K.view!==void 0&&(Ue.view=Object.assign({},K.view));break;case"OrthographicCamera":Ue=new sh(K.left,K.right,K.top,K.bottom,K.near,K.far),K.zoom!==void 0&&(Ue.zoom=K.zoom),K.view!==void 0&&(Ue.view=Object.assign({},K.view));break;case"AmbientLight":Ue=new jm(K.color,K.intensity);break;case"DirectionalLight":Ue=new Zm(K.color,K.intensity);break;case"PointLight":Ue=new Jm(K.color,K.intensity,K.distance,K.decay);break;case"RectAreaLight":Ue=new eg(K.color,K.intensity,K.width,K.height);break;case"SpotLight":Ue=new Ym(K.color,K.intensity,K.distance,K.angle,K.penumbra,K.decay);break;case"HemisphereLight":Ue=new $m(K.color,K.groundColor,K.intensity);break;case"LightProbe":Ue=new ng().fromJSON(K);break;case"SkinnedMesh":at=He(K.geometry),mt=Ke(K.material),Ue=new Z2(at,mt),K.bindMode!==void 0&&(Ue.bindMode=K.bindMode),K.bindMatrix!==void 0&&Ue.bindMatrix.fromArray(K.bindMatrix),K.skeleton!==void 0&&(Ue.skeleton=K.skeleton);break;case"Mesh":at=He(K.geometry),mt=Ke(K.material),Ue=new Zo(at,mt);break;case"InstancedMesh":at=He(K.geometry),mt=Ke(K.material);const vt=K.count,St=K.instanceMatrix,Lt=K.instanceColor;Ue=new nm(at,mt,vt),Ue.instanceMatrix=new $f(new Float32Array(St.array),16),Lt!==void 0&&(Ue.instanceColor=new $f(new Float32Array(Lt.array),Lt.itemSize));break;case"BatchedMesh":at=He(K.geometry),mt=Ke(K.material),Ue=new sm(K.maxGeometryCount,K.maxVertexCount,K.maxIndexCount,mt),Ue.geometry=at,Ue.perObjectFrustumCulled=K.perObjectFrustumCulled,Ue.sortObjects=K.sortObjects,Ue._drawRanges=K.drawRanges,Ue._reservedRanges=K.reservedRanges,Ue._visibility=K.visibility,Ue._active=K.active,Ue._bounds=K.bounds.map(Ht=>{const Dt=new Rs;Dt.min.fromArray(Ht.boxMin),Dt.max.fromArray(Ht.boxMax);const bt=new la;return bt.radius=Ht.sphereRadius,bt.center.fromArray(Ht.sphereCenter),{boxInitialized:Ht.boxInitialized,box:Dt,sphereInitialized:Ht.sphereInitialized,sphere:bt}}),Ue._maxGeometryCount=K.maxGeometryCount,Ue._maxVertexCount=K.maxVertexCount,Ue._maxIndexCount=K.maxIndexCount,Ue._geometryInitialized=K.geometryInitialized,Ue._geometryCount=K.geometryCount,Ue._matricesTexture=Ze(K.matricesTexture.uuid);break;case"LOD":Ue=new $2;break;case"Line":Ue=new fd(He(K.geometry),Ke(K.material));break;case"LineLoop":Ue=new um(He(K.geometry),Ke(K.material));break;case"LineSegments":Ue=new Fu(He(K.geometry),Ke(K.material));break;case"PointCloud":case"Points":Ue=new dm(He(K.geometry),Ke(K.material));break;case"Sprite":Ue=new z2(Ke(K.material));break;case"Group":Ue=new w1;break;case"Bone":Ue=new XA;break;default:Ue=new uo}if(Ue.uuid=K.uuid,K.name!==void 0&&(Ue.name=K.name),K.matrix!==void 0?(Ue.matrix.fromArray(K.matrix),K.matrixAutoUpdate!==void 0&&(Ue.matrixAutoUpdate=K.matrixAutoUpdate),Ue.matrixAutoUpdate&&Ue.matrix.decompose(Ue.position,Ue.quaternion,Ue.scale)):(K.position!==void 0&&Ue.position.fromArray(K.position),K.rotation!==void 0&&Ue.rotation.fromArray(K.rotation),K.quaternion!==void 0&&Ue.quaternion.fromArray(K.quaternion),K.scale!==void 0&&Ue.scale.fromArray(K.scale)),K.up!==void 0&&Ue.up.fromArray(K.up),K.castShadow!==void 0&&(Ue.castShadow=K.castShadow),K.receiveShadow!==void 0&&(Ue.receiveShadow=K.receiveShadow),K.shadow&&(K.shadow.bias!==void 0&&(Ue.shadow.bias=K.shadow.bias),K.shadow.normalBias!==void 0&&(Ue.shadow.normalBias=K.shadow.normalBias),K.shadow.radius!==void 0&&(Ue.shadow.radius=K.shadow.radius),K.shadow.mapSize!==void 0&&Ue.shadow.mapSize.fromArray(K.shadow.mapSize),K.shadow.camera!==void 0&&(Ue.shadow.camera=this.parseObject(K.shadow.camera))),K.visible!==void 0&&(Ue.visible=K.visible),K.frustumCulled!==void 0&&(Ue.frustumCulled=K.frustumCulled),K.renderOrder!==void 0&&(Ue.renderOrder=K.renderOrder),K.userData!==void 0&&(Ue.userData=K.userData),K.layers!==void 0&&(Ue.layers.mask=K.layers),K.children!==void 0){const vt=K.children;for(let St=0;St<vt.length;St++)Ue.add(this.parseObject(vt[St],oe,de,ye,Ie))}if(K.animations!==void 0){const vt=K.animations;for(let St=0;St<vt.length;St++){const Lt=vt[St];Ue.animations.push(Ie[Lt])}}if(K.type==="LOD"){K.autoUpdate!==void 0&&(Ue.autoUpdate=K.autoUpdate);const vt=K.levels;for(let St=0;St<vt.length;St++){const Lt=vt[St],Ht=Ue.getObjectByProperty("uuid",Lt.object);Ht!==void 0&&Ue.addLevel(Ht,Lt.distance,Lt.hysteresis)}}return Ue}bindSkeletons(K,oe){Object.keys(oe).length!==0&&K.traverse(function(de){if(de.isSkinnedMesh===!0&&de.skeleton!==void 0){const ye=oe[de.skeleton];ye===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",de.skeleton):de.bind(ye,de.bindMatrix)}})}}const av={UVMapping:gn,CubeReflectionMapping:Nt,CubeRefractionMapping:ht,EquirectangularReflectionMapping:ot,EquirectangularRefractionMapping:Vt,CubeUVReflectionMapping:Wt},sg={RepeatWrapping:sn,ClampToEdgeWrapping:yn,MirroredRepeatWrapping:ni},og={NearestFilter:ki,NearestMipmapNearestFilter:Hi,NearestMipmapLinearFilter:Xi,LinearFilter:Jr,LinearMipmapNearestFilter:Ai,LinearMipmapLinearFilter:Qs};class lv extends rc{constructor(K){super(K),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(K){return this.options=K,this}load(K,oe,de,ye){K===void 0&&(K=""),this.path!==void 0&&(K=this.path+K),K=this.manager.resolveURL(K);const Ie=this,Ue=ph.get(K);if(Ue!==void 0){if(Ie.manager.itemStart(K),Ue.then){Ue.then(Ze=>{oe&&oe(Ze),Ie.manager.itemEnd(K)}).catch(Ze=>{ye&&ye(Ze)});return}return setTimeout(function(){oe&&oe(Ue),Ie.manager.itemEnd(K)},0),Ue}const He={};He.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",He.headers=this.requestHeader;const Ke=fetch(K,He).then(function(Ze){return Ze.blob()}).then(function(Ze){return createImageBitmap(Ze,Object.assign(Ie.options,{colorSpaceConversion:"none"}))}).then(function(Ze){return ph.add(K,Ze),oe&&oe(Ze),Ie.manager.itemEnd(K),Ze}).catch(function(Ze){ye&&ye(Ze),ph.remove(K),Ie.manager.itemError(K),Ie.manager.itemEnd(K)});ph.add(K,Ke),Ie.manager.itemStart(K)}}let IA;class y2{static getContext(){return IA===void 0&&(IA=new(window.AudioContext||window.webkitAudioContext)),IA}static setContext(K){IA=K}}class cv extends rc{constructor(K){super(K)}load(K,oe,de,ye){const Ie=this,Ue=new mh(this.manager);Ue.setResponseType("arraybuffer"),Ue.setPath(this.path),Ue.setRequestHeader(this.requestHeader),Ue.setWithCredentials(this.withCredentials),Ue.load(K,function(Ke){try{const Ze=Ke.slice(0);y2.getContext().decodeAudioData(Ze,function(mt){oe(mt)}).catch(He)}catch(Ze){He(Ze)}},de,ye);function He(Ke){ye?ye(Ke):console.error(Ke),Ie.manager.itemError(K)}}}const ag=new kr,lg=new kr,D1=new kr;class uv{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new jo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new jo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(K){const oe=this._cache;if(oe.focus!==K.focus||oe.fov!==K.fov||oe.aspect!==K.aspect*this.aspect||oe.near!==K.near||oe.far!==K.far||oe.zoom!==K.zoom||oe.eyeSep!==this.eyeSep){oe.focus=K.focus,oe.fov=K.fov,oe.aspect=K.aspect*this.aspect,oe.near=K.near,oe.far=K.far,oe.zoom=K.zoom,oe.eyeSep=this.eyeSep,D1.copy(K.projectionMatrix);const ye=oe.eyeSep/2,Ie=ye*oe.near/oe.focus,Ue=oe.near*Math.tan(Ll*oe.fov*.5)/oe.zoom;let He,Ke;lg.elements[12]=-ye,ag.elements[12]=ye,He=-Ue*oe.aspect+Ie,Ke=Ue*oe.aspect+Ie,D1.elements[0]=2*oe.near/(Ke-He),D1.elements[8]=(Ke+He)/(Ke-He),this.cameraL.projectionMatrix.copy(D1),He=-Ue*oe.aspect-Ie,Ke=Ue*oe.aspect-Ie,D1.elements[0]=2*oe.near/(Ke-He),D1.elements[8]=(Ke+He)/(Ke-He),this.cameraR.projectionMatrix.copy(D1)}this.cameraL.matrixWorld.copy(K.matrixWorld).multiply(lg),this.cameraR.matrixWorld.copy(K.matrixWorld).multiply(ag)}}class cg{constructor(K=!0){this.autoStart=K,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ug(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let K=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const oe=ug();K=(oe-this.oldTime)/1e3,this.oldTime=oe,this.elapsedTime+=K}return K}}function ug(){return(typeof performance>"u"?Date:performance).now()}const P1=new vn,hg=new to,hv=new vn,F1=new vn;class dv extends uo{constructor(){super(),this.type="AudioListener",this.context=y2.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new cg}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(K){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=K,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(K){return this.gain.gain.setTargetAtTime(K,this.context.currentTime,.01),this}updateMatrixWorld(K){super.updateMatrixWorld(K);const oe=this.context.listener,de=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(P1,hg,hv),F1.set(0,0,-1).applyQuaternion(hg),oe.positionX){const ye=this.context.currentTime+this.timeDelta;oe.positionX.linearRampToValueAtTime(P1.x,ye),oe.positionY.linearRampToValueAtTime(P1.y,ye),oe.positionZ.linearRampToValueAtTime(P1.z,ye),oe.forwardX.linearRampToValueAtTime(F1.x,ye),oe.forwardY.linearRampToValueAtTime(F1.y,ye),oe.forwardZ.linearRampToValueAtTime(F1.z,ye),oe.upX.linearRampToValueAtTime(de.x,ye),oe.upY.linearRampToValueAtTime(de.y,ye),oe.upZ.linearRampToValueAtTime(de.z,ye)}else oe.setPosition(P1.x,P1.y,P1.z),oe.setOrientation(F1.x,F1.y,F1.z,de.x,de.y,de.z)}}class dg extends uo{constructor(K){super(),this.type="Audio",this.listener=K,this.context=K.context,this.gain=this.context.createGain(),this.gain.connect(K.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(K){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=K,this.connect(),this}setMediaElementSource(K){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(K),this.connect(),this}setMediaStreamSource(K){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(K),this.connect(),this}setBuffer(K){return this.buffer=K,this.sourceType="buffer",this.autoplay&&this.play(),this}play(K=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+K;const oe=this.context.createBufferSource();return oe.buffer=this.buffer,oe.loop=this.loop,oe.loopStart=this.loopStart,oe.loopEnd=this.loopEnd,oe.onended=this.onEnded.bind(this),oe.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=oe,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let K=1,oe=this.filters.length;K<oe;K++)this.filters[K-1].connect(this.filters[K]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let K=1,oe=this.filters.length;K<oe;K++)this.filters[K-1].disconnect(this.filters[K]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(K){return K||(K=[]),this._connected===!0?(this.disconnect(),this.filters=K.slice(),this.connect()):this.filters=K.slice(),this}setDetune(K){return this.detune=K,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(K){return this.setFilters(K?[K]:[])}setPlaybackRate(K){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=K,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(K){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=K,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(K){return this.loopStart=K,this}setLoopEnd(K){return this.loopEnd=K,this}getVolume(){return this.gain.gain.value}setVolume(K){return this.gain.gain.setTargetAtTime(K,this.context.currentTime,.01),this}}const O1=new vn,fg=new to,fv=new vn,N1=new vn;class pv extends dg{constructor(K){super(K),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(K){return this.panner.refDistance=K,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(K){return this.panner.rolloffFactor=K,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(K){return this.panner.distanceModel=K,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(K){return this.panner.maxDistance=K,this}setDirectionalCone(K,oe,de){return this.panner.coneInnerAngle=K,this.panner.coneOuterAngle=oe,this.panner.coneOuterGain=de,this}updateMatrixWorld(K){if(super.updateMatrixWorld(K),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(O1,fg,fv),N1.set(0,0,1).applyQuaternion(fg);const oe=this.panner;if(oe.positionX){const de=this.context.currentTime+this.listener.timeDelta;oe.positionX.linearRampToValueAtTime(O1.x,de),oe.positionY.linearRampToValueAtTime(O1.y,de),oe.positionZ.linearRampToValueAtTime(O1.z,de),oe.orientationX.linearRampToValueAtTime(N1.x,de),oe.orientationY.linearRampToValueAtTime(N1.y,de),oe.orientationZ.linearRampToValueAtTime(N1.z,de)}else oe.setPosition(O1.x,O1.y,O1.z),oe.setOrientation(N1.x,N1.y,N1.z)}}class Av{constructor(K,oe=2048){this.analyser=K.context.createAnalyser(),this.analyser.fftSize=oe,this.data=new Uint8Array(this.analyser.frequencyBinCount),K.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let K=0;const oe=this.getFrequencyData();for(let de=0;de<oe.length;de++)K+=oe[de];return K/oe.length}}class pg{constructor(K,oe,de){this.binding=K,this.valueSize=de;let ye,Ie,Ue;switch(oe){case"quaternion":ye=this._slerp,Ie=this._slerpAdditive,Ue=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(de*6),this._workIndex=5;break;case"string":case"bool":ye=this._select,Ie=this._select,Ue=this._setAdditiveIdentityOther,this.buffer=new Array(de*5);break;default:ye=this._lerp,Ie=this._lerpAdditive,Ue=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(de*5)}this._mixBufferRegion=ye,this._mixBufferRegionAdditive=Ie,this._setIdentity=Ue,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(K,oe){const de=this.buffer,ye=this.valueSize,Ie=K*ye+ye;let Ue=this.cumulativeWeight;if(Ue===0){for(let He=0;He!==ye;++He)de[Ie+He]=de[He];Ue=oe}else{Ue+=oe;const He=oe/Ue;this._mixBufferRegion(de,Ie,0,He,ye)}this.cumulativeWeight=Ue}accumulateAdditive(K){const oe=this.buffer,de=this.valueSize,ye=de*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(oe,ye,0,K,de),this.cumulativeWeightAdditive+=K}apply(K){const oe=this.valueSize,de=this.buffer,ye=K*oe+oe,Ie=this.cumulativeWeight,Ue=this.cumulativeWeightAdditive,He=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,Ie<1){const Ke=oe*this._origIndex;this._mixBufferRegion(de,ye,Ke,1-Ie,oe)}Ue>0&&this._mixBufferRegionAdditive(de,ye,this._addIndex*oe,1,oe);for(let Ke=oe,Ze=oe+oe;Ke!==Ze;++Ke)if(de[Ke]!==de[Ke+oe]){He.setValue(de,ye);break}}saveOriginalState(){const K=this.binding,oe=this.buffer,de=this.valueSize,ye=de*this._origIndex;K.getValue(oe,ye);for(let Ie=de,Ue=ye;Ie!==Ue;++Ie)oe[Ie]=oe[ye+Ie%de];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const K=this.valueSize*3;this.binding.setValue(this.buffer,K)}_setAdditiveIdentityNumeric(){const K=this._addIndex*this.valueSize,oe=K+this.valueSize;for(let de=K;de<oe;de++)this.buffer[de]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const K=this._origIndex*this.valueSize,oe=this._addIndex*this.valueSize;for(let de=0;de<this.valueSize;de++)this.buffer[oe+de]=this.buffer[K+de]}_select(K,oe,de,ye,Ie){if(ye>=.5)for(let Ue=0;Ue!==Ie;++Ue)K[oe+Ue]=K[de+Ue]}_slerp(K,oe,de,ye){to.slerpFlat(K,oe,K,oe,K,de,ye)}_slerpAdditive(K,oe,de,ye,Ie){const Ue=this._workIndex*Ie;to.multiplyQuaternionsFlat(K,Ue,K,oe,K,de),to.slerpFlat(K,oe,K,oe,K,Ue,ye)}_lerp(K,oe,de,ye,Ie){const Ue=1-ye;for(let He=0;He!==Ie;++He){const Ke=oe+He;K[Ke]=K[Ke]*Ue+K[de+He]*ye}}_lerpAdditive(K,oe,de,ye,Ie){for(let Ue=0;Ue!==Ie;++Ue){const He=oe+Ue;K[He]=K[He]+K[de+Ue]*ye}}}const C2="\\[\\]\\.:\\/",mv=new RegExp("["+C2+"]","g"),x2="[^"+C2+"]",gv="[^"+C2.replace("\\.","")+"]",vv=/((?:WC+[\/:])*)/.source.replace("WC",x2),Ev=/(WCOD+)?/.source.replace("WCOD",gv),_v=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",x2),yv=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",x2),Cv=new RegExp("^"+vv+Ev+_v+yv+"$"),xv=["material","materials","bones","map"];class wv{constructor(K,oe,de){const ye=de||Lo.parseTrackName(oe);this._targetGroup=K,this._bindings=K.subscribe_(oe,ye)}getValue(K,oe){this.bind();const de=this._targetGroup.nCachedObjects_,ye=this._bindings[de];ye!==void 0&&ye.getValue(K,oe)}setValue(K,oe){const de=this._bindings;for(let ye=this._targetGroup.nCachedObjects_,Ie=de.length;ye!==Ie;++ye)de[ye].setValue(K,oe)}bind(){const K=this._bindings;for(let oe=this._targetGroup.nCachedObjects_,de=K.length;oe!==de;++oe)K[oe].bind()}unbind(){const K=this._bindings;for(let oe=this._targetGroup.nCachedObjects_,de=K.length;oe!==de;++oe)K[oe].unbind()}}class Lo{constructor(K,oe,de){this.path=oe,this.parsedPath=de||Lo.parseTrackName(oe),this.node=Lo.findNode(K,this.parsedPath.nodeName),this.rootNode=K,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(K,oe,de){return K&&K.isAnimationObjectGroup?new Lo.Composite(K,oe,de):new Lo(K,oe,de)}static sanitizeNodeName(K){return K.replace(/\s/g,"_").replace(mv,"")}static parseTrackName(K){const oe=Cv.exec(K);if(oe===null)throw new Error("PropertyBinding: Cannot parse trackName: "+K);const de={nodeName:oe[2],objectName:oe[3],objectIndex:oe[4],propertyName:oe[5],propertyIndex:oe[6]},ye=de.nodeName&&de.nodeName.lastIndexOf(".");if(ye!==void 0&&ye!==-1){const Ie=de.nodeName.substring(ye+1);xv.indexOf(Ie)!==-1&&(de.nodeName=de.nodeName.substring(0,ye),de.objectName=Ie)}if(de.propertyName===null||de.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+K);return de}static findNode(K,oe){if(oe===void 0||oe===""||oe==="."||oe===-1||oe===K.name||oe===K.uuid)return K;if(K.skeleton){const de=K.skeleton.getBoneByName(oe);if(de!==void 0)return de}if(K.children){const de=function(Ie){for(let Ue=0;Ue<Ie.length;Ue++){const He=Ie[Ue];if(He.name===oe||He.uuid===oe)return He;const Ke=de(He.children);if(Ke)return Ke}return null},ye=de(K.children);if(ye)return ye}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(K,oe){K[oe]=this.targetObject[this.propertyName]}_getValue_array(K,oe){const de=this.resolvedProperty;for(let ye=0,Ie=de.length;ye!==Ie;++ye)K[oe++]=de[ye]}_getValue_arrayElement(K,oe){K[oe]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(K,oe){this.resolvedProperty.toArray(K,oe)}_setValue_direct(K,oe){this.targetObject[this.propertyName]=K[oe]}_setValue_direct_setNeedsUpdate(K,oe){this.targetObject[this.propertyName]=K[oe],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(K,oe){this.targetObject[this.propertyName]=K[oe],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(K,oe){const de=this.resolvedProperty;for(let ye=0,Ie=de.length;ye!==Ie;++ye)de[ye]=K[oe++]}_setValue_array_setNeedsUpdate(K,oe){const de=this.resolvedProperty;for(let ye=0,Ie=de.length;ye!==Ie;++ye)de[ye]=K[oe++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(K,oe){const de=this.resolvedProperty;for(let ye=0,Ie=de.length;ye!==Ie;++ye)de[ye]=K[oe++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(K,oe){this.resolvedProperty[this.propertyIndex]=K[oe]}_setValue_arrayElement_setNeedsUpdate(K,oe){this.resolvedProperty[this.propertyIndex]=K[oe],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(K,oe){this.resolvedProperty[this.propertyIndex]=K[oe],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(K,oe){this.resolvedProperty.fromArray(K,oe)}_setValue_fromArray_setNeedsUpdate(K,oe){this.resolvedProperty.fromArray(K,oe),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(K,oe){this.resolvedProperty.fromArray(K,oe),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(K,oe){this.bind(),this.getValue(K,oe)}_setValue_unbound(K,oe){this.bind(),this.setValue(K,oe)}bind(){let K=this.node;const oe=this.parsedPath,de=oe.objectName,ye=oe.propertyName;let Ie=oe.propertyIndex;if(K||(K=Lo.findNode(this.rootNode,oe.nodeName),this.node=K),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!K){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(de){let Ze=oe.objectIndex;switch(de){case"materials":if(!K.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!K.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}K=K.material.materials;break;case"bones":if(!K.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}K=K.skeleton.bones;for(let at=0;at<K.length;at++)if(K[at].name===Ze){Ze=at;break}break;case"map":if("map"in K){K=K.map;break}if(!K.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!K.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}K=K.material.map;break;default:if(K[de]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}K=K[de]}if(Ze!==void 0){if(K[Ze]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,K);return}K=K[Ze]}}const Ue=K[ye];if(Ue===void 0){const Ze=oe.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+Ze+"."+ye+" but it wasn't found.",K);return}let He=this.Versioning.None;this.targetObject=K,K.needsUpdate!==void 0?He=this.Versioning.NeedsUpdate:K.matrixWorldNeedsUpdate!==void 0&&(He=this.Versioning.MatrixWorldNeedsUpdate);let Ke=this.BindingType.Direct;if(Ie!==void 0){if(ye==="morphTargetInfluences"){if(!K.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!K.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}K.morphTargetDictionary[Ie]!==void 0&&(Ie=K.morphTargetDictionary[Ie])}Ke=this.BindingType.ArrayElement,this.resolvedProperty=Ue,this.propertyIndex=Ie}else Ue.fromArray!==void 0&&Ue.toArray!==void 0?(Ke=this.BindingType.HasFromToArray,this.resolvedProperty=Ue):Array.isArray(Ue)?(Ke=this.BindingType.EntireArray,this.resolvedProperty=Ue):this.propertyName=ye;this.getValue=this.GetterByBindingType[Ke],this.setValue=this.SetterByBindingTypeAndVersioning[Ke][He]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Lo.Composite=wv,Lo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Lo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Lo.prototype.GetterByBindingType=[Lo.prototype._getValue_direct,Lo.prototype._getValue_array,Lo.prototype._getValue_arrayElement,Lo.prototype._getValue_toArray],Lo.prototype.SetterByBindingTypeAndVersioning=[[Lo.prototype._setValue_direct,Lo.prototype._setValue_direct_setNeedsUpdate,Lo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Lo.prototype._setValue_array,Lo.prototype._setValue_array_setNeedsUpdate,Lo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Lo.prototype._setValue_arrayElement,Lo.prototype._setValue_arrayElement_setNeedsUpdate,Lo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Lo.prototype._setValue_fromArray,Lo.prototype._setValue_fromArray_setNeedsUpdate,Lo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Sv{constructor(){this.isAnimationObjectGroup=!0,this.uuid=c0(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const K={};this._indicesByUUID=K;for(let de=0,ye=arguments.length;de!==ye;++de)K[arguments[de].uuid]=de;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const oe=this;this.stats={objects:{get total(){return oe._objects.length},get inUse(){return this.total-oe.nCachedObjects_}},get bindingsPerObject(){return oe._bindings.length}}}add(){const K=this._objects,oe=this._indicesByUUID,de=this._paths,ye=this._parsedPaths,Ie=this._bindings,Ue=Ie.length;let He,Ke=K.length,Ze=this.nCachedObjects_;for(let at=0,mt=arguments.length;at!==mt;++at){const vt=arguments[at],St=vt.uuid;let Lt=oe[St];if(Lt===void 0){Lt=Ke++,oe[St]=Lt,K.push(vt);for(let Ht=0,Dt=Ue;Ht!==Dt;++Ht)Ie[Ht].push(new Lo(vt,de[Ht],ye[Ht]))}else if(Lt<Ze){He=K[Lt];const Ht=--Ze,Dt=K[Ht];oe[Dt.uuid]=Lt,K[Lt]=Dt,oe[St]=Ht,K[Ht]=vt;for(let bt=0,tn=Ue;bt!==tn;++bt){const Zt=Ie[bt],qt=Zt[Ht];let Un=Zt[Lt];Zt[Lt]=qt,Un===void 0&&(Un=new Lo(vt,de[bt],ye[bt])),Zt[Ht]=Un}}else K[Lt]!==He&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=Ze}remove(){const K=this._objects,oe=this._indicesByUUID,de=this._bindings,ye=de.length;let Ie=this.nCachedObjects_;for(let Ue=0,He=arguments.length;Ue!==He;++Ue){const Ke=arguments[Ue],Ze=Ke.uuid,at=oe[Ze];if(at!==void 0&&at>=Ie){const mt=Ie++,vt=K[mt];oe[vt.uuid]=at,K[at]=vt,oe[Ze]=mt,K[mt]=Ke;for(let St=0,Lt=ye;St!==Lt;++St){const Ht=de[St],Dt=Ht[mt],bt=Ht[at];Ht[at]=Dt,Ht[mt]=bt}}}this.nCachedObjects_=Ie}uncache(){const K=this._objects,oe=this._indicesByUUID,de=this._bindings,ye=de.length;let Ie=this.nCachedObjects_,Ue=K.length;for(let He=0,Ke=arguments.length;He!==Ke;++He){const Ze=arguments[He],at=Ze.uuid,mt=oe[at];if(mt!==void 0)if(delete oe[at],mt<Ie){const vt=--Ie,St=K[vt],Lt=--Ue,Ht=K[Lt];oe[St.uuid]=mt,K[mt]=St,oe[Ht.uuid]=vt,K[vt]=Ht,K.pop();for(let Dt=0,bt=ye;Dt!==bt;++Dt){const tn=de[Dt],Zt=tn[vt],qt=tn[Lt];tn[mt]=Zt,tn[vt]=qt,tn.pop()}}else{const vt=--Ue,St=K[vt];vt>0&&(oe[St.uuid]=mt),K[mt]=St,K.pop();for(let Lt=0,Ht=ye;Lt!==Ht;++Lt){const Dt=de[Lt];Dt[mt]=Dt[vt],Dt.pop()}}}this.nCachedObjects_=Ie}subscribe_(K,oe){const de=this._bindingsIndicesByPath;let ye=de[K];const Ie=this._bindings;if(ye!==void 0)return Ie[ye];const Ue=this._paths,He=this._parsedPaths,Ke=this._objects,Ze=Ke.length,at=this.nCachedObjects_,mt=new Array(Ze);ye=Ie.length,de[K]=ye,Ue.push(K),He.push(oe),Ie.push(mt);for(let vt=at,St=Ke.length;vt!==St;++vt){const Lt=Ke[vt];mt[vt]=new Lo(Lt,K,oe)}return mt}unsubscribe_(K){const oe=this._bindingsIndicesByPath,de=oe[K];if(de!==void 0){const ye=this._paths,Ie=this._parsedPaths,Ue=this._bindings,He=Ue.length-1,Ke=Ue[He],Ze=K[He];oe[Ze]=de,Ue[de]=Ke,Ue.pop(),Ie[de]=Ie[He],Ie.pop(),ye[de]=ye[He],ye.pop()}}}class Ag{constructor(K,oe,de=null,ye=oe.blendMode){this._mixer=K,this._clip=oe,this._localRoot=de,this.blendMode=ye;const Ie=oe.tracks,Ue=Ie.length,He=new Array(Ue),Ke={endingStart:na,endingEnd:na};for(let Ze=0;Ze!==Ue;++Ze){const at=Ie[Ze].createInterpolant(null);He[Ze]=at,at.settings=Ke}this._interpolantSettings=Ke,this._interpolants=He,this._propertyBindings=new Array(Ue),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=mo,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(K){return this._startTime=K,this}setLoop(K,oe){return this.loop=K,this.repetitions=oe,this}setEffectiveWeight(K){return this.weight=K,this._effectiveWeight=this.enabled?K:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(K){return this._scheduleFading(K,0,1)}fadeOut(K){return this._scheduleFading(K,1,0)}crossFadeFrom(K,oe,de){if(K.fadeOut(oe),this.fadeIn(oe),de){const ye=this._clip.duration,Ie=K._clip.duration,Ue=Ie/ye,He=ye/Ie;K.warp(1,Ue,oe),this.warp(He,1,oe)}return this}crossFadeTo(K,oe,de){return K.crossFadeFrom(this,oe,de)}stopFading(){const K=this._weightInterpolant;return K!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(K)),this}setEffectiveTimeScale(K){return this.timeScale=K,this._effectiveTimeScale=this.paused?0:K,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(K){return this.timeScale=this._clip.duration/K,this.stopWarping()}syncWith(K){return this.time=K.time,this.timeScale=K.timeScale,this.stopWarping()}halt(K){return this.warp(this._effectiveTimeScale,0,K)}warp(K,oe,de){const ye=this._mixer,Ie=ye.time,Ue=this.timeScale;let He=this._timeScaleInterpolant;He===null&&(He=ye._lendControlInterpolant(),this._timeScaleInterpolant=He);const Ke=He.parameterPositions,Ze=He.sampleValues;return Ke[0]=Ie,Ke[1]=Ie+de,Ze[0]=K/Ue,Ze[1]=oe/Ue,this}stopWarping(){const K=this._timeScaleInterpolant;return K!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(K)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(K,oe,de,ye){if(!this.enabled){this._updateWeight(K);return}const Ie=this._startTime;if(Ie!==null){const Ke=(K-Ie)*de;Ke<0||de===0?oe=0:(this._startTime=null,oe=de*Ke)}oe*=this._updateTimeScale(K);const Ue=this._updateTime(oe),He=this._updateWeight(K);if(He>0){const Ke=this._interpolants,Ze=this._propertyBindings;switch(this.blendMode){case C0:for(let at=0,mt=Ke.length;at!==mt;++at)Ke[at].evaluate(Ue),Ze[at].accumulateAdditive(He);break;case J0:default:for(let at=0,mt=Ke.length;at!==mt;++at)Ke[at].evaluate(Ue),Ze[at].accumulate(ye,He)}}}_updateWeight(K){let oe=0;if(this.enabled){oe=this.weight;const de=this._weightInterpolant;if(de!==null){const ye=de.evaluate(K)[0];oe*=ye,K>de.parameterPositions[1]&&(this.stopFading(),ye===0&&(this.enabled=!1))}}return this._effectiveWeight=oe,oe}_updateTimeScale(K){let oe=0;if(!this.paused){oe=this.timeScale;const de=this._timeScaleInterpolant;if(de!==null){const ye=de.evaluate(K)[0];oe*=ye,K>de.parameterPositions[1]&&(this.stopWarping(),oe===0?this.paused=!0:this.timeScale=oe)}}return this._effectiveTimeScale=oe,oe}_updateTime(K){const oe=this._clip.duration,de=this.loop;let ye=this.time+K,Ie=this._loopCount;const Ue=de===fa;if(K===0)return Ie===-1?ye:Ue&&(Ie&1)===1?oe-ye:ye;if(de===Po){Ie===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(ye>=oe)ye=oe;else if(ye<0)ye=0;else{this.time=ye;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=ye,this._mixer.dispatchEvent({type:"finished",action:this,direction:K<0?-1:1})}}else{if(Ie===-1&&(K>=0?(Ie=0,this._setEndings(!0,this.repetitions===0,Ue)):this._setEndings(this.repetitions===0,!0,Ue)),ye>=oe||ye<0){const He=Math.floor(ye/oe);ye-=oe*He,Ie+=Math.abs(He);const Ke=this.repetitions-Ie;if(Ke<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,ye=K>0?oe:0,this.time=ye,this._mixer.dispatchEvent({type:"finished",action:this,direction:K>0?1:-1});else{if(Ke===1){const Ze=K<0;this._setEndings(Ze,!Ze,Ue)}else this._setEndings(!1,!1,Ue);this._loopCount=Ie,this.time=ye,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:He})}}else this.time=ye;if(Ue&&(Ie&1)===1)return oe-ye}return ye}_setEndings(K,oe,de){const ye=this._interpolantSettings;de?(ye.endingStart=ma,ye.endingEnd=ma):(K?ye.endingStart=this.zeroSlopeAtStart?ma:na:ye.endingStart=L0,oe?ye.endingEnd=this.zeroSlopeAtEnd?ma:na:ye.endingEnd=L0)}_scheduleFading(K,oe,de){const ye=this._mixer,Ie=ye.time;let Ue=this._weightInterpolant;Ue===null&&(Ue=ye._lendControlInterpolant(),this._weightInterpolant=Ue);const He=Ue.parameterPositions,Ke=Ue.sampleValues;return He[0]=Ie,Ke[0]=oe,He[1]=Ie+K,Ke[1]=de,this}}const Mv=new Float32Array(1);class bv extends La{constructor(K){super(),this._root=K,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(K,oe){const de=K._localRoot||this._root,ye=K._clip.tracks,Ie=ye.length,Ue=K._propertyBindings,He=K._interpolants,Ke=de.uuid,Ze=this._bindingsByRootAndName;let at=Ze[Ke];at===void 0&&(at={},Ze[Ke]=at);for(let mt=0;mt!==Ie;++mt){const vt=ye[mt],St=vt.name;let Lt=at[St];if(Lt!==void 0)++Lt.referenceCount,Ue[mt]=Lt;else{if(Lt=Ue[mt],Lt!==void 0){Lt._cacheIndex===null&&(++Lt.referenceCount,this._addInactiveBinding(Lt,Ke,St));continue}const Ht=oe&&oe._propertyBindings[mt].binding.parsedPath;Lt=new pg(Lo.create(de,St,Ht),vt.ValueTypeName,vt.getValueSize()),++Lt.referenceCount,this._addInactiveBinding(Lt,Ke,St),Ue[mt]=Lt}He[mt].resultBuffer=Lt.buffer}}_activateAction(K){if(!this._isActiveAction(K)){if(K._cacheIndex===null){const de=(K._localRoot||this._root).uuid,ye=K._clip.uuid,Ie=this._actionsByClip[ye];this._bindAction(K,Ie&&Ie.knownActions[0]),this._addInactiveAction(K,ye,de)}const oe=K._propertyBindings;for(let de=0,ye=oe.length;de!==ye;++de){const Ie=oe[de];Ie.useCount++===0&&(this._lendBinding(Ie),Ie.saveOriginalState())}this._lendAction(K)}}_deactivateAction(K){if(this._isActiveAction(K)){const oe=K._propertyBindings;for(let de=0,ye=oe.length;de!==ye;++de){const Ie=oe[de];--Ie.useCount===0&&(Ie.restoreOriginalState(),this._takeBackBinding(Ie))}this._takeBackAction(K)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const K=this;this.stats={actions:{get total(){return K._actions.length},get inUse(){return K._nActiveActions}},bindings:{get total(){return K._bindings.length},get inUse(){return K._nActiveBindings}},controlInterpolants:{get total(){return K._controlInterpolants.length},get inUse(){return K._nActiveControlInterpolants}}}}_isActiveAction(K){const oe=K._cacheIndex;return oe!==null&&oe<this._nActiveActions}_addInactiveAction(K,oe,de){const ye=this._actions,Ie=this._actionsByClip;let Ue=Ie[oe];if(Ue===void 0)Ue={knownActions:[K],actionByRoot:{}},K._byClipCacheIndex=0,Ie[oe]=Ue;else{const He=Ue.knownActions;K._byClipCacheIndex=He.length,He.push(K)}K._cacheIndex=ye.length,ye.push(K),Ue.actionByRoot[de]=K}_removeInactiveAction(K){const oe=this._actions,de=oe[oe.length-1],ye=K._cacheIndex;de._cacheIndex=ye,oe[ye]=de,oe.pop(),K._cacheIndex=null;const Ie=K._clip.uuid,Ue=this._actionsByClip,He=Ue[Ie],Ke=He.knownActions,Ze=Ke[Ke.length-1],at=K._byClipCacheIndex;Ze._byClipCacheIndex=at,Ke[at]=Ze,Ke.pop(),K._byClipCacheIndex=null;const mt=He.actionByRoot,vt=(K._localRoot||this._root).uuid;delete mt[vt],Ke.length===0&&delete Ue[Ie],this._removeInactiveBindingsForAction(K)}_removeInactiveBindingsForAction(K){const oe=K._propertyBindings;for(let de=0,ye=oe.length;de!==ye;++de){const Ie=oe[de];--Ie.referenceCount===0&&this._removeInactiveBinding(Ie)}}_lendAction(K){const oe=this._actions,de=K._cacheIndex,ye=this._nActiveActions++,Ie=oe[ye];K._cacheIndex=ye,oe[ye]=K,Ie._cacheIndex=de,oe[de]=Ie}_takeBackAction(K){const oe=this._actions,de=K._cacheIndex,ye=--this._nActiveActions,Ie=oe[ye];K._cacheIndex=ye,oe[ye]=K,Ie._cacheIndex=de,oe[de]=Ie}_addInactiveBinding(K,oe,de){const ye=this._bindingsByRootAndName,Ie=this._bindings;let Ue=ye[oe];Ue===void 0&&(Ue={},ye[oe]=Ue),Ue[de]=K,K._cacheIndex=Ie.length,Ie.push(K)}_removeInactiveBinding(K){const oe=this._bindings,de=K.binding,ye=de.rootNode.uuid,Ie=de.path,Ue=this._bindingsByRootAndName,He=Ue[ye],Ke=oe[oe.length-1],Ze=K._cacheIndex;Ke._cacheIndex=Ze,oe[Ze]=Ke,oe.pop(),delete He[Ie],Object.keys(He).length===0&&delete Ue[ye]}_lendBinding(K){const oe=this._bindings,de=K._cacheIndex,ye=this._nActiveBindings++,Ie=oe[ye];K._cacheIndex=ye,oe[ye]=K,Ie._cacheIndex=de,oe[de]=Ie}_takeBackBinding(K){const oe=this._bindings,de=K._cacheIndex,ye=--this._nActiveBindings,Ie=oe[ye];K._cacheIndex=ye,oe[ye]=K,Ie._cacheIndex=de,oe[de]=Ie}_lendControlInterpolant(){const K=this._controlInterpolants,oe=this._nActiveControlInterpolants++;let de=K[oe];return de===void 0&&(de=new p2(new Float32Array(2),new Float32Array(2),1,Mv),de.__cacheIndex=oe,K[oe]=de),de}_takeBackControlInterpolant(K){const oe=this._controlInterpolants,de=K.__cacheIndex,ye=--this._nActiveControlInterpolants,Ie=oe[ye];K.__cacheIndex=ye,oe[ye]=K,Ie.__cacheIndex=de,oe[de]=Ie}clipAction(K,oe,de){const ye=oe||this._root,Ie=ye.uuid;let Ue=typeof K=="string"?Op.findByName(ye,K):K;const He=Ue!==null?Ue.uuid:K,Ke=this._actionsByClip[He];let Ze=null;if(de===void 0&&(Ue!==null?de=Ue.blendMode:de=J0),Ke!==void 0){const mt=Ke.actionByRoot[Ie];if(mt!==void 0&&mt.blendMode===de)return mt;Ze=Ke.knownActions[0],Ue===null&&(Ue=Ze._clip)}if(Ue===null)return null;const at=new Ag(this,Ue,oe,de);return this._bindAction(at,Ze),this._addInactiveAction(at,He,Ie),at}existingAction(K,oe){const de=oe||this._root,ye=de.uuid,Ie=typeof K=="string"?Op.findByName(de,K):K,Ue=Ie?Ie.uuid:K,He=this._actionsByClip[Ue];return He!==void 0&&He.actionByRoot[ye]||null}stopAllAction(){const K=this._actions,oe=this._nActiveActions;for(let de=oe-1;de>=0;--de)K[de].stop();return this}update(K){K*=this.timeScale;const oe=this._actions,de=this._nActiveActions,ye=this.time+=K,Ie=Math.sign(K),Ue=this._accuIndex^=1;for(let Ze=0;Ze!==de;++Ze)oe[Ze]._update(ye,K,Ie,Ue);const He=this._bindings,Ke=this._nActiveBindings;for(let Ze=0;Ze!==Ke;++Ze)He[Ze].apply(Ue);return this}setTime(K){this.time=0;for(let oe=0;oe<this._actions.length;oe++)this._actions[oe].time=0;return this.update(K)}getRoot(){return this._root}uncacheClip(K){const oe=this._actions,de=K.uuid,ye=this._actionsByClip,Ie=ye[de];if(Ie!==void 0){const Ue=Ie.knownActions;for(let He=0,Ke=Ue.length;He!==Ke;++He){const Ze=Ue[He];this._deactivateAction(Ze);const at=Ze._cacheIndex,mt=oe[oe.length-1];Ze._cacheIndex=null,Ze._byClipCacheIndex=null,mt._cacheIndex=at,oe[at]=mt,oe.pop(),this._removeInactiveBindingsForAction(Ze)}delete ye[de]}}uncacheRoot(K){const oe=K.uuid,de=this._actionsByClip;for(const Ue in de){const He=de[Ue].actionByRoot,Ke=He[oe];Ke!==void 0&&(this._deactivateAction(Ke),this._removeInactiveAction(Ke))}const ye=this._bindingsByRootAndName,Ie=ye[oe];if(Ie!==void 0)for(const Ue in Ie){const He=Ie[Ue];He.restoreOriginalState(),this._removeInactiveBinding(He)}}uncacheAction(K,oe){const de=this.existingAction(K,oe);de!==null&&(this._deactivateAction(de),this._removeInactiveAction(de))}}class w2{constructor(K){this.value=K}clone(){return new w2(this.value.clone===void 0?this.value:this.value.clone())}}let Tv=0;class Iv extends La{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Tv++}),this.name="",this.usage=sc,this.uniforms=[]}add(K){return this.uniforms.push(K),this}remove(K){const oe=this.uniforms.indexOf(K);return oe!==-1&&this.uniforms.splice(oe,1),this}setName(K){return this.name=K,this}setUsage(K){return this.usage=K,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(K){this.name=K.name,this.usage=K.usage;const oe=K.uniforms;this.uniforms.length=0;for(let de=0,ye=oe.length;de<ye;de++){const Ie=Array.isArray(oe[de])?oe[de]:[oe[de]];for(let Ue=0;Ue<Ie.length;Ue++)this.uniforms.push(Ie[Ue].clone())}return this}clone(){return new this.constructor().copy(this)}}class Rv extends zp{constructor(K,oe,de=1){super(K,oe),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=de}copy(K){return super.copy(K),this.meshPerAttribute=K.meshPerAttribute,this}clone(K){const oe=super.clone(K);return oe.meshPerAttribute=this.meshPerAttribute,oe}toJSON(K){const oe=super.toJSON(K);return oe.isInstancedInterleavedBuffer=!0,oe.meshPerAttribute=this.meshPerAttribute,oe}}class Bv{constructor(K,oe,de,ye,Ie){this.isGLBufferAttribute=!0,this.name="",this.buffer=K,this.type=oe,this.itemSize=de,this.elementSize=ye,this.count=Ie,this.version=0}set needsUpdate(K){K===!0&&this.version++}setBuffer(K){return this.buffer=K,this}setType(K,oe){return this.type=K,this.elementSize=oe,this}setItemSize(K){return this.itemSize=K,this}setCount(K){return this.count=K,this}}const mg=new kr;class Lv{constructor(K,oe,de=0,ye=1/0){this.ray=new Jo(K,oe),this.near=de,this.far=ye,this.camera=null,this.layers=new Ql,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(K,oe){this.ray.set(K,oe)}setFromCamera(K,oe){oe.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(oe.matrixWorld),this.ray.direction.set(K.x,K.y,.5).unproject(oe).sub(this.ray.origin).normalize(),this.camera=oe):oe.isOrthographicCamera?(this.ray.origin.set(K.x,K.y,(oe.near+oe.far)/(oe.near-oe.far)).unproject(oe),this.ray.direction.set(0,0,-1).transformDirection(oe.matrixWorld),this.camera=oe):console.error("THREE.Raycaster: Unsupported camera type: "+oe.type)}setFromXRController(K){return mg.identity().extractRotation(K.matrixWorld),this.ray.origin.setFromMatrixPosition(K.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(mg),this}intersectObject(K,oe=!0,de=[]){return S2(K,this,de,oe),de.sort(gg),de}intersectObjects(K,oe=!0,de=[]){for(let ye=0,Ie=K.length;ye<Ie;ye++)S2(K[ye],this,de,oe);return de.sort(gg),de}}function gg(Be,K){return Be.distance-K.distance}function S2(Be,K,oe,de){if(Be.layers.test(K.layers)&&Be.raycast(K,oe),de===!0){const ye=Be.children;for(let Ie=0,Ue=ye.length;Ie<Ue;Ie++)S2(ye[Ie],K,oe,!0)}}class Dv{constructor(K=1,oe=0,de=0){return this.radius=K,this.phi=oe,this.theta=de,this}set(K,oe,de){return this.radius=K,this.phi=oe,this.theta=de,this}copy(K){return this.radius=K.radius,this.phi=K.phi,this.theta=K.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(K){return this.setFromCartesianCoords(K.x,K.y,K.z)}setFromCartesianCoords(K,oe,de){return this.radius=Math.sqrt(K*K+oe*oe+de*de),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(K,de),this.phi=Math.acos(qo(oe/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Pv{constructor(K=1,oe=0,de=0){return this.radius=K,this.theta=oe,this.y=de,this}set(K,oe,de){return this.radius=K,this.theta=oe,this.y=de,this}copy(K){return this.radius=K.radius,this.theta=K.theta,this.y=K.y,this}setFromVector3(K){return this.setFromCartesianCoords(K.x,K.y,K.z)}setFromCartesianCoords(K,oe,de){return this.radius=Math.sqrt(K*K+de*de),this.theta=Math.atan2(K,de),this.y=oe,this}clone(){return new this.constructor().copy(this)}}const vg=new qi;class Fv{constructor(K=new qi(1/0,1/0),oe=new qi(-1/0,-1/0)){this.isBox2=!0,this.min=K,this.max=oe}set(K,oe){return this.min.copy(K),this.max.copy(oe),this}setFromPoints(K){this.makeEmpty();for(let oe=0,de=K.length;oe<de;oe++)this.expandByPoint(K[oe]);return this}setFromCenterAndSize(K,oe){const de=vg.copy(oe).multiplyScalar(.5);return this.min.copy(K).sub(de),this.max.copy(K).add(de),this}clone(){return new this.constructor().copy(this)}copy(K){return this.min.copy(K.min),this.max.copy(K.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(K){return this.isEmpty()?K.set(0,0):K.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(K){return this.isEmpty()?K.set(0,0):K.subVectors(this.max,this.min)}expandByPoint(K){return this.min.min(K),this.max.max(K),this}expandByVector(K){return this.min.sub(K),this.max.add(K),this}expandByScalar(K){return this.min.addScalar(-K),this.max.addScalar(K),this}containsPoint(K){return!(K.x<this.min.x||K.x>this.max.x||K.y<this.min.y||K.y>this.max.y)}containsBox(K){return this.min.x<=K.min.x&&K.max.x<=this.max.x&&this.min.y<=K.min.y&&K.max.y<=this.max.y}getParameter(K,oe){return oe.set((K.x-this.min.x)/(this.max.x-this.min.x),(K.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(K){return!(K.max.x<this.min.x||K.min.x>this.max.x||K.max.y<this.min.y||K.min.y>this.max.y)}clampPoint(K,oe){return oe.copy(K).clamp(this.min,this.max)}distanceToPoint(K){return this.clampPoint(K,vg).distanceTo(K)}intersect(K){return this.min.max(K.min),this.max.min(K.max),this.isEmpty()&&this.makeEmpty(),this}union(K){return this.min.min(K.min),this.max.max(K.max),this}translate(K){return this.min.add(K),this.max.add(K),this}equals(K){return K.min.equals(this.min)&&K.max.equals(this.max)}}const Eg=new vn,RA=new vn;class Ov{constructor(K=new vn,oe=new vn){this.start=K,this.end=oe}set(K,oe){return this.start.copy(K),this.end.copy(oe),this}copy(K){return this.start.copy(K.start),this.end.copy(K.end),this}getCenter(K){return K.addVectors(this.start,this.end).multiplyScalar(.5)}delta(K){return K.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(K,oe){return this.delta(oe).multiplyScalar(K).add(this.start)}closestPointToPointParameter(K,oe){Eg.subVectors(K,this.start),RA.subVectors(this.end,this.start);const de=RA.dot(RA);let Ie=RA.dot(Eg)/de;return oe&&(Ie=qo(Ie,0,1)),Ie}closestPointToPoint(K,oe,de){const ye=this.closestPointToPointParameter(K,oe);return this.delta(de).multiplyScalar(ye).add(this.start)}applyMatrix4(K){return this.start.applyMatrix4(K),this.end.applyMatrix4(K),this}equals(K){return K.start.equals(this.start)&&K.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const yg=new vn;class Nv extends uo{constructor(K,oe){super(),this.light=K,this.matrixAutoUpdate=!1,this.color=oe,this.type="SpotLightHelper";const de=new Ds,ye=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let Ue=0,He=1,Ke=32;Ue<Ke;Ue++,He++){const Ze=Ue/Ke*Math.PI*2,at=He/Ke*Math.PI*2;ye.push(Math.cos(Ze),Math.sin(Ze),1,Math.cos(at),Math.sin(at),1)}de.setAttribute("position",new $i(ye,3));const Ie=new bl({fog:!1,toneMapped:!1});this.cone=new Fu(de,Ie),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const K=this.light.distance?this.light.distance:1e3,oe=K*Math.tan(this.light.angle);this.cone.scale.set(oe,oe,K),yg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(yg),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const md=new vn,BA=new kr,M2=new kr;class Uv extends Fu{constructor(K){const oe=Cg(K),de=new Ds,ye=[],Ie=[],Ue=new Wr(0,0,1),He=new Wr(0,1,0);for(let Ze=0;Ze<oe.length;Ze++){const at=oe[Ze];at.parent&&at.parent.isBone&&(ye.push(0,0,0),ye.push(0,0,0),Ie.push(Ue.r,Ue.g,Ue.b),Ie.push(He.r,He.g,He.b))}de.setAttribute("position",new $i(ye,3)),de.setAttribute("color",new $i(Ie,3));const Ke=new bl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(de,Ke),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=K,this.bones=oe,this.matrix=K.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(K){const oe=this.bones,de=this.geometry,ye=de.getAttribute("position");M2.copy(this.root.matrixWorld).invert();for(let Ie=0,Ue=0;Ie<oe.length;Ie++){const He=oe[Ie];He.parent&&He.parent.isBone&&(BA.multiplyMatrices(M2,He.matrixWorld),md.setFromMatrixPosition(BA),ye.setXYZ(Ue,md.x,md.y,md.z),BA.multiplyMatrices(M2,He.parent.matrixWorld),md.setFromMatrixPosition(BA),ye.setXYZ(Ue+1,md.x,md.y,md.z),Ue+=2)}de.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(K)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Cg(Be){const K=[];Be.isBone===!0&&K.push(Be);for(let oe=0;oe<Be.children.length;oe++)K.push.apply(K,Cg(Be.children[oe]));return K}class kv extends Zo{constructor(K,oe,de){const ye=new Lp(oe,4,2),Ie=new Io({wireframe:!0,fog:!1,toneMapped:!1});super(ye,Ie),this.light=K,this.color=de,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Gv=new vn,xg=new Wr,wg=new Wr;class Qv extends uo{constructor(K,oe,de){super(),this.light=K,this.matrix=K.matrixWorld,this.matrixAutoUpdate=!1,this.color=de,this.type="HemisphereLightHelper";const ye=new Bp(oe);ye.rotateY(Math.PI*.5),this.material=new Io({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const Ie=ye.getAttribute("position"),Ue=new Float32Array(Ie.count*3);ye.setAttribute("color",new So(Ue,3)),this.add(new Zo(ye,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const K=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const oe=K.geometry.getAttribute("color");xg.copy(this.light.color),wg.copy(this.light.groundColor);for(let de=0,ye=oe.count;de<ye;de++){const Ie=de<ye/2?xg:wg;oe.setXYZ(de,Ie.r,Ie.g,Ie.b)}oe.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),K.lookAt(Gv.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Hv extends Fu{constructor(K=10,oe=10,de=4473924,ye=8947848){de=new Wr(de),ye=new Wr(ye);const Ie=oe/2,Ue=K/oe,He=K/2,Ke=[],Ze=[];for(let vt=0,St=0,Lt=-He;vt<=oe;vt++,Lt+=Ue){Ke.push(-He,0,Lt,He,0,Lt),Ke.push(Lt,0,-He,Lt,0,He);const Ht=vt===Ie?de:ye;Ht.toArray(Ze,St),St+=3,Ht.toArray(Ze,St),St+=3,Ht.toArray(Ze,St),St+=3,Ht.toArray(Ze,St),St+=3}const at=new Ds;at.setAttribute("position",new $i(Ke,3)),at.setAttribute("color",new $i(Ze,3));const mt=new bl({vertexColors:!0,toneMapped:!1});super(at,mt),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Vv extends Fu{constructor(K=10,oe=16,de=8,ye=64,Ie=4473924,Ue=8947848){Ie=new Wr(Ie),Ue=new Wr(Ue);const He=[],Ke=[];if(oe>1)for(let mt=0;mt<oe;mt++){const vt=mt/oe*(Math.PI*2),St=Math.sin(vt)*K,Lt=Math.cos(vt)*K;He.push(0,0,0),He.push(St,0,Lt);const Ht=mt&1?Ie:Ue;Ke.push(Ht.r,Ht.g,Ht.b),Ke.push(Ht.r,Ht.g,Ht.b)}for(let mt=0;mt<de;mt++){const vt=mt&1?Ie:Ue,St=K-K/de*mt;for(let Lt=0;Lt<ye;Lt++){let Ht=Lt/ye*(Math.PI*2),Dt=Math.sin(Ht)*St,bt=Math.cos(Ht)*St;He.push(Dt,0,bt),Ke.push(vt.r,vt.g,vt.b),Ht=(Lt+1)/ye*(Math.PI*2),Dt=Math.sin(Ht)*St,bt=Math.cos(Ht)*St,He.push(Dt,0,bt),Ke.push(vt.r,vt.g,vt.b)}}const Ze=new Ds;Ze.setAttribute("position",new $i(He,3)),Ze.setAttribute("color",new $i(Ke,3));const at=new bl({vertexColors:!0,toneMapped:!1});super(Ze,at),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const Sg=new vn,LA=new vn,Mg=new vn;class zv extends uo{constructor(K,oe,de){super(),this.light=K,this.matrix=K.matrixWorld,this.matrixAutoUpdate=!1,this.color=de,this.type="DirectionalLightHelper",oe===void 0&&(oe=1);let ye=new Ds;ye.setAttribute("position",new $i([-oe,oe,0,oe,oe,0,oe,-oe,0,-oe,-oe,0,-oe,oe,0],3));const Ie=new bl({fog:!1,toneMapped:!1});this.lightPlane=new fd(ye,Ie),this.add(this.lightPlane),ye=new Ds,ye.setAttribute("position",new $i([0,0,0,0,0,1],3)),this.targetLine=new fd(ye,Ie),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Sg.setFromMatrixPosition(this.light.matrixWorld),LA.setFromMatrixPosition(this.light.target.matrixWorld),Mg.subVectors(LA,Sg),this.lightPlane.lookAt(LA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(LA),this.targetLine.scale.z=Mg.length()}}const DA=new vn,t0=new Kl;class Wv extends Fu{constructor(K){const oe=new Ds,de=new bl({color:16777215,vertexColors:!0,toneMapped:!1}),ye=[],Ie=[],Ue={};He("n1","n2"),He("n2","n4"),He("n4","n3"),He("n3","n1"),He("f1","f2"),He("f2","f4"),He("f4","f3"),He("f3","f1"),He("n1","f1"),He("n2","f2"),He("n3","f3"),He("n4","f4"),He("p","n1"),He("p","n2"),He("p","n3"),He("p","n4"),He("u1","u2"),He("u2","u3"),He("u3","u1"),He("c","t"),He("p","c"),He("cn1","cn2"),He("cn3","cn4"),He("cf1","cf2"),He("cf3","cf4");function He(Lt,Ht){Ke(Lt),Ke(Ht)}function Ke(Lt){ye.push(0,0,0),Ie.push(0,0,0),Ue[Lt]===void 0&&(Ue[Lt]=[]),Ue[Lt].push(ye.length/3-1)}oe.setAttribute("position",new $i(ye,3)),oe.setAttribute("color",new $i(Ie,3)),super(oe,de),this.type="CameraHelper",this.camera=K,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=K.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Ue,this.update();const Ze=new Wr(16755200),at=new Wr(16711680),mt=new Wr(43775),vt=new Wr(16777215),St=new Wr(3355443);this.setColors(Ze,at,mt,vt,St)}setColors(K,oe,de,ye,Ie){const He=this.geometry.getAttribute("color");He.setXYZ(0,K.r,K.g,K.b),He.setXYZ(1,K.r,K.g,K.b),He.setXYZ(2,K.r,K.g,K.b),He.setXYZ(3,K.r,K.g,K.b),He.setXYZ(4,K.r,K.g,K.b),He.setXYZ(5,K.r,K.g,K.b),He.setXYZ(6,K.r,K.g,K.b),He.setXYZ(7,K.r,K.g,K.b),He.setXYZ(8,K.r,K.g,K.b),He.setXYZ(9,K.r,K.g,K.b),He.setXYZ(10,K.r,K.g,K.b),He.setXYZ(11,K.r,K.g,K.b),He.setXYZ(12,K.r,K.g,K.b),He.setXYZ(13,K.r,K.g,K.b),He.setXYZ(14,K.r,K.g,K.b),He.setXYZ(15,K.r,K.g,K.b),He.setXYZ(16,K.r,K.g,K.b),He.setXYZ(17,K.r,K.g,K.b),He.setXYZ(18,K.r,K.g,K.b),He.setXYZ(19,K.r,K.g,K.b),He.setXYZ(20,K.r,K.g,K.b),He.setXYZ(21,K.r,K.g,K.b),He.setXYZ(22,K.r,K.g,K.b),He.setXYZ(23,K.r,K.g,K.b),He.setXYZ(24,oe.r,oe.g,oe.b),He.setXYZ(25,oe.r,oe.g,oe.b),He.setXYZ(26,oe.r,oe.g,oe.b),He.setXYZ(27,oe.r,oe.g,oe.b),He.setXYZ(28,oe.r,oe.g,oe.b),He.setXYZ(29,oe.r,oe.g,oe.b),He.setXYZ(30,oe.r,oe.g,oe.b),He.setXYZ(31,oe.r,oe.g,oe.b),He.setXYZ(32,de.r,de.g,de.b),He.setXYZ(33,de.r,de.g,de.b),He.setXYZ(34,de.r,de.g,de.b),He.setXYZ(35,de.r,de.g,de.b),He.setXYZ(36,de.r,de.g,de.b),He.setXYZ(37,de.r,de.g,de.b),He.setXYZ(38,ye.r,ye.g,ye.b),He.setXYZ(39,ye.r,ye.g,ye.b),He.setXYZ(40,Ie.r,Ie.g,Ie.b),He.setXYZ(41,Ie.r,Ie.g,Ie.b),He.setXYZ(42,Ie.r,Ie.g,Ie.b),He.setXYZ(43,Ie.r,Ie.g,Ie.b),He.setXYZ(44,Ie.r,Ie.g,Ie.b),He.setXYZ(45,Ie.r,Ie.g,Ie.b),He.setXYZ(46,Ie.r,Ie.g,Ie.b),He.setXYZ(47,Ie.r,Ie.g,Ie.b),He.setXYZ(48,Ie.r,Ie.g,Ie.b),He.setXYZ(49,Ie.r,Ie.g,Ie.b),He.needsUpdate=!0}update(){const K=this.geometry,oe=this.pointMap,de=1,ye=1;t0.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),a0("c",oe,K,t0,0,0,-1),a0("t",oe,K,t0,0,0,1),a0("n1",oe,K,t0,-1,-1,-1),a0("n2",oe,K,t0,de,-1,-1),a0("n3",oe,K,t0,-1,ye,-1),a0("n4",oe,K,t0,de,ye,-1),a0("f1",oe,K,t0,-1,-1,1),a0("f2",oe,K,t0,de,-1,1),a0("f3",oe,K,t0,-1,ye,1),a0("f4",oe,K,t0,de,ye,1),a0("u1",oe,K,t0,de*.7,ye*1.1,-1),a0("u2",oe,K,t0,-.7,ye*1.1,-1),a0("u3",oe,K,t0,0,ye*2,-1),a0("cf1",oe,K,t0,-1,0,1),a0("cf2",oe,K,t0,de,0,1),a0("cf3",oe,K,t0,0,-1,1),a0("cf4",oe,K,t0,0,ye,1),a0("cn1",oe,K,t0,-1,0,-1),a0("cn2",oe,K,t0,de,0,-1),a0("cn3",oe,K,t0,0,-1,-1),a0("cn4",oe,K,t0,0,ye,-1),K.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function a0(Be,K,oe,de,ye,Ie,Ue){DA.set(ye,Ie,Ue).unproject(de);const He=K[Be];if(He!==void 0){const Ke=oe.getAttribute("position");for(let Ze=0,at=He.length;Ze<at;Ze++)Ke.setXYZ(He[Ze],DA.x,DA.y,DA.z)}}const PA=new Rs;class $v extends Fu{constructor(K,oe=16776960){const de=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ye=new Float32Array(8*3),Ie=new Ds;Ie.setIndex(new So(de,1)),Ie.setAttribute("position",new So(ye,3)),super(Ie,new bl({color:oe,toneMapped:!1})),this.object=K,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(K){if(K!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&PA.setFromObject(this.object),PA.isEmpty())return;const oe=PA.min,de=PA.max,ye=this.geometry.attributes.position,Ie=ye.array;Ie[0]=de.x,Ie[1]=de.y,Ie[2]=de.z,Ie[3]=oe.x,Ie[4]=de.y,Ie[5]=de.z,Ie[6]=oe.x,Ie[7]=oe.y,Ie[8]=de.z,Ie[9]=de.x,Ie[10]=oe.y,Ie[11]=de.z,Ie[12]=de.x,Ie[13]=de.y,Ie[14]=oe.z,Ie[15]=oe.x,Ie[16]=de.y,Ie[17]=oe.z,Ie[18]=oe.x,Ie[19]=oe.y,Ie[20]=oe.z,Ie[21]=de.x,Ie[22]=oe.y,Ie[23]=oe.z,ye.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(K){return this.object=K,this.update(),this}copy(K,oe){return super.copy(K,oe),this.object=K.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Xv extends Fu{constructor(K,oe=16776960){const de=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),ye=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],Ie=new Ds;Ie.setIndex(new So(de,1)),Ie.setAttribute("position",new $i(ye,3)),super(Ie,new bl({color:oe,toneMapped:!1})),this.box=K,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(K){const oe=this.box;oe.isEmpty()||(oe.getCenter(this.position),oe.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(K))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Kv extends fd{constructor(K,oe=1,de=16776960){const ye=de,Ie=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],Ue=new Ds;Ue.setAttribute("position",new $i(Ie,3)),Ue.computeBoundingSphere(),super(Ue,new bl({color:ye,toneMapped:!1})),this.type="PlaneHelper",this.plane=K,this.size=oe;const He=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],Ke=new Ds;Ke.setAttribute("position",new $i(He,3)),Ke.computeBoundingSphere(),this.add(new Zo(Ke,new Io({color:ye,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(K){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(K)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const bg=new vn;let FA,b2;class Yv extends uo{constructor(K=new vn(0,0,1),oe=new vn(0,0,0),de=1,ye=16776960,Ie=de*.2,Ue=Ie*.2){super(),this.type="ArrowHelper",FA===void 0&&(FA=new Ds,FA.setAttribute("position",new $i([0,0,0,0,1,0],3)),b2=new Yf(0,.5,1,5,1),b2.translate(0,-.5,0)),this.position.copy(oe),this.line=new fd(FA,new bl({color:ye,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Zo(b2,new Io({color:ye,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(K),this.setLength(de,Ie,Ue)}setDirection(K){if(K.y>.99999)this.quaternion.set(0,0,0,1);else if(K.y<-.99999)this.quaternion.set(1,0,0,0);else{bg.set(K.z,0,-K.x).normalize();const oe=Math.acos(K.y);this.quaternion.setFromAxisAngle(bg,oe)}}setLength(K,oe=K*.2,de=oe*.2){this.line.scale.set(1,Math.max(1e-4,K-oe),1),this.line.updateMatrix(),this.cone.scale.set(de,oe,de),this.cone.position.y=K,this.cone.updateMatrix()}setColor(K){this.line.material.color.set(K),this.cone.material.color.set(K)}copy(K){return super.copy(K,!1),this.line.copy(K.line),this.cone.copy(K.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class qv extends Fu{constructor(K=1){const oe=[0,0,0,K,0,0,0,0,0,0,K,0,0,0,0,0,0,K],de=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],ye=new Ds;ye.setAttribute("position",new $i(oe,3)),ye.setAttribute("color",new $i(de,3));const Ie=new bl({vertexColors:!0,toneMapped:!1});super(ye,Ie),this.type="AxesHelper"}setColors(K,oe,de){const ye=new Wr,Ie=this.geometry.attributes.color.array;return ye.set(K),ye.toArray(Ie,0),ye.toArray(Ie,3),ye.set(oe),ye.toArray(Ie,6),ye.toArray(Ie,9),ye.set(de),ye.toArray(Ie,12),ye.toArray(Ie,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Jv{constructor(){this.type="ShapePath",this.color=new Wr,this.subPaths=[],this.currentPath=null}moveTo(K,oe){return this.currentPath=new Mp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(K,oe),this}lineTo(K,oe){return this.currentPath.lineTo(K,oe),this}quadraticCurveTo(K,oe,de,ye){return this.currentPath.quadraticCurveTo(K,oe,de,ye),this}bezierCurveTo(K,oe,de,ye,Ie,Ue){return this.currentPath.bezierCurveTo(K,oe,de,ye,Ie,Ue),this}splineThru(K){return this.currentPath.splineThru(K),this}toShapes(K){function oe(bt){const tn=[];for(let Zt=0,qt=bt.length;Zt<qt;Zt++){const Un=bt[Zt],_n=new T1;_n.curves=Un.curves,tn.push(_n)}return tn}function de(bt,tn){const Zt=tn.length;let qt=!1;for(let Un=Zt-1,_n=0;_n<Zt;Un=_n++){let bn=tn[Un],Fn=tn[_n],pn=Fn.x-bn.x,cn=Fn.y-bn.y;if(Math.abs(cn)>Number.EPSILON){if(cn<0&&(bn=tn[_n],pn=-pn,Fn=tn[Un],cn=-cn),bt.y<bn.y||bt.y>Fn.y)continue;if(bt.y===bn.y){if(bt.x===bn.x)return!0}else{const On=cn*(bt.x-bn.x)-pn*(bt.y-bn.y);if(On===0)return!0;if(On<0)continue;qt=!qt}}else{if(bt.y!==bn.y)continue;if(Fn.x<=bt.x&&bt.x<=bn.x||bn.x<=bt.x&&bt.x<=Fn.x)return!0}}return qt}const ye=Ou.isClockWise,Ie=this.subPaths;if(Ie.length===0)return[];let Ue,He,Ke;const Ze=[];if(Ie.length===1)return He=Ie[0],Ke=new T1,Ke.curves=He.curves,Ze.push(Ke),Ze;let at=!ye(Ie[0].getPoints());at=K?!at:at;const mt=[],vt=[];let St=[],Lt=0,Ht;vt[Lt]=void 0,St[Lt]=[];for(let bt=0,tn=Ie.length;bt<tn;bt++)He=Ie[bt],Ht=He.getPoints(),Ue=ye(Ht),Ue=K?!Ue:Ue,Ue?(!at&&vt[Lt]&&Lt++,vt[Lt]={s:new T1,p:Ht},vt[Lt].s.curves=He.curves,at&&Lt++,St[Lt]=[]):St[Lt].push({h:He,p:Ht[0]});if(!vt[0])return oe(Ie);if(vt.length>1){let bt=!1,tn=0;for(let Zt=0,qt=vt.length;Zt<qt;Zt++)mt[Zt]=[];for(let Zt=0,qt=vt.length;Zt<qt;Zt++){const Un=St[Zt];for(let _n=0;_n<Un.length;_n++){const bn=Un[_n];let Fn=!0;for(let pn=0;pn<vt.length;pn++)de(bn.p,vt[pn].p)&&(Zt!==pn&&tn++,Fn?(Fn=!1,mt[pn].push(bn)):bt=!0);Fn&&mt[Zt].push(bn)}}tn>0&&bt===!1&&(St=mt)}let Dt;for(let bt=0,tn=vt.length;bt<tn;bt++){Ke=vt[bt].s,Ze.push(Ke),Dt=St[bt];for(let Zt=0,qt=Dt.length;Zt<qt;Zt++)Ke.holes.push(Dt[Zt].h)}return Ze}}class Zv extends ga{constructor(K=1,oe=1,de=1,ye={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(K,oe,{...ye,count:de}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:se}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=se)},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>Nr,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>ai,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>yi,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>Kn,KHR_DF_CHANNEL_RGBSDA_RED:()=>rn,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>Ui,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>st,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>$e,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>Pe,KHR_DF_MODEL_ASTC:()=>Ve,KHR_DF_MODEL_ETC1:()=>Ne,KHR_DF_MODEL_ETC1S:()=>Xe,KHR_DF_MODEL_ETC2:()=>ke,KHR_DF_MODEL_RGBSDA:()=>Oe,KHR_DF_MODEL_UNSPECIFIED:()=>Fe,KHR_DF_PRIMARIES_ACES:()=>Ir,KHR_DF_PRIMARIES_ACESCC:()=>Rr,KHR_DF_PRIMARIES_ADOBERGB:()=>kt,KHR_DF_PRIMARIES_BT2020:()=>Mn,KHR_DF_PRIMARIES_BT601_EBU:()=>Qi,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Zi,KHR_DF_PRIMARIES_BT709:()=>hi,KHR_DF_PRIMARIES_CIEXYZ:()=>Vr,KHR_DF_PRIMARIES_DISPLAYP3:()=>Br,KHR_DF_PRIMARIES_NTSC1953:()=>ir,KHR_DF_PRIMARIES_PAL525:()=>zr,KHR_DF_PRIMARIES_UNSPECIFIED:()=>fi,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>Bi,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>Ar,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>Kt,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>fr,KHR_DF_TRANSFER_ACESCC:()=>Cn,KHR_DF_TRANSFER_ACESCCT:()=>Nn,KHR_DF_TRANSFER_ADOBERGB:()=>Qn,KHR_DF_TRANSFER_BT1886:()=>Bt,KHR_DF_TRANSFER_DCIP3:()=>Xt,KHR_DF_TRANSFER_HLG_EOTF:()=>ut,KHR_DF_TRANSFER_HLG_OETF:()=>dt,KHR_DF_TRANSFER_ITU:()=>Rt,KHR_DF_TRANSFER_LINEAR:()=>tt,KHR_DF_TRANSFER_NTSC:()=>Mt,KHR_DF_TRANSFER_PAL625_EOTF:()=>nn,KHR_DF_TRANSFER_PAL_OETF:()=>hn,KHR_DF_TRANSFER_PQ_EOTF:()=>Ut,KHR_DF_TRANSFER_PQ_OETF:()=>Tt,KHR_DF_TRANSFER_SLOG:()=>Gt,KHR_DF_TRANSFER_SLOG2:()=>_t,KHR_DF_TRANSFER_SRGB:()=>ft,KHR_DF_TRANSFER_ST240:()=>An,KHR_DF_TRANSFER_UNSPECIFIED:()=>ze,KHR_DF_VENDORID_KHRONOS:()=>Le,KHR_DF_VERSION:()=>xe,KHR_SUPERCOMPRESSION_BASISLZ:()=>Te,KHR_SUPERCOMPRESSION_NONE:()=>me,KHR_SUPERCOMPRESSION_ZLIB:()=>be,KHR_SUPERCOMPRESSION_ZSTD:()=>Re,KTX2Container:()=>cl,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>Vt,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>yr,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Li,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>vi,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>Wi,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>gi,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>Dn,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>jn,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>Vn,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>Ul,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>Nl,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>Ol,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>qo,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>c0,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>oa,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>La,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>oc,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>hc,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>Wu,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Wa,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>gu,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>ac,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Ll,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>Ku,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>Dd,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>Dl,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>To,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>Wc,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>Pd,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>gs,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>Sh,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>wh,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>Pl,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>bh,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>Mh,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>Au,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>Sd,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>sc,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>Xu,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>bd,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>Md,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>Fl,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>Td,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>Th,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>cc,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>Rd,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Id,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>mu,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>Ld,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>Bd,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>uc,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>j0,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>zu,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>D0,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>Fd,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>$u,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>an,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>ot,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>Nt,VK_FORMAT_B8G8R8A8_SINT:()=>Jt,VK_FORMAT_B8G8R8A8_SNORM:()=>di,VK_FORMAT_B8G8R8A8_SRGB:()=>xn,VK_FORMAT_B8G8R8A8_UINT:()=>$t,VK_FORMAT_B8G8R8A8_UNORM:()=>qn,VK_FORMAT_B8G8R8_SINT:()=>l0,VK_FORMAT_B8G8R8_SNORM:()=>Do,VK_FORMAT_B8G8R8_SRGB:()=>Ra,VK_FORMAT_B8G8R8_UINT:()=>Ca,VK_FORMAT_B8G8R8_UNORM:()=>Ia,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>bo,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>Tc,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>Rl,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>bc,VK_FORMAT_BC2_SRGB_BLOCK:()=>Ic,VK_FORMAT_BC2_UNORM_BLOCK:()=>Bl,VK_FORMAT_BC3_SRGB_BLOCK:()=>P0,VK_FORMAT_BC3_UNORM_BLOCK:()=>x0,VK_FORMAT_BC4_SNORM_BLOCK:()=>zc,VK_FORMAT_BC4_UNORM_BLOCK:()=>Uu,VK_FORMAT_BC5_SNORM_BLOCK:()=>ku,VK_FORMAT_BC5_UNORM_BLOCK:()=>Ed,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>hu,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>Gu,VK_FORMAT_BC7_SRGB_BLOCK:()=>Eh,VK_FORMAT_BC7_UNORM_BLOCK:()=>Qu,VK_FORMAT_D16_UNORM:()=>Tl,VK_FORMAT_D16_UNORM_S8_UINT:()=>Ba,VK_FORMAT_D24_UNORM_S8_UINT:()=>lo,VK_FORMAT_D32_SFLOAT:()=>Va,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>za,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Z0,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>du,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>xh,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Ch,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>yh,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>Hu,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>xd,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>Vu,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>wd,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>Cd,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>yd,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>Xc,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>pu,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>$a,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>Lh,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Us,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>Dh,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>Ud,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>Ph,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>qi,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>Nd,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>$c,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>Rh,VK_FORMAT_R10X6_UNORM_PACK16:()=>Ih,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>Bh,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>Od,VK_FORMAT_R12X4_UNORM_PACK16:()=>fu,VK_FORMAT_R16G16B16A16_SFLOAT:()=>xi,VK_FORMAT_R16G16B16A16_SINT:()=>Yn,VK_FORMAT_R16G16B16A16_SNORM:()=>mn,VK_FORMAT_R16G16B16A16_UINT:()=>kn,VK_FORMAT_R16G16B16A16_UNORM:()=>jt,VK_FORMAT_R16G16B16_SFLOAT:()=>zt,VK_FORMAT_R16G16B16_SINT:()=>Ot,VK_FORMAT_R16G16B16_SNORM:()=>Ns,VK_FORMAT_R16G16B16_UINT:()=>It,VK_FORMAT_R16G16B16_UNORM:()=>bs,VK_FORMAT_R16G16_SFLOAT:()=>Ss,VK_FORMAT_R16G16_SINT:()=>Er,VK_FORMAT_R16G16_SNORM:()=>eo,VK_FORMAT_R16G16_UINT:()=>wo,VK_FORMAT_R16G16_UNORM:()=>Yr,VK_FORMAT_R16_SFLOAT:()=>as,VK_FORMAT_R16_SINT:()=>er,VK_FORMAT_R16_SNORM:()=>Ur,VK_FORMAT_R16_UINT:()=>hs,VK_FORMAT_R16_UNORM:()=>Sr,VK_FORMAT_R32G32B32A32_SFLOAT:()=>Ao,VK_FORMAT_R32G32B32A32_SINT:()=>$s,VK_FORMAT_R32G32B32A32_UINT:()=>ds,VK_FORMAT_R32G32B32_SFLOAT:()=>ys,VK_FORMAT_R32G32B32_SINT:()=>Ls,VK_FORMAT_R32G32B32_UINT:()=>As,VK_FORMAT_R32G32_SFLOAT:()=>Ki,VK_FORMAT_R32G32_SINT:()=>Gr,VK_FORMAT_R32G32_UINT:()=>cr,VK_FORMAT_R32_SFLOAT:()=>bi,VK_FORMAT_R32_SINT:()=>ti,VK_FORMAT_R32_UINT:()=>zi,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>on,VK_FORMAT_R4G4_UNORM_PACK8:()=>fn,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>ht,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>gn,VK_FORMAT_R64G64B64A64_SFLOAT:()=>H0,VK_FORMAT_R64G64B64A64_SINT:()=>C0,VK_FORMAT_R64G64B64A64_UINT:()=>J0,VK_FORMAT_R64G64B64_SFLOAT:()=>L0,VK_FORMAT_R64G64B64_SINT:()=>ma,VK_FORMAT_R64G64B64_UINT:()=>na,VK_FORMAT_R64G64_SFLOAT:()=>Aa,VK_FORMAT_R64G64_SINT:()=>zo,VK_FORMAT_R64G64_UINT:()=>pa,VK_FORMAT_R64_SFLOAT:()=>fa,VK_FORMAT_R64_SINT:()=>mo,VK_FORMAT_R64_UINT:()=>Po,VK_FORMAT_R8G8B8A8_SINT:()=>q0,VK_FORMAT_R8G8B8A8_SNORM:()=>Ts,VK_FORMAT_R8G8B8A8_SRGB:()=>dn,VK_FORMAT_R8G8B8A8_UINT:()=>ta,VK_FORMAT_R8G8B8A8_UNORM:()=>ko,VK_FORMAT_R8G8B8_SINT:()=>Vo,VK_FORMAT_R8G8B8_SNORM:()=>js,VK_FORMAT_R8G8B8_SRGB:()=>Mo,VK_FORMAT_R8G8B8_UINT:()=>Qs,VK_FORMAT_R8G8B8_UNORM:()=>Ai,VK_FORMAT_R8G8_SINT:()=>Ws,VK_FORMAT_R8G8_SNORM:()=>ji,VK_FORMAT_R8G8_SRGB:()=>Jr,VK_FORMAT_R8G8_UINT:()=>Xi,VK_FORMAT_R8G8_UNORM:()=>Hi,VK_FORMAT_R8_SINT:()=>ni,VK_FORMAT_R8_SNORM:()=>sn,VK_FORMAT_R8_SRGB:()=>ki,VK_FORMAT_R8_UINT:()=>yn,VK_FORMAT_R8_UNORM:()=>Wt,VK_FORMAT_S8_UINT:()=>V0,VK_FORMAT_UNDEFINED:()=>Yt,VK_FORMAT_X8_D24_UNORM_PACK32:()=>Il,read:()=>go,write:()=>Rc});var se=ve("./node_modules/buffer/index.js").Buffer;const me=0,Te=1,Re=2,be=3,Pe=0,Le=0,xe=2,Fe=0,Oe=1,Ne=160,ke=161,Ve=162,Xe=163,$e=0,st=1,ze=0,tt=1,ft=2,Rt=3,Mt=4,Gt=5,_t=6,Bt=7,dt=8,ut=9,Ut=10,Tt=11,Xt=12,hn=13,nn=14,An=15,Cn=16,Nn=17,Qn=18,fi=0,hi=1,Qi=2,Zi=3,Mn=4,Vr=5,Ir=6,Rr=7,ir=8,zr=9,Br=10,kt=11,rn=0,Kn=1,ai=2,Ui=13,yi=14,Nr=15,Ar=128,fr=64,Bi=32,Kt=16,Yt=0,fn=1,on=2,an=3,gn=4,Nt=5,ht=6,ot=7,Vt=8,Wt=9,sn=10,yn=13,ni=14,ki=15,Hi=16,ji=17,Xi=20,Ws=21,Jr=22,Ai=23,js=24,Qs=27,Vo=28,Mo=29,Ia=30,Do=31,Ca=34,l0=35,Ra=36,ko=37,Ts=38,ta=41,q0=42,dn=43,qn=44,di=45,$t=48,Jt=49,xn=50,Vn=58,Dn=59,jn=62,gi=63,Wi=64,Li=65,vi=68,yr=69,Sr=70,Ur=71,hs=74,er=75,as=76,Yr=77,eo=78,wo=81,Er=82,Ss=83,bs=84,Ns=85,It=88,Ot=89,zt=90,jt=91,mn=92,kn=95,Yn=96,xi=97,zi=98,ti=99,bi=100,cr=101,Gr=102,Ki=103,As=104,Ls=105,ys=106,ds=107,$s=108,Ao=109,Po=110,mo=111,fa=112,pa=113,zo=114,Aa=115,na=116,ma=117,L0=118,J0=119,C0=120,H0=121,D0=122,Z0=123,Tl=124,Il=125,Va=126,V0=127,Ba=128,lo=129,za=130,bc=131,Rl=132,Tc=133,bo=134,Bl=135,Ic=136,x0=137,P0=138,Uu=139,zc=140,Ed=141,ku=142,Gu=143,hu=144,Qu=145,Eh=146,yd=147,Cd=148,xd=149,Hu=150,wd=151,Vu=152,yh=153,Ch=154,xh=155,du=156,wh=157,Sh=158,Mh=159,bh=160,sc=161,Sd=162,Md=163,bd=164,Th=165,Td=166,Id=167,Rd=168,Bd=169,Ld=170,zu=171,j0=172,oc=173,La=174,Wa=175,Wu=176,Ll=177,ac=178,c0=179,qo=180,Dl=181,Dd=182,Pd=183,Wc=184,Ih=1000156007,Rh=1000156008,$c=1000156009,Xc=1000156010,Fd=1000156011,fu=1000156017,Od=1000156018,Bh=1000156019,pu=1000156020,$u=1000156021,Lh=1000054e3,Dh=1000054001,Ph=1000054002,Nd=1000054003,$a=1000054004,Us=1000054005,Ud=1000054006,qi=1000054007,gs=1000066e3,Pl=1000066001,Au=1000066002,Xu=1000066003,Fl=1000066004,cc=1000066005,mu=1000066006,uc=1000066007,oa=1000066008,hc=1000066009,gu=1000066010,Ol=1000066011,Ku=1000066012,To=1000066013,Nl=100034e4,Ul=1000340001;class cl{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class dc{constructor(Fs,co,to,vn){this._dataView=new DataView(Fs.buffer,Fs.byteOffset+co,to),this._littleEndian=vn,this._offset=0}_nextUint8(){const Fs=this._dataView.getUint8(this._offset);return this._offset+=1,Fs}_nextUint16(){const Fs=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Fs}_nextUint32(){const Fs=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Fs}_nextUint64(){const Fs=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Fs}_nextInt32(){const Fs=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Fs}_skip(Fs){return this._offset+=Fs,this}_scan(Fs,co=0){const to=this._offset;let vn=0;for(;this._dataView.getUint8(this._offset)!==co&&vn<Fs;)vn++,this._offset++;return vn<Fs&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+to,vn)}}const Kc=new Uint8Array([0]),Wo=[171,75,84,88,32,50,48,187,13,10,26,10];function Yc(Kr){return typeof TextEncoder<"u"?new TextEncoder().encode(Kr):se.from(Kr)}function Yu(Kr){return typeof TextDecoder<"u"?new TextDecoder().decode(Kr):se.from(Kr).toString("utf8")}function Fo(Kr){let Fs=0;for(const vn of Kr)Fs+=vn.byteLength;const co=new Uint8Array(Fs);let to=0;for(const vn of Kr)co.set(new Uint8Array(vn),to),to+=vn.byteLength;return co}function go(Kr){const Fs=new Uint8Array(Kr.buffer,Kr.byteOffset,Wo.length);if(Fs[0]!==Wo[0]||Fs[1]!==Wo[1]||Fs[2]!==Wo[2]||Fs[3]!==Wo[3]||Fs[4]!==Wo[4]||Fs[5]!==Wo[5]||Fs[6]!==Wo[6]||Fs[7]!==Wo[7]||Fs[8]!==Wo[8]||Fs[9]!==Wo[9]||Fs[10]!==Wo[10]||Fs[11]!==Wo[11])throw new Error("Missing KTX 2.0 identifier.");const co=new cl,to=17*Uint32Array.BYTES_PER_ELEMENT,vn=new dc(Kr,Wo.length,to,!0);co.vkFormat=vn._nextUint32(),co.typeSize=vn._nextUint32(),co.pixelWidth=vn._nextUint32(),co.pixelHeight=vn._nextUint32(),co.pixelDepth=vn._nextUint32(),co.layerCount=vn._nextUint32(),co.faceCount=vn._nextUint32();const u0=vn._nextUint32();co.supercompressionScheme=vn._nextUint32();const $o=vn._nextUint32(),Rs=vn._nextUint32(),Zs=vn._nextUint32(),Da=vn._nextUint32(),F0=vn._nextUint64(),w0=vn._nextUint64(),xa=new dc(Kr,Wo.length+to,3*u0*8,!0);for(let Jo=0;Jo<u0;Jo++)co.levels.push({levelData:new Uint8Array(Kr.buffer,Kr.byteOffset+xa._nextUint64(),xa._nextUint64()),uncompressedByteLength:xa._nextUint64()});const Ms=new dc(Kr,$o,Rs,!0),Is={vendorId:Ms._skip(4)._nextUint16(),descriptorType:Ms._nextUint16(),versionNumber:Ms._nextUint16(),descriptorBlockSize:Ms._nextUint16(),colorModel:Ms._nextUint8(),colorPrimaries:Ms._nextUint8(),transferFunction:Ms._nextUint8(),flags:Ms._nextUint8(),texelBlockDimension:[Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8()],bytesPlane:[Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8()],samples:[]},aa=(Is.descriptorBlockSize/4-6)/4;for(let Jo=0;Jo<aa;Jo++){const kr={bitOffset:Ms._nextUint16(),bitLength:Ms._nextUint8(),channelType:Ms._nextUint8(),samplePosition:[Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8(),Ms._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&kr.channelType?(kr.sampleLower=Ms._nextInt32(),kr.sampleUpper=Ms._nextInt32()):(kr.sampleLower=Ms._nextUint32(),kr.sampleUpper=Ms._nextUint32()),Is.samples[Jo]=kr}co.dataFormatDescriptor.length=0,co.dataFormatDescriptor.push(Is);const Pa=new dc(Kr,Zs,Da,!0);for(;Pa._offset<Da;){const Jo=Pa._nextUint32(),kr=Pa._scan(Jo),ia=Yu(kr),Eo=Pa._scan(Jo-kr.byteLength);co.keyValue[ia]=ia.match(/^ktx/i)?Yu(Eo):Eo,Pa._offset%4&&Pa._skip(4-Pa._offset%4)}if(w0<=0)return co;const vo=new dc(Kr,F0,w0,!0),Xs=vo._nextUint16(),Lr=vo._nextUint16(),Hs=vo._nextUint32(),Xa=vo._nextUint32(),ul=vo._nextUint32(),hl=vo._nextUint32(),pc=[];for(let Jo=0;Jo<u0;Jo++)pc.push({imageFlags:vo._nextUint32(),rgbSliceByteOffset:vo._nextUint32(),rgbSliceByteLength:vo._nextUint32(),alphaSliceByteOffset:vo._nextUint32(),alphaSliceByteLength:vo._nextUint32()});const la=F0+vo._offset,el=la+Hs,kl=el+Xa,qc=kl+ul,Gl=new Uint8Array(Kr.buffer,Kr.byteOffset+la,Hs),Jc=new Uint8Array(Kr.buffer,Kr.byteOffset+el,Xa),z0=new Uint8Array(Kr.buffer,Kr.byteOffset+kl,ul),Zc=new Uint8Array(Kr.buffer,Kr.byteOffset+qc,hl);return co.globalData={endpointCount:Xs,selectorCount:Lr,imageDescs:pc,endpointsData:Gl,selectorsData:Jc,tablesData:z0,extendedData:Zc},co}function fc(){return(fc=Object.assign||function(Kr){for(var Fs=1;Fs<arguments.length;Fs++){var co=arguments[Fs];for(var to in co)Object.prototype.hasOwnProperty.call(co,to)&&(Kr[to]=co[to])}return Kr}).apply(this,arguments)}const ga={keepWriter:!1};function Rc(Kr,Fs={}){Fs=fc({},ga,Fs);let co=new ArrayBuffer(0);if(Kr.globalData){const Xs=new ArrayBuffer(20+5*Kr.globalData.imageDescs.length*4),Lr=new DataView(Xs);Lr.setUint16(0,Kr.globalData.endpointCount,!0),Lr.setUint16(2,Kr.globalData.selectorCount,!0),Lr.setUint32(4,Kr.globalData.endpointsData.byteLength,!0),Lr.setUint32(8,Kr.globalData.selectorsData.byteLength,!0),Lr.setUint32(12,Kr.globalData.tablesData.byteLength,!0),Lr.setUint32(16,Kr.globalData.extendedData.byteLength,!0);for(let Hs=0;Hs<Kr.globalData.imageDescs.length;Hs++){const Xa=Kr.globalData.imageDescs[Hs];Lr.setUint32(20+5*Hs*4+0,Xa.imageFlags,!0),Lr.setUint32(20+5*Hs*4+4,Xa.rgbSliceByteOffset,!0),Lr.setUint32(20+5*Hs*4+8,Xa.rgbSliceByteLength,!0),Lr.setUint32(20+5*Hs*4+12,Xa.alphaSliceByteOffset,!0),Lr.setUint32(20+5*Hs*4+16,Xa.alphaSliceByteLength,!0)}co=Fo([Xs,Kr.globalData.endpointsData,Kr.globalData.selectorsData,Kr.globalData.tablesData,Kr.globalData.extendedData])}const to=[];let vn=Kr.keyValue;Fs.keepWriter||(vn=fc({},Kr.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const Xs in vn){const Lr=vn[Xs],Hs=Yc(Xs),Xa=typeof Lr=="string"?Yc(Lr):Lr,ul=Hs.byteLength+1+Xa.byteLength+1,hl=ul%4?4-ul%4:0;to.push(Fo([new Uint32Array([ul]),Hs,Kc,Xa,Kc,new Uint8Array(hl).fill(0)]))}const u0=Fo(to);if(Kr.dataFormatDescriptor.length!==1||Kr.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const $o=Kr.dataFormatDescriptor[0],Rs=new ArrayBuffer(28+16*$o.samples.length),Zs=new DataView(Rs),Da=24+16*$o.samples.length;if(Zs.setUint32(0,Rs.byteLength,!0),Zs.setUint16(4,$o.vendorId,!0),Zs.setUint16(6,$o.descriptorType,!0),Zs.setUint16(8,$o.versionNumber,!0),Zs.setUint16(10,Da,!0),Zs.setUint8(12,$o.colorModel),Zs.setUint8(13,$o.colorPrimaries),Zs.setUint8(14,$o.transferFunction),Zs.setUint8(15,$o.flags),!Array.isArray($o.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");Zs.setUint8(16,$o.texelBlockDimension[0]),Zs.setUint8(17,$o.texelBlockDimension[1]),Zs.setUint8(18,$o.texelBlockDimension[2]),Zs.setUint8(19,$o.texelBlockDimension[3]);for(let Xs=0;Xs<8;Xs++)Zs.setUint8(20+Xs,$o.bytesPlane[Xs]);for(let Xs=0;Xs<$o.samples.length;Xs++){const Lr=$o.samples[Xs],Hs=28+16*Xs;if(Lr.channelID)throw new Error("channelID has been renamed to channelType.");Zs.setUint16(Hs+0,Lr.bitOffset,!0),Zs.setUint8(Hs+2,Lr.bitLength),Zs.setUint8(Hs+3,Lr.channelType),Zs.setUint8(Hs+4,Lr.samplePosition[0]),Zs.setUint8(Hs+5,Lr.samplePosition[1]),Zs.setUint8(Hs+6,Lr.samplePosition[2]),Zs.setUint8(Hs+7,Lr.samplePosition[3]),64&Lr.channelType?(Zs.setInt32(Hs+8,Lr.sampleLower,!0),Zs.setInt32(Hs+12,Lr.sampleUpper,!0)):(Zs.setUint32(Hs+8,Lr.sampleLower,!0),Zs.setUint32(Hs+12,Lr.sampleUpper,!0))}const F0=Wo.length+68+3*Kr.levels.length*8,w0=F0+Rs.byteLength;let xa=co.byteLength>0?w0+u0.byteLength:0;xa%8&&(xa+=8-xa%8);const Ms=[],Is=new DataView(new ArrayBuffer(3*Kr.levels.length*8));let aa=(xa||w0+u0.byteLength)+co.byteLength;for(let Xs=0;Xs<Kr.levels.length;Xs++){const Lr=Kr.levels[Xs];Ms.push(Lr.levelData),Is.setBigUint64(24*Xs+0,BigInt(aa),!0),Is.setBigUint64(24*Xs+8,BigInt(Lr.levelData.byteLength),!0),Is.setBigUint64(24*Xs+16,BigInt(Lr.uncompressedByteLength),!0),aa+=Lr.levelData.byteLength}const Pa=new ArrayBuffer(68),vo=new DataView(Pa);return vo.setUint32(0,Kr.vkFormat,!0),vo.setUint32(4,Kr.typeSize,!0),vo.setUint32(8,Kr.pixelWidth,!0),vo.setUint32(12,Kr.pixelHeight,!0),vo.setUint32(16,Kr.pixelDepth,!0),vo.setUint32(20,Kr.layerCount,!0),vo.setUint32(24,Kr.faceCount,!0),vo.setUint32(28,Kr.levels.length,!0),vo.setUint32(32,Kr.supercompressionScheme,!0),vo.setUint32(36,F0,!0),vo.setUint32(40,Rs.byteLength,!0),vo.setUint32(44,w0,!0),vo.setUint32(48,u0.byteLength,!0),vo.setBigUint64(52,BigInt(co.byteLength>0?xa:0),!0),vo.setBigUint64(60,BigInt(co.byteLength),!0),new Uint8Array(Fo([new Uint8Array(Wo).buffer,Pa,Is.buffer,Rs,u0,xa>0?new ArrayBuffer(xa-(w0+u0.byteLength)):new ArrayBuffer(0),co,...Ms]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{ZSTDDecoder:()=>Pe});var se=ve("./node_modules/buffer/index.js").Buffer;let me,Te,Re;const be={env:{emscripten_notify_memory_growth:function(xe){Re=new Uint8Array(Te.exports.memory.buffer)}}};class Pe{init(){return me||(me=typeof fetch<"u"?fetch("data:application/wasm;base64,"+Le).then(Fe=>Fe.arrayBuffer()).then(Fe=>WebAssembly.instantiate(Fe,be)).then(this._init):WebAssembly.instantiate(se.from(Le,"base64"),be).then(this._init),me)}_init(Fe){Te=Fe.instance,be.env.emscripten_notify_memory_growth(0)}decode(Fe,Oe=0){if(!Te)throw new Error("ZSTDDecoder: Await .init() before decoding.");const Ne=Fe.byteLength,ke=Te.exports.malloc(Ne);Re.set(Fe,ke),Oe=Oe||Number(Te.exports.ZSTD_findDecompressedSize(ke,Ne));const Ve=Te.exports.malloc(Oe),Xe=Te.exports.ZSTD_decompress(Ve,Oe,ke,Ne),$e=Re.slice(Ve,Ve+Xe);return Te.exports.free(ke),Te.exports.free(Ve),$e}}const Le="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{LightProbeGenerator:()=>me});var se=ve("./node_modules/three/build/three.module.js");class me{static fromCubeTexture(be){let Pe=0;const Le=new se.Vector3,xe=new se.Vector3,Fe=new se.Color,Oe=[0,0,0,0,0,0,0,0,0],Ne=new se.SphericalHarmonics3,ke=Ne.coefficients;for(let Xe=0;Xe<6;Xe++){const $e=be.image[Xe],st=$e.width,ze=$e.height,tt=document.createElement("canvas");tt.width=st,tt.height=ze;const ft=tt.getContext("2d");ft.drawImage($e,0,0,st,ze);const Rt=ft.getImageData(0,0,st,ze),Mt=Rt.data,Gt=Rt.width,_t=2/Gt;for(let Bt=0,dt=Mt.length;Bt<dt;Bt+=4){Fe.setRGB(Mt[Bt]/255,Mt[Bt+1]/255,Mt[Bt+2]/255),Te(Fe,be.colorSpace);const ut=Bt/4,Ut=-1+(ut%Gt+.5)*_t,Tt=1-(Math.floor(ut/Gt)+.5)*_t;switch(Xe){case 0:Le.set(-1,Tt,-Ut);break;case 1:Le.set(1,Tt,Ut);break;case 2:Le.set(-Ut,1,-Tt);break;case 3:Le.set(-Ut,-1,Tt);break;case 4:Le.set(-Ut,Tt,1);break;case 5:Le.set(Ut,Tt,-1);break}const Xt=Le.lengthSq(),hn=4/(Math.sqrt(Xt)*Xt);Pe+=hn,xe.copy(Le).normalize(),se.SphericalHarmonics3.getBasisAt(xe,Oe);for(let nn=0;nn<9;nn++)ke[nn].x+=Oe[nn]*Fe.r*hn,ke[nn].y+=Oe[nn]*Fe.g*hn,ke[nn].z+=Oe[nn]*Fe.b*hn}}const Ve=4*Math.PI/Pe;for(let Xe=0;Xe<9;Xe++)ke[Xe].x*=Ve,ke[Xe].y*=Ve,ke[Xe].z*=Ve;return new se.LightProbe(Ne)}static fromCubeRenderTarget(be,Pe){let Le=0;const xe=new se.Vector3,Fe=new se.Vector3,Oe=new se.Color,Ne=[0,0,0,0,0,0,0,0,0],ke=new se.SphericalHarmonics3,Ve=ke.coefficients,Xe=Pe.texture.type;for(let st=0;st<6;st++){const ze=Pe.width;let tt;Xe===se.HalfFloatType?tt=new Uint16Array(ze*ze*4):tt=new Uint8Array(ze*ze*4),be.readRenderTargetPixels(Pe,0,0,ze,ze,tt,st);const ft=2/ze;for(let Rt=0,Mt=tt.length;Rt<Mt;Rt+=4){let Gt,_t,Bt;Xe===se.HalfFloatType?(Gt=se.DataUtils.fromHalfFloat(tt[Rt]),_t=se.DataUtils.fromHalfFloat(tt[Rt+1]),Bt=se.DataUtils.fromHalfFloat(tt[Rt+2])):(Gt=tt[Rt]/255,_t=tt[Rt+1]/255,Bt=tt[Rt+2]/255),Oe.setRGB(Gt,_t,Bt),Te(Oe,Pe.texture.colorSpace);const dt=Rt/4,ut=-1+(dt%ze+.5)*ft,Ut=1-(Math.floor(dt/ze)+.5)*ft;switch(st){case 0:xe.set(1,Ut,-ut);break;case 1:xe.set(-1,Ut,ut);break;case 2:xe.set(ut,1,-Ut);break;case 3:xe.set(ut,-1,Ut);break;case 4:xe.set(ut,Ut,1);break;case 5:xe.set(-ut,Ut,-1);break}const Tt=xe.lengthSq(),Xt=4/(Math.sqrt(Tt)*Tt);Le+=Xt,Fe.copy(xe).normalize(),se.SphericalHarmonics3.getBasisAt(Fe,Ne);for(let hn=0;hn<9;hn++)Ve[hn].x+=Ne[hn]*Oe.r*Xt,Ve[hn].y+=Ne[hn]*Oe.g*Xt,Ve[hn].z+=Ne[hn]*Oe.b*Xt}}const $e=4*Math.PI/Le;for(let st=0;st<9;st++)Ve[st].x*=$e,Ve[st].y*=$e,Ve[st].z*=$e;return new se.LightProbe(ke)}}function Te(Re,be){switch(be){case se.SRGBColorSpace:Re.convertSRGBToLinear();break;case se.LinearSRGBColorSpace:case se.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return Re}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{DRACOLoader:()=>Te});var se=ve("./node_modules/three/build/three.module.js");const me=new WeakMap;class Te extends se.Loader{constructor(Pe){super(Pe),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(Pe){return this.decoderPath=Pe,this}setDecoderConfig(Pe){return this.decoderConfig=Pe,this}setWorkerLimit(Pe){return this.workerLimit=Pe,this}load(Pe,Le,xe,Fe){const Oe=new se.FileLoader(this.manager);Oe.setPath(this.path),Oe.setResponseType("arraybuffer"),Oe.setRequestHeader(this.requestHeader),Oe.setWithCredentials(this.withCredentials),Oe.load(Pe,Ne=>{this.parse(Ne,Le,Fe)},xe,Fe)}parse(Pe,Le,xe=()=>{}){this.decodeDracoFile(Pe,Le,null,null,se.SRGBColorSpace).catch(xe)}decodeDracoFile(Pe,Le,xe,Fe,Oe=se.LinearSRGBColorSpace,Ne=()=>{}){const ke={attributeIDs:xe||this.defaultAttributeIDs,attributeTypes:Fe||this.defaultAttributeTypes,useUniqueIDs:!!xe,vertexColorSpace:Oe};return this.decodeGeometry(Pe,ke).then(Le).catch(Ne)}decodeGeometry(Pe,Le){const xe=JSON.stringify(Le);if(me.has(Pe)){const Ve=me.get(Pe);if(Ve.key===xe)return Ve.promise;if(Pe.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let Fe;const Oe=this.workerNextTaskID++,Ne=Pe.byteLength,ke=this._getWorker(Oe,Ne).then(Ve=>(Fe=Ve,new Promise((Xe,$e)=>{Fe._callbacks[Oe]={resolve:Xe,reject:$e},Fe.postMessage({type:"decode",id:Oe,taskConfig:Le,buffer:Pe},[Pe])}))).then(Ve=>this._createGeometry(Ve.geometry));return ke.catch(()=>!0).then(()=>{Fe&&Oe&&this._releaseTask(Fe,Oe)}),me.set(Pe,{key:xe,promise:ke}),ke}_createGeometry(Pe){const Le=new se.BufferGeometry;Pe.index&&Le.setIndex(new se.BufferAttribute(Pe.index.array,1));for(let xe=0;xe<Pe.attributes.length;xe++){const Fe=Pe.attributes[xe],Oe=Fe.name,Ne=Fe.array,ke=Fe.itemSize,Ve=new se.BufferAttribute(Ne,ke);Oe==="color"&&(this._assignVertexColorSpace(Ve,Fe.vertexColorSpace),Ve.normalized=!(Ne instanceof Float32Array)),Le.setAttribute(Oe,Ve)}return Le}_assignVertexColorSpace(Pe,Le){if(Le!==se.SRGBColorSpace)return;const xe=new se.Color;for(let Fe=0,Oe=Pe.count;Fe<Oe;Fe++)xe.fromBufferAttribute(Pe,Fe).convertSRGBToLinear(),Pe.setXYZ(Fe,xe.r,xe.g,xe.b)}_loadLibrary(Pe,Le){const xe=new se.FileLoader(this.manager);return xe.setPath(this.decoderPath),xe.setResponseType(Le),xe.setWithCredentials(this.withCredentials),new Promise((Fe,Oe)=>{xe.load(Pe,Fe,void 0,Oe)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const Pe=typeof WebAssembly!="object"||this.decoderConfig.type==="js",Le=[];return Pe?Le.push(this._loadLibrary("draco_decoder.js","text")):(Le.push(this._loadLibrary("draco_wasm_wrapper.js","text")),Le.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(Le).then(xe=>{const Fe=xe[0];Pe||(this.decoderConfig.wasmBinary=xe[1]);const Oe=Re.toString(),Ne=["/* draco decoder */",Fe,"","/* worker */",Oe.substring(Oe.indexOf("{")+1,Oe.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Ne]))}),this.decoderPending}_getWorker(Pe,Le){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const Fe=new Worker(this.workerSourceURL);Fe._callbacks={},Fe._taskCosts={},Fe._taskLoad=0,Fe.postMessage({type:"init",decoderConfig:this.decoderConfig}),Fe.onmessage=function(Oe){const Ne=Oe.data;switch(Ne.type){case"decode":Fe._callbacks[Ne.id].resolve(Ne);break;case"error":Fe._callbacks[Ne.id].reject(Ne);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+Ne.type+'"')}},this.workerPool.push(Fe)}else this.workerPool.sort(function(Fe,Oe){return Fe._taskLoad>Oe._taskLoad?-1:1});const xe=this.workerPool[this.workerPool.length-1];return xe._taskCosts[Pe]=Le,xe._taskLoad+=Le,xe})}_releaseTask(Pe,Le){Pe._taskLoad-=Pe._taskCosts[Le],delete Pe._callbacks[Le],delete Pe._taskCosts[Le]}debug(){console.log("Task load: ",this.workerPool.map(Pe=>Pe._taskLoad))}dispose(){for(let Pe=0;Pe<this.workerPool.length;++Pe)this.workerPool[Pe].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Re(){let be,Pe;onmessage=function(Ne){const ke=Ne.data;switch(ke.type){case"init":be=ke.decoderConfig,Pe=new Promise(function($e){be.onModuleLoaded=function(st){$e({draco:st})},DracoDecoderModule(be)});break;case"decode":const Ve=ke.buffer,Xe=ke.taskConfig;Pe.then($e=>{const st=$e.draco,ze=new st.Decoder;try{const tt=Le(st,ze,new Int8Array(Ve),Xe),ft=tt.attributes.map(Rt=>Rt.array.buffer);tt.index&&ft.push(tt.index.array.buffer),self.postMessage({type:"decode",id:ke.id,geometry:tt},ft)}catch(tt){console.error(tt),self.postMessage({type:"error",id:ke.id,error:tt.message})}finally{st.destroy(ze)}});break}};function Le(Ne,ke,Ve,Xe){const $e=Xe.attributeIDs,st=Xe.attributeTypes;let ze,tt;const ft=ke.GetEncodedGeometryType(Ve);if(ft===Ne.TRIANGULAR_MESH)ze=new Ne.Mesh,tt=ke.DecodeArrayToMesh(Ve,Ve.byteLength,ze);else if(ft===Ne.POINT_CLOUD)ze=new Ne.PointCloud,tt=ke.DecodeArrayToPointCloud(Ve,Ve.byteLength,ze);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!tt.ok()||ze.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+tt.error_msg());const Rt={index:null,attributes:[]};for(const Mt in $e){const Gt=self[st[Mt]];let _t,Bt;if(Xe.useUniqueIDs)Bt=$e[Mt],_t=ke.GetAttributeByUniqueId(ze,Bt);else{if(Bt=ke.GetAttributeId(ze,Ne[$e[Mt]]),Bt===-1)continue;_t=ke.GetAttribute(ze,Bt)}const dt=Fe(Ne,ke,ze,Mt,Gt,_t);Mt==="color"&&(dt.vertexColorSpace=Xe.vertexColorSpace),Rt.attributes.push(dt)}return ft===Ne.TRIANGULAR_MESH&&(Rt.index=xe(Ne,ke,ze)),Ne.destroy(ze),Rt}function xe(Ne,ke,Ve){const $e=Ve.num_faces()*3,st=$e*4,ze=Ne._malloc(st);ke.GetTrianglesUInt32Array(Ve,st,ze);const tt=new Uint32Array(Ne.HEAPF32.buffer,ze,$e).slice();return Ne._free(ze),{array:tt,itemSize:1}}function Fe(Ne,ke,Ve,Xe,$e,st){const ze=st.num_components(),ft=Ve.num_points()*ze,Rt=ft*$e.BYTES_PER_ELEMENT,Mt=Oe(Ne,$e),Gt=Ne._malloc(Rt);ke.GetAttributeDataArrayForAllPoints(Ve,st,Mt,Rt,Gt);const _t=new $e(Ne.HEAPF32.buffer,Gt,ft).slice();return Ne._free(Gt),{name:Xe,array:_t,itemSize:ze}}function Oe(Ne,ke){switch(ke){case Float32Array:return Ne.DT_FLOAT32;case Int8Array:return Ne.DT_INT8;case Int16Array:return Ne.DT_INT16;case Int32Array:return Ne.DT_INT32;case Uint8Array:return Ne.DT_UINT8;case Uint16Array:return Ne.DT_UINT16;case Uint32Array:return Ne.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{GLTFLoader:()=>Te});var se=ve("./node_modules/three/build/three.module.js"),me=ve("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class Te extends se.Loader{constructor(Kt){super(Kt),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(Yt){return new Fe(Yt)}),this.register(function(Yt){return new Oe(Yt)}),this.register(function(Yt){return new ft(Yt)}),this.register(function(Yt){return new Rt(Yt)}),this.register(function(Yt){return new Mt(Yt)}),this.register(function(Yt){return new ke(Yt)}),this.register(function(Yt){return new Ve(Yt)}),this.register(function(Yt){return new Xe(Yt)}),this.register(function(Yt){return new $e(Yt)}),this.register(function(Yt){return new xe(Yt)}),this.register(function(Yt){return new st(Yt)}),this.register(function(Yt){return new Ne(Yt)}),this.register(function(Yt){return new tt(Yt)}),this.register(function(Yt){return new ze(Yt)}),this.register(function(Yt){return new Pe(Yt)}),this.register(function(Yt){return new Gt(Yt)}),this.register(function(Yt){return new _t(Yt)})}load(Kt,Yt,fn,on){const an=this;let gn;if(this.resourcePath!=="")gn=this.resourcePath;else if(this.path!==""){const ot=se.LoaderUtils.extractUrlBase(Kt);gn=se.LoaderUtils.resolveURL(ot,this.path)}else gn=se.LoaderUtils.extractUrlBase(Kt);this.manager.itemStart(Kt);const Nt=function(ot){on?on(ot):console.error(ot),an.manager.itemError(Kt),an.manager.itemEnd(Kt)},ht=new se.FileLoader(this.manager);ht.setPath(this.path),ht.setResponseType("arraybuffer"),ht.setRequestHeader(this.requestHeader),ht.setWithCredentials(this.withCredentials),ht.load(Kt,function(ot){try{an.parse(ot,gn,function(Vt){Yt(Vt),an.manager.itemEnd(Kt)},Nt)}catch(Vt){Nt(Vt)}},fn,Nt)}setDRACOLoader(Kt){return this.dracoLoader=Kt,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(Kt){return this.ktx2Loader=Kt,this}setMeshoptDecoder(Kt){return this.meshoptDecoder=Kt,this}register(Kt){return this.pluginCallbacks.indexOf(Kt)===-1&&this.pluginCallbacks.push(Kt),this}unregister(Kt){return this.pluginCallbacks.indexOf(Kt)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(Kt),1),this}parse(Kt,Yt,fn,on){let an;const gn={},Nt={},ht=new TextDecoder;if(typeof Kt=="string")an=JSON.parse(Kt);else if(Kt instanceof ArrayBuffer)if(ht.decode(new Uint8Array(Kt,0,4))===Bt){try{gn[be.KHR_BINARY_GLTF]=new Ut(Kt)}catch(Wt){on&&on(Wt);return}an=JSON.parse(gn[be.KHR_BINARY_GLTF].content)}else an=JSON.parse(ht.decode(Kt));else an=Kt;if(an.asset===void 0||an.asset.version[0]<2){on&&on(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const ot=new Nr(an,{path:Yt||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ot.fileLoader.setRequestHeader(this.requestHeader);for(let Vt=0;Vt<this.pluginCallbacks.length;Vt++){const Wt=this.pluginCallbacks[Vt](ot);Wt.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),Nt[Wt.name]=Wt,gn[Wt.name]=!0}if(an.extensionsUsed)for(let Vt=0;Vt<an.extensionsUsed.length;++Vt){const Wt=an.extensionsUsed[Vt],sn=an.extensionsRequired||[];switch(Wt){case be.KHR_MATERIALS_UNLIT:gn[Wt]=new Le;break;case be.KHR_DRACO_MESH_COMPRESSION:gn[Wt]=new Tt(an,this.dracoLoader);break;case be.KHR_TEXTURE_TRANSFORM:gn[Wt]=new Xt;break;case be.KHR_MESH_QUANTIZATION:gn[Wt]=new hn;break;default:sn.indexOf(Wt)>=0&&Nt[Wt]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Wt+'".')}}ot.setExtensions(gn),ot.setPlugins(Nt),ot.parse(fn,on)}parseAsync(Kt,Yt){const fn=this;return new Promise(function(on,an){fn.parse(Kt,Yt,on,an)})}}function Re(){let Bi={};return{get:function(Kt){return Bi[Kt]},add:function(Kt,Yt){Bi[Kt]=Yt},remove:function(Kt){delete Bi[Kt]},removeAll:function(){Bi={}}}}const be={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Pe{constructor(Kt){this.parser=Kt,this.name=be.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const Kt=this.parser,Yt=this.parser.json.nodes||[];for(let fn=0,on=Yt.length;fn<on;fn++){const an=Yt[fn];an.extensions&&an.extensions[this.name]&&an.extensions[this.name].light!==void 0&&Kt._addNodeRef(this.cache,an.extensions[this.name].light)}}_loadLight(Kt){const Yt=this.parser,fn="light:"+Kt;let on=Yt.cache.get(fn);if(on)return on;const an=Yt.json,ht=((an.extensions&&an.extensions[this.name]||{}).lights||[])[Kt];let ot;const Vt=new se.Color(16777215);ht.color!==void 0&&Vt.setRGB(ht.color[0],ht.color[1],ht.color[2],se.LinearSRGBColorSpace);const Wt=ht.range!==void 0?ht.range:0;switch(ht.type){case"directional":ot=new se.DirectionalLight(Vt),ot.target.position.set(0,0,-1),ot.add(ot.target);break;case"point":ot=new se.PointLight(Vt),ot.distance=Wt;break;case"spot":ot=new se.SpotLight(Vt),ot.distance=Wt,ht.spot=ht.spot||{},ht.spot.innerConeAngle=ht.spot.innerConeAngle!==void 0?ht.spot.innerConeAngle:0,ht.spot.outerConeAngle=ht.spot.outerConeAngle!==void 0?ht.spot.outerConeAngle:Math.PI/4,ot.angle=ht.spot.outerConeAngle,ot.penumbra=1-ht.spot.innerConeAngle/ht.spot.outerConeAngle,ot.target.position.set(0,0,-1),ot.add(ot.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+ht.type)}return ot.position.set(0,0,0),ot.decay=2,zr(ot,ht),ht.intensity!==void 0&&(ot.intensity=ht.intensity),ot.name=Yt.createUniqueName(ht.name||"light_"+Kt),on=Promise.resolve(ot),Yt.cache.add(fn,on),on}getDependency(Kt,Yt){if(Kt==="light")return this._loadLight(Yt)}createNodeAttachment(Kt){const Yt=this,fn=this.parser,an=fn.json.nodes[Kt],Nt=(an.extensions&&an.extensions[this.name]||{}).light;return Nt===void 0?null:this._loadLight(Nt).then(function(ht){return fn._getNodeRef(Yt.cache,Nt,ht)})}}class Le{constructor(){this.name=be.KHR_MATERIALS_UNLIT}getMaterialType(){return se.MeshBasicMaterial}extendParams(Kt,Yt,fn){const on=[];Kt.color=new se.Color(1,1,1),Kt.opacity=1;const an=Yt.pbrMetallicRoughness;if(an){if(Array.isArray(an.baseColorFactor)){const gn=an.baseColorFactor;Kt.color.setRGB(gn[0],gn[1],gn[2],se.LinearSRGBColorSpace),Kt.opacity=gn[3]}an.baseColorTexture!==void 0&&on.push(fn.assignTexture(Kt,"map",an.baseColorTexture,se.SRGBColorSpace))}return Promise.all(on)}}class xe{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(Kt,Yt){const on=this.parser.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=on.extensions[this.name].emissiveStrength;return an!==void 0&&(Yt.emissiveIntensity=an),Promise.resolve()}}class Fe{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_CLEARCOAT}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];if(gn.clearcoatFactor!==void 0&&(Yt.clearcoat=gn.clearcoatFactor),gn.clearcoatTexture!==void 0&&an.push(fn.assignTexture(Yt,"clearcoatMap",gn.clearcoatTexture)),gn.clearcoatRoughnessFactor!==void 0&&(Yt.clearcoatRoughness=gn.clearcoatRoughnessFactor),gn.clearcoatRoughnessTexture!==void 0&&an.push(fn.assignTexture(Yt,"clearcoatRoughnessMap",gn.clearcoatRoughnessTexture)),gn.clearcoatNormalTexture!==void 0&&(an.push(fn.assignTexture(Yt,"clearcoatNormalMap",gn.clearcoatNormalTexture)),gn.clearcoatNormalTexture.scale!==void 0)){const Nt=gn.clearcoatNormalTexture.scale;Yt.clearcoatNormalScale=new se.Vector2(Nt,Nt)}return Promise.all(an)}}class Oe{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_DISPERSION}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const on=this.parser.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=on.extensions[this.name];return Yt.dispersion=an.dispersion!==void 0?an.dispersion:0,Promise.resolve()}}class Ne{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_IRIDESCENCE}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];return gn.iridescenceFactor!==void 0&&(Yt.iridescence=gn.iridescenceFactor),gn.iridescenceTexture!==void 0&&an.push(fn.assignTexture(Yt,"iridescenceMap",gn.iridescenceTexture)),gn.iridescenceIor!==void 0&&(Yt.iridescenceIOR=gn.iridescenceIor),Yt.iridescenceThicknessRange===void 0&&(Yt.iridescenceThicknessRange=[100,400]),gn.iridescenceThicknessMinimum!==void 0&&(Yt.iridescenceThicknessRange[0]=gn.iridescenceThicknessMinimum),gn.iridescenceThicknessMaximum!==void 0&&(Yt.iridescenceThicknessRange[1]=gn.iridescenceThicknessMaximum),gn.iridescenceThicknessTexture!==void 0&&an.push(fn.assignTexture(Yt,"iridescenceThicknessMap",gn.iridescenceThicknessTexture)),Promise.all(an)}}class ke{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_SHEEN}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[];Yt.sheenColor=new se.Color(0,0,0),Yt.sheenRoughness=0,Yt.sheen=1;const gn=on.extensions[this.name];if(gn.sheenColorFactor!==void 0){const Nt=gn.sheenColorFactor;Yt.sheenColor.setRGB(Nt[0],Nt[1],Nt[2],se.LinearSRGBColorSpace)}return gn.sheenRoughnessFactor!==void 0&&(Yt.sheenRoughness=gn.sheenRoughnessFactor),gn.sheenColorTexture!==void 0&&an.push(fn.assignTexture(Yt,"sheenColorMap",gn.sheenColorTexture,se.SRGBColorSpace)),gn.sheenRoughnessTexture!==void 0&&an.push(fn.assignTexture(Yt,"sheenRoughnessMap",gn.sheenRoughnessTexture)),Promise.all(an)}}class Ve{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_TRANSMISSION}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];return gn.transmissionFactor!==void 0&&(Yt.transmission=gn.transmissionFactor),gn.transmissionTexture!==void 0&&an.push(fn.assignTexture(Yt,"transmissionMap",gn.transmissionTexture)),Promise.all(an)}}class Xe{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_VOLUME}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];Yt.thickness=gn.thicknessFactor!==void 0?gn.thicknessFactor:0,gn.thicknessTexture!==void 0&&an.push(fn.assignTexture(Yt,"thicknessMap",gn.thicknessTexture)),Yt.attenuationDistance=gn.attenuationDistance||1/0;const Nt=gn.attenuationColor||[1,1,1];return Yt.attenuationColor=new se.Color().setRGB(Nt[0],Nt[1],Nt[2],se.LinearSRGBColorSpace),Promise.all(an)}}class $e{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_IOR}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const on=this.parser.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=on.extensions[this.name];return Yt.ior=an.ior!==void 0?an.ior:1.5,Promise.resolve()}}class st{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_SPECULAR}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];Yt.specularIntensity=gn.specularFactor!==void 0?gn.specularFactor:1,gn.specularTexture!==void 0&&an.push(fn.assignTexture(Yt,"specularIntensityMap",gn.specularTexture));const Nt=gn.specularColorFactor||[1,1,1];return Yt.specularColor=new se.Color().setRGB(Nt[0],Nt[1],Nt[2],se.LinearSRGBColorSpace),gn.specularColorTexture!==void 0&&an.push(fn.assignTexture(Yt,"specularColorMap",gn.specularColorTexture,se.SRGBColorSpace)),Promise.all(an)}}class ze{constructor(Kt){this.parser=Kt,this.name=be.EXT_MATERIALS_BUMP}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];return Yt.bumpScale=gn.bumpFactor!==void 0?gn.bumpFactor:1,gn.bumpTexture!==void 0&&an.push(fn.assignTexture(Yt,"bumpMap",gn.bumpTexture)),Promise.all(an)}}class tt{constructor(Kt){this.parser=Kt,this.name=be.KHR_MATERIALS_ANISOTROPY}getMaterialType(Kt){const fn=this.parser.json.materials[Kt];return!fn.extensions||!fn.extensions[this.name]?null:se.MeshPhysicalMaterial}extendMaterialParams(Kt,Yt){const fn=this.parser,on=fn.json.materials[Kt];if(!on.extensions||!on.extensions[this.name])return Promise.resolve();const an=[],gn=on.extensions[this.name];return gn.anisotropyStrength!==void 0&&(Yt.anisotropy=gn.anisotropyStrength),gn.anisotropyRotation!==void 0&&(Yt.anisotropyRotation=gn.anisotropyRotation),gn.anisotropyTexture!==void 0&&an.push(fn.assignTexture(Yt,"anisotropyMap",gn.anisotropyTexture)),Promise.all(an)}}class ft{constructor(Kt){this.parser=Kt,this.name=be.KHR_TEXTURE_BASISU}loadTexture(Kt){const Yt=this.parser,fn=Yt.json,on=fn.textures[Kt];if(!on.extensions||!on.extensions[this.name])return null;const an=on.extensions[this.name],gn=Yt.options.ktx2Loader;if(!gn){if(fn.extensionsRequired&&fn.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return Yt.loadTextureImage(Kt,an.source,gn)}}class Rt{constructor(Kt){this.parser=Kt,this.name=be.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(Kt){const Yt=this.name,fn=this.parser,on=fn.json,an=on.textures[Kt];if(!an.extensions||!an.extensions[Yt])return null;const gn=an.extensions[Yt],Nt=on.images[gn.source];let ht=fn.textureLoader;if(Nt.uri){const ot=fn.options.manager.getHandler(Nt.uri);ot!==null&&(ht=ot)}return this.detectSupport().then(function(ot){if(ot)return fn.loadTextureImage(Kt,gn.source,ht);if(on.extensionsRequired&&on.extensionsRequired.indexOf(Yt)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return fn.loadTexture(Kt)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Kt){const Yt=new Image;Yt.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",Yt.onload=Yt.onerror=function(){Kt(Yt.height===1)}})),this.isSupported}}class Mt{constructor(Kt){this.parser=Kt,this.name=be.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(Kt){const Yt=this.name,fn=this.parser,on=fn.json,an=on.textures[Kt];if(!an.extensions||!an.extensions[Yt])return null;const gn=an.extensions[Yt],Nt=on.images[gn.source];let ht=fn.textureLoader;if(Nt.uri){const ot=fn.options.manager.getHandler(Nt.uri);ot!==null&&(ht=ot)}return this.detectSupport().then(function(ot){if(ot)return fn.loadTextureImage(Kt,gn.source,ht);if(on.extensionsRequired&&on.extensionsRequired.indexOf(Yt)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return fn.loadTexture(Kt)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(Kt){const Yt=new Image;Yt.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",Yt.onload=Yt.onerror=function(){Kt(Yt.height===1)}})),this.isSupported}}class Gt{constructor(Kt){this.name=be.EXT_MESHOPT_COMPRESSION,this.parser=Kt}loadBufferView(Kt){const Yt=this.parser.json,fn=Yt.bufferViews[Kt];if(fn.extensions&&fn.extensions[this.name]){const on=fn.extensions[this.name],an=this.parser.getDependency("buffer",on.buffer),gn=this.parser.options.meshoptDecoder;if(!gn||!gn.supported){if(Yt.extensionsRequired&&Yt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return an.then(function(Nt){const ht=on.byteOffset||0,ot=on.byteLength||0,Vt=on.count,Wt=on.byteStride,sn=new Uint8Array(Nt,ht,ot);return gn.decodeGltfBufferAsync?gn.decodeGltfBufferAsync(Vt,Wt,sn,on.mode,on.filter).then(function(yn){return yn.buffer}):gn.ready.then(function(){const yn=new ArrayBuffer(Vt*Wt);return gn.decodeGltfBuffer(new Uint8Array(yn),Vt,Wt,sn,on.mode,on.filter),yn})})}else return null}}class _t{constructor(Kt){this.name=be.EXT_MESH_GPU_INSTANCING,this.parser=Kt}createNodeMesh(Kt){const Yt=this.parser.json,fn=Yt.nodes[Kt];if(!fn.extensions||!fn.extensions[this.name]||fn.mesh===void 0)return null;const on=Yt.meshes[fn.mesh];for(const ot of on.primitives)if(ot.mode!==Nn.TRIANGLES&&ot.mode!==Nn.TRIANGLE_STRIP&&ot.mode!==Nn.TRIANGLE_FAN&&ot.mode!==void 0)return null;const gn=fn.extensions[this.name].attributes,Nt=[],ht={};for(const ot in gn)Nt.push(this.parser.getDependency("accessor",gn[ot]).then(Vt=>(ht[ot]=Vt,ht[ot])));return Nt.length<1?null:(Nt.push(this.parser.createNodeMesh(Kt)),Promise.all(Nt).then(ot=>{const Vt=ot.pop(),Wt=Vt.isGroup?Vt.children:[Vt],sn=ot[0].count,yn=[];for(const ni of Wt){const ki=new se.Matrix4,Hi=new se.Vector3,ji=new se.Quaternion,Xi=new se.Vector3(1,1,1),Ws=new se.InstancedMesh(ni.geometry,ni.material,sn);for(let Jr=0;Jr<sn;Jr++)ht.TRANSLATION&&Hi.fromBufferAttribute(ht.TRANSLATION,Jr),ht.ROTATION&&ji.fromBufferAttribute(ht.ROTATION,Jr),ht.SCALE&&Xi.fromBufferAttribute(ht.SCALE,Jr),Ws.setMatrixAt(Jr,ki.compose(Hi,ji,Xi));for(const Jr in ht)if(Jr==="_COLOR_0"){const Ai=ht[Jr];Ws.instanceColor=new se.InstancedBufferAttribute(Ai.array,Ai.itemSize,Ai.normalized)}else Jr!=="TRANSLATION"&&Jr!=="ROTATION"&&Jr!=="SCALE"&&ni.geometry.setAttribute(Jr,ht[Jr]);se.Object3D.prototype.copy.call(Ws,ni),this.parser.assignFinalMaterial(Ws),yn.push(Ws)}return Vt.isGroup?(Vt.clear(),Vt.add(...yn),Vt):yn[0]}))}}const Bt="glTF",dt=12,ut={JSON:1313821514,BIN:5130562};class Ut{constructor(Kt){this.name=be.KHR_BINARY_GLTF,this.content=null,this.body=null;const Yt=new DataView(Kt,0,dt),fn=new TextDecoder;if(this.header={magic:fn.decode(new Uint8Array(Kt.slice(0,4))),version:Yt.getUint32(4,!0),length:Yt.getUint32(8,!0)},this.header.magic!==Bt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const on=this.header.length-dt,an=new DataView(Kt,dt);let gn=0;for(;gn<on;){const Nt=an.getUint32(gn,!0);gn+=4;const ht=an.getUint32(gn,!0);if(gn+=4,ht===ut.JSON){const ot=new Uint8Array(Kt,dt+gn,Nt);this.content=fn.decode(ot)}else if(ht===ut.BIN){const ot=dt+gn;this.body=Kt.slice(ot,ot+Nt)}gn+=Nt}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Tt{constructor(Kt,Yt){if(!Yt)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=be.KHR_DRACO_MESH_COMPRESSION,this.json=Kt,this.dracoLoader=Yt,this.dracoLoader.preload()}decodePrimitive(Kt,Yt){const fn=this.json,on=this.dracoLoader,an=Kt.extensions[this.name].bufferView,gn=Kt.extensions[this.name].attributes,Nt={},ht={},ot={};for(const Vt in gn){const Wt=Zi[Vt]||Vt.toLowerCase();Nt[Wt]=gn[Vt]}for(const Vt in Kt.attributes){const Wt=Zi[Vt]||Vt.toLowerCase();if(gn[Vt]!==void 0){const sn=fn.accessors[Kt.attributes[Vt]],yn=Qn[sn.componentType];ot[Wt]=yn.name,ht[Wt]=sn.normalized===!0}}return Yt.getDependency("bufferView",an).then(function(Vt){return new Promise(function(Wt,sn){on.decodeDracoFile(Vt,function(yn){for(const ni in yn.attributes){const ki=yn.attributes[ni],Hi=ht[ni];Hi!==void 0&&(ki.normalized=Hi)}Wt(yn)},Nt,ot,se.LinearSRGBColorSpace,sn)})})}}class Xt{constructor(){this.name=be.KHR_TEXTURE_TRANSFORM}extendTexture(Kt,Yt){return(Yt.texCoord===void 0||Yt.texCoord===Kt.channel)&&Yt.offset===void 0&&Yt.rotation===void 0&&Yt.scale===void 0||(Kt=Kt.clone(),Yt.texCoord!==void 0&&(Kt.channel=Yt.texCoord),Yt.offset!==void 0&&Kt.offset.fromArray(Yt.offset),Yt.rotation!==void 0&&(Kt.rotation=Yt.rotation),Yt.scale!==void 0&&Kt.repeat.fromArray(Yt.scale),Kt.needsUpdate=!0),Kt}}class hn{constructor(){this.name=be.KHR_MESH_QUANTIZATION}}class nn extends se.Interpolant{constructor(Kt,Yt,fn,on){super(Kt,Yt,fn,on)}copySampleValue_(Kt){const Yt=this.resultBuffer,fn=this.sampleValues,on=this.valueSize,an=Kt*on*3+on;for(let gn=0;gn!==on;gn++)Yt[gn]=fn[an+gn];return Yt}interpolate_(Kt,Yt,fn,on){const an=this.resultBuffer,gn=this.sampleValues,Nt=this.valueSize,ht=Nt*2,ot=Nt*3,Vt=on-Yt,Wt=(fn-Yt)/Vt,sn=Wt*Wt,yn=sn*Wt,ni=Kt*ot,ki=ni-ot,Hi=-2*yn+3*sn,ji=yn-sn,Xi=1-Hi,Ws=ji-sn+Wt;for(let Jr=0;Jr!==Nt;Jr++){const Ai=gn[ki+Jr+Nt],js=gn[ki+Jr+ht]*Vt,Qs=gn[ni+Jr+Nt],Vo=gn[ni+Jr]*Vt;an[Jr]=Xi*Ai+Ws*js+Hi*Qs+ji*Vo}return an}}const An=new se.Quaternion;class Cn extends nn{interpolate_(Kt,Yt,fn,on){const an=super.interpolate_(Kt,Yt,fn,on);return An.fromArray(an).normalize().toArray(an),an}}const Nn={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Qn={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},fi={9728:se.NearestFilter,9729:se.LinearFilter,9984:se.NearestMipmapNearestFilter,9985:se.LinearMipmapNearestFilter,9986:se.NearestMipmapLinearFilter,9987:se.LinearMipmapLinearFilter},hi={33071:se.ClampToEdgeWrapping,33648:se.MirroredRepeatWrapping,10497:se.RepeatWrapping},Qi={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Zi={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Mn={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Vr={CUBICSPLINE:void 0,LINEAR:se.InterpolateLinear,STEP:se.InterpolateDiscrete},Ir={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Rr(Bi){return Bi.DefaultMaterial===void 0&&(Bi.DefaultMaterial=new se.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:se.FrontSide})),Bi.DefaultMaterial}function ir(Bi,Kt,Yt){for(const fn in Yt.extensions)Bi[fn]===void 0&&(Kt.userData.gltfExtensions=Kt.userData.gltfExtensions||{},Kt.userData.gltfExtensions[fn]=Yt.extensions[fn])}function zr(Bi,Kt){Kt.extras!==void 0&&(typeof Kt.extras=="object"?Object.assign(Bi.userData,Kt.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+Kt.extras))}function Br(Bi,Kt,Yt){let fn=!1,on=!1,an=!1;for(let ot=0,Vt=Kt.length;ot<Vt;ot++){const Wt=Kt[ot];if(Wt.POSITION!==void 0&&(fn=!0),Wt.NORMAL!==void 0&&(on=!0),Wt.COLOR_0!==void 0&&(an=!0),fn&&on&&an)break}if(!fn&&!on&&!an)return Promise.resolve(Bi);const gn=[],Nt=[],ht=[];for(let ot=0,Vt=Kt.length;ot<Vt;ot++){const Wt=Kt[ot];if(fn){const sn=Wt.POSITION!==void 0?Yt.getDependency("accessor",Wt.POSITION):Bi.attributes.position;gn.push(sn)}if(on){const sn=Wt.NORMAL!==void 0?Yt.getDependency("accessor",Wt.NORMAL):Bi.attributes.normal;Nt.push(sn)}if(an){const sn=Wt.COLOR_0!==void 0?Yt.getDependency("accessor",Wt.COLOR_0):Bi.attributes.color;ht.push(sn)}}return Promise.all([Promise.all(gn),Promise.all(Nt),Promise.all(ht)]).then(function(ot){const Vt=ot[0],Wt=ot[1],sn=ot[2];return fn&&(Bi.morphAttributes.position=Vt),on&&(Bi.morphAttributes.normal=Wt),an&&(Bi.morphAttributes.color=sn),Bi.morphTargetsRelative=!0,Bi})}function kt(Bi,Kt){if(Bi.updateMorphTargets(),Kt.weights!==void 0)for(let Yt=0,fn=Kt.weights.length;Yt<fn;Yt++)Bi.morphTargetInfluences[Yt]=Kt.weights[Yt];if(Kt.extras&&Array.isArray(Kt.extras.targetNames)){const Yt=Kt.extras.targetNames;if(Bi.morphTargetInfluences.length===Yt.length){Bi.morphTargetDictionary={};for(let fn=0,on=Yt.length;fn<on;fn++)Bi.morphTargetDictionary[Yt[fn]]=fn}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function rn(Bi){let Kt;const Yt=Bi.extensions&&Bi.extensions[be.KHR_DRACO_MESH_COMPRESSION];if(Yt?Kt="draco:"+Yt.bufferView+":"+Yt.indices+":"+Kn(Yt.attributes):Kt=Bi.indices+":"+Kn(Bi.attributes)+":"+Bi.mode,Bi.targets!==void 0)for(let fn=0,on=Bi.targets.length;fn<on;fn++)Kt+=":"+Kn(Bi.targets[fn]);return Kt}function Kn(Bi){let Kt="";const Yt=Object.keys(Bi).sort();for(let fn=0,on=Yt.length;fn<on;fn++)Kt+=Yt[fn]+":"+Bi[Yt[fn]]+";";return Kt}function ai(Bi){switch(Bi){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Ui(Bi){return Bi.search(/\.jpe?g($|\?)/i)>0||Bi.search(/^data\:image\/jpeg/)===0?"image/jpeg":Bi.search(/\.webp($|\?)/i)>0||Bi.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const yi=new se.Matrix4;class Nr{constructor(Kt={},Yt={}){this.json=Kt,this.extensions={},this.plugins={},this.options=Yt,this.cache=new Re,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let fn=!1,on=!1,an=-1;typeof navigator<"u"&&(fn=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,on=navigator.userAgent.indexOf("Firefox")>-1,an=on?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||fn||on&&an<98?this.textureLoader=new se.TextureLoader(this.options.manager):this.textureLoader=new se.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new se.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(Kt){this.extensions=Kt}setPlugins(Kt){this.plugins=Kt}parse(Kt,Yt){const fn=this,on=this.json,an=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(gn){return gn._markDefs&&gn._markDefs()}),Promise.all(this._invokeAll(function(gn){return gn.beforeRoot&&gn.beforeRoot()})).then(function(){return Promise.all([fn.getDependencies("scene"),fn.getDependencies("animation"),fn.getDependencies("camera")])}).then(function(gn){const Nt={scene:gn[0][on.scene||0],scenes:gn[0],animations:gn[1],cameras:gn[2],asset:on.asset,parser:fn,userData:{}};return ir(an,Nt,on),zr(Nt,on),Promise.all(fn._invokeAll(function(ht){return ht.afterRoot&&ht.afterRoot(Nt)})).then(function(){for(const ht of Nt.scenes)ht.updateMatrixWorld();Kt(Nt)})}).catch(Yt)}_markDefs(){const Kt=this.json.nodes||[],Yt=this.json.skins||[],fn=this.json.meshes||[];for(let on=0,an=Yt.length;on<an;on++){const gn=Yt[on].joints;for(let Nt=0,ht=gn.length;Nt<ht;Nt++)Kt[gn[Nt]].isBone=!0}for(let on=0,an=Kt.length;on<an;on++){const gn=Kt[on];gn.mesh!==void 0&&(this._addNodeRef(this.meshCache,gn.mesh),gn.skin!==void 0&&(fn[gn.mesh].isSkinnedMesh=!0)),gn.camera!==void 0&&this._addNodeRef(this.cameraCache,gn.camera)}}_addNodeRef(Kt,Yt){Yt!==void 0&&(Kt.refs[Yt]===void 0&&(Kt.refs[Yt]=Kt.uses[Yt]=0),Kt.refs[Yt]++)}_getNodeRef(Kt,Yt,fn){if(Kt.refs[Yt]<=1)return fn;const on=fn.clone(),an=(gn,Nt)=>{const ht=this.associations.get(gn);ht!=null&&this.associations.set(Nt,ht);for(const[ot,Vt]of gn.children.entries())an(Vt,Nt.children[ot])};return an(fn,on),on.name+="_instance_"+Kt.uses[Yt]++,on}_invokeOne(Kt){const Yt=Object.values(this.plugins);Yt.push(this);for(let fn=0;fn<Yt.length;fn++){const on=Kt(Yt[fn]);if(on)return on}return null}_invokeAll(Kt){const Yt=Object.values(this.plugins);Yt.unshift(this);const fn=[];for(let on=0;on<Yt.length;on++){const an=Kt(Yt[on]);an&&fn.push(an)}return fn}getDependency(Kt,Yt){const fn=Kt+":"+Yt;let on=this.cache.get(fn);if(!on){switch(Kt){case"scene":on=this.loadScene(Yt);break;case"node":on=this._invokeOne(function(an){return an.loadNode&&an.loadNode(Yt)});break;case"mesh":on=this._invokeOne(function(an){return an.loadMesh&&an.loadMesh(Yt)});break;case"accessor":on=this.loadAccessor(Yt);break;case"bufferView":on=this._invokeOne(function(an){return an.loadBufferView&&an.loadBufferView(Yt)});break;case"buffer":on=this.loadBuffer(Yt);break;case"material":on=this._invokeOne(function(an){return an.loadMaterial&&an.loadMaterial(Yt)});break;case"texture":on=this._invokeOne(function(an){return an.loadTexture&&an.loadTexture(Yt)});break;case"skin":on=this.loadSkin(Yt);break;case"animation":on=this._invokeOne(function(an){return an.loadAnimation&&an.loadAnimation(Yt)});break;case"camera":on=this.loadCamera(Yt);break;default:if(on=this._invokeOne(function(an){return an!=this&&an.getDependency&&an.getDependency(Kt,Yt)}),!on)throw new Error("Unknown type: "+Kt);break}this.cache.add(fn,on)}return on}getDependencies(Kt){let Yt=this.cache.get(Kt);if(!Yt){const fn=this,on=this.json[Kt+(Kt==="mesh"?"es":"s")]||[];Yt=Promise.all(on.map(function(an,gn){return fn.getDependency(Kt,gn)})),this.cache.add(Kt,Yt)}return Yt}loadBuffer(Kt){const Yt=this.json.buffers[Kt],fn=this.fileLoader;if(Yt.type&&Yt.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+Yt.type+" buffer type is not supported.");if(Yt.uri===void 0&&Kt===0)return Promise.resolve(this.extensions[be.KHR_BINARY_GLTF].body);const on=this.options;return new Promise(function(an,gn){fn.load(se.LoaderUtils.resolveURL(Yt.uri,on.path),an,void 0,function(){gn(new Error('THREE.GLTFLoader: Failed to load buffer "'+Yt.uri+'".'))})})}loadBufferView(Kt){const Yt=this.json.bufferViews[Kt];return this.getDependency("buffer",Yt.buffer).then(function(fn){const on=Yt.byteLength||0,an=Yt.byteOffset||0;return fn.slice(an,an+on)})}loadAccessor(Kt){const Yt=this,fn=this.json,on=this.json.accessors[Kt];if(on.bufferView===void 0&&on.sparse===void 0){const gn=Qi[on.type],Nt=Qn[on.componentType],ht=on.normalized===!0,ot=new Nt(on.count*gn);return Promise.resolve(new se.BufferAttribute(ot,gn,ht))}const an=[];return on.bufferView!==void 0?an.push(this.getDependency("bufferView",on.bufferView)):an.push(null),on.sparse!==void 0&&(an.push(this.getDependency("bufferView",on.sparse.indices.bufferView)),an.push(this.getDependency("bufferView",on.sparse.values.bufferView))),Promise.all(an).then(function(gn){const Nt=gn[0],ht=Qi[on.type],ot=Qn[on.componentType],Vt=ot.BYTES_PER_ELEMENT,Wt=Vt*ht,sn=on.byteOffset||0,yn=on.bufferView!==void 0?fn.bufferViews[on.bufferView].byteStride:void 0,ni=on.normalized===!0;let ki,Hi;if(yn&&yn!==Wt){const ji=Math.floor(sn/yn),Xi="InterleavedBuffer:"+on.bufferView+":"+on.componentType+":"+ji+":"+on.count;let Ws=Yt.cache.get(Xi);Ws||(ki=new ot(Nt,ji*yn,on.count*yn/Vt),Ws=new se.InterleavedBuffer(ki,yn/Vt),Yt.cache.add(Xi,Ws)),Hi=new se.InterleavedBufferAttribute(Ws,ht,sn%yn/Vt,ni)}else Nt===null?ki=new ot(on.count*ht):ki=new ot(Nt,sn,on.count*ht),Hi=new se.BufferAttribute(ki,ht,ni);if(on.sparse!==void 0){const ji=Qi.SCALAR,Xi=Qn[on.sparse.indices.componentType],Ws=on.sparse.indices.byteOffset||0,Jr=on.sparse.values.byteOffset||0,Ai=new Xi(gn[1],Ws,on.sparse.count*ji),js=new ot(gn[2],Jr,on.sparse.count*ht);Nt!==null&&(Hi=new se.BufferAttribute(Hi.array.slice(),Hi.itemSize,Hi.normalized));for(let Qs=0,Vo=Ai.length;Qs<Vo;Qs++){const Mo=Ai[Qs];if(Hi.setX(Mo,js[Qs*ht]),ht>=2&&Hi.setY(Mo,js[Qs*ht+1]),ht>=3&&Hi.setZ(Mo,js[Qs*ht+2]),ht>=4&&Hi.setW(Mo,js[Qs*ht+3]),ht>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Hi})}loadTexture(Kt){const Yt=this.json,fn=this.options,an=Yt.textures[Kt].source,gn=Yt.images[an];let Nt=this.textureLoader;if(gn.uri){const ht=fn.manager.getHandler(gn.uri);ht!==null&&(Nt=ht)}return this.loadTextureImage(Kt,an,Nt)}loadTextureImage(Kt,Yt,fn){const on=this,an=this.json,gn=an.textures[Kt],Nt=an.images[Yt],ht=(Nt.uri||Nt.bufferView)+":"+gn.sampler;if(this.textureCache[ht])return this.textureCache[ht];const ot=this.loadImageSource(Yt,fn).then(function(Vt){Vt.flipY=!1,Vt.name=gn.name||Nt.name||"",Vt.name===""&&typeof Nt.uri=="string"&&Nt.uri.startsWith("data:image/")===!1&&(Vt.name=Nt.uri);const sn=(an.samplers||{})[gn.sampler]||{};return Vt.magFilter=fi[sn.magFilter]||se.LinearFilter,Vt.minFilter=fi[sn.minFilter]||se.LinearMipmapLinearFilter,Vt.wrapS=hi[sn.wrapS]||se.RepeatWrapping,Vt.wrapT=hi[sn.wrapT]||se.RepeatWrapping,on.associations.set(Vt,{textures:Kt}),Vt}).catch(function(){return null});return this.textureCache[ht]=ot,ot}loadImageSource(Kt,Yt){const fn=this,on=this.json,an=this.options;if(this.sourceCache[Kt]!==void 0)return this.sourceCache[Kt].then(Wt=>Wt.clone());const gn=on.images[Kt],Nt=self.URL||self.webkitURL;let ht=gn.uri||"",ot=!1;if(gn.bufferView!==void 0)ht=fn.getDependency("bufferView",gn.bufferView).then(function(Wt){ot=!0;const sn=new Blob([Wt],{type:gn.mimeType});return ht=Nt.createObjectURL(sn),ht});else if(gn.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+Kt+" is missing URI and bufferView");const Vt=Promise.resolve(ht).then(function(Wt){return new Promise(function(sn,yn){let ni=sn;Yt.isImageBitmapLoader===!0&&(ni=function(ki){const Hi=new se.Texture(ki);Hi.needsUpdate=!0,sn(Hi)}),Yt.load(se.LoaderUtils.resolveURL(Wt,an.path),ni,void 0,yn)})}).then(function(Wt){return ot===!0&&Nt.revokeObjectURL(ht),Wt.userData.mimeType=gn.mimeType||Ui(gn.uri),Wt}).catch(function(Wt){throw console.error("THREE.GLTFLoader: Couldn't load texture",ht),Wt});return this.sourceCache[Kt]=Vt,Vt}assignTexture(Kt,Yt,fn,on){const an=this;return this.getDependency("texture",fn.index).then(function(gn){if(!gn)return null;if(fn.texCoord!==void 0&&fn.texCoord>0&&(gn=gn.clone(),gn.channel=fn.texCoord),an.extensions[be.KHR_TEXTURE_TRANSFORM]){const Nt=fn.extensions!==void 0?fn.extensions[be.KHR_TEXTURE_TRANSFORM]:void 0;if(Nt){const ht=an.associations.get(gn);gn=an.extensions[be.KHR_TEXTURE_TRANSFORM].extendTexture(gn,Nt),an.associations.set(gn,ht)}}return on!==void 0&&(gn.colorSpace=on),Kt[Yt]=gn,gn})}assignFinalMaterial(Kt){const Yt=Kt.geometry;let fn=Kt.material;const on=Yt.attributes.tangent===void 0,an=Yt.attributes.color!==void 0,gn=Yt.attributes.normal===void 0;if(Kt.isPoints){const Nt="PointsMaterial:"+fn.uuid;let ht=this.cache.get(Nt);ht||(ht=new se.PointsMaterial,se.Material.prototype.copy.call(ht,fn),ht.color.copy(fn.color),ht.map=fn.map,ht.sizeAttenuation=!1,this.cache.add(Nt,ht)),fn=ht}else if(Kt.isLine){const Nt="LineBasicMaterial:"+fn.uuid;let ht=this.cache.get(Nt);ht||(ht=new se.LineBasicMaterial,se.Material.prototype.copy.call(ht,fn),ht.color.copy(fn.color),ht.map=fn.map,this.cache.add(Nt,ht)),fn=ht}if(on||an||gn){let Nt="ClonedMaterial:"+fn.uuid+":";on&&(Nt+="derivative-tangents:"),an&&(Nt+="vertex-colors:"),gn&&(Nt+="flat-shading:");let ht=this.cache.get(Nt);ht||(ht=fn.clone(),an&&(ht.vertexColors=!0),gn&&(ht.flatShading=!0),on&&(ht.normalScale&&(ht.normalScale.y*=-1),ht.clearcoatNormalScale&&(ht.clearcoatNormalScale.y*=-1)),this.cache.add(Nt,ht),this.associations.set(ht,this.associations.get(fn))),fn=ht}Kt.material=fn}getMaterialType(){return se.MeshStandardMaterial}loadMaterial(Kt){const Yt=this,fn=this.json,on=this.extensions,an=fn.materials[Kt];let gn;const Nt={},ht=an.extensions||{},ot=[];if(ht[be.KHR_MATERIALS_UNLIT]){const Wt=on[be.KHR_MATERIALS_UNLIT];gn=Wt.getMaterialType(),ot.push(Wt.extendParams(Nt,an,Yt))}else{const Wt=an.pbrMetallicRoughness||{};if(Nt.color=new se.Color(1,1,1),Nt.opacity=1,Array.isArray(Wt.baseColorFactor)){const sn=Wt.baseColorFactor;Nt.color.setRGB(sn[0],sn[1],sn[2],se.LinearSRGBColorSpace),Nt.opacity=sn[3]}Wt.baseColorTexture!==void 0&&ot.push(Yt.assignTexture(Nt,"map",Wt.baseColorTexture,se.SRGBColorSpace)),Nt.metalness=Wt.metallicFactor!==void 0?Wt.metallicFactor:1,Nt.roughness=Wt.roughnessFactor!==void 0?Wt.roughnessFactor:1,Wt.metallicRoughnessTexture!==void 0&&(ot.push(Yt.assignTexture(Nt,"metalnessMap",Wt.metallicRoughnessTexture)),ot.push(Yt.assignTexture(Nt,"roughnessMap",Wt.metallicRoughnessTexture))),gn=this._invokeOne(function(sn){return sn.getMaterialType&&sn.getMaterialType(Kt)}),ot.push(Promise.all(this._invokeAll(function(sn){return sn.extendMaterialParams&&sn.extendMaterialParams(Kt,Nt)})))}an.doubleSided===!0&&(Nt.side=se.DoubleSide);const Vt=an.alphaMode||Ir.OPAQUE;if(Vt===Ir.BLEND?(Nt.transparent=!0,Nt.depthWrite=!1):(Nt.transparent=!1,Vt===Ir.MASK&&(Nt.alphaTest=an.alphaCutoff!==void 0?an.alphaCutoff:.5)),an.normalTexture!==void 0&&gn!==se.MeshBasicMaterial&&(ot.push(Yt.assignTexture(Nt,"normalMap",an.normalTexture)),Nt.normalScale=new se.Vector2(1,1),an.normalTexture.scale!==void 0)){const Wt=an.normalTexture.scale;Nt.normalScale.set(Wt,Wt)}if(an.occlusionTexture!==void 0&&gn!==se.MeshBasicMaterial&&(ot.push(Yt.assignTexture(Nt,"aoMap",an.occlusionTexture)),an.occlusionTexture.strength!==void 0&&(Nt.aoMapIntensity=an.occlusionTexture.strength)),an.emissiveFactor!==void 0&&gn!==se.MeshBasicMaterial){const Wt=an.emissiveFactor;Nt.emissive=new se.Color().setRGB(Wt[0],Wt[1],Wt[2],se.LinearSRGBColorSpace)}return an.emissiveTexture!==void 0&&gn!==se.MeshBasicMaterial&&ot.push(Yt.assignTexture(Nt,"emissiveMap",an.emissiveTexture,se.SRGBColorSpace)),Promise.all(ot).then(function(){const Wt=new gn(Nt);return an.name&&(Wt.name=an.name),zr(Wt,an),Yt.associations.set(Wt,{materials:Kt}),an.extensions&&ir(on,Wt,an),Wt})}createUniqueName(Kt){const Yt=se.PropertyBinding.sanitizeNodeName(Kt||"");return Yt in this.nodeNamesUsed?Yt+"_"+ ++this.nodeNamesUsed[Yt]:(this.nodeNamesUsed[Yt]=0,Yt)}loadGeometries(Kt){const Yt=this,fn=this.extensions,on=this.primitiveCache;function an(Nt){return fn[be.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Nt,Yt).then(function(ht){return fr(ht,Nt,Yt)})}const gn=[];for(let Nt=0,ht=Kt.length;Nt<ht;Nt++){const ot=Kt[Nt],Vt=rn(ot),Wt=on[Vt];if(Wt)gn.push(Wt.promise);else{let sn;ot.extensions&&ot.extensions[be.KHR_DRACO_MESH_COMPRESSION]?sn=an(ot):sn=fr(new se.BufferGeometry,ot,Yt),on[Vt]={primitive:ot,promise:sn},gn.push(sn)}}return Promise.all(gn)}loadMesh(Kt){const Yt=this,fn=this.json,on=this.extensions,an=fn.meshes[Kt],gn=an.primitives,Nt=[];for(let ht=0,ot=gn.length;ht<ot;ht++){const Vt=gn[ht].material===void 0?Rr(this.cache):this.getDependency("material",gn[ht].material);Nt.push(Vt)}return Nt.push(Yt.loadGeometries(gn)),Promise.all(Nt).then(function(ht){const ot=ht.slice(0,ht.length-1),Vt=ht[ht.length-1],Wt=[];for(let yn=0,ni=Vt.length;yn<ni;yn++){const ki=Vt[yn],Hi=gn[yn];let ji;const Xi=ot[yn];if(Hi.mode===Nn.TRIANGLES||Hi.mode===Nn.TRIANGLE_STRIP||Hi.mode===Nn.TRIANGLE_FAN||Hi.mode===void 0)ji=an.isSkinnedMesh===!0?new se.SkinnedMesh(ki,Xi):new se.Mesh(ki,Xi),ji.isSkinnedMesh===!0&&ji.normalizeSkinWeights(),Hi.mode===Nn.TRIANGLE_STRIP?ji.geometry=(0,me.toTrianglesDrawMode)(ji.geometry,se.TriangleStripDrawMode):Hi.mode===Nn.TRIANGLE_FAN&&(ji.geometry=(0,me.toTrianglesDrawMode)(ji.geometry,se.TriangleFanDrawMode));else if(Hi.mode===Nn.LINES)ji=new se.LineSegments(ki,Xi);else if(Hi.mode===Nn.LINE_STRIP)ji=new se.Line(ki,Xi);else if(Hi.mode===Nn.LINE_LOOP)ji=new se.LineLoop(ki,Xi);else if(Hi.mode===Nn.POINTS)ji=new se.Points(ki,Xi);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Hi.mode);Object.keys(ji.geometry.morphAttributes).length>0&&kt(ji,an),ji.name=Yt.createUniqueName(an.name||"mesh_"+Kt),zr(ji,an),Hi.extensions&&ir(on,ji,Hi),Yt.assignFinalMaterial(ji),Wt.push(ji)}for(let yn=0,ni=Wt.length;yn<ni;yn++)Yt.associations.set(Wt[yn],{meshes:Kt,primitives:yn});if(Wt.length===1)return an.extensions&&ir(on,Wt[0],an),Wt[0];const sn=new se.Group;an.extensions&&ir(on,sn,an),Yt.associations.set(sn,{meshes:Kt});for(let yn=0,ni=Wt.length;yn<ni;yn++)sn.add(Wt[yn]);return sn})}loadCamera(Kt){let Yt;const fn=this.json.cameras[Kt],on=fn[fn.type];if(!on){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return fn.type==="perspective"?Yt=new se.PerspectiveCamera(se.MathUtils.radToDeg(on.yfov),on.aspectRatio||1,on.znear||1,on.zfar||2e6):fn.type==="orthographic"&&(Yt=new se.OrthographicCamera(-on.xmag,on.xmag,on.ymag,-on.ymag,on.znear,on.zfar)),fn.name&&(Yt.name=this.createUniqueName(fn.name)),zr(Yt,fn),Promise.resolve(Yt)}loadSkin(Kt){const Yt=this.json.skins[Kt],fn=[];for(let on=0,an=Yt.joints.length;on<an;on++)fn.push(this._loadNodeShallow(Yt.joints[on]));return Yt.inverseBindMatrices!==void 0?fn.push(this.getDependency("accessor",Yt.inverseBindMatrices)):fn.push(null),Promise.all(fn).then(function(on){const an=on.pop(),gn=on,Nt=[],ht=[];for(let ot=0,Vt=gn.length;ot<Vt;ot++){const Wt=gn[ot];if(Wt){Nt.push(Wt);const sn=new se.Matrix4;an!==null&&sn.fromArray(an.array,ot*16),ht.push(sn)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Yt.joints[ot])}return new se.Skeleton(Nt,ht)})}loadAnimation(Kt){const Yt=this.json,fn=this,on=Yt.animations[Kt],an=on.name?on.name:"animation_"+Kt,gn=[],Nt=[],ht=[],ot=[],Vt=[];for(let Wt=0,sn=on.channels.length;Wt<sn;Wt++){const yn=on.channels[Wt],ni=on.samplers[yn.sampler],ki=yn.target,Hi=ki.node,ji=on.parameters!==void 0?on.parameters[ni.input]:ni.input,Xi=on.parameters!==void 0?on.parameters[ni.output]:ni.output;ki.node!==void 0&&(gn.push(this.getDependency("node",Hi)),Nt.push(this.getDependency("accessor",ji)),ht.push(this.getDependency("accessor",Xi)),ot.push(ni),Vt.push(ki))}return Promise.all([Promise.all(gn),Promise.all(Nt),Promise.all(ht),Promise.all(ot),Promise.all(Vt)]).then(function(Wt){const sn=Wt[0],yn=Wt[1],ni=Wt[2],ki=Wt[3],Hi=Wt[4],ji=[];for(let Xi=0,Ws=sn.length;Xi<Ws;Xi++){const Jr=sn[Xi],Ai=yn[Xi],js=ni[Xi],Qs=ki[Xi],Vo=Hi[Xi];if(Jr===void 0)continue;Jr.updateMatrix&&Jr.updateMatrix();const Mo=fn._createAnimationTracks(Jr,Ai,js,Qs,Vo);if(Mo)for(let Ia=0;Ia<Mo.length;Ia++)ji.push(Mo[Ia])}return new se.AnimationClip(an,void 0,ji)})}createNodeMesh(Kt){const Yt=this.json,fn=this,on=Yt.nodes[Kt];return on.mesh===void 0?null:fn.getDependency("mesh",on.mesh).then(function(an){const gn=fn._getNodeRef(fn.meshCache,on.mesh,an);return on.weights!==void 0&&gn.traverse(function(Nt){if(Nt.isMesh)for(let ht=0,ot=on.weights.length;ht<ot;ht++)Nt.morphTargetInfluences[ht]=on.weights[ht]}),gn})}loadNode(Kt){const Yt=this.json,fn=this,on=Yt.nodes[Kt],an=fn._loadNodeShallow(Kt),gn=[],Nt=on.children||[];for(let ot=0,Vt=Nt.length;ot<Vt;ot++)gn.push(fn.getDependency("node",Nt[ot]));const ht=on.skin===void 0?Promise.resolve(null):fn.getDependency("skin",on.skin);return Promise.all([an,Promise.all(gn),ht]).then(function(ot){const Vt=ot[0],Wt=ot[1],sn=ot[2];sn!==null&&Vt.traverse(function(yn){yn.isSkinnedMesh&&yn.bind(sn,yi)});for(let yn=0,ni=Wt.length;yn<ni;yn++)Vt.add(Wt[yn]);return Vt})}_loadNodeShallow(Kt){const Yt=this.json,fn=this.extensions,on=this;if(this.nodeCache[Kt]!==void 0)return this.nodeCache[Kt];const an=Yt.nodes[Kt],gn=an.name?on.createUniqueName(an.name):"",Nt=[],ht=on._invokeOne(function(ot){return ot.createNodeMesh&&ot.createNodeMesh(Kt)});return ht&&Nt.push(ht),an.camera!==void 0&&Nt.push(on.getDependency("camera",an.camera).then(function(ot){return on._getNodeRef(on.cameraCache,an.camera,ot)})),on._invokeAll(function(ot){return ot.createNodeAttachment&&ot.createNodeAttachment(Kt)}).forEach(function(ot){Nt.push(ot)}),this.nodeCache[Kt]=Promise.all(Nt).then(function(ot){let Vt;if(an.isBone===!0?Vt=new se.Bone:ot.length>1?Vt=new se.Group:ot.length===1?Vt=ot[0]:Vt=new se.Object3D,Vt!==ot[0])for(let Wt=0,sn=ot.length;Wt<sn;Wt++)Vt.add(ot[Wt]);if(an.name&&(Vt.userData.name=an.name,Vt.name=gn),zr(Vt,an),an.extensions&&ir(fn,Vt,an),an.matrix!==void 0){const Wt=new se.Matrix4;Wt.fromArray(an.matrix),Vt.applyMatrix4(Wt)}else an.translation!==void 0&&Vt.position.fromArray(an.translation),an.rotation!==void 0&&Vt.quaternion.fromArray(an.rotation),an.scale!==void 0&&Vt.scale.fromArray(an.scale);return on.associations.has(Vt)||on.associations.set(Vt,{}),on.associations.get(Vt).nodes=Kt,Vt}),this.nodeCache[Kt]}loadScene(Kt){const Yt=this.extensions,fn=this.json.scenes[Kt],on=this,an=new se.Group;fn.name&&(an.name=on.createUniqueName(fn.name)),zr(an,fn),fn.extensions&&ir(Yt,an,fn);const gn=fn.nodes||[],Nt=[];for(let ht=0,ot=gn.length;ht<ot;ht++)Nt.push(on.getDependency("node",gn[ht]));return Promise.all(Nt).then(function(ht){for(let Vt=0,Wt=ht.length;Vt<Wt;Vt++)an.add(ht[Vt]);const ot=Vt=>{const Wt=new Map;for(const[sn,yn]of on.associations)(sn instanceof se.Material||sn instanceof se.Texture)&&Wt.set(sn,yn);return Vt.traverse(sn=>{const yn=on.associations.get(sn);yn!=null&&Wt.set(sn,yn)}),Wt};return on.associations=ot(an),an})}_createAnimationTracks(Kt,Yt,fn,on,an){const gn=[],Nt=Kt.name?Kt.name:Kt.uuid,ht=[];Mn[an.path]===Mn.weights?Kt.traverse(function(sn){sn.morphTargetInfluences&&ht.push(sn.name?sn.name:sn.uuid)}):ht.push(Nt);let ot;switch(Mn[an.path]){case Mn.weights:ot=se.NumberKeyframeTrack;break;case Mn.rotation:ot=se.QuaternionKeyframeTrack;break;case Mn.position:case Mn.scale:ot=se.VectorKeyframeTrack;break;default:switch(fn.itemSize){case 1:ot=se.NumberKeyframeTrack;break;case 2:case 3:default:ot=se.VectorKeyframeTrack;break}break}const Vt=on.interpolation!==void 0?Vr[on.interpolation]:se.InterpolateLinear,Wt=this._getArrayFromAccessor(fn);for(let sn=0,yn=ht.length;sn<yn;sn++){const ni=new ot(ht[sn]+"."+Mn[an.path],Yt.array,Wt,Vt);on.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(ni),gn.push(ni)}return gn}_getArrayFromAccessor(Kt){let Yt=Kt.array;if(Kt.normalized){const fn=ai(Yt.constructor),on=new Float32Array(Yt.length);for(let an=0,gn=Yt.length;an<gn;an++)on[an]=Yt[an]*fn;Yt=on}return Yt}_createCubicSplineTrackInterpolant(Kt){Kt.createInterpolant=function(fn){const on=this instanceof se.QuaternionKeyframeTrack?Cn:nn;return new on(this.times,this.values,this.getValueSize()/3,fn)},Kt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Ar(Bi,Kt,Yt){const fn=Kt.attributes,on=new se.Box3;if(fn.POSITION!==void 0){const Nt=Yt.json.accessors[fn.POSITION],ht=Nt.min,ot=Nt.max;if(ht!==void 0&&ot!==void 0){if(on.set(new se.Vector3(ht[0],ht[1],ht[2]),new se.Vector3(ot[0],ot[1],ot[2])),Nt.normalized){const Vt=ai(Qn[Nt.componentType]);on.min.multiplyScalar(Vt),on.max.multiplyScalar(Vt)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const an=Kt.targets;if(an!==void 0){const Nt=new se.Vector3,ht=new se.Vector3;for(let ot=0,Vt=an.length;ot<Vt;ot++){const Wt=an[ot];if(Wt.POSITION!==void 0){const sn=Yt.json.accessors[Wt.POSITION],yn=sn.min,ni=sn.max;if(yn!==void 0&&ni!==void 0){if(ht.setX(Math.max(Math.abs(yn[0]),Math.abs(ni[0]))),ht.setY(Math.max(Math.abs(yn[1]),Math.abs(ni[1]))),ht.setZ(Math.max(Math.abs(yn[2]),Math.abs(ni[2]))),sn.normalized){const ki=ai(Qn[sn.componentType]);ht.multiplyScalar(ki)}Nt.max(ht)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}on.expandByVector(Nt)}Bi.boundingBox=on;const gn=new se.Sphere;on.getCenter(gn.center),gn.radius=on.min.distanceTo(on.max)/2,Bi.boundingSphere=gn}function fr(Bi,Kt,Yt){const fn=Kt.attributes,on=[];function an(gn,Nt){return Yt.getDependency("accessor",gn).then(function(ht){Bi.setAttribute(Nt,ht)})}for(const gn in fn){const Nt=Zi[gn]||gn.toLowerCase();Nt in Bi.attributes||on.push(an(fn[gn],Nt))}if(Kt.indices!==void 0&&!Bi.index){const gn=Yt.getDependency("accessor",Kt.indices).then(function(Nt){Bi.setIndex(Nt)});on.push(gn)}return se.ColorManagement.workingColorSpace!==se.LinearSRGBColorSpace&&"COLOR_0"in fn&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${se.ColorManagement.workingColorSpace}" not supported.`),zr(Bi,Kt),Ar(Bi,Kt,Yt),Promise.all(on).then(function(){return Kt.targets!==void 0?Br(Bi,Kt.targets,Yt):Bi})}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{KTX2Loader:()=>xe});var se=ve("./node_modules/three/build/three.module.js"),me=ve("./node_modules/three/examples/jsm/utils/WorkerPool.js"),Te=ve("./node_modules/three/examples/jsm/libs/ktx-parse.module.js"),Re=ve("./node_modules/three/examples/jsm/libs/zstddec.module.js");const be=new WeakMap;let Pe=0,Le;class xe extends se.Loader{constructor($e){super($e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new me.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath($e){return this.transcoderPath=$e,this}setWorkerLimit($e){return this.workerPool.setWorkerLimit($e),this}async detectSupportAsync($e){return this.workerConfig={astcSupported:await $e.hasFeatureAsync("texture-compression-astc"),etc1Supported:await $e.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await $e.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await $e.hasFeatureAsync("texture-compression-bc"),bptcSupported:await $e.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await $e.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport($e){return $e.isWebGPURenderer===!0?this.workerConfig={astcSupported:$e.hasFeature("texture-compression-astc"),etc1Supported:$e.hasFeature("texture-compression-etc1"),etc2Supported:$e.hasFeature("texture-compression-etc2"),dxtSupported:$e.hasFeature("texture-compression-bc"),bptcSupported:$e.hasFeature("texture-compression-bptc"),pvrtcSupported:$e.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:$e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:$e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:$e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:$e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:$e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:$e.extensions.has("WEBGL_compressed_texture_pvrtc")||$e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const $e=new se.FileLoader(this.manager);$e.setPath(this.transcoderPath),$e.setWithCredentials(this.withCredentials);const st=$e.loadAsync("basis_transcoder.js"),ze=new se.FileLoader(this.manager);ze.setPath(this.transcoderPath),ze.setResponseType("arraybuffer"),ze.setWithCredentials(this.withCredentials);const tt=ze.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([st,tt]).then(([ft,Rt])=>{const Mt=xe.BasisWorker.toString(),Gt=["/* constants */","let _EngineFormat = "+JSON.stringify(xe.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(xe.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(xe.BasisFormat),"/* basis_transcoder.js */",ft,"/* worker */",Mt.substring(Mt.indexOf("{")+1,Mt.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Gt])),this.transcoderBinary=Rt,this.workerPool.setWorkerCreator(()=>{const _t=new Worker(this.workerSourceURL),Bt=this.transcoderBinary.slice(0);return _t.postMessage({type:"init",config:this.workerConfig,transcoderBinary:Bt},[Bt]),_t})}),Pe>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Pe++}return this.transcoderPending}load($e,st,ze,tt){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const ft=new se.FileLoader(this.manager);ft.setResponseType("arraybuffer"),ft.setWithCredentials(this.withCredentials),ft.load($e,Rt=>{if(be.has(Rt))return be.get(Rt).promise.then(st).catch(tt);this._createTexture(Rt).then(Mt=>st?st(Mt):null).catch(tt)},ze,tt)}_createTextureFrom($e,st){const{faces:ze,width:tt,height:ft,format:Rt,type:Mt,error:Gt,dfdFlags:_t}=$e;if(Mt==="error")return Promise.reject(Gt);let Bt;if(st.faceCount===6)Bt=new se.CompressedCubeTexture(ze,Rt,se.UnsignedByteType);else{const dt=ze[0].mipmaps;Bt=st.layerCount>1?new se.CompressedArrayTexture(dt,tt,ft,st.layerCount,Rt,se.UnsignedByteType):new se.CompressedTexture(dt,tt,ft,Rt,se.UnsignedByteType)}return Bt.minFilter=ze[0].mipmaps.length===1?se.LinearFilter:se.LinearMipmapLinearFilter,Bt.magFilter=se.LinearFilter,Bt.generateMipmaps=!1,Bt.needsUpdate=!0,Bt.colorSpace=Ve(st),Bt.premultiplyAlpha=!!(_t&Te.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),Bt}async _createTexture($e,st={}){const ze=(0,Te.read)(new Uint8Array($e));if(ze.vkFormat!==Te.VK_FORMAT_UNDEFINED)return ke(ze);const tt=st,ft=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:$e,taskConfig:tt},[$e])).then(Rt=>this._createTextureFrom(Rt.data,ze));return be.set($e,{promise:ft}),ft}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Pe--,this}}xe.BasisFormat={ETC1S:0,UASTC_4x4:1},xe.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},xe.EngineFormat={RGBAFormat:se.RGBAFormat,RGBA_ASTC_4x4_Format:se.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:se.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:se.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:se.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:se.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:se.RGB_ETC1_Format,RGB_ETC2_Format:se.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:se.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:se.RGBA_S3TC_DXT1_Format},xe.BasisWorker=function(){let Xe,$e,st;const ze=_EngineFormat,tt=_TranscoderFormat,ft=_BasisFormat;self.addEventListener("message",function(Tt){const Xt=Tt.data;switch(Xt.type){case"init":Xe=Xt.config,Rt(Xt.transcoderBinary);break;case"transcode":$e.then(()=>{try{const{faces:hn,buffers:nn,width:An,height:Cn,hasAlpha:Nn,format:Qn,dfdFlags:fi}=Mt(Xt.buffer);self.postMessage({type:"transcode",id:Xt.id,faces:hn,width:An,height:Cn,hasAlpha:Nn,format:Qn,dfdFlags:fi},nn)}catch(hn){console.error(hn),self.postMessage({type:"error",id:Xt.id,error:hn.message})}});break}});function Rt(Tt){$e=new Promise(Xt=>{st={wasmBinary:Tt,onRuntimeInitialized:Xt},BASIS(st)}).then(()=>{st.initializeBasis(),st.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function Mt(Tt){const Xt=new st.KTX2File(new Uint8Array(Tt));function hn(){Xt.close(),Xt.delete()}if(!Xt.isValid())throw hn(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const nn=Xt.isUASTC()?ft.UASTC_4x4:ft.ETC1S,An=Xt.getWidth(),Cn=Xt.getHeight(),Nn=Xt.getLayers()||1,Qn=Xt.getLevels(),fi=Xt.getFaces(),hi=Xt.getHasAlpha(),Qi=Xt.getDFDFlags(),{transcoderFormat:Zi,engineFormat:Mn}=dt(nn,An,Cn,hi);if(!An||!Cn||!Qn)throw hn(),new Error("THREE.KTX2Loader:	Invalid texture");if(!Xt.startTranscoding())throw hn(),new Error("THREE.KTX2Loader: .startTranscoding failed");const Vr=[],Ir=[];for(let Rr=0;Rr<fi;Rr++){const ir=[];for(let zr=0;zr<Qn;zr++){const Br=[];let kt,rn;for(let ai=0;ai<Nn;ai++){const Ui=Xt.getImageLevelInfo(zr,ai,Rr);Rr===0&&zr===0&&ai===0&&(Ui.origWidth%4!==0||Ui.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),Qn>1?(kt=Ui.origWidth,rn=Ui.origHeight):(kt=Ui.width,rn=Ui.height);const yi=new Uint8Array(Xt.getImageTranscodedSizeInBytes(zr,ai,0,Zi));if(!Xt.transcodeImage(yi,zr,ai,Rr,Zi,0,-1,-1))throw hn(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Br.push(yi)}const Kn=Ut(Br);ir.push({data:Kn,width:kt,height:rn}),Ir.push(Kn.buffer)}Vr.push({mipmaps:ir,width:An,height:Cn,format:Mn})}return hn(),{faces:Vr,buffers:Ir,width:An,height:Cn,hasAlpha:hi,format:Mn,dfdFlags:Qi}}const Gt=[{if:"astcSupported",basisFormat:[ft.UASTC_4x4],transcoderFormat:[tt.ASTC_4x4,tt.ASTC_4x4],engineFormat:[ze.RGBA_ASTC_4x4_Format,ze.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[ft.ETC1S,ft.UASTC_4x4],transcoderFormat:[tt.BC7_M5,tt.BC7_M5],engineFormat:[ze.RGBA_BPTC_Format,ze.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[ft.ETC1S,ft.UASTC_4x4],transcoderFormat:[tt.BC1,tt.BC3],engineFormat:[ze.RGBA_S3TC_DXT1_Format,ze.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[ft.ETC1S,ft.UASTC_4x4],transcoderFormat:[tt.ETC1,tt.ETC2],engineFormat:[ze.RGB_ETC2_Format,ze.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[ft.ETC1S,ft.UASTC_4x4],transcoderFormat:[tt.ETC1],engineFormat:[ze.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[ft.ETC1S,ft.UASTC_4x4],transcoderFormat:[tt.PVRTC1_4_RGB,tt.PVRTC1_4_RGBA],engineFormat:[ze.RGB_PVRTC_4BPPV1_Format,ze.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],_t=Gt.sort(function(Tt,Xt){return Tt.priorityETC1S-Xt.priorityETC1S}),Bt=Gt.sort(function(Tt,Xt){return Tt.priorityUASTC-Xt.priorityUASTC});function dt(Tt,Xt,hn,nn){let An,Cn;const Nn=Tt===ft.ETC1S?_t:Bt;for(let Qn=0;Qn<Nn.length;Qn++){const fi=Nn[Qn];if(Xe[fi.if]&&fi.basisFormat.includes(Tt)&&!(nn&&fi.transcoderFormat.length<2)&&!(fi.needsPowerOfTwo&&!(ut(Xt)&&ut(hn))))return An=fi.transcoderFormat[nn?1:0],Cn=fi.engineFormat[nn?1:0],{transcoderFormat:An,engineFormat:Cn}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),An=tt.RGBA32,Cn=ze.RGBAFormat,{transcoderFormat:An,engineFormat:Cn}}function ut(Tt){return Tt<=2?!0:(Tt&Tt-1)===0&&Tt!==0}function Ut(Tt){if(Tt.length===1)return Tt[0];let Xt=0;for(let An=0;An<Tt.length;An++){const Cn=Tt[An];Xt+=Cn.byteLength}const hn=new Uint8Array(Xt);let nn=0;for(let An=0;An<Tt.length;An++){const Cn=Tt[An];hn.set(Cn,nn),nn+=Cn.byteLength}return hn}};const Fe=new Set([se.RGBAFormat,se.RGFormat,se.RedFormat]),Oe={[Te.VK_FORMAT_R32G32B32A32_SFLOAT]:se.RGBAFormat,[Te.VK_FORMAT_R16G16B16A16_SFLOAT]:se.RGBAFormat,[Te.VK_FORMAT_R8G8B8A8_UNORM]:se.RGBAFormat,[Te.VK_FORMAT_R8G8B8A8_SRGB]:se.RGBAFormat,[Te.VK_FORMAT_R32G32_SFLOAT]:se.RGFormat,[Te.VK_FORMAT_R16G16_SFLOAT]:se.RGFormat,[Te.VK_FORMAT_R8G8_UNORM]:se.RGFormat,[Te.VK_FORMAT_R8G8_SRGB]:se.RGFormat,[Te.VK_FORMAT_R32_SFLOAT]:se.RedFormat,[Te.VK_FORMAT_R16_SFLOAT]:se.RedFormat,[Te.VK_FORMAT_R8_SRGB]:se.RedFormat,[Te.VK_FORMAT_R8_UNORM]:se.RedFormat,[Te.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:se.RGBA_ASTC_6x6_Format,[Te.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:se.RGBA_ASTC_6x6_Format},Ne={[Te.VK_FORMAT_R32G32B32A32_SFLOAT]:se.FloatType,[Te.VK_FORMAT_R16G16B16A16_SFLOAT]:se.HalfFloatType,[Te.VK_FORMAT_R8G8B8A8_UNORM]:se.UnsignedByteType,[Te.VK_FORMAT_R8G8B8A8_SRGB]:se.UnsignedByteType,[Te.VK_FORMAT_R32G32_SFLOAT]:se.FloatType,[Te.VK_FORMAT_R16G16_SFLOAT]:se.HalfFloatType,[Te.VK_FORMAT_R8G8_UNORM]:se.UnsignedByteType,[Te.VK_FORMAT_R8G8_SRGB]:se.UnsignedByteType,[Te.VK_FORMAT_R32_SFLOAT]:se.FloatType,[Te.VK_FORMAT_R16_SFLOAT]:se.HalfFloatType,[Te.VK_FORMAT_R8_SRGB]:se.UnsignedByteType,[Te.VK_FORMAT_R8_UNORM]:se.UnsignedByteType,[Te.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:se.UnsignedByteType,[Te.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:se.UnsignedByteType};async function ke(Xe){const{vkFormat:$e}=Xe;if(Oe[$e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let st;Xe.supercompressionScheme===Te.KHR_SUPERCOMPRESSION_ZSTD&&(Le||(Le=new Promise(async ft=>{const Rt=new Re.ZSTDDecoder;await Rt.init(),ft(Rt)})),st=await Le);const ze=[];for(let ft=0;ft<Xe.levels.length;ft++){const Rt=Math.max(1,Xe.pixelWidth>>ft),Mt=Math.max(1,Xe.pixelHeight>>ft),Gt=Xe.pixelDepth?Math.max(1,Xe.pixelDepth>>ft):0,_t=Xe.levels[ft];let Bt;if(Xe.supercompressionScheme===Te.KHR_SUPERCOMPRESSION_NONE)Bt=_t.levelData;else if(Xe.supercompressionScheme===Te.KHR_SUPERCOMPRESSION_ZSTD)Bt=st.decode(_t.levelData,_t.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let dt;Ne[$e]===se.FloatType?dt=new Float32Array(Bt.buffer,Bt.byteOffset,Bt.byteLength/Float32Array.BYTES_PER_ELEMENT):Ne[$e]===se.HalfFloatType?dt=new Uint16Array(Bt.buffer,Bt.byteOffset,Bt.byteLength/Uint16Array.BYTES_PER_ELEMENT):dt=Bt,ze.push({data:dt,width:Rt,height:Mt,depth:Gt})}let tt;if(Fe.has(Oe[$e]))tt=Xe.pixelDepth===0?new se.DataTexture(ze[0].data,Xe.pixelWidth,Xe.pixelHeight):new se.Data3DTexture(ze[0].data,Xe.pixelWidth,Xe.pixelHeight,Xe.pixelDepth);else{if(Xe.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");tt=new se.CompressedTexture(ze,Xe.pixelWidth,Xe.pixelHeight)}return tt.mipmaps=ze,tt.type=Ne[$e],tt.format=Oe[$e],tt.colorSpace=Ve(Xe),tt.needsUpdate=!0,Promise.resolve(tt)}function Ve(Xe){const $e=Xe.dataFormatDescriptor[0];return $e.colorPrimaries===Te.KHR_DF_PRIMARIES_BT709?$e.transferFunction===Te.KHR_DF_TRANSFER_SRGB?se.SRGBColorSpace:se.LinearSRGBColorSpace:$e.colorPrimaries===Te.KHR_DF_PRIMARIES_DISPLAYP3?$e.transferFunction===Te.KHR_DF_TRANSFER_SRGB?se.DisplayP3ColorSpace:se.LinearDisplayP3ColorSpace:($e.colorPrimaries===Te.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${$e.colorPrimaries}"`),se.NoColorSpace)}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{MTLLoader:()=>me});var se=ve("./node_modules/three/build/three.module.js");class me extends se.Loader{constructor(be){super(be)}load(be,Pe,Le,xe){const Fe=this,Oe=this.path===""?se.LoaderUtils.extractUrlBase(be):this.path,Ne=new se.FileLoader(this.manager);Ne.setPath(this.path),Ne.setRequestHeader(this.requestHeader),Ne.setWithCredentials(this.withCredentials),Ne.load(be,function(ke){try{Pe(Fe.parse(ke,Oe))}catch(Ve){xe?xe(Ve):console.error(Ve),Fe.manager.itemError(be)}},Le,xe)}setMaterialOptions(be){return this.materialOptions=be,this}parse(be,Pe){const Le=be.split(`
`);let xe={};const Fe=/\s+/,Oe={};for(let ke=0;ke<Le.length;ke++){let Ve=Le[ke];if(Ve=Ve.trim(),Ve.length===0||Ve.charAt(0)==="#")continue;const Xe=Ve.indexOf(" ");let $e=Xe>=0?Ve.substring(0,Xe):Ve;$e=$e.toLowerCase();let st=Xe>=0?Ve.substring(Xe+1):"";if(st=st.trim(),$e==="newmtl")xe={name:st},Oe[st]=xe;else if($e==="ka"||$e==="kd"||$e==="ks"||$e==="ke"){const ze=st.split(Fe,3);xe[$e]=[parseFloat(ze[0]),parseFloat(ze[1]),parseFloat(ze[2])]}else xe[$e]=st}const Ne=new Te(this.resourcePath||Pe,this.materialOptions);return Ne.setCrossOrigin(this.crossOrigin),Ne.setManager(this.manager),Ne.setMaterials(Oe),Ne}}class Te{constructor(be="",Pe={}){this.baseUrl=be,this.options=Pe,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:se.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:se.RepeatWrapping}setCrossOrigin(be){return this.crossOrigin=be,this}setManager(be){this.manager=be}setMaterials(be){this.materialsInfo=this.convert(be),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(be){if(!this.options)return be;const Pe={};for(const Le in be){const xe=be[Le],Fe={};Pe[Le]=Fe;for(const Oe in xe){let Ne=!0,ke=xe[Oe];const Ve=Oe.toLowerCase();switch(Ve){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(ke=[ke[0]/255,ke[1]/255,ke[2]/255]),this.options&&this.options.ignoreZeroRGBs&&ke[0]===0&&ke[1]===0&&ke[2]===0&&(Ne=!1);break}Ne&&(Fe[Ve]=ke)}}return Pe}preload(){for(const be in this.materialsInfo)this.create(be)}getIndex(be){return this.nameLookup[be]}getAsArray(){let be=0;for(const Pe in this.materialsInfo)this.materialsArray[be]=this.create(Pe),this.nameLookup[Pe]=be,be++;return this.materialsArray}create(be){return this.materials[be]===void 0&&this.createMaterial_(be),this.materials[be]}createMaterial_(be){const Pe=this,Le=this.materialsInfo[be],xe={name:be,side:this.side};function Fe(Ne,ke){return typeof ke!="string"||ke===""?"":/^https?:\/\//i.test(ke)?ke:Ne+ke}function Oe(Ne,ke){if(xe[Ne])return;const Ve=Pe.getTextureParams(ke,xe),Xe=Pe.loadTexture(Fe(Pe.baseUrl,Ve.url));Xe.repeat.copy(Ve.scale),Xe.offset.copy(Ve.offset),Xe.wrapS=Pe.wrap,Xe.wrapT=Pe.wrap,(Ne==="map"||Ne==="emissiveMap")&&(Xe.colorSpace=se.SRGBColorSpace),xe[Ne]=Xe}for(const Ne in Le){const ke=Le[Ne];let Ve;if(ke!=="")switch(Ne.toLowerCase()){case"kd":xe.color=new se.Color().fromArray(ke).convertSRGBToLinear();break;case"ks":xe.specular=new se.Color().fromArray(ke).convertSRGBToLinear();break;case"ke":xe.emissive=new se.Color().fromArray(ke).convertSRGBToLinear();break;case"map_kd":Oe("map",ke);break;case"map_ks":Oe("specularMap",ke);break;case"map_ke":Oe("emissiveMap",ke);break;case"norm":Oe("normalMap",ke);break;case"map_bump":case"bump":Oe("bumpMap",ke);break;case"map_d":Oe("alphaMap",ke),xe.transparent=!0;break;case"ns":xe.shininess=parseFloat(ke);break;case"d":Ve=parseFloat(ke),Ve<1&&(xe.opacity=Ve,xe.transparent=!0);break;case"tr":Ve=parseFloat(ke),this.options&&this.options.invertTrProperty&&(Ve=1-Ve),Ve>0&&(xe.opacity=1-Ve,xe.transparent=!0);break}}return this.materials[be]=new se.MeshPhongMaterial(xe),this.materials[be]}getTextureParams(be,Pe){const Le={scale:new se.Vector2(1,1),offset:new se.Vector2(0,0)},xe=be.split(/\s+/);let Fe;return Fe=xe.indexOf("-bm"),Fe>=0&&(Pe.bumpScale=parseFloat(xe[Fe+1]),xe.splice(Fe,2)),Fe=xe.indexOf("-s"),Fe>=0&&(Le.scale.set(parseFloat(xe[Fe+1]),parseFloat(xe[Fe+2])),xe.splice(Fe,4)),Fe=xe.indexOf("-o"),Fe>=0&&(Le.offset.set(parseFloat(xe[Fe+1]),parseFloat(xe[Fe+2])),xe.splice(Fe,4)),Le.url=xe.join(" ").trim(),Le}loadTexture(be,Pe,Le,xe,Fe){const Oe=this.manager!==void 0?this.manager:se.DefaultLoadingManager;let Ne=Oe.getHandler(be);Ne===null&&(Ne=new se.TextureLoader(Oe)),Ne.setCrossOrigin&&Ne.setCrossOrigin(this.crossOrigin);const ke=Ne.load(be,Le,xe,Fe);return Pe!==void 0&&(ke.mapping=Pe),ke}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{OBJLoader:()=>Xe});var se=ve("./node_modules/three/build/three.module.js");const me=/^[og]\s*(.+)?/,Te=/^mtllib /,Re=/^usemtl /,be=/^usemap /,Pe=/\s+/,Le=new se.Vector3,xe=new se.Vector3,Fe=new se.Vector3,Oe=new se.Vector3,Ne=new se.Vector3,ke=new se.Color;function Ve(){const $e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(st,ze){if(this.object&&this.object.fromDeclaration===!1){this.object.name=st,this.object.fromDeclaration=ze!==!1;return}const tt=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:st||"",fromDeclaration:ze!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(ft,Rt){const Mt=this._finalize(!1);Mt&&(Mt.inherited||Mt.groupCount<=0)&&this.materials.splice(Mt.index,1);const Gt={index:this.materials.length,name:ft||"",mtllib:Array.isArray(Rt)&&Rt.length>0?Rt[Rt.length-1]:"",smooth:Mt!==void 0?Mt.smooth:this.smooth,groupStart:Mt!==void 0?Mt.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(_t){const Bt={index:typeof _t=="number"?_t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return Bt.clone=this.clone.bind(Bt),Bt}};return this.materials.push(Gt),Gt},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(ft){const Rt=this.currentMaterial();if(Rt&&Rt.groupEnd===-1&&(Rt.groupEnd=this.geometry.vertices.length/3,Rt.groupCount=Rt.groupEnd-Rt.groupStart,Rt.inherited=!1),ft&&this.materials.length>1)for(let Mt=this.materials.length-1;Mt>=0;Mt--)this.materials[Mt].groupCount<=0&&this.materials.splice(Mt,1);return ft&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),Rt}},tt&&tt.name&&typeof tt.clone=="function"){const ft=tt.clone(0);ft.inherited=!0,this.object.materials.push(ft)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(st,ze){const tt=parseInt(st,10);return(tt>=0?tt-1:tt+ze/3)*3},parseNormalIndex:function(st,ze){const tt=parseInt(st,10);return(tt>=0?tt-1:tt+ze/3)*3},parseUVIndex:function(st,ze){const tt=parseInt(st,10);return(tt>=0?tt-1:tt+ze/2)*2},addVertex:function(st,ze,tt){const ft=this.vertices,Rt=this.object.geometry.vertices;Rt.push(ft[st+0],ft[st+1],ft[st+2]),Rt.push(ft[ze+0],ft[ze+1],ft[ze+2]),Rt.push(ft[tt+0],ft[tt+1],ft[tt+2])},addVertexPoint:function(st){const ze=this.vertices;this.object.geometry.vertices.push(ze[st+0],ze[st+1],ze[st+2])},addVertexLine:function(st){const ze=this.vertices;this.object.geometry.vertices.push(ze[st+0],ze[st+1],ze[st+2])},addNormal:function(st,ze,tt){const ft=this.normals,Rt=this.object.geometry.normals;Rt.push(ft[st+0],ft[st+1],ft[st+2]),Rt.push(ft[ze+0],ft[ze+1],ft[ze+2]),Rt.push(ft[tt+0],ft[tt+1],ft[tt+2])},addFaceNormal:function(st,ze,tt){const ft=this.vertices,Rt=this.object.geometry.normals;Le.fromArray(ft,st),xe.fromArray(ft,ze),Fe.fromArray(ft,tt),Ne.subVectors(Fe,xe),Oe.subVectors(Le,xe),Ne.cross(Oe),Ne.normalize(),Rt.push(Ne.x,Ne.y,Ne.z),Rt.push(Ne.x,Ne.y,Ne.z),Rt.push(Ne.x,Ne.y,Ne.z)},addColor:function(st,ze,tt){const ft=this.colors,Rt=this.object.geometry.colors;ft[st]!==void 0&&Rt.push(ft[st+0],ft[st+1],ft[st+2]),ft[ze]!==void 0&&Rt.push(ft[ze+0],ft[ze+1],ft[ze+2]),ft[tt]!==void 0&&Rt.push(ft[tt+0],ft[tt+1],ft[tt+2])},addUV:function(st,ze,tt){const ft=this.uvs,Rt=this.object.geometry.uvs;Rt.push(ft[st+0],ft[st+1]),Rt.push(ft[ze+0],ft[ze+1]),Rt.push(ft[tt+0],ft[tt+1])},addDefaultUV:function(){const st=this.object.geometry.uvs;st.push(0,0),st.push(0,0),st.push(0,0)},addUVLine:function(st){const ze=this.uvs;this.object.geometry.uvs.push(ze[st+0],ze[st+1])},addFace:function(st,ze,tt,ft,Rt,Mt,Gt,_t,Bt){const dt=this.vertices.length;let ut=this.parseVertexIndex(st,dt),Ut=this.parseVertexIndex(ze,dt),Tt=this.parseVertexIndex(tt,dt);if(this.addVertex(ut,Ut,Tt),this.addColor(ut,Ut,Tt),Gt!==void 0&&Gt!==""){const Xt=this.normals.length;ut=this.parseNormalIndex(Gt,Xt),Ut=this.parseNormalIndex(_t,Xt),Tt=this.parseNormalIndex(Bt,Xt),this.addNormal(ut,Ut,Tt)}else this.addFaceNormal(ut,Ut,Tt);if(ft!==void 0&&ft!==""){const Xt=this.uvs.length;ut=this.parseUVIndex(ft,Xt),Ut=this.parseUVIndex(Rt,Xt),Tt=this.parseUVIndex(Mt,Xt),this.addUV(ut,Ut,Tt),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(st){this.object.geometry.type="Points";const ze=this.vertices.length;for(let tt=0,ft=st.length;tt<ft;tt++){const Rt=this.parseVertexIndex(st[tt],ze);this.addVertexPoint(Rt),this.addColor(Rt)}},addLineGeometry:function(st,ze){this.object.geometry.type="Line";const tt=this.vertices.length,ft=this.uvs.length;for(let Rt=0,Mt=st.length;Rt<Mt;Rt++)this.addVertexLine(this.parseVertexIndex(st[Rt],tt));for(let Rt=0,Mt=ze.length;Rt<Mt;Rt++)this.addUVLine(this.parseUVIndex(ze[Rt],ft))}};return $e.startObject("",!1),$e}class Xe extends se.Loader{constructor(st){super(st),this.materials=null}load(st,ze,tt,ft){const Rt=this,Mt=new se.FileLoader(this.manager);Mt.setPath(this.path),Mt.setRequestHeader(this.requestHeader),Mt.setWithCredentials(this.withCredentials),Mt.load(st,function(Gt){try{ze(Rt.parse(Gt))}catch(_t){ft?ft(_t):console.error(_t),Rt.manager.itemError(st)}},tt,ft)}setMaterials(st){return this.materials=st,this}parse(st){const ze=new Ve;st.indexOf(`\r
`)!==-1&&(st=st.replace(/\r\n/g,`
`)),st.indexOf(`\\
`)!==-1&&(st=st.replace(/\\\n/g,""));const tt=st.split(`
`);let ft=[];for(let Gt=0,_t=tt.length;Gt<_t;Gt++){const Bt=tt[Gt].trimStart();if(Bt.length===0)continue;const dt=Bt.charAt(0);if(dt!=="#")if(dt==="v"){const ut=Bt.split(Pe);switch(ut[0]){case"v":ze.vertices.push(parseFloat(ut[1]),parseFloat(ut[2]),parseFloat(ut[3])),ut.length>=7?(ke.setRGB(parseFloat(ut[4]),parseFloat(ut[5]),parseFloat(ut[6])).convertSRGBToLinear(),ze.colors.push(ke.r,ke.g,ke.b)):ze.colors.push(void 0,void 0,void 0);break;case"vn":ze.normals.push(parseFloat(ut[1]),parseFloat(ut[2]),parseFloat(ut[3]));break;case"vt":ze.uvs.push(parseFloat(ut[1]),parseFloat(ut[2]));break}}else if(dt==="f"){const Ut=Bt.slice(1).trim().split(Pe),Tt=[];for(let hn=0,nn=Ut.length;hn<nn;hn++){const An=Ut[hn];if(An.length>0){const Cn=An.split("/");Tt.push(Cn)}}const Xt=Tt[0];for(let hn=1,nn=Tt.length-1;hn<nn;hn++){const An=Tt[hn],Cn=Tt[hn+1];ze.addFace(Xt[0],An[0],Cn[0],Xt[1],An[1],Cn[1],Xt[2],An[2],Cn[2])}}else if(dt==="l"){const ut=Bt.substring(1).trim().split(" ");let Ut=[];const Tt=[];if(Bt.indexOf("/")===-1)Ut=ut;else for(let Xt=0,hn=ut.length;Xt<hn;Xt++){const nn=ut[Xt].split("/");nn[0]!==""&&Ut.push(nn[0]),nn[1]!==""&&Tt.push(nn[1])}ze.addLineGeometry(Ut,Tt)}else if(dt==="p"){const Ut=Bt.slice(1).trim().split(" ");ze.addPointGeometry(Ut)}else if((ft=me.exec(Bt))!==null){const ut=(" "+ft[0].slice(1).trim()).slice(1);ze.startObject(ut)}else if(Re.test(Bt))ze.object.startMaterial(Bt.substring(7).trim(),ze.materialLibraries);else if(Te.test(Bt))ze.materialLibraries.push(Bt.substring(7).trim());else if(be.test(Bt))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(dt==="s"){if(ft=Bt.split(" "),ft.length>1){const Ut=ft[1].trim().toLowerCase();ze.object.smooth=Ut!=="0"&&Ut!=="off"}else ze.object.smooth=!0;const ut=ze.object.currentMaterial();ut&&(ut.smooth=ze.object.smooth)}else{if(Bt==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+Bt+'"')}}ze.finalize();const Rt=new se.Group;if(Rt.materialLibraries=[].concat(ze.materialLibraries),!(ze.objects.length===1&&ze.objects[0].geometry.vertices.length===0)===!0)for(let Gt=0,_t=ze.objects.length;Gt<_t;Gt++){const Bt=ze.objects[Gt],dt=Bt.geometry,ut=Bt.materials,Ut=dt.type==="Line",Tt=dt.type==="Points";let Xt=!1;if(dt.vertices.length===0)continue;const hn=new se.BufferGeometry;hn.setAttribute("position",new se.Float32BufferAttribute(dt.vertices,3)),dt.normals.length>0&&hn.setAttribute("normal",new se.Float32BufferAttribute(dt.normals,3)),dt.colors.length>0&&(Xt=!0,hn.setAttribute("color",new se.Float32BufferAttribute(dt.colors,3))),dt.hasUVIndices===!0&&hn.setAttribute("uv",new se.Float32BufferAttribute(dt.uvs,2));const nn=[];for(let Cn=0,Nn=ut.length;Cn<Nn;Cn++){const Qn=ut[Cn],fi=Qn.name+"_"+Qn.smooth+"_"+Xt;let hi=ze.materials[fi];if(this.materials!==null){if(hi=this.materials.create(Qn.name),Ut&&hi&&!(hi instanceof se.LineBasicMaterial)){const Qi=new se.LineBasicMaterial;se.Material.prototype.copy.call(Qi,hi),Qi.color.copy(hi.color),hi=Qi}else if(Tt&&hi&&!(hi instanceof se.PointsMaterial)){const Qi=new se.PointsMaterial({size:10,sizeAttenuation:!1});se.Material.prototype.copy.call(Qi,hi),Qi.color.copy(hi.color),Qi.map=hi.map,hi=Qi}}hi===void 0&&(Ut?hi=new se.LineBasicMaterial:Tt?hi=new se.PointsMaterial({size:1,sizeAttenuation:!1}):hi=new se.MeshPhongMaterial,hi.name=Qn.name,hi.flatShading=!Qn.smooth,hi.vertexColors=Xt,ze.materials[fi]=hi),nn.push(hi)}let An;if(nn.length>1){for(let Cn=0,Nn=ut.length;Cn<Nn;Cn++){const Qn=ut[Cn];hn.addGroup(Qn.groupStart,Qn.groupCount,Cn)}Ut?An=new se.LineSegments(hn,nn):Tt?An=new se.Points(hn,nn):An=new se.Mesh(hn,nn)}else Ut?An=new se.LineSegments(hn,nn[0]):Tt?An=new se.Points(hn,nn[0]):An=new se.Mesh(hn,nn[0]);An.name=Bt.name,Rt.add(An)}else if(ze.vertices.length>0){const Gt=new se.PointsMaterial({size:1,sizeAttenuation:!1}),_t=new se.BufferGeometry;_t.setAttribute("position",new se.Float32BufferAttribute(ze.vertices,3)),ze.colors.length>0&&ze.colors[0]!==void 0&&(_t.setAttribute("color",new se.Float32BufferAttribute(ze.colors,3)),Gt.vertexColors=!0);const Bt=new se.Points(_t,Gt);Rt.add(Bt)}return Rt}}},"./node_modules/three/examples/jsm/math/OBB.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{OBB:()=>tt});var se=ve("./node_modules/three/build/three.module.js");const me={c:null,u:[new se.Vector3,new se.Vector3,new se.Vector3],e:[]},Te={c:null,u:[new se.Vector3,new se.Vector3,new se.Vector3],e:[]},Re=[[],[],[]],be=[[],[],[]],Pe=[],Le=new se.Vector3,xe=new se.Vector3,Fe=new se.Vector3,Oe=new se.Vector3,Ne=new se.Vector3,ke=new se.Vector3,Ve=new se.Matrix3,Xe=new se.Box3,$e=new se.Matrix4,st=new se.Matrix4,ze=new se.Ray;class tt{constructor(Mt=new se.Vector3,Gt=new se.Vector3,_t=new se.Matrix3){this.center=Mt,this.halfSize=Gt,this.rotation=_t}set(Mt,Gt,_t){return this.center=Mt,this.halfSize=Gt,this.rotation=_t,this}copy(Mt){return this.center.copy(Mt.center),this.halfSize.copy(Mt.halfSize),this.rotation.copy(Mt.rotation),this}clone(){return new this.constructor().copy(this)}getSize(Mt){return Mt.copy(this.halfSize).multiplyScalar(2)}clampPoint(Mt,Gt){const _t=this.halfSize;Oe.subVectors(Mt,this.center),this.rotation.extractBasis(Le,xe,Fe),Gt.copy(this.center);const Bt=se.MathUtils.clamp(Oe.dot(Le),-_t.x,_t.x);Gt.add(Le.multiplyScalar(Bt));const dt=se.MathUtils.clamp(Oe.dot(xe),-_t.y,_t.y);Gt.add(xe.multiplyScalar(dt));const ut=se.MathUtils.clamp(Oe.dot(Fe),-_t.z,_t.z);return Gt.add(Fe.multiplyScalar(ut)),Gt}containsPoint(Mt){return Oe.subVectors(Mt,this.center),this.rotation.extractBasis(Le,xe,Fe),Math.abs(Oe.dot(Le))<=this.halfSize.x&&Math.abs(Oe.dot(xe))<=this.halfSize.y&&Math.abs(Oe.dot(Fe))<=this.halfSize.z}intersectsBox3(Mt){return this.intersectsOBB(ft.fromBox3(Mt))}intersectsSphere(Mt){return this.clampPoint(Mt.center,ke),ke.distanceToSquared(Mt.center)<=Mt.radius*Mt.radius}intersectsOBB(Mt,Gt=Number.EPSILON){me.c=this.center,me.e[0]=this.halfSize.x,me.e[1]=this.halfSize.y,me.e[2]=this.halfSize.z,this.rotation.extractBasis(me.u[0],me.u[1],me.u[2]),Te.c=Mt.center,Te.e[0]=Mt.halfSize.x,Te.e[1]=Mt.halfSize.y,Te.e[2]=Mt.halfSize.z,Mt.rotation.extractBasis(Te.u[0],Te.u[1],Te.u[2]);for(let dt=0;dt<3;dt++)for(let ut=0;ut<3;ut++)Re[dt][ut]=me.u[dt].dot(Te.u[ut]);Oe.subVectors(Te.c,me.c),Pe[0]=Oe.dot(me.u[0]),Pe[1]=Oe.dot(me.u[1]),Pe[2]=Oe.dot(me.u[2]);for(let dt=0;dt<3;dt++)for(let ut=0;ut<3;ut++)be[dt][ut]=Math.abs(Re[dt][ut])+Gt;let _t,Bt;for(let dt=0;dt<3;dt++)if(_t=me.e[dt],Bt=Te.e[0]*be[dt][0]+Te.e[1]*be[dt][1]+Te.e[2]*be[dt][2],Math.abs(Pe[dt])>_t+Bt)return!1;for(let dt=0;dt<3;dt++)if(_t=me.e[0]*be[0][dt]+me.e[1]*be[1][dt]+me.e[2]*be[2][dt],Bt=Te.e[dt],Math.abs(Pe[0]*Re[0][dt]+Pe[1]*Re[1][dt]+Pe[2]*Re[2][dt])>_t+Bt)return!1;return _t=me.e[1]*be[2][0]+me.e[2]*be[1][0],Bt=Te.e[1]*be[0][2]+Te.e[2]*be[0][1],!(Math.abs(Pe[2]*Re[1][0]-Pe[1]*Re[2][0])>_t+Bt||(_t=me.e[1]*be[2][1]+me.e[2]*be[1][1],Bt=Te.e[0]*be[0][2]+Te.e[2]*be[0][0],Math.abs(Pe[2]*Re[1][1]-Pe[1]*Re[2][1])>_t+Bt)||(_t=me.e[1]*be[2][2]+me.e[2]*be[1][2],Bt=Te.e[0]*be[0][1]+Te.e[1]*be[0][0],Math.abs(Pe[2]*Re[1][2]-Pe[1]*Re[2][2])>_t+Bt)||(_t=me.e[0]*be[2][0]+me.e[2]*be[0][0],Bt=Te.e[1]*be[1][2]+Te.e[2]*be[1][1],Math.abs(Pe[0]*Re[2][0]-Pe[2]*Re[0][0])>_t+Bt)||(_t=me.e[0]*be[2][1]+me.e[2]*be[0][1],Bt=Te.e[0]*be[1][2]+Te.e[2]*be[1][0],Math.abs(Pe[0]*Re[2][1]-Pe[2]*Re[0][1])>_t+Bt)||(_t=me.e[0]*be[2][2]+me.e[2]*be[0][2],Bt=Te.e[0]*be[1][1]+Te.e[1]*be[1][0],Math.abs(Pe[0]*Re[2][2]-Pe[2]*Re[0][2])>_t+Bt)||(_t=me.e[0]*be[1][0]+me.e[1]*be[0][0],Bt=Te.e[1]*be[2][2]+Te.e[2]*be[2][1],Math.abs(Pe[1]*Re[0][0]-Pe[0]*Re[1][0])>_t+Bt)||(_t=me.e[0]*be[1][1]+me.e[1]*be[0][1],Bt=Te.e[0]*be[2][2]+Te.e[2]*be[2][0],Math.abs(Pe[1]*Re[0][1]-Pe[0]*Re[1][1])>_t+Bt)||(_t=me.e[0]*be[1][2]+me.e[1]*be[0][2],Bt=Te.e[0]*be[2][1]+Te.e[1]*be[2][0],Math.abs(Pe[1]*Re[0][2]-Pe[0]*Re[1][2])>_t+Bt))}intersectsPlane(Mt){this.rotation.extractBasis(Le,xe,Fe);const Gt=this.halfSize.x*Math.abs(Mt.normal.dot(Le))+this.halfSize.y*Math.abs(Mt.normal.dot(xe))+this.halfSize.z*Math.abs(Mt.normal.dot(Fe)),_t=Mt.normal.dot(this.center)-Mt.constant;return Math.abs(_t)<=Gt}intersectRay(Mt,Gt){return this.getSize(Ne),Xe.setFromCenterAndSize(Oe.set(0,0,0),Ne),$e.setFromMatrix3(this.rotation),$e.setPosition(this.center),st.copy($e).invert(),ze.copy(Mt).applyMatrix4(st),ze.intersectBox(Xe,Gt)?Gt.applyMatrix4($e):null}intersectsRay(Mt){return this.intersectRay(Mt,Oe)!==null}fromBox3(Mt){return Mt.getCenter(this.center),Mt.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(Mt){return Mt.center.equals(this.center)&&Mt.halfSize.equals(this.halfSize)&&Mt.rotation.equals(this.rotation)}applyMatrix4(Mt){const Gt=Mt.elements;let _t=Oe.set(Gt[0],Gt[1],Gt[2]).length();const Bt=Oe.set(Gt[4],Gt[5],Gt[6]).length(),dt=Oe.set(Gt[8],Gt[9],Gt[10]).length();Mt.determinant()<0&&(_t=-_t),Ve.setFromMatrix4(Mt);const Ut=1/_t,Tt=1/Bt,Xt=1/dt;return Ve.elements[0]*=Ut,Ve.elements[1]*=Ut,Ve.elements[2]*=Ut,Ve.elements[3]*=Tt,Ve.elements[4]*=Tt,Ve.elements[5]*=Tt,Ve.elements[6]*=Xt,Ve.elements[7]*=Xt,Ve.elements[8]*=Xt,this.rotation.multiply(Ve),this.halfSize.x*=_t,this.halfSize.y*=Bt,this.halfSize.z*=dt,Oe.setFromMatrixPosition(Mt),this.center.add(Oe),this}}const ft=new tt},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{computeMikkTSpaceTangents:()=>me,computeMorphedAttributes:()=>ke,deepCloneAttribute:()=>be,deinterleaveAttribute:()=>Le,deinterleaveGeometry:()=>xe,estimateBytesUsed:()=>Fe,interleaveAttributes:()=>Pe,mergeAttributes:()=>Re,mergeGeometries:()=>Te,mergeGroups:()=>Ve,mergeVertices:()=>Oe,toCreasedNormals:()=>Xe,toTrianglesDrawMode:()=>Ne});var se=ve("./node_modules/three/build/three.module.js");function me($e,st,ze=!0){if(!st||!st.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!$e.hasAttribute("position")||!$e.hasAttribute("normal")||!$e.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function tt(Mt){if(Mt.normalized||Mt.isInterleavedBufferAttribute){const Gt=new Float32Array(Mt.count*Mt.itemSize);for(let _t=0,Bt=0;_t<Mt.count;_t++)Gt[Bt++]=Mt.getX(_t),Gt[Bt++]=Mt.getY(_t),Mt.itemSize>2&&(Gt[Bt++]=Mt.getZ(_t));return Gt}return Mt.array instanceof Float32Array?Mt.array:new Float32Array(Mt.array)}const ft=$e.index?$e.toNonIndexed():$e,Rt=st.generateTangents(tt(ft.attributes.position),tt(ft.attributes.normal),tt(ft.attributes.uv));if(ze)for(let Mt=3;Mt<Rt.length;Mt+=4)Rt[Mt]*=-1;return ft.setAttribute("tangent",new se.BufferAttribute(Rt,4)),$e!==ft&&$e.copy(ft),$e}function Te($e,st=!1){const ze=$e[0].index!==null,tt=new Set(Object.keys($e[0].attributes)),ft=new Set(Object.keys($e[0].morphAttributes)),Rt={},Mt={},Gt=$e[0].morphTargetsRelative,_t=new se.BufferGeometry;let Bt=0;for(let dt=0;dt<$e.length;++dt){const ut=$e[dt];let Ut=0;if(ze!==(ut.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dt+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const Tt in ut.attributes){if(!tt.has(Tt))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dt+'. All geometries must have compatible attributes; make sure "'+Tt+'" attribute exists among all geometries, or in none of them.'),null;Rt[Tt]===void 0&&(Rt[Tt]=[]),Rt[Tt].push(ut.attributes[Tt]),Ut++}if(Ut!==tt.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dt+". Make sure all geometries have the same number of attributes."),null;if(Gt!==ut.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dt+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const Tt in ut.morphAttributes){if(!ft.has(Tt))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dt+".  .morphAttributes must be consistent throughout all geometries."),null;Mt[Tt]===void 0&&(Mt[Tt]=[]),Mt[Tt].push(ut.morphAttributes[Tt])}if(st){let Tt;if(ze)Tt=ut.index.count;else if(ut.attributes.position!==void 0)Tt=ut.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+dt+". The geometry must have either an index or a position attribute"),null;_t.addGroup(Bt,Tt,dt),Bt+=Tt}}if(ze){let dt=0;const ut=[];for(let Ut=0;Ut<$e.length;++Ut){const Tt=$e[Ut].index;for(let Xt=0;Xt<Tt.count;++Xt)ut.push(Tt.getX(Xt)+dt);dt+=$e[Ut].attributes.position.count}_t.setIndex(ut)}for(const dt in Rt){const ut=Re(Rt[dt]);if(!ut)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+dt+" attribute."),null;_t.setAttribute(dt,ut)}for(const dt in Mt){const ut=Mt[dt][0].length;if(ut===0)break;_t.morphAttributes=_t.morphAttributes||{},_t.morphAttributes[dt]=[];for(let Ut=0;Ut<ut;++Ut){const Tt=[];for(let hn=0;hn<Mt[dt].length;++hn)Tt.push(Mt[dt][hn][Ut]);const Xt=Re(Tt);if(!Xt)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+dt+" morphAttribute."),null;_t.morphAttributes[dt].push(Xt)}}return _t}function Re($e){let st,ze,tt,ft=-1,Rt=0;for(let Bt=0;Bt<$e.length;++Bt){const dt=$e[Bt];if(st===void 0&&(st=dt.array.constructor),st!==dt.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(ze===void 0&&(ze=dt.itemSize),ze!==dt.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(tt===void 0&&(tt=dt.normalized),tt!==dt.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(ft===-1&&(ft=dt.gpuType),ft!==dt.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;Rt+=dt.count*ze}const Mt=new st(Rt),Gt=new se.BufferAttribute(Mt,ze,tt);let _t=0;for(let Bt=0;Bt<$e.length;++Bt){const dt=$e[Bt];if(dt.isInterleavedBufferAttribute){const ut=_t/ze;for(let Ut=0,Tt=dt.count;Ut<Tt;Ut++)for(let Xt=0;Xt<ze;Xt++){const hn=dt.getComponent(Ut,Xt);Gt.setComponent(Ut+ut,Xt,hn)}}else Mt.set(dt.array,_t);_t+=dt.count*ze}return ft!==void 0&&(Gt.gpuType=ft),Gt}function be($e){return $e.isInstancedInterleavedBufferAttribute||$e.isInterleavedBufferAttribute?Le($e):$e.isInstancedBufferAttribute?new se.InstancedBufferAttribute().copy($e):new se.BufferAttribute().copy($e)}function Pe($e){let st,ze=0,tt=0;for(let Bt=0,dt=$e.length;Bt<dt;++Bt){const ut=$e[Bt];if(st===void 0&&(st=ut.array.constructor),st!==ut.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;ze+=ut.array.length,tt+=ut.itemSize}const ft=new se.InterleavedBuffer(new st(ze),tt);let Rt=0;const Mt=[],Gt=["getX","getY","getZ","getW"],_t=["setX","setY","setZ","setW"];for(let Bt=0,dt=$e.length;Bt<dt;Bt++){const ut=$e[Bt],Ut=ut.itemSize,Tt=ut.count,Xt=new se.InterleavedBufferAttribute(ft,Ut,Rt,ut.normalized);Mt.push(Xt),Rt+=Ut;for(let hn=0;hn<Tt;hn++)for(let nn=0;nn<Ut;nn++)Xt[_t[nn]](hn,ut[Gt[nn]](hn))}return Mt}function Le($e){const st=$e.data.array.constructor,ze=$e.count,tt=$e.itemSize,ft=$e.normalized,Rt=new st(ze*tt);let Mt;$e.isInstancedInterleavedBufferAttribute?Mt=new se.InstancedBufferAttribute(Rt,tt,ft,$e.meshPerAttribute):Mt=new se.BufferAttribute(Rt,tt,ft);for(let Gt=0;Gt<ze;Gt++)Mt.setX(Gt,$e.getX(Gt)),tt>=2&&Mt.setY(Gt,$e.getY(Gt)),tt>=3&&Mt.setZ(Gt,$e.getZ(Gt)),tt>=4&&Mt.setW(Gt,$e.getW(Gt));return Mt}function xe($e){const st=$e.attributes,ze=$e.morphTargets,tt=new Map;for(const ft in st){const Rt=st[ft];Rt.isInterleavedBufferAttribute&&(tt.has(Rt)||tt.set(Rt,Le(Rt)),st[ft]=tt.get(Rt))}for(const ft in ze){const Rt=ze[ft];Rt.isInterleavedBufferAttribute&&(tt.has(Rt)||tt.set(Rt,Le(Rt)),ze[ft]=tt.get(Rt))}}function Fe($e){let st=0;for(const tt in $e.attributes){const ft=$e.getAttribute(tt);st+=ft.count*ft.itemSize*ft.array.BYTES_PER_ELEMENT}const ze=$e.getIndex();return st+=ze?ze.count*ze.itemSize*ze.array.BYTES_PER_ELEMENT:0,st}function Oe($e,st=1e-4){st=Math.max(st,Number.EPSILON);const ze={},tt=$e.getIndex(),ft=$e.getAttribute("position"),Rt=tt?tt.count:ft.count;let Mt=0;const Gt=Object.keys($e.attributes),_t={},Bt={},dt=[],ut=["getX","getY","getZ","getW"],Ut=["setX","setY","setZ","setW"];for(let Cn=0,Nn=Gt.length;Cn<Nn;Cn++){const Qn=Gt[Cn],fi=$e.attributes[Qn];_t[Qn]=new se.BufferAttribute(new fi.array.constructor(fi.count*fi.itemSize),fi.itemSize,fi.normalized);const hi=$e.morphAttributes[Qn];hi&&(Bt[Qn]=new se.BufferAttribute(new hi.array.constructor(hi.count*hi.itemSize),hi.itemSize,hi.normalized))}const Tt=st*.5,Xt=Math.log10(1/st),hn=Math.pow(10,Xt),nn=Tt*hn;for(let Cn=0;Cn<Rt;Cn++){const Nn=tt?tt.getX(Cn):Cn;let Qn="";for(let fi=0,hi=Gt.length;fi<hi;fi++){const Qi=Gt[fi],Zi=$e.getAttribute(Qi),Mn=Zi.itemSize;for(let Vr=0;Vr<Mn;Vr++)Qn+=`${~~(Zi[ut[Vr]](Nn)*hn+nn)},`}if(Qn in ze)dt.push(ze[Qn]);else{for(let fi=0,hi=Gt.length;fi<hi;fi++){const Qi=Gt[fi],Zi=$e.getAttribute(Qi),Mn=$e.morphAttributes[Qi],Vr=Zi.itemSize,Ir=_t[Qi],Rr=Bt[Qi];for(let ir=0;ir<Vr;ir++){const zr=ut[ir],Br=Ut[ir];if(Ir[Br](Mt,Zi[zr](Nn)),Mn)for(let kt=0,rn=Mn.length;kt<rn;kt++)Rr[kt][Br](Mt,Mn[kt][zr](Nn))}}ze[Qn]=Mt,dt.push(Mt),Mt++}}const An=$e.clone();for(const Cn in $e.attributes){const Nn=_t[Cn];if(An.setAttribute(Cn,new se.BufferAttribute(Nn.array.slice(0,Mt*Nn.itemSize),Nn.itemSize,Nn.normalized)),Cn in Bt)for(let Qn=0;Qn<Bt[Cn].length;Qn++){const fi=Bt[Cn][Qn];An.morphAttributes[Cn][Qn]=new se.BufferAttribute(fi.array.slice(0,Mt*fi.itemSize),fi.itemSize,fi.normalized)}}return An.setIndex(dt),An}function Ne($e,st){if(st===se.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),$e;if(st===se.TriangleFanDrawMode||st===se.TriangleStripDrawMode){let ze=$e.getIndex();if(ze===null){const Mt=[],Gt=$e.getAttribute("position");if(Gt!==void 0){for(let _t=0;_t<Gt.count;_t++)Mt.push(_t);$e.setIndex(Mt),ze=$e.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),$e}const tt=ze.count-2,ft=[];if(st===se.TriangleFanDrawMode)for(let Mt=1;Mt<=tt;Mt++)ft.push(ze.getX(0)),ft.push(ze.getX(Mt)),ft.push(ze.getX(Mt+1));else for(let Mt=0;Mt<tt;Mt++)Mt%2===0?(ft.push(ze.getX(Mt)),ft.push(ze.getX(Mt+1)),ft.push(ze.getX(Mt+2))):(ft.push(ze.getX(Mt+2)),ft.push(ze.getX(Mt+1)),ft.push(ze.getX(Mt)));ft.length/3!==tt&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const Rt=$e.clone();return Rt.setIndex(ft),Rt.clearGroups(),Rt}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",st),$e}function ke($e){const st=new se.Vector3,ze=new se.Vector3,tt=new se.Vector3,ft=new se.Vector3,Rt=new se.Vector3,Mt=new se.Vector3,Gt=new se.Vector3,_t=new se.Vector3,Bt=new se.Vector3;function dt(ai,Ui,yi,Nr,Ar,fr,Bi,Kt){st.fromBufferAttribute(Ui,Ar),ze.fromBufferAttribute(Ui,fr),tt.fromBufferAttribute(Ui,Bi);const Yt=ai.morphTargetInfluences;if(yi&&Yt){Gt.set(0,0,0),_t.set(0,0,0),Bt.set(0,0,0);for(let fn=0,on=yi.length;fn<on;fn++){const an=Yt[fn],gn=yi[fn];an!==0&&(ft.fromBufferAttribute(gn,Ar),Rt.fromBufferAttribute(gn,fr),Mt.fromBufferAttribute(gn,Bi),Nr?(Gt.addScaledVector(ft,an),_t.addScaledVector(Rt,an),Bt.addScaledVector(Mt,an)):(Gt.addScaledVector(ft.sub(st),an),_t.addScaledVector(Rt.sub(ze),an),Bt.addScaledVector(Mt.sub(tt),an)))}st.add(Gt),ze.add(_t),tt.add(Bt)}ai.isSkinnedMesh&&(ai.applyBoneTransform(Ar,st),ai.applyBoneTransform(fr,ze),ai.applyBoneTransform(Bi,tt)),Kt[Ar*3+0]=st.x,Kt[Ar*3+1]=st.y,Kt[Ar*3+2]=st.z,Kt[fr*3+0]=ze.x,Kt[fr*3+1]=ze.y,Kt[fr*3+2]=ze.z,Kt[Bi*3+0]=tt.x,Kt[Bi*3+1]=tt.y,Kt[Bi*3+2]=tt.z}const ut=$e.geometry,Ut=$e.material;let Tt,Xt,hn;const nn=ut.index,An=ut.attributes.position,Cn=ut.morphAttributes.position,Nn=ut.morphTargetsRelative,Qn=ut.attributes.normal,fi=ut.morphAttributes.position,hi=ut.groups,Qi=ut.drawRange;let Zi,Mn,Vr,Ir,Rr,ir,zr;const Br=new Float32Array(An.count*An.itemSize),kt=new Float32Array(Qn.count*Qn.itemSize);if(nn!==null)if(Array.isArray(Ut))for(Zi=0,Vr=hi.length;Zi<Vr;Zi++)for(Rr=hi[Zi],ir=Math.max(Rr.start,Qi.start),zr=Math.min(Rr.start+Rr.count,Qi.start+Qi.count),Mn=ir,Ir=zr;Mn<Ir;Mn+=3)Tt=nn.getX(Mn),Xt=nn.getX(Mn+1),hn=nn.getX(Mn+2),dt($e,An,Cn,Nn,Tt,Xt,hn,Br),dt($e,Qn,fi,Nn,Tt,Xt,hn,kt);else for(ir=Math.max(0,Qi.start),zr=Math.min(nn.count,Qi.start+Qi.count),Zi=ir,Vr=zr;Zi<Vr;Zi+=3)Tt=nn.getX(Zi),Xt=nn.getX(Zi+1),hn=nn.getX(Zi+2),dt($e,An,Cn,Nn,Tt,Xt,hn,Br),dt($e,Qn,fi,Nn,Tt,Xt,hn,kt);else if(Array.isArray(Ut))for(Zi=0,Vr=hi.length;Zi<Vr;Zi++)for(Rr=hi[Zi],ir=Math.max(Rr.start,Qi.start),zr=Math.min(Rr.start+Rr.count,Qi.start+Qi.count),Mn=ir,Ir=zr;Mn<Ir;Mn+=3)Tt=Mn,Xt=Mn+1,hn=Mn+2,dt($e,An,Cn,Nn,Tt,Xt,hn,Br),dt($e,Qn,fi,Nn,Tt,Xt,hn,kt);else for(ir=Math.max(0,Qi.start),zr=Math.min(An.count,Qi.start+Qi.count),Zi=ir,Vr=zr;Zi<Vr;Zi+=3)Tt=Zi,Xt=Zi+1,hn=Zi+2,dt($e,An,Cn,Nn,Tt,Xt,hn,Br),dt($e,Qn,fi,Nn,Tt,Xt,hn,kt);const rn=new se.Float32BufferAttribute(Br,3),Kn=new se.Float32BufferAttribute(kt,3);return{positionAttribute:An,normalAttribute:Qn,morphedPositionAttribute:rn,morphedNormalAttribute:Kn}}function Ve($e){if($e.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),$e;let st=$e.groups;if(st=st.sort((Mt,Gt)=>Mt.materialIndex!==Gt.materialIndex?Mt.materialIndex-Gt.materialIndex:Mt.start-Gt.start),$e.getIndex()===null){const Mt=$e.getAttribute("position"),Gt=[];for(let _t=0;_t<Mt.count;_t+=3)Gt.push(_t,_t+1,_t+2);$e.setIndex(Gt)}const ze=$e.getIndex(),tt=[];for(let Mt=0;Mt<st.length;Mt++){const Gt=st[Mt],_t=Gt.start,Bt=_t+Gt.count;for(let dt=_t;dt<Bt;dt++)tt.push(ze.getX(dt))}$e.dispose(),$e.setIndex(tt);let ft=0;for(let Mt=0;Mt<st.length;Mt++){const Gt=st[Mt];Gt.start=ft,ft+=Gt.count}let Rt=st[0];$e.groups=[Rt];for(let Mt=1;Mt<st.length;Mt++){const Gt=st[Mt];Rt.materialIndex===Gt.materialIndex?Rt.count+=Gt.count:(Rt=Gt,$e.groups.push(Rt))}return $e}function Xe($e,st=Math.PI/3){const ze=Math.cos(st),tt=(1+1e-10)*100,ft=[new se.Vector3,new se.Vector3,new se.Vector3],Rt=new se.Vector3,Mt=new se.Vector3,Gt=new se.Vector3,_t=new se.Vector3;function Bt(hn){const nn=~~(hn.x*tt),An=~~(hn.y*tt),Cn=~~(hn.z*tt);return`${nn},${An},${Cn}`}const dt=$e.index?$e.toNonIndexed():$e,ut=dt.attributes.position,Ut={};for(let hn=0,nn=ut.count/3;hn<nn;hn++){const An=3*hn,Cn=ft[0].fromBufferAttribute(ut,An+0),Nn=ft[1].fromBufferAttribute(ut,An+1),Qn=ft[2].fromBufferAttribute(ut,An+2);Rt.subVectors(Qn,Nn),Mt.subVectors(Cn,Nn);const fi=new se.Vector3().crossVectors(Rt,Mt).normalize();for(let hi=0;hi<3;hi++){const Qi=ft[hi],Zi=Bt(Qi);Zi in Ut||(Ut[Zi]=[]),Ut[Zi].push(fi)}}const Tt=new Float32Array(ut.count*3),Xt=new se.BufferAttribute(Tt,3,!1);for(let hn=0,nn=ut.count/3;hn<nn;hn++){const An=3*hn,Cn=ft[0].fromBufferAttribute(ut,An+0),Nn=ft[1].fromBufferAttribute(ut,An+1),Qn=ft[2].fromBufferAttribute(ut,An+2);Rt.subVectors(Qn,Nn),Mt.subVectors(Cn,Nn),Gt.crossVectors(Rt,Mt).normalize();for(let fi=0;fi<3;fi++){const hi=ft[fi],Qi=Bt(hi),Zi=Ut[Qi];_t.set(0,0,0);for(let Mn=0,Vr=Zi.length;Mn<Vr;Mn++){const Ir=Zi[Mn];Gt.dot(Ir)>ze&&_t.add(Ir)}_t.normalize(),Xt.setXYZ(An+fi,_t.x,_t.y,_t.z)}}return dt.setAttribute("normal",Xt),dt}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{WorkerPool:()=>se});class se{constructor(Te=4){this.pool=Te,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(Te){if(!this.workers[Te]){const Re=this.workerCreator();Re.addEventListener("message",this._onMessage.bind(this,Te)),this.workers[Te]=Re}}_getIdleWorker(){for(let Te=0;Te<this.pool;Te++)if(!(this.workerStatus&1<<Te))return Te;return-1}_onMessage(Te,Re){const be=this.workersResolve[Te];if(be&&be(Re),this.queue.length){const{resolve:Pe,msg:Le,transfer:xe}=this.queue.shift();this.workersResolve[Te]=Pe,this.workers[Te].postMessage(Le,xe)}else this.workerStatus^=1<<Te}setWorkerCreator(Te){this.workerCreator=Te}setWorkerLimit(Te){this.pool=Te}postMessage(Te,Re){return new Promise(be=>{const Pe=this._getIdleWorker();Pe!==-1?(this._initWorker(Pe),this.workerStatus|=1<<Pe,this.workersResolve[Pe]=be,this.workers[Pe].postMessage(Te,Re)):this.queue.push({resolve:be,msg:Te,transfer:Re})})}dispose(){this.workers.forEach(Te=>Te.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./src/lib/three.mjs":(pe,Me,ve)=>{ve.r(Me),ve.d(Me,{default:()=>Ne});var se=ve("./node_modules/three/build/three.module.js"),me=ve("./node_modules/three/examples/jsm/loaders/DRACOLoader.js"),Te=ve("./node_modules/three/examples/jsm/loaders/GLTFLoader.js"),Re=ve("./node_modules/three/examples/jsm/loaders/KTX2Loader.js"),be=ve("./node_modules/three/examples/jsm/math/OBB.js"),Pe=ve("./node_modules/three/examples/jsm/loaders/OBJLoader.js"),Le=ve("./node_modules/three/examples/jsm/loaders/MTLLoader.js"),xe=ve("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js"),Fe=ve("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js"),Oe={...se};Oe.DRACOLoader=me.DRACOLoader,Oe.GLTFLoader=Te.GLTFLoader,Oe.KTX2Loader=Re.KTX2Loader,Oe.OBJLoader=Pe.OBJLoader,Oe.MTLLoader=Le.MTLLoader,Oe.OBB=be.OBB,Oe.BufferGeometryUtils=xe,Oe.LightProbeGenerator=Fe.LightProbeGenerator;const Ne=Oe},"./package.json":pe=>{pe.exports=JSON.parse('{"name":"aframe","version":"1.6.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.5.0 1.6.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node --experimental-require-module ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.164.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},ne={};function F(pe){var Me=ne[pe];if(Me!==void 0)return Me.exports;var ve=ne[pe]={id:pe,exports:{}};return ie[pe].call(ve.exports,ve,ve.exports,F),ve.exports}F.m=ie,F.n=pe=>{var Me=pe&&pe.__esModule?()=>pe.default:()=>pe;return F.d(Me,{a:Me}),Me},F.d=(pe,Me)=>{for(var ve in Me)F.o(Me,ve)&&!F.o(pe,ve)&&Object.defineProperty(pe,ve,{enumerable:!0,get:Me[ve]})},F.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),F.o=(pe,Me)=>Object.prototype.hasOwnProperty.call(pe,Me),F.r=pe=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(pe,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(pe,"__esModule",{value:!0})},F.b=document.baseURI||self.location.href,F.nc=void 0;var fe=F("./src/index.js");return fe})())}(aframeMaster)),aframeMaster.exports}requireAframeMaster();function commonjsRequire(re){throw new Error('Could not dynamically require "'+re+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var aframeAr_min={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(__viteBrowserExternal$1);aframeAr_min.exports;var hasRequiredAframeAr_min;function requireAframeAr_min(){return hasRequiredAframeAr_min||(hasRequiredAframeAr_min=1,function(module){(function(){var re=function(xe,Fe,Oe){var Ne=xe,ke=Fe;if(this.orientation="landscape",this.listeners={},typeof xe!="number"){var Ve=xe;Oe=Fe,Ne=Ve.videoWidth||Ve.width,ke=Ve.videoHeight||Ve.height,this.image=Ve}if(this.defaultMarkerWidth=1,this.patternMarkers={},this.barcodeMarkers={},this.transform_mat=new Float32Array(16),this.canvas=document.createElement("canvas"),this.canvas.width=Ne,this.canvas.height=ke,this.ctx=this.canvas.getContext("2d"),this.videoWidth=Ne,this.videoHeight=ke,typeof Oe=="string"){var Xe=this;this.cameraParam=new U(Oe,function(){Xe._initialize()},function($e){console.error("ARController: Failed to load ARCameraParam",$e)})}else this.cameraParam=Oe,this._initialize()};re.prototype.dispose=function(){Y.teardown(this.id);for(var xe in this)this[xe]=null},re.prototype.process=function(xe){this.detectMarker(xe);var Fe=this.getMarkerNum(),Oe,Ne;for(Oe in this.patternMarkers)Ne=this.patternMarkers[Oe],Ne.inPrevious=Ne.inCurrent,Ne.inCurrent=!1;for(Oe in this.barcodeMarkers)Ne=this.barcodeMarkers[Oe],Ne.inPrevious=Ne.inCurrent,Ne.inCurrent=!1;for(var ke=0;ke<Fe;ke++){var Ve=this.getMarker(ke),Xe=Y.UNKNOWN_MARKER,$e=this.trackPatternMarkerId(-1);Ve.idPatt>-1&&(Ve.id===Ve.idPatt||Ve.idMatrix===-1)?($e=this.trackPatternMarkerId(Ve.idPatt),Xe=Y.PATTERN_MARKER,Ve.dir!==Ve.dirPatt&&this.setMarkerInfoDir(ke,Ve.dirPatt)):Ve.idMatrix>-1&&($e=this.trackBarcodeMarkerId(Ve.idMatrix),Xe=Y.BARCODE_MARKER,Ve.dir!==Ve.dirMatrix&&this.setMarkerInfoDir(ke,Ve.dirMatrix)),Xe!==Y.UNKNOWN_MARKER&&$e.inPrevious?this.getTransMatSquareCont(ke,$e.markerWidth,$e.matrix,$e.matrix):this.getTransMatSquare(ke,$e.markerWidth,$e.matrix),$e.inCurrent=!0,this.transMatToGLMat($e.matrix,this.transform_mat),this.dispatchEvent({name:"getMarker",target:this,data:{index:ke,type:Xe,marker:Ve,matrix:this.transform_mat}})}for(var st=this.getMultiMarkerCount(),ke=0;ke<st;ke++){var ze=this.getMultiMarkerPatternCount(ke),$e=!1;Y.getTransMatMultiSquareRobust(this.id,ke),this.transMatToGLMat(this.marker_transform_mat,this.transform_mat);for(var tt=0;tt<ze;tt++){var ft=this.getMultiEachMarker(ke,tt);if(ft.visible>=0){$e=!0,this.dispatchEvent({name:"getMultiMarker",target:this,data:{multiMarkerId:ke,matrix:this.transform_mat}});break}}if($e)for(var tt=0;tt<ze;tt++){var ft=this.getMultiEachMarker(ke,tt);this.transMatToGLMat(this.marker_transform_mat,this.transform_mat),this.dispatchEvent({name:"getMultiMarkerSub",target:this,data:{multiMarkerId:ke,markerIndex:tt,marker:ft,matrix:this.transform_mat}})}}this._bwpointer&&this.debugDraw()},re.prototype.trackPatternMarkerId=function(xe,Fe){var Oe=this.patternMarkers[xe];return Oe||(this.patternMarkers[xe]=Oe={inPrevious:!1,inCurrent:!1,matrix:new Float32Array(12),markerWidth:Fe||this.defaultMarkerWidth}),Fe&&(Oe.markerWidth=Fe),Oe},re.prototype.trackBarcodeMarkerId=function(xe,Fe){var Oe=this.barcodeMarkers[xe];return Oe||(this.barcodeMarkers[xe]=Oe={inPrevious:!1,inCurrent:!1,matrix:new Float32Array(12),markerWidth:Fe||this.defaultMarkerWidth}),Fe&&(Oe.markerWidth=Fe),Oe},re.prototype.getMultiMarkerCount=function(){return Y.getMultiMarkerCount(this.id)},re.prototype.getMultiMarkerPatternCount=function(xe){return Y.getMultiMarkerNum(this.id,xe)},re.prototype.addEventListener=function(xe,Fe){this.listeners[xe]||(this.listeners[xe]=[]),this.listeners[xe].push(Fe)},re.prototype.removeEventListener=function(xe,Fe){if(this.listeners[xe]){var Oe=this.listeners[xe].indexOf(Fe);Oe>-1&&this.listeners[xe].splice(Oe,1)}},re.prototype.dispatchEvent=function(xe){var Fe=this.listeners[xe.name];if(Fe)for(var Oe=0;Oe<Fe.length;Oe++)Fe[Oe].call(this,xe)},re.prototype.debugSetup=function(){document.body.appendChild(this.canvas),this.setDebugMode(1),this._bwpointer=this.getProcessingImage()},re.prototype.loadMarker=function(xe,Fe,Oe){return Y.addMarker(this.id,xe,Fe,Oe)},re.prototype.loadMultiMarker=function(xe,Fe,Oe){return Y.addMultiMarker(this.id,xe,Fe,Oe)},re.prototype.getTransMatSquare=function(xe,Fe,Oe){return Y.getTransMatSquare(this.id,xe,Fe),Oe.set(this.marker_transform_mat),Oe},re.prototype.getTransMatSquareCont=function(xe,Fe,Oe,Ne){return this.marker_transform_mat.set(Oe),Y.getTransMatSquareCont(this.id,xe,Fe),Ne.set(this.marker_transform_mat),Ne},re.prototype.getTransMatMultiSquare=function(xe,Fe){return Y.getTransMatMultiSquare(this.id,xe),Fe.set(this.marker_transform_mat),Fe},re.prototype.getTransMatMultiSquareRobust=function(xe,Fe){return Y.getTransMatMultiSquare(this.id,xe),Fe.set(this.marker_transform_mat),Fe},re.prototype.transMatToGLMat=function(xe,Fe,Oe){return Fe[0+0*4]=xe[0],Fe[0+1*4]=xe[1],Fe[0+2*4]=xe[2],Fe[0+3*4]=xe[3],Fe[1+0*4]=xe[4],Fe[1+1*4]=xe[5],Fe[1+2*4]=xe[6],Fe[1+3*4]=xe[7],Fe[2+0*4]=xe[8],Fe[2+1*4]=xe[9],Fe[2+2*4]=xe[10],Fe[2+3*4]=xe[11],Fe[3+0*4]=0,Fe[3+1*4]=0,Fe[3+2*4]=0,Fe[3+3*4]=1,Oe!=null&&Oe!==0&&(Fe[12]*=Oe,Fe[13]*=Oe,Fe[14]*=Oe),Fe},re.prototype.detectMarker=function(xe){return this._copyImageToHeap(xe)?Y.detectMarker(this.id):-99},re.prototype.getMarkerNum=function(){return Y.getMarkerNum(this.id)},re.prototype.getMarker=function(xe){if(Y.getMarker(this.id,xe)===0)return Y.markerInfo},re.prototype.setMarkerInfoVertex=function(xe,Fe){for(var Oe=0;Oe<Fe.length;Oe++)this.marker_transform_mat[Oe*2+0]=Fe[Oe][0],this.marker_transform_mat[Oe*2+1]=Fe[Oe][1];return Y.setMarkerInfoVertex(this.id,xe)},re.prototype.cloneMarkerInfo=function(xe){return JSON.parse(JSON.stringify(xe))},re.prototype.getMultiEachMarker=function(xe,Fe){if(Y.getMultiEachMarker(this.id,xe,Fe)===0)return Y.multiEachMarkerInfo},re.prototype.getTransformationMatrix=function(){return this.transform_mat},re.prototype.getCameraMatrix=function(){return this.camera_mat},re.prototype.getMarkerTransformationMatrix=function(){return this.marker_transform_mat},re.prototype.setDebugMode=function(xe){return Y.setDebugMode(this.id,xe)},re.prototype.getDebugMode=function(){return Y.getDebugMode(this.id)},re.prototype.getProcessingImage=function(){return Y.getProcessingImage(this.id)},re.prototype.setLogLevel=function(xe){return Y.setLogLevel(xe)},re.prototype.getLogLevel=function(){return Y.getLogLevel()},re.prototype.setMarkerInfoDir=function(xe,Fe){return Y.setMarkerInfoDir(this.id,xe,Fe)},re.prototype.setProjectionNearPlane=function(xe){return Y.setProjectionNearPlane(this.id,xe)},re.prototype.getProjectionNearPlane=function(){return Y.getProjectionNearPlane(this.id)},re.prototype.setProjectionFarPlane=function(xe){return Y.setProjectionFarPlane(this.id,xe)},re.prototype.getProjectionFarPlane=function(){return Y.getProjectionFarPlane(this.id)},re.prototype.setThresholdMode=function(xe){return Y.setThresholdMode(this.id,xe)},re.prototype.getThresholdMode=function(){return Y.getThresholdMode(this.id)},re.prototype.setThreshold=function(xe){return Y.setThreshold(this.id,xe)},re.prototype.getThreshold=function(){return Y.getThreshold(this.id)},re.prototype.setPatternDetectionMode=function(xe){return Y.setPatternDetectionMode(this.id,xe)},re.prototype.getPatternDetectionMode=function(){return Y.getPatternDetectionMode(this.id)},re.prototype.setMatrixCodeType=function(xe){return Y.setMatrixCodeType(this.id,xe)},re.prototype.getMatrixCodeType=function(){return Y.getMatrixCodeType(this.id)},re.prototype.setLabelingMode=function(xe){return Y.setLabelingMode(this.id,xe)},re.prototype.getLabelingMode=function(){return Y.getLabelingMode(this.id)},re.prototype.setPattRatio=function(xe){return Y.setPattRatio(this.id,xe)},re.prototype.getPattRatio=function(){return Y.getPattRatio(this.id)},re.prototype.setImageProcMode=function(xe){return Y.setImageProcMode(this.id,xe)},re.prototype.getImageProcMode=function(){return Y.getImageProcMode(this.id)},re.prototype.debugDraw=function(){var xe=new Uint8ClampedArray(Module.HEAPU8.buffer,this._bwpointer,this.framesize),Fe=new ImageData(xe,this.canvas.width,this.canvas.height);this.ctx.putImageData(Fe,0,0);for(var Oe=this.getMarkerNum(),Ne=0;Ne<Oe;Ne++)this._debugMarker(this.getMarker(Ne))},re.prototype._initialize=function(){this.id=Y.setup(this.canvas.width,this.canvas.height,this.cameraParam.id);var xe=Y.frameMalloc;this.framepointer=xe.framepointer,this.framesize=xe.framesize,this.dataHeap=new Uint8Array(Module.HEAPU8.buffer,this.framepointer,this.framesize),this.camera_mat=new Float64Array(Module.HEAPU8.buffer,xe.camera,16),this.marker_transform_mat=new Float64Array(Module.HEAPU8.buffer,xe.transform,12),this.setProjectionNearPlane(.1),this.setProjectionFarPlane(1e3);var Fe=this;setTimeout(function(){Fe.onload&&Fe.onload(),Fe.dispatchEvent({name:"load",target:Fe})},1)},re.prototype._copyImageToHeap=function(xe){xe||(xe=this.image),this.ctx.save(),this.orientation==="portrait"?(this.ctx.translate(this.canvas.width,0),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(xe,0,0,this.canvas.height,this.canvas.width)):this.ctx.drawImage(xe,0,0,this.canvas.width,this.canvas.height),this.ctx.restore();var Fe=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),Oe=Fe.data;return this.dataHeap?(this.dataHeap.set(Oe),!0):!1},re.prototype._debugMarker=function(xe){var Fe,Oe;Fe=xe.vertex;var Ne=this.ctx;Ne.strokeStyle="red",Ne.beginPath(),Ne.moveTo(Fe[0][0],Fe[0][1]),Ne.lineTo(Fe[1][0],Fe[1][1]),Ne.stroke(),Ne.beginPath(),Ne.moveTo(Fe[2][0],Fe[2][1]),Ne.lineTo(Fe[3][0],Fe[3][1]),Ne.stroke(),Ne.strokeStyle="green",Ne.beginPath(),Ne.lineTo(Fe[1][0],Fe[1][1]),Ne.lineTo(Fe[2][0],Fe[2][1]),Ne.stroke(),Ne.beginPath(),Ne.moveTo(Fe[3][0],Fe[3][1]),Ne.lineTo(Fe[0][0],Fe[0][1]),Ne.stroke(),Oe=xe.pos,Ne.beginPath(),Ne.arc(Oe[0],Oe[1],8,0,Math.PI*2),Ne.fillStyle="red",Ne.fill()},re.getUserMedia=function(xe){xe.facingMode;var Fe=xe.onSuccess,Oe=xe.onError||function(ft){console.error("ARController.getUserMedia",ft)},Ne=document.createElement("video"),ke=function(){this.videoWidth!==0&&Fe(Ne)},Ve=!1,Xe=["touchstart","touchend","touchmove","touchcancel","click","mousedown","mouseup","mousemove","keydown","keyup","keypress","scroll"],$e=function(ft){Ve&&(Ne.play(),Ne.paused||Xe.forEach(function(Rt){window.removeEventListener(Rt,$e,!0)}))};Xe.forEach(function(ft){window.addEventListener(ft,$e,!0)});var st=function(ft){Ne.addEventListener("loadedmetadata",ke,!1),Ne.src=window.URL.createObjectURL(ft),Ve=!0,$e()},ze={};xe.width&&(xe.width,typeof xe.width=="object"?(xe.width.max&&(ze.maxWidth=xe.width.max),xe.width.min&&(ze.minWidth=xe.width.max)):ze.maxWidth=xe.width),xe.height&&(xe.height,typeof xe.height=="object"?(xe.height.max&&(ze.maxHeight=xe.height.max),xe.height.min&&(ze.minHeight=xe.height.max)):ze.maxHeight=xe.height),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var tt={audio:!1,video:{mandatory:ze}};return navigator.getUserMedia?navigator.getUserMedia(tt,st,Oe):Oe("navigator.getUserMedia is not supported on your browser"),Ne},re.getUserMediaARController=function(xe){var Fe={};for(var Oe in xe)Fe[Oe]=xe[Oe];var Ne=xe.onSuccess,ke=xe.cameraParam;Fe.onSuccess=function(){new U(ke,function(){var Xe=this,$e=xe.maxARVideoSize||Math.max(Ve.videoWidth,Ve.videoHeight),st=$e/Math.max(Ve.videoWidth,Ve.videoHeight),ze=st*Ve.videoWidth,tt=st*Ve.videoHeight;if(Ve.videoWidth<Ve.videoHeight){var ft=ze;ze=tt,tt=ft}var Rt=new re(ze,tt,Xe);Rt.image=Ve,Ve.videoWidth<Ve.videoHeight?(Rt.orientation="portrait",Rt.videoWidth=Ve.videoHeight,Rt.videoHeight=Ve.videoWidth):(Rt.orientation="landscape",Rt.videoWidth=Ve.videoWidth,Rt.videoHeight=Ve.videoHeight),Ne(Rt,Xe)},function(Xe){console.error("ARController: Failed to load ARCameraParam",Xe)})};var Ve=this.getUserMedia(Fe);return Ve};var U=function(xe,Fe,Oe){this.id=-1,this._src="",this.complete=!1,this.onload=Fe,this.onerror=Oe,xe&&this.load(xe)};U.prototype.load=function(xe){if(this._src!=="")throw"ARCameraParam: Trying to load camera parameters twice.";if(this._src=xe,xe){var Fe=this;Y.loadCamera(xe,function(Oe){Fe.id=Oe,Fe.complete=!0,Fe.onload()},function(Oe){Fe.onerror(Oe)})}},Object.defineProperty(U.prototype,"src",{set:function(xe){this.load(xe)},get:function(){return this._src}}),U.prototype.dispose=function(){this.id!==-1&&Y.deleteCamera(this.id),this.id=-1,this._src="",this.complete=!1};var Y={UNKNOWN_MARKER:-1,PATTERN_MARKER:0,BARCODE_MARKER:1,loadCamera:Te,addMarker:fe,addMultiMarker:se},ie=["setup","teardown","setLogLevel","getLogLevel","setDebugMode","getDebugMode","getProcessingImage","setMarkerInfoDir","setMarkerInfoVertex","getTransMatSquare","getTransMatSquareCont","getTransMatMultiSquare","getTransMatMultiSquareRobust","getMultiMarkerNum","getMultiMarkerCount","detectMarker","getMarkerNum","getMarker","getMultiEachMarker","setProjectionNearPlane","getProjectionNearPlane","setProjectionFarPlane","getProjectionFarPlane","setThresholdMode","getThresholdMode","setThreshold","getThreshold","setPatternDetectionMode","getPatternDetectionMode","setMatrixCodeType","getMatrixCodeType","setLabelingMode","getLabelingMode","setPattRatio","getPattRatio","setImageProcMode","getImageProcMode"];function ne(){ie.forEach(function(Fe){Y[Fe]=Module[Fe]});for(var xe in Module)xe.match(/^AR/)&&(Y[xe]=Module[xe])}var F=0;function fe(xe,Fe,Oe){var Ne="/marker_"+F++;Pe(Fe,Ne,function(){var ke=Module._addMarker(xe,Ne);Oe&&Oe(ke)})}function pe(xe){return String.fromCharCode.apply(String,xe)}function Me(xe){var Fe=pe(xe),Oe=Fe.split(`
`),Ne=[],ke=0;return Oe.forEach(function(Ve){if(Ve=Ve.trim(),!(!Ve||Ve.startsWith("#")))switch(ke){case 0:ke=1;return;case 1:Ve.match(/^\d+$/)||Ne.push(Ve);case 2:case 3:case 4:ke++;return;case 5:ke=1;return}}),Ne}var ve=0;function se(xe,Fe,Oe){var Ne="/multi_marker_"+ve++;Pe(Fe,Ne,function(ke){var Ve=Me(ke);function Xe(){var st=Module._addMultiMarker(xe,Ne),ze=Module.getMultiMarkerNum(xe,st);Oe&&Oe(st,ze)}if(!Ve.length)return Xe();var $e=Fe.split("/").slice(0,-1).join("/");Ve=Ve.map(function(st){return[$e+"/"+st,st]}),Le(Ve,Xe)})}var me=0;function Te(xe,Fe){var Oe="/camera_param_"+me++,Ne=function(){var ke=Module._loadCamera(Oe);Fe&&Fe(ke)};typeof xe=="object"?be(Oe,xe,Ne):xe.indexOf(`
`)>-1?Re(Oe,xe,Ne):Pe(xe,Oe,Ne)}function Re(xe,Fe,Oe){for(var Ne=new Uint8Array(Fe.length),ke=0;ke<Ne.length;ke++)Ne[ke]=Fe.charCodeAt(ke)&255;be(xe,Ne,Oe)}function be(xe,Fe,Oe){FS.writeFile(xe,Fe,{encoding:"binary"}),Oe(Fe)}function Pe(xe,Fe,Oe){var Ne=new XMLHttpRequest;Ne.open("GET",xe,!0),Ne.responseType="arraybuffer",Ne.onload=function(ke){var Ve=Ne.response,Xe=new Uint8Array(Ve);be(Fe,Xe,Oe)},Ne.send()}function Le(xe,Fe){var Oe=xe.pop();Oe?Pe(Oe[0],Oe[1],function(){Le(xe,Fe)}):Fe()}window.artoolkit=Y,window.ARController=re,window.ARCameraParam=U,window.Module?ne():window.Module={onRuntimeInitialized:function(){ne()}}})();var Module;Module||(Module=(typeof Module<"u"?Module:null)||{});var moduleOverrides={};for(var key in Module)Module.hasOwnProperty(key)&&(moduleOverrides[key]=Module[key]);var ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof commonjsRequire=="function"&&!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_WORKER,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){Module.print||(Module.print=function(U){process.stdout.write(U+`
`)}),Module.printErr||(Module.printErr=function(U){process.stderr.write(U+`
`)});var nodeFS=require$$1,nodePath=require$$1;Module.read=function(U,Y){U=nodePath.normalize(U);var ie=nodeFS.readFileSync(U);return!ie&&U!=nodePath.resolve(U)&&(U=path.join(__dirname,"..","src",U),ie=nodeFS.readFileSync(U)),ie&&!Y&&(ie=ie.toString()),ie},Module.readBinary=function(U){var Y=Module.read(U,!0);return Y.buffer||(Y=new Uint8Array(Y)),assert(Y.buffer),Y},Module.load=function(U){globalEval(read(U))},Module.thisProgram||(process.argv.length>1?Module.thisProgram=process.argv[1].replace(/\\/g,"/"):Module.thisProgram="unknown-program"),Module.arguments=process.argv.slice(2),module.exports=Module,process.on("uncaughtException",function(re){if(!(re instanceof ExitStatus))throw re}),Module.inspect=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL)Module.print||(Module.print=print),typeof printErr<"u"&&(Module.printErr=printErr),typeof read<"u"?Module.read=read:Module.read=function(){throw"no read() available (jsc?)"},Module.readBinary=function(U){if(typeof readbuffer=="function")return new Uint8Array(readbuffer(U));var Y=read(U,"binary");return assert(typeof Y=="object"),Y},typeof scriptArgs<"u"?Module.arguments=scriptArgs:typeof arguments<"u"&&(Module.arguments=arguments);else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){if(Module.read=function(U){var Y=new XMLHttpRequest;return Y.open("GET",U,!1),Y.send(null),Y.responseText},typeof arguments<"u"&&(Module.arguments=arguments),typeof console<"u")Module.print||(Module.print=function(U){console.log(U)}),Module.printErr||(Module.printErr=function(U){console.log(U)});else{var TRY_USE_DUMP=!1;Module.print||(Module.print=TRY_USE_DUMP&&typeof dump<"u"?function(re){dump(re)}:function(re){})}ENVIRONMENT_IS_WORKER&&(Module.load=importScripts),typeof Module.setWindowTitle>"u"&&(Module.setWindowTitle=function(re){document.title=re})}else throw"Unknown runtime environment. Where are we?";function globalEval(re){eval.call(null,re)}!Module.load&&Module.read&&(Module.load=function(U){globalEval(Module.read(U))}),Module.print||(Module.print=function(){}),Module.printErr||(Module.printErr=Module.print),Module.arguments||(Module.arguments=[]),Module.thisProgram||(Module.thisProgram="./this.program"),Module.print=Module.print,Module.printErr=Module.printErr,Module.preRun=[],Module.postRun=[];for(var key in moduleOverrides)moduleOverrides.hasOwnProperty(key)&&(Module[key]=moduleOverrides[key]);var Runtime={setTempRet0:function(re){tempRet0=re},getTempRet0:function(){return tempRet0},stackSave:function(){return STACKTOP},stackRestore:function(re){STACKTOP=re},getNativeTypeSize:function(re){switch(re){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:{if(re[re.length-1]==="*")return Runtime.QUANTUM_SIZE;if(re[0]==="i"){var U=parseInt(re.substr(1));return assert(U%8===0),U/8}else return 0}}},getNativeFieldSize:function(re){return Math.max(Runtime.getNativeTypeSize(re),Runtime.QUANTUM_SIZE)},STACK_ALIGN:16,prepVararg:function(re,U){return U==="double"||U==="i64"?re&7&&(assert((re&7)===4),re+=4):assert((re&3)===0),re},getAlignSize:function(re,U,Y){return!Y&&(re=="i64"||re=="double")?8:re?Math.min(U||(re?Runtime.getNativeFieldSize(re):0),Runtime.QUANTUM_SIZE):Math.min(U,8)},dynCall:function(re,U,Y){return Y&&Y.length?(Y.splice||(Y=Array.prototype.slice.call(Y)),Y.splice(0,0,U),Module["dynCall_"+re].apply(null,Y)):Module["dynCall_"+re].call(null,U)},functionPointers:[],addFunction:function(re){for(var U=0;U<Runtime.functionPointers.length;U++)if(!Runtime.functionPointers[U])return Runtime.functionPointers[U]=re,2*(1+U);throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."},removeFunction:function(re){Runtime.functionPointers[(re-2)/2]=null},warnOnce:function(re){Runtime.warnOnce.shown||(Runtime.warnOnce.shown={}),Runtime.warnOnce.shown[re]||(Runtime.warnOnce.shown[re]=1,Module.printErr(re))},funcWrappers:{},getFuncWrapper:function(re,U){assert(U),Runtime.funcWrappers[U]||(Runtime.funcWrappers[U]={});var Y=Runtime.funcWrappers[U];return Y[re]||(Y[re]=function(){return Runtime.dynCall(U,re,arguments)}),Y[re]},getCompilerSetting:function(re){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"},stackAlloc:function(re){var U=STACKTOP;return STACKTOP=STACKTOP+re|0,STACKTOP=STACKTOP+15&-16,U},staticAlloc:function(re){var U=STATICTOP;return STATICTOP=STATICTOP+re|0,STATICTOP=STATICTOP+15&-16,U},dynamicAlloc:function(re){var U=DYNAMICTOP;if(DYNAMICTOP=DYNAMICTOP+re|0,DYNAMICTOP=DYNAMICTOP+15&-16,DYNAMICTOP>=TOTAL_MEMORY){var Y=enlargeMemory();if(!Y)return DYNAMICTOP=U,0}return U},alignMemory:function(re,U){var Y=re=Math.ceil(re/(U||16))*(U||16);return Y},makeBigInt:function(re,U,Y){var ie=Y?+(re>>>0)+ +(U>>>0)*4294967296:+(re>>>0)+ +(U|0)*4294967296;return ie},GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module.Runtime=Runtime;var ABORT=!1,tempDouble,tempI64,tempRet0;function assert(re,U){re||abort("Assertion failed: "+U)}function getCFunc(ident){var func=Module["_"+ident];if(!func)try{func=eval("_"+ident)}catch(re){}return assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)"),func}var cwrap,ccall;(function(){var JSfuncs={stackSave:function(){Runtime.stackSave()},stackRestore:function(){Runtime.stackRestore()},arrayToC:function(re){var U=Runtime.stackAlloc(re.length);return writeArrayToMemory(re,U),U},stringToC:function(re){var U=0;return re!=null&&re!==0&&(U=Runtime.stackAlloc((re.length<<2)+1),writeStringToMemory(re,U)),U}},toC={string:JSfuncs.stringToC,array:JSfuncs.arrayToC};ccall=function(U,Y,ie,ne,F){var fe=getCFunc(U),pe=[],Me=0;if(ne)for(var ve=0;ve<ne.length;ve++){var se=toC[ie[ve]];se?(Me===0&&(Me=Runtime.stackSave()),pe[ve]=se(ne[ve])):pe[ve]=ne[ve]}var me=fe.apply(null,pe);if(Y==="string"&&(me=Pointer_stringify(me)),Me!==0){if(F&&F.async){EmterpreterAsync.asyncFinalizers.push(function(){Runtime.stackRestore(Me)});return}Runtime.stackRestore(Me)}return me};var sourceRegex=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(re){var U=re.toString().match(sourceRegex).slice(1);return{arguments:U[0],body:U[1],returnValue:U[2]}}var JSsource={};for(var fun in JSfuncs)JSfuncs.hasOwnProperty(fun)&&(JSsource[fun]=parseJSFunc(JSfuncs[fun]));cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident),numericArgs=argTypes.every(function(re){return re==="number"}),numericRet=returnType!=="string";if(numericRet&&numericArgs)return cfunc;var argNames=argTypes.map(function(re,U){return"$"+U}),funcstr="(function("+argNames.join(",")+") {",nargs=argTypes.length;if(!numericArgs){funcstr+="var stack = "+JSsource.stackSave.body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if(type!=="number"){var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";",funcstr+=convertCode.body+";",funcstr+=arg+"="+convertCode.returnValue+";"}}}var cfuncname=parseJSFunc(function(){return cfunc}).returnValue;if(funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");",!numericRet){var strgfy=parseJSFunc(function(){return Pointer_stringify}).returnValue;funcstr+="ret = "+strgfy+"(ret);"}return numericArgs||(funcstr+=JSsource.stackRestore.body.replace("()","(stack)")+";"),funcstr+="return ret})",eval(funcstr)}})(),Module.ccall=ccall,Module.cwrap=cwrap;function setValue(re,U,Y,ie){switch(Y=Y||"i8",Y.charAt(Y.length-1)==="*"&&(Y="i32"),Y){case"i1":HEAP8[re>>0]=U;break;case"i8":HEAP8[re>>0]=U;break;case"i16":HEAP16[re>>1]=U;break;case"i32":HEAP32[re>>2]=U;break;case"i64":tempI64=[U>>>0,(tempDouble=U,+Math_abs(tempDouble)>=1?tempDouble>0?(Math_min(+Math_floor(tempDouble/4294967296),4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[re>>2]=tempI64[0],HEAP32[re+4>>2]=tempI64[1];break;case"float":HEAPF32[re>>2]=U;break;case"double":HEAPF64[re>>3]=U;break;default:abort("invalid type for setValue: "+Y)}}Module.setValue=setValue;function getValue(re,U,Y){switch(U=U||"i8",U.charAt(U.length-1)==="*"&&(U="i32"),U){case"i1":return HEAP8[re>>0];case"i8":return HEAP8[re>>0];case"i16":return HEAP16[re>>1];case"i32":return HEAP32[re>>2];case"i64":return HEAP32[re>>2];case"float":return HEAPF32[re>>2];case"double":return HEAPF64[re>>3];default:abort("invalid type for setValue: "+U)}return null}Module.getValue=getValue;var ALLOC_NORMAL=0,ALLOC_STACK=1,ALLOC_STATIC=2,ALLOC_DYNAMIC=3,ALLOC_NONE=4;Module.ALLOC_NORMAL=ALLOC_NORMAL,Module.ALLOC_STACK=ALLOC_STACK,Module.ALLOC_STATIC=ALLOC_STATIC,Module.ALLOC_DYNAMIC=ALLOC_DYNAMIC,Module.ALLOC_NONE=ALLOC_NONE;function allocate(re,U,Y,ie){var ne,F;typeof re=="number"?(ne=!0,F=re):(ne=!1,F=re.length);var fe=typeof U=="string"?U:null,pe;if(Y==ALLOC_NONE?pe=ie:pe=[_malloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][Y===void 0?ALLOC_STATIC:Y](Math.max(F,fe?1:U.length)),ne){var ie=pe,Me;for(assert((pe&3)==0),Me=pe+(F&-4);ie<Me;ie+=4)HEAP32[ie>>2]=0;for(Me=pe+F;ie<Me;)HEAP8[ie++>>0]=0;return pe}if(fe==="i8")return re.subarray||re.slice?HEAPU8.set(re,pe):HEAPU8.set(new Uint8Array(re),pe),pe;for(var ve=0,se,me,Te;ve<F;){var Re=re[ve];if(typeof Re=="function"&&(Re=Runtime.getFunctionIndex(Re)),se=fe||U[ve],se===0){ve++;continue}se=="i64"&&(se="i32"),setValue(pe+ve,Re,se),Te!==se&&(me=Runtime.getNativeTypeSize(se),Te=se),ve+=me}return pe}Module.allocate=allocate;function getMemory(re){return staticSealed?typeof _sbrk<"u"&&!_sbrk.called||!runtimeInitialized?Runtime.dynamicAlloc(re):_malloc(re):Runtime.staticAlloc(re)}Module.getMemory=getMemory;function Pointer_stringify(re,U){if(U===0||!re)return"";for(var Y=0,ie,ne=0;ie=HEAPU8[re+ne>>0],Y|=ie,!(ie==0&&!U||(ne++,U&&ne==U)););U||(U=ne);var F="";if(Y<128){for(var fe=1024,pe;U>0;)pe=String.fromCharCode.apply(String,HEAPU8.subarray(re,re+Math.min(U,fe))),F=F?F+pe:pe,re+=fe,U-=fe;return F}return Module.UTF8ToString(re)}Module.Pointer_stringify=Pointer_stringify;function AsciiToString(re){for(var U="";;){var Y=HEAP8[re++>>0];if(!Y)return U;U+=String.fromCharCode(Y)}}Module.AsciiToString=AsciiToString;function stringToAscii(re,U){return writeAsciiToMemory(re,U,!1)}Module.stringToAscii=stringToAscii;function UTF8ArrayToString(re,U){for(var Y,ie,ne,F,fe,pe,Me="";;){if(Y=re[U++],!Y)return Me;if(!(Y&128)){Me+=String.fromCharCode(Y);continue}if(ie=re[U++]&63,(Y&224)==192){Me+=String.fromCharCode((Y&31)<<6|ie);continue}if(ne=re[U++]&63,(Y&240)==224?Y=(Y&15)<<12|ie<<6|ne:(F=re[U++]&63,(Y&248)==240?Y=(Y&7)<<18|ie<<12|ne<<6|F:(fe=re[U++]&63,(Y&252)==248?Y=(Y&3)<<24|ie<<18|ne<<12|F<<6|fe:(pe=re[U++]&63,Y=(Y&1)<<30|ie<<24|ne<<18|F<<12|fe<<6|pe))),Y<65536)Me+=String.fromCharCode(Y);else{var ve=Y-65536;Me+=String.fromCharCode(55296|ve>>10,56320|ve&1023)}}}Module.UTF8ArrayToString=UTF8ArrayToString;function UTF8ToString(re){return UTF8ArrayToString(HEAPU8,re)}Module.UTF8ToString=UTF8ToString;function stringToUTF8Array(re,U,Y,ie){if(!(ie>0))return 0;for(var ne=Y,F=Y+ie-1,fe=0;fe<re.length;++fe){var pe=re.charCodeAt(fe);if(pe>=55296&&pe<=57343&&(pe=65536+((pe&1023)<<10)|re.charCodeAt(++fe)&1023),pe<=127){if(Y>=F)break;U[Y++]=pe}else if(pe<=2047){if(Y+1>=F)break;U[Y++]=192|pe>>6,U[Y++]=128|pe&63}else if(pe<=65535){if(Y+2>=F)break;U[Y++]=224|pe>>12,U[Y++]=128|pe>>6&63,U[Y++]=128|pe&63}else if(pe<=2097151){if(Y+3>=F)break;U[Y++]=240|pe>>18,U[Y++]=128|pe>>12&63,U[Y++]=128|pe>>6&63,U[Y++]=128|pe&63}else if(pe<=67108863){if(Y+4>=F)break;U[Y++]=248|pe>>24,U[Y++]=128|pe>>18&63,U[Y++]=128|pe>>12&63,U[Y++]=128|pe>>6&63,U[Y++]=128|pe&63}else{if(Y+5>=F)break;U[Y++]=252|pe>>30,U[Y++]=128|pe>>24&63,U[Y++]=128|pe>>18&63,U[Y++]=128|pe>>12&63,U[Y++]=128|pe>>6&63,U[Y++]=128|pe&63}}return U[Y]=0,Y-ne}Module.stringToUTF8Array=stringToUTF8Array;function stringToUTF8(re,U,Y){return stringToUTF8Array(re,HEAPU8,U,Y)}Module.stringToUTF8=stringToUTF8;function lengthBytesUTF8(re){for(var U=0,Y=0;Y<re.length;++Y){var ie=re.charCodeAt(Y);ie>=55296&&ie<=57343&&(ie=65536+((ie&1023)<<10)|re.charCodeAt(++Y)&1023),ie<=127?++U:ie<=2047?U+=2:ie<=65535?U+=3:ie<=2097151?U+=4:ie<=67108863?U+=5:U+=6}return U}Module.lengthBytesUTF8=lengthBytesUTF8;function UTF16ToString(re){for(var U=0,Y="";;){var ie=HEAP16[re+U*2>>1];if(ie==0)return Y;++U,Y+=String.fromCharCode(ie)}}Module.UTF16ToString=UTF16ToString;function stringToUTF16(re,U,Y){if(Y===void 0&&(Y=2147483647),Y<2)return 0;Y-=2;for(var ie=U,ne=Y<re.length*2?Y/2:re.length,F=0;F<ne;++F){var fe=re.charCodeAt(F);HEAP16[U>>1]=fe,U+=2}return HEAP16[U>>1]=0,U-ie}Module.stringToUTF16=stringToUTF16;function lengthBytesUTF16(re){return re.length*2}Module.lengthBytesUTF16=lengthBytesUTF16;function UTF32ToString(re){for(var U=0,Y="";;){var ie=HEAP32[re+U*4>>2];if(ie==0)return Y;if(++U,ie>=65536){var ne=ie-65536;Y+=String.fromCharCode(55296|ne>>10,56320|ne&1023)}else Y+=String.fromCharCode(ie)}}Module.UTF32ToString=UTF32ToString;function stringToUTF32(re,U,Y){if(Y===void 0&&(Y=2147483647),Y<4)return 0;for(var ie=U,ne=ie+Y-4,F=0;F<re.length;++F){var fe=re.charCodeAt(F);if(fe>=55296&&fe<=57343){var pe=re.charCodeAt(++F);fe=65536+((fe&1023)<<10)|pe&1023}if(HEAP32[U>>2]=fe,U+=4,U+4>ne)break}return HEAP32[U>>2]=0,U-ie}Module.stringToUTF32=stringToUTF32;function lengthBytesUTF32(re){for(var U=0,Y=0;Y<re.length;++Y){var ie=re.charCodeAt(Y);ie>=55296&&ie<=57343&&++Y,U+=4}return U}Module.lengthBytesUTF32=lengthBytesUTF32;function demangle(re){var U=!!Module.___cxa_demangle;if(U)try{var Y=_malloc(re.length);writeStringToMemory(re.substr(1),Y);var ie=_malloc(4),ne=Module.___cxa_demangle(Y,0,0,ie);if(getValue(ie,"i32")===0&&ne)return Pointer_stringify(ne)}catch{}finally{Y&&_free(Y),ie&&_free(ie),ne&&_free(ne)}var F=3,fe={v:"void",b:"bool",c:"char",s:"short",i:"int",l:"long",f:"float",d:"double",w:"wchar_t",a:"signed char",h:"unsigned char",t:"unsigned short",j:"unsigned int",m:"unsigned long",x:"long long",y:"unsigned long long",z:"..."},pe=[],Me=!0;function ve(){F++,re[F]==="K"&&F++;for(var Te=[];re[F]!=="E";){if(re[F]==="S"){F++;var Re=re.indexOf("_",F),be=re.substring(F,Re)||0;Te.push(pe[be]||"?"),F=Re+1;continue}if(re[F]==="C"){Te.push(Te[Te.length-1]),F+=2;continue}var Pe=parseInt(re.substr(F)),Le=Pe.toString().length;if(!Pe||!Le){F--;break}var xe=re.substr(F+Le,Pe);Te.push(xe),pe.push(xe),F+=Le+Pe}return F++,Te}function se(Te,Re,be){Re=Re||1/0;var Pe="",Le=[];function xe(){return"("+Le.join(", ")+")"}var Fe;if(re[F]==="N"){if(Fe=ve().join("::"),Re--,Re===0)return Te?[Fe]:Fe}else{(re[F]==="K"||Me&&re[F]==="L")&&F++;var Oe=parseInt(re.substr(F));if(Oe){var Ne=Oe.toString().length;Fe=re.substr(F+Ne,Oe),F+=Ne+Oe}}if(Me=!1,re[F]==="I"){F++;var ke=se(!0),Ve=se(!0,1,!0);Pe+=Ve[0]+" "+Fe+"<"+ke.join(", ")+">"}else Pe=Fe;e:for(;F<re.length&&Re-- >0;){var Xe=re[F++];if(Xe in fe)Le.push(fe[Xe]);else switch(Xe){case"P":Le.push(se(!0,1,!0)[0]+"*");break;case"R":Le.push(se(!0,1,!0)[0]+"&");break;case"L":{F++;var $e=re.indexOf("E",F),Oe=$e-F;Le.push(re.substr(F,Oe)),F+=Oe+2;break}case"A":{var Oe=parseInt(re.substr(F));if(F+=Oe.toString().length,re[F]!=="_")throw"?";F++,Le.push(se(!0,1,!0)[0]+" ["+Oe+"]");break}case"E":break e;default:Pe+="?"+Xe;break e}}return!be&&Le.length===1&&Le[0]==="void"&&(Le=[]),Te?(Pe&&Le.push(Pe+"?"),Le):Pe+xe()}var me=re;try{if(re=="Object._main"||re=="_main")return"main()";if(typeof re=="number"&&(re=Pointer_stringify(re)),re[0]!=="_"||re[1]!=="_"||re[2]!=="Z")return re;switch(re[3]){case"n":return"operator new()";case"d":return"operator delete()"}me=se()}catch{me+="?"}return me.indexOf("?")>=0&&!U&&Runtime.warnOnce("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),me}function demangleAll(re){return re.replace(/__Z[\w\d_]+/g,function(U){var Y=demangle(U);return U===Y?U:U+" ["+Y+"]"})}function jsStackTrace(){var re=new Error;if(!re.stack){try{throw new Error(0)}catch(U){re=U}if(!re.stack)return"(no stack trace available)"}return re.stack.toString()}function stackTrace(){return demangleAll(jsStackTrace())}Module.stackTrace=stackTrace;var PAGE_SIZE=4096;function alignMemoryPage(re){return re%4096>0&&(re+=4096-re%4096),re}var HEAP,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64,STATIC_BASE=0,STATICTOP=0,staticSealed=!1,STACK_BASE=0,STACKTOP=0,STACK_MAX=0,DYNAMIC_BASE=0,DYNAMICTOP=0;function abortOnCannotGrowMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+TOTAL_MEMORY+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which adjusts the size at runtime but prevents some optimizations, (3) set Module.TOTAL_MEMORY to a higher value before the program runs, or if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function enlargeMemory(){abortOnCannotGrowMemory()}for(var TOTAL_STACK=Module.TOTAL_STACK||5242880,TOTAL_MEMORY=Module.TOTAL_MEMORY||268435456,totalMemory=64*1024;totalMemory<TOTAL_MEMORY||totalMemory<2*TOTAL_STACK;)totalMemory<16*1024*1024?totalMemory*=2:totalMemory+=16*1024*1024;totalMemory!==TOTAL_MEMORY&&(TOTAL_MEMORY=totalMemory),assert(typeof Int32Array<"u"&&typeof Float64Array<"u"&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set,"JS engine does not provide full typed array support");var buffer;buffer=new ArrayBuffer(TOTAL_MEMORY),HEAP8=new Int8Array(buffer),HEAP16=new Int16Array(buffer),HEAP32=new Int32Array(buffer),HEAPU8=new Uint8Array(buffer),HEAPU16=new Uint16Array(buffer),HEAPU32=new Uint32Array(buffer),HEAPF32=new Float32Array(buffer),HEAPF64=new Float64Array(buffer),HEAP32[0]=255,assert(HEAPU8[0]===255&&HEAPU8[3]===0,"Typed arrays 2 must be run on a little-endian system"),Module.HEAP=HEAP,Module.buffer=buffer,Module.HEAP8=HEAP8,Module.HEAP16=HEAP16,Module.HEAP32=HEAP32,Module.HEAPU8=HEAPU8,Module.HEAPU16=HEAPU16,Module.HEAPU32=HEAPU32,Module.HEAPF32=HEAPF32,Module.HEAPF64=HEAPF64;function callRuntimeCallbacks(re){for(;re.length>0;){var U=re.shift();if(typeof U=="function"){U();continue}var Y=U.func;typeof Y=="number"?U.arg===void 0?Runtime.dynCall("v",Y):Runtime.dynCall("vi",Y,[U.arg]):Y(U.arg===void 0?null:U.arg)}}var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1;function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){runtimeInitialized||(runtimeInitialized=!0,callRuntimeCallbacks(__ATINIT__))}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__)}function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(re){__ATPRERUN__.unshift(re)}Module.addOnPreRun=addOnPreRun;function addOnInit(re){__ATINIT__.unshift(re)}Module.addOnInit=addOnInit;function addOnPreMain(re){__ATMAIN__.unshift(re)}Module.addOnPreMain=addOnPreMain;function addOnExit(re){__ATEXIT__.unshift(re)}Module.addOnExit=addOnExit;function addOnPostRun(re){__ATPOSTRUN__.unshift(re)}Module.addOnPostRun=addOnPostRun;function intArrayFromString(re,U,Y){var ie=Y>0?Y:lengthBytesUTF8(re)+1,ne=new Array(ie),F=stringToUTF8Array(re,ne,0,ne.length);return U&&(ne.length=F),ne}Module.intArrayFromString=intArrayFromString;function intArrayToString(re){for(var U=[],Y=0;Y<re.length;Y++){var ie=re[Y];ie>255&&(ie&=255),U.push(String.fromCharCode(ie))}return U.join("")}Module.intArrayToString=intArrayToString;function writeStringToMemory(re,U,Y){for(var ie=intArrayFromString(re,Y),ne=0;ne<ie.length;){var F=ie[ne];HEAP8[U+ne>>0]=F,ne=ne+1}}Module.writeStringToMemory=writeStringToMemory;function writeArrayToMemory(re,U){for(var Y=0;Y<re.length;Y++)HEAP8[U++>>0]=re[Y]}Module.writeArrayToMemory=writeArrayToMemory;function writeAsciiToMemory(re,U,Y){for(var ie=0;ie<re.length;++ie)HEAP8[U++>>0]=re.charCodeAt(ie);Y||(HEAP8[U>>0]=0)}Module.writeAsciiToMemory=writeAsciiToMemory,(!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function re(U,Y){var ie=U>>>16,ne=U&65535,F=Y>>>16,fe=Y&65535;return ne*fe+(ie*fe+ne*F<<16)|0}),Math.imul=Math.imul,Math.clz32||(Math.clz32=function(re){re=re>>>0;for(var U=0;U<32;U++)if(re&1<<31-U)return U;return 32}),Math.clz32=Math.clz32;var Math_abs=Math.abs,Math_cos=Math.cos,Math_sin=Math.sin,Math_sqrt=Math.sqrt,Math_ceil=Math.ceil,Math_floor=Math.floor,Math_min=Math.min,runDependencies=0,dependenciesFulfilled=null;function addRunDependency(re){runDependencies++,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies)}Module.addRunDependency=addRunDependency;function removeRunDependency(re){if(runDependencies--,Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies),runDependencies==0&&dependenciesFulfilled){var U=dependenciesFulfilled;dependenciesFulfilled=null,U()}}Module.removeRunDependency=removeRunDependency,Module.preloadedImages={},Module.preloadedAudios={};var ASM_CONSTS=[function(re,U,Y,ie){{artoolkit.multiEachMarkerInfo||(artoolkit.multiEachMarkerInfo={});var ne=artoolkit.multiEachMarkerInfo;ne.visible=re,ne.pattId=U,ne.pattType=Y,ne.width=ie}},function(re,U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le,xe,Fe,Oe,Ne,ke,Ve,Xe,$e,st,ze,tt,ft,Rt,Mt,Gt,_t){{var Bt=arguments,dt=12;artoolkit.markerInfo||(artoolkit.markerInfo={pos:[0,0],line:[[0,0,0],[0,0,0],[0,0,0],[0,0,0]],vertex:[[0,0],[0,0],[0,0],[0,0]]});var ut=artoolkit.markerInfo;ut.area=re,ut.id=U,ut.idPatt=Y,ut.idMatrix=ie,ut.dir=ne,ut.dirPatt=F,ut.dirMatrix=fe,ut.cf=pe,ut.cfPatt=Me,ut.cfMatrix=ve,ut.pos[0]=se,ut.pos[1]=me,ut.line[0][0]=Bt[dt++],ut.line[0][1]=Bt[dt++],ut.line[0][2]=Bt[dt++],ut.line[1][0]=Bt[dt++],ut.line[1][1]=Bt[dt++],ut.line[1][2]=Bt[dt++],ut.line[2][0]=Bt[dt++],ut.line[2][1]=Bt[dt++],ut.line[2][2]=Bt[dt++],ut.line[3][0]=Bt[dt++],ut.line[3][1]=Bt[dt++],ut.line[3][2]=Bt[dt++],ut.vertex[0][0]=Bt[dt++],ut.vertex[0][1]=Bt[dt++],ut.vertex[1][0]=Bt[dt++],ut.vertex[1][1]=Bt[dt++],ut.vertex[2][0]=Bt[dt++],ut.vertex[2][1]=Bt[dt++],ut.vertex[3][0]=Bt[dt++],ut.vertex[3][1]=Bt[dt++],ut.errorCorrected=Bt[dt++]}},function(re,U,Y,ie,ne){{artoolkit.frameMalloc||(artoolkit.frameMalloc={});var F=artoolkit.frameMalloc;F.framepointer=U,F.framesize=Y,F.camera=ie,F.transform=ne}}];function _emscripten_asm_const_33(re,U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le,xe,Fe,Oe,Ne,ke,Ve,Xe,$e,st,ze,tt,ft,Rt,Mt,Gt,_t,Bt){return ASM_CONSTS[re](U,Y,ie,ne,F,fe,pe,Me,ve,se,me,Te,Re,be,Pe,Le,xe,Fe,Oe,Ne,ke,Ve,Xe,$e,st,ze,tt,ft,Rt,Mt,Gt,_t,Bt)}function _emscripten_asm_const_4(re,U,Y,ie,ne){return ASM_CONSTS[re](U,Y,ie,ne)}function _emscripten_asm_const_5(re,U,Y,ie,ne,F){return ASM_CONSTS[re](U,Y,ie,ne,F)}STATIC_BASE=8,STATICTOP=STATIC_BASE+16496,__ATINIT__.push({func:function(){__GLOBAL__sub_I_ARToolKitJS_cpp()}},{func:function(){__GLOBAL__sub_I_bind_cpp()}}),allocate([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,52,9,0,0,53,42,0,0,0,0,0,0,1,0,0,0,128,1,0,0,0,0,0,0,228,8,0,0,116,42,0,0,52,9,0,0,136,47,0,0,0,0,0,0,1,0,0,0,128,1,0,0,0,0,0,0,52,9,0,0,73,47,0,0,0,0,0,0,1,0,0,0,128,1,0,0,0,0,0,0,228,8,0,0,54,47,0,0,228,8,0,0,23,47,0,0,228,8,0,0,62,46,0,0,228,8,0,0,31,46,0,0,228,8,0,0,0,46,0,0,228,8,0,0,225,45,0,0,228,8,0,0,194,45,0,0,228,8,0,0,93,46,0,0,228,8,0,0,124,46,0,0,228,8,0,0,155,46,0,0,228,8,0,0,186,46,0,0,228,8,0,0,217,46,0,0,228,8,0,0,248,46,0,0,12,9,0,0,199,47,0,0,48,2,0,0,0,0,0,0,228,8,0,0,212,47,0,0,228,8,0,0,225,47,0,0,12,9,0,0,238,47,0,0,56,2,0,0,0,0,0,0,12,9,0,0,15,48,0,0,64,2,0,0,0,0,0,0,12,9,0,0,49,48,0,0,64,2,0,0,0,0,0,0,200,8,0,0,89,48,0,0,200,8,0,0,91,48,0,0,200,8,0,0,93,48,0,0,200,8,0,0,95,48,0,0,200,8,0,0,97,48,0,0,200,8,0,0,99,48,0,0,200,8,0,0,101,48,0,0,200,8,0,0,103,48,0,0,200,8,0,0,105,48,0,0,200,8,0,0,107,48,0,0,200,8,0,0,109,48,0,0,200,8,0,0,111,48,0,0,200,8,0,0,113,48,0,0,12,9,0,0,115,48,0,0,80,2,0,0,0,0,0,0,12,9,0,0,152,48,0,0,80,2,0,0,0,0,0,0,255,15,0,0,6,16,0,0,18,16,0,0,28,16,0,0,255,255,255,255,255,255,255,255,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,255,255,255,255,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,1,0,0,0,2,0,0,0,4,0,0,0,8,0,0,0,3,0,0,0,6,0,0,0,12,0,0,0,11,0,0,0,5,0,0,0,10,0,0,0,7,0,0,0,14,0,0,0,15,0,0,0,13,0,0,0,9,0,0,0,1,0,0,0,2,0,0,0,4,0,0,0,8,0,0,0,16,0,0,0,32,0,0,0,64,0,0,0,3,0,0,0,6,0,0,0,12,0,0,0,24,0,0,0,48,0,0,0,96,0,0,0,67,0,0,0,5,0,0,0,10,0,0,0,20,0,0,0,40,0,0,0,80,0,0,0,35,0,0,0,70,0,0,0,15,0,0,0,30,0,0,0,60,0,0,0,120,0,0,0,115,0,0,0,101,0,0,0,73,0,0,0,17,0,0,0,34,0,0,0,68,0,0,0,11,0,0,0,22,0,0,0,44,0,0,0,88,0,0,0,51,0,0,0,102,0,0,0,79,0,0,0,29,0,0,0,58,0,0,0,116,0,0,0,107,0,0,0,85,0,0,0,41,0,0,0,82,0,0,0,39,0,0,0,78,0,0,0,31,0,0,0,62,0,0,0,124,0,0,0,123,0,0,0,117,0,0,0,105,0,0,0,81,0,0,0,33,0,0,0,66,0,0,0,7,0,0,0,14,0,0,0,28,0,0,0,56,0,0,0,112,0,0,0,99,0,0,0,69,0,0,0,9,0,0,0,18,0,0,0,36,0,0,0,72,0,0,0,19,0,0,0,38,0,0,0,76,0,0,0,27,0,0,0,54,0,0,0,108,0,0,0,91,0,0,0,53,0,0,0,106,0,0,0,87,0,0,0,45,0,0,0,90,0,0,0,55,0,0,0,110,0,0,0,95,0,0,0,61,0,0,0,122,0,0,0,119,0,0,0,109,0,0,0,89,0,0,0,49,0,0,0,98,0,0,0,71,0,0,0,13,0,0,0,26,0,0,0,52,0,0,0,104,0,0,0,83,0,0,0,37,0,0,0,74,0,0,0,23,0,0,0,46,0,0,0,92,0,0,0,59,0,0,0,118,0,0,0,111,0,0,0,93,0,0,0,57,0,0,0,114,0,0,0,103,0,0,0,77,0,0,0,25,0,0,0,50,0,0,0,100,0,0,0,75,0,0,0,21,0,0,0,42,0,0,0,84,0,0,0,43,0,0,0,86,0,0,0,47,0,0,0,94,0,0,0,63,0,0,0,126,0,0,0,127,0,0,0,125,0,0,0,121,0,0,0,113,0,0,0,97,0,0,0,65,0,0,0,255,255,255,255,0,0,0,0,1,0,0,0,4,0,0,0,2,0,0,0,8,0,0,0,5,0,0,0,10,0,0,0,3,0,0,0,14,0,0,0,9,0,0,0,7,0,0,0,6,0,0,0,13,0,0,0,11,0,0,0,12,0,0,0,255,255,255,255,0,0,0,0,1,0,0,0,7,0,0,0,2,0,0,0,14,0,0,0,8,0,0,0,56,0,0,0,3,0,0,0,63,0,0,0,15,0,0,0,31,0,0,0,9,0,0,0,90,0,0,0,57,0,0,0,21,0,0,0,4,0,0,0,28,0,0,0,64,0,0,0,67,0,0,0,16,0,0,0,112,0,0,0,32,0,0,0,97,0,0,0,10,0,0,0,108,0,0,0,91,0,0,0,70,0,0,0,58,0,0,0,38,0,0,0,22,0,0,0,47,0,0,0,5,0,0,0,54,0,0,0,29,0,0,0,19,0,0,0,65,0,0,0,95,0,0,0,68,0,0,0,45,0,0,0,17,0,0,0,43,0,0,0,113,0,0,0,115,0,0,0,33,0,0,0,77,0,0,0,98,0,0,0,117,0,0,0,11,0,0,0,87,0,0,0,109,0,0,0,35,0,0,0,92,0,0,0,74,0,0,0,71,0,0,0,79,0,0,0,59,0,0,0,104,0,0,0,39,0,0,0,100,0,0,0,23,0,0,0,82,0,0,0,48,0,0,0,119,0,0,0,6,0,0,0,126,0,0,0,55,0,0,0,13,0,0,0,30,0,0,0,62,0,0,0,20,0,0,0,89,0,0,0,66,0,0,0,27,0,0,0,96,0,0,0,111,0,0,0,69,0,0,0,107,0,0,0,46,0,0,0,37,0,0,0,18,0,0,0,53,0,0,0,44,0,0,0,94,0,0,0,114,0,0,0,42,0,0,0,116,0,0,0,76,0,0,0,34,0,0,0,86,0,0,0,78,0,0,0,73,0,0,0,99,0,0,0,103,0,0,0,118,0,0,0,81,0,0,0,12,0,0,0,125,0,0,0,88,0,0,0,61,0,0,0,110,0,0,0,26,0,0,0,36,0,0,0,106,0,0,0,93,0,0,0,52,0,0,0,75,0,0,0,41,0,0,0,72,0,0,0,85,0,0,0,80,0,0,0,102,0,0,0,60,0,0,0,124,0,0,0,105,0,0,0,25,0,0,0,40,0,0,0,51,0,0,0,101,0,0,0,84,0,0,0,24,0,0,0,123,0,0,0,83,0,0,0,50,0,0,0,49,0,0,0,122,0,0,0,120,0,0,0,121,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,136,0,0,0,5,0,0,0,144,0,0,0,6,0,0,0,152,0,0,0,9,0,0,0,176,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,253,255,255,255,254,255,255,255,0,0,0,0,112,2,0,0,168,2,0,0,200,2,0,0,112,2,0,0,168,2,0,0,168,2,0,0,208,2,0,0,168,2,0,0,112,2,0,0,168,2,0,0,208,2,0,0,168,2,0,0,112,2,0,0,168,2,0,0,168,2,0,0,104,1,0,0,168,2,0,0,168,2,0,0,168,2,0,0,168,2,0,0,168,2,0,0,104,1,0,0,168,2,0,0,168,2,0,0,168,2,0,0,168,2,0,0,168,2,0,0,168,2,0,0,0,0,0,0,32,2,0,0,1,0,0,0,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,96,2,0,0,3,0,0,0,4,0,0,0,5,0,0,0,6,0,0,0,1,0,0,0,0,0,0,0,80,2,0,0,3,0,0,0,7,0,0,0,5,0,0,0,6,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,216,2,0,0,3,0,0,0,8,0,0,0,5,0,0,0,6,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,232,2,0,0,3,0,0,0,9,0,0,0,5,0,0,0,6,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,192,3,0,0,192,4,0,0,192,5,0,0,192,6,0,0,192,7,0,0,192,8,0,0,192,9,0,0,192,10,0,0,192,11,0,0,192,12,0,0,192,13,0,0,192,14,0,0,192,15,0,0,192,16,0,0,192,17,0,0,192,18,0,0,192,19,0,0,192,20,0,0,192,21,0,0,192,22,0,0,192,23,0,0,192,24,0,0,192,25,0,0,192,26,0,0,192,27,0,0,192,28,0,0,192,29,0,0,192,30,0,0,192,31,0,0,192,0,0,0,179,1,0,0,195,2,0,0,195,3,0,0,195,4,0,0,195,5,0,0,195,6,0,0,195,7,0,0,195,8,0,0,195,9,0,0,195,10,0,0,195,11,0,0,195,12,0,0,195,13,0,0,211,14,0,0,195,15,0,0,195,0,0,12,187,1,0,12,195,2,0,12,195,3,0,12,195,4,0,12,211,240,10,0,0,96,11,0,0,0,0,0,0,10,0,0,0,100,0,0,0,232,3,0,0,16,39,0,0,160,134,1,0,64,66,15,0,128,150,152,0,0,225,245,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,5,0,0,0,81,62,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,5,0,0,0,73,58,0,0,0,4,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,3,0,0,0,5,0,0,0,7,0,0,0,11,0,0,0,13,0,0,0,17,0,0,0,19,0,0,0,23,0,0,0,29,0,0,0,31,0,0,0,37,0,0,0,41,0,0,0,43,0,0,0,47,0,0,0,53,0,0,0,59,0,0,0,61,0,0,0,67,0,0,0,71,0,0,0,73,0,0,0,79,0,0,0,83,0,0,0,89,0,0,0,97,0,0,0,101,0,0,0,103,0,0,0,107,0,0,0,109,0,0,0,113,0,0,0,127,0,0,0,131,0,0,0,137,0,0,0,139,0,0,0,149,0,0,0,151,0,0,0,157,0,0,0,163,0,0,0,167,0,0,0,173,0,0,0,179,0,0,0,181,0,0,0,191,0,0,0,193,0,0,0,197,0,0,0,199,0,0,0,211,0,0,0,1,0,0,0,11,0,0,0,13,0,0,0,17,0,0,0,19,0,0,0,23,0,0,0,29,0,0,0,31,0,0,0,37,0,0,0,41,0,0,0,43,0,0,0,47,0,0,0,53,0,0,0,59,0,0,0,61,0,0,0,67,0,0,0,71,0,0,0,73,0,0,0,79,0,0,0,83,0,0,0,89,0,0,0,97,0,0,0,101,0,0,0,103,0,0,0,107,0,0,0,109,0,0,0,113,0,0,0,121,0,0,0,127,0,0,0,131,0,0,0,137,0,0,0,139,0,0,0,143,0,0,0,149,0,0,0,151,0,0,0,157,0,0,0,163,0,0,0,167,0,0,0,169,0,0,0,173,0,0,0,179,0,0,0,181,0,0,0,187,0,0,0,191,0,0,0,193,0,0,0,197,0,0,0,199,0,0,0,209,0,0,0,69,114,114,111,114,58,32,108,97,98,101,108,105,110,103,32,119,111,114,107,32,111,118,101,114,102,108,111,119,46,10,0,69,114,114,111,114,58,32,85,110,115,117,112,112,111,114,116,101,100,32,112,105,120,101,108,32,102,111,114,109,97,116,32,40,37,100,41,32,114,101,113,117,101,115,116,101,100,46,10,0,85,110,107,110,111,119,110,32,111,114,32,117,110,115,117,112,112,111,114,116,101,100,32,108,97,98,101,108,105,110,103,32,116,104,114,101,115,104,111,108,100,32,109,111,100,101,32,114,101,113,117,101,115,116,101,100,46,32,83,101,116,32,116,111,32,109,97,110,117,97,108,46,10,0,76,97,98,101,108,105,110,103,32,116,104,114,101,115,104,111,108,100,32,109,111,100,101,32,115,101,116,32,116,111,32,37,115,46,10,0,77,65,78,85,65,76,0,65,85,84,79,95,77,69,68,73,65,78,0,65,85,84,79,95,79,84,83,85,0,65,85,84,79,95,65,68,65,80,84,73,86,69,65,85,84,79,95,66,82,65,67,75,69,84,73,78,71,0,65,117,116,111,32,116,104,114,101,115,104,111,108,100,32,40,98,114,97,99,107,101,116,41,32,109,97,114,107,101,114,32,99,111,117,110,116,115,32,45,91,37,51,100,58,32,37,51,100,93,32,91,37,51,100,58,32,37,51,100,93,32,91,37,51,100,58,32,37,51,100,93,43,46,10,0,65,117,116,111,32,116,104,114,101,115,104,111,108,100,32,40,98,114,97,99,107,101,116,41,32,97,100,106,117,115,116,101,100,32,116,104,114,101,115,104,111,108,100,32,116,111,32,37,100,46,10,0,109,101,100,105,97,110,0,79,116,115,117,0,65,117,116,111,32,116,104,114,101,115,104,111,108,100,32,40,37,115,41,32,97,100,106,117,115,116,101,100,32,116,104,114,101,115,104,111,108,100,32,116,111,32,37,100,46,10,0,63,63,63,32,49,10,0,63,63,63,32,50,10,0,63,63,63,32,51,10,0,69,114,114,111,114,58,32,85,110,115,117,112,112,111,114,116,101,100,32,112,105,120,101,108,32,102,111,114,109,97,116,32,112,97,115,115,101,100,32,116,111,32,97,114,73,109,97,103,101,80,114,111,99,72,105,115,116,40,41,46,10,0,0,0,0,1,0,1,1,1,0,2,4,255,255,5,3,1,0,2,255,6,7,255,3,1,2,2,3,2,3,2,3,3,0,255,4,6,7,5,255,1,4,5,4,4,5,5,4,5,7,6,6,6,7,7,7,6,255,2,4,6,7,5,3,255,0,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,0,1,1,0,1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,0,0,1,1,1,0,1,1,1,1,1,1,0,0,255,255,3,255,5,6,255,255,9,10,255,12,255,255,15,255,17,18,255,20,255,255,23,24,255,255,27,255,29,30,255,255,1,2,255,4,255,255,7,8,255,255,11,255,13,14,255,16,255,255,19,255,21,22,255,255,25,26,255,28,255,255,31,69,114,114,111,114,58,32,117,110,115,117,112,112,111,114,116,101,100,32,112,105,120,101,108,32,102,111,114,109,97,116,46,10,0,69,114,114,111,114,58,32,78,85,76,76,32,112,97,116,116,72,97,110,100,108,101,46,10,0,69,114,114,111,114,58,32,99,97,110,39,116,32,108,111,97,100,32,112,97,116,116,101,114,110,32,102,114,111,109,32,78,85,76,76,32,98,117,102,102,101,114,46,10,0,69,114,114,111,114,58,32,111,117,116,32,111,102,32,109,101,109,111,114,121,46,10,0,32,9,10,13,0,80,97,116,116,101,114,110,32,68,97,116,97,32,114,101,97,100,32,101,114,114,111,114,33,33,10,0,69,114,114,111,114,32,111,112,101,110,105,110,103,32,112,97,116,116,101,114,110,32,102,105,108,101,32,39,37,115,39,32,102,111,114,32,114,101,97,100,105,110,103,46,10,0,69,114,114,111,114,32,114,101,97,100,105,110,103,32,112,97,116,116,101,114,110,32,102,105,108,101,32,39,37,115,39,46,10,0,114,98,0,69,114,114,111,114,32,40,37,100,41,58,32,117,110,97,98,108,101,32,116,111,32,111,112,101,110,32,99,97,109,101,114,97,32,112,97,114,97,109,101,116,101,114,115,32,102,105,108,101,32,34,37,115,34,32,102,111,114,32,114,101,97,100,105,110,103,46,10,0,69,114,114,111,114,32,40,37,100,41,58,32,117,110,97,98,108,101,32,116,111,32,100,101,116,101,114,109,105,110,101,32,102,105,108,101,32,108,101,110,103,116,104,46,0,69,114,114,111,114,58,32,115,117,112,112,108,105,101,100,32,102,105,108,101,32,100,111,101,115,32,110,111,116,32,97,112,112,101,97,114,32,116,111,32,98,101,32,97,110,32,65,82,84,111,111,108,75,105,116,32,99,97,109,101,114,97,32,112,97,114,97,109,101,116,101,114,32,102,105,108,101,46,10,0,69,114,114,111,114,32,40,37,100,41,58,32,117,110,97,98,108,101,32,116,111,32,114,101,97,100,32,102,114,111,109,32,102,105,108,101,46,0,69,114,114,111,114,58,32,105,99,112,71,101,116,74,95,85,95,88,99,0,69,114,114,111,114,58,32,109,97,108,108,111,99,10,0,69,114,114,111,114,32,49,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,69,114,114,111,114,32,50,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,69,114,114,111,114,32,51,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,69,114,114,111,114,32,52,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,69,114,114,111,114,32,53,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,69,114,114,111,114,32,54,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,69,114,114,111,114,32,55,58,32,105,99,112,71,101,116,73,110,105,116,88,119,50,88,99,10,0,114,0,69,114,114,111,114,58,32,117,110,97,98,108,101,32,116,111,32,111,112,101,110,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,46,10,0,37,115,37,115,10,0,0,37,100,0,69,114,114,111,114,32,112,114,111,99,101,115,115,105,110,103,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,58,32,70,105,114,115,116,32,108,105,110,101,32,109,117,115,116,32,98,101,32,110,117,109,98,101,114,32,111,102,32,109,97,114,107,101,114,32,99,111,110,102,105,103,115,32,116,111,32,114,101,97,100,46,10,0,79,117,116,32,111,102,32,109,101,109,111,114,121,33,33,10,0,37,108,108,117,37,99,0,69,114,114,111,114,32,112,114,111,99,101,115,115,105,110,103,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,58,32,112,97,116,116,101,114,110,32,39,37,115,39,32,115,112,101,99,105,102,105,101,100,32,105,110,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,117,114,97,116,105,111,110,32,119,104,105,108,101,32,105,110,32,98,97,114,99,111,100,101,45,111,110,108,121,32,109,111,100,101,46,10,0,69,114,114,111,114,32,112,114,111,99,101,115,115,105,110,103,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,58,32,85,110,97,98,108,101,32,116,111,32,100,101,116,101,114,109,105,110,101,32,100,105,114,101,99,116,111,114,121,32,110,97,109,101,46,10,0,69,114,114,111,114,32,112,114,111,99,101,115,115,105,110,103,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,58,32,85,110,97,98,108,101,32,116,111,32,108,111,97,100,32,112,97,116,116,101,114,110,32,39,37,115,39,46,10,0,37,108,102,0,69,114,114,111,114,32,112,114,111,99,101,115,115,105,110,103,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,44,32,109,97,114,107,101,114,32,100,101,102,105,110,105,116,105,111,110,32,37,51,100,58,32,70,105,114,115,116,32,108,105,110,101,32,109,117,115,116,32,98,101,32,112,97,116,116,101,114,110,32,119,105,100,116,104,46,10,0,37,108,102,32,37,108,102,32,37,108,102,32,37,108,102,0,37,102,32,37,102,0,69,114,114,111,114,32,112,114,111,99,101,115,115,105,110,103,32,109,117,108,116,105,109,97,114,107,101,114,32,99,111,110,102,105,103,32,102,105,108,101,32,39,37,115,39,44,32,109,97,114,107,101,114,32,100,101,102,105,110,105,116,105,111,110,32,37,51,100,58,32,76,105,110,101,115,32,50,32,45,32,52,32,109,117,115,116,32,98,101,32,109,97,114,107,101,114,32,116,114,97,110,115,102,111,114,109,46,10,0,97,114,103,108,67,97,109,101,114,97,70,114,117,115,116,117,109,40,41,58,32,97,114,80,97,114,97,109,68,101,99,111,109,112,77,97,116,40,41,32,105,110,100,105,99,97,116,101,100,32,112,97,114,97,109,101,116,101,114,32,101,114,114,111,114,46,10,0,108,111,97,100,67,97,109,101,114,97,40,41,58,32,69,114,114,111,114,32,108,111,97,100,105,110,103,32,112,97,114,97,109,101,116,101,114,32,102,105,108,101,32,37,115,32,102,111,114,32,99,97,109,101,114,97,46,10,0,42,42,42,32,67,97,109,101,114,97,32,80,97,114,97,109,101,116,101,114,32,114,101,115,105,122,101,100,32,102,114,111,109,32,37,100,44,32,37,100,46,32,42,42,42,10,0,115,101,116,67,97,109,101,114,97,40,41,58,32,69,114,114,111,114,58,32,97,114,80,97,114,97,109,76,84,67,114,101,97,116,101,46,10,0,115,101,116,67,97,109,101,114,97,40,41,58,32,69,114,114,111,114,58,32,97,114,67,114,101,97,116,101,72,97,110,100,108,101,46,10,0,115,101,116,67,97,109,101,114,97,40,41,58,32,69,114,114,111,114,32,99,114,101,97,116,105,110,103,32,51,68,32,104,97,110,100,108,101,0,108,111,97,100,77,97,114,107,101,114,40,41,58,32,69,114,114,111,114,32,108,111,97,100,105,110,103,32,112,97,116,116,101,114,110,32,102,105,108,101,32,37,115,46,10,0,65,82,84,111,111,108,75,105,116,74,83,40,41,58,32,85,110,97,98,108,101,32,116,111,32,115,101,116,32,117,112,32,65,82,32,109,97,114,107,101,114,46,10,0,99,111,110,102,105,103,32,100,97,116,97,32,108,111,97,100,32,101,114,114,111,114,32,33,33,10,0,65,82,84,111,111,108,75,105,116,74,83,40,41,58,32,85,110,97,98,108,101,32,116,111,32,115,101,116,32,117,112,32,65,82,32,109,117,108,116,105,109,97,114,107,101,114,46,10,0,80,97,116,116,101,114,110,32,100,101,116,101,99,116,105,111,110,32,109,111,100,101,32,115,101,116,32,116,111,32,37,100,46,10,0,80,97,116,116,101,114,110,32,114,97,116,105,111,32,115,105,122,101,32,115,101,116,32,116,111,32,37,102,46,10,0,76,97,98,101,108,105,110,103,32,109,111,100,101,32,115,101,116,32,116,111,32,37,100,10,0,84,104,114,101,115,104,111,108,100,32,115,101,116,32,116,111,32,37,100,10,0,84,104,114,101,115,104,111,108,100,32,109,111,100,101,32,115,101,116,32,116,111,32,37,100,10,0,111,110,46,0,111,102,102,46,0,68,101,98,117,103,32,109,111,100,101,32,115,101,116,32,116,111,32,37,115,10,0,73,109,97,103,101,32,112,114,111,99,46,32,109,111,100,101,32,115,101,116,32,116,111,32,37,100,46,10,0,123,32,105,102,32,40,33,97,114,116,111,111,108,107,105,116,91,34,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,73,110,102,111,34,93,41,32,123,32,97,114,116,111,111,108,107,105,116,91,34,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,73,110,102,111,34,93,32,61,32,40,123,125,41,59,32,125,32,118,97,114,32,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,32,61,32,97,114,116,111,111,108,107,105,116,91,34,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,73,110,102,111,34,93,59,32,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,91,39,118,105,115,105,98,108,101,39,93,32,61,32,36,48,59,32,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,91,39,112,97,116,116,73,100,39,93,32,61,32,36,49,59,32,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,91,39,112,97,116,116,84,121,112,101,39,93,32,61,32,36,50,59,32,109,117,108,116,105,69,97,99,104,77,97,114,107,101,114,91,39,119,105,100,116,104,39,93,32,61,32,36,51,59,32,125,0,123,32,118,97,114,32,36,97,32,61,32,97,114,103,117,109,101,110,116,115,59,32,118,97,114,32,105,32,61,32,49,50,59,32,105,102,32,40,33,97,114,116,111,111,108,107,105,116,91,34,109,97,114,107,101,114,73,110,102,111,34,93,41,32,123,32,97,114,116,111,111,108,107,105,116,91,34,109,97,114,107,101,114,73,110,102,111,34,93,32,61,32,40,123,32,112,111,115,58,32,91,48,44,48,93,44,32,108,105,110,101,58,32,91,91,48,44,48,44,48,93,44,32,91,48,44,48,44,48,93,44,32,91,48,44,48,44,48,93,44,32,91,48,44,48,44,48,93,93,44,32,118,101,114,116,101,120,58,32,91,91,48,44,48,93,44,32,91,48,44,48,93,44,32,91,48,44,48,93,44,32,91,48,44,48,93,93,32,125,41,59,32,125,32,118,97,114,32,109,97,114,107,101,114,73,110,102,111,32,61,32,97,114,116,111,111,108,107,105,116,91,34,109,97,114,107,101,114,73,110,102,111,34,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,97,114,101,97,34,93,32,61,32,36,48,59,32,109,97,114,107,101,114,73,110,102,111,91,34,105,100,34,93,32,61,32,36,49,59,32,109,97,114,107,101,114,73,110,102,111,91,34,105,100,80,97,116,116,34,93,32,61,32,36,50,59,32,109,97,114,107,101,114,73,110,102,111,91,34,105,100,77,97,116,114,105,120,34,93,32,61,32,36,51,59,32,109,97,114,107,101,114,73,110,102,111,91,34,100,105,114,34,93,32,61,32,36,52,59,32,109,97,114,107,101,114,73,110,102,111,91,34,100,105,114,80,97,116,116,34,93,32,61,32,36,53,59,32,109,97,114,107,101,114,73,110,102,111,91,34,100,105,114,77,97,116,114,105,120,34,93,32,61,32,36,54,59,32,109,97,114,107,101,114,73,110,102,111,91,34,99,102,34,93,32,61,32,36,55,59,32,109,97,114,107,101,114,73,110,102,111,91,34,99,102,80,97,116,116,34,93,32,61,32,36,56,59,32,109,97,114,107,101,114,73,110,102,111,91,34,99,102,77,97,116,114,105,120,34,93,32,61,32,36,57,59,32,109,97,114,107,101,114,73,110,102,111,91,34,112,111,115,34,93,91,48,93,32,61,32,36,49,48,59,32,109,97,114,107,101,114,73,110,102,111,91,34,112,111,115,34,93,91,49,93,32,61,32,36,49,49,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,48,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,48,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,48,93,91,50,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,49,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,49,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,49,93,91,50,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,50,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,50,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,50,93,91,50,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,51,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,51,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,108,105,110,101,34,93,91,51,93,91,50,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,48,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,48,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,49,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,49,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,50,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,50,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,51,93,91,48,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,118,101,114,116,101,120,34,93,91,51,93,91,49,93,32,61,32,36,97,91,105,43,43,93,59,32,109,97,114,107,101,114,73,110,102,111,91,34,101,114,114,111,114,67,111,114,114,101,99,116,101,100,34,93,32,61,32,36,97,91,105,43,43,93,59,32,125,0,115,101,116,117,112,40,41,58,32,69,114,114,111,114,58,32,97,114,80,97,116,116,67,114,101,97,116,101,72,97,110,100,108,101,46,10,0,65,108,108,111,99,97,116,101,100,32,118,105,100,101,111,70,114,97,109,101,83,105,122,101,32,37,100,10,0,123,32,105,102,32,40,33,97,114,116,111,111,108,107,105,116,91,34,102,114,97,109,101,77,97,108,108,111,99,34,93,41,32,123,32,97,114,116,111,111,108,107,105,116,91,34,102,114,97,109,101,77,97,108,108,111,99,34,93,32,61,32,40,123,125,41,59,32,125,32,118,97,114,32,102,114,97,109,101,77,97,108,108,111,99,32,61,32,97,114,116,111,111,108,107,105,116,91,34,102,114,97,109,101,77,97,108,108,111,99,34,93,59,32,102,114,97,109,101,77,97,108,108,111,99,91,34,102,114,97,109,101,112,111,105,110,116,101,114,34,93,32,61,32,36,49,59,32,102,114,97,109,101,77,97,108,108,111,99,91,34,102,114,97,109,101,115,105,122,101,34,93,32,61,32,36,50,59,32,102,114,97,109,101,77,97,108,108,111,99,91,34,99,97,109,101,114,97,34,93,32,61,32,36,51,59,32,102,114,97,109,101,77,97,108,108,111,99,91,34,116,114,97,110,115,102,111,114,109,34,93,32,61,32,36,52,59,32,125,0,115,101,116,117,112,0,116,101,97,114,100,111,119,110,0,95,97,100,100,77,97,114,107,101,114,0,95,97,100,100,77,117,108,116,105,77,97,114,107,101,114,0,103,101,116,77,117,108,116,105,77,97,114,107,101,114,78,117,109,0,103,101,116,77,117,108,116,105,77,97,114,107,101,114,67,111,117,110,116,0,95,108,111,97,100,67,97,109,101,114,97,0,115,101,116,77,97,114,107,101,114,73,110,102,111,68,105,114,0,115,101,116,77,97,114,107,101,114,73,110,102,111,86,101,114,116,101,120,0,103,101,116,84,114,97,110,115,77,97,116,83,113,117,97,114,101,0,103,101,116,84,114,97,110,115,77,97,116,83,113,117,97,114,101,67,111,110,116,0,103,101,116,84,114,97,110,115,77,97,116,77,117,108,116,105,83,113,117,97,114,101,0,103,101,116,84,114,97,110,115,77,97,116,77,117,108,116,105,83,113,117,97,114,101,82,111,98,117,115,116,0,100,101,116,101,99,116,77,97,114,107,101,114,0,103,101,116,77,97,114,107,101,114,78,117,109,0,103,101,116,77,117,108,116,105,69,97,99,104,77,97,114,107,101,114,0,103,101,116,77,97,114,107,101,114,0,115,101,116,68,101,98,117,103,77,111,100,101,0,103,101,116,68,101,98,117,103,77,111,100,101,0,103,101,116,80,114,111,99,101,115,115,105,110,103,73,109,97,103,101,0,115,101,116,76,111,103,76,101,118,101,108,0,103,101,116,76,111,103,76,101,118,101,108,0,115,101,116,80,114,111,106,101,99,116,105,111,110,78,101,97,114,80,108,97,110,101,0,103,101,116,80,114,111,106,101,99,116,105,111,110,78,101,97,114,80,108,97,110,101,0,115,101,116,80,114,111,106,101,99,116,105,111,110,70,97,114,80,108,97,110,101,0,103,101,116,80,114,111,106,101,99,116,105,111,110,70,97,114,80,108,97,110,101,0,115,101,116,84,104,114,101,115,104,111,108,100,77,111,100,101,0,103,101,116,84,104,114,101,115,104,111,108,100,77,111,100,101,0,115,101,116,84,104,114,101,115,104,111,108,100,0,103,101,116,84,104,114,101,115,104,111,108,100,0,115,101,116,80,97,116,116,101,114,110,68,101,116,101,99,116,105,111,110,77,111,100,101,0,103,101,116,80,97,116,116,101,114,110,68,101,116,101,99,116,105,111,110,77,111,100,101,0,115,101,116,80,97,116,116,82,97,116,105,111,0,103,101,116,80,97,116,116,82,97,116,105,111,0,115,101,116,77,97,116,114,105,120,67,111,100,101,84,121,112,101,0,103,101,116,77,97,116,114,105,120,67,111,100,101,84,121,112,101,0,115,101,116,76,97,98,101,108,105,110,103,77,111,100,101,0,103,101,116,76,97,98,101,108,105,110,103,77,111,100,101,0,115,101,116,73,109,97,103,101,80,114,111,99,77,111,100,101,0,103,101,116,73,109,97,103,101,80,114,111,99,77,111,100,101,0,69,82,82,79,82,95,65,82,67,79,78,84,82,79,76,76,69,82,95,78,79,84,95,70,79,85,78,68,0,69,82,82,79,82,95,77,85,76,84,73,77,65,82,75,69,82,95,78,79,84,95,70,79,85,78,68,0,69,82,82,79,82,95,77,65,82,75,69,82,95,73,78,68,69,88,95,79,85,84,95,79,70,95,66,79,85,78,68,83,0,65,82,95,68,69,66,85,71,95,68,73,83,65,66,76,69,0,65,82,95,68,69,66,85,71,95,69,78,65,66,76,69,0,65,82,95,68,69,70,65,85,76,84,95,68,69,66,85,71,95,77,79,68,69,0,65,82,95,76,65,66,69,76,73,78,71,95,87,72,73,84,69,95,82,69,71,73,79,78,0,65,82,95,76,65,66,69,76,73,78,71,95,66,76,65,67,75,95,82,69,71,73,79,78,0,65,82,95,68,69,70,65,85,76,84,95,76,65,66,69,76,73,78,71,95,77,79,68,69,0,65,82,95,68,69,70,65,85,76,84,95,76,65,66,69,76,73,78,71,95,84,72,82,69,83,72,0,65,82,95,73,77,65,71,69,95,80,82,79,67,95,70,82,65,77,69,95,73,77,65,71,69,0,65,82,95,73,77,65,71,69,95,80,82,79,67,95,70,73,69,76,68,95,73,77,65,71,69,0,65,82,95,68,69,70,65,85,76,84,95,73,77,65,71,69,95,80,82,79,67,95,77,79,68,69,0,65,82,95,84,69,77,80,76,65,84,69,95,77,65,84,67,72,73,78,71,95,67,79,76,79,82,0,65,82,95,84,69,77,80,76,65,84,69,95,77,65,84,67,72,73,78,71,95,77,79,78,79,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,68,69,84,69,67,84,73,79,78,0,65,82,95,84,69,77,80,76,65,84,69,95,77,65,84,67,72,73,78,71,95,67,79,76,79,82,95,65,78,68,95,77,65,84,82,73,88,0,65,82,95,84,69,77,80,76,65,84,69,95,77,65,84,67,72,73,78,71,95,77,79,78,79,95,65,78,68,95,77,65,84,82,73,88,0,65,82,95,68,69,70,65,85,76,84,95,80,65,84,84,69,82,78,95,68,69,84,69,67,84,73,79,78,95,77,79,68,69,0,65,82,95,85,83,69,95,84,82,65,67,75,73,78,71,95,72,73,83,84,79,82,89,0,65,82,95,78,79,85,83,69,95,84,82,65,67,75,73,78,71,95,72,73,83,84,79,82,89,0,65,82,95,85,83,69,95,84,82,65,67,75,73,78,71,95,72,73,83,84,79,82,89,95,86,50,0,65,82,95,68,69,70,65,85,76,84,95,77,65,82,75,69,82,95,69,88,84,82,65,67,84,73,79,78,95,77,79,68,69,0,65,82,95,77,65,88,95,76,79,79,80,95,67,79,85,78,84,0,65,82,95,76,79,79,80,95,66,82,69,65,75,95,84,72,82,69,83,72,0,65,82,95,76,79,71,95,76,69,86,69,76,95,68,69,66,85,71,0,65,82,95,76,79,71,95,76,69,86,69,76,95,73,78,70,79,0,65,82,95,76,79,71,95,76,69,86,69,76,95,87,65,82,78,0,65,82,95,76,79,71,95,76,69,86,69,76,95,69,82,82,79,82,0,65,82,95,76,79,71,95,76,69,86,69,76,95,82,69,76,95,73,78,70,79,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,51,120,51,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,51,120,51,95,72,65,77,77,73,78,71,54,51,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,51,120,51,95,80,65,82,73,84,89,54,53,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,52,120,52,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,52,120,52,95,66,67,72,95,49,51,95,57,95,51,0,65,82,95,77,65,84,82,73,88,95,67,79,68,69,95,52,120,52,95,66,67,72,95,49,51,95,53,95,53,0,65,82,95,76,65,66,69,76,73,78,71,95,84,72,82,69,83,72,95,77,79,68,69,95,77,65,78,85,65,76,0,65,82,95,76,65,66,69,76,73,78,71,95,84,72,82,69,83,72,95,77,79,68,69,95,65,85,84,79,95,77,69,68,73,65,78,0,65,82,95,76,65],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE),allocate([66,69,76,73,78,71,95,84,72,82,69,83,72,95,77,79,68,69,95,65,85,84,79,95,79,84,83,85,0,65,82,95,76,65,66,69,76,73,78,71,95,84,72,82,69,83,72,95,77,79,68,69,95,65,85,84,79,95,65,68,65,80,84,73,86,69,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,78,79,78,69,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,80,65,84,84,69,82,78,95,69,88,84,82,65,67,84,73,79,78,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,77,65,84,67,72,95,71,69,78,69,82,73,67,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,77,65,84,67,72,95,67,79,78,84,82,65,83,84,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,77,65,84,67,72,95,66,65,82,67,79,68,69,95,78,79,84,95,70,79,85,78,68,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,77,65,84,67,72,95,66,65,82,67,79,68,69,95,69,68,67,95,70,65,73,76,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,77,65,84,67,72,95,67,79,78,70,73,68,69,78,67,69,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,80,79,83,69,95,69,82,82,79,82,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,80,79,83,69,95,69,82,82,79,82,95,77,85,76,84,73,0,65,82,95,77,65,82,75,69,82,95,73,78,70,79,95,67,85,84,79,70,70,95,80,72,65,83,69,95,72,69,85,82,73,83,84,73,67,95,84,82,79,85,66,76,69,83,79,77,69,95,77,65,84,82,73,88,95,67,79,68,69,83,0,118,105,105,102,0,118,105,105,105,0,100,105,105,0,118,105,105,100,0,105,105,0,118,105,105,0,105,105,105,0,78,83,116,51,95,95,49,49,50,98,97,115,105,99,95,115,116,114,105,110,103,73,99,78,83,95,49,49,99,104,97,114,95,116,114,97,105,116,115,73,99,69,69,78,83,95,57,97,108,108,111,99,97,116,111,114,73,99,69,69,69,69,0,78,83,116,51,95,95,49,50,49,95,95,98,97,115,105,99,95,115,116,114,105,110,103,95,99,111,109,109,111,110,73,76,98,49,69,69,69,0,105,105,105,105,0,105,105,105,105,105,0,118,111,105,100,0,98,111,111,108,0,99,104,97,114,0,115,105,103,110,101,100,32,99,104,97,114,0,117,110,115,105,103,110,101,100,32,99,104,97,114,0,115,104,111,114,116,0,117,110,115,105,103,110,101,100,32,115,104,111,114,116,0,105,110,116,0,117,110,115,105,103,110,101,100,32,105,110,116,0,108,111,110,103,0,117,110,115,105,103,110,101,100,32,108,111,110,103,0,102,108,111,97,116,0,100,111,117,98,108,101,0,115,116,100,58,58,115,116,114,105,110,103,0,115,116,100,58,58,98,97,115,105,99,95,115,116,114,105,110,103,60,117,110,115,105,103,110,101,100,32,99,104,97,114,62,0,115,116,100,58,58,119,115,116,114,105,110,103,0,101,109,115,99,114,105,112,116,101,110,58,58,118,97,108,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,99,104,97,114,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,115,105,103,110,101,100,32,99,104,97,114,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,110,115,105,103,110,101,100,32,99,104,97,114,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,115,104,111,114,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,110,115,105,103,110,101,100,32,115,104,111,114,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,105,110,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,110,115,105,103,110,101,100,32,105,110,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,108,111,110,103,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,110,115,105,103,110,101,100,32,108,111,110,103,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,105,110,116,56,95,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,105,110,116,56,95,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,105,110,116,49,54,95,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,105,110,116,49,54,95,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,105,110,116,51,50,95,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,117,105,110,116,51,50,95,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,102,108,111,97,116,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,100,111,117,98,108,101,62,0,101,109,115,99,114,105,112,116,101,110,58,58,109,101,109,111,114,121,95,118,105,101,119,60,108,111,110,103,32,100,111,117,98,108,101,62,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,101,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,100,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,102,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,109,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,108,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,106,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,105,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,116,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,115,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,104,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,97,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,49,49,109,101,109,111,114,121,95,118,105,101,119,73,99,69,69,0,78,49,48,101,109,115,99,114,105,112,116,101,110,51,118,97,108,69,0,78,83,116,51,95,95,49,49,50,98,97,115,105,99,95,115,116,114,105,110,103,73,119,78,83,95,49,49,99,104,97,114,95,116,114,97,105,116,115,73,119,69,69,78,83,95,57,97,108,108,111,99,97,116,111,114,73,119,69,69,69,69,0,78,83,116,51,95,95,49,49,50,98,97,115,105,99,95,115,116,114,105,110,103,73,104,78,83,95,49,49,99,104,97,114,95,116,114,97,105,116,115,73,104,69,69,78,83,95,57,97,108,108,111,99,97,116,111,114,73,104,69,69,69,69,0,83,116,57,98,97,100,95,97,108,108,111,99,0,83,116,57,101,120,99,101,112,116,105,111,110,0,83,116,57,116,121,112,101,95,105,110,102,111,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,51,95,95,102,117,110,100,97,109,101,110,116,97,108,95,116,121,112,101,95,105,110,102,111,69,0,118,0,98,0,99,0,104,0,97,0,115,0,116,0,105,0,106,0,108,0,109,0,102,0,100,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,49,95,95,118,109,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,33,34,118,101,99,116,111,114,32,108,101,110,103,116,104,95,101,114,114,111,114,34,0,47,85,115,101,114,115,47,106,101,114,111,109,101,101,116,105,101,110,110,101,47,119,111,114,107,47,101,109,115,100,107,95,112,111,114,116,97,98,108,101,47,101,109,115,99,114,105,112,116,101,110,47,49,46,51,53,46,48,47,115,121,115,116,101,109,47,105,110,99,108,117,100,101,47,108,105,98,99,120,120,47,118,101,99,116,111,114,0,95,95,116,104,114,111,119,95,108,101,110,103,116,104,95,101,114,114,111,114,0,115,116,100,58,58,98,97,100,95,97,108,108,111,99,0,33,34,98,97,115,105,99,95,115,116,114,105,110,103,32,108,101,110,103,116,104,95,101,114,114,111,114,34,0,47,85,115,101,114,115,47,106,101,114,111,109,101,101,116,105,101,110,110,101,47,119,111,114,107,47,101,109,115,100,107,95,112,111,114,116,97,98,108,101,47,101,109,115,99,114,105,112,116,101,110,47,49,46,51,53,46,48,47,115,121,115,116,101,109,47,105,110,99,108,117,100,101,47,108,105,98,99,120,120,47,115,116,114,105,110,103,0,84,33,34,25,13,1,2,3,17,75,28,12,16,4,11,29,18,30,39,104,110,111,112,113,98,32,5,6,15,19,20,21,26,8,22,7,40,36,23,24,9,10,14,27,31,37,35,131,130,125,38,42,43,60,61,62,63,67,71,74,77,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,114,115,116,121,122,123,124,0,73,108,108,101,103,97,108,32,98,121,116,101,32,115,101,113,117,101,110,99,101,0,68,111,109,97,105,110,32,101,114,114,111,114,0,82,101,115,117,108,116,32,110,111,116,32,114,101,112,114,101,115,101,110,116,97,98,108,101,0,78,111,116,32,97,32,116,116,121,0,80,101,114,109,105,115,115,105,111,110,32,100,101,110,105,101,100,0,79,112,101,114,97,116,105,111,110,32,110,111,116,32,112,101,114,109,105,116,116,101,100,0,78,111,32,115,117,99,104,32,102,105,108,101,32,111,114,32,100,105,114,101,99,116,111,114,121,0,78,111,32,115,117,99,104,32,112,114,111,99,101,115,115,0,70,105,108,101,32,101,120,105,115,116,115,0,86,97,108,117,101,32,116,111,111,32,108,97,114,103,101,32,102,111,114,32,100,97,116,97,32,116,121,112,101,0,78,111,32,115,112,97,99,101,32,108,101,102,116,32,111,110,32,100,101,118,105,99,101,0,79,117,116,32,111,102,32,109,101,109,111,114,121,0,82,101,115,111,117,114,99,101,32,98,117,115,121,0,73,110,116,101,114,114,117,112,116,101,100,32,115,121,115,116,101,109,32,99,97,108,108,0,82,101,115,111,117,114,99,101,32,116,101,109,112,111,114,97,114,105,108,121,32,117,110,97,118,97,105,108,97,98,108,101,0,73,110,118,97,108,105,100,32,115,101,101,107,0,67,114,111,115,115,45,100,101,118,105,99,101,32,108,105,110,107,0,82,101,97,100,45,111,110,108,121,32,102,105,108,101,32,115,121,115,116,101,109,0,68,105,114,101,99,116,111,114,121,32,110,111,116,32,101,109,112,116,121,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,112,101,101,114,0,79,112,101,114,97,116,105,111,110,32,116,105,109,101,100,32,111,117,116,0,67,111,110,110,101,99,116,105,111,110,32,114,101,102,117,115,101,100,0,72,111,115,116,32,105,115,32,100,111,119,110,0,72,111,115,116,32,105,115,32,117,110,114,101,97,99,104,97,98,108,101,0,65,100,100,114,101,115,115,32,105,110,32,117,115,101,0,66,114,111,107,101,110,32,112,105,112,101,0,73,47,79,32,101,114,114,111,114,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,32,111,114,32,97,100,100,114,101,115,115,0,66,108,111,99,107,32,100,101,118,105,99,101,32,114,101,113,117,105,114,101,100,0,78,111,32,115,117,99,104,32,100,101,118,105,99,101,0,78,111,116,32,97,32,100,105,114,101,99,116,111,114,121,0,73,115,32,97,32,100,105,114,101,99,116,111,114,121,0,84,101,120,116,32,102,105,108,101,32,98,117,115,121,0,69,120,101,99,32,102,111,114,109,97,116,32,101,114,114,111,114,0,73,110,118,97,108,105,100,32,97,114,103,117,109,101,110,116,0,65,114,103,117,109,101,110,116,32,108,105,115,116,32,116,111,111,32,108,111,110,103,0,83,121,109,98,111,108,105,99,32,108,105,110,107,32,108,111,111,112,0,70,105,108,101,110,97,109,101,32,116,111,111,32,108,111,110,103,0,84,111,111,32,109,97,110,121,32,111,112,101,110,32,102,105,108,101,115,32,105,110,32,115,121,115,116,101,109,0,78,111,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,115,32,97,118,97,105,108,97,98,108,101,0,66,97,100,32,102,105,108,101,32,100,101,115,99,114,105,112,116,111,114,0,78,111,32,99,104,105,108,100,32,112,114,111,99,101,115,115,0,66,97,100,32,97,100,100,114,101,115,115,0,70,105,108,101,32,116,111,111,32,108,97,114,103,101,0,84,111,111,32,109,97,110,121,32,108,105,110,107,115,0,78,111,32,108,111,99,107,115,32,97,118,97,105,108,97,98,108,101,0,82,101,115,111,117,114,99,101,32,100,101,97,100,108,111,99,107,32,119,111,117,108,100,32,111,99,99,117,114,0,83,116,97,116,101,32,110,111,116,32,114,101,99,111,118,101,114,97,98,108,101,0,80,114,101,118,105,111,117,115,32,111,119,110,101,114,32,100,105,101,100,0,79,112,101,114,97,116,105,111,110,32,99,97,110,99,101,108,101,100,0,70,117,110,99,116,105,111,110,32,110,111,116,32,105,109,112,108,101,109,101,110,116,101,100,0,78,111,32,109,101,115,115,97,103,101,32,111,102,32,100,101,115,105,114,101,100,32,116,121,112,101,0,73,100,101,110,116,105,102,105,101,114,32,114,101,109,111,118,101,100,0,68,101,118,105,99,101,32,110,111,116,32,97,32,115,116,114,101,97,109,0,78,111,32,100,97,116,97,32,97,118,97,105,108,97,98,108,101,0,68,101,118,105,99,101,32,116,105,109,101,111,117,116,0,79,117,116,32,111,102,32,115,116,114,101,97,109,115,32,114,101,115,111,117,114,99,101,115,0,76,105,110,107,32,104,97,115,32,98,101,101,110,32,115,101,118,101,114,101,100,0,80,114,111,116,111,99,111,108,32,101,114,114,111,114,0,66,97,100,32,109,101,115,115,97,103,101,0,70,105,108,101,32,100,101,115,99,114,105,112,116,111,114,32,105,110,32,98,97,100,32,115,116,97,116,101,0,78,111,116,32,97,32,115,111,99,107,101,116,0,68,101,115,116,105,110,97,116,105,111,110,32,97,100,100,114,101,115,115,32,114,101,113,117,105,114,101,100,0,77,101,115,115,97,103,101,32,116,111,111,32,108,97,114,103,101,0,80,114,111,116,111,99,111,108,32,119,114,111,110,103,32,116,121,112,101,32,102,111,114,32,115,111,99,107,101,116,0,80,114,111,116,111,99,111,108,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,80,114,111,116,111,99,111,108,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,83,111,99,107,101,116,32,116,121,112,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,78,111,116,32,115,117,112,112,111,114,116,101,100,0,80,114,111,116,111,99,111,108,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,0,65,100,100,114,101,115,115,32,102,97,109,105,108,121,32,110,111,116,32,115,117,112,112,111,114,116,101,100,32,98,121,32,112,114,111,116,111,99,111,108,0,65,100,100,114,101,115,115,32,110,111,116,32,97,118,97,105,108,97,98,108,101,0,78,101,116,119,111,114,107,32,105,115,32,100,111,119,110,0,78,101,116,119,111,114,107,32,117,110,114,101,97,99,104,97,98,108,101,0,67,111,110,110,101,99,116,105,111,110,32,114,101,115,101,116,32,98,121,32,110,101,116,119,111,114,107,0,67,111,110,110,101,99,116,105,111,110,32,97,98,111,114,116,101,100,0,78,111,32,98,117,102,102,101,114,32,115,112,97,99,101,32,97,118,97,105,108,97,98,108,101,0,83,111,99,107,101,116,32,105,115,32,99,111,110,110,101,99,116,101,100,0,83,111,99,107,101,116,32,110,111,116,32,99,111,110,110,101,99,116,101,100,0,67,97,110,110,111,116,32,115,101,110,100,32,97,102,116,101,114,32,115,111,99,107,101,116,32,115,104,117,116,100,111,119,110,0,79,112,101,114,97,116,105,111,110,32,97,108,114,101,97,100,121,32,105,110,32,112,114,111,103,114,101,115,115,0,79,112,101,114,97,116,105,111,110,32,105,110,32,112,114,111,103,114,101,115,115,0,83,116,97,108,101,32,102,105,108,101,32,104,97,110,100,108,101,0,82,101,109,111,116,101,32,73,47,79,32,101,114,114,111,114,0,81,117,111,116,97,32,101,120,99,101,101,100,101,100,0,78,111,32,109,101,100,105,117,109,32,102,111,117,110,100,0,87,114,111,110,103,32,109,101,100,105,117,109,32,116,121,112,101,0,78,111,32,101,114,114,111,114,32,105,110,102,111,114,109,97,116,105,111,110,0,0,105,110,102,105,110,105,116,121,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,255,255,255,255,255,255,255,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,255,255,255,255,255,255,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,2,4,7,3,6,5,0,114,119,97],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE+10240),allocate([17,0,10,0,17,17,17,0,0,0,0,5,0,0,0,0,0,0,9,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,15,10,17,17,17,3,10,7,0,1,19,9,11,11,0,0,9,6,11,0,0,11,0,6,17,0,0,0,17,17,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,17,0,10,10,17,17,17,0,10,0,0,2,0,9,11,0,0,0,9,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,13,0,0,0,4,13,0,0,0,0,9,14,0,0,0,0,0,14,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,15,0,0,0,0,9,16,0,0,0,0,0,16,0,0,16,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,18,18,18,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,9,11,0,0,0,0,0,11,0,0,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,12,0,0,0,0,9,12,0,0,0,0,0,12,0,0,12,0,0,48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,45,43,32,32,32,48,88,48,120,0,40,110,117,108,108,41,0,45,48,88,43,48,88,32,48,88,45,48,120,43,48,120,32,48,120,0,105,110,102,0,73,78,70,0,110,97,110,0,78,65,78,0,46,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE+15945);var tempDoublePtr=Runtime.alignMemory(allocate(12,"i8",ALLOC_STATIC),8);assert(tempDoublePtr%8==0);function _atexit(re,U){__ATEXIT__.unshift({func:re,arg:U})}function ___cxa_atexit(){return _atexit.apply(null,arguments)}Module._i64Subtract=_i64Subtract;function ___assert_fail(re,U,Y,ie){throw ABORT=!0,"Assertion failed: "+Pointer_stringify(re)+", at: "+[U?Pointer_stringify(U):"unknown filename",Y,ie?Pointer_stringify(ie):"unknown function"]+" at "+stackTrace()}function embind_init_charCodes(){for(var re=new Array(256),U=0;U<256;++U)re[U]=String.fromCharCode(U);embind_charCodes=re}var embind_charCodes=void 0;function readLatin1String(re){for(var U="",Y=re;HEAPU8[Y];)U+=embind_charCodes[HEAPU8[Y++]];return U}var awaitingDependencies={},registeredTypes={},typeDependencies={},char_0=48,char_9=57;function makeLegalFunctionName(re){if(re===void 0)return"_unknown";re=re.replace(/[^a-zA-Z0-9_]/g,"$");var U=re.charCodeAt(0);return U>=char_0&&U<=char_9?"_"+re:re}function createNamedFunction(re,U){return re=makeLegalFunctionName(re),new Function("body","return function "+re+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(U)}function extendError(re,U){var Y=createNamedFunction(U,function(ie){this.name=U,this.message=ie;var ne=new Error(ie).stack;ne!==void 0&&(this.stack=this.toString()+`
`+ne.replace(/^Error(:[^\n]*)?\n/,""))});return Y.prototype=Object.create(re.prototype),Y.prototype.constructor=Y,Y.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},Y}var BindingError=void 0;function throwBindingError(re){throw new BindingError(re)}var InternalError=void 0;function throwInternalError(re){throw new InternalError(re)}function whenDependentTypesAreResolved(re,U,Y){re.forEach(function(pe){typeDependencies[pe]=U});function ie(pe){var Me=Y(pe);Me.length!==re.length&&throwInternalError("Mismatched type converter count");for(var ve=0;ve<re.length;++ve)registerType(re[ve],Me[ve])}var ne=new Array(U.length),F=[],fe=0;U.forEach(function(pe,Me){registeredTypes.hasOwnProperty(pe)?ne[Me]=registeredTypes[pe]:(F.push(pe),awaitingDependencies.hasOwnProperty(pe)||(awaitingDependencies[pe]=[]),awaitingDependencies[pe].push(function(){ne[Me]=registeredTypes[pe],++fe,fe===F.length&&ie(ne)}))}),F.length===0&&ie(ne)}function registerType(re,U,Y){if(Y=Y||{},!("argPackAdvance"in U))throw new TypeError("registerType registeredInstance requires argPackAdvance");var ie=U.name;if(re||throwBindingError('type "'+ie+'" must have a positive integer typeid pointer'),registeredTypes.hasOwnProperty(re)){if(Y.ignoreDuplicateRegistrations)return;throwBindingError("Cannot register type '"+ie+"' twice")}if(registeredTypes[re]=U,delete typeDependencies[re],awaitingDependencies.hasOwnProperty(re)){var ne=awaitingDependencies[re];delete awaitingDependencies[re],ne.forEach(function(F){F()})}}function __embind_register_void(re,U){U=readLatin1String(U),registerType(re,{isVoid:!0,name:U,argPackAdvance:0,fromWireType:function(){},toWireType:function(Y,ie){}})}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:function(re){if(!re||EXCEPTIONS.infos[re])return re;for(var U in EXCEPTIONS.infos){var Y=EXCEPTIONS.infos[U];if(Y.adjusted===re)return U}return re},addRef:function(re){if(re){var U=EXCEPTIONS.infos[re];U.refcount++}},decRef:function(re){if(re){var U=EXCEPTIONS.infos[re];assert(U.refcount>0),U.refcount--,U.refcount===0&&(U.destructor&&Runtime.dynCall("vi",U.destructor,[re]),delete EXCEPTIONS.infos[re],___cxa_free_exception(re))}},clearRef:function(re){if(re){var U=EXCEPTIONS.infos[re];U.refcount=0}}};function ___resumeException(re){throw EXCEPTIONS.last||(EXCEPTIONS.last=re),EXCEPTIONS.clearRef(EXCEPTIONS.deAdjust(re)),re+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ___cxa_find_matching_catch(){var re=EXCEPTIONS.last;if(!re)return asm.setTempRet0(0),0|0;var U=EXCEPTIONS.infos[re],Y=U.type;if(!Y)return asm.setTempRet0(0),re|0;var ie=Array.prototype.slice.call(arguments);Module.___cxa_is_pointer_type(Y),___cxa_find_matching_catch.buffer||(___cxa_find_matching_catch.buffer=_malloc(4)),HEAP32[___cxa_find_matching_catch.buffer>>2]=re,re=___cxa_find_matching_catch.buffer;for(var ne=0;ne<ie.length;ne++)if(ie[ne]&&Module.___cxa_can_catch(ie[ne],Y,re))return re=HEAP32[re>>2],U.adjusted=re,asm.setTempRet0(ie[ne]),re|0;return re=HEAP32[re>>2],asm.setTempRet0(Y),re|0}function ___cxa_throw(re,U,Y){throw EXCEPTIONS.infos[re]={ptr:re,adjusted:re,type:U,destructor:Y,refcount:0},EXCEPTIONS.last=re,"uncaught_exception"in __ZSt18uncaught_exceptionv?__ZSt18uncaught_exceptionv.uncaught_exception++:__ZSt18uncaught_exceptionv.uncaught_exception=1,re+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}Module._memset=_memset;function getShiftFromSize(re){switch(re){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+re)}}function __embind_register_bool(re,U,Y,ie,ne){var F=getShiftFromSize(Y);U=readLatin1String(U),registerType(re,{name:U,fromWireType:function(fe){return!!fe},toWireType:function(fe,pe){return pe?ie:ne},argPackAdvance:8,readValueFromPointer:function(fe){var pe;if(Y===1)pe=HEAP8;else if(Y===2)pe=HEAP16;else if(Y===4)pe=HEAP32;else throw new TypeError("Unknown boolean type size: "+U);return this.fromWireType(pe[fe>>F])},destructorFunction:null})}Module._bitshift64Shl=_bitshift64Shl;function _abort(){Module.abort()}function _free(){}Module._free=_free;function _malloc(re){var U=Runtime.dynamicAlloc(re+8);return U+8&4294967288}Module._malloc=_malloc;function simpleReadValueFromPointer(re){return this.fromWireType(HEAPU32[re>>2])}function __embind_register_std_string(re,U){U=readLatin1String(U),registerType(re,{name:U,fromWireType:function(Y){for(var ie=HEAPU32[Y>>2],ne=new Array(ie),F=0;F<ie;++F)ne[F]=String.fromCharCode(HEAPU8[Y+4+F]);return _free(Y),ne.join("")},toWireType:function(Y,ie){ie instanceof ArrayBuffer&&(ie=new Uint8Array(ie));function ne(me,Te){return me[Te]}function F(me,Te){return me.charCodeAt(Te)}var fe;ie instanceof Uint8Array||ie instanceof Int8Array?fe=ne:typeof ie=="string"?fe=F:throwBindingError("Cannot pass non-string to std::string");var pe=ie.length,Me=_malloc(4+pe);HEAPU32[Me>>2]=pe;for(var ve=0;ve<pe;++ve){var se=fe(ie,ve);se>255&&(_free(Me),throwBindingError("String has UTF-16 code units that do not fit in 8 bits")),HEAPU8[Me+4+ve]=se}return Y!==null&&Y.push(_free,Me),Me},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:function(Y){_free(Y)}})}function __embind_register_std_wstring(re,U,Y){Y=readLatin1String(Y);var ie,ne;U===2?(ie=function(){return HEAPU16},ne=1):U===4&&(ie=function(){return HEAPU32},ne=2),registerType(re,{name:Y,fromWireType:function(F){for(var fe=ie(),pe=HEAPU32[F>>2],Me=new Array(pe),ve=F+4>>ne,se=0;se<pe;++se)Me[se]=String.fromCharCode(fe[ve+se]);return _free(F),Me.join("")},toWireType:function(F,fe){var pe=ie(),Me=fe.length,ve=_malloc(4+Me*U);HEAPU32[ve>>2]=Me;for(var se=ve+4>>ne,me=0;me<Me;++me)pe[se+me]=fe.charCodeAt(me);return F!==null&&F.push(_free,ve),ve},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:function(F){_free(F)}})}function ___lock(){}function ___unlock(){}Module._i64Add=_i64Add;var _fabs=Math_abs,_sqrt=Math_sqrt;function _embind_repr(re){if(re===null)return"null";var U=typeof re;return U==="object"||U==="array"||U==="function"?re.toString():""+re}function integerReadValueFromPointer(re,U,Y){switch(U){case 0:return Y?function(ne){return HEAP8[ne]}:function(ne){return HEAPU8[ne]};case 1:return Y?function(ne){return HEAP16[ne>>1]}:function(ne){return HEAPU16[ne>>1]};case 2:return Y?function(ne){return HEAP32[ne>>2]}:function(ne){return HEAPU32[ne>>2]};default:throw new TypeError("Unknown integer type: "+re)}}function __embind_register_integer(re,U,Y,ie,ne){U=readLatin1String(U),ne===-1&&(ne=4294967295);var F=getShiftFromSize(Y),fe=function(Me){return Me};if(ie===0){var pe=32-8*Y;fe=function(Me){return Me<<pe>>>pe}}registerType(re,{name:U,fromWireType:fe,toWireType:function(Me,ve){if(typeof ve!="number"&&typeof ve!="boolean")throw new TypeError('Cannot convert "'+_embind_repr(ve)+'" to '+this.name);if(ve<ie||ve>ne)throw new TypeError('Passing a number "'+_embind_repr(ve)+'" from JS side to C/C++ side to an argument of type "'+U+'", which is outside the valid range ['+ie+", "+ne+"]!");return ve|0},argPackAdvance:8,readValueFromPointer:integerReadValueFromPointer(U,F,ie!==0),destructorFunction:null})}var emval_free_list=[],emval_handle_array=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function __emval_decref(re){re>4&&--emval_handle_array[re].refcount===0&&(emval_handle_array[re]=void 0,emval_free_list.push(re))}function count_emval_handles(){for(var re=0,U=5;U<emval_handle_array.length;++U)emval_handle_array[U]!==void 0&&++re;return re}function get_first_emval(){for(var re=5;re<emval_handle_array.length;++re)if(emval_handle_array[re]!==void 0)return emval_handle_array[re];return null}function init_emval(){Module.count_emval_handles=count_emval_handles,Module.get_first_emval=get_first_emval}function __emval_register(re){switch(re){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var U=emval_free_list.length?emval_free_list.pop():emval_handle_array.length;return emval_handle_array[U]={refcount:1,value:re},U}}}function __embind_register_emval(re,U){U=readLatin1String(U),registerType(re,{name:U,fromWireType:function(Y){var ie=emval_handle_array[Y].value;return __emval_decref(Y),ie},toWireType:function(Y,ie){return __emval_register(ie)},argPackAdvance:8,readValueFromPointer:simpleReadValueFromPointer,destructorFunction:null})}function ___cxa_allocate_exception(re){return _malloc(re)}var _sin=Math_sin;function ___setErrNo(re){return Module.___errno_location&&(HEAP32[Module.___errno_location()>>2]=re),re}var ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _sysconf(re){switch(re){case 30:return PAGE_SIZE;case 85:return totalMemory/PAGE_SIZE;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 79:return 0;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return typeof navigator=="object"&&navigator.hardwareConcurrency||1}return ___setErrNo(ERRNO_CODES.EINVAL),-1}Module._bitshift64Lshr=_bitshift64Lshr;function __exit(re){Module.exit(re)}function _exit(re){__exit(re)}function floatReadValueFromPointer(re,U){switch(U){case 2:return function(Y){return this.fromWireType(HEAPF32[Y>>2])};case 3:return function(Y){return this.fromWireType(HEAPF64[Y>>3])};default:throw new TypeError("Unknown float type: "+re)}}function __embind_register_float(re,U,Y){var ie=getShiftFromSize(Y);U=readLatin1String(U),registerType(re,{name:U,fromWireType:function(ne){return ne},toWireType:function(ne,F){if(typeof F!="number"&&typeof F!="boolean")throw new TypeError('Cannot convert "'+_embind_repr(F)+'" to '+this.name);return F},argPackAdvance:8,readValueFromPointer:floatReadValueFromPointer(U,ie),destructorFunction:null})}function _pthread_cleanup_push(re,U){__ATEXIT__.push(function(){Runtime.dynCall("vi",re,[U])}),_pthread_cleanup_push.level=__ATEXIT__.length}function new_(re,U){if(!(re instanceof Function))throw new TypeError("new_ called with constructor type "+typeof re+" which is not a function");var Y=createNamedFunction(re.name||"unknownFunctionName",function(){});Y.prototype=re.prototype;var ie=new Y,ne=re.apply(ie,U);return ne instanceof Object?ne:ie}function runDestructors(re){for(;re.length;){var U=re.pop(),Y=re.pop();Y(U)}}function craftInvokerFunction(re,U,Y,ie,ne){var F=U.length;F<2&&throwBindingError("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var fe=U[1]!==null&&Y!==null,pe="",Me="",ve=0;ve<F-2;++ve)pe+=(ve!==0?", ":"")+"arg"+ve,Me+=(ve!==0?", ":"")+"arg"+ve+"Wired";for(var se="return function "+makeLegalFunctionName(re)+"("+pe+`) {
if (arguments.length !== `+(F-2)+`) {
throwBindingError('function `+re+" called with ' + arguments.length + ' arguments, expected "+(F-2)+` args!');
}
`,me=!1,ve=1;ve<U.length;++ve)if(U[ve]!==null&&U[ve].destructorFunction===void 0){me=!0;break}me&&(se+=`var destructors = [];
`);var Te=me?"destructors":"null",Re=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],be=[throwBindingError,ie,ne,runDestructors,U[0],U[1]];fe&&(se+="var thisWired = classParam.toWireType("+Te+`, this);
`);for(var ve=0;ve<F-2;++ve)se+="var arg"+ve+"Wired = argType"+ve+".toWireType("+Te+", arg"+ve+"); // "+U[ve+2].name+`
`,Re.push("argType"+ve),be.push(U[ve+2]);fe&&(Me="thisWired"+(Me.length>0?", ":"")+Me);var Pe=U[0].name!=="void";if(se+=(Pe?"var rv = ":"")+"invoker(fn"+(Me.length>0?", ":"")+Me+`);
`,me)se+=`runDestructors(destructors);
`;else for(var ve=fe?1:2;ve<U.length;++ve){var Le=ve===1?"thisWired":"arg"+(ve-2)+"Wired";U[ve].destructorFunction!==null&&(se+=Le+"_dtor("+Le+"); // "+U[ve].name+`
`,Re.push(Le+"_dtor"),be.push(U[ve].destructorFunction))}Pe&&(se+=`var ret = retType.fromWireType(rv);
return ret;
`),se+=`}
`,Re.push(se);var xe=new_(Function,Re).apply(null,be);return xe}function ensureOverloadTable(re,U,Y){if(re[U].overloadTable===void 0){var ie=re[U];re[U]=function(){return re[U].overloadTable.hasOwnProperty(arguments.length)||throwBindingError("Function '"+Y+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+re[U].overloadTable+")!"),re[U].overloadTable[arguments.length].apply(this,arguments)},re[U].overloadTable=[],re[U].overloadTable[ie.argCount]=ie}}function exposePublicSymbol(re,U,Y){Module.hasOwnProperty(re)?((Y===void 0||Module[re].overloadTable!==void 0&&Module[re].overloadTable[Y]!==void 0)&&throwBindingError("Cannot register public name '"+re+"' twice"),ensureOverloadTable(Module,re,re),Module.hasOwnProperty(Y)&&throwBindingError("Cannot register multiple overloads of a function with the same number of arguments ("+Y+")!"),Module[re].overloadTable[Y]=U):(Module[re]=U,Y!==void 0&&(Module[re].numArguments=Y))}function heap32VectorToArray(re,U){for(var Y=[],ie=0;ie<re;ie++)Y.push(HEAP32[(U>>2)+ie]);return Y}function replacePublicSymbol(re,U,Y){Module.hasOwnProperty(re)||throwInternalError("Replacing nonexistant public symbol"),Module[re].overloadTable!==void 0&&Y!==void 0?Module[re].overloadTable[Y]=U:Module[re]=U}function requireFunction(re,U){re=readLatin1String(re);function Y(F){for(var fe=[],pe=1;pe<re.length;++pe)fe.push("a"+pe);var Me="dynCall_"+re+"_"+U,ve="return function "+Me+"("+fe.join(", ")+`) {
`;return ve+="    return dynCall(rawFunction"+(fe.length?", ":"")+fe.join(", ")+`);
`,ve+=`};
`,new Function("dynCall","rawFunction",ve)(F,U)}var ie;if(Module["FUNCTION_TABLE_"+re]!==void 0)ie=Module["FUNCTION_TABLE_"+re][U];else if(typeof FUNCTION_TABLE<"u")ie=FUNCTION_TABLE[U];else{var ne=asm["dynCall_"+re];ne===void 0&&(ne=asm["dynCall_"+re.replace(/f/g,"d")],ne===void 0&&throwBindingError("No dynCall invoker for signature: "+re)),ie=Y(ne)}return typeof ie!="function"&&throwBindingError("unknown function pointer with signature "+re+": "+U),ie}var UnboundTypeError=void 0;function getTypeName(re){var U=___getTypeName(re),Y=readLatin1String(U);return _free(U),Y}function throwUnboundTypeError(re,U){var Y=[],ie={};function ne(F){if(!ie[F]&&!registeredTypes[F]){if(typeDependencies[F]){typeDependencies[F].forEach(ne);return}Y.push(F),ie[F]=!0}}throw U.forEach(ne),new UnboundTypeError(re+": "+Y.map(getTypeName).join([", "]))}function __embind_register_function(re,U,Y,ie,ne,F){var fe=heap32VectorToArray(U,Y);re=readLatin1String(re),ne=requireFunction(ie,ne),exposePublicSymbol(re,function(){throwUnboundTypeError("Cannot call "+re+" due to unbound types",fe)},U-1),whenDependentTypesAreResolved([],fe,function(pe){var Me=[pe[0],null].concat(pe.slice(1));return replacePublicSymbol(re,craftInvokerFunction(re,Me,null,ne,F),U-1),[]})}function __embind_register_constant(re,U,Y){re=readLatin1String(re),whenDependentTypesAreResolved([],[U],function(ie){return ie=ie[0],Module[re]=ie.fromWireType(Y),[]})}function _pthread_cleanup_pop(){assert(_pthread_cleanup_push.level==__ATEXIT__.length,"cannot pop if something else added meanwhile!"),__ATEXIT__.pop(),_pthread_cleanup_push.level=__ATEXIT__.length}var ERRNO_MESSAGES={0:"Success",1:"Not super-user",2:"No such file or directory",3:"No such process",4:"Interrupted system call",5:"I/O error",6:"No such device or address",7:"Arg list too long",8:"Exec format error",9:"Bad file number",10:"No children",11:"No more processes",12:"Not enough core",13:"Permission denied",14:"Bad address",15:"Block device required",16:"Mount device busy",17:"File exists",18:"Cross-device link",19:"No such device",20:"Not a directory",21:"Is a directory",22:"Invalid argument",23:"Too many open files in system",24:"Too many open files",25:"Not a typewriter",26:"Text file busy",27:"File too large",28:"No space left on device",29:"Illegal seek",30:"Read only file system",31:"Too many links",32:"Broken pipe",33:"Math arg out of domain of func",34:"Math result not representable",35:"File locking deadlock error",36:"File or path name too long",37:"No record locks available",38:"Function not implemented",39:"Directory not empty",40:"Too many symbolic links",42:"No message of desired type",43:"Identifier removed",44:"Channel number out of range",45:"Level 2 not synchronized",46:"Level 3 halted",47:"Level 3 reset",48:"Link number out of range",49:"Protocol driver not attached",50:"No CSI structure available",51:"Level 2 halted",52:"Invalid exchange",53:"Invalid request descriptor",54:"Exchange full",55:"No anode",56:"Invalid request code",57:"Invalid slot",59:"Bad font file fmt",60:"Device not a stream",61:"No data (for no delay io)",62:"Timer expired",63:"Out of streams resources",64:"Machine is not on the network",65:"Package not installed",66:"The object is remote",67:"The link has been severed",68:"Advertise error",69:"Srmount error",70:"Communication error on send",71:"Protocol error",72:"Multihop attempted",73:"Cross mount point (not really error)",74:"Trying to read unreadable message",75:"Value too large for defined data type",76:"Given log. name not unique",77:"f.d. invalid for this operation",78:"Remote address changed",79:"Can   access a needed shared lib",80:"Accessing a corrupted shared lib",81:".lib section in a.out corrupted",82:"Attempting to link in too many libs",83:"Attempting to exec a shared library",84:"Illegal byte sequence",86:"Streams pipe error",87:"Too many users",88:"Socket operation on non-socket",89:"Destination address required",90:"Message too long",91:"Protocol wrong type for socket",92:"Protocol not available",93:"Unknown protocol",94:"Socket type not supported",95:"Not supported",96:"Protocol family not supported",97:"Address family not supported by protocol family",98:"Address already in use",99:"Address not available",100:"Network interface is not configured",101:"Network is unreachable",102:"Connection reset by network",103:"Connection aborted",104:"Connection reset by peer",105:"No buffer space available",106:"Socket is already connected",107:"Socket is not connected",108:"Can't send after socket shutdown",109:"Too many references",110:"Connection timed out",111:"Connection refused",112:"Host is down",113:"Host is unreachable",114:"Socket already connected",115:"Connection already in progress",116:"Stale file handle",122:"Quota exceeded",123:"No medium (in tape drive)",125:"Operation canceled",130:"Previous owner died",131:"State not recoverable"},PATH={splitPath:function(re){var U=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return U.exec(re).slice(1)},normalizeArray:function(re,U){for(var Y=0,ie=re.length-1;ie>=0;ie--){var ne=re[ie];ne==="."?re.splice(ie,1):ne===".."?(re.splice(ie,1),Y++):Y&&(re.splice(ie,1),Y--)}if(U)for(;Y--;Y)re.unshift("..");return re},normalize:function(re){var U=re.charAt(0)==="/",Y=re.substr(-1)==="/";return re=PATH.normalizeArray(re.split("/").filter(function(ie){return!!ie}),!U).join("/"),!re&&!U&&(re="."),re&&Y&&(re+="/"),(U?"/":"")+re},dirname:function(re){var U=PATH.splitPath(re),Y=U[0],ie=U[1];return!Y&&!ie?".":(ie&&(ie=ie.substr(0,ie.length-1)),Y+ie)},basename:function(re){if(re==="/")return"/";var U=re.lastIndexOf("/");return U===-1?re:re.substr(U+1)},extname:function(re){return PATH.splitPath(re)[3]},join:function(){var re=Array.prototype.slice.call(arguments,0);return PATH.normalize(re.join("/"))},join2:function(re,U){return PATH.normalize(re+"/"+U)},resolve:function(){for(var re="",U=!1,Y=arguments.length-1;Y>=-1&&!U;Y--){var ie=Y>=0?arguments[Y]:FS.cwd();if(typeof ie!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!ie)return"";re=ie+"/"+re,U=ie.charAt(0)==="/"}return re=PATH.normalizeArray(re.split("/").filter(function(ne){return!!ne}),!U).join("/"),(U?"/":"")+re||"."},relative:function(re,U){re=PATH.resolve(re).substr(1),U=PATH.resolve(U).substr(1);function Y(ve){for(var se=0;se<ve.length&&ve[se]==="";se++);for(var me=ve.length-1;me>=0&&ve[me]==="";me--);return se>me?[]:ve.slice(se,me-se+1)}for(var ie=Y(re.split("/")),ne=Y(U.split("/")),F=Math.min(ie.length,ne.length),fe=F,pe=0;pe<F;pe++)if(ie[pe]!==ne[pe]){fe=pe;break}for(var Me=[],pe=fe;pe<ie.length;pe++)Me.push("..");return Me=Me.concat(ne.slice(fe)),Me.join("/")}},TTY={ttys:[],init:function(){},shutdown:function(){},register:function(re,U){TTY.ttys[re]={input:[],output:[],ops:U},FS.registerDevice(re,TTY.stream_ops)},stream_ops:{open:function(re){var U=TTY.ttys[re.node.rdev];if(!U)throw new FS.ErrnoError(ERRNO_CODES.ENODEV);re.tty=U,re.seekable=!1},close:function(re){re.tty.ops.flush(re.tty)},flush:function(re){re.tty.ops.flush(re.tty)},read:function(re,U,Y,ie,ne){if(!re.tty||!re.tty.ops.get_char)throw new FS.ErrnoError(ERRNO_CODES.ENXIO);for(var F=0,fe=0;fe<ie;fe++){var pe;try{pe=re.tty.ops.get_char(re.tty)}catch{throw new FS.ErrnoError(ERRNO_CODES.EIO)}if(pe===void 0&&F===0)throw new FS.ErrnoError(ERRNO_CODES.EAGAIN);if(pe==null)break;F++,U[Y+fe]=pe}return F&&(re.node.timestamp=Date.now()),F},write:function(re,U,Y,ie,ne){if(!re.tty||!re.tty.ops.put_char)throw new FS.ErrnoError(ERRNO_CODES.ENXIO);for(var F=0;F<ie;F++)try{re.tty.ops.put_char(re.tty,U[Y+F])}catch{throw new FS.ErrnoError(ERRNO_CODES.EIO)}return ie&&(re.node.timestamp=Date.now()),F}},default_tty_ops:{get_char:function(re){if(!re.input.length){var U=null;if(ENVIRONMENT_IS_NODE){var Y=256,ie=new Buffer(Y),ne=0,F=process.stdin.fd,fe=!1;try{F=fs.openSync("/dev/stdin","r"),fe=!0}catch{}ne=fs.readSync(F,ie,0,Y,null),fe&&fs.closeSync(F),ne>0?U=ie.slice(0,ne).toString("utf-8"):U=null}else typeof window<"u"&&typeof window.prompt=="function"?(U=window.prompt("Input: "),U!==null&&(U+=`
`)):typeof readline=="function"&&(U=readline(),U!==null&&(U+=`
`));if(!U)return null;re.input=intArrayFromString(U,!0)}return re.input.shift()},put_char:function(re,U){U===null||U===10?(Module.print(UTF8ArrayToString(re.output,0)),re.output=[]):U!=0&&re.output.push(U)},flush:function(re){re.output&&re.output.length>0&&(Module.print(UTF8ArrayToString(re.output,0)),re.output=[])}},default_tty1_ops:{put_char:function(re,U){U===null||U===10?(Module.printErr(UTF8ArrayToString(re.output,0)),re.output=[]):U!=0&&re.output.push(U)},flush:function(re){re.output&&re.output.length>0&&(Module.printErr(UTF8ArrayToString(re.output,0)),re.output=[])}}},MEMFS={ops_table:null,mount:function(re){return MEMFS.createNode(null,"/",16895,0)},createNode:function(re,U,Y,ie){if(FS.isBlkdev(Y)||FS.isFIFO(Y))throw new FS.ErrnoError(ERRNO_CODES.EPERM);MEMFS.ops_table||(MEMFS.ops_table={dir:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr,lookup:MEMFS.node_ops.lookup,mknod:MEMFS.node_ops.mknod,rename:MEMFS.node_ops.rename,unlink:MEMFS.node_ops.unlink,rmdir:MEMFS.node_ops.rmdir,readdir:MEMFS.node_ops.readdir,symlink:MEMFS.node_ops.symlink},stream:{llseek:MEMFS.stream_ops.llseek}},file:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr},stream:{llseek:MEMFS.stream_ops.llseek,read:MEMFS.stream_ops.read,write:MEMFS.stream_ops.write,allocate:MEMFS.stream_ops.allocate,mmap:MEMFS.stream_ops.mmap,msync:MEMFS.stream_ops.msync}},link:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr,readlink:MEMFS.node_ops.readlink},stream:{}},chrdev:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr},stream:FS.chrdev_stream_ops}});var ne=FS.createNode(re,U,Y,ie);return FS.isDir(ne.mode)?(ne.node_ops=MEMFS.ops_table.dir.node,ne.stream_ops=MEMFS.ops_table.dir.stream,ne.contents={}):FS.isFile(ne.mode)?(ne.node_ops=MEMFS.ops_table.file.node,ne.stream_ops=MEMFS.ops_table.file.stream,ne.usedBytes=0,ne.contents=null):FS.isLink(ne.mode)?(ne.node_ops=MEMFS.ops_table.link.node,ne.stream_ops=MEMFS.ops_table.link.stream):FS.isChrdev(ne.mode)&&(ne.node_ops=MEMFS.ops_table.chrdev.node,ne.stream_ops=MEMFS.ops_table.chrdev.stream),ne.timestamp=Date.now(),re&&(re.contents[U]=ne),ne},getFileDataAsRegularArray:function(re){if(re.contents&&re.contents.subarray){for(var U=[],Y=0;Y<re.usedBytes;++Y)U.push(re.contents[Y]);return U}return re.contents},getFileDataAsTypedArray:function(re){return re.contents?re.contents.subarray?re.contents.subarray(0,re.usedBytes):new Uint8Array(re.contents):new Uint8Array},expandFileStorage:function(re,U){if(re.contents&&re.contents.subarray&&U>re.contents.length&&(re.contents=MEMFS.getFileDataAsRegularArray(re),re.usedBytes=re.contents.length),!re.contents||re.contents.subarray){var Y=re.contents?re.contents.buffer.byteLength:0;if(Y>=U)return;var ie=1024*1024;U=Math.max(U,Y*(Y<ie?2:1.125)|0),Y!=0&&(U=Math.max(U,256));var ne=re.contents;re.contents=new Uint8Array(U),re.usedBytes>0&&re.contents.set(ne.subarray(0,re.usedBytes),0);return}for(!re.contents&&U>0&&(re.contents=[]);re.contents.length<U;)re.contents.push(0)},resizeFileStorage:function(re,U){if(re.usedBytes!=U){if(U==0){re.contents=null,re.usedBytes=0;return}if(!re.contents||re.contents.subarray){var Y=re.contents;re.contents=new Uint8Array(new ArrayBuffer(U)),Y&&re.contents.set(Y.subarray(0,Math.min(U,re.usedBytes))),re.usedBytes=U;return}if(re.contents||(re.contents=[]),re.contents.length>U)re.contents.length=U;else for(;re.contents.length<U;)re.contents.push(0);re.usedBytes=U}},node_ops:{getattr:function(re){var U={};return U.dev=FS.isChrdev(re.mode)?re.id:1,U.ino=re.id,U.mode=re.mode,U.nlink=1,U.uid=0,U.gid=0,U.rdev=re.rdev,FS.isDir(re.mode)?U.size=4096:FS.isFile(re.mode)?U.size=re.usedBytes:FS.isLink(re.mode)?U.size=re.link.length:U.size=0,U.atime=new Date(re.timestamp),U.mtime=new Date(re.timestamp),U.ctime=new Date(re.timestamp),U.blksize=4096,U.blocks=Math.ceil(U.size/U.blksize),U},setattr:function(re,U){U.mode!==void 0&&(re.mode=U.mode),U.timestamp!==void 0&&(re.timestamp=U.timestamp),U.size!==void 0&&MEMFS.resizeFileStorage(re,U.size)},lookup:function(re,U){throw FS.genericErrors[ERRNO_CODES.ENOENT]},mknod:function(re,U,Y,ie){return MEMFS.createNode(re,U,Y,ie)},rename:function(re,U,Y){if(FS.isDir(re.mode)){var ie;try{ie=FS.lookupNode(U,Y)}catch{}if(ie)for(var ne in ie.contents)throw new FS.ErrnoError(ERRNO_CODES.ENOTEMPTY)}delete re.parent.contents[re.name],re.name=Y,U.contents[Y]=re,re.parent=U},unlink:function(re,U){delete re.contents[U]},rmdir:function(re,U){var Y=FS.lookupNode(re,U);for(var ie in Y.contents)throw new FS.ErrnoError(ERRNO_CODES.ENOTEMPTY);delete re.contents[U]},readdir:function(re){var U=[".",".."];for(var Y in re.contents)re.contents.hasOwnProperty(Y)&&U.push(Y);return U},symlink:function(re,U,Y){var ie=MEMFS.createNode(re,U,41471,0);return ie.link=Y,ie},readlink:function(re){if(!FS.isLink(re.mode))throw new FS.ErrnoError(ERRNO_CODES.EINVAL);return re.link}},stream_ops:{read:function(re,U,Y,ie,ne){var F=re.node.contents;if(ne>=re.node.usedBytes)return 0;var fe=Math.min(re.node.usedBytes-ne,ie);if(assert(fe>=0),fe>8&&F.subarray)U.set(F.subarray(ne,ne+fe),Y);else for(var pe=0;pe<fe;pe++)U[Y+pe]=F[ne+pe];return fe},write:function(re,U,Y,ie,ne,F){if(!ie)return 0;var fe=re.node;if(fe.timestamp=Date.now(),U.subarray&&(!fe.contents||fe.contents.subarray)){if(F)return fe.contents=U.subarray(Y,Y+ie),fe.usedBytes=ie,ie;if(fe.usedBytes===0&&ne===0)return fe.contents=new Uint8Array(U.subarray(Y,Y+ie)),fe.usedBytes=ie,ie;if(ne+ie<=fe.usedBytes)return fe.contents.set(U.subarray(Y,Y+ie),ne),ie}if(MEMFS.expandFileStorage(fe,ne+ie),fe.contents.subarray&&U.subarray)fe.contents.set(U.subarray(Y,Y+ie),ne);else for(var pe=0;pe<ie;pe++)fe.contents[ne+pe]=U[Y+pe];return fe.usedBytes=Math.max(fe.usedBytes,ne+ie),ie},llseek:function(re,U,Y){var ie=U;if(Y===1?ie+=re.position:Y===2&&FS.isFile(re.node.mode)&&(ie+=re.node.usedBytes),ie<0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);return ie},allocate:function(re,U,Y){MEMFS.expandFileStorage(re.node,U+Y),re.node.usedBytes=Math.max(re.node.usedBytes,U+Y)},mmap:function(re,U,Y,ie,ne,F,fe){if(!FS.isFile(re.node.mode))throw new FS.ErrnoError(ERRNO_CODES.ENODEV);var pe,Me,ve=re.node.contents;if(!(fe&2)&&(ve.buffer===U||ve.buffer===U.buffer))Me=!1,pe=ve.byteOffset;else{if((ne>0||ne+ie<re.node.usedBytes)&&(ve.subarray?ve=ve.subarray(ne,ne+ie):ve=Array.prototype.slice.call(ve,ne,ne+ie)),Me=!0,pe=_malloc(ie),!pe)throw new FS.ErrnoError(ERRNO_CODES.ENOMEM);U.set(ve,pe)}return{ptr:pe,allocated:Me}},msync:function(re,U,Y,ie,ne){if(!FS.isFile(re.node.mode))throw new FS.ErrnoError(ERRNO_CODES.ENODEV);return ne&2||MEMFS.stream_ops.write(re,U,0,ie,Y,!1),0}}},IDBFS={dbs:{},indexedDB:function(){if(typeof indexedDB<"u")return indexedDB;var re=null;return typeof window=="object"&&(re=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),assert(re,"IDBFS used, but indexedDB not supported"),re},DB_VERSION:21,DB_STORE_NAME:"FILE_DATA",mount:function(re){return MEMFS.mount.apply(null,arguments)},syncfs:function(re,U,Y){IDBFS.getLocalSet(re,function(ie,ne){if(ie)return Y(ie);IDBFS.getRemoteSet(re,function(F,fe){if(F)return Y(F);var pe=U?fe:ne,Me=U?ne:fe;IDBFS.reconcile(pe,Me,Y)})})},getDB:function(re,U){var Y=IDBFS.dbs[re];if(Y)return U(null,Y);var ie;try{ie=IDBFS.indexedDB().open(re,IDBFS.DB_VERSION)}catch(ne){return U(ne)}ie.onupgradeneeded=function(ne){var F=ne.target.result,fe=ne.target.transaction,pe;F.objectStoreNames.contains(IDBFS.DB_STORE_NAME)?pe=fe.objectStore(IDBFS.DB_STORE_NAME):pe=F.createObjectStore(IDBFS.DB_STORE_NAME),pe.indexNames.contains("timestamp")||pe.createIndex("timestamp","timestamp",{unique:!1})},ie.onsuccess=function(){Y=ie.result,IDBFS.dbs[re]=Y,U(null,Y)},ie.onerror=function(ne){U(this.error),ne.preventDefault()}},getLocalSet:function(re,U){var Y={};function ie(Me){return Me!=="."&&Me!==".."}function ne(Me){return function(ve){return PATH.join2(Me,ve)}}for(var F=FS.readdir(re.mountpoint).filter(ie).map(ne(re.mountpoint));F.length;){var fe=F.pop(),pe;try{pe=FS.stat(fe)}catch(Me){return U(Me)}FS.isDir(pe.mode)&&F.push.apply(F,FS.readdir(fe).filter(ie).map(ne(fe))),Y[fe]={timestamp:pe.mtime}}return U(null,{type:"local",entries:Y})},getRemoteSet:function(re,U){var Y={};IDBFS.getDB(re.mountpoint,function(ie,ne){if(ie)return U(ie);var F=ne.transaction([IDBFS.DB_STORE_NAME],"readonly");F.onerror=function(Me){U(this.error),Me.preventDefault()};var fe=F.objectStore(IDBFS.DB_STORE_NAME),pe=fe.index("timestamp");pe.openKeyCursor().onsuccess=function(Me){var ve=Me.target.result;if(!ve)return U(null,{type:"remote",db:ne,entries:Y});Y[ve.primaryKey]={timestamp:ve.key},ve.continue()}})},loadLocalEntry:function(re,U){var Y,ie;try{var ne=FS.lookupPath(re);ie=ne.node,Y=FS.stat(re)}catch(F){return U(F)}return FS.isDir(Y.mode)?U(null,{timestamp:Y.mtime,mode:Y.mode}):FS.isFile(Y.mode)?(ie.contents=MEMFS.getFileDataAsTypedArray(ie),U(null,{timestamp:Y.mtime,mode:Y.mode,contents:ie.contents})):U(new Error("node type not supported"))},storeLocalEntry:function(re,U,Y){try{if(FS.isDir(U.mode))FS.mkdir(re,U.mode);else if(FS.isFile(U.mode))FS.writeFile(re,U.contents,{encoding:"binary",canOwn:!0});else return Y(new Error("node type not supported"));FS.chmod(re,U.mode),FS.utime(re,U.timestamp,U.timestamp)}catch(ie){return Y(ie)}Y(null)},removeLocalEntry:function(re,U){try{var Y=FS.lookupPath(re),ie=FS.stat(re);FS.isDir(ie.mode)?FS.rmdir(re):FS.isFile(ie.mode)&&FS.unlink(re)}catch(ne){return U(ne)}U(null)},loadRemoteEntry:function(re,U,Y){var ie=re.get(U);ie.onsuccess=function(ne){Y(null,ne.target.result)},ie.onerror=function(ne){Y(this.error),ne.preventDefault()}},storeRemoteEntry:function(re,U,Y,ie){var ne=re.put(Y,U);ne.onsuccess=function(){ie(null)},ne.onerror=function(F){ie(this.error),F.preventDefault()}},removeRemoteEntry:function(re,U,Y){var ie=re.delete(U);ie.onsuccess=function(){Y(null)},ie.onerror=function(ne){Y(this.error),ne.preventDefault()}},reconcile:function(re,U,Y){var ie=0,ne=[];Object.keys(re.entries).forEach(function(me){var Te=re.entries[me],Re=U.entries[me];(!Re||Te.timestamp>Re.timestamp)&&(ne.push(me),ie++)});var F=[];if(Object.keys(U.entries).forEach(function(me){U.entries[me];var Te=re.entries[me];Te||(F.push(me),ie++)}),!ie)return Y(null);var fe=0,pe=re.type==="remote"?re.db:U.db,Me=pe.transaction([IDBFS.DB_STORE_NAME],"readwrite"),ve=Me.objectStore(IDBFS.DB_STORE_NAME);function se(me){if(me)return se.errored?void 0:(se.errored=!0,Y(me));if(++fe>=ie)return Y(null)}Me.onerror=function(me){se(this.error),me.preventDefault()},ne.sort().forEach(function(me){U.type==="local"?IDBFS.loadRemoteEntry(ve,me,function(Te,Re){if(Te)return se(Te);IDBFS.storeLocalEntry(me,Re,se)}):IDBFS.loadLocalEntry(me,function(Te,Re){if(Te)return se(Te);IDBFS.storeRemoteEntry(ve,me,Re,se)})}),F.sort().reverse().forEach(function(me){U.type==="local"?IDBFS.removeLocalEntry(me,se):IDBFS.removeRemoteEntry(ve,me,se)})}},NODEFS={isWindows:!1,staticInit:function(){NODEFS.isWindows=!!process.platform.match(/^win/)},mount:function(re){return assert(ENVIRONMENT_IS_NODE),NODEFS.createNode(null,"/",NODEFS.getMode(re.opts.root),0)},createNode:function(re,U,Y,ie){if(!FS.isDir(Y)&&!FS.isFile(Y)&&!FS.isLink(Y))throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var ne=FS.createNode(re,U,Y);return ne.node_ops=NODEFS.node_ops,ne.stream_ops=NODEFS.stream_ops,ne},getMode:function(re){var U;try{U=fs.lstatSync(re),NODEFS.isWindows&&(U.mode=U.mode|(U.mode&146)>>1)}catch(Y){throw Y.code?new FS.ErrnoError(ERRNO_CODES[Y.code]):Y}return U.mode},realPath:function(re){for(var U=[];re.parent!==re;)U.push(re.name),re=re.parent;return U.push(re.mount.opts.root),U.reverse(),PATH.join.apply(null,U)},flagsToPermissionStringMap:{0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},flagsToPermissionString:function(re){if(re&=-32769,re in NODEFS.flagsToPermissionStringMap)return NODEFS.flagsToPermissionStringMap[re];throw new FS.ErrnoError(ERRNO_CODES.EINVAL)},node_ops:{getattr:function(re){var U=NODEFS.realPath(re),Y;try{Y=fs.lstatSync(U)}catch(ie){throw ie.code?new FS.ErrnoError(ERRNO_CODES[ie.code]):ie}return NODEFS.isWindows&&!Y.blksize&&(Y.blksize=4096),NODEFS.isWindows&&!Y.blocks&&(Y.blocks=(Y.size+Y.blksize-1)/Y.blksize|0),{dev:Y.dev,ino:Y.ino,mode:Y.mode,nlink:Y.nlink,uid:Y.uid,gid:Y.gid,rdev:Y.rdev,size:Y.size,atime:Y.atime,mtime:Y.mtime,ctime:Y.ctime,blksize:Y.blksize,blocks:Y.blocks}},setattr:function(re,U){var Y=NODEFS.realPath(re);try{if(U.mode!==void 0&&(fs.chmodSync(Y,U.mode),re.mode=U.mode),U.timestamp!==void 0){var ie=new Date(U.timestamp);fs.utimesSync(Y,ie,ie)}U.size!==void 0&&fs.truncateSync(Y,U.size)}catch(ne){throw ne.code?new FS.ErrnoError(ERRNO_CODES[ne.code]):ne}},lookup:function(re,U){var Y=PATH.join2(NODEFS.realPath(re),U),ie=NODEFS.getMode(Y);return NODEFS.createNode(re,U,ie)},mknod:function(re,U,Y,ie){var ne=NODEFS.createNode(re,U,Y,ie),F=NODEFS.realPath(ne);try{FS.isDir(ne.mode)?fs.mkdirSync(F,ne.mode):fs.writeFileSync(F,"",{mode:ne.mode})}catch(fe){throw fe.code?new FS.ErrnoError(ERRNO_CODES[fe.code]):fe}return ne},rename:function(re,U,Y){var ie=NODEFS.realPath(re),ne=PATH.join2(NODEFS.realPath(U),Y);try{fs.renameSync(ie,ne)}catch(F){throw F.code?new FS.ErrnoError(ERRNO_CODES[F.code]):F}},unlink:function(re,U){var Y=PATH.join2(NODEFS.realPath(re),U);try{fs.unlinkSync(Y)}catch(ie){throw ie.code?new FS.ErrnoError(ERRNO_CODES[ie.code]):ie}},rmdir:function(re,U){var Y=PATH.join2(NODEFS.realPath(re),U);try{fs.rmdirSync(Y)}catch(ie){throw ie.code?new FS.ErrnoError(ERRNO_CODES[ie.code]):ie}},readdir:function(re){var U=NODEFS.realPath(re);try{return fs.readdirSync(U)}catch(Y){throw Y.code?new FS.ErrnoError(ERRNO_CODES[Y.code]):Y}},symlink:function(re,U,Y){var ie=PATH.join2(NODEFS.realPath(re),U);try{fs.symlinkSync(Y,ie)}catch(ne){throw ne.code?new FS.ErrnoError(ERRNO_CODES[ne.code]):ne}},readlink:function(re){var U=NODEFS.realPath(re);try{return U=fs.readlinkSync(U),U=NODEJS_PATH.relative(NODEJS_PATH.resolve(re.mount.opts.root),U),U}catch(Y){throw Y.code?new FS.ErrnoError(ERRNO_CODES[Y.code]):Y}}},stream_ops:{open:function(re){var U=NODEFS.realPath(re.node);try{FS.isFile(re.node.mode)&&(re.nfd=fs.openSync(U,NODEFS.flagsToPermissionString(re.flags)))}catch(Y){throw Y.code?new FS.ErrnoError(ERRNO_CODES[Y.code]):Y}},close:function(re){try{FS.isFile(re.node.mode)&&re.nfd&&fs.closeSync(re.nfd)}catch(U){throw U.code?new FS.ErrnoError(ERRNO_CODES[U.code]):U}},read:function(re,U,Y,ie,ne){if(ie===0)return 0;var F=new Buffer(ie),fe;try{fe=fs.readSync(re.nfd,F,0,ie,ne)}catch(Me){throw new FS.ErrnoError(ERRNO_CODES[Me.code])}if(fe>0)for(var pe=0;pe<fe;pe++)U[Y+pe]=F[pe];return fe},write:function(re,U,Y,ie,ne){var F=new Buffer(U.subarray(Y,Y+ie)),fe;try{fe=fs.writeSync(re.nfd,F,0,ie,ne)}catch(pe){throw new FS.ErrnoError(ERRNO_CODES[pe.code])}return fe},llseek:function(re,U,Y){var ie=U;if(Y===1)ie+=re.position;else if(Y===2&&FS.isFile(re.node.mode))try{var ne=fs.fstatSync(re.nfd);ie+=ne.size}catch(F){throw new FS.ErrnoError(ERRNO_CODES[F.code])}if(ie<0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);return ie}}},WORKERFS={DIR_MODE:16895,FILE_MODE:33279,reader:null,mount:function(re){assert(ENVIRONMENT_IS_WORKER),WORKERFS.reader||(WORKERFS.reader=new FileReaderSync);var U=WORKERFS.createNode(null,"/",WORKERFS.DIR_MODE,0),Y={};function ie(F){for(var fe=F.split("/"),pe=U,Me=0;Me<fe.length-1;Me++){var ve=fe.slice(0,Me+1).join("/");Y[ve]||(Y[ve]=WORKERFS.createNode(pe,ve,WORKERFS.DIR_MODE,0)),pe=Y[ve]}return pe}function ne(F){var fe=F.split("/");return fe[fe.length-1]}return Array.prototype.forEach.call(re.opts.files||[],function(F){WORKERFS.createNode(ie(F.name),ne(F.name),WORKERFS.FILE_MODE,0,F,F.lastModifiedDate)}),(re.opts.blobs||[]).forEach(function(F){WORKERFS.createNode(ie(F.name),ne(F.name),WORKERFS.FILE_MODE,0,F.data)}),(re.opts.packages||[]).forEach(function(F){F.metadata.files.forEach(function(fe){var pe=fe.filename.substr(1);WORKERFS.createNode(ie(pe),ne(pe),WORKERFS.FILE_MODE,0,F.blob.slice(fe.start,fe.end))})}),U},createNode:function(re,U,Y,ie,ne,F){var fe=FS.createNode(re,U,Y);return fe.mode=Y,fe.node_ops=WORKERFS.node_ops,fe.stream_ops=WORKERFS.stream_ops,fe.timestamp=(F||new Date).getTime(),assert(WORKERFS.FILE_MODE!==WORKERFS.DIR_MODE),Y===WORKERFS.FILE_MODE?(fe.size=ne.size,fe.contents=ne):(fe.size=4096,fe.contents={}),re&&(re.contents[U]=fe),fe},node_ops:{getattr:function(re){return{dev:1,ino:void 0,mode:re.mode,nlink:1,uid:0,gid:0,rdev:void 0,size:re.size,atime:new Date(re.timestamp),mtime:new Date(re.timestamp),ctime:new Date(re.timestamp),blksize:4096,blocks:Math.ceil(re.size/4096)}},setattr:function(re,U){U.mode!==void 0&&(re.mode=U.mode),U.timestamp!==void 0&&(re.timestamp=U.timestamp)},lookup:function(re,U){throw new FS.ErrnoError(ERRNO_CODES.ENOENT)},mknod:function(re,U,Y,ie){throw new FS.ErrnoError(ERRNO_CODES.EPERM)},rename:function(re,U,Y){throw new FS.ErrnoError(ERRNO_CODES.EPERM)},unlink:function(re,U){throw new FS.ErrnoError(ERRNO_CODES.EPERM)},rmdir:function(re,U){throw new FS.ErrnoError(ERRNO_CODES.EPERM)},readdir:function(re){throw new FS.ErrnoError(ERRNO_CODES.EPERM)},symlink:function(re,U,Y){throw new FS.ErrnoError(ERRNO_CODES.EPERM)},readlink:function(re){throw new FS.ErrnoError(ERRNO_CODES.EPERM)}},stream_ops:{read:function(re,U,Y,ie,ne){if(ne>=re.node.size)return 0;var F=re.node.contents.slice(ne,ne+ie),fe=WORKERFS.reader.readAsArrayBuffer(F);return U.set(new Uint8Array(fe),Y),F.size},write:function(re,U,Y,ie,ne){throw new FS.ErrnoError(ERRNO_CODES.EIO)},llseek:function(re,U,Y){var ie=U;if(Y===1?ie+=re.position:Y===2&&FS.isFile(re.node.mode)&&(ie+=re.node.size),ie<0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);return ie}}};allocate(1,"i32*",ALLOC_STATIC),allocate(1,"i32*",ALLOC_STATIC),allocate(1,"i32*",ALLOC_STATIC);var FS={root:null,mounts:[],devices:[null],streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,handleFSError:function(re){if(!(re instanceof FS.ErrnoError))throw re+" : "+stackTrace();return ___setErrNo(re.errno)},lookupPath:function(re,U){if(re=PATH.resolve(FS.cwd(),re),U=U||{},!re)return{path:"",node:null};var Y={follow_mount:!0,recurse_count:0};for(var ie in Y)U[ie]===void 0&&(U[ie]=Y[ie]);if(U.recurse_count>8)throw new FS.ErrnoError(ERRNO_CODES.ELOOP);for(var ne=PATH.normalizeArray(re.split("/").filter(function(Te){return!!Te}),!1),F=FS.root,fe="/",pe=0;pe<ne.length;pe++){var Me=pe===ne.length-1;if(Me&&U.parent)break;if(F=FS.lookupNode(F,ne[pe]),fe=PATH.join2(fe,ne[pe]),FS.isMountpoint(F)&&(!Me||Me&&U.follow_mount)&&(F=F.mounted.root),!Me||U.follow)for(var ve=0;FS.isLink(F.mode);){var se=FS.readlink(fe);fe=PATH.resolve(PATH.dirname(fe),se);var me=FS.lookupPath(fe,{recurse_count:U.recurse_count});if(F=me.node,ve++>40)throw new FS.ErrnoError(ERRNO_CODES.ELOOP)}}return{path:fe,node:F}},getPath:function(re){for(var U;;){if(FS.isRoot(re)){var Y=re.mount.mountpoint;return U?Y[Y.length-1]!=="/"?Y+"/"+U:Y+U:Y}U=U?re.name+"/"+U:re.name,re=re.parent}},hashName:function(re,U){for(var Y=0,ie=0;ie<U.length;ie++)Y=(Y<<5)-Y+U.charCodeAt(ie)|0;return(re+Y>>>0)%FS.nameTable.length},hashAddNode:function(re){var U=FS.hashName(re.parent.id,re.name);re.name_next=FS.nameTable[U],FS.nameTable[U]=re},hashRemoveNode:function(re){var U=FS.hashName(re.parent.id,re.name);if(FS.nameTable[U]===re)FS.nameTable[U]=re.name_next;else for(var Y=FS.nameTable[U];Y;){if(Y.name_next===re){Y.name_next=re.name_next;break}Y=Y.name_next}},lookupNode:function(re,U){var Y=FS.mayLookup(re);if(Y)throw new FS.ErrnoError(Y,re);for(var ie=FS.hashName(re.id,U),ne=FS.nameTable[ie];ne;ne=ne.name_next){var F=ne.name;if(ne.parent.id===re.id&&F===U)return ne}return FS.lookup(re,U)},createNode:function(re,U,Y,ie){if(!FS.FSNode){FS.FSNode=function(pe,Me,ve,se){pe||(pe=this),this.parent=pe,this.mount=pe.mount,this.mounted=null,this.id=FS.nextInode++,this.name=Me,this.mode=ve,this.node_ops={},this.stream_ops={},this.rdev=se},FS.FSNode.prototype={};var ne=365,F=146;Object.defineProperties(FS.FSNode.prototype,{read:{get:function(){return(this.mode&ne)===ne},set:function(pe){pe?this.mode|=ne:this.mode&=~ne}},write:{get:function(){return(this.mode&F)===F},set:function(pe){pe?this.mode|=F:this.mode&=~F}},isFolder:{get:function(){return FS.isDir(this.mode)}},isDevice:{get:function(){return FS.isChrdev(this.mode)}}})}var fe=new FS.FSNode(re,U,Y,ie);return FS.hashAddNode(fe),fe},destroyNode:function(re){FS.hashRemoveNode(re)},isRoot:function(re){return re===re.parent},isMountpoint:function(re){return!!re.mounted},isFile:function(re){return(re&61440)===32768},isDir:function(re){return(re&61440)===16384},isLink:function(re){return(re&61440)===40960},isChrdev:function(re){return(re&61440)===8192},isBlkdev:function(re){return(re&61440)===24576},isFIFO:function(re){return(re&61440)===4096},isSocket:function(re){return(re&49152)===49152},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(re){var U=FS.flagModes[re];if(typeof U>"u")throw new Error("Unknown file open mode: "+re);return U},flagsToPermissionString:function(re){var U=["r","w","rw"][re&3];return re&512&&(U+="w"),U},nodePermissions:function(re,U){return FS.ignorePermissions?0:U.indexOf("r")!==-1&&!(re.mode&292)||U.indexOf("w")!==-1&&!(re.mode&146)||U.indexOf("x")!==-1&&!(re.mode&73)?ERRNO_CODES.EACCES:0},mayLookup:function(re){var U=FS.nodePermissions(re,"x");return U||(re.node_ops.lookup?0:ERRNO_CODES.EACCES)},mayCreate:function(re,U){try{var Y=FS.lookupNode(re,U);return ERRNO_CODES.EEXIST}catch{}return FS.nodePermissions(re,"wx")},mayDelete:function(re,U,Y){var ie;try{ie=FS.lookupNode(re,U)}catch(F){return F.errno}var ne=FS.nodePermissions(re,"wx");if(ne)return ne;if(Y){if(!FS.isDir(ie.mode))return ERRNO_CODES.ENOTDIR;if(FS.isRoot(ie)||FS.getPath(ie)===FS.cwd())return ERRNO_CODES.EBUSY}else if(FS.isDir(ie.mode))return ERRNO_CODES.EISDIR;return 0},mayOpen:function(re,U){return re?FS.isLink(re.mode)?ERRNO_CODES.ELOOP:FS.isDir(re.mode)&&(U&2097155||U&512)?ERRNO_CODES.EISDIR:FS.nodePermissions(re,FS.flagsToPermissionString(U)):ERRNO_CODES.ENOENT},MAX_OPEN_FDS:4096,nextfd:function(re,U){re=re||0,U=U||FS.MAX_OPEN_FDS;for(var Y=re;Y<=U;Y++)if(!FS.streams[Y])return Y;throw new FS.ErrnoError(ERRNO_CODES.EMFILE)},getStream:function(re){return FS.streams[re]},createStream:function(re,U,Y){FS.FSStream||(FS.FSStream=function(){},FS.FSStream.prototype={},Object.defineProperties(FS.FSStream.prototype,{object:{get:function(){return this.node},set:function(fe){this.node=fe}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}}}));var ie=new FS.FSStream;for(var ne in re)ie[ne]=re[ne];re=ie;var F=FS.nextfd(U,Y);return re.fd=F,FS.streams[F]=re,re},closeStream:function(re){FS.streams[re]=null},chrdev_stream_ops:{open:function(re){var U=FS.getDevice(re.node.rdev);re.stream_ops=U.stream_ops,re.stream_ops.open&&re.stream_ops.open(re)},llseek:function(){throw new FS.ErrnoError(ERRNO_CODES.ESPIPE)}},major:function(re){return re>>8},minor:function(re){return re&255},makedev:function(re,U){return re<<8|U},registerDevice:function(re,U){FS.devices[re]={stream_ops:U}},getDevice:function(re){return FS.devices[re]},getMounts:function(re){for(var U=[],Y=[re];Y.length;){var ie=Y.pop();U.push(ie),Y.push.apply(Y,ie.mounts)}return U},syncfs:function(re,U){typeof re=="function"&&(U=re,re=!1);var Y=FS.getMounts(FS.root.mount),ie=0;function ne(F){if(F)return ne.errored?void 0:(ne.errored=!0,U(F));++ie>=Y.length&&U(null)}Y.forEach(function(F){if(!F.type.syncfs)return ne(null);F.type.syncfs(F,re,ne)})},mount:function(re,U,Y){var ie=Y==="/",ne=!Y,F;if(ie&&FS.root)throw new FS.ErrnoError(ERRNO_CODES.EBUSY);if(!ie&&!ne){var fe=FS.lookupPath(Y,{follow_mount:!1});if(Y=fe.path,F=fe.node,FS.isMountpoint(F))throw new FS.ErrnoError(ERRNO_CODES.EBUSY);if(!FS.isDir(F.mode))throw new FS.ErrnoError(ERRNO_CODES.ENOTDIR)}var pe={type:re,opts:U,mountpoint:Y,mounts:[]},Me=re.mount(pe);return Me.mount=pe,pe.root=Me,ie?FS.root=Me:F&&(F.mounted=pe,F.mount&&F.mount.mounts.push(pe)),Me},unmount:function(re){var U=FS.lookupPath(re,{follow_mount:!1});if(!FS.isMountpoint(U.node))throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var Y=U.node,ie=Y.mounted,ne=FS.getMounts(ie);Object.keys(FS.nameTable).forEach(function(fe){for(var pe=FS.nameTable[fe];pe;){var Me=pe.name_next;ne.indexOf(pe.mount)!==-1&&FS.destroyNode(pe),pe=Me}}),Y.mounted=null;var F=Y.mount.mounts.indexOf(ie);assert(F!==-1),Y.mount.mounts.splice(F,1)},lookup:function(re,U){return re.node_ops.lookup(re,U)},mknod:function(re,U,Y){var ie=FS.lookupPath(re,{parent:!0}),ne=ie.node,F=PATH.basename(re);if(!F||F==="."||F==="..")throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var fe=FS.mayCreate(ne,F);if(fe)throw new FS.ErrnoError(fe);if(!ne.node_ops.mknod)throw new FS.ErrnoError(ERRNO_CODES.EPERM);return ne.node_ops.mknod(ne,F,U,Y)},create:function(re,U){return U=U!==void 0?U:438,U&=4095,U|=32768,FS.mknod(re,U,0)},mkdir:function(re,U){return U=U!==void 0?U:511,U&=1023,U|=16384,FS.mknod(re,U,0)},mkdev:function(re,U,Y){return typeof Y>"u"&&(Y=U,U=438),U|=8192,FS.mknod(re,U,Y)},symlink:function(re,U){if(!PATH.resolve(re))throw new FS.ErrnoError(ERRNO_CODES.ENOENT);var Y=FS.lookupPath(U,{parent:!0}),ie=Y.node;if(!ie)throw new FS.ErrnoError(ERRNO_CODES.ENOENT);var ne=PATH.basename(U),F=FS.mayCreate(ie,ne);if(F)throw new FS.ErrnoError(F);if(!ie.node_ops.symlink)throw new FS.ErrnoError(ERRNO_CODES.EPERM);return ie.node_ops.symlink(ie,ne,re)},rename:function(re,U){var Y=PATH.dirname(re),ie=PATH.dirname(U),ne=PATH.basename(re),F=PATH.basename(U),fe,pe,Me;try{fe=FS.lookupPath(re,{parent:!0}),pe=fe.node,fe=FS.lookupPath(U,{parent:!0}),Me=fe.node}catch{throw new FS.ErrnoError(ERRNO_CODES.EBUSY)}if(!pe||!Me)throw new FS.ErrnoError(ERRNO_CODES.ENOENT);if(pe.mount!==Me.mount)throw new FS.ErrnoError(ERRNO_CODES.EXDEV);var ve=FS.lookupNode(pe,ne),se=PATH.relative(re,ie);if(se.charAt(0)!==".")throw new FS.ErrnoError(ERRNO_CODES.EINVAL);if(se=PATH.relative(U,Y),se.charAt(0)!==".")throw new FS.ErrnoError(ERRNO_CODES.ENOTEMPTY);var me;try{me=FS.lookupNode(Me,F)}catch{}if(ve!==me){var Te=FS.isDir(ve.mode),Re=FS.mayDelete(pe,ne,Te);if(Re)throw new FS.ErrnoError(Re);if(Re=me?FS.mayDelete(Me,F,Te):FS.mayCreate(Me,F),Re)throw new FS.ErrnoError(Re);if(!pe.node_ops.rename)throw new FS.ErrnoError(ERRNO_CODES.EPERM);if(FS.isMountpoint(ve)||me&&FS.isMountpoint(me))throw new FS.ErrnoError(ERRNO_CODES.EBUSY);if(Me!==pe&&(Re=FS.nodePermissions(pe,"w"),Re))throw new FS.ErrnoError(Re);try{FS.trackingDelegate.willMovePath&&FS.trackingDelegate.willMovePath(re,U)}catch(be){console.log("FS.trackingDelegate['willMovePath']('"+re+"', '"+U+"') threw an exception: "+be.message)}FS.hashRemoveNode(ve);try{pe.node_ops.rename(ve,Me,F)}catch(be){throw be}finally{FS.hashAddNode(ve)}try{FS.trackingDelegate.onMovePath&&FS.trackingDelegate.onMovePath(re,U)}catch(be){console.log("FS.trackingDelegate['onMovePath']('"+re+"', '"+U+"') threw an exception: "+be.message)}}},rmdir:function(re){var U=FS.lookupPath(re,{parent:!0}),Y=U.node,ie=PATH.basename(re),ne=FS.lookupNode(Y,ie),F=FS.mayDelete(Y,ie,!0);if(F)throw new FS.ErrnoError(F);if(!Y.node_ops.rmdir)throw new FS.ErrnoError(ERRNO_CODES.EPERM);if(FS.isMountpoint(ne))throw new FS.ErrnoError(ERRNO_CODES.EBUSY);try{FS.trackingDelegate.willDeletePath&&FS.trackingDelegate.willDeletePath(re)}catch(fe){console.log("FS.trackingDelegate['willDeletePath']('"+re+"') threw an exception: "+fe.message)}Y.node_ops.rmdir(Y,ie),FS.destroyNode(ne);try{FS.trackingDelegate.onDeletePath&&FS.trackingDelegate.onDeletePath(re)}catch(fe){console.log("FS.trackingDelegate['onDeletePath']('"+re+"') threw an exception: "+fe.message)}},readdir:function(re){var U=FS.lookupPath(re,{follow:!0}),Y=U.node;if(!Y.node_ops.readdir)throw new FS.ErrnoError(ERRNO_CODES.ENOTDIR);return Y.node_ops.readdir(Y)},unlink:function(re){var U=FS.lookupPath(re,{parent:!0}),Y=U.node,ie=PATH.basename(re),ne=FS.lookupNode(Y,ie),F=FS.mayDelete(Y,ie,!1);if(F)throw F===ERRNO_CODES.EISDIR&&(F=ERRNO_CODES.EPERM),new FS.ErrnoError(F);if(!Y.node_ops.unlink)throw new FS.ErrnoError(ERRNO_CODES.EPERM);if(FS.isMountpoint(ne))throw new FS.ErrnoError(ERRNO_CODES.EBUSY);try{FS.trackingDelegate.willDeletePath&&FS.trackingDelegate.willDeletePath(re)}catch(fe){console.log("FS.trackingDelegate['willDeletePath']('"+re+"') threw an exception: "+fe.message)}Y.node_ops.unlink(Y,ie),FS.destroyNode(ne);try{FS.trackingDelegate.onDeletePath&&FS.trackingDelegate.onDeletePath(re)}catch(fe){console.log("FS.trackingDelegate['onDeletePath']('"+re+"') threw an exception: "+fe.message)}},readlink:function(re){var U=FS.lookupPath(re),Y=U.node;if(!Y)throw new FS.ErrnoError(ERRNO_CODES.ENOENT);if(!Y.node_ops.readlink)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);return PATH.resolve(FS.getPath(Y.parent),Y.node_ops.readlink(Y))},stat:function(re,U){var Y=FS.lookupPath(re,{follow:!U}),ie=Y.node;if(!ie)throw new FS.ErrnoError(ERRNO_CODES.ENOENT);if(!ie.node_ops.getattr)throw new FS.ErrnoError(ERRNO_CODES.EPERM);return ie.node_ops.getattr(ie)},lstat:function(re){return FS.stat(re,!0)},chmod:function(re,U,Y){var ie;if(typeof re=="string"){var ne=FS.lookupPath(re,{follow:!Y});ie=ne.node}else ie=re;if(!ie.node_ops.setattr)throw new FS.ErrnoError(ERRNO_CODES.EPERM);ie.node_ops.setattr(ie,{mode:U&4095|ie.mode&-4096,timestamp:Date.now()})},lchmod:function(re,U){FS.chmod(re,U,!0)},fchmod:function(re,U){var Y=FS.getStream(re);if(!Y)throw new FS.ErrnoError(ERRNO_CODES.EBADF);FS.chmod(Y.node,U)},chown:function(re,U,Y,ie){var ne;if(typeof re=="string"){var F=FS.lookupPath(re,{follow:!ie});ne=F.node}else ne=re;if(!ne.node_ops.setattr)throw new FS.ErrnoError(ERRNO_CODES.EPERM);ne.node_ops.setattr(ne,{timestamp:Date.now()})},lchown:function(re,U,Y){FS.chown(re,U,Y,!0)},fchown:function(re,U,Y){var ie=FS.getStream(re);if(!ie)throw new FS.ErrnoError(ERRNO_CODES.EBADF);FS.chown(ie.node,U,Y)},truncate:function(re,U){if(U<0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var Y;if(typeof re=="string"){var ie=FS.lookupPath(re,{follow:!0});Y=ie.node}else Y=re;if(!Y.node_ops.setattr)throw new FS.ErrnoError(ERRNO_CODES.EPERM);if(FS.isDir(Y.mode))throw new FS.ErrnoError(ERRNO_CODES.EISDIR);if(!FS.isFile(Y.mode))throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var ne=FS.nodePermissions(Y,"w");if(ne)throw new FS.ErrnoError(ne);Y.node_ops.setattr(Y,{size:U,timestamp:Date.now()})},ftruncate:function(re,U){var Y=FS.getStream(re);if(!Y)throw new FS.ErrnoError(ERRNO_CODES.EBADF);if(!(Y.flags&2097155))throw new FS.ErrnoError(ERRNO_CODES.EINVAL);FS.truncate(Y.node,U)},utime:function(re,U,Y){var ie=FS.lookupPath(re,{follow:!0}),ne=ie.node;ne.node_ops.setattr(ne,{timestamp:Math.max(U,Y)})},open:function(re,U,Y,ie,ne){if(re==="")throw new FS.ErrnoError(ERRNO_CODES.ENOENT);U=typeof U=="string"?FS.modeStringToFlags(U):U,Y=typeof Y>"u"?438:Y,U&64?Y=Y&4095|32768:Y=0;var F;if(typeof re=="object")F=re;else{re=PATH.normalize(re);try{var fe=FS.lookupPath(re,{follow:!(U&131072)});F=fe.node}catch{}}var pe=!1;if(U&64)if(F){if(U&128)throw new FS.ErrnoError(ERRNO_CODES.EEXIST)}else F=FS.mknod(re,Y,0),pe=!0;if(!F)throw new FS.ErrnoError(ERRNO_CODES.ENOENT);if(FS.isChrdev(F.mode)&&(U&=-513),U&65536&&!FS.isDir(F.mode))throw new FS.ErrnoError(ERRNO_CODES.ENOTDIR);if(!pe){var Me=FS.mayOpen(F,U);if(Me)throw new FS.ErrnoError(Me)}U&512&&FS.truncate(F,0),U&=-641;var ve=FS.createStream({node:F,path:FS.getPath(F),flags:U,seekable:!0,position:0,stream_ops:F.stream_ops,ungotten:[],error:!1},ie,ne);ve.stream_ops.open&&ve.stream_ops.open(ve),Module.logReadFiles&&!(U&1)&&(FS.readFiles||(FS.readFiles={}),re in FS.readFiles||(FS.readFiles[re]=1,Module.printErr("read file: "+re)));try{if(FS.trackingDelegate.onOpenFile){var se=0;(U&2097155)!==1&&(se|=FS.tracking.openFlags.READ),U&2097155&&(se|=FS.tracking.openFlags.WRITE),FS.trackingDelegate.onOpenFile(re,se)}}catch(me){console.log("FS.trackingDelegate['onOpenFile']('"+re+"', flags) threw an exception: "+me.message)}return ve},close:function(re){re.getdents&&(re.getdents=null);try{re.stream_ops.close&&re.stream_ops.close(re)}catch(U){throw U}finally{FS.closeStream(re.fd)}},llseek:function(re,U,Y){if(!re.seekable||!re.stream_ops.llseek)throw new FS.ErrnoError(ERRNO_CODES.ESPIPE);return re.position=re.stream_ops.llseek(re,U,Y),re.ungotten=[],re.position},read:function(re,U,Y,ie,ne){if(ie<0||ne<0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);if((re.flags&2097155)===1)throw new FS.ErrnoError(ERRNO_CODES.EBADF);if(FS.isDir(re.node.mode))throw new FS.ErrnoError(ERRNO_CODES.EISDIR);if(!re.stream_ops.read)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);var F=!0;if(typeof ne>"u")ne=re.position,F=!1;else if(!re.seekable)throw new FS.ErrnoError(ERRNO_CODES.ESPIPE);var fe=re.stream_ops.read(re,U,Y,ie,ne);return F||(re.position+=fe),fe},write:function(re,U,Y,ie,ne,F){if(ie<0||ne<0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);if(!(re.flags&2097155))throw new FS.ErrnoError(ERRNO_CODES.EBADF);if(FS.isDir(re.node.mode))throw new FS.ErrnoError(ERRNO_CODES.EISDIR);if(!re.stream_ops.write)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);re.flags&1024&&FS.llseek(re,0,2);var fe=!0;if(typeof ne>"u")ne=re.position,fe=!1;else if(!re.seekable)throw new FS.ErrnoError(ERRNO_CODES.ESPIPE);var pe=re.stream_ops.write(re,U,Y,ie,ne,F);fe||(re.position+=pe);try{re.path&&FS.trackingDelegate.onWriteToFile&&FS.trackingDelegate.onWriteToFile(re.path)}catch(Me){console.log("FS.trackingDelegate['onWriteToFile']('"+path+"') threw an exception: "+Me.message)}return pe},allocate:function(re,U,Y){if(U<0||Y<=0)throw new FS.ErrnoError(ERRNO_CODES.EINVAL);if(!(re.flags&2097155))throw new FS.ErrnoError(ERRNO_CODES.EBADF);if(!FS.isFile(re.node.mode)&&!FS.isDir(node.mode))throw new FS.ErrnoError(ERRNO_CODES.ENODEV);if(!re.stream_ops.allocate)throw new FS.ErrnoError(ERRNO_CODES.EOPNOTSUPP);re.stream_ops.allocate(re,U,Y)},mmap:function(re,U,Y,ie,ne,F,fe){if((re.flags&2097155)===1)throw new FS.ErrnoError(ERRNO_CODES.EACCES);if(!re.stream_ops.mmap)throw new FS.ErrnoError(ERRNO_CODES.ENODEV);return re.stream_ops.mmap(re,U,Y,ie,ne,F,fe)},msync:function(re,U,Y,ie,ne){return!re||!re.stream_ops.msync?0:re.stream_ops.msync(re,U,Y,ie,ne)},munmap:function(re){return 0},ioctl:function(re,U,Y){if(!re.stream_ops.ioctl)throw new FS.ErrnoError(ERRNO_CODES.ENOTTY);return re.stream_ops.ioctl(re,U,Y)},readFile:function(re,U){if(U=U||{},U.flags=U.flags||"r",U.encoding=U.encoding||"binary",U.encoding!=="utf8"&&U.encoding!=="binary")throw new Error('Invalid encoding type "'+U.encoding+'"');var Y,ie=FS.open(re,U.flags),ne=FS.stat(re),F=ne.size,fe=new Uint8Array(F);return FS.read(ie,fe,0,F,0),U.encoding==="utf8"?Y=UTF8ArrayToString(fe,0):U.encoding==="binary"&&(Y=fe),FS.close(ie),Y},writeFile:function(re,U,Y){if(Y=Y||{},Y.flags=Y.flags||"w",Y.encoding=Y.encoding||"utf8",Y.encoding!=="utf8"&&Y.encoding!=="binary")throw new Error('Invalid encoding type "'+Y.encoding+'"');var ie=FS.open(re,Y.flags,Y.mode);if(Y.encoding==="utf8"){var ne=new Uint8Array(lengthBytesUTF8(U)+1),F=stringToUTF8Array(U,ne,0,ne.length);FS.write(ie,ne,0,F,0,Y.canOwn)}else Y.encoding==="binary"&&FS.write(ie,U,0,U.length,0,Y.canOwn);FS.close(ie)},cwd:function(){return FS.currentPath},chdir:function(re){var U=FS.lookupPath(re,{follow:!0});if(!FS.isDir(U.node.mode))throw new FS.ErrnoError(ERRNO_CODES.ENOTDIR);var Y=FS.nodePermissions(U.node,"x");if(Y)throw new FS.ErrnoError(Y);FS.currentPath=U.path},createDefaultDirectories:function(){FS.mkdir("/tmp"),FS.mkdir("/home"),FS.mkdir("/home/web_user")},createDefaultDevices:function(){FS.mkdir("/dev"),FS.registerDevice(FS.makedev(1,3),{read:function(){return 0},write:function(Y,ie,ne,F,fe){return F}}),FS.mkdev("/dev/null",FS.makedev(1,3)),TTY.register(FS.makedev(5,0),TTY.default_tty_ops),TTY.register(FS.makedev(6,0),TTY.default_tty1_ops),FS.mkdev("/dev/tty",FS.makedev(5,0)),FS.mkdev("/dev/tty1",FS.makedev(6,0));var re;if(typeof crypto<"u"){var U=new Uint8Array(1);re=function(){return crypto.getRandomValues(U),U[0]}}else ENVIRONMENT_IS_NODE?re=function(){return require$$1.randomBytes(1)[0]}:re=function(){return Math.random()*256|0};FS.createDevice("/dev","random",re),FS.createDevice("/dev","urandom",re),FS.mkdir("/dev/shm"),FS.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){FS.mkdir("/proc"),FS.mkdir("/proc/self"),FS.mkdir("/proc/self/fd"),FS.mount({mount:function(){var re=FS.createNode("/proc/self","fd",16895,73);return re.node_ops={lookup:function(U,Y){var ie=+Y,ne=FS.getStream(ie);if(!ne)throw new FS.ErrnoError(ERRNO_CODES.EBADF);var F={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return ne.path}}};return F.parent=F,F}},re}},{},"/proc/self/fd")},createStandardStreams:function(){Module.stdin?FS.createDevice("/dev","stdin",Module.stdin):FS.symlink("/dev/tty","/dev/stdin"),Module.stdout?FS.createDevice("/dev","stdout",null,Module.stdout):FS.symlink("/dev/tty","/dev/stdout"),Module.stderr?FS.createDevice("/dev","stderr",null,Module.stderr):FS.symlink("/dev/tty1","/dev/stderr");var re=FS.open("/dev/stdin","r");assert(re.fd===0,"invalid handle for stdin ("+re.fd+")");var U=FS.open("/dev/stdout","w");assert(U.fd===1,"invalid handle for stdout ("+U.fd+")");var Y=FS.open("/dev/stderr","w");assert(Y.fd===2,"invalid handle for stderr ("+Y.fd+")")},ensureErrnoError:function(){FS.ErrnoError||(FS.ErrnoError=function(U,Y){this.node=Y,this.setErrno=function(ie){this.errno=ie;for(var ne in ERRNO_CODES)if(ERRNO_CODES[ne]===ie){this.code=ne;break}},this.setErrno(U),this.message=ERRNO_MESSAGES[U]},FS.ErrnoError.prototype=new Error,FS.ErrnoError.prototype.constructor=FS.ErrnoError,[ERRNO_CODES.ENOENT].forEach(function(re){FS.genericErrors[re]=new FS.ErrnoError(re),FS.genericErrors[re].stack="<generic error, no stack>"}))},staticInit:function(){FS.ensureErrnoError(),FS.nameTable=new Array(4096),FS.mount(MEMFS,{},"/"),FS.createDefaultDirectories(),FS.createDefaultDevices(),FS.createSpecialDirectories(),FS.filesystems={MEMFS,IDBFS,NODEFS,WORKERFS}},init:function(re,U,Y){assert(!FS.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),FS.init.initialized=!0,FS.ensureErrnoError(),Module.stdin=re||Module.stdin,Module.stdout=U||Module.stdout,Module.stderr=Y||Module.stderr,FS.createStandardStreams()},quit:function(){FS.init.initialized=!1;var re=Module._fflush;re&&re(0);for(var U=0;U<FS.streams.length;U++){var Y=FS.streams[U];Y&&FS.close(Y)}},getMode:function(re,U){var Y=0;return re&&(Y|=365),U&&(Y|=146),Y},joinPath:function(re,U){var Y=PATH.join.apply(null,re);return U&&Y[0]=="/"&&(Y=Y.substr(1)),Y},absolutePath:function(re,U){return PATH.resolve(U,re)},standardizePath:function(re){return PATH.normalize(re)},findObject:function(re,U){var Y=FS.analyzePath(re,U);return Y.exists?Y.object:(___setErrNo(Y.error),null)},analyzePath:function(re,U){try{var Y=FS.lookupPath(re,{follow:!U});re=Y.path}catch{}var ie={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var Y=FS.lookupPath(re,{parent:!0});ie.parentExists=!0,ie.parentPath=Y.path,ie.parentObject=Y.node,ie.name=PATH.basename(re),Y=FS.lookupPath(re,{follow:!U}),ie.exists=!0,ie.path=Y.path,ie.object=Y.node,ie.name=Y.node.name,ie.isRoot=Y.path==="/"}catch(ne){ie.error=ne.errno}return ie},createFolder:function(re,U,Y,ie){var ne=PATH.join2(typeof re=="string"?re:FS.getPath(re),U),F=FS.getMode(Y,ie);return FS.mkdir(ne,F)},createPath:function(re,U,Y,ie){re=typeof re=="string"?re:FS.getPath(re);for(var ne=U.split("/").reverse();ne.length;){var F=ne.pop();if(F){var fe=PATH.join2(re,F);try{FS.mkdir(fe)}catch{}re=fe}}return fe},createFile:function(re,U,Y,ie,ne){var F=PATH.join2(typeof re=="string"?re:FS.getPath(re),U),fe=FS.getMode(ie,ne);return FS.create(F,fe)},createDataFile:function(re,U,Y,ie,ne,F){var fe=U?PATH.join2(typeof re=="string"?re:FS.getPath(re),U):re,pe=FS.getMode(ie,ne),Me=FS.create(fe,pe);if(Y){if(typeof Y=="string"){for(var ve=new Array(Y.length),se=0,me=Y.length;se<me;++se)ve[se]=Y.charCodeAt(se);Y=ve}FS.chmod(Me,pe|146);var Te=FS.open(Me,"w");FS.write(Te,Y,0,Y.length,0,F),FS.close(Te),FS.chmod(Me,pe)}return Me},createDevice:function(re,U,Y,ie){var ne=PATH.join2(typeof re=="string"?re:FS.getPath(re),U),F=FS.getMode(!!Y,!!ie);FS.createDevice.major||(FS.createDevice.major=64);var fe=FS.makedev(FS.createDevice.major++,0);return FS.registerDevice(fe,{open:function(pe){pe.seekable=!1},close:function(pe){ie&&ie.buffer&&ie.buffer.length&&ie(10)},read:function(pe,Me,ve,se,me){for(var Te=0,Re=0;Re<se;Re++){var be;try{be=Y()}catch{throw new FS.ErrnoError(ERRNO_CODES.EIO)}if(be===void 0&&Te===0)throw new FS.ErrnoError(ERRNO_CODES.EAGAIN);if(be==null)break;Te++,Me[ve+Re]=be}return Te&&(pe.node.timestamp=Date.now()),Te},write:function(pe,Me,ve,se,me){for(var Te=0;Te<se;Te++)try{ie(Me[ve+Te])}catch{throw new FS.ErrnoError(ERRNO_CODES.EIO)}return se&&(pe.node.timestamp=Date.now()),Te}}),FS.mkdev(ne,F,fe)},createLink:function(re,U,Y,ie,ne){var F=PATH.join2(typeof re=="string"?re:FS.getPath(re),U);return FS.symlink(Y,F)},forceLoadFile:function(re){if(re.isDevice||re.isFolder||re.link||re.contents)return!0;var U=!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Module.read)try{re.contents=intArrayFromString(Module.read(re.url),!0),re.usedBytes=re.contents.length}catch{U=!1}else throw new Error("Cannot load without read() or XMLHttpRequest.");return U||___setErrNo(ERRNO_CODES.EIO),U},createLazyFile:function(re,U,Y,ie,ne){function F(){this.lengthKnown=!1,this.chunks=[]}if(F.prototype.get=function(Te){if(!(Te>this.length-1||Te<0)){var Re=Te%this.chunkSize,be=Te/this.chunkSize|0;return this.getter(be)[Re]}},F.prototype.setDataGetter=function(Te){this.getter=Te},F.prototype.cacheLength=function(){var Te=new XMLHttpRequest;if(Te.open("HEAD",Y,!1),Te.send(null),!(Te.status>=200&&Te.status<300||Te.status===304))throw new Error("Couldn't load "+Y+". Status: "+Te.status);var Re=Number(Te.getResponseHeader("Content-length")),be,Pe=(be=Te.getResponseHeader("Accept-Ranges"))&&be==="bytes",Le=1024*1024;Pe||(Le=Re);var xe=function(Oe,Ne){if(Oe>Ne)throw new Error("invalid range ("+Oe+", "+Ne+") or no bytes requested!");if(Ne>Re-1)throw new Error("only "+Re+" bytes available! programmer error!");var ke=new XMLHttpRequest;if(ke.open("GET",Y,!1),Re!==Le&&ke.setRequestHeader("Range","bytes="+Oe+"-"+Ne),typeof Uint8Array<"u"&&(ke.responseType="arraybuffer"),ke.overrideMimeType&&ke.overrideMimeType("text/plain; charset=x-user-defined"),ke.send(null),!(ke.status>=200&&ke.status<300||ke.status===304))throw new Error("Couldn't load "+Y+". Status: "+ke.status);return ke.response!==void 0?new Uint8Array(ke.response||[]):intArrayFromString(ke.responseText||"",!0)},Fe=this;Fe.setDataGetter(function(Oe){var Ne=Oe*Le,ke=(Oe+1)*Le-1;if(ke=Math.min(ke,Re-1),typeof Fe.chunks[Oe]>"u"&&(Fe.chunks[Oe]=xe(Ne,ke)),typeof Fe.chunks[Oe]>"u")throw new Error("doXHR failed!");return Fe.chunks[Oe]}),this._length=Re,this._chunkSize=Le,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!ENVIRONMENT_IS_WORKER)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var fe=new F;Object.defineProperty(fe,"length",{get:function(){return this.lengthKnown||this.cacheLength(),this._length}}),Object.defineProperty(fe,"chunkSize",{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}});var pe={isDevice:!1,contents:fe}}else var pe={isDevice:!1,url:Y};var Me=FS.createFile(re,U,pe,ie,ne);pe.contents?Me.contents=pe.contents:pe.url&&(Me.contents=null,Me.url=pe.url),Object.defineProperty(Me,"usedBytes",{get:function(){return this.contents.length}});var ve={},se=Object.keys(Me.stream_ops);return se.forEach(function(me){var Te=Me.stream_ops[me];ve[me]=function(){if(!FS.forceLoadFile(Me))throw new FS.ErrnoError(ERRNO_CODES.EIO);return Te.apply(null,arguments)}}),ve.read=function(Te,Re,be,Pe,Le){if(!FS.forceLoadFile(Me))throw new FS.ErrnoError(ERRNO_CODES.EIO);var xe=Te.node.contents;if(Le>=xe.length)return 0;var Fe=Math.min(xe.length-Le,Pe);if(assert(Fe>=0),xe.slice)for(var Oe=0;Oe<Fe;Oe++)Re[be+Oe]=xe[Le+Oe];else for(var Oe=0;Oe<Fe;Oe++)Re[be+Oe]=xe.get(Le+Oe);return Fe},Me.stream_ops=ve,Me},createPreloadedFile:function(re,U,Y,ie,ne,F,fe,pe,Me,ve){Browser.init();var se=U?PATH.resolve(PATH.join2(re,U)):re;function me(Te){function Re(Pe){ve&&ve(),pe||FS.createDataFile(re,U,Pe,ie,ne,Me),F&&F(),removeRunDependency()}var be=!1;Module.preloadPlugins.forEach(function(Pe){be||Pe.canHandle(se)&&(Pe.handle(Te,se,Re,function(){fe&&fe(),removeRunDependency()}),be=!0)}),be||Re(Te)}addRunDependency(),typeof Y=="string"?Browser.asyncLoad(Y,function(Te){me(Te)},fe):me(Y)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(re,U,Y){U=U||function(){},Y=Y||function(){};var ie=FS.indexedDB();try{var ne=ie.open(FS.DB_NAME(),FS.DB_VERSION)}catch(F){return Y(F)}ne.onupgradeneeded=function(){console.log("creating db");var fe=ne.result;fe.createObjectStore(FS.DB_STORE_NAME)},ne.onsuccess=function(){var fe=ne.result,pe=fe.transaction([FS.DB_STORE_NAME],"readwrite"),Me=pe.objectStore(FS.DB_STORE_NAME),ve=0,se=0,me=re.length;function Te(){se==0?U():Y()}re.forEach(function(Re){var be=Me.put(FS.analyzePath(Re).object.contents,Re);be.onsuccess=function(){ve++,ve+se==me&&Te()},be.onerror=function(){se++,ve+se==me&&Te()}}),pe.onerror=Y},ne.onerror=Y},loadFilesFromDB:function(re,U,Y){U=U||function(){},Y=Y||function(){};var ie=FS.indexedDB();try{var ne=ie.open(FS.DB_NAME(),FS.DB_VERSION)}catch(F){return Y(F)}ne.onupgradeneeded=Y,ne.onsuccess=function(){var fe=ne.result;try{var pe=fe.transaction([FS.DB_STORE_NAME],"readonly")}catch(Re){Y(Re);return}var Me=pe.objectStore(FS.DB_STORE_NAME),ve=0,se=0,me=re.length;function Te(){se==0?U():Y()}re.forEach(function(Re){var be=Me.get(Re);be.onsuccess=function(){FS.analyzePath(Re).exists&&FS.unlink(Re),FS.createDataFile(PATH.dirname(Re),PATH.basename(Re),be.result,!0,!0,!0),ve++,ve+se==me&&Te()},be.onerror=function(){se++,ve+se==me&&Te()}}),pe.onerror=Y},ne.onerror=Y}},SYSCALLS={DEFAULT_POLLMASK:5,mappings:{},umask:511,calculateAt:function(re,U){if(U[0]!=="/"){var Y;if(re===-100)Y=FS.cwd();else{var ie=FS.getStream(re);if(!ie)throw new FS.ErrnoError(ERRNO_CODES.EBADF);Y=ie.path}U=PATH.join2(Y,U)}return U},doStat:function(re,U,Y){try{var ie=re(U)}catch(ne){if(ne&&ne.node&&PATH.normalize(U)!==PATH.normalize(FS.getPath(ne.node)))return-20;throw ne}return HEAP32[Y>>2]=ie.dev,HEAP32[Y+4>>2]=0,HEAP32[Y+8>>2]=ie.ino,HEAP32[Y+12>>2]=ie.mode,HEAP32[Y+16>>2]=ie.nlink,HEAP32[Y+20>>2]=ie.uid,HEAP32[Y+24>>2]=ie.gid,HEAP32[Y+28>>2]=ie.rdev,HEAP32[Y+32>>2]=0,HEAP32[Y+36>>2]=ie.size,HEAP32[Y+40>>2]=4096,HEAP32[Y+44>>2]=ie.blocks,HEAP32[Y+48>>2]=ie.atime.getTime()/1e3|0,HEAP32[Y+52>>2]=0,HEAP32[Y+56>>2]=ie.mtime.getTime()/1e3|0,HEAP32[Y+60>>2]=0,HEAP32[Y+64>>2]=ie.ctime.getTime()/1e3|0,HEAP32[Y+68>>2]=0,HEAP32[Y+72>>2]=ie.ino,0},doMsync:function(re,U,Y,ie){var ne=new Uint8Array(HEAPU8.subarray(re,re+Y));FS.msync(U,ne,0,Y,ie)},doMkdir:function(re,U){return re=PATH.normalize(re),re[re.length-1]==="/"&&(re=re.substr(0,re.length-1)),FS.mkdir(re,U,0),0},doMknod:function(re,U,Y){switch(U&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-22}return FS.mknod(re,U,Y),0},doReadlink:function(re,U,Y){if(Y<=0)return-22;var ie=FS.readlink(re);return ie=ie.slice(0,Math.max(0,Y)),writeStringToMemory(ie,U,!0),ie.length},doAccess:function(re,U){if(U&-8)return-22;var Y,ie=FS.lookupPath(re,{follow:!0});Y=ie.node;var ne="";return U&4&&(ne+="r"),U&2&&(ne+="w"),U&1&&(ne+="x"),ne&&FS.nodePermissions(Y,ne)?-13:0},doDup:function(re,U,Y){var ie=FS.getStream(Y);return ie&&FS.close(ie),FS.open(re,U,0,Y,Y).fd},doReadv:function(re,U,Y,ie){for(var ne=0,F=0;F<Y;F++){var fe=HEAP32[U+F*8>>2],pe=HEAP32[U+(F*8+4)>>2],Me=FS.read(re,HEAP8,fe,pe,ie);if(Me<0)return-1;if(ne+=Me,Me<pe)break}return ne},doWritev:function(re,U,Y,ie){for(var ne=0,F=0;F<Y;F++){var fe=HEAP32[U+F*8>>2],pe=HEAP32[U+(F*8+4)>>2],Me=FS.write(re,HEAP8,fe,pe,ie);if(Me<0)return-1;ne+=Me}return ne},varargs:0,get:function(re){SYSCALLS.varargs+=4;var U=HEAP32[SYSCALLS.varargs-4>>2];return U},getStr:function(){var re=Pointer_stringify(SYSCALLS.get());return re},getStreamFromFD:function(){var re=FS.getStream(SYSCALLS.get());if(!re)throw new FS.ErrnoError(ERRNO_CODES.EBADF);return re},getSocketFromFD:function(){var re=SOCKFS.getSocket(SYSCALLS.get());if(!re)throw new FS.ErrnoError(ERRNO_CODES.EBADF);return re},getSocketAddress:function(re){var U=SYSCALLS.get(),Y=SYSCALLS.get();if(re&&U===0)return null;var ie=__read_sockaddr(U,Y);if(ie.errno)throw new FS.ErrnoError(ie.errno);return ie.addr=DNS.lookup_addr(ie.addr)||ie.addr,ie},get64:function(){var re=SYSCALLS.get(),U=SYSCALLS.get();return re>=0?assert(U===0):assert(U===-1),re},getZero:function(){assert(SYSCALLS.get()===0)}};function ___syscall5(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStr(),ie=SYSCALLS.get(),ne=SYSCALLS.get(),F=FS.open(Y,ie,ne);return F.fd}catch(fe){return(typeof FS>"u"||!(fe instanceof FS.ErrnoError))&&abort(fe),-fe.errno}}function _emscripten_memcpy_big(re,U,Y){return HEAPU8.set(HEAPU8.subarray(U,U+Y),re),re}Module._memcpy=_memcpy;function ___syscall6(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStreamFromFD();return FS.close(Y),0}catch(ie){return(typeof FS>"u"||!(ie instanceof FS.ErrnoError))&&abort(ie),-ie.errno}}var _cos=Math_cos;function _sbrk(re){var U=_sbrk;U.called||(DYNAMICTOP=alignMemoryPage(DYNAMICTOP),U.called=!0,assert(Runtime.dynamicAlloc),U.alloc=Runtime.dynamicAlloc,Runtime.dynamicAlloc=function(){abort("cannot dynamically allocate, sbrk now has control")});var Y=DYNAMICTOP;if(re!=0){var ie=U.alloc(re);if(!ie)return-1>>>0}return Y}function ___syscall54(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStreamFromFD(),ie=SYSCALLS.get();switch(ie){case 21505:return Y.tty?0:-ERRNO_CODES.ENOTTY;case 21506:return Y.tty?0:-ERRNO_CODES.ENOTTY;case 21519:{if(!Y.tty)return-ERRNO_CODES.ENOTTY;var ne=SYSCALLS.get();return HEAP32[ne>>2]=0,0}case 21520:return Y.tty?-ERRNO_CODES.EINVAL:-ERRNO_CODES.ENOTTY;case 21531:{var ne=SYSCALLS.get();return FS.ioctl(Y,ie,ne)}default:abort("bad ioctl syscall "+ie)}}catch(F){return(typeof FS>"u"||!(F instanceof FS.ErrnoError))&&abort(F),-F.errno}}var _ceilf=Math_ceil;function __embind_register_memory_view(re,U,Y){var ie=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ne=ie[U];function F(fe){fe=fe>>2;var pe=HEAPU32,Me=pe[fe],ve=pe[fe+1];return new ne(pe.buffer,ve,Me)}Y=readLatin1String(Y),registerType(re,{name:Y,fromWireType:F,argPackAdvance:8,readValueFromPointer:F},{ignoreDuplicateRegistrations:!0})}function _time(re){var U=Date.now()/1e3|0;return re&&(HEAP32[re>>2]=U),U}function _pthread_self(){return 0}function ___syscall140(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStreamFromFD(),ie=SYSCALLS.get(),ne=SYSCALLS.get(),F=SYSCALLS.get(),fe=SYSCALLS.get(),pe=ne;return assert(ie===0),FS.llseek(Y,pe,fe),HEAP32[F>>2]=Y.position,Y.getdents&&pe===0&&fe===0&&(Y.getdents=null),0}catch(Me){return(typeof FS>"u"||!(Me instanceof FS.ErrnoError))&&abort(Me),-Me.errno}}function ___syscall146(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStreamFromFD(),ie=SYSCALLS.get(),ne=SYSCALLS.get();return SYSCALLS.doWritev(Y,ie,ne)}catch(F){return(typeof FS>"u"||!(F instanceof FS.ErrnoError))&&abort(F),-F.errno}}function ___syscall221(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStreamFromFD(),ie=SYSCALLS.get();switch(ie){case 0:{var ne=SYSCALLS.get();if(ne<0)return-ERRNO_CODES.EINVAL;var F;return F=FS.open(Y.path,Y.flags,0,ne),F.fd}case 1:case 2:return 0;case 3:return Y.flags;case 4:{var ne=SYSCALLS.get();return Y.flags|=ne,0}case 12:case 12:{var ne=SYSCALLS.get(),fe=0;return HEAP16[ne+fe>>1]=2,0}case 13:case 14:case 13:case 14:return 0;case 16:case 8:return-ERRNO_CODES.EINVAL;case 9:return ___setErrNo(ERRNO_CODES.EINVAL),-1;default:return-ERRNO_CODES.EINVAL}}catch(pe){return(typeof FS>"u"||!(pe instanceof FS.ErrnoError))&&abort(pe),-pe.errno}}function ___syscall145(re,U){SYSCALLS.varargs=U;try{var Y=SYSCALLS.getStreamFromFD(),ie=SYSCALLS.get(),ne=SYSCALLS.get();return SYSCALLS.doReadv(Y,ie,ne)}catch(F){return(typeof FS>"u"||!(F instanceof FS.ErrnoError))&&abort(F),-F.errno}}var ___dso_handle=allocate(1,"i32*",ALLOC_STATIC);if(embind_init_charCodes(),BindingError=Module.BindingError=extendError(Error,"BindingError"),InternalError=Module.InternalError=extendError(Error,"InternalError"),init_emval(),UnboundTypeError=Module.UnboundTypeError=extendError(Error,"UnboundTypeError"),FS.staticInit(),__ATINIT__.unshift(function(){!Module.noFSInit&&!FS.init.initialized&&FS.init()}),__ATMAIN__.push(function(){FS.ignorePermissions=!1}),__ATEXIT__.push(function(){FS.quit()}),Module.FS_createFolder=FS.createFolder,Module.FS_createPath=FS.createPath,Module.FS_createDataFile=FS.createDataFile,Module.FS_createPreloadedFile=FS.createPreloadedFile,Module.FS_createLazyFile=FS.createLazyFile,Module.FS_createLink=FS.createLink,Module.FS_createDevice=FS.createDevice,Module.FS_unlink=FS.unlink,__ATINIT__.unshift(function(){}),__ATEXIT__.push(function(){}),ENVIRONMENT_IS_NODE){var fs=require$$1,NODEJS_PATH=require$$1;NODEFS.staticInit()}STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP),staticSealed=!0,STACK_MAX=STACK_BASE+TOTAL_STACK,DYNAMIC_BASE=DYNAMICTOP=Runtime.alignMemory(STACK_MAX),assert(DYNAMIC_BASE<TOTAL_MEMORY,"TOTAL_MEMORY not big enough for stack");var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_DYNAMIC);function invoke_iiii(re,U,Y,ie){try{return Module.dynCall_iiii(re,U,Y,ie)}catch(ne){if(typeof ne!="number"&&ne!=="longjmp")throw ne;asm.setThrew(1,0)}}function invoke_viiiii(re,U,Y,ie,ne,F){try{Module.dynCall_viiiii(re,U,Y,ie,ne,F)}catch(fe){if(typeof fe!="number"&&fe!=="longjmp")throw fe;asm.setThrew(1,0)}}function invoke_dii(re,U,Y){try{return Module.dynCall_dii(re,U,Y)}catch(ie){if(typeof ie!="number"&&ie!=="longjmp")throw ie;asm.setThrew(1,0)}}function invoke_vid(re,U,Y){try{Module.dynCall_vid(re,U,Y)}catch(ie){if(typeof ie!="number"&&ie!=="longjmp")throw ie;asm.setThrew(1,0)}}function invoke_di(re,U){try{return Module.dynCall_di(re,U)}catch(Y){if(typeof Y!="number"&&Y!=="longjmp")throw Y;asm.setThrew(1,0)}}function invoke_i(re){try{return Module.dynCall_i(re)}catch(U){if(typeof U!="number"&&U!=="longjmp")throw U;asm.setThrew(1,0)}}function invoke_vi(re,U){try{Module.dynCall_vi(re,U)}catch(Y){if(typeof Y!="number"&&Y!=="longjmp")throw Y;asm.setThrew(1,0)}}function invoke_vii(re,U,Y){try{Module.dynCall_vii(re,U,Y)}catch(ie){if(typeof ie!="number"&&ie!=="longjmp")throw ie;asm.setThrew(1,0)}}function invoke_ii(re,U){try{return Module.dynCall_ii(re,U)}catch(Y){if(typeof Y!="number"&&Y!=="longjmp")throw Y;asm.setThrew(1,0)}}function invoke_viii(re,U,Y,ie){try{Module.dynCall_viii(re,U,Y,ie)}catch(ne){if(typeof ne!="number"&&ne!=="longjmp")throw ne;asm.setThrew(1,0)}}function invoke_v(re){try{Module.dynCall_v(re)}catch(U){if(typeof U!="number"&&U!=="longjmp")throw U;asm.setThrew(1,0)}}function invoke_viid(re,U,Y,ie){try{Module.dynCall_viid(re,U,Y,ie)}catch(ne){if(typeof ne!="number"&&ne!=="longjmp")throw ne;asm.setThrew(1,0)}}function invoke_iiiii(re,U,Y,ie,ne){try{return Module.dynCall_iiiii(re,U,Y,ie,ne)}catch(F){if(typeof F!="number"&&F!=="longjmp")throw F;asm.setThrew(1,0)}}function invoke_viiiiii(re,U,Y,ie,ne,F,fe){try{Module.dynCall_viiiiii(re,U,Y,ie,ne,F,fe)}catch(pe){if(typeof pe!="number"&&pe!=="longjmp")throw pe;asm.setThrew(1,0)}}function invoke_iii(re,U,Y){try{return Module.dynCall_iii(re,U,Y)}catch(ie){if(typeof ie!="number"&&ie!=="longjmp")throw ie;asm.setThrew(1,0)}}function invoke_viiii(re,U,Y,ie,ne){try{Module.dynCall_viiii(re,U,Y,ie,ne)}catch(F){if(typeof F!="number"&&F!=="longjmp")throw F;asm.setThrew(1,0)}}Module.asmGlobalArg={Math,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Float32Array,Float64Array,NaN:NaN,Infinity:1/0},Module.asmLibraryArg={abort,assert,invoke_iiii,invoke_viiiii,invoke_dii,invoke_vid,invoke_di,invoke_i,invoke_vi,invoke_vii,invoke_ii,invoke_viii,invoke_v,invoke_viid,invoke_iiiii,invoke_viiiiii,invoke_iii,invoke_viiii,_fabs,___syscall221,_sin,floatReadValueFromPointer,simpleReadValueFromPointer,integerReadValueFromPointer,__embind_register_memory_view,throwInternalError,get_first_emval,_abort,count_emval_handles,_pthread_cleanup_push,__embind_register_integer,extendError,___assert_fail,init_emval,__embind_register_void,___cxa_find_matching_catch,_ceilf,getShiftFromSize,__embind_register_function,embind_init_charCodes,_emscripten_asm_const_33,throwBindingError,___setErrNo,__emval_register,_sbrk,readLatin1String,___cxa_allocate_exception,_emscripten_memcpy_big,__embind_register_bool,___resumeException,__ZSt18uncaught_exceptionv,_sysconf,_embind_repr,__embind_register_std_wstring,createNamedFunction,__embind_register_emval,_cos,throwUnboundTypeError,_pthread_self,craftInvokerFunction,__emval_decref,_sqrt,__embind_register_float,makeLegalFunctionName,___syscall54,___unlock,heap32VectorToArray,_pthread_cleanup_pop,whenDependentTypesAreResolved,_exit,__embind_register_std_string,new_,___cxa_atexit,registerType,___cxa_throw,__exit,___lock,___syscall6,___syscall5,ensureOverloadTable,__embind_register_constant,_time,requireFunction,runDestructors,getTypeName,_atexit,___syscall140,exposePublicSymbol,_emscripten_asm_const_5,_emscripten_asm_const_4,replacePublicSymbol,___syscall145,___syscall146,STACKTOP,STACK_MAX,tempDoublePtr,ABORT,cttz_i8,___dso_handle};var asm=function(re,U,Y){var ie=new re.Int8Array(Y),ne=new re.Int16Array(Y),F=new re.Int32Array(Y),fe=new re.Uint8Array(Y),pe=new re.Uint16Array(Y),Me=new re.Uint32Array(Y),ve=new re.Float32Array(Y),se=new re.Float64Array(Y),me=U.STACKTOP|0,Te=U.STACK_MAX|0,Re=U.tempDoublePtr|0,be=U.ABORT|0,Pe=U.cttz_i8|0,Le=U.___dso_handle|0,xe=0,Fe=0,Oe=0,Ne=0,ke=re.NaN,Ve=re.Infinity,Xe=0,$e=0,st=0,ze=0,tt=0,ft=0,Rt=0,Mt=0,Gt=0,_t=0,Bt=0,dt=0,ut=0,Ut=0,Tt=0,Xt=0,hn=0,nn=0,An=0,Cn=re.Math.floor,Nn=re.Math.abs,Qn=re.Math.sqrt,fi=re.Math.pow,hi=re.Math.cos,Qi=re.Math.sin,Zi=re.Math.tan,Mn=re.Math.acos,Vr=re.Math.asin,Ir=re.Math.atan,Rr=re.Math.atan2,ir=re.Math.exp,zr=re.Math.log,Br=re.Math.ceil,kt=re.Math.imul,rn=re.Math.min,Kn=re.Math.clz32,ai=U.abort,Ui=U.assert,yi=U.invoke_iiii,Nr=U.invoke_viiiii,Ar=U.invoke_dii,fr=U.invoke_vid,Bi=U.invoke_di,Kt=U.invoke_i,Yt=U.invoke_vi,fn=U.invoke_vii,on=U.invoke_ii,an=U.invoke_viii,gn=U.invoke_v,Nt=U.invoke_viid,ht=U.invoke_iiiii,ot=U.invoke_viiiiii,Vt=U.invoke_iii,Wt=U.invoke_viiii,sn=U._fabs,yn=U.___syscall221,ni=U._sin,ki=U.floatReadValueFromPointer,Hi=U.simpleReadValueFromPointer,ji=U.integerReadValueFromPointer,Xi=U.__embind_register_memory_view,Ws=U.throwInternalError,Jr=U.get_first_emval,Ai=U._abort,js=U.count_emval_handles,Qs=U._pthread_cleanup_push,Vo=U.__embind_register_integer,Mo=U.extendError,Ia=U.___assert_fail,Do=U.init_emval,Ca=U.__embind_register_void,l0=U.___cxa_find_matching_catch,Ra=U._ceilf,ko=U.getShiftFromSize,Ts=U.__embind_register_function,ta=U.embind_init_charCodes,q0=U._emscripten_asm_const_33,dn=U.throwBindingError,qn=U.___setErrNo,di=U.__emval_register,$t=U._sbrk,Jt=U.readLatin1String,xn=U.___cxa_allocate_exception,Vn=U._emscripten_memcpy_big,Dn=U.__embind_register_bool,jn=U.___resumeException,gi=U.__ZSt18uncaught_exceptionv,Wi=U._sysconf,Li=U._embind_repr,vi=U.__embind_register_std_wstring,yr=U.createNamedFunction,Sr=U.__embind_register_emval,Ur=U._cos,hs=U.throwUnboundTypeError,er=U._pthread_self,as=U.craftInvokerFunction,Yr=U.__emval_decref,eo=U._sqrt,wo=U.__embind_register_float,Er=U.makeLegalFunctionName,Ss=U.___syscall54,bs=U.___unlock,Ns=U.heap32VectorToArray,It=U._pthread_cleanup_pop,Ot=U.whenDependentTypesAreResolved,zt=U._exit,jt=U.__embind_register_std_string,mn=U.new_,kn=U.___cxa_atexit,Yn=U.registerType,xi=U.___cxa_throw,zi=U.__exit,ti=U.___lock,bi=U.___syscall6,cr=U.___syscall5,Gr=U.ensureOverloadTable,Ki=U.__embind_register_constant,As=U._time,Ls=U.requireFunction,ys=U.runDestructors,ds=U.getTypeName,$s=U._atexit,Ao=U.___syscall140,Po=U.exposePublicSymbol,mo=U._emscripten_asm_const_5,fa=U._emscripten_asm_const_4,pa=U.replacePublicSymbol,zo=U.___syscall145,Aa=U.___syscall146,na=0;function ma(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(lt=Ye+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)ee=ee+(Ye<<1)|0,J=J+(Ye<<1)|0;J=G+1179664|0,ee=Ye+1|0,rt=0-Ye|0,We=1-Ye|0,pt=~Ye,Qe=q+4|0;e:do if((Et|0)>1){qe=(lt|0)>1,O=(F[G+4>>2]|0)+ee|0,Je=1,j=W+((q<<1)+2)|0,W=le+(ee<<1)|0,ee=0;t:for(;;){if(qe)for(De=1,Ce=j,he=ee;;){do if((fe[Ce>>0]|0|0)>(X|0))ne[W>>1]=0,ie[O>>0]=0,ee=he;else{if(ie[O>>0]=-1,ee=ne[W+(rt<<1)>>1]|0,ee<<16>>16>0){ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(q=ne[W+(We<<1)>>1]|0,le=q<<16>>16,ee=ne[W+(pt<<1)>>1]|0,ce=ee<<16>>16,j=ee<<16>>16>0,q<<16>>16<=0){if(j){ne[W>>1]=ee,ee=ce*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-3<<2)|0,(F[j>>2]|0)<(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=ne[W+-2>>1]|0,ee<<16>>16>0){if(ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(De|0)){ee=he;break}F[ee>>2]=De,ee=he;break}else{if(ee=he+1|0,(he|0)>32767)break t;ne[W>>1]=ee,F[G+1179664+(he<<2)>>2]=ee<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=Je,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=Je,F[G+1310736+(he+6<<2)>>2]=Je;break}}if(j){if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(j=ne[W+-2>>1]|0,j<<16>>16<=0){ne[W>>1]=q,ee=le*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-4<<2)|0,(F[j>>2]|0)>(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=he}while(!1);if(De=De+1|0,j=Ce+2|0,W=W+2|0,O=O+1|0,(De|0)>=(lt|0))break;Ce=j,he=ee}if(Je=Je+1|0,(Je|0)>=(Et|0)){le=ee,je=52;break e}else O=O+2|0,j=j+Qe|0,W=W+4|0}Jn(3,3904,At),O=-1}else le=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function L0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(lt=Ye+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)ee=ee+(Ye<<1)|0,J=J+(Ye<<1)|0;J=G+1179664|0,ee=Ye+1|0,rt=0-Ye|0,We=1-Ye|0,pt=~Ye,Qe=(q<<1)+8|0;e:do if((Et|0)>1){qe=(lt|0)>1,O=(F[G+4>>2]|0)+ee|0,Je=1,j=W+((q<<2)+4)|0,W=le+(ee<<1)|0,ee=0;t:for(;;){if(qe)for(De=1,Ce=j,he=ee;;){do if((fe[Ce+1>>0]|0|0)>(X|0))ne[W>>1]=0,ie[O>>0]=0,ee=he;else{if(ie[O>>0]=-1,ee=ne[W+(rt<<1)>>1]|0,ee<<16>>16>0){ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(q=ne[W+(We<<1)>>1]|0,le=q<<16>>16,ee=ne[W+(pt<<1)>>1]|0,ce=ee<<16>>16,j=ee<<16>>16>0,q<<16>>16<=0){if(j){ne[W>>1]=ee,ee=ce*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-3<<2)|0,(F[j>>2]|0)<(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=ne[W+-2>>1]|0,ee<<16>>16>0){if(ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(De|0)){ee=he;break}F[ee>>2]=De,ee=he;break}else{if(ee=he+1|0,(he|0)>32767)break t;ne[W>>1]=ee,F[G+1179664+(he<<2)>>2]=ee<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=Je,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=Je,F[G+1310736+(he+6<<2)>>2]=Je;break}}if(j){if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(j=ne[W+-2>>1]|0,j<<16>>16<=0){ne[W>>1]=q,ee=le*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-4<<2)|0,(F[j>>2]|0)>(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=he}while(!1);if(De=De+1|0,j=Ce+4|0,W=W+2|0,O=O+1|0,(De|0)>=(lt|0))break;Ce=j,he=ee}if(Je=Je+1|0,(Je|0)>=(Et|0)){le=ee,je=52;break e}else O=O+2|0,j=j+Qe|0,W=W+4|0}Jn(3,3904,At),O=-1}else le=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function J0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(lt=Ye+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)ee=ee+(Ye<<1)|0,J=J+(Ye<<1)|0;J=G+1179664|0,ee=Ye+1|0,rt=0-Ye|0,We=1-Ye|0,pt=~Ye,Qe=(q<<1)+8|0;e:do if((Et|0)>1){qe=(lt|0)>1,O=(F[G+4>>2]|0)+ee|0,Je=1,j=W+((q<<2)+4)|0,W=le+(ee<<1)|0,ee=0;t:for(;;){if(qe)for(De=1,Ce=j,he=ee;;){do if((fe[Ce>>0]|0|0)>(X|0))ne[W>>1]=0,ie[O>>0]=0,ee=he;else{if(ie[O>>0]=-1,ee=ne[W+(rt<<1)>>1]|0,ee<<16>>16>0){ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(q=ne[W+(We<<1)>>1]|0,le=q<<16>>16,ee=ne[W+(pt<<1)>>1]|0,ce=ee<<16>>16,j=ee<<16>>16>0,q<<16>>16<=0){if(j){ne[W>>1]=ee,ee=ce*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-3<<2)|0,(F[j>>2]|0)<(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=ne[W+-2>>1]|0,ee<<16>>16>0){if(ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(De|0)){ee=he;break}F[ee>>2]=De,ee=he;break}else{if(ee=he+1|0,(he|0)>32767)break t;ne[W>>1]=ee,F[G+1179664+(he<<2)>>2]=ee<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=Je,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=Je,F[G+1310736+(he+6<<2)>>2]=Je;break}}if(j){if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(j=ne[W+-2>>1]|0,j<<16>>16<=0){ne[W>>1]=q,ee=le*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-4<<2)|0,(F[j>>2]|0)>(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=he}while(!1);if(De=De+1|0,j=Ce+4|0,W=W+2|0,O=O+1|0,(De|0)>=(lt|0))break;Ce=j,he=ee}if(Je=Je+1|0,(Je|0)>=(Et|0)){le=ee,je=52;break e}else O=O+2|0,j=j+Qe|0,W=W+4|0}Jn(3,3904,At),O=-1}else le=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function C0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O*3|0)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){do if(((fe[De+1>>0]|0)+(fe[De>>0]|0)+(fe[De+2>>0]|0)|0)>(Et|0))ne[W>>1]=0,ie[O>>0]=0,X=Ce;else{if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}while(!1);if(Qe=Qe+1|0,J=De+3|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+6|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function H0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<1)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){ce=fe[De>>0]|0,he=fe[De+1>>0]|0;do if(((ce&248)+10+(ce<<5&224)+(he>>>3&28)+(he<<3&248)|0)>(Et|0))ne[W>>1]=0,ie[O>>0]=0,X=Ce;else{if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}while(!1);if(Qe=Qe+1|0,J=De+2|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+4|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function D0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<2)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){do if(((fe[De+1>>0]|0)+(fe[De>>0]|0)+(fe[De+2>>0]|0)|0)>(Et|0))ne[W>>1]=0,ie[O>>0]=0,X=Ce;else{if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}while(!1);if(Qe=Qe+1|0,J=De+4|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+8|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Z0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<1)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){he=fe[De>>0]|0;do if(((he&240)+24+(he<<4&240)+((fe[De+1>>0]|0)&240)|0)>(Et|0))ne[W>>1]=0,ie[O>>0]=0,X=Ce;else{if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}while(!1);if(Qe=Qe+1|0,J=De+2|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+4|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Tl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<1)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){ce=fe[De>>0]|0,he=fe[De+1>>0]|0;do if(((ce&248)+12+(ce<<5&224)+(he>>>3&24)+(he<<2&248)|0)>(Et|0))ne[W>>1]=0,ie[O>>0]=0,X=Ce;else{if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}while(!1);if(Qe=Qe+1|0,J=De+2|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+4|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Il(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<2)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){do if(((fe[De+2>>0]|0)+(fe[De+1>>0]|0)+(fe[De+3>>0]|0)|0)>(Et|0))ne[W>>1]=0,ie[O>>0]=0,X=Ce;else{if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}while(!1);if(Qe=Qe+1|0,J=De+4|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+8|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Va(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,ce=(F[G+4>>2]|0)+O|0,lt=1,W=W+O|0,le=le+(O<<1)|0,ee=0;t:for(;;){if(Je)for(O=ce,We=1,Qe=W,De=ee;;){do if((fe[Qe>>0]|0|0)>(X|0))ne[le>>1]=0,ie[O>>0]=0,ee=De;else{if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}while(!1);if(We=We+1|0,W=Qe+1|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}else O=ce;if(lt=lt+1|0,(lt|0)>=(At|0)){he=ee,Ye=52;break e}else ce=O+2|0,W=W+2|0,le=le+4|0}Jn(3,3904,je),O=-1}else he=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function V0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,ce=(F[G+4>>2]|0)+O|0,lt=1,W=W+(O<<1)|0,le=le+(O<<1)|0,ee=0;t:for(;;){if(Je)for(O=ce,We=1,Qe=W,De=ee;;){do if((fe[Qe+1>>0]|0|0)>(X|0))ne[le>>1]=0,ie[O>>0]=0,ee=De;else{if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}while(!1);if(We=We+1|0,W=Qe+2|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}else O=ce;if(lt=lt+1|0,(lt|0)>=(At|0)){he=ee,Ye=52;break e}else ce=O+2|0,W=W+4|0,le=le+4|0}Jn(3,3904,je),O=-1}else he=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Ba(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,ce=(F[G+4>>2]|0)+O|0,lt=1,W=W+(O<<1)|0,le=le+(O<<1)|0,ee=0;t:for(;;){if(Je)for(O=ce,We=1,Qe=W,De=ee;;){do if((fe[Qe>>0]|0|0)>(X|0))ne[le>>1]=0,ie[O>>0]=0,ee=De;else{if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}while(!1);if(We=We+1|0,W=Qe+2|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}else O=ce;if(lt=lt+1|0,(lt|0)>=(At|0)){he=ee,Ye=52;break e}else ce=O+2|0,W=W+4|0,le=le+4|0}Jn(3,3904,je),O=-1}else he=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function lo(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,ee=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,O=(F[G+4>>2]|0)+ee|0,lt=1,W=W+ee|0,le=le+(ee<<1)|0,X=X+ee|0,ee=0;t:for(;;){if(Je)for(We=1,Qe=W,De=ee;;){do if((fe[Qe>>0]|0)>(fe[X>>0]|0))ne[le>>1]=0,ie[O>>0]=0,ee=De;else{if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}while(!1);if(We=We+1|0,W=Qe+1|0,X=X+1|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}if(lt=lt+1|0,(lt|0)>=(At|0)){ce=ee,Ye=52;break e}else O=O+2|0,W=W+2|0,le=le+4|0,X=X+2|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(ce|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(ce|0);)W=W+1|0,J=J+4|0;if(X=G+8|0,O=ee+-1|0,F[X>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[X>>2]|0))}if((ce|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(ce|0))}if((F[X>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[X>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function za(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q*3|0)+12|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q*6|0)+6)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){do if(((fe[he+1>>0]|0)+(fe[he>>0]|0)+(fe[he+2>>0]|0)|0)>(Je|0)){if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}else ne[j>>1]=0,ie[O>>0]=0,X=ce;while(!1);if(Ce=Ce+1|0,J=he+6|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function bc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<1)+8|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<2)+4)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){q=fe[he>>0]|0,le=fe[he+1>>0]|0;do if(((q&248)+10+(q<<5&224)+(le>>>3&28)+(le<<3&248)|0)>(Je|0)){if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}else ne[j>>1]=0,ie[O>>0]=0,X=ce;while(!1);if(Ce=Ce+1|0,J=he+4|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Rl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<2)+16|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<3)+8)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){do if(((fe[he+1>>0]|0)+(fe[he>>0]|0)+(fe[he+2>>0]|0)|0)>(Je|0)){if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}else ne[j>>1]=0,ie[O>>0]=0,X=ce;while(!1);if(Ce=Ce+1|0,J=he+8|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Tc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<1)+8|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<2)+4)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){le=fe[he>>0]|0;do if(((le&240)+24+(le<<4&240)+((fe[he+1>>0]|0)&240)|0)>(Je|0)){if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}else ne[j>>1]=0,ie[O>>0]=0,X=ce;while(!1);if(Ce=Ce+1|0,J=he+4|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function bo(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<1)+8|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<2)+4)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){q=fe[he>>0]|0,le=fe[he+1>>0]|0;do if(((q&248)+12+(q<<5&224)+(le>>>3&24)+(le<<2&248)|0)>(Je|0)){if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}else ne[j>>1]=0,ie[O>>0]=0,X=ce;while(!1);if(Ce=Ce+1|0,J=he+4|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Bl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<2)+16|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<3)+8)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){do if(((fe[he+2>>0]|0)+(fe[he+1>>0]|0)+(fe[he+3>>0]|0)|0)>(Je|0)){if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}else ne[j>>1]=0,ie[O>>0]=0,X=ce;while(!1);if(Ce=Ce+1|0,J=he+8|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Ic(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(lt=Ye+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)ee=ee+(Ye<<1)|0,J=J+(Ye<<1)|0;J=G+1179664|0,ee=Ye+1|0,rt=0-Ye|0,We=1-Ye|0,pt=~Ye,Qe=q+4|0;e:do if((Et|0)>1){qe=(lt|0)>1,O=(F[G+4>>2]|0)+ee|0,Je=1,j=W+((q<<1)+2)|0,W=le+(ee<<1)|0,ee=0;t:for(;;){if(qe)for(De=1,Ce=j,he=ee;;){do if((fe[Ce>>0]|0|0)>(X|0)){if(ie[O>>0]=-1,ee=ne[W+(rt<<1)>>1]|0,ee<<16>>16>0){ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(q=ne[W+(We<<1)>>1]|0,le=q<<16>>16,ee=ne[W+(pt<<1)>>1]|0,ce=ee<<16>>16,j=ee<<16>>16>0,q<<16>>16<=0){if(j){ne[W>>1]=ee,ee=ce*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-3<<2)|0,(F[j>>2]|0)<(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=ne[W+-2>>1]|0,ee<<16>>16>0){if(ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(De|0)){ee=he;break}F[ee>>2]=De,ee=he;break}else{if(ee=he+1|0,(he|0)>32767)break t;ne[W>>1]=ee,F[G+1179664+(he<<2)>>2]=ee<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=Je,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=Je,F[G+1310736+(he+6<<2)>>2]=Je;break}}if(j){if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(j=ne[W+-2>>1]|0,j<<16>>16<=0){ne[W>>1]=q,ee=le*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-4<<2)|0,(F[j>>2]|0)>(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=he}else ne[W>>1]=0,ie[O>>0]=0,ee=he;while(!1);if(De=De+1|0,j=Ce+2|0,W=W+2|0,O=O+1|0,(De|0)>=(lt|0))break;Ce=j,he=ee}if(Je=Je+1|0,(Je|0)>=(Et|0)){le=ee,je=52;break e}else O=O+2|0,j=j+Qe|0,W=W+4|0}Jn(3,3904,At),O=-1}else le=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function x0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(lt=Ye+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)ee=ee+(Ye<<1)|0,J=J+(Ye<<1)|0;J=G+1179664|0,ee=Ye+1|0,rt=0-Ye|0,We=1-Ye|0,pt=~Ye,Qe=(q<<1)+8|0;e:do if((Et|0)>1){qe=(lt|0)>1,O=(F[G+4>>2]|0)+ee|0,Je=1,j=W+((q<<2)+4)|0,W=le+(ee<<1)|0,ee=0;t:for(;;){if(qe)for(De=1,Ce=j,he=ee;;){do if((fe[Ce+1>>0]|0|0)>(X|0)){if(ie[O>>0]=-1,ee=ne[W+(rt<<1)>>1]|0,ee<<16>>16>0){ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(q=ne[W+(We<<1)>>1]|0,le=q<<16>>16,ee=ne[W+(pt<<1)>>1]|0,ce=ee<<16>>16,j=ee<<16>>16>0,q<<16>>16<=0){if(j){ne[W>>1]=ee,ee=ce*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-3<<2)|0,(F[j>>2]|0)<(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=ne[W+-2>>1]|0,ee<<16>>16>0){if(ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(De|0)){ee=he;break}F[ee>>2]=De,ee=he;break}else{if(ee=he+1|0,(he|0)>32767)break t;ne[W>>1]=ee,F[G+1179664+(he<<2)>>2]=ee<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=Je,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=Je,F[G+1310736+(he+6<<2)>>2]=Je;break}}if(j){if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(j=ne[W+-2>>1]|0,j<<16>>16<=0){ne[W>>1]=q,ee=le*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-4<<2)|0,(F[j>>2]|0)>(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=he}else ne[W>>1]=0,ie[O>>0]=0,ee=he;while(!1);if(De=De+1|0,j=Ce+4|0,W=W+2|0,O=O+1|0,(De|0)>=(lt|0))break;Ce=j,he=ee}if(Je=Je+1|0,(Je|0)>=(Et|0)){le=ee,je=52;break e}else O=O+2|0,j=j+Qe|0,W=W+4|0}Jn(3,3904,At),O=-1}else le=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function P0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(lt=Ye+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)ee=ee+(Ye<<1)|0,J=J+(Ye<<1)|0;J=G+1179664|0,ee=Ye+1|0,rt=0-Ye|0,We=1-Ye|0,pt=~Ye,Qe=(q<<1)+8|0;e:do if((Et|0)>1){qe=(lt|0)>1,O=(F[G+4>>2]|0)+ee|0,Je=1,j=W+((q<<2)+4)|0,W=le+(ee<<1)|0,ee=0;t:for(;;){if(qe)for(De=1,Ce=j,he=ee;;){do if((fe[Ce>>0]|0|0)>(X|0)){if(ie[O>>0]=-1,ee=ne[W+(rt<<1)>>1]|0,ee<<16>>16>0){ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(q=ne[W+(We<<1)>>1]|0,le=q<<16>>16,ee=ne[W+(pt<<1)>>1]|0,ce=ee<<16>>16,j=ee<<16>>16>0,q<<16>>16<=0){if(j){ne[W>>1]=ee,ee=ce*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-3<<2)|0,(F[j>>2]|0)<(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=ne[W+-2>>1]|0,ee<<16>>16>0){if(ne[W>>1]=ee,ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(De|0)){ee=he;break}F[ee>>2]=De,ee=he;break}else{if(ee=he+1|0,(he|0)>32767)break t;ne[W>>1]=ee,F[G+1179664+(he<<2)>>2]=ee<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=Je,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=Je,F[G+1310736+(he+6<<2)>>2]=Je;break}}if(j){if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(ee+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+Je,F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(j=ne[W+-2>>1]|0,j<<16>>16<=0){ne[W>>1]=q,ee=le*7|0,j=G+1310736+(ee+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(ee+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+De,j=G+1310736+(ee+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+Je,j=G+1310736+(ee+-4<<2)|0,(F[j>>2]|0)>(De|0)&&(F[j>>2]=De),F[G+1310736+(ee+-1<<2)>>2]=Je,ee=he;break}if(ee=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(ee|0)>(le|0))if(ne[W>>1]=le,(he|0)>0)for(j=0,q=J;;)if((F[q>>2]|0)==(ee|0)&&(F[q>>2]=le),j=j+1|0,(j|0)>=(he|0)){ee=le;break}else q=q+4|0;else ee=le;else if(ne[W>>1]=ee,(ee|0)<(le|0)&(he|0)>0)for(j=0,q=J;(F[q>>2]|0)==(le|0)&&(F[q>>2]=ee),j=j+1|0,!((j|0)>=(he|0));)q=q+4|0;ee=(ee<<16>>16)*7|0,ce=G+1310736+(ee+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(ee+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=he}else ne[W>>1]=0,ie[O>>0]=0,ee=he;while(!1);if(De=De+1|0,j=Ce+4|0,W=W+2|0,O=O+1|0,(De|0)>=(lt|0))break;Ce=j,he=ee}if(Je=Je+1|0,(Je|0)>=(Et|0)){le=ee,je=52;break e}else O=O+2|0,j=j+Qe|0,W=W+4|0}Jn(3,3904,At),O=-1}else le=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Uu(W){W=W|0;var q=0;return q=me,me=me+W|0,me=me+15&-16,q|0}function zc(){return me|0}function Ed(W){W=W|0,me=W}function ku(W,q){W=W|0,q=q|0,me=W,Te=q}function Gu(W,q){W=W|0,q=q|0,xe||(xe=W,Fe=q)}function hu(W){W=W|0,ie[Re>>0]=ie[W>>0],ie[Re+1>>0]=ie[W+1>>0],ie[Re+2>>0]=ie[W+2>>0],ie[Re+3>>0]=ie[W+3>>0]}function Qu(W){W=W|0,ie[Re>>0]=ie[W>>0],ie[Re+1>>0]=ie[W+1>>0],ie[Re+2>>0]=ie[W+2>>0],ie[Re+3>>0]=ie[W+3>>0],ie[Re+4>>0]=ie[W+4>>0],ie[Re+5>>0]=ie[W+5>>0],ie[Re+6>>0]=ie[W+6>>0],ie[Re+7>>0]=ie[W+7>>0]}function Eh(W){W=W|0,_t=W}function yd(){return _t|0}function Cd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q*3|0)+12|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q*6|0)+6)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(qe|0))ne[ce>>1]=0,O=le;else{if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}while(!1);if(he=he+1|0,X=X+6|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function xd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<1)+8|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<2)+4)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){W=fe[X>>0]|0,q=fe[X+1>>0]|0;do if(((W&248)+10+(W<<5&224)+(q>>>3&28)+(q<<3&248)|0)>(qe|0))ne[ce>>1]=0,O=le;else{if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}while(!1);if(he=he+1|0,X=X+4|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Hu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<2)+16|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<3)+8)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(qe|0))ne[ce>>1]=0,O=le;else{if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}while(!1);if(he=he+1|0,X=X+8|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function wd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<1)+8|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<2)+4)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){q=fe[X>>0]|0;do if(((q&240)+24+(q<<4&240)+((fe[X+1>>0]|0)&240)|0)>(qe|0))ne[ce>>1]=0,O=le;else{if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}while(!1);if(he=he+1|0,X=X+4|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Vu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<1)+8|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<2)+4)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){W=fe[X>>0]|0,q=fe[X+1>>0]|0;do if(((W&248)+12+(W<<5&224)+(q>>>3&24)+(q<<2&248)|0)>(qe|0))ne[ce>>1]=0,O=le;else{if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}while(!1);if(he=he+1|0,X=X+4|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function yh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<2)+16|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<3)+8)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){do if(((fe[X+2>>0]|0)+(fe[X+1>>0]|0)+(fe[X+3>>0]|0)|0)>(qe|0))ne[ce>>1]=0,O=le;else{if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}while(!1);if(he=he+1|0,X=X+8|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Ch(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(Je=je+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(Je<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+(je<<1)|0,J=J+(je<<1)|0;J=G+1179664|0,pt=0-je|0,Qe=1-je|0,We=~je,De=q+4|0;e:do if((lt|0)>1){rt=(Je|0)>1,qe=1,ee=W+((q<<1)+2)|0,j=le+(je+1<<1)|0,O=0;t:for(;;){if(rt)for(Ce=1,he=j,ce=O;;){do if((fe[ee>>0]|0|0)>(X|0))ne[he>>1]=0,O=ce;else{if(O=ne[he+(pt<<1)>>1]|0,O<<16>>16>0){ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(W=ne[he+(Qe<<1)>>1]|0,q=W<<16>>16,O=ne[he+(We<<1)>>1]|0,le=O<<16>>16,j=O<<16>>16>0,W<<16>>16<=0){if(j){ne[he>>1]=O,O=le*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-3<<2)|0,(F[j>>2]|0)<(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=ne[he+-2>>1]|0,O<<16>>16>0){if(ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Ce|0)){O=ce;break}F[O>>2]=Ce,O=ce;break}else{if(O=ce+1|0,(ce|0)>32767)break t;ne[he>>1]=O,F[G+1179664+(ce<<2)>>2]=O<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(j){if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(j=ne[he+-2>>1]|0,j<<16>>16<=0){ne[he>>1]=W,O=q*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-4<<2)|0,(F[j>>2]|0)>(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=ce}while(!1);if(Ce=Ce+1|0,ee=ee+2|0,j=he+2|0,(Ce|0)>=(Je|0))break;he=j,ce=O}if(qe=qe+1|0,(qe|0)>=(lt|0)){le=O,At=52;break e}else ee=ee+De|0,j=j+4|0}Jn(3,3904,Et),O=-1}else le=0,At=52;while(!1);if((At|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function xh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(Je=je+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(Je<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+(je<<1)|0,J=J+(je<<1)|0;J=G+1179664|0,pt=0-je|0,Qe=1-je|0,We=~je,De=(q<<1)+8|0;e:do if((lt|0)>1){rt=(Je|0)>1,qe=1,ee=W+((q<<2)+4)|0,j=le+(je+1<<1)|0,O=0;t:for(;;){if(rt)for(Ce=1,he=j,ce=O;;){do if((fe[ee+1>>0]|0|0)>(X|0))ne[he>>1]=0,O=ce;else{if(O=ne[he+(pt<<1)>>1]|0,O<<16>>16>0){ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(W=ne[he+(Qe<<1)>>1]|0,q=W<<16>>16,O=ne[he+(We<<1)>>1]|0,le=O<<16>>16,j=O<<16>>16>0,W<<16>>16<=0){if(j){ne[he>>1]=O,O=le*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-3<<2)|0,(F[j>>2]|0)<(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=ne[he+-2>>1]|0,O<<16>>16>0){if(ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Ce|0)){O=ce;break}F[O>>2]=Ce,O=ce;break}else{if(O=ce+1|0,(ce|0)>32767)break t;ne[he>>1]=O,F[G+1179664+(ce<<2)>>2]=O<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(j){if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(j=ne[he+-2>>1]|0,j<<16>>16<=0){ne[he>>1]=W,O=q*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-4<<2)|0,(F[j>>2]|0)>(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=ce}while(!1);if(Ce=Ce+1|0,ee=ee+4|0,j=he+2|0,(Ce|0)>=(Je|0))break;he=j,ce=O}if(qe=qe+1|0,(qe|0)>=(lt|0)){le=O,At=52;break e}else ee=ee+De|0,j=j+4|0}Jn(3,3904,Et),O=-1}else le=0,At=52;while(!1);if((At|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function du(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(Je=je+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(Je<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+(je<<1)|0,J=J+(je<<1)|0;J=G+1179664|0,pt=0-je|0,Qe=1-je|0,We=~je,De=(q<<1)+8|0;e:do if((lt|0)>1){rt=(Je|0)>1,qe=1,ee=W+((q<<2)+4)|0,j=le+(je+1<<1)|0,O=0;t:for(;;){if(rt)for(Ce=1,he=j,ce=O;;){do if((fe[ee>>0]|0|0)>(X|0))ne[he>>1]=0,O=ce;else{if(O=ne[he+(pt<<1)>>1]|0,O<<16>>16>0){ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(W=ne[he+(Qe<<1)>>1]|0,q=W<<16>>16,O=ne[he+(We<<1)>>1]|0,le=O<<16>>16,j=O<<16>>16>0,W<<16>>16<=0){if(j){ne[he>>1]=O,O=le*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-3<<2)|0,(F[j>>2]|0)<(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=ne[he+-2>>1]|0,O<<16>>16>0){if(ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Ce|0)){O=ce;break}F[O>>2]=Ce,O=ce;break}else{if(O=ce+1|0,(ce|0)>32767)break t;ne[he>>1]=O,F[G+1179664+(ce<<2)>>2]=O<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(j){if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(j=ne[he+-2>>1]|0,j<<16>>16<=0){ne[he>>1]=W,O=q*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-4<<2)|0,(F[j>>2]|0)>(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=ce}while(!1);if(Ce=Ce+1|0,ee=ee+4|0,j=he+2|0,(Ce|0)>=(Je|0))break;he=j,ce=O}if(qe=qe+1|0,(qe|0)>=(lt|0)){le=O,At=52;break e}else ee=ee+De|0,j=j+4|0}Jn(3,3904,Et),O=-1}else le=0,At=52;while(!1);if((At|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function wh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O*3|0)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(lt|0))ne[Ce>>1]=0,O=he;else{if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}while(!1);if(De=De+1|0,X=X+3|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+6|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Sh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<1)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){le=fe[X>>0]|0,ce=fe[X+1>>0]|0;do if(((le&248)+10+(le<<5&224)+(ce>>>3&28)+(ce<<3&248)|0)>(lt|0))ne[Ce>>1]=0,O=he;else{if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}while(!1);if(De=De+1|0,X=X+2|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+4|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Mh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<2)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(lt|0))ne[Ce>>1]=0,O=he;else{if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}while(!1);if(De=De+1|0,X=X+4|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+8|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function bh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<1)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){ce=fe[X>>0]|0;do if(((ce&240)+24+(ce<<4&240)+((fe[X+1>>0]|0)&240)|0)>(lt|0))ne[Ce>>1]=0,O=he;else{if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}while(!1);if(De=De+1|0,X=X+2|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+4|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function sc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<1)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){le=fe[X>>0]|0,ce=fe[X+1>>0]|0;do if(((le&248)+12+(le<<5&224)+(ce>>>3&24)+(ce<<2&248)|0)>(lt|0))ne[Ce>>1]=0,O=he;else{if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}while(!1);if(De=De+1|0,X=X+2|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+4|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Sd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<2)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){do if(((fe[X+2>>0]|0)+(fe[X+1>>0]|0)+(fe[X+3>>0]|0)|0)>(lt|0))ne[Ce>>1]=0,O=he;else{if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}while(!1);if(De=De+1|0,X=X+4|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+8|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Md(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+O|0,W=le+(O<<1)|0,O=0;t:for(;;){if(qe)for(Qe=1,De=W,Ce=O;;){do if((fe[ee>>0]|0|0)>(X|0))ne[De>>1]=0,O=Ce;else{if(O=ne[De+(rt<<1)>>1]|0,O<<16>>16>0){ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(le=ne[De+(We<<1)>>1]|0,ce=le<<16>>16,O=ne[De+(pt<<1)>>1]|0,he=O<<16>>16,W=O<<16>>16>0,le<<16>>16<=0){if(W){ne[De>>1]=O,O=he*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-3<<2)|0,(F[W>>2]|0)<(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16>0){if(ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[De>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(W){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16<=0){ne[De>>1]=le,O=ce*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-4<<2)|0,(F[W>>2]|0)>(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(ce=F[G+1179664+(ce+-1<<2)>>2]|0,O=F[G+1179664+((O<<16>>16)+-1<<2)>>2]|0,(ce|0)>(O|0)){if(ne[De>>1]=O,(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0}else if(ne[De>>1]=ce,(ce|0)<(O|0)&(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}while(!1);if(Qe=Qe+1|0,ee=ee+1|0,W=De+2|0,(Qe|0)>=(lt|0))break;De=W,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){he=O,je=52;break e}else ee=ee+2|0,W=W+4|0}Jn(3,3904,At),O=-1}else he=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function bd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+(O<<1)|0,W=le+(O<<1)|0,O=0;t:for(;;){if(qe)for(Qe=1,De=W,Ce=O;;){do if((fe[ee+1>>0]|0|0)>(X|0))ne[De>>1]=0,O=Ce;else{if(O=ne[De+(rt<<1)>>1]|0,O<<16>>16>0){ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(le=ne[De+(We<<1)>>1]|0,ce=le<<16>>16,O=ne[De+(pt<<1)>>1]|0,he=O<<16>>16,W=O<<16>>16>0,le<<16>>16<=0){if(W){ne[De>>1]=O,O=he*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-3<<2)|0,(F[W>>2]|0)<(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16>0){if(ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[De>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(W){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(W=ne[De+-2>>1]|0,W<<16>>16<=0){ne[De>>1]=le,O=ce*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-4<<2)|0,(F[W>>2]|0)>(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}while(!1);if(Qe=Qe+1|0,ee=ee+2|0,W=De+2|0,(Qe|0)>=(lt|0))break;De=W,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){he=O,je=52;break e}else ee=ee+4|0,W=W+4|0}Jn(3,3904,At),O=-1}else he=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Th(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+(O<<1)|0,W=le+(O<<1)|0,O=0;t:for(;;){if(qe)for(Qe=1,De=W,Ce=O;;){do if((fe[ee>>0]|0|0)>(X|0))ne[De>>1]=0,O=Ce;else{if(O=ne[De+(rt<<1)>>1]|0,O<<16>>16>0){ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(le=ne[De+(We<<1)>>1]|0,ce=le<<16>>16,O=ne[De+(pt<<1)>>1]|0,he=O<<16>>16,W=O<<16>>16>0,le<<16>>16<=0){if(W){ne[De>>1]=O,O=he*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-3<<2)|0,(F[W>>2]|0)<(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16>0){if(ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[De>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(W){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16<=0){ne[De>>1]=le,O=ce*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-4<<2)|0,(F[W>>2]|0)>(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(ce=F[G+1179664+(ce+-1<<2)>>2]|0,O=F[G+1179664+((O<<16>>16)+-1<<2)>>2]|0,(ce|0)>(O|0)){if(ne[De>>1]=O,(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0}else if(ne[De>>1]=ce,(ce|0)<(O|0)&(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}while(!1);if(Qe=Qe+1|0,ee=ee+2|0,W=De+2|0,(Qe|0)>=(lt|0))break;De=W,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){he=O,je=52;break e}else ee=ee+4|0,W=W+4|0}Jn(3,3904,At),O=-1}else he=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Td(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+O|0,W=le+(O<<1)|0,le=X+O|0,O=0;t:for(;;){if(qe)for(Qe=1,De=ee,Ce=O;;){do if((fe[De>>0]|0)>(fe[le>>0]|0))ne[W>>1]=0,O=Ce;else{if(O=ne[W+(rt<<1)>>1]|0,O<<16>>16>0){ne[W>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(X=ne[W+(We<<1)>>1]|0,ce=X<<16>>16,O=ne[W+(pt<<1)>>1]|0,he=O<<16>>16,ee=O<<16>>16>0,X<<16>>16<=0){if(ee){ne[W>>1]=O,O=he*7|0,ee=G+1310736+(O+-7<<2)|0,F[ee>>2]=(F[ee>>2]|0)+1,ee=G+1310736+(O+-6<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Qe,ee=G+1310736+(O+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=G+1310736+(O+-3<<2)|0,(F[ee>>2]|0)<(Qe|0)&&(F[ee>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[W+-2>>1]|0,O<<16>>16>0){if(ne[W>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(ee){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(ee=0,X=J;;)if((F[X>>2]|0)==(O|0)&&(F[X>>2]=ce),ee=ee+1|0,(ee|0)>=(Ce|0)){O=ce;break}else X=X+4|0;else O=ce;else if(ne[W>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(ee=0,X=J;(F[X>>2]|0)==(ce|0)&&(F[X>>2]=O),ee=ee+1|0,!((ee|0)>=(Ce|0));)X=X+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[W+-2>>1]|0,O<<16>>16<=0){ne[W>>1]=X,O=ce*7|0,ee=G+1310736+(O+-7<<2)|0,F[ee>>2]=(F[ee>>2]|0)+1,ee=G+1310736+(O+-6<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Qe,ee=G+1310736+(O+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=G+1310736+(O+-4<<2)|0,(F[ee>>2]|0)>(Qe|0)&&(F[ee>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(ce=F[G+1179664+(ce+-1<<2)>>2]|0,O=F[G+1179664+((O<<16>>16)+-1<<2)>>2]|0,(ce|0)>(O|0)){if(ne[W>>1]=O,(Ce|0)>0)for(ee=0,X=J;(F[X>>2]|0)==(ce|0)&&(F[X>>2]=O),ee=ee+1|0,!((ee|0)>=(Ce|0));)X=X+4|0}else if(ne[W>>1]=ce,(ce|0)<(O|0)&(Ce|0)>0)for(ee=0,X=J;;)if((F[X>>2]|0)==(O|0)&&(F[X>>2]=ce),ee=ee+1|0,(ee|0)>=(Ce|0)){O=ce;break}else X=X+4|0;else O=ce;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}while(!1);if(Qe=Qe+1|0,ee=De+1|0,le=le+1|0,W=W+2|0,(Qe|0)>=(lt|0))break;De=ee,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){ce=O,je=52;break e}else ee=ee+2|0,W=W+4|0,le=le+2|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(ce|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(ce|0);)W=W+1|0,J=J+4|0;if(X=G+8|0,O=ee+-1|0,F[X>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[X>>2]|0))}if((ce|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(ce|0))}if((F[X>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[X>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Id(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q*3|0)+12|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q*6|0)+6)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(qe|0)){if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}else ne[ce>>1]=0,O=le;while(!1);if(he=he+1|0,X=X+6|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Rd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<1)+8|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<2)+4)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){W=fe[X>>0]|0,q=fe[X+1>>0]|0;do if(((W&248)+10+(W<<5&224)+(q>>>3&28)+(q<<3&248)|0)>(qe|0)){if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}else ne[ce>>1]=0,O=le;while(!1);if(he=he+1|0,X=X+4|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Bd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<2)+16|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<3)+8)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(qe|0)){if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}else ne[ce>>1]=0,O=le;while(!1);if(he=he+1|0,X=X+8|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Ld(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<1)+8|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<2)+4)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){q=fe[X>>0]|0;do if(((q&240)+24+(q<<4&240)+((fe[X+1>>0]|0)&240)|0)>(qe|0)){if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}else ne[ce>>1]=0,O=le;while(!1);if(he=he+1|0,X=X+4|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function zu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<1)+8|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<2)+4)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){W=fe[X>>0]|0,q=fe[X+1>>0]|0;do if(((W&248)+12+(W<<5&224)+(q>>>3&24)+(q<<2&248)|0)>(qe|0)){if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}else ne[ce>>1]=0,O=le;while(!1);if(he=he+1|0,X=X+4|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function j0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(qe=X*3|0,Je=je+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)X=X+(je<<1)|0,ee=ee+(je<<1)|0;ee=G+1179664|0,We=0-je|0,De=1-je|0,Qe=~je,Ce=(q<<2)+16|0;e:do if((lt|0)>1){pt=(Je|0)>1,rt=1,X=W+((q<<3)+8)|0,J=le+(je+1<<1)|0,O=0;t:for(;;){if(pt)for(he=1,ce=J,le=O;;){do if(((fe[X+2>>0]|0)+(fe[X+1>>0]|0)+(fe[X+3>>0]|0)|0)>(qe|0)){if(O=ne[ce+(We<<1)>>1]|0,O<<16>>16>0){ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(j=ne[ce+(De<<1)>>1]|0,W=j<<16>>16,O=ne[ce+(Qe<<1)>>1]|0,q=O<<16>>16,J=O<<16>>16>0,j<<16>>16<=0){if(J){ne[ce>>1]=O,O=q*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=ne[ce+-2>>1]|0,O<<16>>16>0){if(ne[ce>>1]=O,O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(he|0)){O=le;break}F[O>>2]=he,O=le;break}else{if(O=le+1|0,(le|0)>32767)break t;ne[ce>>1]=O,F[G+1179664+(le<<2)>>2]=O<<16>>16,le=le*7|0,F[G+1310736+(le<<2)>>2]=1,F[G+1310736+(le+1<<2)>>2]=he,F[G+1310736+(le+2<<2)>>2]=rt,F[G+1310736+(le+3<<2)>>2]=he,F[G+1310736+(le+4<<2)>>2]=he,F[G+1310736+(le+5<<2)>>2]=rt,F[G+1310736+(le+6<<2)>>2]=rt;break}}if(J){if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+(q+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,q=G+1310736+(O+-5<<2)|0,F[q>>2]=(F[q>>2]|0)+rt,F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(J=ne[ce+-2>>1]|0,J<<16>>16<=0){ne[ce>>1]=j,O=W*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+he,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+rt,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(he|0)&&(F[J>>2]=he),F[G+1310736+(O+-1<<2)>>2]=rt,O=le;break}if(O=F[G+1179664+(W+-1<<2)>>2]|0,W=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(W|0))if(ne[ce>>1]=W,(le|0)>0)for(J=0,j=ee;;)if((F[j>>2]|0)==(O|0)&&(F[j>>2]=W),J=J+1|0,(J|0)>=(le|0)){O=W;break}else j=j+4|0;else O=W;else if(ne[ce>>1]=O,(O|0)<(W|0)&(le|0)>0)for(J=0,j=ee;(F[j>>2]|0)==(W|0)&&(F[j>>2]=O),J=J+1|0,!((J|0)>=(le|0));)j=j+4|0;O=(O<<16>>16)*7|0,q=G+1310736+(O+-7<<2)|0,F[q>>2]=(F[q>>2]|0)+1,q=G+1310736+(O+-6<<2)|0,F[q>>2]=(F[q>>2]|0)+he,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+rt,O=le}else ne[ce>>1]=0,O=le;while(!1);if(he=he+1|0,X=X+8|0,J=ce+2|0,(he|0)>=(Je|0))break;ce=J,le=O}if(rt=rt+1|0,(rt|0)>=(lt|0)){q=O,At=52;break e}else X=X+Ce|0,J=J+4|0}Jn(3,3904,Et),O=-1}else q=0,At=52;while(!1);if((At|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function oc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(Je=je+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(Je<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+(je<<1)|0,J=J+(je<<1)|0;J=G+1179664|0,pt=0-je|0,Qe=1-je|0,We=~je,De=q+4|0;e:do if((lt|0)>1){rt=(Je|0)>1,qe=1,ee=W+((q<<1)+2)|0,j=le+(je+1<<1)|0,O=0;t:for(;;){if(rt)for(Ce=1,he=j,ce=O;;){do if((fe[ee>>0]|0|0)>(X|0)){if(O=ne[he+(pt<<1)>>1]|0,O<<16>>16>0){ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(W=ne[he+(Qe<<1)>>1]|0,q=W<<16>>16,O=ne[he+(We<<1)>>1]|0,le=O<<16>>16,j=O<<16>>16>0,W<<16>>16<=0){if(j){ne[he>>1]=O,O=le*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-3<<2)|0,(F[j>>2]|0)<(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=ne[he+-2>>1]|0,O<<16>>16>0){if(ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Ce|0)){O=ce;break}F[O>>2]=Ce,O=ce;break}else{if(O=ce+1|0,(ce|0)>32767)break t;ne[he>>1]=O,F[G+1179664+(ce<<2)>>2]=O<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(j){if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(j=ne[he+-2>>1]|0,j<<16>>16<=0){ne[he>>1]=W,O=q*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-4<<2)|0,(F[j>>2]|0)>(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=ce}else ne[he>>1]=0,O=ce;while(!1);if(Ce=Ce+1|0,ee=ee+2|0,j=he+2|0,(Ce|0)>=(Je|0))break;he=j,ce=O}if(qe=qe+1|0,(qe|0)>=(lt|0)){le=O,At=52;break e}else ee=ee+De|0,j=j+4|0}Jn(3,3904,Et),O=-1}else le=0,At=52;while(!1);if((At|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function La(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(Je=je+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(Je<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+(je<<1)|0,J=J+(je<<1)|0;J=G+1179664|0,pt=0-je|0,Qe=1-je|0,We=~je,De=(q<<1)+8|0;e:do if((lt|0)>1){rt=(Je|0)>1,qe=1,ee=W+((q<<2)+4)|0,j=le+(je+1<<1)|0,O=0;t:for(;;){if(rt)for(Ce=1,he=j,ce=O;;){do if((fe[ee+1>>0]|0|0)>(X|0)){if(O=ne[he+(pt<<1)>>1]|0,O<<16>>16>0){ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(W=ne[he+(Qe<<1)>>1]|0,q=W<<16>>16,O=ne[he+(We<<1)>>1]|0,le=O<<16>>16,j=O<<16>>16>0,W<<16>>16<=0){if(j){ne[he>>1]=O,O=le*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-3<<2)|0,(F[j>>2]|0)<(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=ne[he+-2>>1]|0,O<<16>>16>0){if(ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Ce|0)){O=ce;break}F[O>>2]=Ce,O=ce;break}else{if(O=ce+1|0,(ce|0)>32767)break t;ne[he>>1]=O,F[G+1179664+(ce<<2)>>2]=O<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(j){if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(j=ne[he+-2>>1]|0,j<<16>>16<=0){ne[he>>1]=W,O=q*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-4<<2)|0,(F[j>>2]|0)>(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=ce}else ne[he>>1]=0,O=ce;while(!1);if(Ce=Ce+1|0,ee=ee+4|0,j=he+2|0,(Ce|0)>=(Je|0))break;he=j,ce=O}if(qe=qe+1|0,(qe|0)>=(lt|0)){le=O,At=52;break e}else ee=ee+De|0,j=j+4|0}Jn(3,3904,Et),O=-1}else le=0,At=52;while(!1);if((At|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Wa(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,Et=Qt,je=(q|0)/2|0,Ye=(j|0)/2|0,le=F[G>>2]|0,lt=Ye+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(lt,je)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(je|0));)ee=ee+2|0,J=J+2|0;if(Je=je+-1|0,(j|0)>1)for(O=0,ee=le,J=le+(Je<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+(je<<1)|0,J=J+(je<<1)|0;J=G+1179664|0,pt=0-je|0,Qe=1-je|0,We=~je,De=(q<<1)+8|0;e:do if((lt|0)>1){rt=(Je|0)>1,qe=1,ee=W+((q<<2)+4)|0,j=le+(je+1<<1)|0,O=0;t:for(;;){if(rt)for(Ce=1,he=j,ce=O;;){do if((fe[ee>>0]|0|0)>(X|0)){if(O=ne[he+(pt<<1)>>1]|0,O<<16>>16>0){ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(W=ne[he+(Qe<<1)>>1]|0,q=W<<16>>16,O=ne[he+(We<<1)>>1]|0,le=O<<16>>16,j=O<<16>>16>0,W<<16>>16<=0){if(j){ne[he>>1]=O,O=le*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-3<<2)|0,(F[j>>2]|0)<(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=ne[he+-2>>1]|0,O<<16>>16>0){if(ne[he>>1]=O,O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Ce|0)){O=ce;break}F[O>>2]=Ce,O=ce;break}else{if(O=ce+1|0,(ce|0)>32767)break t;ne[he>>1]=O,F[G+1179664+(ce<<2)>>2]=O<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(j){if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(O+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(j=ne[he+-2>>1]|0,j<<16>>16<=0){ne[he>>1]=W,O=q*7|0,j=G+1310736+(O+-7<<2)|0,F[j>>2]=(F[j>>2]|0)+1,j=G+1310736+(O+-6<<2)|0,F[j>>2]=(F[j>>2]|0)+Ce,j=G+1310736+(O+-5<<2)|0,F[j>>2]=(F[j>>2]|0)+qe,j=G+1310736+(O+-4<<2)|0,(F[j>>2]|0)>(Ce|0)&&(F[j>>2]=Ce),F[G+1310736+(O+-1<<2)>>2]=qe,O=ce;break}if(O=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((j<<16>>16)+-1<<2)>>2]|0,(O|0)>(q|0))if(ne[he>>1]=q,(ce|0)>0)for(j=0,W=J;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=q),j=j+1|0,(j|0)>=(ce|0)){O=q;break}else W=W+4|0;else O=q;else if(ne[he>>1]=O,(O|0)<(q|0)&(ce|0)>0)for(j=0,W=J;(F[W>>2]|0)==(q|0)&&(F[W>>2]=O),j=j+1|0,!((j|0)>=(ce|0));)W=W+4|0;O=(O<<16>>16)*7|0,le=G+1310736+(O+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(O+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=ce}else ne[he>>1]=0,O=ce;while(!1);if(Ce=Ce+1|0,ee=ee+4|0,j=he+2|0,(Ce|0)>=(Je|0))break;he=j,ce=O}if(qe=qe+1|0,(qe|0)>=(lt|0)){le=O,At=52;break e}else ee=ee+De|0,j=j+4|0}Jn(3,3904,Et),O=-1}else le=0,At=52;while(!1);if((At|0)==52){if(W=G+12|0,(le|0)<1)ee=1;else for(j=1,ee=1;O=F[J>>2]|0,(O|0)==(j|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(j|0)<(le|0);)j=j+1|0,J=J+4|0;if(q=G+8|0,O=ee+-1|0,F[q>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do At=O<<2,F[G+131084+(At<<2)>>2]=je,F[G+131084+((At|1)<<2)>>2]=0,F[G+131084+((At|2)<<2)>>2]=Ye,F[G+131084+((At|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[q>>2]|0))}if((le|0)>0){W=0;do J=(F[G+1179664+(W<<2)>>2]|0)+-1|0,j=W*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(j<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(j+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(j+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(j+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(j+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(j+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(j+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),W=W+1|0;while((W|0)<(le|0))}if((F[q>>2]|0)>0){O=0;do je=G+12+(O<<2)|0,Ye=O<<1,At=G+655376+(Ye<<3)|0,se[At>>3]=+se[At>>3]/+(F[je>>2]|0),Ye=G+655376+((Ye|1)<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[je>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Wu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O*3|0)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(lt|0)){if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}else ne[Ce>>1]=0,O=he;while(!1);if(De=De+1|0,X=X+3|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+6|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Ll(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<1)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){le=fe[X>>0]|0,ce=fe[X+1>>0]|0;do if(((le&248)+10+(le<<5&224)+(ce>>>3&28)+(ce<<3&248)|0)>(lt|0)){if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}else ne[Ce>>1]=0,O=he;while(!1);if(De=De+1|0,X=X+2|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+4|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function ac(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<2)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){do if(((fe[X+1>>0]|0)+(fe[X>>0]|0)+(fe[X+2>>0]|0)|0)>(lt|0)){if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}else ne[Ce>>1]=0,O=he;while(!1);if(De=De+1|0,X=X+4|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+8|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function c0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<1)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){ce=fe[X>>0]|0;do if(((ce&240)+24+(ce<<4&240)+((fe[X+1>>0]|0)&240)|0)>(lt|0)){if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}else ne[Ce>>1]=0,O=he;while(!1);if(De=De+1|0,X=X+2|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+4|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function qo(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<1)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){le=fe[X>>0]|0,ce=fe[X+1>>0]|0;do if(((le&248)+12+(le<<5&224)+(ce>>>3&24)+(ce<<2&248)|0)>(lt|0)){if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}else ne[Ce>>1]=0,O=he;while(!1);if(De=De+1|0,X=X+2|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+4|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Dl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=X*3|0,Je=q+-1|0,(j|0)>0)for(O=0,X=le,ee=le+(Je<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,pt=0-q|0,Qe=1-q|0,We=~q;e:do if((Et|0)>1){rt=(Je|0)>1,qe=1,X=W+(O<<2)|0,J=le+(O<<1)|0,O=0;t:for(;;){if(rt)for(De=1,Ce=J,he=O;;){do if(((fe[X+2>>0]|0)+(fe[X+1>>0]|0)+(fe[X+3>>0]|0)|0)>(lt|0)){if(O=ne[Ce+(pt<<1)>>1]|0,O<<16>>16>0){ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(W=ne[Ce+(Qe<<1)>>1]|0,le=W<<16>>16,O=ne[Ce+(We<<1)>>1]|0,ce=O<<16>>16,J=O<<16>>16>0,W<<16>>16<=0){if(J){ne[Ce>>1]=O,O=ce*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-3<<2)|0,(F[J>>2]|0)<(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=ne[Ce+-2>>1]|0,O<<16>>16>0){if(ne[Ce>>1]=O,O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(De|0)){O=he;break}F[O>>2]=De,O=he;break}else{if(O=he+1|0,(he|0)>32767)break t;ne[Ce>>1]=O,F[G+1179664+(he<<2)>>2]=O<<16>>16,he=he*7|0,F[G+1310736+(he<<2)>>2]=1,F[G+1310736+(he+1<<2)>>2]=De,F[G+1310736+(he+2<<2)>>2]=qe,F[G+1310736+(he+3<<2)>>2]=De,F[G+1310736+(he+4<<2)>>2]=De,F[G+1310736+(he+5<<2)>>2]=qe,F[G+1310736+(he+6<<2)>>2]=qe;break}}if(J){if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+(ce+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,ce=G+1310736+(O+-5<<2)|0,F[ce>>2]=(F[ce>>2]|0)+qe,F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(J=ne[Ce+-2>>1]|0,J<<16>>16<=0){ne[Ce>>1]=W,O=le*7|0,J=G+1310736+(O+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(O+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+De,J=G+1310736+(O+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(O+-4<<2)|0,(F[J>>2]|0)>(De|0)&&(F[J>>2]=De),F[G+1310736+(O+-1<<2)>>2]=qe,O=he;break}if(O=F[G+1179664+(le+-1<<2)>>2]|0,le=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(O|0)>(le|0))if(ne[Ce>>1]=le,(he|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(O|0)&&(F[W>>2]=le),J=J+1|0,(J|0)>=(he|0)){O=le;break}else W=W+4|0;else O=le;else if(ne[Ce>>1]=O,(O|0)<(le|0)&(he|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(le|0)&&(F[W>>2]=O),J=J+1|0,!((J|0)>=(he|0));)W=W+4|0;O=(O<<16>>16)*7|0,ce=G+1310736+(O+-7<<2)|0,F[ce>>2]=(F[ce>>2]|0)+1,ce=G+1310736+(O+-6<<2)|0,F[ce>>2]=(F[ce>>2]|0)+De,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+qe,O=he}else ne[Ce>>1]=0,O=he;while(!1);if(De=De+1|0,X=X+4|0,J=Ce+2|0,(De|0)>=(Je|0))break;Ce=J,he=O}if(qe=qe+1|0,(qe|0)>=(Et|0)){ce=O,je=52;break e}else X=X+8|0,J=J+4|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Dd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+O|0,W=le+(O<<1)|0,O=0;t:for(;;){if(qe)for(Qe=1,De=W,Ce=O;;){do if((fe[ee>>0]|0|0)>(X|0)){if(O=ne[De+(rt<<1)>>1]|0,O<<16>>16>0){ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(le=ne[De+(We<<1)>>1]|0,ce=le<<16>>16,O=ne[De+(pt<<1)>>1]|0,he=O<<16>>16,W=O<<16>>16>0,le<<16>>16<=0){if(W){ne[De>>1]=O,O=he*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-3<<2)|0,(F[W>>2]|0)<(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16>0){if(ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[De>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(W){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16<=0){ne[De>>1]=le,O=ce*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-4<<2)|0,(F[W>>2]|0)>(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(ce=F[G+1179664+(ce+-1<<2)>>2]|0,O=F[G+1179664+((O<<16>>16)+-1<<2)>>2]|0,(ce|0)>(O|0)){if(ne[De>>1]=O,(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0}else if(ne[De>>1]=ce,(ce|0)<(O|0)&(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}else ne[De>>1]=0,O=Ce;while(!1);if(Qe=Qe+1|0,ee=ee+1|0,W=De+2|0,(Qe|0)>=(lt|0))break;De=W,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){he=O,je=52;break e}else ee=ee+2|0,W=W+4|0}Jn(3,3904,At),O=-1}else he=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Pd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+(O<<1)|0,W=le+(O<<1)|0,O=0;t:for(;;){if(qe)for(Qe=1,De=W,Ce=O;;){do if((fe[ee+1>>0]|0|0)>(X|0)){if(O=ne[De+(rt<<1)>>1]|0,O<<16>>16>0){ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(le=ne[De+(We<<1)>>1]|0,ce=le<<16>>16,O=ne[De+(pt<<1)>>1]|0,he=O<<16>>16,W=O<<16>>16>0,le<<16>>16<=0){if(W){ne[De>>1]=O,O=he*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-3<<2)|0,(F[W>>2]|0)<(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16>0){if(ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[De>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(W){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(W=ne[De+-2>>1]|0,W<<16>>16<=0){ne[De>>1]=le,O=ce*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-4<<2)|0,(F[W>>2]|0)>(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}else ne[De>>1]=0,O=Ce;while(!1);if(Qe=Qe+1|0,ee=ee+2|0,W=De+2|0,(Qe|0)>=(lt|0))break;De=W,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){he=O,je=52;break e}else ee=ee+4|0,W=W+4|0}Jn(3,3904,At),O=-1}else he=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Wc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+(O<<1)|0,W=le+(O<<1)|0,O=0;t:for(;;){if(qe)for(Qe=1,De=W,Ce=O;;){do if((fe[ee>>0]|0|0)>(X|0)){if(O=ne[De+(rt<<1)>>1]|0,O<<16>>16>0){ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(le=ne[De+(We<<1)>>1]|0,ce=le<<16>>16,O=ne[De+(pt<<1)>>1]|0,he=O<<16>>16,W=O<<16>>16>0,le<<16>>16<=0){if(W){ne[De>>1]=O,O=he*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-3<<2)|0,(F[W>>2]|0)<(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16>0){if(ne[De>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[De>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(W){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[De>>1]=ce,(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;else if(ne[De>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[De+-2>>1]|0,O<<16>>16<=0){ne[De>>1]=le,O=ce*7|0,W=G+1310736+(O+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(O+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe,W=G+1310736+(O+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+Je,W=G+1310736+(O+-4<<2)|0,(F[W>>2]|0)>(Qe|0)&&(F[W>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(ce=F[G+1179664+(ce+-1<<2)>>2]|0,O=F[G+1179664+((O<<16>>16)+-1<<2)>>2]|0,(ce|0)>(O|0)){if(ne[De>>1]=O,(Ce|0)>0)for(W=0,le=J;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=O),W=W+1|0,!((W|0)>=(Ce|0));)le=le+4|0}else if(ne[De>>1]=ce,(ce|0)<(O|0)&(Ce|0)>0)for(W=0,le=J;;)if((F[le>>2]|0)==(O|0)&&(F[le>>2]=ce),W=W+1|0,(W|0)>=(Ce|0)){O=ce;break}else le=le+4|0;else O=ce;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}else ne[De>>1]=0,O=Ce;while(!1);if(Qe=Qe+1|0,ee=ee+2|0,W=De+2|0,(Qe|0)>=(lt|0))break;De=W,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){he=O,je=52;break e}else ee=ee+4|0,W=W+4|0}Jn(3,3904,At),O=-1}else he=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Ih(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;if(Ye=me,me=me+16|0,At=Ye,le=F[G>>2]|0,Et=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(Et,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(lt=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(lt<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((Et|0)>1){qe=(lt|0)>1,Je=1,ee=W+O|0,W=le+(O<<1)|0,le=X+O|0,O=0;t:for(;;){if(qe)for(Qe=1,De=ee,Ce=O;;){do if((fe[De>>0]|0)>(fe[le>>0]|0)){if(O=ne[W+(rt<<1)>>1]|0,O<<16>>16>0){ne[W>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(X=ne[W+(We<<1)>>1]|0,ce=X<<16>>16,O=ne[W+(pt<<1)>>1]|0,he=O<<16>>16,ee=O<<16>>16>0,X<<16>>16<=0){if(ee){ne[W>>1]=O,O=he*7|0,ee=G+1310736+(O+-7<<2)|0,F[ee>>2]=(F[ee>>2]|0)+1,ee=G+1310736+(O+-6<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Qe,ee=G+1310736+(O+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=G+1310736+(O+-3<<2)|0,(F[ee>>2]|0)<(Qe|0)&&(F[ee>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[W+-2>>1]|0,O<<16>>16>0){if(ne[W>>1]=O,O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,O=G+1310736+(O+-3<<2)|0,(F[O>>2]|0)>=(Qe|0)){O=Ce;break}F[O>>2]=Qe,O=Ce;break}else{if(O=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=O,F[G+1179664+(Ce<<2)>>2]=O<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(ee){if(O=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(O|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(ee=0,X=J;;)if((F[X>>2]|0)==(O|0)&&(F[X>>2]=ce),ee=ee+1|0,(ee|0)>=(Ce|0)){O=ce;break}else X=X+4|0;else O=ce;else if(ne[W>>1]=O,(O|0)<(ce|0)&(Ce|0)>0)for(ee=0,X=J;(F[X>>2]|0)==(ce|0)&&(F[X>>2]=O),ee=ee+1|0,!((ee|0)>=(Ce|0));)X=X+4|0;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(O+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(O=ne[W+-2>>1]|0,O<<16>>16<=0){ne[W>>1]=X,O=ce*7|0,ee=G+1310736+(O+-7<<2)|0,F[ee>>2]=(F[ee>>2]|0)+1,ee=G+1310736+(O+-6<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Qe,ee=G+1310736+(O+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+Je,ee=G+1310736+(O+-4<<2)|0,(F[ee>>2]|0)>(Qe|0)&&(F[ee>>2]=Qe),F[G+1310736+(O+-1<<2)>>2]=Je,O=Ce;break}if(ce=F[G+1179664+(ce+-1<<2)>>2]|0,O=F[G+1179664+((O<<16>>16)+-1<<2)>>2]|0,(ce|0)>(O|0)){if(ne[W>>1]=O,(Ce|0)>0)for(ee=0,X=J;(F[X>>2]|0)==(ce|0)&&(F[X>>2]=O),ee=ee+1|0,!((ee|0)>=(Ce|0));)X=X+4|0}else if(ne[W>>1]=ce,(ce|0)<(O|0)&(Ce|0)>0)for(ee=0,X=J;;)if((F[X>>2]|0)==(O|0)&&(F[X>>2]=ce),ee=ee+1|0,(ee|0)>=(Ce|0)){O=ce;break}else X=X+4|0;else O=ce;O=(O<<16>>16)*7|0,he=G+1310736+(O+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(O+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,O=G+1310736+(O+-5<<2)|0,F[O>>2]=(F[O>>2]|0)+Je,O=Ce}else ne[W>>1]=0,O=Ce;while(!1);if(Qe=Qe+1|0,ee=De+1|0,le=le+1|0,W=W+2|0,(Qe|0)>=(lt|0))break;De=ee,Ce=O}if(Je=Je+1|0,(Je|0)>=(Et|0)){ce=O,je=52;break e}else ee=ee+2|0,W=W+4|0,le=le+2|0}Jn(3,3904,At),O=-1}else ce=0,je=52;while(!1);if((je|0)==52){if(le=G+12|0,(ce|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(ce|0);)W=W+1|0,J=J+4|0;if(X=G+8|0,O=ee+-1|0,F[X>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=q,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=j,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[X>>2]|0))}if((ce|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(ce|0))}if((F[X>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,je=G+655376+(j<<3)|0,se[je>>3]=+se[je>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[X>>2]|0));O=0}else O=0}else O=0}return me=Ye,O|0}function Rh(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q*3|0)+12|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q*6|0)+6)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){do if(((fe[he+1>>0]|0)+(fe[he>>0]|0)+(fe[he+2>>0]|0)|0)>(Je|0))ne[j>>1]=0,ie[O>>0]=0,X=ce;else{if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}while(!1);if(Ce=Ce+1|0,J=he+6|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function $c(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<1)+8|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<2)+4)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){q=fe[he>>0]|0,le=fe[he+1>>0]|0;do if(((q&248)+10+(q<<5&224)+(le>>>3&28)+(le<<3&248)|0)>(Je|0))ne[j>>1]=0,ie[O>>0]=0,X=ce;else{if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}while(!1);if(Ce=Ce+1|0,J=he+4|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Xc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<2)+16|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<3)+8)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){do if(((fe[he+1>>0]|0)+(fe[he>>0]|0)+(fe[he+2>>0]|0)|0)>(Je|0))ne[j>>1]=0,ie[O>>0]=0,X=ce;else{if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}while(!1);if(Ce=Ce+1|0,J=he+8|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Fd(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<1)+8|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<2)+4)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){le=fe[he>>0]|0;do if(((le&240)+24+(le<<4&240)+((fe[he+1>>0]|0)&240)|0)>(Je|0))ne[j>>1]=0,ie[O>>0]=0,X=ce;else{if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}while(!1);if(Ce=Ce+1|0,J=he+4|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function fu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<1)+8|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<2)+4)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){q=fe[he>>0]|0,le=fe[he+1>>0]|0;do if(((q&248)+12+(q<<5&224)+(le>>>3&24)+(le<<2&248)|0)>(Je|0))ne[j>>1]=0,ie[O>>0]=0,X=ce;else{if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}while(!1);if(Ce=Ce+1|0,J=he+4|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Od(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;if(Bn=me,me=me+16|0,At=Bn,Ye=(q|0)/2|0,Qt=(j|0)/2|0,le=F[G>>2]|0,Et=Qt+-1|0,(q|0)>1)for(O=0,ee=le,J=le+((kt(Et,Ye)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(Ye|0));)ee=ee+2|0,J=J+2|0;if(Je=X*3|0,lt=Ye+-1|0,(j|0)>1)for(O=0,X=le,ee=le+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(Qt|0));)X=X+(Ye<<1)|0,ee=ee+(Ye<<1)|0;ee=G+1179664|0,X=Ye+1|0,pt=0-Ye|0,Qe=1-Ye|0,We=~Ye,De=(q<<2)+16|0;e:do if((Et|0)>1){rt=(lt|0)>1,O=(F[G+4>>2]|0)+X|0,qe=1,J=W+((q<<3)+8)|0,j=le+(X<<1)|0,X=0;t:for(;;){if(rt)for(Ce=1,he=J,ce=X;;){do if(((fe[he+2>>0]|0)+(fe[he+1>>0]|0)+(fe[he+3>>0]|0)|0)>(Je|0))ne[j>>1]=0,ie[O>>0]=0,X=ce;else{if(ie[O>>0]=-1,X=ne[j+(pt<<1)>>1]|0,X<<16>>16>0){ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(W=ne[j+(Qe<<1)>>1]|0,q=W<<16>>16,X=ne[j+(We<<1)>>1]|0,le=X<<16>>16,J=X<<16>>16>0,W<<16>>16<=0){if(J){ne[j>>1]=X,X=le*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=ne[j+-2>>1]|0,X<<16>>16>0){if(ne[j>>1]=X,X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Ce|0)){X=ce;break}F[X>>2]=Ce,X=ce;break}else{if(X=ce+1|0,(ce|0)>32767)break t;ne[j>>1]=X,F[G+1179664+(ce<<2)>>2]=X<<16>>16,ce=ce*7|0,F[G+1310736+(ce<<2)>>2]=1,F[G+1310736+(ce+1<<2)>>2]=Ce,F[G+1310736+(ce+2<<2)>>2]=qe,F[G+1310736+(ce+3<<2)>>2]=Ce,F[G+1310736+(ce+4<<2)>>2]=Ce,F[G+1310736+(ce+5<<2)>>2]=qe,F[G+1310736+(ce+6<<2)>>2]=qe;break}}if(J){if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+(le+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,le=G+1310736+(X+-5<<2)|0,F[le>>2]=(F[le>>2]|0)+qe,F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(J=ne[j+-2>>1]|0,J<<16>>16<=0){ne[j>>1]=W,X=q*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Ce,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+qe,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Ce|0)&&(F[J>>2]=Ce),F[G+1310736+(X+-1<<2)>>2]=qe,X=ce;break}if(X=F[G+1179664+(q+-1<<2)>>2]|0,q=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(q|0))if(ne[j>>1]=q,(ce|0)>0)for(J=0,W=ee;;)if((F[W>>2]|0)==(X|0)&&(F[W>>2]=q),J=J+1|0,(J|0)>=(ce|0)){X=q;break}else W=W+4|0;else X=q;else if(ne[j>>1]=X,(X|0)<(q|0)&(ce|0)>0)for(J=0,W=ee;(F[W>>2]|0)==(q|0)&&(F[W>>2]=X),J=J+1|0,!((J|0)>=(ce|0));)W=W+4|0;X=(X<<16>>16)*7|0,le=G+1310736+(X+-7<<2)|0,F[le>>2]=(F[le>>2]|0)+1,le=G+1310736+(X+-6<<2)|0,F[le>>2]=(F[le>>2]|0)+Ce,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+qe,X=ce}while(!1);if(Ce=Ce+1|0,J=he+8|0,j=j+2|0,O=O+1|0,(Ce|0)>=(lt|0))break;he=J,ce=X}if(qe=qe+1|0,(qe|0)>=(Et|0)){q=X,je=52;break e}else O=O+2|0,J=J+De|0,j=j+4|0}Jn(3,3904,At),O=-1}else q=0,je=52;while(!1);if((je|0)==52){if(j=G+12|0,(q|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(q|0);)J=J+1|0,ee=ee+4|0;if(W=G+8|0,O=X+-1|0,F[W>>2]=O,O){if(ii(j|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do je=O<<2,F[G+131084+(je<<2)>>2]=Ye,F[G+131084+((je|1)<<2)>>2]=0,F[G+131084+((je|2)<<2)>>2]=Qt,F[G+131084+((je|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[W>>2]|0))}if((q|0)>0){j=0;do ee=(F[G+1179664+(j<<2)>>2]|0)+-1|0,J=j*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),j=j+1|0;while((j|0)<(q|0))}if((F[W>>2]|0)>0){O=0;do Ye=G+12+(O<<2)|0,Qt=O<<1,je=G+655376+(Qt<<3)|0,se[je>>3]=+se[je>>3]/+(F[Ye>>2]|0),Qt=G+655376+((Qt|1)<<3)|0,se[Qt>>3]=+se[Qt>>3]/+(F[Ye>>2]|0),O=O+1|0;while((O|0)<(F[W>>2]|0));O=0}else O=0}else O=0}return me=Bn,O|0}function Bh(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;(q|0)!=1?q+-1&q&&(q=tc(q)|0):q=2,G=F[W+4>>2]|0,q>>>0<=G>>>0?q>>>0<G>>>0&&(G>>>0>2?X=(G+-1&G|0)==0:X=0,j=~~+Br(+(+((F[W+12>>2]|0)>>>0)/+ve[W+16>>2]))>>>0,X?j=1<<32-(Kn(j+-1|0)|0):j=tc(j)|0,q=q>>>0<j>>>0?j:q,q>>>0<G>>>0&&pu(W,q)):pu(W,q)}function pu(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0;X=W+4|0;e:do if(q){if(Ce=uc(q<<2)|0,j=F[W>>2]|0,F[W>>2]=Ce,j&&oa(j),F[X>>2]=q,q){j=0;do F[(F[W>>2]|0)+(j<<2)>>2]=0,j=j+1|0;while((j|0)!=(q|0))}if(X=W+8|0,G=F[X>>2]|0,G&&(j=F[G+4>>2]|0,he=q+-1|0,Ce=(he&q|0)==0,Ce?ee=j&he:ee=(j>>>0)%(q>>>0)|0,F[(F[W>>2]|0)+(ee<<2)>>2]=X,j=F[G>>2]|0,j))for(O=G,X=G;;){ce=X;t:for(;;){for(;;){if(X=F[j+4>>2]|0,Ce?le=X&he:le=(X>>>0)%(q>>>0)|0,(le|0)==(ee|0)){X=j;break}if(X=(F[W>>2]|0)+(le<<2)|0,!(F[X>>2]|0)){ee=le,G=j;break t}for(J=j+8|0,X=j;G=F[X>>2]|0,!!G;)if((F[J>>2]|0)==(F[G+8>>2]|0))X=G;else break;if(F[O>>2]=G,F[X>>2]=F[F[(F[W>>2]|0)+(le<<2)>>2]>>2],F[F[(F[W>>2]|0)+(le<<2)>>2]>>2]=j,j=F[ce>>2]|0,!j)break e}if(j=F[X>>2]|0,j)O=X,ce=X;else break e}if(F[X>>2]=O,j=F[G>>2]|0,j)O=G,X=G;else break}}else j=F[W>>2]|0,F[W>>2]=0,j&&oa(j),F[X>>2]=0;while(!1)}function $u(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0;return G=me,me=me+32|0,O=G+16|0,X=G+4|0,ee=G,q=F[q>>2]|0,j=F[q>>2]|0,F[ee>>2]=q,F[O>>2]=F[ee>>2],Lh(X,W,O),q=F[X>>2]|0,F[X>>2]=0,q&&(ie[X+8>>0]|0&&Iu(q+264|0),oa(q)),me=G,j|0}function Lh(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0;for(De=F[j>>2]|0,ce=F[q+4>>2]|0,j=F[De+4>>2]|0,he=ce+-1|0,Ce=(he&ce|0)==0,Ce?le=he&j:le=(j>>>0)%(ce>>>0)|0,G=(F[q>>2]|0)+(le<<2)|0,X=F[G>>2]|0;;)if(j=F[X>>2]|0,(j|0)==(De|0)){J=X;break}else X=j;ee=q+8|0,(J|0)!=(ee|0)?(j=F[J+4>>2]|0,Ce?j=j&he:j=(j>>>0)%(ce>>>0)|0,(j|0)==(le|0)?G=De:O=12):O=12;do if((O|0)==12){if(j=F[De>>2]|0,j&&(j=F[j+4>>2]|0,Ce?j=j&he:j=(j>>>0)%(ce>>>0)|0,(j|0)==(le|0))){G=De;break}F[G>>2]=0,G=De}while(!1);X=F[G>>2]|0,j=X,X&&(X=F[X+4>>2]|0,Ce?X=X&he:X=(X>>>0)%(ce>>>0)|0,(X|0)!=(le|0)&&(F[(F[q>>2]|0)+(X<<2)>>2]=J,j=F[De>>2]|0)),F[J>>2]=j,F[G>>2]=0,q=q+12|0,F[q>>2]=(F[q>>2]|0)+-1,F[W>>2]=De,F[W+4>>2]=ee,ie[W+8>>0]=1}function Dh(W,q,j){W=W|0,q=q|0,j=j|0;var X=0;X=uc(408)|0,F[X+8>>2]=F[j>>2],ii(X+16|0,0,392)|0,se[X+248>>3]=1e-4,se[X+256>>3]=1e3,j=X+264|0,F[j>>2]=0,F[j+4>>2]=0,F[j+8>>2]=0,F[j+12>>2]=0,F[W>>2]=X,W=W+4|0,F[W>>2]=q+8,F[W+4>>2]=257}function Ph(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0;ce=F[j+8>>2]|0,pt=j+4|0,F[pt>>2]=ce,We=q+4|0,le=F[We>>2]|0,Qe=(le|0)==0;e:do if(Qe)G=0,De=12;else if(he=le+-1|0,Ce=(he&le|0)==0,Ce?G=he&ce:G=(ce>>>0)%(le>>>0)|0,X=F[(F[q>>2]|0)+(G<<2)>>2]|0,!X)De=12;else for(;;){if(O=F[X>>2]|0,!O){De=12;break e}if(X=F[O+4>>2]|0,Ce?X=X&he:X=(X>>>0)%(le>>>0)|0,(X|0)!=(G|0)){De=12;break e}if((F[O+8>>2]|0)==(ce|0)){X=0,j=O;break}else X=O}while(!1);if((De|0)==12){ce=q+12|0,ee=+(((F[ce>>2]|0)+1|0)>>>0),J=+ve[q+16>>2];do if(Qe|ee>+(le>>>0)*J)if(le>>>0>2?X=(le+-1&le|0)==0:X=0,O=(X&1|le<<1)^1,X=~~+Br(+(ee/J))>>>0,Nd(q,O>>>0<X>>>0?X:O),O=F[We>>2]|0,X=F[pt>>2]|0,G=O+-1|0,G&O){le=O,G=(X>>>0)%(O>>>0)|0;break}else{le=O,G=G&X;break}while(!1);X=F[(F[q>>2]|0)+(G<<2)>>2]|0,X?(F[j>>2]=F[X>>2],F[X>>2]=j):(X=q+8|0,F[j>>2]=F[X>>2],F[X>>2]=j,F[(F[q>>2]|0)+(G<<2)>>2]=X,X=F[j>>2]|0,X&&(X=F[X+4>>2]|0,G=le+-1|0,G&le?X=(X>>>0)%(le>>>0)|0:X=X&G,F[(F[q>>2]|0)+(X<<2)>>2]=j)),F[ce>>2]=(F[ce>>2]|0)+1,X=1}F[W>>2]=j,ie[W+4>>0]=X}function Nd(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;(q|0)!=1?q+-1&q&&(q=tc(q)|0):q=2,G=F[W+4>>2]|0,q>>>0<=G>>>0?q>>>0<G>>>0&&(G>>>0>2?X=(G+-1&G|0)==0:X=0,j=~~+Br(+(+((F[W+12>>2]|0)>>>0)/+ve[W+16>>2]))>>>0,X?j=1<<32-(Kn(j+-1|0)|0):j=tc(j)|0,q=q>>>0<j>>>0?j:q,q>>>0<G>>>0&&$a(W,q)):$a(W,q)}function $a(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0;X=W+4|0;e:do if(q){if(Ce=uc(q<<2)|0,j=F[W>>2]|0,F[W>>2]=Ce,j&&oa(j),F[X>>2]=q,q){j=0;do F[(F[W>>2]|0)+(j<<2)>>2]=0,j=j+1|0;while((j|0)!=(q|0))}if(X=W+8|0,G=F[X>>2]|0,G&&(j=F[G+4>>2]|0,he=q+-1|0,Ce=(he&q|0)==0,Ce?ee=j&he:ee=(j>>>0)%(q>>>0)|0,F[(F[W>>2]|0)+(ee<<2)>>2]=X,j=F[G>>2]|0,j))for(O=G,X=G;;){ce=X;t:for(;;){for(;;){if(X=F[j+4>>2]|0,Ce?le=X&he:le=(X>>>0)%(q>>>0)|0,(le|0)==(ee|0)){X=j;break}if(X=(F[W>>2]|0)+(le<<2)|0,!(F[X>>2]|0)){ee=le,G=j;break t}for(J=j+8|0,X=j;G=F[X>>2]|0,!!G;)if((F[J>>2]|0)==(F[G+8>>2]|0))X=G;else break;if(F[O>>2]=G,F[X>>2]=F[F[(F[W>>2]|0)+(le<<2)>>2]>>2],F[F[(F[W>>2]|0)+(le<<2)>>2]>>2]=j,j=F[ce>>2]|0,!j)break e}if(j=F[X>>2]|0,j)O=X,ce=X;else break e}if(F[X>>2]=O,j=F[G>>2]|0,j)O=G,X=G;else break}}else j=F[W>>2]|0,F[W>>2]=0,j&&oa(j),F[X>>2]=0;while(!1)}function Us(W){return W=W|0,Oa(F[W+4>>2]|0)|0}function Ud(W){W=W|0,Ca(624,10917),Dn(632,10922,1,1,0),Vo(640,10927,1,-128,127),Vo(656,10932,1,-128,127),Vo(648,10944,1,0,255),Vo(664,10958,2,-32768,32767),Vo(672,10964,2,0,65535),Vo(680,10979,4,-2147483648,2147483647),Vo(688,10983,4,0,-1),Vo(696,10996,4,-2147483648,2147483647),Vo(704,11001,4,0,-1),wo(712,11015,4),wo(720,11021,8),jt(360,11028),jt(392,11040),vi(416,4,11073),Sr(440,11086),Xi(448,0,11102),gs(11132),Pl(11169),Au(11208),Xu(11239),Fl(11279),cc(11308),Xi(456,4,11346),Xi(464,5,11376),gs(11415),Pl(11447),Au(11480),Xu(11513),Fl(11547),cc(11580),Xi(472,6,11614),Xi(480,7,11645),Xi(488,7,11677)}function qi(){Ud(0)}function gs(W){W=W|0,Xi(536,0,W|0)}function Pl(W){W=W|0,Xi(528,1,W|0)}function Au(W){W=W|0,Xi(520,2,W|0)}function Xu(W){W=W|0,Xi(512,3,W|0)}function Fl(W){W=W|0,Xi(504,4,W|0)}function cc(W){W=W|0,Xi(496,5,W|0)}function mu(W){W=W|0,Ia(12478,12501,303,12589)}function uc(W){W=W|0;var q=0;q=W|0?W:1,W=$i(q)|0;e:do if(!W){for(;W=Ku()|0,!!W;)if(ua[W&0](),W=$i(q)|0,W)break e;q=xn(4)|0,F[q>>2]=2224,xi(q|0,544,1)}while(!1);return W|0}function oa(W){W=W|0,Mr(W)}function hc(W){W=W|0}function gu(W){W=W|0,oa(W)}function Ol(W){return W=W|0,12610}function Ku(){var W=0;return W=F[559]|0,F[559]=W+0,W|0}function To(W){W=W|0}function Nl(W){W=W|0}function Ul(W){W=W|0}function cl(W){W=W|0}function dc(W){W=W|0}function Kc(W){W=W|0,oa(W)}function Wo(W){W=W|0,oa(W)}function Yc(W){W=W|0,oa(W)}function Yu(W){W=W|0,oa(W)}function Fo(W,q,j){return W=W|0,q=q|0,j=j|0,(W|0)==(q|0)|0}function go(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;if(ee=me,me=me+64|0,O=ee,(W|0)!=(q|0))if(q|0&&(G=co(q,576,592,0)|0,(G|0)!=0)){q=O,X=q+56|0;do F[q>>2]=0,q=q+4|0;while((q|0)<(X|0));F[O>>2]=G,F[O+8>>2]=W,F[O+12>>2]=-1,F[O+48>>2]=1,ls[F[(F[G>>2]|0)+28>>2]&3](G,O,F[j>>2]|0,1),(F[O+24>>2]|0)==1?(F[j>>2]=F[O+16>>2],q=1):q=0}else q=0;else q=1;return me=ee,q|0}function fc(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0;W=q+16|0,G=F[W>>2]|0;do if(G){if((G|0)!=(j|0)){X=q+36|0,F[X>>2]=(F[X>>2]|0)+1,F[q+24>>2]=2,ie[q+54>>0]=1;break}W=q+24|0,(F[W>>2]|0)==2&&(F[W>>2]=X)}else F[W>>2]=j,F[q+24>>2]=X,F[q+36>>2]=1;while(!1)}function ga(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0,(W|0)==(F[q+8>>2]|0)&&fc(0,q,j,X)}function Rc(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0,(W|0)==(F[q+8>>2]|0)?fc(0,q,j,X):(W=F[W+8>>2]|0,ls[F[(F[W>>2]|0)+28>>2]&3](W,q,j,X))}function Kr(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0;O=F[W+4>>2]|0,G=O>>8,O&1&&(G=F[(F[j>>2]|0)+G>>2]|0),W=F[W>>2]|0,ls[F[(F[W>>2]|0)+28>>2]&3](W,q,j+G|0,O&2|0?X:2)}function Fs(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0;e:do if((W|0)!=(F[q+8>>2]|0)){if(O=F[W+12>>2]|0,G=W+16+(O<<3)|0,Kr(W+16|0,q,j,X),(O|0)>1){O=q+54|0,W=W+24|0;do{if(Kr(W,q,j,X),ie[O>>0]|0)break e;W=W+8|0}while(W>>>0<G>>>0)}}else fc(0,q,j,X);while(!1)}function co(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0;Qe=me,me=me+64|0,De=Qe,Ce=F[W>>2]|0,he=W+(F[Ce+-8>>2]|0)|0,Ce=F[Ce+-4>>2]|0,F[De>>2]=j,F[De+4>>2]=W,F[De+8>>2]=q,F[De+12>>2]=X,X=De+16|0,W=De+20|0,q=De+24|0,G=De+28|0,O=De+32|0,ee=De+40|0,J=(Ce|0)==(j|0),le=X,ce=le+36|0;do F[le>>2]=0,le=le+4|0;while((le|0)<(ce|0));ne[X+36>>1]=0,ie[X+38>>0]=0;e:do if(J)F[De+48>>2]=1,ui[F[(F[j>>2]|0)+20>>2]&3](j,De,he,he,1,0),X=(F[q>>2]|0)==1?he:0;else{switch(Tn[F[(F[Ce>>2]|0)+24>>2]&3](Ce,De,he,1,0),F[De+36>>2]|0){case 0:{X=(F[ee>>2]|0)==1&(F[G>>2]|0)==1&(F[O>>2]|0)==1?F[W>>2]|0:0;break e}case 1:break;default:{X=0;break e}}if((F[q>>2]|0)!=1&&!((F[ee>>2]|0)==0&(F[G>>2]|0)==1&(F[O>>2]|0)==1)){X=0;break}X=F[X>>2]|0}while(!1);return me=Qe,X|0}function to(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,ie[q+53>>0]=1;do if((F[q+4>>2]|0)==(X|0)){if(ie[q+52>>0]=1,X=q+16|0,W=F[X>>2]|0,!W){if(F[X>>2]=j,F[q+24>>2]=G,F[q+36>>2]=1,!((G|0)==1&&(F[q+48>>2]|0)==1))break;ie[q+54>>0]=1;break}if((W|0)!=(j|0)){G=q+36|0,F[G>>2]=(F[G>>2]|0)+1,ie[q+54>>0]=1;break}W=q+24|0,X=F[W>>2]|0,(X|0)==2&&(F[W>>2]=G,X=G),(X|0)==1&&(F[q+48>>2]|0)==1&&(ie[q+54>>0]=1)}while(!1)}function vn(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;e:do if((W|0)==(F[q+8>>2]|0))(F[q+4>>2]|0)==(j|0)&&(O=q+28|0,(F[O>>2]|0)!=1)&&(F[O>>2]=X);else{if((W|0)!=(F[q>>2]|0)){if(We=F[W+12>>2]|0,J=W+16+(We<<3)|0,$o(W+16|0,q,j,X,G),O=W+24|0,(We|0)<=1)break;if(ee=F[W+8>>2]|0,!(ee&2|0)&&(le=q+36|0,(F[le>>2]|0)!=1)){if(!(ee&1)){for(ee=q+54|0;;)if(ie[ee>>0]|0||(F[le>>2]|0)==1||($o(O,q,j,X,G),O=O+8|0,O>>>0>=J>>>0))break e}for(ee=q+24|0,W=q+54|0;;)if(ie[W>>0]|0||(F[le>>2]|0)==1&&(F[ee>>2]|0)==1||($o(O,q,j,X,G),O=O+8|0,O>>>0>=J>>>0))break e}for(ee=q+54|0;;)if(ie[ee>>0]|0||($o(O,q,j,X,G),O=O+8|0,O>>>0>=J>>>0))break e}if((F[q+16>>2]|0)!=(j|0)&&(Qe=q+20|0,(F[Qe>>2]|0)!=(j|0))){if(F[q+32>>2]=X,he=q+44|0,(F[he>>2]|0)==4)break;ee=F[W+12>>2]|0,J=W+16+(ee<<3)|0,le=q+52|0,X=q+53|0,Ce=q+54|0,ce=W+8|0,De=q+24|0;t:do if((ee|0)>0)for(ee=0,O=0,W=W+16|0;;){if(ie[le>>0]=0,ie[X>>0]=0,u0(W,q,j,j,1,G),ie[Ce>>0]|0){We=20;break t}do if(ie[X>>0]|0){if(!(ie[le>>0]|0))if(F[ce>>2]&1){O=1;break}else{O=1,We=20;break t}if((F[De>>2]|0)==1)break t;if(F[ce>>2]&2)ee=1,O=1;else break t}while(!1);if(W=W+8|0,W>>>0>=J>>>0){We=20;break}}else ee=0,O=0,We=20;while(!1);do if((We|0)==20){if(!ee&&(F[Qe>>2]=j,j=q+40|0,F[j>>2]=(F[j>>2]|0)+1,(F[q+36>>2]|0)==1)&&(F[De>>2]|0)==2){if(ie[Ce>>0]=1,O)break}else We=24;if((We|0)==24&&O)break;F[he>>2]=4;break e}while(!1);F[he>>2]=3;break}(X|0)==1&&(F[q+32>>2]=1)}while(!1)}function u0(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0;var ee=0,J=0;J=F[W+4>>2]|0,ee=J>>8,J&1&&(ee=F[(F[X>>2]|0)+ee>>2]|0),W=F[W>>2]|0,ui[F[(F[W>>2]|0)+20>>2]&3](W,q,j,X+ee|0,J&2|0?G:2,O)}function $o(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0;ee=F[W+4>>2]|0,O=ee>>8,ee&1&&(O=F[(F[j>>2]|0)+O>>2]|0),W=F[W>>2]|0,Tn[F[(F[W>>2]|0)+24>>2]&3](W,q,j+O|0,ee&2|0?X:2,G)}function Rs(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0;e:do if((W|0)==(F[q+8>>2]|0))(F[q+4>>2]|0)==(j|0)&&(O=q+28|0,(F[O>>2]|0)!=1)&&(F[O>>2]=X);else{if((W|0)!=(F[q>>2]|0)){J=F[W+8>>2]|0,Tn[F[(F[J>>2]|0)+24>>2]&3](J,q,j,X,G);break}if((F[q+16>>2]|0)!=(j|0)&&(ee=q+20|0,(F[ee>>2]|0)!=(j|0))){if(F[q+32>>2]=X,X=q+44|0,(F[X>>2]|0)==4)break;O=q+52|0,ie[O>>0]=0,le=q+53|0,ie[le>>0]=0,W=F[W+8>>2]|0,ui[F[(F[W>>2]|0)+20>>2]&3](W,q,j,j,1,G),ie[le>>0]|0?ie[O>>0]|0||(O=1,J=13):(O=0,J=13);do if((J|0)==13){if(F[ee>>2]=j,le=q+40|0,F[le>>2]=(F[le>>2]|0)+1,(F[q+36>>2]|0)==1&&(F[q+24>>2]|0)==2){if(ie[q+54>>0]=1,O)break}else J=16;if((J|0)==16&&O)break;F[X>>2]=4;break e}while(!1);F[X>>2]=3;break}(X|0)==1&&(F[q+32>>2]=1)}while(!1)}function Zs(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0;do if((W|0)==(F[q+8>>2]|0))(F[q+4>>2]|0)==(j|0)&&(ee=q+28|0,(F[ee>>2]|0)!=1)&&(F[ee>>2]=X);else if((W|0)==(F[q>>2]|0)){if((F[q+16>>2]|0)!=(j|0)&&(O=q+20|0,(F[O>>2]|0)!=(j|0))){F[q+32>>2]=X,F[O>>2]=j,G=q+40|0,F[G>>2]=(F[G>>2]|0)+1,(F[q+36>>2]|0)==1&&(F[q+24>>2]|0)==2&&(ie[q+54>>0]=1),F[q+44>>2]=4;break}(X|0)==1&&(F[q+32>>2]=1)}while(!1)}function Da(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0;var ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0;if((W|0)==(F[q+8>>2]|0))to(0,q,j,X,G);else{he=q+52|0,Ce=ie[he>>0]|0,De=q+53|0,Qe=ie[De>>0]|0,ce=F[W+12>>2]|0,ee=W+16+(ce<<3)|0,ie[he>>0]=0,ie[De>>0]=0,u0(W+16|0,q,j,X,G,O);e:do if((ce|0)>1){J=q+24|0,le=W+8|0,ce=q+54|0,W=W+24|0;do{if(ie[ce>>0]|0)break e;if(ie[he>>0]|0){if((F[J>>2]|0)==1||!(F[le>>2]&2))break e}else if(ie[De>>0]|0&&!(F[le>>2]&1|0))break e;ie[he>>0]=0,ie[De>>0]=0,u0(W,q,j,X,G,O),W=W+8|0}while(W>>>0<ee>>>0)}while(!1);ie[he>>0]=Ce,ie[De>>0]=Qe}}function F0(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,(W|0)==(F[q+8>>2]|0)?to(0,q,j,X,G):(W=F[W+8>>2]|0,ui[F[(F[W>>2]|0)+20>>2]&3](W,q,j,X,G,O))}function w0(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,(W|0)==(F[q+8>>2]|0)&&to(0,q,j,X,G)}function xa(W){W=W|0,Ia(12625,12654,1164,12589)}function Ms(W){return W=W|0,((W|0)==32|(W+-9|0)>>>0<5)&1|0}function Is(){var W=0;return F[597]|0?W=F[(er()|0)+60>>2]|0:W=2644,W|0}function aa(W){W=W|0;var q=0,j=0;for(q=0;;){if((fe[12742+q>>0]|0)==(W|0)){j=2;break}if(q=q+1|0,(q|0)==87){q=87,W=12830,j=5;break}}if((j|0)==2&&(q?(W=12830,j=5):W=12830),(j|0)==5)for(;;){for(j=W;W=j+1|0,ie[j>>0]|0;)j=W;if(q=q+-1|0,q)j=5;else break}return W|0}function Pa(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0;switch(Yi=me,me=me+512|0,Gn=Yi,q|0){case 0:{Pn=24,ei=-149,Et=4;break}case 1:{Pn=53,ei=-1074,Et=4;break}case 2:{Pn=53,ei=-1074,Et=4;break}default:X=0}e:do if((Et|0)==4){Ye=W+4|0,je=W+100|0;do q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0;while(Ms(q)|0);t:do switch(q|0){case 43:case 45:if(G=1-(((q|0)==45&1)<<1)|0,q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0){F[Ye>>2]=q+1,q=fe[q>>0]|0,Wn=G;break t}else{q=Lr(W)|0,Wn=G;break t}default:Wn=1}while(!1);G=q,q=0;do{if((G|32|0)!=(ie[14634+q>>0]|0))break;do if(q>>>0<7)if(G=F[Ye>>2]|0,G>>>0<(F[je>>2]|0)>>>0){F[Ye>>2]=G+1,G=fe[G>>0]|0;break}else{G=Lr(W)|0;break}while(!1);q=q+1|0}while(q>>>0<8);t:do switch(q|0){case 8:break;case 3:{Et=23;break}default:{if(ee=(j|0)!=0,ee&q>>>0>3){if((q|0)==8)break t;Et=23;break t}n:do if(!q){q=0;do{if((G|32|0)!=(ie[16477+q>>0]|0))break n;do if(q>>>0<2)if(G=F[Ye>>2]|0,G>>>0<(F[je>>2]|0)>>>0){F[Ye>>2]=G+1,G=fe[G>>0]|0;break}else{G=Lr(W)|0;break}while(!1);q=q+1|0}while(q>>>0<3)}while(!1);switch(q|0){case 3:{if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,(q|0)==40)q=1;else{if(!(F[je>>2]|0)){X=ke;break e}F[Ye>>2]=(F[Ye>>2]|0)+-1,X=ke;break e}for(;G=F[Ye>>2]|0,G>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=G+1,G=fe[G>>0]|0):G=Lr(W)|0,!(!((G+-48|0)>>>0<10|(G+-65|0)>>>0<26)&&!((G|0)==95|(G+-97|0)>>>0<26));)q=q+1|0;if((G|0)==41){X=ke;break e}if(G=(F[je>>2]|0)==0,G||(F[Ye>>2]=(F[Ye>>2]|0)+-1),!ee){F[(Is()|0)>>2]=22,Xs(W,0),X=0;break e}if(!q){X=ke;break e}for(;;)if(q=q+-1|0,G||(F[Ye>>2]=(F[Ye>>2]|0)+-1),!q){X=ke;break e}}case 0:{do if((G|0)==48){if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,(q|32|0)!=120){if(!(F[je>>2]|0)){q=48;break}F[Ye>>2]=(F[Ye>>2]|0)+-1,q=48;break}q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0,ee=0):(q=Lr(W)|0,ee=0);n:for(;;){switch(q|0){case 46:{Et=74;break n}case 48:break;default:{Je=0,J=0,qe=0,G=0,ce=ee,he=0,rt=0,le=1,ee=0,X=0;break n}}if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0){F[Ye>>2]=q+1,q=fe[q>>0]|0,ee=1;continue}else{q=Lr(W)|0,ee=1;continue}}if((Et|0)==74)if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,(q|0)==48){ee=0,G=0;do q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,ee=Bs(ee|0,G|0,-1,-1)|0,G=_t;while((q|0)==48);Je=0,J=0,qe=ee,ce=1,he=1,rt=0,le=1,ee=0,X=0}else Je=0,J=0,qe=0,G=0,ce=ee,he=1,rt=0,le=1,ee=0,X=0;for(;;){if(We=q+-48|0,Ce=q|32,We>>>0>=10){if(pt=(q|0)==46,!(pt|(Ce+-97|0)>>>0<6)){Ce=qe,We=Je;break}if(pt)if(!he)pt=J,G=Je,We=Je,he=1,Ce=rt,O=le;else{Ce=qe,We=Je,q=46;break}else Et=86}else Et=86;if((Et|0)==86){Et=0,q=(q|0)>57?Ce+-87|0:We;do if((Je|0)<0|(Je|0)==0&J>>>0<8)Ce=rt,O=le,ee=q+(ee<<4)|0;else{if((Je|0)<0|(Je|0)==0&J>>>0<14){Qe=le*.0625,Ce=rt,O=Qe,X=X+Qe*+(q|0);break}(rt|0)!=0|(q|0)==0?(Ce=rt,O=le):(Ce=1,O=le,X=X+le*.5)}while(!1);J=Bs(J|0,Je|0,1,0)|0,pt=qe,We=_t,ce=1}if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0){F[Ye>>2]=q+1,Je=We,qe=pt,q=fe[q>>0]|0,rt=Ce,le=O;continue}else{Je=We,qe=pt,q=Lr(W)|0,rt=Ce,le=O;continue}}if(!ce){q=(F[je>>2]|0)==0,q||(F[Ye>>2]=(F[Ye>>2]|0)+-1),j?!q&&(lt=F[Ye>>2]|0,F[Ye>>2]=lt+-1,(he|0)!=0)&&(F[Ye>>2]=lt+-2):Xs(W,0),X=+(Wn|0)*0;break e}if(ce=(he|0)==0,he=ce?J:Ce,ce=ce?We:G,(We|0)<0|(We|0)==0&J>>>0<8){G=We;do ee=ee<<4,J=Bs(J|0,G|0,1,0)|0,G=_t;while((G|0)<0|(G|0)==0&J>>>0<8)}if((q|32|0)==112){if(G=Lc(W,j)|0,q=_t,(G|0)==0&(q|0)==-2147483648){if(!j){Xs(W,0),X=0;break e}F[je>>2]|0?(F[Ye>>2]=(F[Ye>>2]|0)+-1,G=0,q=0):(G=0,q=0)}}else F[je>>2]|0?(F[Ye>>2]=(F[Ye>>2]|0)+-1,G=0,q=0):(G=0,q=0);if(Gn=Bo(he|0,ce|0,2)|0,Gn=Bs(Gn|0,_t|0,-32,-1)|0,q=Bs(Gn|0,_t|0,G|0,q|0)|0,G=_t,!ee){X=+(Wn|0)*0;break e}if((G|0)>0|(G|0)==0&q>>>0>(0-ei|0)>>>0){F[(Is()|0)>>2]=34,X=+(Wn|0)*17976931348623157e292*17976931348623157e292;break e}if(Gn=ei+-106|0,Bn=((Gn|0)<0)<<31>>31,(G|0)<(Bn|0)|(G|0)==(Bn|0)&q>>>0<Gn>>>0){F[(Is()|0)>>2]=34,X=+(Wn|0)*22250738585072014e-324*22250738585072014e-324;break e}if((ee|0)>-1){do Bn=!(X>=.5),Gn=Bn&1|ee<<1,ee=Gn^1,X=X+(Bn?X:X+-1),q=Bs(q|0,G|0,-1,-1)|0,G=_t;while((Gn|0)>-1);J=q,le=X}else J=q,le=X;q=o0(32,0,ei|0,((ei|0)<0)<<31>>31|0)|0,q=Bs(J|0,G|0,q|0,_t|0)|0,ei=_t,0>(ei|0)|(ei|0)==0&Pn>>>0>q>>>0?(q|0)<0?(q=0,Et=127):Et=125:(q=Pn,Et=125),(Et|0)==125&&((q|0)<53?Et=127:(G=q,O=+(Wn|0),X=0)),(Et|0)==127&&(X=+(Wn|0),G=q,O=X,X=+ul(+kl(1,84-q|0),X)),Pn=(ee&1|0)==0&(le!=0&(G|0)<32),X=O*(Pn?0:le)+(X+O*+(((Pn&1)+ee|0)>>>0))-X,X==0&&(F[(Is()|0)>>2]=34),X=+qc(X,J);break e}else q=G;while(!1);Qt=ei+Pn|0,Bn=0-Qt|0,ee=0;n:for(;;){switch(q|0){case 46:{Et=138;break n}case 48:break;default:{G=0,Ce=0,he=0;break n}}if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0){F[Ye>>2]=q+1,q=fe[q>>0]|0,ee=1;continue}else{q=Lr(W)|0,ee=1;continue}}if((Et|0)==138)if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,(q|0)==48)for(G=0,q=0;;)if(G=Bs(G|0,q|0,-1,-1)|0,ee=_t,q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,(q|0)==48)q=ee;else{Ce=ee,ee=1,he=1;break}else G=0,Ce=0,he=1;F[Gn>>2]=0,ce=q+-48|0,J=(q|0)==46;n:do if(J|ce>>>0<10){At=Gn+496|0,Je=0,pt=0,rt=J,Et=Ce,We=ee,lt=he,ee=0,J=0,he=0;r:for(;;){do if(rt)if(!lt)G=Je,Ce=pt,lt=1;else{Ce=Et,q=Je,ce=pt;break r}else{if(rt=Bs(Je|0,pt|0,1,0)|0,pt=_t,qe=(q|0)!=48,(J|0)>=125){if(!qe){Ce=Et,Je=rt;break}F[At>>2]=F[At>>2]|1,Ce=Et,Je=rt;break}Ce=Gn+(J<<2)|0,ee&&(ce=q+-48+((F[Ce>>2]|0)*10|0)|0),F[Ce>>2]=ce,ee=ee+1|0,ce=(ee|0)==9,Ce=Et,Je=rt,We=1,ee=ce?0:ee,J=(ce&1)+J|0,he=qe?rt:he}while(!1);if(q=F[Ye>>2]|0,q>>>0<(F[je>>2]|0)>>>0?(F[Ye>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,ce=q+-48|0,rt=(q|0)==46,rt|ce>>>0<10)Et=Ce;else{ce=lt,Et=161;break n}}We=(We|0)!=0,Et=169}else Je=0,pt=0,We=ee,ce=he,ee=0,J=0,he=0,Et=161;while(!1);do if((Et|0)==161){if(At=(ce|0)==0,G=At?Je:G,Ce=At?pt:Ce,We=(We|0)!=0,!((q|32|0)==101&We))if((q|0)>-1){q=Je,ce=pt,Et=169;break}else{q=Je,ce=pt,Et=171;break}if(ce=Lc(W,j)|0,q=_t,(ce|0)==0&(q|0)==-2147483648){if(!j){Xs(W,0),X=0;break}F[je>>2]|0?(F[Ye>>2]=(F[Ye>>2]|0)+-1,ce=0,q=0):(ce=0,q=0)}G=Bs(ce|0,q|0,G|0,Ce|0)|0,We=Je,Ce=_t,ce=pt,Et=173}while(!1);(Et|0)==169&&(F[je>>2]|0?(F[Ye>>2]=(F[Ye>>2]|0)+-1,We?(We=q,Et=173):Et=172):Et=171),(Et|0)==171&&(We?(We=q,Et=173):Et=172);do if((Et|0)==172)F[(Is()|0)>>2]=22,Xs(W,0),X=0;else if((Et|0)==173){if(q=F[Gn>>2]|0,!q){X=+(Wn|0)*0;break}if(((ce|0)<0|(ce|0)==0&We>>>0<10)&((G|0)==(We|0)&(Ce|0)==(ce|0))&&Pn>>>0>30|(q>>>Pn|0)==0){X=+(Wn|0)*+(q>>>0);break}if(W=(ei|0)/-2|0,Ye=((W|0)<0)<<31>>31,(Ce|0)>(Ye|0)|(Ce|0)==(Ye|0)&G>>>0>W>>>0){F[(Is()|0)>>2]=34,X=+(Wn|0)*17976931348623157e292*17976931348623157e292;break}if(W=ei+-106|0,Ye=((W|0)<0)<<31>>31,(Ce|0)<(Ye|0)|(Ce|0)==(Ye|0)&G>>>0<W>>>0){F[(Is()|0)>>2]=34,X=+(Wn|0)*22250738585072014e-324*22250738585072014e-324;break}if(ee){if((ee|0)<9){ce=Gn+(J<<2)|0,q=F[ce>>2]|0;do q=q*10|0,ee=ee+1|0;while((ee|0)!=9);F[ce>>2]=q}J=J+1|0}if((he|0)<9&&(he|0)<=(G|0)&(G|0)<18){if((G|0)==9){X=+(Wn|0)*+((F[Gn>>2]|0)>>>0);break}if((G|0)<9){X=+(Wn|0)*+((F[Gn>>2]|0)>>>0)/+(F[2648+(8-G<<2)>>2]|0);break}if(W=Pn+27+(kt(G,-3)|0)|0,q=F[Gn>>2]|0,(W|0)>30|(q>>>W|0)==0){X=+(Wn|0)*+(q>>>0)*+(F[2648+(G+-10<<2)>>2]|0);break}}if(q=(G|0)%9|0,!q)ee=0,q=0;else{if(We=(G|0)>-1?q:q+9|0,ce=F[2648+(8-We<<2)>>2]|0,J){he=1e9/(ce|0)|0,ee=0,q=0,Ce=0;do je=Gn+(Ce<<2)|0,Ye=F[je>>2]|0,W=((Ye>>>0)/(ce>>>0)|0)+q|0,F[je>>2]=W,q=kt((Ye>>>0)%(ce>>>0)|0,he)|0,W=(Ce|0)==(ee|0)&(W|0)==0,Ce=Ce+1|0,G=W?G+-9|0:G,ee=W?Ce&127:ee;while((Ce|0)!=(J|0));q&&(F[Gn+(J<<2)>>2]=q,J=J+1|0)}else ee=0,J=0;q=0,G=9-We+G|0}n:for(;;){pt=(G|0)<18,rt=(G|0)==18,qe=Gn+(ee<<2)|0;do{if(!pt){if(!rt)break n;if((F[qe>>2]|0)>>>0>=9007199){G=18;break n}}for(ce=0,he=J+127|0;We=he&127,Ce=Gn+(We<<2)|0,he=Bo(F[Ce>>2]|0,0,29)|0,he=Bs(he|0,_t|0,ce|0,0)|0,ce=_t,ce>>>0>0|(ce|0)==0&he>>>0>1e9?(W=Gc(he|0,ce|0,1e9,0)|0,he=g1(he|0,ce|0,1e9,0)|0,ce=W):ce=0,F[Ce>>2]=he,W=(We|0)==(ee|0),J=(We|0)!=(J+127&127|0)|W||he|0?J:We,!W;)he=We+-1|0;q=q+-29|0}while(!(ce|0));ee=ee+127&127,(ee|0)==(J|0)&&(W=J+127&127,J=Gn+((J+126&127)<<2)|0,F[J>>2]=F[J>>2]|F[Gn+(W<<2)>>2],J=W),F[Gn+(ee<<2)>>2]=ce,G=G+9|0}n:for(;;){for(Je=J+1&127,qe=Gn+((J+127&127)<<2)|0;;){for(pt=(G|0)==18,rt=(G|0)>27?9:1,We=pt^1;;){he=ee&127,Ce=(he|0)==(J|0);do if(Ce)Et=219;else{if(ce=F[Gn+(he<<2)>>2]|0,ce>>>0<9007199){Et=219;break}if(ce>>>0>9007199)break;if(ce=ee+1&127,(ce|0)==(J|0)){Et=219;break}if(ce=F[Gn+(ce<<2)>>2]|0,ce>>>0<254740991){Et=219;break}if(!(ce>>>0>254740991|We)){G=he;break n}}while(!1);if((Et|0)==219&&(Et=0,pt)){Et=220;break n}if(q=q+rt|0,(ee|0)==(J|0))ee=J;else break}for(We=(1<<rt)+-1|0,pt=1e9>>>rt,he=ee,ce=0,Ce=ee;Ye=Gn+(Ce<<2)|0,W=F[Ye>>2]|0,ee=(W>>>rt)+ce|0,F[Ye>>2]=ee,ce=kt(W&We,pt)|0,ee=(Ce|0)==(he|0)&(ee|0)==0,Ce=Ce+1&127,G=ee?G+-9|0:G,ee=ee?Ce:he,(Ce|0)!=(J|0);)he=ee;if(ce){if((Je|0)!=(ee|0))break;F[qe>>2]=F[qe>>2]|1}}F[Gn+(J<<2)>>2]=ce,J=Je}(Et|0)==220&&(Ce?(F[Gn+(Je+-1<<2)>>2]=0,G=J,J=Je):G=he),X=+((F[Gn+(G<<2)>>2]|0)>>>0),G=ee+1&127,(G|0)==(J|0)&&(J=ee+2&127,F[Gn+(J+-1<<2)>>2]=0),Qe=+(Wn|0),O=Qe*(X*1e9+ +((F[Gn+(G<<2)>>2]|0)>>>0)),pt=q+53|0,Ce=pt-ei|0,We=(Ce|0)<(Pn|0),G=We&1,he=We?(Ce|0)<0?0:Ce:Pn,(he|0)<53?(mi=+ul(+kl(1,105-he|0),O),le=+pc(O,+kl(1,53-he|0)),De=mi,X=le,le=mi+(O-le)):(De=0,X=0,le=O),ce=ee+2&127;do if((ce|0)==(J|0))O=X;else{ce=F[Gn+(ce<<2)>>2]|0;do if(ce>>>0>=5e8){if(ce>>>0>5e8){X=Qe*.75+X;break}if((ee+3&127|0)==(J|0)){X=Qe*.5+X;break}else{X=Qe*.75+X;break}}else{if(!(ce|0)&&(ee+3&127|0)==(J|0))break;X=Qe*.25+X}while(!1);if((53-he|0)<=1){O=X;break}if(+pc(X,1)!=0){O=X;break}O=X+1}while(!1);X=le+O-De;do if((pt&2147483647|0)>(-2-Qt|0)){if(+Nn(+X)>=9007199254740992&&(G=We&(he|0)==(Ce|0)?0:G,q=q+1|0,X=X*.5),(q+50|0)<=(Bn|0)&&!(O!=0&(G|0)!=0))break;F[(Is()|0)>>2]=34}while(!1);X=+qc(X,q)}while(!1);break e}default:{F[je>>2]|0&&(F[Ye>>2]=(F[Ye>>2]|0)+-1),F[(Is()|0)>>2]=22,Xs(W,0),X=0;break e}}}}while(!1);if((Et|0)==23&&(G=(F[je>>2]|0)==0,G||(F[Ye>>2]=(F[Ye>>2]|0)+-1),(j|0)!=0&q>>>0>3))do G||(F[Ye>>2]=(F[Ye>>2]|0)+-1),q=q+-1|0;while(q>>>0>3);X=+(Wn|0)*Ve}while(!1);return me=Yi,+X}function vo(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;e:do if(q>>>0>36)F[(Is()|0)>>2]=22,G=0,X=0;else{We=W+4|0,Qe=W+100|0;do O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0;while(Ms(O)|0);t:do switch(O|0){case 43:case 45:if(ee=((O|0)==45)<<31>>31,O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0){F[We>>2]=O+1,O=fe[O>>0]|0,De=ee;break t}else{O=Lr(W)|0,De=ee;break t}default:De=0}while(!1);ee=(q|0)==0;do if((q&-17|0)==0&(O|0)==48){if(O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,(O|32|0)!=120)if(ee){q=8,he=46;break}else{he=32;break}if(q=F[We>>2]|0,q>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=q+1,O=fe[q>>0]|0):O=Lr(W)|0,(fe[14643+(O+1)>>0]|0)>15){if(X=(F[Qe>>2]|0)==0,X||(F[We>>2]=(F[We>>2]|0)+-1),!j){Xs(W,0),G=0,X=0;break e}if(X){G=0,X=0;break e}F[We>>2]=(F[We>>2]|0)+-1,G=0,X=0;break e}else q=16,he=46}else if(q=ee?10:q,(fe[14643+(O+1)>>0]|0)>>>0<q>>>0)he=32;else{F[Qe>>2]|0&&(F[We>>2]=(F[We>>2]|0)+-1),Xs(W,0),F[(Is()|0)>>2]=22,G=0,X=0;break e}while(!1);if((he|0)==32)if((q|0)==10){if(q=O+-48|0,q>>>0<10){for(O=0;;)if(ee=(O*10|0)+q|0,q=F[We>>2]|0,q>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=q+1,O=fe[q>>0]|0):O=Lr(W)|0,q=O+-48|0,q>>>0<10&ee>>>0<429496729)O=ee;else{q=ee;break}ee=0}else q=0,ee=0;if(j=O+-48|0,j>>>0<10){for(;;){if(J=E0(q|0,ee|0,10,0)|0,le=_t,ce=((j|0)<0)<<31>>31,Ce=~ce,le>>>0>Ce>>>0|(le|0)==(Ce|0)&J>>>0>~j>>>0){J=q;break}if(q=Bs(J|0,le|0,j|0,ce|0)|0,ee=_t,O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,j=O+-48|0,!(j>>>0<10&(ee>>>0<429496729|(ee|0)==429496729&q>>>0<2576980378))){J=q;break}}j>>>0>9?(O=J,q=De):(q=10,he=72)}else O=q,q=De}else he=46;t:do if((he|0)==46){if(!(q+-1&q)){if(he=ie[14900+((q*23|0)>>>5&7)>>0]|0,ee=ie[14643+(O+1)>>0]|0,j=ee&255,j>>>0<q>>>0){for(O=0;J=j|O<<he,O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,ee=ie[14643+(O+1)>>0]|0,j=ee&255,J>>>0<134217728&j>>>0<q>>>0;)O=J;j=0}else j=0,J=0;if(le=nc(-1,-1,he|0)|0,ce=_t,(ee&255)>>>0>=q>>>0|(j>>>0>ce>>>0|(j|0)==(ce|0)&J>>>0>le>>>0)){ee=j,he=72;break}else O=j;for(;;)if(J=Bo(J|0,O|0,he|0)|0,j=_t,J=ee&255|J,O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,ee=ie[14643+(O+1)>>0]|0,(ee&255)>>>0>=q>>>0|(j>>>0>ce>>>0|(j|0)==(ce|0)&J>>>0>le>>>0)){ee=j,he=72;break t}else O=j}if(ee=ie[14643+(O+1)>>0]|0,j=ee&255,j>>>0<q>>>0){for(O=0;J=j+(kt(O,q)|0)|0,O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,ee=ie[14643+(O+1)>>0]|0,j=ee&255,J>>>0<119304647&j>>>0<q>>>0;)O=J;j=0}else J=0,j=0;if((ee&255)>>>0<q>>>0)for(he=Gc(-1,-1,q|0,0)|0,Ce=_t,ce=j;;){if(ce>>>0>Ce>>>0|(ce|0)==(Ce|0)&J>>>0>he>>>0){ee=ce,he=72;break t}if(j=E0(J|0,ce|0,q|0,0)|0,le=_t,ee=ee&255,le>>>0>4294967295|(le|0)==-1&j>>>0>~ee>>>0){ee=ce,he=72;break t}if(J=Bs(ee|0,0,j|0,le|0)|0,j=_t,O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,ee=ie[14643+(O+1)>>0]|0,(ee&255)>>>0>=q>>>0){ee=j,he=72;break}else ce=j}else ee=j,he=72}while(!1);if((he|0)==72)if((fe[14643+(O+1)>>0]|0)>>>0<q>>>0){do O=F[We>>2]|0,O>>>0<(F[Qe>>2]|0)>>>0?(F[We>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0;while((fe[14643+(O+1)>>0]|0)>>>0<q>>>0);F[(Is()|0)>>2]=34,ee=G,O=X,q=(X&1|0)==0&!0?De:0}else O=J,q=De;if(F[Qe>>2]|0&&(F[We>>2]=(F[We>>2]|0)+-1),!(ee>>>0<G>>>0|(ee|0)==(G|0)&O>>>0<X>>>0)){if(!((X&1|0)!=0|!1|(q|0)!=0)){F[(Is()|0)>>2]=34,X=Bs(X|0,G|0,-1,-1)|0,G=_t;break}if(ee>>>0>G>>>0|(ee|0)==(G|0)&O>>>0>X>>>0){F[(Is()|0)>>2]=34;break}}X=((q|0)<0)<<31>>31,X=o0(O^q|0,ee^X|0,q|0,X|0)|0,G=_t}while(!1);return _t=G,X|0}function Xs(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;F[W+104>>2]=q,j=F[W+4>>2]|0,X=F[W+8>>2]|0,G=X-j|0,F[W+108>>2]=G,(q|0)!=0&(G|0)>(q|0)?F[W+100>>2]=j+q:F[W+100>>2]=X}function Lr(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0;return j=W+104|0,O=F[j>>2]|0,O|0&&(F[W+108>>2]|0)>=(O|0)?ee=4:(q=Ql(W)|0,(q|0)>=0?(G=F[j>>2]|0,j=W+8|0,G?(X=F[j>>2]|0,O=F[W+4>>2]|0,j=X,G=G-(F[W+108>>2]|0)+-1|0,(j-O|0)>(G|0)?F[W+100>>2]=O+G:ee=9):(X=F[j>>2]|0,j=X,ee=9),(ee|0)==9&&(F[W+100>>2]=j),j=F[W+4>>2]|0,X&&(W=W+108|0,F[W>>2]=X+1-j+(F[W>>2]|0)),j=j+-1|0,(fe[j>>0]|0|0)!=(q|0)&&(ie[j>>0]=q)):ee=4),(ee|0)==4&&(F[W+100>>2]=0,q=-1),q|0}function Hs(W){return W=W|0,W>>>0>4294963200&&(F[(Is()|0)>>2]=0-W,W=-1),W|0}function Xa(W,q){W=+W,q=+q;var j=0,X=0;return se[Re>>3]=W,X=F[Re>>2]|0,j=F[Re+4>>2]|0,se[Re>>3]=q,j=F[Re+4>>2]&-2147483648|j&2147483647,F[Re>>2]=X,F[Re+4>>2]=j,+ +se[Re>>3]}function ul(W,q){return W=+W,q=+q,+ +Xa(W,q)}function hl(W,q){W=+W,q=+q;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0;se[Re>>3]=W,j=F[Re>>2]|0,ce=F[Re+4>>2]|0,se[Re>>3]=q,he=F[Re>>2]|0,Ce=F[Re+4>>2]|0,X=nc(j|0,ce|0,52)|0,X=X&2047,J=nc(he|0,Ce|0,52)|0,J=J&2047,De=ce&-2147483648,ee=Bo(he|0,Ce|0,1)|0,le=_t;e:do if(!((ee|0)==0&(le|0)==0)&&(O=Ce&2147483647,!(O>>>0>2146435072|(O|0)==2146435072&he>>>0>0|(X|0)==2047))){if(G=Bo(j|0,ce|0,1)|0,O=_t,!(O>>>0>le>>>0|(O|0)==(le|0)&G>>>0>ee>>>0))return+((G|0)==(ee|0)&(O|0)==(le|0)?W*0:W);if(X)G=ce&1048575|1048576;else{if(X=Bo(j|0,ce|0,12)|0,G=_t,(G|0)>-1|(G|0)==-1&X>>>0>4294967295){O=X,X=0;do X=X+-1|0,O=Bo(O|0,G|0,1)|0,G=_t;while((G|0)>-1|(G|0)==-1&O>>>0>4294967295)}else X=0;j=Bo(j|0,ce|0,1-X|0)|0,G=_t}if(J)ce=Ce&1048575|1048576;else{if(O=Bo(he|0,Ce|0,12)|0,ee=_t,(ee|0)>-1|(ee|0)==-1&O>>>0>4294967295){J=0;do J=J+-1|0,O=Bo(O|0,ee|0,1)|0,ee=_t;while((ee|0)>-1|(ee|0)==-1&O>>>0>4294967295)}else J=0;he=Bo(he|0,Ce|0,1-J|0)|0,ce=_t}le=o0(j|0,G|0,he|0,ce|0)|0,ee=_t,O=(ee|0)>-1|(ee|0)==-1&le>>>0>4294967295;t:do if((X|0)>(J|0)){for(;;){if(O){if((j|0)==(he|0)&(G|0)==(ce|0))break;j=le,G=ee}if(j=Bo(j|0,G|0,1)|0,G=_t,X=X+-1|0,le=o0(j|0,G|0,he|0,ce|0)|0,ee=_t,O=(ee|0)>-1|(ee|0)==-1&le>>>0>4294967295,(X|0)<=(J|0))break t}q=W*0;break e}while(!1);if(O)if((j|0)==(he|0)&(G|0)==(ce|0)){q=W*0;break}else G=ee,j=le;if(G>>>0<1048576|(G|0)==1048576&j>>>0<0)do j=Bo(j|0,G|0,1)|0,G=_t,X=X+-1|0;while(G>>>0<1048576|(G|0)==1048576&j>>>0<0);(X|0)>0?(Ce=Bs(j|0,G|0,0,-1048576)|0,j=_t,X=Bo(X|0,0,52)|0,j=j|_t,X=Ce|X):(X=nc(j|0,G|0,1-X|0)|0,j=_t),F[Re>>2]=X,F[Re+4>>2]=j|De,q=+se[Re>>3]}else Qe=3;while(!1);return(Qe|0)==3&&(q=W*q,q=q/q),+q}function pc(W,q){return W=+W,q=+q,+ +hl(W,q)}function la(W,q){W=+W,q=q|0;var j=0,X=0,G=0;switch(se[Re>>3]=W,j=F[Re>>2]|0,X=F[Re+4>>2]|0,G=nc(j|0,X|0,52)|0,G=G&2047,G|0){case 0:{W!=0?(W=+la(W*18446744073709552e3,q),j=(F[q>>2]|0)+-64|0):j=0,F[q>>2]=j;break}case 2047:break;default:F[q>>2]=G+-1022,F[Re>>2]=j,F[Re+4>>2]=X&-2146435073|1071644672,W=+se[Re>>3]}return+W}function el(W,q){return W=+W,q=q|0,+ +la(W,q)}function kl(W,q){W=+W,q=q|0;var j=0;return(q|0)>1023?(W=W*898846567431158e293,j=q+-1023|0,(j|0)>1023&&(j=q+-2046|0,j=(j|0)>1023?1023:j,W=W*898846567431158e293)):(q|0)<-1022?(W=W*22250738585072014e-324,j=q+1022|0,(j|0)<-1022&&(j=q+2044|0,j=(j|0)<-1022?-1022:j,W=W*22250738585072014e-324)):j=q,j=Bo(j+1023|0,0,52)|0,q=_t,F[Re>>2]=j,F[Re+4>>2]=q,+(W*+se[Re>>3])}function qc(W,q){return W=+W,q=q|0,+ +kl(W,q)}function Gl(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0;le=me,me=me+16|0,G=le,ee=X|0?X:2680,X=F[ee>>2]|0;e:do if(!q)X?J=15:X=0;else if(O=W|0?W:G,!j)X=-2;else{if(X)G=j,J=9;else{if(X=ie[q>>0]|0,G=X&255,X<<24>>24>-1){F[O>>2]=G,X=X<<24>>24!=0&1;break}if(X=G+-194|0,X>>>0>50){J=15;break}X=F[2432+(X<<2)>>2]|0,G=j+-1|0,G&&(q=q+1|0,J=9)}t:do if((J|0)==9){if(W=ie[q>>0]|0,ce=(W&255)>>>3,(ce+-16|ce+(X>>26))>>>0>7){J=15;break e}for(;q=q+1|0,X=(W&255)+-128|X<<6,G=G+-1|0,!((X|0)>=0);){if(!G)break t;if(W=ie[q>>0]|0,(W&-64)<<24>>24!=-128){J=15;break e}}F[ee>>2]=0,F[O>>2]=X,X=j-G|0;break e}while(!1);F[ee>>2]=X,X=-2}while(!1);return(J|0)==15&&(F[ee>>2]=0,F[(Is()|0)>>2]=84,X=-1),me=le,X|0}function Jc(W){return W=W|0,W?W=(F[W>>2]|0)==0:W=1,W&1|0}function z0(W,q,j){W=W|0,q=q|0,j=j|0;do if(W){if(q>>>0<128){ie[W>>0]=q,W=1;break}if(q>>>0<2048){ie[W>>0]=q>>>6|192,ie[W+1>>0]=q&63|128,W=2;break}if(q>>>0<55296|(q&-8192|0)==57344){ie[W>>0]=q>>>12|224,ie[W+1>>0]=q>>>6&63|128,ie[W+2>>0]=q&63|128,W=3;break}if((q+-65536|0)>>>0<1048576){ie[W>>0]=q>>>18|240,ie[W+1>>0]=q>>>12&63|128,ie[W+2>>0]=q>>>6&63|128,ie[W+3>>0]=q&63|128,W=4;break}else{F[(Is()|0)>>2]=84,W=-1;break}}else W=1;while(!1);return W|0}function Zc(W,q){return W=W|0,q=q|0,W?W=z0(W,q,0)|0:W=0,W|0}function Jo(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0;if(Ce=me,me=me+112|0,he=Ce+40|0,le=Ce+24|0,J=Ce+16|0,G=Ce,ce=Ce+52|0,X=ie[q>>0]|0,qa(14909,X<<24>>24,4)|0)if(j=$i(1144)|0,!j)j=0;else{O=j,ee=O+112|0;do F[O>>2]=0,O=O+4|0;while((O|0)<(ee|0));wa(q,43)|0||(F[j>>2]=X<<24>>24==114?8:4),wa(q,101)|0&&(F[G>>2]=W,F[G+4>>2]=2,F[G+8>>2]=1,yn(221,G|0)|0,X=ie[q>>0]|0),X<<24>>24==97?(F[J>>2]=W,F[J+4>>2]=3,X=yn(221,J|0)|0,X&1024||(F[le>>2]=W,F[le+4>>2]=4,F[le+8>>2]=X|1024,yn(221,le|0)|0),q=F[j>>2]|128,F[j>>2]=q):q=F[j>>2]|0,F[j+60>>2]=W,F[j+44>>2]=j+120,F[j+48>>2]=1024,X=j+75|0,ie[X>>0]=-1,!(q&8|0)&&(F[he>>2]=W,F[he+4>>2]=21505,F[he+8>>2]=ce,(Ss(54,he|0)|0)==0)&&(ie[X>>0]=10),F[j+32>>2]=14,F[j+36>>2]=4,F[j+40>>2]=5,F[j+12>>2]=2,F[598]|0||(F[j+76>>2]=-1),ti(2416),X=F[603]|0,F[j+56>>2]=X,X&&(F[X+52>>2]=j),F[603]=j,bs(2416)}else F[(Is()|0)>>2]=22,j=0;return me=Ce,j|0}function kr(W){W=W|0;var q=0,j=0,X=0;return j=(wa(W,43)|0)==0,q=ie[W>>0]|0,j=j?q<<24>>24!=114&1:2,X=(wa(W,120)|0)==0,j=X?j:j|128,W=(wa(W,101)|0)==0,W=W?j:j|524288,W=q<<24>>24==114?W:W|64,W=q<<24>>24==119?W|512:W,(q<<24>>24==97?W|1024:W)|0}function ia(W){return W=W|0,0}function Eo(W){W=W|0}function kd(W){W=W|0;var q=0,j=0;return q=me,me=me+16|0,j=q,F[j>>2]=F[W+60>>2],W=Hs(bi(6,j|0)|0)|0,me=q,W|0}function Zf(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0;return ce=me,me=me+48|0,O=ce+16|0,G=ce,X=ce+32|0,F[X>>2]=q,ee=X+4|0,le=W+48|0,he=F[le>>2]|0,F[ee>>2]=j-((he|0)!=0&1),J=W+44|0,F[X+8>>2]=F[J>>2],F[X+12>>2]=he,F[597]|0?(Qs(13,W|0),F[G>>2]=F[W+60>>2],F[G+4>>2]=X,F[G+8>>2]=2,X=Hs(zo(145,G|0)|0)|0,It(0)):(F[O>>2]=F[W+60>>2],F[O+4>>2]=X,F[O+8>>2]=2,X=Hs(zo(145,O|0)|0)|0),(X|0)>=1?(ee=F[ee>>2]|0,X>>>0>ee>>>0&&(O=F[J>>2]|0,G=W+4|0,F[G>>2]=O,F[W+8>>2]=O+(X-ee),F[le>>2]|0&&(F[G>>2]=O+1,ie[q+(j+-1)>>0]=ie[O>>0]|0),X=j)):(F[W>>2]=F[W>>2]|X&48^16,F[W+8>>2]=0,F[W+4>>2]=0),me=ce,X|0}function Bc(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0;return G=me,me=me+32|0,O=G,X=G+20|0,F[O>>2]=F[W+60>>2],F[O+4>>2]=0,F[O+8>>2]=q,F[O+12>>2]=X,F[O+16>>2]=j,(Hs(Ao(140,O|0)|0)|0)<0?(F[X>>2]=-1,W=-1):W=F[X>>2]|0,me=G,W|0}function dl(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;for(We=me,me=me+48|0,Ce=We+16|0,he=We,X=We+32|0,De=W+28|0,G=F[De>>2]|0,F[X>>2]=G,Qe=W+20|0,G=(F[Qe>>2]|0)-G|0,F[X+4>>2]=G,F[X+8>>2]=q,F[X+12>>2]=j,le=W+60|0,ce=W+44|0,q=2,G=G+j|0;;){if(F[597]|0?(Qs(14,W|0),F[he>>2]=F[le>>2],F[he+4>>2]=X,F[he+8>>2]=q,ee=Hs(Aa(146,he|0)|0)|0,It(0)):(F[Ce>>2]=F[le>>2],F[Ce+4>>2]=X,F[Ce+8>>2]=q,ee=Hs(Aa(146,Ce|0)|0)|0),(G|0)==(ee|0)){G=6;break}if((ee|0)<0){G=8;break}G=G-ee|0,O=F[X+4>>2]|0,ee>>>0<=O>>>0?(q|0)==2?(F[De>>2]=(F[De>>2]|0)+ee,J=O,q=2):J=O:(J=F[ce>>2]|0,F[De>>2]=J,F[Qe>>2]=J,J=F[X+12>>2]|0,ee=ee-O|0,X=X+8|0,q=q+-1|0),F[X>>2]=(F[X>>2]|0)+ee,F[X+4>>2]=J-ee}return(G|0)==6?(Ce=F[ce>>2]|0,F[W+16>>2]=Ce+(F[W+48>>2]|0),W=Ce,F[De>>2]=W,F[Qe>>2]=W):(G|0)==8&&(F[W+16>>2]=0,F[De>>2]=0,F[Qe>>2]=0,F[W>>2]=F[W>>2]|32,(q|0)==2?j=0:j=j-(F[X+4>>2]|0)|0),me=We,j|0}function n0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;return G=me,me=me+80|0,X=G,F[W+36>>2]=4,!(F[W>>2]&64|0)&&(F[X>>2]=F[W+60>>2],F[X+4>>2]=21505,F[X+8>>2]=G+12,(Ss(54,X|0)|0)!=0)&&(ie[W+75>>0]=-1),X=dl(W,q,j)|0,me=G,X|0}function jc(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;return X=W+84|0,O=F[X>>2]|0,ee=j+256|0,G=qa(O,0,ee)|0,G=G|0?G-O|0:ee,j=G>>>0<j>>>0?G:j,Ko(q|0,O|0,j|0)|0,F[W+4>>2]=O+j,q=O+G|0,F[W+8>>2]=q,F[X>>2]=q,j|0}function vu(W){W=W|0;var q=0,j=0;return q=W+74|0,j=ie[q>>0]|0,ie[q>>0]=j+255|j,q=W+20|0,j=W+44|0,(F[q>>2]|0)>>>0>(F[j>>2]|0)>>>0&&en[F[W+36>>2]&15](W,0,0)|0,F[W+16>>2]=0,F[W+28>>2]=0,F[q>>2]=0,q=F[W>>2]|0,q&20?(q&4&&(F[W>>2]=q|32),q=-1):(q=F[j>>2]|0,F[W+8>>2]=q,F[W+4>>2]=q,q=0),q|0}function S0(W){W=W|0;var q=0,j=0;return q=W+74|0,j=ie[q>>0]|0,ie[q>>0]=j+255|j,q=F[W>>2]|0,q&8?(F[W>>2]=q|32,q=-1):(F[W+8>>2]=0,F[W+4>>2]=0,q=F[W+44>>2]|0,F[W+28>>2]=q,F[W+20>>2]=q,F[W+16>>2]=q+(F[W+48>>2]|0),q=0),q|0}function Ql(W){W=W|0;var q=0,j=0;return j=me,me=me+16|0,q=j,!(F[W+8>>2]|0)&&vu(W)|0?q=-1:(en[F[W+32>>2]&15](W,q,1)|0)==1?q=fe[q>>0]|0:q=-1,me=j,q|0}function W0(W){W=W|0;var q=0,j=0,X=0;return X=(F[W>>2]&1|0)!=0,X||(ti(2416),j=F[W+52>>2]|0,q=W+56|0,j&&(F[j+56>>2]=F[q>>2]),q=F[q>>2]|0,q&&(F[q+52>>2]=j),(F[603]|0)==(W|0)&&(F[603]=q),bs(2416)),q=Co(W)|0,q=Zr[F[W+12>>2]&31](W)|0|q,j=F[W+92>>2]|0,j&&Mr(j),X||Mr(W),q|0}function Xo(W){W=W|0;var q=0;return(F[W+76>>2]|0)>-1&&(q=(ia(W)|0)==0),W=(F[W>>2]|0)>>>5&1,W|0}function Co(W){W=W|0;var q=0,j=0;do if(W){if((F[W+76>>2]|0)<=-1){q=gc(W)|0;break}j=(ia(W)|0)==0,q=gc(W)|0,j||Eo(W)}else{if(F[660]|0?q=Co(F[660]|0)|0:q=0,ti(2416),W=F[603]|0,W)do(F[W+76>>2]|0)>-1?j=ia(W)|0:j=0,(F[W+20>>2]|0)>>>0>(F[W+28>>2]|0)>>>0&&(q=gc(W)|0|q),j&&Eo(W),W=F[W+56>>2]|0;while(W|0);bs(2416)}while(!1);return q|0}function i0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;if((F[j+76>>2]|0)>-1?Ce=ia(j)|0:Ce=0,X=q+-1|0,(q|0)<2)De=j+74|0,he=ie[De>>0]|0,ie[De>>0]=he+255|he,Ce&&Eo(j),X?W=0:ie[W>>0]=0;else{e:do if(X){for(ce=j+4|0,he=j+8|0,G=W;;){if(O=F[ce>>2]|0,Qe=O,J=(F[he>>2]|0)-Qe|0,ee=qa(O,10,J)|0,We=(ee|0)==0,ee=We?J:1-Qe+ee|0,Qe=ee>>>0<X>>>0,ee=Qe?ee:X,Ko(G|0,O|0,ee|0)|0,O=F[ce>>2]|0,J=O+ee|0,F[ce>>2]=J,q=G+ee|0,le=X-ee|0,!(We&Qe)){De=18;break e}if(J>>>0<(F[he>>2]|0)>>>0)ee=ee+1|0,F[ce>>2]=O+ee,O=fe[J>>0]|0;else{if(X=Ql(j)|0,(X|0)<0)break;ee=ee+1|0,O=X}if(X=le+-1|0,G=G+ee|0,ie[q>>0]=O,!((X|0)!=0&(O&255|0)!=10)){q=G,De=18;break e}}(q|0)!=(W|0)&&F[j>>2]&16|0?De=18:W=0}else q=W,De=18;while(!1);(De|0)==18&&(W?ie[q>>0]=0:W=0),Ce&&Eo(j)}return W|0}function va(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;return G=me,me=me+32|0,X=G+16|0,j=G,qa(14909,ie[q>>0]|0,4)|0?(O=kr(q)|0|32768,F[j>>2]=W,F[j+4>>2]=O,F[j+8>>2]=438,j=Hs(cr(5,j|0)|0)|0,(j|0)>=0?(W=Jo(j,q)|0,W||(F[X>>2]=j,bi(6,X|0)|0,W=0)):W=0):(F[(Is()|0)>>2]=22,W=0),me=G,W|0}function Ka(W,q){return W=W|0,q=q|0,(pl(W,Na(W)|0,1,q)|0)+-1|0}function Ac(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0;J=kt(j,q)|0,(F[X+76>>2]|0)>-1?le=ia(X)|0:le=0,G=X+74|0,O=ie[G>>0]|0,ie[G>>0]=O+255|O,G=X+4|0,O=F[G>>2]|0,ee=(F[X+8>>2]|0)-O|0,(ee|0)>0?(ee=ee>>>0<J>>>0?ee:J,Ko(W|0,O|0,ee|0)|0,F[G>>2]=O+ee,W=W+ee|0,G=J-ee|0):G=J;e:do if(!G)ce=13;else{for(ee=X+32|0,O=G;;){if(vu(X)|0){j=O;break}if(G=en[F[ee>>2]&15](X,W,O)|0,(G+1|0)>>>0<2){j=O;break}if((O|0)==(G|0)){ce=13;break e}else W=W+G|0,O=O-G|0}le&&Eo(X),j=((J-j|0)>>>0)/(q>>>0)|0}while(!1);return(ce|0)==13&&le&&Eo(X),j|0}function mc(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;return(j|0)==1&&(q=q-(F[W+8>>2]|0)+(F[W+4>>2]|0)|0),G=W+20|0,X=W+28|0,(F[G>>2]|0)>>>0>(F[X>>2]|0)>>>0&&(en[F[W+36>>2]&15](W,0,0)|0,(F[G>>2]|0)==0)?q=-1:(F[W+16>>2]=0,F[X>>2]=0,F[G>>2]=0,(en[F[W+40>>2]&15](W,q,j)|0)<0?q=-1:(F[W+8>>2]=0,F[W+4>>2]=0,F[W>>2]=F[W>>2]&-17,q=0)),q|0}function M0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0;return(F[W+76>>2]|0)>-1?(X=(ia(W)|0)==0,q=mc(W,q,j)|0,X||Eo(W)):q=mc(W,q,j)|0,q|0}function eu(W,q,j){return W=W|0,q=q|0,j=j|0,M0(W,q,j)|0}function Fh(W){W=W|0;var q=0;return F[W>>2]&128?q=(F[W+20>>2]|0)>>>0>(F[W+28>>2]|0)>>>0?2:1:q=1,q=en[F[W+40>>2]&15](W,0,q)|0,(q|0)>=0&&(q=q-(F[W+8>>2]|0)+(F[W+4>>2]|0)+(F[W+20>>2]|0)-(F[W+28>>2]|0)|0),q|0}function Gd(W){W=W|0;var q=0;return(F[W+76>>2]|0)>-1&&(q=(ia(W)|0)==0),W=Fh(W)|0,W|0}function qu(W){return W=W|0,Gd(W)|0}function Go(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;X=j+16|0,G=F[X>>2]|0,G?O=4:S0(j)|0?X=0:(G=F[X>>2]|0,O=4);e:do if((O|0)==4){if(ee=j+20|0,O=F[ee>>2]|0,(G-O|0)>>>0<q>>>0){X=en[F[j+36>>2]&15](j,W,q)|0;break}t:do if((ie[j+75>>0]|0)>-1){for(X=q;;){if(!X){G=O,X=0;break t}if(G=X+-1|0,(ie[W+G>>0]|0)==10)break;X=G}if((en[F[j+36>>2]&15](j,W,X)|0)>>>0<X>>>0)break e;q=q-X|0,W=W+X|0,G=F[ee>>2]|0}else G=O,X=0;while(!1);Ko(G|0,W|0,q|0)|0,F[ee>>2]=(F[ee>>2]|0)+q,X=X+q|0}while(!1);return X|0}function pl(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0;return G=kt(j,q)|0,(F[X+76>>2]|0)>-1?(O=(ia(X)|0)==0,W=Go(W,G,X)|0,O||Eo(X)):W=Go(W,G,X)|0,(W|0)!=(G|0)&&(j=(W>>>0)/(q>>>0)|0),j|0}function uo(W){W=W|0;var q=0;(F[W+76>>2]|0)>-1?(q=(ia(W)|0)==0,mc(W,0,0)|0,F[W>>2]=F[W>>2]&-33,q||Eo(W)):(mc(W,0,0)|0,F[W>>2]=F[W>>2]&-33)}function Ya(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;return X=me,me=me+16|0,G=X,F[G>>2]=j,j=Al(W,q,G)|0,me=X,j|0}function Hl(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0;J=me,me=me+16|0,X=J,G=$i(240)|0;do if(G){if(F[X>>2]=F[j>>2],X=tl(G,240,q,X)|0,X>>>0<240){q=zl(G,X+1|0)|0,F[W>>2]=q|0?q:G;break}Mr(G),(X|0)>=0&&(ee=X+1|0,O=$i(ee)|0,F[W>>2]=O,(O|0)!=0)?X=tl(O,ee,q,j)|0:X=-1}else X=-1;while(!1);return me=J,X|0}function Qd(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0;pt=me,me=me+224|0,Ce=pt+80|0,We=pt+96|0,Qe=pt,De=pt+136|0,X=We,G=X+40|0;do F[X>>2]=0,X=X+4|0;while((X|0)<(G|0));return F[Ce>>2]=F[j>>2],(So(0,q,Ce,Qe,We)|0)<0?j=-1:((F[W+76>>2]|0)>-1?ce=ia(W)|0:ce=0,j=F[W>>2]|0,he=j&32,(ie[W+74>>0]|0)<1&&(F[W>>2]=j&-33),j=W+48|0,F[j>>2]|0?X=So(W,q,Ce,Qe,We)|0:(G=W+44|0,O=F[G>>2]|0,F[G>>2]=De,ee=W+28|0,F[ee>>2]=De,J=W+20|0,F[J>>2]=De,F[j>>2]=80,le=W+16|0,F[le>>2]=De+80,X=So(W,q,Ce,Qe,We)|0,O&&(en[F[W+36>>2]&15](W,0,0)|0,X=F[J>>2]|0?X:-1,F[G>>2]=O,F[j>>2]=0,F[le>>2]=0,F[ee>>2]=0,F[J>>2]=0)),j=F[W>>2]|0,F[W>>2]=j|he,ce&&Eo(W),j=j&32|0?-1:X),me=pt,j|0}function h0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0;tr=me,me=me+304|0,Bn=tr+16|0,Wn=tr+8|0,Gn=tr+33|0,ei=tr,qe=tr+32|0,(F[W+76>>2]|0)>-1?Gi=ia(W)|0:Gi=0,X=ie[q>>0]|0;e:do if(X<<24>>24){Pn=W+4|0,Yi=W+100|0,Qt=W+108|0,Je=W+8|0,lt=Gn+10|0,Et=Gn+33|0,At=Wn+4|0,je=Gn+46|0,Ye=Gn+94|0,O=X,X=0,ee=q,Ce=0,G=0,q=0;t:for(;;){n:do if(Ms(O&255)|0){for(;O=ee+1|0,Ms(fe[O>>0]|0)|0;)ee=O;Xs(W,0);do O=F[Pn>>2]|0,O>>>0<(F[Yi>>2]|0)>>>0?(F[Pn>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0;while(Ms(O)|0);O=F[Pn>>2]|0,F[Yi>>2]|0&&(O=O+-1|0,F[Pn>>2]=O),J=(F[Qt>>2]|0)+Ce+O-(F[Je>>2]|0)|0}else{O=(ie[ee>>0]|0)==37;r:do if(O){ce=ee+1|0,J=ie[ce>>0]|0;i:do switch(J<<24>>24){case 37:break r;case 42:{rt=0,J=ee+2|0;break}default:{if(J=(J&255)+-48|0,J>>>0<10&&(ie[ee+2>>0]|0)==36){for(F[Bn>>2]=F[j>>2];rt=(F[Bn>>2]|0)+3&-4,O=F[rt>>2]|0,F[Bn>>2]=rt+4,J>>>0>1;)J=J+-1|0;rt=O,J=ee+3|0;break i}J=(F[j>>2]|0)+3&-4,rt=F[J>>2]|0,F[j>>2]=J+4,J=ce}}while(!1);if(O=ie[J>>0]|0,ee=O&255,(ee+-48|0)>>>0<10)for(O=0;ce=(O*10|0)+-48+ee|0,J=J+1|0,O=ie[J>>0]|0,ee=O&255,!((ee+-48|0)>>>0>=10);)O=ce;else ce=0;switch(O<<24>>24==109?(J=J+1|0,he=ie[J>>0]|0,O=(rt|0)!=0&1,G=0,q=0):(he=O,O=0),ee=J+1|0,he&255|0){case 104:{pt=(ie[ee>>0]|0)==104,ee=pt?J+2|0:ee,J=pt?-2:-1;break}case 108:{pt=(ie[ee>>0]|0)==108,ee=pt?J+2|0:ee,J=pt?3:1;break}case 106:{J=3;break}case 116:case 122:{J=1;break}case 76:{J=2;break}case 110:case 112:case 67:case 83:case 91:case 99:case 115:case 88:case 71:case 70:case 69:case 65:case 103:case 102:case 101:case 97:case 120:case 117:case 111:case 105:case 100:{ee=J,J=0;break}default:{mi=152;break t}}switch(he=fe[ee>>0]|0,De=(he&47|0)==3,he=De?he|32:he,De=De?1:J,he|0){case 99:{pt=Ce,We=(ce|0)<1?1:ce;break}case 91:{pt=Ce,We=ce;break}case 110:{if(!rt){J=Ce;break n}switch(De|0){case-2:{ie[rt>>0]=Ce,J=Ce;break n}case-1:{ne[rt>>1]=Ce,J=Ce;break n}case 0:{F[rt>>2]=Ce,J=Ce;break n}case 1:{F[rt>>2]=Ce,J=Ce;break n}case 3:{J=rt,F[J>>2]=Ce,F[J+4>>2]=((Ce|0)<0)<<31>>31,J=Ce;break n}default:{J=Ce;break n}}}default:{Xs(W,0);do J=F[Pn>>2]|0,J>>>0<(F[Yi>>2]|0)>>>0?(F[Pn>>2]=J+1,J=fe[J>>0]|0):J=Lr(W)|0;while(Ms(J)|0);J=F[Pn>>2]|0,F[Yi>>2]|0&&(J=J+-1|0,F[Pn>>2]=J),pt=(F[Qt>>2]|0)+Ce+J-(F[Je>>2]|0)|0,We=ce}}if(Xs(W,We),J=F[Pn>>2]|0,ce=F[Yi>>2]|0,J>>>0<ce>>>0)F[Pn>>2]=J+1;else{if((Lr(W)|0)<0){mi=152;break t}ce=F[Yi>>2]|0}ce&&(F[Pn>>2]=(F[Pn>>2]|0)+-1);i:do switch(he|0){case 91:case 99:case 115:{Qe=(he|0)==99;s:do if((he&239|0)==99)ii(Gn|0,-1,257)|0,ie[Gn>>0]=0,(he|0)==115&&(ie[Et>>0]=0,ie[lt>>0]=0,ie[lt+1>>0]=0,ie[lt+2>>0]=0,ie[lt+3>>0]=0,ie[lt+4>>0]=0);else{switch(Di=ee+1|0,Ce=(ie[Di>>0]|0)==94,J=Ce&1,he=Ce?Di:ee,ee=Ce?ee+2|0:Di,ii(Gn|0,Ce&1|0,257)|0,ie[Gn>>0]=0,ie[ee>>0]|0){case 45:{Ce=(J^1)&255,ie[je>>0]=Ce,ee=he+2|0;break}case 93:{Ce=(J^1)&255,ie[Ye>>0]=Ce,ee=he+2|0;break}default:Ce=(J^1)&255}for(;;){J=ie[ee>>0]|0;o:do switch(J<<24>>24){case 0:{mi=152;break t}case 93:break s;case 45:{switch(he=ee+1|0,J=ie[he>>0]|0,J<<24>>24){case 93:case 0:{J=45;break o}default:}if(ee=ie[ee+-1>>0]|0,(ee&255)<(J&255)){ee=ee&255;do ee=ee+1|0,ie[Gn+ee>>0]=Ce,J=ie[he>>0]|0;while((ee|0)<(J&255|0));ee=he}else ee=he;break}default:}while(!1);ie[Gn+((J&255)+1)>>0]=Ce,ee=ee+1|0}}while(!1);he=Qe?We+1|0:31,Ce=(De|0)==1,De=(O|0)!=0;s:do if(Ce){if(De){if(q=$i(he<<2)|0,!q){G=0,mi=152;break t}}else q=rt;F[Wn>>2]=0,F[At>>2]=0,G=0;o:for(;;){ce=(q|0)==0;do{a:for(;;){if(J=F[Pn>>2]|0,J>>>0<(F[Yi>>2]|0)>>>0?(F[Pn>>2]=J+1,J=fe[J>>0]|0):J=Lr(W)|0,!(ie[Gn+(J+1)>>0]|0))break o;switch(ie[qe>>0]=J,Gl(ei,qe,1,Wn)|0){case-1:{G=0,mi=152;break t}case-2:break;default:break a}}ce||(F[q+(G<<2)>>2]=F[ei>>2],G=G+1|0)}while(!(De&(G|0)==(he|0)));if(G=he<<1|1,J=zl(q,G<<2)|0,!J){G=0,mi=152;break t}Di=he,he=G,q=J,G=Di}if(Jc(Wn)|0)ce=G,G=0;else{G=0,mi=152;break t}}else{if(De){if(G=$i(he)|0,G)J=0;else{G=0,q=0,mi=152;break t}for(;;){do{if(q=F[Pn>>2]|0,q>>>0<(F[Yi>>2]|0)>>>0?(F[Pn>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,!(ie[Gn+(q+1)>>0]|0)){ce=J,q=0;break s}ie[G+J>>0]=q,J=J+1|0}while((J|0)!=(he|0));if(q=he<<1|1,J=zl(G,q)|0,J)Di=he,he=q,G=J,J=Di;else{q=0,mi=152;break t}}}if(rt)for(G=0;;){if(q=F[Pn>>2]|0,q>>>0<ce>>>0?(F[Pn>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,!(ie[Gn+(q+1)>>0]|0)){ce=G,G=rt,q=0;break s}ie[rt+G>>0]=q,ce=F[Yi>>2]|0,G=G+1|0}else for(G=ce;;){if(q=F[Pn>>2]|0,q>>>0<G>>>0?(F[Pn>>2]=q+1,q=fe[q>>0]|0):q=Lr(W)|0,!(ie[Gn+(q+1)>>0]|0)){ce=0,G=0,q=0;break s}G=F[Yi>>2]|0}}while(!1);if(J=F[Pn>>2]|0,F[Yi>>2]|0&&(J=J+-1|0,F[Pn>>2]=J),J=J-(F[Je>>2]|0)+(F[Qt>>2]|0)|0,!J||!((J|0)==(We|0)|Qe^1))break t;do if(De)if(Ce){F[rt>>2]=q;break}else{F[rt>>2]=G;break}while(!1);if(!Qe){if(q&&(F[q+(ce<<2)>>2]=0),!G){G=0;break i}ie[G+ce>>0]=0}break}case 120:case 88:case 112:{J=16,mi=134;break}case 111:{J=8,mi=134;break}case 117:case 100:{J=10,mi=134;break}case 105:{J=0,mi=134;break}case 71:case 103:case 70:case 102:case 69:case 101:case 65:case 97:{if(le=+Pa(W,De,0),(F[Qt>>2]|0)==((F[Je>>2]|0)-(F[Pn>>2]|0)|0))break t;if(rt)switch(De|0){case 0:{ve[rt>>2]=le;break i}case 1:{se[rt>>3]=le;break i}case 2:{se[rt>>3]=le;break i}default:break i}break}default:}while(!1);i:do if((mi|0)==134){if(mi=0,J=vo(W,J,0,-1,-1)|0,(F[Qt>>2]|0)==((F[Je>>2]|0)-(F[Pn>>2]|0)|0))break t;if((rt|0)!=0&(he|0)==112){F[rt>>2]=J;break}if(rt)switch(De|0){case-2:{ie[rt>>0]=J;break i}case-1:{ne[rt>>1]=J;break i}case 0:{F[rt>>2]=J;break i}case 1:{F[rt>>2]=J;break i}case 3:{Di=rt,F[Di>>2]=J,F[Di+4>>2]=_t;break i}default:break i}}while(!1);X=((rt|0)!=0&1)+X|0,J=(F[Qt>>2]|0)+pt+(F[Pn>>2]|0)-(F[Je>>2]|0)|0;break n}while(!1);if(ee=ee+(O&1)|0,Xs(W,0),O=F[Pn>>2]|0,O>>>0<(F[Yi>>2]|0)>>>0?(F[Pn>>2]=O+1,O=fe[O>>0]|0):O=Lr(W)|0,(O|0)!=(fe[ee>>0]|0)){mi=21;break t}J=Ce+1|0}while(!1);if(ee=ee+1|0,O=ie[ee>>0]|0,O<<24>>24)Ce=J;else break e}if((mi|0)==21){if(F[Yi>>2]|0&&(F[Pn>>2]=(F[Pn>>2]|0)+-1),(X|0)!=0|(O|0)>-1)break;X=0,mi=153}else(mi|0)==152&&(X||(X=O,mi=153));(mi|0)==153&&(O=X,X=-1),O&&(Mr(G),Mr(q))}else X=0;while(!1);return Gi&&Eo(W),me=tr,X|0}function tl(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0;he=me,me=me+128|0,G=he+112|0,ce=he,O=ce,ee=2684,J=O+112|0;do F[O>>2]=F[ee>>2],O=O+4|0,ee=ee+4|0;while((O|0)<(J|0));return(q+-1|0)>>>0>2147483646?q?(F[(Is()|0)>>2]=75,q=-1):(q=1,le=4):(G=W,le=4),(le|0)==4&&(le=-2-G|0,le=q>>>0>le>>>0?le:q,F[ce+48>>2]=le,W=ce+20|0,F[W>>2]=G,F[ce+44>>2]=G,q=G+le|0,G=ce+16|0,F[G>>2]=q,F[ce+28>>2]=q,q=Qd(ce,j,X)|0,le&&(j=F[W>>2]|0,ie[j+(((j|0)==(F[G>>2]|0))<<31>>31)>>0]=0)),me=he,q|0}function Al(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;O=me,me=me+112|0,X=O,G=X,ee=G+112|0;do F[G>>2]=0,G=G+4|0;while((G|0)<(ee|0));return F[X+32>>2]=15,F[X+44>>2]=W,F[X+76>>2]=-1,F[X+84>>2]=W,ee=h0(X,q,j)|0,me=O,ee|0}function Ju(W){W=W|0;for(var q=0,j=0,X=0,G=0;q=W+1|0,Ms(ie[W>>0]|0)|0;)W=q;switch(j=ie[W>>0]|0,j<<24>>24|0){case 45:{X=1,G=5;break}case 43:{X=0,G=5;break}default:X=0}if((G|0)==5&&(W=q,j=ie[q>>0]|0),q=(j<<24>>24)+-48|0,q>>>0<10){j=W,W=0;do j=j+1|0,W=(W*10|0)-q|0,q=(ie[j>>0]|0)+-48|0;while(q>>>0<10)}else W=0;return(X|0?W:0-W|0)|0}function Eu(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0;if(pt=me,me=me+208|0,De=pt+8|0,Qe=pt,G=kt(j,q)|0,Ce=Qe,F[Ce>>2]=1,F[Ce+4>>2]=0,G){for(J=G-j|0,F[De+4>>2]=j,F[De>>2]=j,O=j,q=j,ee=2;q=q+j+O|0,F[De+(ee<<2)>>2]=q,q>>>0<G>>>0;)Ce=O,O=q,ee=ee+1|0,q=Ce;if(Ce=0-j|0,le=W+J|0,he=Qe+4|0,(J|0)>0)for(J=le,G=1,ee=1;;){do if((G&3|0)==3)Zu(W,j,X,ee,De),ce=F[he>>2]|0,q=ce<<30|(F[Qe>>2]|0)>>>2,F[Qe>>2]=q,F[he>>2]=ce>>>2,ee=ee+2|0;else{if(q=ee+-1|0,(F[De+(q<<2)>>2]|0)>>>0<(J-W|0)>>>0?Zu(W,j,X,ee,De):Nh(W,j,X,Qe,ee,0,De),(ee|0)==1){q=F[Qe>>2]|0,F[he>>2]=q>>>31|F[he>>2]<<1,q=q<<1,F[Qe>>2]=q,ee=0;break}q>>>0>31?(G=F[Qe>>2]|0,F[he>>2]=G,F[Qe>>2]=0,q=ee+-33|0,O=0):(G=F[he>>2]|0,O=F[Qe>>2]|0),F[he>>2]=O>>>(32-q|0)|G<<q,q=O<<q,F[Qe>>2]=q,ee=1}while(!1);if(G=q|1,F[Qe>>2]=G,q=W+j|0,q>>>0>=le>>>0){G=q;break}else W=q}else G=W,ee=1;if(Nh(G,j,X,Qe,ee,0,De),ce=Qe+4|0,q=F[Qe>>2]|0,!((ee|0)==1&(q|0)==1&(F[ce>>2]|0)==0))for(O=G;;){if((ee|0)<2){G=q+-1|0;do if(G){if(G&1)We=24;else{J=G,G=0;do G=G+1|0,J=J>>>1;while(!(J&1|0));G||(We=24)}if((We|0)==24){if(We=0,le=F[he>>2]|0,!le){G=64,We=30;break}if(!(le&1))J=le,G=0;else{W=0,J=le,G=0;break}for(;;)if(W=G+1|0,J=J>>>1,J&1){J=W;break}else G=W;if(J)G=G+33|0;else{W=0,J=le,G=0;break}}G>>>0>31?We=30:(W=G,J=F[he>>2]|0)}else G=32,We=30;while(!1);(We|0)==30&&(We=0,q=F[he>>2]|0,F[Qe>>2]=q,F[he>>2]=0,W=G+-32|0,J=0),F[Qe>>2]=J<<32-W|q>>>W,F[he>>2]=J>>>W,O=O+Ce|0,G=G+ee|0}else W=q>>>30,le=W|F[he>>2]<<2,G=ee+-2|0,F[Qe>>2]=(q<<1&2147483646|W<<31)^3,F[he>>2]=le>>>1,Nh(O+(0-((F[De+(G<<2)>>2]|0)+j))|0,j,X,Qe,ee+-1|0,1,De),le=F[Qe>>2]|0,F[he>>2]=le>>>31|F[he>>2]<<1,F[Qe>>2]=le<<1|1,O=O+Ce|0,Nh(O,j,X,Qe,G,1,De);if(q=F[Qe>>2]|0,(G|0)==1&(q|0)==1&(F[ce>>2]|0)==0)break;ee=G}}me=pt}function qa(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;O=q&255,X=(j|0)!=0;e:do if(X&(W&3|0)!=0)for(G=q&255;;){if((ie[W>>0]|0)==G<<24>>24){ee=6;break e}if(W=W+1|0,j=j+-1|0,X=(j|0)!=0,!(X&(W&3|0)!=0)){ee=5;break}}else ee=5;while(!1);(ee|0)==5&&(X?ee=6:j=0);e:do if((ee|0)==6&&(G=q&255,(ie[W>>0]|0)!=G<<24>>24)){X=kt(O,16843009)|0;t:do if(j>>>0>3){for(;O=F[W>>2]^X,!((O&-2139062144^-2139062144)&O+-16843009);)if(W=W+4|0,j=j+-4|0,j>>>0<=3){ee=11;break t}}else ee=11;while(!1);if((ee|0)==11&&!j){j=0;break}for(;;){if((ie[W>>0]|0)==G<<24>>24)break e;if(W=W+1|0,j=j+-1|0,!j){j=0;break}}}while(!1);return(j|0?W:0)|0}function O0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0;X=q&255;do{if(!j){q=0;break}j=j+-1|0,q=W+j|0}while((ie[q>>0]|0)!=X<<24>>24);return q|0}function Fa(W,q){W=W|0,q=q|0;var j=0,X=0;j=q;e:do if((j^W)&3)X=8;else{if(j&3)do{if(j=ie[q>>0]|0,ie[W>>0]=j,!(j<<24>>24))break e;q=q+1|0,W=W+1|0}while(q&3|0);if(j=F[q>>2]|0,!((j&-2139062144^-2139062144)&j+-16843009))for(X=W;q=q+4|0,W=X+4|0,F[X>>2]=j,j=F[q>>2]|0,!((j&-2139062144^-2139062144)&j+-16843009);)X=W;X=8}while(!1);if((X|0)==8&&(X=ie[q>>0]|0,ie[W>>0]=X,X<<24>>24))do q=q+1|0,W=W+1|0,X=ie[q>>0]|0,ie[W>>0]=X;while(X<<24>>24);return W|0}function Vl(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0;G=q;do if((G^W)&3)O=11;else{X=(j|0)!=0;e:do if(X&(G&3|0)!=0)for(;;){if(G=ie[q>>0]|0,ie[W>>0]=G,!(G<<24>>24))break e;if(j=j+-1|0,q=q+1|0,W=W+1|0,X=(j|0)!=0,!(X&(q&3|0)!=0)){O=5;break}}else O=5;while(!1);if((O|0)==5&&!X){j=0;break}if(ie[q>>0]|0){e:do if(j>>>0>3)do{if(X=F[q>>2]|0,(X&-2139062144^-2139062144)&X+-16843009)break e;F[W>>2]=X,j=j+-4|0,q=q+4|0,W=W+4|0}while(j>>>0>3);while(!1);O=11}}while(!1);e:do if((O|0)==11)if(!j)j=0;else for(;;){if(O=ie[q>>0]|0,ie[W>>0]=O,!(O<<24>>24))break e;if(j=j+-1|0,W=W+1|0,j)q=q+1|0;else{j=0;break}}while(!1);return ii(W|0,0,j|0)|0,W|0}function wa(W,q){return W=W|0,q=q|0,W=ml(W,q)|0,((ie[W>>0]|0)==(q&255)<<24>>24?W:0)|0}function ml(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;X=q&255;e:do if(!X)W=W+(Na(W)|0)|0;else{if(W&3){j=q&255;do{if(G=ie[W>>0]|0,!(G<<24>>24)||G<<24>>24==j<<24>>24)break e;W=W+1|0}while(W&3|0)}X=kt(X,16843009)|0,j=F[W>>2]|0;t:do if(!((j&-2139062144^-2139062144)&j+-16843009))do{if(G=j^X,(G&-2139062144^-2139062144)&G+-16843009)break t;W=W+4|0,j=F[W>>2]|0}while(!((j&-2139062144^-2139062144)&j+-16843009|0));while(!1);for(j=q&255;G=ie[W>>0]|0,!(!(G<<24>>24)||G<<24>>24==j<<24>>24);)W=W+1|0}while(!1);return W|0}function Oh(W,q){return W=W|0,q=q|0,Fa(W,q)|0,W|0}function Wr(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;if(G=me,me=me+32|0,X=G,j=ie[q>>0]|0,j<<24>>24&&ie[q+1>>0]|0){F[X>>2]=0,F[X+4>>2]=0,F[X+8>>2]=0,F[X+12>>2]=0,F[X+16>>2]=0,F[X+20>>2]=0,F[X+24>>2]=0,F[X+28>>2]=0;do O=X+(((j&255)>>>5&255)<<2)|0,F[O>>2]=F[O>>2]|1<<(j&31),q=q+1|0,j=ie[q>>0]|0;while(j<<24>>24);q=ie[W>>0]|0;e:do if(!(q<<24>>24))j=W;else{j=W;do{if(F[X+(((q&255)>>>5&255)<<2)>>2]&1<<(q&31))break e;j=j+1|0,q=ie[j>>0]|0}while(q<<24>>24)}while(!1);j=j-W|0}else j=(ml(W,j<<24>>24)|0)-W|0;return me=G,j|0}function Oa(W){W=W|0;var q=0,j=0;return j=(Na(W)|0)+1|0,q=$i(j)|0,q?Ko(q|0,W|0,j|0)|0:q=0,q|0}function Na(W){W=W|0;var q=0,j=0,X=0;X=W;e:do if(!(X&3))j=4;else for(q=W,W=X;;){if(!(ie[q>>0]|0))break e;if(q=q+1|0,W=q,!(W&3)){W=q,j=4;break}}while(!1);if((j|0)==4){for(;q=F[W>>2]|0,!((q&-2139062144^-2139062144)&q+-16843009);)W=W+4|0;if((q&255)<<24>>24)do W=W+1|0;while(ie[W>>0]|0)}return W-X|0}function Oo(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0;X=W+(Na(W)|0)|0;e:do if(j)for(;;){if(G=ie[q>>0]|0,!(G<<24>>24))break e;if(j=j+-1|0,O=X+1|0,ie[X>>0]=G,j)q=q+1|0,X=O;else{X=O;break}}while(!1);return ie[X>>0]=0,W|0}function Io(W,q,j){return W=W|0,q=q|0,j=j|0,Vl(W,q,j)|0,W|0}function Ua(W,q){return W=W|0,q=q|0,O0(W,q,(Na(W)|0)+1|0)|0}function k1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;O=me,me=me+32|0,G=O,F[G>>2]=0,F[G+4>>2]=0,F[G+8>>2]=0,F[G+12>>2]=0,F[G+16>>2]=0,F[G+20>>2]=0,F[G+24>>2]=0,F[G+28>>2]=0,X=ie[q>>0]|0;do if(!(X<<24>>24))q=0;else{if(ie[q+1>>0]|0)j=q,q=X;else{for(q=W;(ie[q>>0]|0)==X<<24>>24;)q=q+1|0;q=q-W|0;break}do X=G+(((q&255)>>>5&255)<<2)|0,F[X>>2]=F[X>>2]|1<<(q&31),j=j+1|0,q=ie[j>>0]|0;while(q<<24>>24);j=ie[W>>0]|0;e:do if(!(j<<24>>24))q=W;else{q=W;do{if(!(F[G+(((j&255)>>>5&255)<<2)>>2]&1<<(j&31)))break e;q=q+1|0,j=ie[q>>0]|0}while(j<<24>>24)}while(!1);q=q-W|0}while(!1);return me=O,q|0}function d0(W,q){W=W|0,q=q|0;var j=0,X=0;W?(X=W,j=3):(W=F[699]|0,W?(X=W,j=3):W=0);do if((j|0)==3){if(j=k1(X,q)|0,W=X+j|0,!(ie[W>>0]|0)){F[699]=0,W=0;break}if(j=(Wr(W,q)|0)+j|0,q=X+j|0,F[699]=q,ie[q>>0]|0){F[699]=X+(j+1),ie[q>>0]=0;break}else{F[699]=0;break}}while(!1);return W|0}function Lc(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0;switch(ee=W+4|0,j=F[ee>>2]|0,J=W+100|0,j>>>0<(F[J>>2]|0)>>>0?(F[ee>>2]=j+1,j=fe[j>>0]|0):j=Lr(W)|0,j|0){case 43:case 45:{X=(j|0)==45&1,j=F[ee>>2]|0,j>>>0<(F[J>>2]|0)>>>0?(F[ee>>2]=j+1,j=fe[j>>0]|0):j=Lr(W)|0,(q|0)!=0&(j+-48|0)>>>0>9&&F[J>>2]|0&&(F[ee>>2]=(F[ee>>2]|0)+-1),O=X;break}default:O=0}if((j+-48|0)>>>0>9)F[J>>2]|0?(F[ee>>2]=(F[ee>>2]|0)+-1,X=-2147483648,j=0):(X=-2147483648,j=0);else{X=0;do X=j+-48+(X*10|0)|0,j=F[ee>>2]|0,j>>>0<(F[J>>2]|0)>>>0?(F[ee>>2]=j+1,j=fe[j>>0]|0):j=Lr(W)|0;while((j+-48|0)>>>0<10&(X|0)<214748364);if(q=((X|0)<0)<<31>>31,(j+-48|0)>>>0<10){do q=E0(X|0,q|0,10,0)|0,X=_t,j=Bs(j|0,((j|0)<0)<<31>>31|0,-48,-1)|0,X=Bs(j|0,_t|0,q|0,X|0)|0,q=_t,j=F[ee>>2]|0,j>>>0<(F[J>>2]|0)>>>0?(F[ee>>2]=j+1,j=fe[j>>0]|0):j=Lr(W)|0;while((j+-48|0)>>>0<10&((q|0)<21474836|(q|0)==21474836&X>>>0<2061584302));G=X}else G=X;if((j+-48|0)>>>0<10)do j=F[ee>>2]|0,j>>>0<(F[J>>2]|0)>>>0?(F[ee>>2]=j+1,j=fe[j>>0]|0):j=Lr(W)|0;while((j+-48|0)>>>0<10);F[J>>2]|0&&(F[ee>>2]=(F[ee>>2]|0)+-1),W=(O|0)!=0,j=o0(0,0,G|0,q|0)|0,X=W?_t:q,j=W?j:G}return _t=X,j|0}function Hd(W){W=W|0,F[W+68>>2]|0||Eo(W)}function Ea(W){W=W|0,F[W+68>>2]|0||Eo(W)}function gc(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0;return q=W+20|0,O=W+28|0,(F[q>>2]|0)>>>0>(F[O>>2]|0)>>>0&&(en[F[W+36>>2]&15](W,0,0)|0,(F[q>>2]|0)==0)?q=-1:(ee=W+4|0,j=F[ee>>2]|0,X=W+8|0,G=F[X>>2]|0,j>>>0<G>>>0&&en[F[W+40>>2]&15](W,j-G|0,1)|0,F[W+16>>2]=0,F[O>>2]=0,F[q>>2]=0,F[X>>2]=0,F[ee>>2]=0,q=0),q|0}function So(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0,jr=0,wr=0,ks=0,ho=0,zs=0,Fi=0,ar=0,Cr=0,no=0,ms=0,ic=0,ol=0,Gf=0,Qf=0,Hc=0;Hc=me,me=me+624|0,ms=Hc+24|0,ol=Hc+16|0,ic=Hc+588|0,zs=Hc+576|0,no=Hc,wr=Hc+536|0,Qf=Hc+8|0,Gf=Hc+528|0,Yi=(W|0)!=0,mi=wr+40|0,jr=mi,wr=wr+39|0,ks=Qf+4|0,ho=zs+12|0,zs=zs+11|0,Fi=ic,ar=ho,Cr=ar-Fi|0,Gi=-2-Fi|0,tr=ar+2|0,Di=ms+288|0,wn=ic+9|0,ci=wn,Rn=ic+8|0,O=0,pt=q,ee=0,q=0;e:for(;;){do if((O|0)>-1)if((ee|0)>(2147483647-O|0)){F[(Is()|0)>>2]=75,O=-1;break}else{O=ee+O|0;break}while(!1);if(ee=ie[pt>>0]|0,ee<<24>>24)J=pt;else{Pn=245;break}t:for(;;){switch(ee<<24>>24){case 37:{ee=J,Pn=9;break t}case 0:{ee=J;break t}default:}ei=J+1|0,ee=ie[ei>>0]|0,J=ei}t:do if((Pn|0)==9)for(;;){if(Pn=0,(ie[ee+1>>0]|0)!=37)break t;if(J=J+1|0,ee=ee+2|0,(ie[ee>>0]|0)==37)Pn=9;else break}while(!1);if(qe=J-pt|0,Yi&&!(F[W>>2]&32|0)&&Go(pt,qe,W)|0,(J|0)!=(pt|0)){pt=ee,ee=qe;continue}he=ee+1|0,J=ie[he>>0]|0,le=(J<<24>>24)+-48|0,le>>>0<10?(ei=(ie[ee+2>>0]|0)==36,he=ei?ee+3|0:he,J=ie[he>>0]|0,Qe=ei?le:-1,q=ei?1:q):Qe=-1,ee=J<<24>>24;t:do if((ee&-32|0)==32)for(le=0;;){if(!(1<<ee+-32&75913)){Ce=le,ee=he;break t}if(le=1<<(J<<24>>24)+-32|le,he=he+1|0,J=ie[he>>0]|0,ee=J<<24>>24,(ee&-32|0)!=32){Ce=le,ee=he;break}}else Ce=0,ee=he;while(!1);do if(J<<24>>24==42){if(le=ee+1|0,J=(ie[le>>0]|0)+-48|0,J>>>0<10&&(ie[ee+2>>0]|0)==36)F[G+(J<<2)>>2]=10,q=1,ee=ee+3|0,J=F[X+((ie[le>>0]|0)+-48<<3)>>2]|0;else{if(q){O=-1;break e}if(!Yi){rt=Ce,ee=le,q=0,ei=0;break}q=(F[j>>2]|0)+3&-4,J=F[q>>2]|0,F[j>>2]=q+4,q=0,ee=le}(J|0)<0?(rt=Ce|8192,ei=0-J|0):(rt=Ce,ei=J)}else if(le=(J<<24>>24)+-48|0,le>>>0<10){J=0;do J=(J*10|0)+le|0,ee=ee+1|0,le=(ie[ee>>0]|0)+-48|0;while(le>>>0<10);if((J|0)<0){O=-1;break e}else rt=Ce,ei=J}else rt=Ce,ei=0;while(!1);t:do if((ie[ee>>0]|0)==46){if(le=ee+1|0,J=ie[le>>0]|0,J<<24>>24!=42){if(he=(J<<24>>24)+-48|0,he>>>0<10)ee=le,J=0;else{ee=le,he=0;break}for(;;)if(J=(J*10|0)+he|0,ee=ee+1|0,he=(ie[ee>>0]|0)+-48|0,he>>>0>=10){he=J;break t}}if(le=ee+2|0,J=(ie[le>>0]|0)+-48|0,J>>>0<10&&(ie[ee+3>>0]|0)==36){F[G+(J<<2)>>2]=10,ee=ee+4|0,he=F[X+((ie[le>>0]|0)+-48<<3)>>2]|0;break}if(q){O=-1;break e}Yi?(ee=(F[j>>2]|0)+3&-4,he=F[ee>>2]|0,F[j>>2]=ee+4,ee=le):(ee=le,he=0)}else he=-1;while(!1);for(De=0;;){if(J=(ie[ee>>0]|0)+-65|0,J>>>0>57){O=-1;break e}if(le=ee+1|0,J=ie[15953+(De*58|0)+J>>0]|0,Ce=J&255,(Ce+-1|0)>>>0<8)ee=le,De=Ce;else{Wn=le;break}}if(!(J<<24>>24)){O=-1;break}le=(Qe|0)>-1;do if(J<<24>>24==19)if(le){O=-1;break e}else Pn=52;else{if(le){F[G+(Qe<<2)>>2]=Ce,Bn=X+(Qe<<3)|0,Gn=F[Bn+4>>2]|0,Pn=no,F[Pn>>2]=F[Bn>>2],F[Pn+4>>2]=Gn,Pn=52;break}if(!Yi){O=0;break e}Vd(no,Ce,j)}while(!1);if((Pn|0)==52&&(Pn=0,!Yi)){pt=Wn,ee=qe;continue}Qe=ie[ee>>0]|0,Qe=(De|0)!=0&(Qe&15|0)==3?Qe&-33:Qe,le=rt&-65537,Gn=rt&8192|0?le:rt;t:do switch(Qe|0){case 110:switch(De|0){case 0:{F[F[no>>2]>>2]=O,pt=Wn,ee=qe;continue e}case 1:{F[F[no>>2]>>2]=O,pt=Wn,ee=qe;continue e}case 2:{pt=F[no>>2]|0,F[pt>>2]=O,F[pt+4>>2]=((O|0)<0)<<31>>31,pt=Wn,ee=qe;continue e}case 3:{ne[F[no>>2]>>1]=O,pt=Wn,ee=qe;continue e}case 4:{ie[F[no>>2]>>0]=O,pt=Wn,ee=qe;continue e}case 6:{F[F[no>>2]>>2]=O,pt=Wn,ee=qe;continue e}case 7:{pt=F[no>>2]|0,F[pt>>2]=O,F[pt+4>>2]=((O|0)<0)<<31>>31,pt=Wn,ee=qe;continue e}default:{pt=Wn,ee=qe;continue e}}case 112:{De=Gn|8,he=he>>>0>8?he:8,Qe=120,Pn=64;break}case 88:case 120:{De=Gn,Pn=64;break}case 111:{if(le=no,J=F[le>>2]|0,le=F[le+4>>2]|0,(J|0)==0&(le|0)==0)ee=mi;else{ee=mi;do ee=ee+-1|0,ie[ee>>0]=J&7|48,J=nc(J|0,le|0,3)|0,le=_t;while(!((J|0)==0&(le|0)==0))}Gn&8?(De=jr-ee+1|0,J=Gn,he=(he|0)<(De|0)?De:he,De=0,Ce=16433,Pn=77):(J=Gn,De=0,Ce=16433,Pn=77);break}case 105:case 100:{if(J=no,ee=F[J>>2]|0,J=F[J+4>>2]|0,(J|0)<0){ee=o0(0,0,ee|0,J|0)|0,J=_t,le=no,F[le>>2]=ee,F[le+4>>2]=J,le=1,Ce=16433,Pn=76;break t}Gn&2048?(le=1,Ce=16434,Pn=76):(Ce=Gn&1,le=Ce,Ce=Ce|0?16435:16433,Pn=76);break}case 117:{J=no,ee=F[J>>2]|0,J=F[J+4>>2]|0,le=0,Ce=16433,Pn=76;break}case 99:{ie[wr>>0]=F[no>>2],pt=wr,J=1,De=0,Qe=16433,ee=mi;break}case 109:{ee=aa(F[(Is()|0)>>2]|0)|0,Pn=82;break}case 115:{ee=F[no>>2]|0,ee=ee|0?ee:16443,Pn=82;break}case 67:{F[Qf>>2]=F[no>>2],F[ks>>2]=0,F[no>>2]=Qf,he=-1,Pn=86;break}case 83:{he?Pn=86:(ra(W,32,ei,0,Gn),ee=0,Pn=98);break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{ce=+se[no>>3],F[ol>>2]=0,se[Re>>3]=ce,(F[Re+4>>2]|0)>=0?Gn&2048?(Qt=1,Bn=16453):(Bn=Gn&1,Qt=Bn,Bn=Bn|0?16456:16451):(ce=-ce,Qt=1,Bn=16450),se[Re>>3]=ce,Ye=F[Re+4>>2]&2146435072;do if(Ye>>>0<2146435072|(Ye|0)==2146435072&!1){if(We=+el(ce,ol)*2,J=We!=0,J&&(F[ol>>2]=(F[ol>>2]|0)+-1),At=Qe|32,(At|0)==97){pt=Qe&32,qe=pt|0?Bn+9|0:Bn,rt=Qt|2,ee=12-he|0;do if(he>>>0>11|(ee|0)==0)ce=We;else{ce=8;do ee=ee+-1|0,ce=ce*16;while(ee|0);if((ie[qe>>0]|0)==45){ce=-(ce+(-We-ce));break}else{ce=We+ce-ce;break}}while(!1);for(J=F[ol>>2]|0,ee=(J|0)<0?0-J|0:J,ee=vc(ee,((ee|0)<0)<<31>>31,ho)|0,(ee|0)==(ho|0)&&(ie[zs>>0]=48,ee=zs),ie[ee+-1>>0]=(J>>31&2)+43,De=ee+-2|0,ie[De>>0]=Qe+15,Ce=(he|0)<1,le=(Gn&8|0)==0,J=ic;;){Bn=~~ce,ee=J+1|0,ie[J>>0]=fe[16417+Bn>>0]|pt,ce=(ce-+(Bn|0))*16;do if((ee-Fi|0)==1){if(le&(Ce&ce==0))break;ie[ee>>0]=46,ee=J+2|0}while(!1);if(ce==0)break;J=ee}he=(he|0)!=0&(Gi+ee|0)<(he|0)?tr+he-De|0:Cr-De+ee|0,le=he+rt|0,ra(W,32,ei,le,Gn),F[W>>2]&32||Go(qe,rt,W)|0,ra(W,48,ei,le,Gn^65536),ee=ee-Fi|0,F[W>>2]&32||Go(ic,ee,W)|0,J=ar-De|0,ra(W,48,he-(ee+J)|0,0,0),F[W>>2]&32||Go(De,J,W)|0,ra(W,32,ei,le,Gn^8192),ee=(le|0)<(ei|0)?ei:le;break}ee=(he|0)<0?6:he,J?(J=(F[ol>>2]|0)+-28|0,F[ol>>2]=J,ce=We*268435456):(ce=We,J=F[ol>>2]|0),Ye=(J|0)<0?ms:Di,je=Ye,J=Ye;do Et=~~ce>>>0,F[J>>2]=Et,J=J+4|0,ce=(ce-+(Et>>>0))*1e9;while(ce!=0);if(le=J,J=F[ol>>2]|0,(J|0)>0)for(Ce=Ye;;){De=(J|0)>29?29:J,he=le+-4|0;do if(he>>>0<Ce>>>0)he=Ce;else{J=0;do Et=Bo(F[he>>2]|0,0,De|0)|0,Et=Bs(Et|0,_t|0,J|0,0)|0,J=_t,lt=g1(Et|0,J|0,1e9,0)|0,F[he>>2]=lt,J=Gc(Et|0,J|0,1e9,0)|0,he=he+-4|0;while(he>>>0>=Ce>>>0);if(!J){he=Ce;break}he=Ce+-4|0,F[he>>2]=J}while(!1);for(;!(le>>>0<=he>>>0);)if(J=le+-4|0,!(F[J>>2]|0))le=J;else break;if(J=(F[ol>>2]|0)-De|0,F[ol>>2]=J,(J|0)>0)Ce=he;else break}else he=Ye;if((J|0)<0)for(qe=((ee+25|0)/9|0)+1|0,Je=(At|0)==102,pt=he;;){rt=0-J|0,rt=(rt|0)>9?9:rt;do if(pt>>>0<le>>>0){J=(1<<rt)+-1|0,Ce=1e9>>>rt,he=0,De=pt;do Et=F[De>>2]|0,F[De>>2]=(Et>>>rt)+he,he=kt(Et&J,Ce)|0,De=De+4|0;while(De>>>0<le>>>0);if(J=F[pt>>2]|0?pt:pt+4|0,!he){he=J;break}F[le>>2]=he,he=J,le=le+4|0}else he=F[pt>>2]|0?pt:pt+4|0;while(!1);if(J=Je?Ye:he,le=(le-J>>2|0)>(qe|0)?J+(qe<<2)|0:le,J=(F[ol>>2]|0)+rt|0,F[ol>>2]=J,(J|0)>=0){pt=he;break}else pt=he}else pt=he;do if(pt>>>0<le>>>0){if(J=(je-pt>>2)*9|0,Ce=F[pt>>2]|0,Ce>>>0<10)break;he=10;do he=he*10|0,J=J+1|0;while(Ce>>>0>=he>>>0)}else J=0;while(!1);if(lt=(At|0)==103,Et=(ee|0)!=0,he=ee-((At|0)!=102?J:0)+((Et&lt)<<31>>31)|0,(he|0)<(((le-je>>2)*9|0)+-9|0)){if(De=he+9216|0,Je=(De|0)/9|0,he=Ye+(Je+-1023<<2)|0,De=((De|0)%9|0)+1|0,(De|0)<9){Ce=10;do Ce=Ce*10|0,De=De+1|0;while((De|0)!=9)}else Ce=10;rt=F[he>>2]|0,qe=(rt>>>0)%(Ce>>>0)|0,!(qe|0)&&(Ye+(Je+-1022<<2)|0)==(le|0)?Ce=pt:Pn=163;do if((Pn|0)==163){Pn=0,We=((rt>>>0)/(Ce>>>0)|0)&1|0?9007199254740994:9007199254740992,De=(Ce|0)/2|0;do if(qe>>>0<De>>>0)ce=.5;else{if((qe|0)==(De|0)&&(Ye+(Je+-1022<<2)|0)==(le|0)){ce=1;break}ce=1.5}while(!1);do if(Qt){if((ie[Bn>>0]|0)!=45)break;We=-We,ce=-ce}while(!1);if(De=rt-qe|0,F[he>>2]=De,We+ce==We){Ce=pt;break}if(At=De+Ce|0,F[he>>2]=At,At>>>0>999999999)for(J=pt;;)if(Ce=he+-4|0,F[he>>2]=0,Ce>>>0<J>>>0&&(J=J+-4|0,F[J>>2]=0),At=(F[Ce>>2]|0)+1|0,F[Ce>>2]=At,At>>>0>999999999)he=Ce;else{pt=J,he=Ce;break}if(J=(je-pt>>2)*9|0,De=F[pt>>2]|0,De>>>0<10){Ce=pt;break}else Ce=10;do Ce=Ce*10|0,J=J+1|0;while(De>>>0>=Ce>>>0);Ce=pt}while(!1);At=he+4|0,pt=Ce,le=le>>>0>At>>>0?At:le}for(qe=0-J|0;;){if(le>>>0<=pt>>>0){Je=0,At=le;break}if(he=le+-4|0,!(F[he>>2]|0))le=he;else{Je=1,At=le;break}}do if(lt){if(ee=(Et&1^1)+ee|0,(ee|0)>(J|0)&(J|0)>-5?(Qe=Qe+-1|0,ee=ee+-1-J|0):(Qe=Qe+-2|0,ee=ee+-1|0),le=Gn&8,le)break;do if(Je){if(le=F[At+-4>>2]|0,!le){he=9;break}if(!((le>>>0)%10|0))Ce=10,he=0;else{he=0;break}do Ce=Ce*10|0,he=he+1|0;while(!((le>>>0)%(Ce>>>0)|0|0))}else he=9;while(!1);if(le=((At-je>>2)*9|0)+-9|0,(Qe|32|0)==102){le=le-he|0,le=(le|0)<0?0:le,ee=(ee|0)<(le|0)?ee:le,le=0;break}else{le=le+J-he|0,le=(le|0)<0?0:le,ee=(ee|0)<(le|0)?ee:le,le=0;break}}else le=Gn&8;while(!1);if(rt=ee|le,Ce=(rt|0)!=0&1,De=(Qe|32|0)==102,De)J=(J|0)>0?J:0,Qe=0;else{if(he=(J|0)<0?qe:J,he=vc(he,((he|0)<0)<<31>>31,ho)|0,(ar-he|0)<2)do he=he+-1|0,ie[he>>0]=48;while((ar-he|0)<2);ie[he+-1>>0]=(J>>31&2)+43,je=he+-2|0,ie[je>>0]=Qe,J=ar-je|0,Qe=je}qe=Qt+1+ee+Ce+J|0,ra(W,32,ei,qe,Gn),F[W>>2]&32||Go(Bn,Qt,W)|0,ra(W,48,ei,qe,Gn^65536);do if(De){he=pt>>>0>Ye>>>0?Ye:pt,J=he;do{le=vc(F[J>>2]|0,0,wn)|0;do if((J|0)==(he|0)){if((le|0)!=(wn|0))break;ie[Rn>>0]=48,le=Rn}else{if(le>>>0<=ic>>>0)break;do le=le+-1|0,ie[le>>0]=48;while(le>>>0>ic>>>0)}while(!1);F[W>>2]&32||Go(le,ci-le|0,W)|0,J=J+4|0}while(J>>>0<=Ye>>>0);do if(rt){if(F[W>>2]&32)break;Go(16485,1,W)|0}while(!1);if((ee|0)>0&J>>>0<At>>>0)for(le=J;;){if(J=vc(F[le>>2]|0,0,wn)|0,J>>>0>ic>>>0)do J=J+-1|0,ie[J>>0]=48;while(J>>>0>ic>>>0);if(F[W>>2]&32||Go(J,(ee|0)>9?9:ee,W)|0,le=le+4|0,J=ee+-9|0,(ee|0)>9&le>>>0<At>>>0)ee=J;else{ee=J;break}}ra(W,48,ee+9|0,9,0)}else{if(De=Je?At:pt+4|0,(ee|0)>-1){Ce=(le|0)==0,he=pt;do{J=vc(F[he>>2]|0,0,wn)|0,(J|0)==(wn|0)&&(ie[Rn>>0]=48,J=Rn);do if((he|0)==(pt|0)){if(le=J+1|0,F[W>>2]&32||Go(J,1,W)|0,Ce&(ee|0)<1){J=le;break}if(F[W>>2]&32){J=le;break}Go(16485,1,W)|0,J=le}else{if(J>>>0<=ic>>>0)break;do J=J+-1|0,ie[J>>0]=48;while(J>>>0>ic>>>0)}while(!1);le=ci-J|0,F[W>>2]&32||Go(J,(ee|0)>(le|0)?le:ee,W)|0,ee=ee-le|0,he=he+4|0}while(he>>>0<De>>>0&(ee|0)>-1)}if(ra(W,48,ee+18|0,18,0),F[W>>2]&32)break;Go(Qe,ar-Qe|0,W)|0}while(!1);ra(W,32,ei,qe,Gn^8192),ee=(qe|0)<(ei|0)?ei:qe}else De=(Qe&32|0)!=0,Ce=ce!=ce|!1,J=Ce?0:Qt,he=J+3|0,ra(W,32,ei,he,le),ee=F[W>>2]|0,ee&32||(Go(Bn,J,W)|0,ee=F[W>>2]|0),ee&32||Go(Ce?De?16477:16481:De?16469:16473,3,W)|0,ra(W,32,ei,he,Gn^8192),ee=(he|0)<(ei|0)?ei:he;while(!1);pt=Wn;continue e}default:le=Gn,J=he,De=0,Qe=16433,ee=mi}while(!1);t:do if((Pn|0)==64)if(le=no,J=F[le>>2]|0,le=F[le+4>>2]|0,Ce=Qe&32,(J|0)==0&(le|0)==0)ee=mi,J=De,De=0,Ce=16433,Pn=77;else{ee=mi;do ee=ee+-1|0,ie[ee>>0]=fe[16417+(J&15)>>0]|Ce,J=nc(J|0,le|0,4)|0,le=_t;while(!((J|0)==0&(le|0)==0));Pn=no,(De&8|0)==0|(F[Pn>>2]|0)==0&(F[Pn+4>>2]|0)==0?(J=De,De=0,Ce=16433,Pn=77):(J=De,De=2,Ce=16433+(Qe>>4)|0,Pn=77)}else if((Pn|0)==76)ee=vc(ee,J,mi)|0,J=Gn,De=le,Pn=77;else if((Pn|0)==82)Pn=0,Gn=qa(ee,0,he)|0,Bn=(Gn|0)==0,pt=ee,J=Bn?he:Gn-ee|0,De=0,Qe=16433,ee=Bn?ee+he|0:Gn;else if((Pn|0)==86){for(Pn=0,J=0,ee=0,Ce=F[no>>2]|0;le=F[Ce>>2]|0,!(!le||(ee=Zc(Gf,le)|0,(ee|0)<0|ee>>>0>(he-J|0)>>>0));)if(J=ee+J|0,he>>>0>J>>>0)Ce=Ce+4|0;else break;if((ee|0)<0){O=-1;break e}if(ra(W,32,ei,J,Gn),!J)ee=0,Pn=98;else for(le=0,he=F[no>>2]|0;;){if(ee=F[he>>2]|0,!ee){ee=J,Pn=98;break t}if(ee=Zc(Gf,ee)|0,le=ee+le|0,(le|0)>(J|0)){ee=J,Pn=98;break t}if(F[W>>2]&32||Go(Gf,ee,W)|0,le>>>0>=J>>>0){ee=J,Pn=98;break}else he=he+4|0}}while(!1);if((Pn|0)==98){Pn=0,ra(W,32,ei,ee,Gn^8192),pt=Wn,ee=(ei|0)>(ee|0)?ei:ee;continue}(Pn|0)==77&&(Pn=0,le=(he|0)>-1?J&-65537:J,J=no,J=(F[J>>2]|0)!=0|(F[J+4>>2]|0)!=0,(he|0)!=0|J?(J=(J&1^1)+(jr-ee)|0,pt=ee,J=(he|0)>(J|0)?he:J,Qe=Ce,ee=mi):(pt=mi,J=0,Qe=Ce,ee=mi)),Ce=ee-pt|0,J=(J|0)<(Ce|0)?Ce:J,he=De+J|0,ee=(ei|0)<(he|0)?he:ei,ra(W,32,ee,he,le),F[W>>2]&32||Go(Qe,De,W)|0,ra(W,48,ee,he,le^65536),ra(W,48,J,Ce,0),F[W>>2]&32||Go(pt,Ce,W)|0,ra(W,32,ee,he,le^8192),pt=Wn}e:do if((Pn|0)==245&&!W)if(q){for(O=1;q=F[G+(O<<2)>>2]|0,!!q;)if(Vd(X+(O<<3)|0,q,j),O=O+1|0,(O|0)>=10){O=1;break e}if((O|0)<10)for(;;){if(F[G+(O<<2)>>2]|0){O=-1;break e}if(O=O+1|0,(O|0)>=10){O=1;break}}else O=1}else O=0;while(!1);return me=Hc,O|0}function _u(W,q,j){return W=W|0,q=q|0,j=j|0,jc(W,q,j)|0}function Zu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0;Qe=me,me=me+240|0,De=Qe,F[De>>2]=W;e:do if((X|0)>1)for(Ce=0-q|0,O=X,ee=W,le=W,ce=1;;){if(W=ee+Ce|0,he=O+-2|0,J=ee+(0-((F[G+(he<<2)>>2]|0)+q))|0,(dr[j&15](le,J)|0)>-1&&(dr[j&15](le,W)|0)>-1){X=ce;break e}if(X=ce+1|0,ee=De+(ce<<2)|0,(dr[j&15](J,W)|0)>-1?(F[ee>>2]=J,W=J,O=O+-1|0):(F[ee>>2]=W,O=he),(O|0)<=1)break e;ee=W,le=F[De>>2]|0,ce=X}else X=1;while(!1);yu(q,De,X),me=Qe}function Nh(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0;var J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0;pt=me,me=me+240|0,Qe=pt,le=F[X>>2]|0,X=F[X+4>>2]|0,F[Qe>>2]=W,De=0-q|0;e:do if((X|0)!=0|(le|0)!=1&&(J=W+(0-(F[ee+(G<<2)>>2]|0))|0,(dr[j&15](J,W)|0)>=1))for(O=(O|0)==0,Ce=J,ce=le,he=X,J=1;;){if(O&(G|0)>1){if(X=F[ee+(G+-2<<2)>>2]|0,(dr[j&15](W+De|0,Ce)|0)>-1){O=G,X=J,We=20;break e}if((dr[j&15](W+(0-(X+q))|0,Ce)|0)>-1){O=G,X=J,We=20;break e}}X=J+1|0,F[Qe+(J<<2)>>2]=Ce,O=ce+-1|0;do if(O){if(O&1)We=11;else{W=O,O=0;do O=O+1|0,W=W>>>1;while(!(W&1|0));O||(We=11)}if((We|0)==11){if(We=0,!he){O=64,We=16;break}if(!(he&1))W=he,O=0;else{le=0,W=ce,J=he,O=0;break}for(;;)if(J=O+1|0,W=W>>>1,W&1){W=J;break}else O=J;if(W)O=O+33|0;else{le=0,W=ce,J=he,O=0;break}}O>>>0>31?We=16:(le=O,W=ce,J=he)}else O=32,We=16;while(!1);if((We|0)==16&&(We=0,le=O+-32|0,W=he,J=0),ce=J<<32-le|W>>>le,he=J>>>le,O=O+G|0,!((he|0)!=0|(ce|0)!=1)){W=Ce,We=20;break e}if(W=Ce+(0-(F[ee+(O<<2)>>2]|0))|0,(dr[j&15](W,F[Qe>>2]|0)|0)<1){W=Ce,G=O,O=0,We=19;break}else le=Ce,G=O,O=1,Ce=W,J=X,W=le}else X=1,We=19;while(!1);(We|0)==19&&!(O|0)&&(O=G,We=20),(We|0)==20&&(yu(q,Qe,X),Zu(W,q,j,O,ee)),me=pt}function yu(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0;ee=me,me=me+256|0,X=ee;e:do if((j|0)>=2&&(O=q+(j<<2)|0,F[O>>2]=X,(W|0)!=0))for(;;){G=W>>>0>256?256:W,Ko(X|0,F[q>>2]|0,G|0)|0,X=0;do J=q+(X<<2)|0,X=X+1|0,Ko(F[J>>2]|0,F[q+(X<<2)>>2]|0,G|0)|0,F[J>>2]=(F[J>>2]|0)+G;while((X|0)!=(j|0));if((W|0)==(G|0))break e;W=W-G|0,X=F[O>>2]|0}while(!1);me=ee}function Cu(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;return X=W+20|0,G=F[X>>2]|0,W=(F[W+16>>2]|0)-G|0,W=W>>>0>j>>>0?j:W,Ko(G|0,q|0,W|0)|0,F[X>>2]=(F[X>>2]|0)+W,j|0}function Vd(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0;e:do if(q>>>0<=20)do switch(q|0){case 9:{X=(F[j>>2]|0)+3&-4,q=F[X>>2]|0,F[j>>2]=X+4,F[W>>2]=q;break e}case 10:{X=(F[j>>2]|0)+3&-4,q=F[X>>2]|0,F[j>>2]=X+4,X=W,F[X>>2]=q,F[X+4>>2]=((q|0)<0)<<31>>31;break e}case 11:{X=(F[j>>2]|0)+3&-4,q=F[X>>2]|0,F[j>>2]=X+4,X=W,F[X>>2]=q,F[X+4>>2]=0;break e}case 12:{X=(F[j>>2]|0)+7&-8,q=X,G=F[q>>2]|0,q=F[q+4>>2]|0,F[j>>2]=X+8,X=W,F[X>>2]=G,F[X+4>>2]=q;break e}case 13:{G=(F[j>>2]|0)+3&-4,X=F[G>>2]|0,F[j>>2]=G+4,X=(X&65535)<<16>>16,G=W,F[G>>2]=X,F[G+4>>2]=((X|0)<0)<<31>>31;break e}case 14:{G=(F[j>>2]|0)+3&-4,X=F[G>>2]|0,F[j>>2]=G+4,G=W,F[G>>2]=X&65535,F[G+4>>2]=0;break e}case 15:{G=(F[j>>2]|0)+3&-4,X=F[G>>2]|0,F[j>>2]=G+4,X=(X&255)<<24>>24,G=W,F[G>>2]=X,F[G+4>>2]=((X|0)<0)<<31>>31;break e}case 16:{G=(F[j>>2]|0)+3&-4,X=F[G>>2]|0,F[j>>2]=G+4,G=W,F[G>>2]=X&255,F[G+4>>2]=0;break e}case 17:{G=(F[j>>2]|0)+7&-8,O=+se[G>>3],F[j>>2]=G+8,se[W>>3]=O;break e}case 18:{G=(F[j>>2]|0)+7&-8,O=+se[G>>3],F[j>>2]=G+8,se[W>>3]=O;break e}default:break e}while(!1);while(!1)}function vc(W,q,j){W=W|0,q=q|0,j=j|0;var X=0;if(q>>>0>0|(q|0)==0&W>>>0>4294967295)for(;;)if(X=g1(W|0,q|0,10,0)|0,j=j+-1|0,ie[j>>0]=X|48,X=Gc(W|0,q|0,10,0)|0,q>>>0>9|(q|0)==9&W>>>0>4294967295)W=X,q=_t;else{W=X;break}if(W)for(;j=j+-1|0,ie[j>>0]=(W>>>0)%10|0|48,!(W>>>0<10);)W=(W>>>0)/10|0;return j|0}function ra(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0;J=me,me=me+256|0,ee=J;do if((j|0)>(X|0)&(G&73728|0)==0){if(G=j-X|0,ii(ee|0,q|0,(G>>>0>256?256:G)|0)|0,q=F[W>>2]|0,O=(q&32|0)==0,G>>>0>255){X=j-X|0;do O&&(Go(ee,256,W)|0,q=F[W>>2]|0),G=G+-256|0,O=(q&32|0)==0;while(G>>>0>255);if(O)G=X&255;else break}else if(!O)break;Go(ee,G,W)|0}while(!1);me=J}function $i(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0;do if(W>>>0<245){if(Qe=W>>>0<11?16:W+11&-8,W=Qe>>>3,J=F[756]|0,j=J>>>W,j&3){W=(j&1^1)+W|0,X=W<<1,j=3064+(X<<2)|0,X=3064+(X+2<<2)|0,G=F[X>>2]|0,O=G+8|0,ee=F[O>>2]|0;do if((j|0)!=(ee|0))if(ee>>>0<(F[760]|0)>>>0&&Ai(),q=ee+12|0,(F[q>>2]|0)==(G|0)){F[q>>2]=j,F[X>>2]=ee;break}else Ai();else F[756]=J&~(1<<W);while(!1);return Rn=W<<3,F[G+4>>2]=Rn|3,Rn=G+(Rn|4)|0,F[Rn>>2]=F[Rn>>2]|1,Rn=O,Rn|0}if(ee=F[758]|0,Qe>>>0>ee>>>0){if(j){X=2<<W,X=j<<W&(X|0-X),X=(X&0-X)+-1|0,le=X>>>12&16,X=X>>>le,G=X>>>5&8,X=X>>>G,O=X>>>2&4,X=X>>>O,j=X>>>1&2,X=X>>>j,W=X>>>1&1,W=(G|le|O|j|W)+(X>>>W)|0,X=W<<1,j=3064+(X<<2)|0,X=3064+(X+2<<2)|0,O=F[X>>2]|0,le=O+8|0,G=F[le>>2]|0;do if((j|0)!=(G|0))if(G>>>0<(F[760]|0)>>>0&&Ai(),q=G+12|0,(F[q>>2]|0)==(O|0)){F[q>>2]=j,F[X>>2]=G,ce=F[758]|0;break}else Ai();else F[756]=J&~(1<<W),ce=ee;while(!1);return Rn=W<<3,ee=Rn-Qe|0,F[O+4>>2]=Qe|3,J=O+Qe|0,F[O+(Qe|4)>>2]=ee|1,F[O+Rn>>2]=ee,ce&&(G=F[761]|0,j=ce>>>3,q=j<<1,X=3064+(q<<2)|0,W=F[756]|0,j=1<<j,W&j?(W=3064+(q+2<<2)|0,q=F[W>>2]|0,q>>>0<(F[760]|0)>>>0?Ai():(he=W,Ce=q)):(F[756]=W|j,he=3064+(q+2<<2)|0,Ce=X),F[he>>2]=G,F[Ce+12>>2]=G,F[G+8>>2]=Ce,F[G+12>>2]=X),F[758]=ee,F[761]=J,Rn=le,Rn|0}if(W=F[757]|0,W){for(j=(W&0-W)+-1|0,ci=j>>>12&16,j=j>>>ci,wn=j>>>5&8,j=j>>>wn,Rn=j>>>2&4,j=j>>>Rn,W=j>>>1&2,j=j>>>W,X=j>>>1&1,X=F[3328+((wn|ci|Rn|W|X)+(j>>>X)<<2)>>2]|0,j=(F[X+4>>2]&-8)-Qe|0,W=X;;){if(q=F[W+16>>2]|0,!q&&(q=F[W+20>>2]|0,!q)){le=j;break}W=(F[q+4>>2]&-8)-Qe|0,Rn=W>>>0<j>>>0,j=Rn?W:j,W=q,X=Rn?q:X}O=F[760]|0,X>>>0<O>>>0&&Ai(),J=X+Qe|0,X>>>0>=J>>>0&&Ai(),ee=F[X+24>>2]|0,j=F[X+12>>2]|0;do if((j|0)==(X|0)){if(W=X+20|0,q=F[W>>2]|0,!q&&(W=X+16|0,q=F[W>>2]|0,!q)){De=0;break}for(;;){if(j=q+20|0,G=F[j>>2]|0,G){q=G,W=j;continue}if(j=q+16|0,G=F[j>>2]|0,G)q=G,W=j;else break}if(W>>>0<O>>>0)Ai();else{F[W>>2]=0,De=q;break}}else if(G=F[X+8>>2]|0,G>>>0<O>>>0&&Ai(),q=G+12|0,(F[q>>2]|0)!=(X|0)&&Ai(),W=j+8|0,(F[W>>2]|0)==(X|0)){F[q>>2]=j,F[W>>2]=G,De=j;break}else Ai();while(!1);do if(ee){if(q=F[X+28>>2]|0,W=3328+(q<<2)|0,(X|0)==(F[W>>2]|0)){if(F[W>>2]=De,!De){F[757]=F[757]&~(1<<q);break}}else if(ee>>>0<(F[760]|0)>>>0&&Ai(),q=ee+16|0,(F[q>>2]|0)==(X|0)?F[q>>2]=De:F[ee+20>>2]=De,!De)break;W=F[760]|0,De>>>0<W>>>0&&Ai(),F[De+24>>2]=ee,q=F[X+16>>2]|0;do if(q)if(q>>>0<W>>>0)Ai();else{F[De+16>>2]=q,F[q+24>>2]=De;break}while(!1);if(q=F[X+20>>2]|0,q)if(q>>>0<(F[760]|0)>>>0)Ai();else{F[De+20>>2]=q,F[q+24>>2]=De;break}}while(!1);return le>>>0<16?(Rn=le+Qe|0,F[X+4>>2]=Rn|3,Rn=X+(Rn+4)|0,F[Rn>>2]=F[Rn>>2]|1):(F[X+4>>2]=Qe|3,F[X+(Qe|4)>>2]=le|1,F[X+(le+Qe)>>2]=le,q=F[758]|0,q&&(O=F[761]|0,j=q>>>3,q=j<<1,G=3064+(q<<2)|0,W=F[756]|0,j=1<<j,W&j?(q=3064+(q+2<<2)|0,W=F[q>>2]|0,W>>>0<(F[760]|0)>>>0?Ai():(We=q,pt=W)):(F[756]=W|j,We=3064+(q+2<<2)|0,pt=G),F[We>>2]=O,F[pt+12>>2]=O,F[O+8>>2]=pt,F[O+12>>2]=G),F[758]=le,F[761]=J),Rn=X+8|0,Rn|0}else pt=Qe}else pt=Qe}else if(W>>>0<=4294967231)if(W=W+11|0,Ce=W&-8,he=F[757]|0,he){j=0-Ce|0,W=W>>>8,W?Ce>>>0>16777215?ce=31:(pt=(W+1048320|0)>>>16&8,Et=W<<pt,We=(Et+520192|0)>>>16&4,Et=Et<<We,ce=(Et+245760|0)>>>16&2,ce=14-(We|pt|ce)+(Et<<ce>>>15)|0,ce=Ce>>>(ce+7|0)&1|ce<<1):ce=0,W=F[3328+(ce<<2)>>2]|0;e:do if(!W)G=0,W=0,Et=86;else for(ee=j,G=0,J=Ce<<((ce|0)==31?0:25-(ce>>>1)|0),le=W,W=0;;){if(O=F[le+4>>2]&-8,j=O-Ce|0,j>>>0<ee>>>0)if((O|0)==(Ce|0)){O=le,W=le,Et=90;break e}else W=le;else j=ee;if(Et=F[le+20>>2]|0,le=F[le+16+(J>>>31<<2)>>2]|0,G=(Et|0)==0|(Et|0)==(le|0)?G:Et,le)ee=j,J=J<<1;else{Et=86;break}}while(!1);if((Et|0)==86){if((G|0)==0&(W|0)==0){if(W=2<<ce,W=he&(W|0-W),!W){pt=Ce;break}W=(W&0-W)+-1|0,De=W>>>12&16,W=W>>>De,he=W>>>5&8,W=W>>>he,We=W>>>2&4,W=W>>>We,pt=W>>>1&2,W=W>>>pt,G=W>>>1&1,G=F[3328+((he|De|We|pt|G)+(W>>>G)<<2)>>2]|0,W=0}G?(O=G,Et=90):(J=j,le=W)}if((Et|0)==90)for(;;){if(Et=0,pt=(F[O+4>>2]&-8)-Ce|0,G=pt>>>0<j>>>0,j=G?pt:j,W=G?O:W,G=F[O+16>>2]|0,G){O=G,Et=90;continue}if(O=F[O+20>>2]|0,O)Et=90;else{J=j,le=W;break}}if(le|0&&J>>>0<((F[758]|0)-Ce|0)>>>0){G=F[760]|0,le>>>0<G>>>0&&Ai(),ee=le+Ce|0,le>>>0>=ee>>>0&&Ai(),O=F[le+24>>2]|0,j=F[le+12>>2]|0;do if((j|0)==(le|0)){if(W=le+20|0,q=F[W>>2]|0,!q&&(W=le+16|0,q=F[W>>2]|0,!q)){Qe=0;break}for(;;){if(j=q+20|0,X=F[j>>2]|0,X){q=X,W=j;continue}if(j=q+16|0,X=F[j>>2]|0,X)q=X,W=j;else break}if(W>>>0<G>>>0)Ai();else{F[W>>2]=0,Qe=q;break}}else if(X=F[le+8>>2]|0,X>>>0<G>>>0&&Ai(),q=X+12|0,(F[q>>2]|0)!=(le|0)&&Ai(),W=j+8|0,(F[W>>2]|0)==(le|0)){F[q>>2]=j,F[W>>2]=X,Qe=j;break}else Ai();while(!1);do if(O){if(q=F[le+28>>2]|0,W=3328+(q<<2)|0,(le|0)==(F[W>>2]|0)){if(F[W>>2]=Qe,!Qe){F[757]=F[757]&~(1<<q);break}}else if(O>>>0<(F[760]|0)>>>0&&Ai(),q=O+16|0,(F[q>>2]|0)==(le|0)?F[q>>2]=Qe:F[O+20>>2]=Qe,!Qe)break;W=F[760]|0,Qe>>>0<W>>>0&&Ai(),F[Qe+24>>2]=O,q=F[le+16>>2]|0;do if(q)if(q>>>0<W>>>0)Ai();else{F[Qe+16>>2]=q,F[q+24>>2]=Qe;break}while(!1);if(q=F[le+20>>2]|0,q)if(q>>>0<(F[760]|0)>>>0)Ai();else{F[Qe+20>>2]=q,F[q+24>>2]=Qe;break}}while(!1);e:do if(J>>>0>=16){if(F[le+4>>2]=Ce|3,F[le+(Ce|4)>>2]=J|1,F[le+(J+Ce)>>2]=J,q=J>>>3,J>>>0<256){W=q<<1,X=3064+(W<<2)|0,j=F[756]|0,q=1<<q,j&q?(q=3064+(W+2<<2)|0,W=F[q>>2]|0,W>>>0<(F[760]|0)>>>0?Ai():(qe=q,Je=W)):(F[756]=j|q,qe=3064+(W+2<<2)|0,Je=X),F[qe>>2]=ee,F[Je+12>>2]=ee,F[le+(Ce+8)>>2]=Je,F[le+(Ce+12)>>2]=X;break}if(q=J>>>8,q?J>>>0>16777215?X=31:(ci=(q+1048320|0)>>>16&8,Rn=q<<ci,wn=(Rn+520192|0)>>>16&4,Rn=Rn<<wn,X=(Rn+245760|0)>>>16&2,X=14-(wn|ci|X)+(Rn<<X>>>15)|0,X=J>>>(X+7|0)&1|X<<1):X=0,q=3328+(X<<2)|0,F[le+(Ce+28)>>2]=X,F[le+(Ce+20)>>2]=0,F[le+(Ce+16)>>2]=0,W=F[757]|0,j=1<<X,!(W&j)){F[757]=W|j,F[q>>2]=ee,F[le+(Ce+24)>>2]=q,F[le+(Ce+12)>>2]=ee,F[le+(Ce+8)>>2]=ee;break}q=F[q>>2]|0;t:do if((F[q+4>>2]&-8|0)!=(J|0)){for(X=J<<((X|0)==31?0:25-(X>>>1)|0);W=q+16+(X>>>31<<2)|0,j=F[W>>2]|0,!!j;)if((F[j+4>>2]&-8|0)==(J|0)){Ye=j;break t}else X=X<<1,q=j;if(W>>>0<(F[760]|0)>>>0)Ai();else{F[W>>2]=ee,F[le+(Ce+24)>>2]=q,F[le+(Ce+12)>>2]=ee,F[le+(Ce+8)>>2]=ee;break e}}else Ye=q;while(!1);if(q=Ye+8|0,W=F[q>>2]|0,Rn=F[760]|0,W>>>0>=Rn>>>0&Ye>>>0>=Rn>>>0){F[W+12>>2]=ee,F[q>>2]=ee,F[le+(Ce+8)>>2]=W,F[le+(Ce+12)>>2]=Ye,F[le+(Ce+24)>>2]=0;break}else Ai()}else Rn=J+Ce|0,F[le+4>>2]=Rn|3,Rn=le+(Rn+4)|0,F[Rn>>2]=F[Rn>>2]|1;while(!1);return Rn=le+8|0,Rn|0}else pt=Ce}else pt=Ce;else pt=-1;while(!1);if(j=F[758]|0,j>>>0>=pt>>>0)return q=j-pt|0,W=F[761]|0,q>>>0>15?(F[761]=W+pt,F[758]=q,F[W+(pt+4)>>2]=q|1,F[W+j>>2]=q,F[W+4>>2]=pt|3):(F[758]=0,F[761]=0,F[W+4>>2]=j|3,Rn=W+(j+4)|0,F[Rn>>2]=F[Rn>>2]|1),Rn=W+8|0,Rn|0;if(W=F[759]|0,W>>>0>pt>>>0)return ci=W-pt|0,F[759]=ci,Rn=F[762]|0,F[762]=Rn+pt,F[Rn+(pt+4)>>2]=ci|1,F[Rn+4>>2]=pt|3,Rn=Rn+8|0,Rn|0;do if(!(F[874]|0))if(W=Wi(30)|0,W+-1&W)Ai();else{F[876]=W,F[875]=W,F[877]=-1,F[878]=-1,F[879]=0,F[867]=0,F[874]=(As(0)|0)&-16^1431655768;break}while(!1);if(le=pt+48|0,J=F[876]|0,ce=pt+47|0,ee=J+ce|0,J=0-J|0,he=ee&J,he>>>0<=pt>>>0||(W=F[866]|0,W|0&&(Je=F[864]|0,Ye=Je+he|0,Ye>>>0<=Je>>>0|Ye>>>0>W>>>0)))return Rn=0,Rn|0;e:do if(F[867]&4)W=0,Et=191;else{W=F[762]|0;t:do if(W){for(G=3472;;){if(j=F[G>>2]|0,j>>>0<=W>>>0&&(rt=G+4|0,(j+(F[rt>>2]|0)|0)>>>0>W>>>0)){O=G,W=rt;break}if(G=F[G+8>>2]|0,!G){Et=174;break t}}if(j=ee-(F[759]|0)&J,j>>>0<2147483647)if(G=$t(j|0)|0,Ye=(G|0)==((F[O>>2]|0)+(F[W>>2]|0)|0),W=Ye?j:0,Ye){if((G|0)!=-1){At=G,We=W,Et=194;break e}}else Et=184;else W=0}else Et=174;while(!1);do if((Et|0)==174)if(O=$t(0)|0,(O|0)!=-1)if(W=O,j=F[875]|0,G=j+-1|0,G&W?j=he-W+(G+W&0-j)|0:j=he,W=F[864]|0,G=W+j|0,j>>>0>pt>>>0&j>>>0<2147483647){if(Ye=F[866]|0,Ye|0&&G>>>0<=W>>>0|G>>>0>Ye>>>0){W=0;break}if(G=$t(j|0)|0,Ye=(G|0)==(O|0),W=Ye?j:0,Ye){At=O,We=W,Et=194;break e}else Et=184}else W=0;else W=0;while(!1);t:do if((Et|0)==184){O=0-j|0;do if(le>>>0>j>>>0&(j>>>0<2147483647&(G|0)!=-1)&&(lt=F[876]|0,lt=ce-j+lt&0-lt,lt>>>0<2147483647))if(($t(lt|0)|0)==-1){$t(O|0)|0;break t}else{j=lt+j|0;break}while(!1);if((G|0)!=-1){At=G,We=j,Et=194;break e}}while(!1);F[867]=F[867]|4,Et=191}while(!1);if((Et|0)==191&&he>>>0<2147483647&&(At=$t(he|0)|0,je=$t(0)|0,At>>>0<je>>>0&((At|0)!=-1&(je|0)!=-1))&&(Qt=je-At|0,Bn=Qt>>>0>(pt+40|0)>>>0,Bn)&&(We=Bn?Qt:W,Et=194),(Et|0)==194){W=(F[864]|0)+We|0,F[864]=W,W>>>0>(F[865]|0)>>>0&&(F[865]=W),ee=F[762]|0;e:do if(ee){O=3472;do{if(W=F[O>>2]|0,j=O+4|0,G=F[j>>2]|0,(At|0)==(W+G|0)){Gn=W,Wn=j,ei=G,Pn=O,Et=204;break}O=F[O+8>>2]|0}while(O|0);if((Et|0)==204&&!(F[Pn+12>>2]&8|0)&&ee>>>0<At>>>0&ee>>>0>=Gn>>>0){F[Wn>>2]=ei+We,Rn=(F[759]|0)+We|0,ci=ee+8|0,ci=ci&7|0?0-ci&7:0,wn=Rn-ci|0,F[762]=ee+ci,F[759]=wn,F[ee+(ci+4)>>2]=wn|1,F[ee+(Rn+4)>>2]=40,F[763]=F[878];break}for(W=F[760]|0,At>>>0<W>>>0&&(F[760]=At,W=At),j=At+We|0,O=3472;;){if((F[O>>2]|0)==(j|0)){G=O,j=O,Et=212;break}if(O=F[O+8>>2]|0,!O){j=3472;break}}if((Et|0)==212)if(F[j+12>>2]&8)j=3472;else{F[G>>2]=At,De=j+4|0,F[De>>2]=(F[De>>2]|0)+We,De=At+8|0,De=De&7|0?0-De&7:0,ce=At+(We+8)|0,ce=ce&7|0?0-ce&7:0,q=At+(ce+We)|0,Ce=De+pt|0,Qe=At+Ce|0,he=q-(At+De)-pt|0,F[At+(De+4)>>2]=pt|3;t:do if((q|0)!=(ee|0)){if((q|0)==(F[761]|0)){Rn=(F[758]|0)+he|0,F[758]=Rn,F[761]=Qe,F[At+(Ce+4)>>2]=Rn|1,F[At+(Rn+Ce)>>2]=Rn;break}if(J=We+4|0,j=F[At+(J+ce)>>2]|0,(j&3|0)==1){le=j&-8,O=j>>>3;n:do if(j>>>0>=256){ee=F[At+((ce|24)+We)>>2]|0,X=F[At+(We+12+ce)>>2]|0;do if((X|0)==(q|0)){if(G=ce|16,X=At+(J+G)|0,j=F[X>>2]|0,!j&&(X=At+(G+We)|0,j=F[X>>2]|0,!j)){Di=0;break}for(;;){if(G=j+20|0,O=F[G>>2]|0,O){j=O,X=G;continue}if(G=j+16|0,O=F[G>>2]|0,O)j=O,X=G;else break}if(X>>>0<W>>>0)Ai();else{F[X>>2]=0,Di=j;break}}else if(G=F[At+((ce|8)+We)>>2]|0,G>>>0<W>>>0&&Ai(),W=G+12|0,(F[W>>2]|0)!=(q|0)&&Ai(),j=X+8|0,(F[j>>2]|0)==(q|0)){F[W>>2]=X,F[j>>2]=G,Di=X;break}else Ai();while(!1);if(!ee)break;W=F[At+(We+28+ce)>>2]|0,j=3328+(W<<2)|0;do if((q|0)!=(F[j>>2]|0)){if(ee>>>0<(F[760]|0)>>>0&&Ai(),W=ee+16|0,(F[W>>2]|0)==(q|0)?F[W>>2]=Di:F[ee+20>>2]=Di,!Di)break n}else{if(F[j>>2]=Di,Di)break;F[757]=F[757]&~(1<<W);break n}while(!1);j=F[760]|0,Di>>>0<j>>>0&&Ai(),F[Di+24>>2]=ee,q=ce|16,W=F[At+(q+We)>>2]|0;do if(W)if(W>>>0<j>>>0)Ai();else{F[Di+16>>2]=W,F[W+24>>2]=Di;break}while(!1);if(q=F[At+(J+q)>>2]|0,!q)break;if(q>>>0<(F[760]|0)>>>0)Ai();else{F[Di+20>>2]=q,F[q+24>>2]=Di;break}}else{X=F[At+((ce|8)+We)>>2]|0,G=F[At+(We+12+ce)>>2]|0,j=3064+(O<<1<<2)|0;do if((X|0)!=(j|0)){if(X>>>0<W>>>0&&Ai(),(F[X+12>>2]|0)==(q|0))break;Ai()}while(!1);if((G|0)==(X|0)){F[756]=F[756]&~(1<<O);break}do if((G|0)==(j|0))Yi=G+8|0;else{if(G>>>0<W>>>0&&Ai(),W=G+8|0,(F[W>>2]|0)==(q|0)){Yi=W;break}Ai()}while(!1);F[X+12>>2]=G,F[Yi>>2]=X}while(!1);q=At+((le|ce)+We)|0,G=le+he|0}else G=he;if(q=q+4|0,F[q>>2]=F[q>>2]&-2,F[At+(Ce+4)>>2]=G|1,F[At+(G+Ce)>>2]=G,q=G>>>3,G>>>0<256){W=q<<1,X=3064+(W<<2)|0,j=F[756]|0,q=1<<q;do if(!(j&q))F[756]=j|q,wn=3064+(W+2<<2)|0,ci=X;else{if(q=3064+(W+2<<2)|0,W=F[q>>2]|0,W>>>0>=(F[760]|0)>>>0){wn=q,ci=W;break}Ai()}while(!1);F[wn>>2]=Qe,F[ci+12>>2]=Qe,F[At+(Ce+8)>>2]=ci,F[At+(Ce+12)>>2]=X;break}q=G>>>8;do if(!q)X=0;else{if(G>>>0>16777215){X=31;break}wn=(q+1048320|0)>>>16&8,ci=q<<wn,Di=(ci+520192|0)>>>16&4,ci=ci<<Di,X=(ci+245760|0)>>>16&2,X=14-(Di|wn|X)+(ci<<X>>>15)|0,X=G>>>(X+7|0)&1|X<<1}while(!1);if(q=3328+(X<<2)|0,F[At+(Ce+28)>>2]=X,F[At+(Ce+20)>>2]=0,F[At+(Ce+16)>>2]=0,W=F[757]|0,j=1<<X,!(W&j)){F[757]=W|j,F[q>>2]=Qe,F[At+(Ce+24)>>2]=q,F[At+(Ce+12)>>2]=Qe,F[At+(Ce+8)>>2]=Qe;break}q=F[q>>2]|0;n:do if((F[q+4>>2]&-8|0)!=(G|0)){for(X=G<<((X|0)==31?0:25-(X>>>1)|0);W=q+16+(X>>>31<<2)|0,j=F[W>>2]|0,!!j;)if((F[j+4>>2]&-8|0)==(G|0)){Rn=j;break n}else X=X<<1,q=j;if(W>>>0<(F[760]|0)>>>0)Ai();else{F[W>>2]=Qe,F[At+(Ce+24)>>2]=q,F[At+(Ce+12)>>2]=Qe,F[At+(Ce+8)>>2]=Qe;break t}}else Rn=q;while(!1);if(q=Rn+8|0,W=F[q>>2]|0,ci=F[760]|0,W>>>0>=ci>>>0&Rn>>>0>=ci>>>0){F[W+12>>2]=Qe,F[q>>2]=Qe,F[At+(Ce+8)>>2]=W,F[At+(Ce+12)>>2]=Rn,F[At+(Ce+24)>>2]=0;break}else Ai()}else Rn=(F[759]|0)+he|0,F[759]=Rn,F[762]=Qe,F[At+(Ce+4)>>2]=Rn|1;while(!1);return Rn=At+(De|8)|0,Rn|0}for(;W=F[j>>2]|0,!(W>>>0<=ee>>>0&&(q=F[j+4>>2]|0,X=W+q|0,X>>>0>ee>>>0));)j=F[j+8>>2]|0;if(G=W+(q+-39)|0,W=W+(q+-47+(G&7|0?0-G&7:0))|0,G=ee+16|0,W=W>>>0<G>>>0?ee:W,q=W+8|0,j=At+8|0,j=j&7|0?0-j&7:0,Rn=We+-40-j|0,F[762]=At+j,F[759]=Rn,F[At+(j+4)>>2]=Rn|1,F[At+(We+-36)>>2]=40,F[763]=F[878],j=W+4|0,F[j>>2]=27,F[q>>2]=F[868],F[q+4>>2]=F[869],F[q+8>>2]=F[870],F[q+12>>2]=F[871],F[868]=At,F[869]=We,F[871]=0,F[870]=q,q=W+28|0,F[q>>2]=7,(W+32|0)>>>0<X>>>0)do Rn=q,q=q+4|0,F[q>>2]=7;while((Rn+8|0)>>>0<X>>>0);if((W|0)!=(ee|0)){if(O=W-ee|0,F[j>>2]=F[j>>2]&-2,F[ee+4>>2]=O|1,F[W>>2]=O,q=O>>>3,O>>>0<256){W=q<<1,X=3064+(W<<2)|0,j=F[756]|0,q=1<<q,j&q?(q=3064+(W+2<<2)|0,W=F[q>>2]|0,W>>>0<(F[760]|0)>>>0?Ai():(mi=q,Gi=W)):(F[756]=j|q,mi=3064+(W+2<<2)|0,Gi=X),F[mi>>2]=ee,F[Gi+12>>2]=ee,F[ee+8>>2]=Gi,F[ee+12>>2]=X;break}if(q=O>>>8,q?O>>>0>16777215?X=31:(ci=(q+1048320|0)>>>16&8,Rn=q<<ci,wn=(Rn+520192|0)>>>16&4,Rn=Rn<<wn,X=(Rn+245760|0)>>>16&2,X=14-(wn|ci|X)+(Rn<<X>>>15)|0,X=O>>>(X+7|0)&1|X<<1):X=0,j=3328+(X<<2)|0,F[ee+28>>2]=X,F[ee+20>>2]=0,F[G>>2]=0,q=F[757]|0,W=1<<X,!(q&W)){F[757]=q|W,F[j>>2]=ee,F[ee+24>>2]=j,F[ee+12>>2]=ee,F[ee+8>>2]=ee;break}q=F[j>>2]|0;t:do if((F[q+4>>2]&-8|0)!=(O|0)){for(X=O<<((X|0)==31?0:25-(X>>>1)|0);W=q+16+(X>>>31<<2)|0,j=F[W>>2]|0,!!j;)if((F[j+4>>2]&-8|0)==(O|0)){tr=j;break t}else X=X<<1,q=j;if(W>>>0<(F[760]|0)>>>0)Ai();else{F[W>>2]=ee,F[ee+24>>2]=q,F[ee+12>>2]=ee,F[ee+8>>2]=ee;break e}}else tr=q;while(!1);if(q=tr+8|0,W=F[q>>2]|0,Rn=F[760]|0,W>>>0>=Rn>>>0&tr>>>0>=Rn>>>0){F[W+12>>2]=ee,F[q>>2]=ee,F[ee+8>>2]=W,F[ee+12>>2]=tr,F[ee+24>>2]=0;break}else Ai()}}else{Rn=F[760]|0,(Rn|0)==0|At>>>0<Rn>>>0&&(F[760]=At),F[868]=At,F[869]=We,F[871]=0,F[765]=F[874],F[764]=-1,q=0;do Rn=q<<1,ci=3064+(Rn<<2)|0,F[3064+(Rn+3<<2)>>2]=ci,F[3064+(Rn+2<<2)>>2]=ci,q=q+1|0;while((q|0)!=32);Rn=At+8|0,Rn=Rn&7|0?0-Rn&7:0,ci=We+-40-Rn|0,F[762]=At+Rn,F[759]=ci,F[At+(Rn+4)>>2]=ci|1,F[At+(We+-36)>>2]=40,F[763]=F[878]}while(!1);if(q=F[759]|0,q>>>0>pt>>>0)return ci=q-pt|0,F[759]=ci,Rn=F[762]|0,F[762]=Rn+pt,F[Rn+(pt+4)>>2]=ci|1,F[Rn+4>>2]=pt|3,Rn=Rn+8|0,Rn|0}return F[(Is()|0)>>2]=12,Rn=0,Rn|0}function Mr(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0;if(W){q=W+-8|0,J=F[760]|0,q>>>0<J>>>0&&Ai(),j=F[W+-4>>2]|0,X=j&3,(X|0)==1&&Ai(),Qe=j&-8,pt=W+(Qe+-8)|0;do if(j&1)lt=q,O=Qe;else{if(q=F[q>>2]|0,!X)return;if(le=-8-q|0,he=W+le|0,Ce=q+Qe|0,he>>>0<J>>>0&&Ai(),(he|0)==(F[761]|0)){if(q=W+(Qe+-4)|0,j=F[q>>2]|0,(j&3|0)!=3){lt=he,O=Ce;break}F[758]=Ce,F[q>>2]=j&-2,F[W+(le+4)>>2]=Ce|1,F[pt>>2]=Ce;return}if(G=q>>>3,q>>>0<256){if(X=F[W+(le+8)>>2]|0,j=F[W+(le+12)>>2]|0,q=3064+(G<<1<<2)|0,(X|0)!=(q|0)&&(X>>>0<J>>>0&&Ai(),(F[X+12>>2]|0)!=(he|0)&&Ai()),(j|0)==(X|0)){F[756]=F[756]&~(1<<G),lt=he,O=Ce;break}(j|0)!=(q|0)?(j>>>0<J>>>0&&Ai(),q=j+8|0,(F[q>>2]|0)==(he|0)?ee=q:Ai()):ee=j+8|0,F[X+12>>2]=j,F[ee>>2]=X,lt=he,O=Ce;break}ee=F[W+(le+24)>>2]|0,X=F[W+(le+12)>>2]|0;do if((X|0)==(he|0)){if(j=W+(le+20)|0,q=F[j>>2]|0,!q&&(j=W+(le+16)|0,q=F[j>>2]|0,!q)){ce=0;break}for(;;){if(X=q+20|0,G=F[X>>2]|0,G){q=G,j=X;continue}if(X=q+16|0,G=F[X>>2]|0,G)q=G,j=X;else break}if(j>>>0<J>>>0)Ai();else{F[j>>2]=0,ce=q;break}}else if(G=F[W+(le+8)>>2]|0,G>>>0<J>>>0&&Ai(),q=G+12|0,(F[q>>2]|0)!=(he|0)&&Ai(),j=X+8|0,(F[j>>2]|0)==(he|0)){F[q>>2]=X,F[j>>2]=G,ce=X;break}else Ai();while(!1);if(ee){if(q=F[W+(le+28)>>2]|0,j=3328+(q<<2)|0,(he|0)==(F[j>>2]|0)){if(F[j>>2]=ce,!ce){F[757]=F[757]&~(1<<q),lt=he,O=Ce;break}}else if(ee>>>0<(F[760]|0)>>>0&&Ai(),q=ee+16|0,(F[q>>2]|0)==(he|0)?F[q>>2]=ce:F[ee+20>>2]=ce,!ce){lt=he,O=Ce;break}j=F[760]|0,ce>>>0<j>>>0&&Ai(),F[ce+24>>2]=ee,q=F[W+(le+16)>>2]|0;do if(q)if(q>>>0<j>>>0)Ai();else{F[ce+16>>2]=q,F[q+24>>2]=ce;break}while(!1);if(q=F[W+(le+20)>>2]|0,q)if(q>>>0<(F[760]|0)>>>0)Ai();else{F[ce+20>>2]=q,F[q+24>>2]=ce,lt=he,O=Ce;break}else lt=he,O=Ce}else lt=he,O=Ce}while(!1);if(lt>>>0>=pt>>>0&&Ai(),q=W+(Qe+-4)|0,j=F[q>>2]|0,j&1||Ai(),j&2)F[q>>2]=j&-2,F[lt+4>>2]=O|1,F[lt+O>>2]=O;else{if((pt|0)==(F[762]|0)){if(Je=(F[759]|0)+O|0,F[759]=Je,F[762]=lt,F[lt+4>>2]=Je|1,(lt|0)!=(F[761]|0))return;F[761]=0,F[758]=0;return}if((pt|0)==(F[761]|0)){Je=(F[758]|0)+O|0,F[758]=Je,F[761]=lt,F[lt+4>>2]=Je|1,F[lt+Je>>2]=Je;return}O=(j&-8)+O|0,G=j>>>3;do if(j>>>0>=256){ee=F[W+(Qe+16)>>2]|0,q=F[W+(Qe|4)>>2]|0;do if((q|0)==(pt|0)){if(j=W+(Qe+12)|0,q=F[j>>2]|0,!q&&(j=W+(Qe+8)|0,q=F[j>>2]|0,!q)){We=0;break}for(;;){if(X=q+20|0,G=F[X>>2]|0,G){q=G,j=X;continue}if(X=q+16|0,G=F[X>>2]|0,G)q=G,j=X;else break}if(j>>>0<(F[760]|0)>>>0)Ai();else{F[j>>2]=0,We=q;break}}else if(j=F[W+Qe>>2]|0,j>>>0<(F[760]|0)>>>0&&Ai(),X=j+12|0,(F[X>>2]|0)!=(pt|0)&&Ai(),G=q+8|0,(F[G>>2]|0)==(pt|0)){F[X>>2]=q,F[G>>2]=j,We=q;break}else Ai();while(!1);if(ee){if(q=F[W+(Qe+20)>>2]|0,j=3328+(q<<2)|0,(pt|0)==(F[j>>2]|0)){if(F[j>>2]=We,!We){F[757]=F[757]&~(1<<q);break}}else if(ee>>>0<(F[760]|0)>>>0&&Ai(),q=ee+16|0,(F[q>>2]|0)==(pt|0)?F[q>>2]=We:F[ee+20>>2]=We,!We)break;j=F[760]|0,We>>>0<j>>>0&&Ai(),F[We+24>>2]=ee,q=F[W+(Qe+8)>>2]|0;do if(q)if(q>>>0<j>>>0)Ai();else{F[We+16>>2]=q,F[q+24>>2]=We;break}while(!1);if(q=F[W+(Qe+12)>>2]|0,q)if(q>>>0<(F[760]|0)>>>0)Ai();else{F[We+20>>2]=q,F[q+24>>2]=We;break}}}else{if(X=F[W+Qe>>2]|0,j=F[W+(Qe|4)>>2]|0,q=3064+(G<<1<<2)|0,(X|0)!=(q|0)&&(X>>>0<(F[760]|0)>>>0&&Ai(),(F[X+12>>2]|0)!=(pt|0)&&Ai()),(j|0)==(X|0)){F[756]=F[756]&~(1<<G);break}(j|0)!=(q|0)?(j>>>0<(F[760]|0)>>>0&&Ai(),q=j+8|0,(F[q>>2]|0)==(pt|0)?De=q:Ai()):De=j+8|0,F[X+12>>2]=j,F[De>>2]=X}while(!1);if(F[lt+4>>2]=O|1,F[lt+O>>2]=O,(lt|0)==(F[761]|0)){F[758]=O;return}}if(q=O>>>3,O>>>0<256){j=q<<1,G=3064+(j<<2)|0,X=F[756]|0,q=1<<q,X&q?(q=3064+(j+2<<2)|0,j=F[q>>2]|0,j>>>0<(F[760]|0)>>>0?Ai():(rt=q,qe=j)):(F[756]=X|q,rt=3064+(j+2<<2)|0,qe=G),F[rt>>2]=lt,F[qe+12>>2]=lt,F[lt+8>>2]=qe,F[lt+12>>2]=G;return}q=O>>>8,q?O>>>0>16777215?G=31:(rt=(q+1048320|0)>>>16&8,qe=q<<rt,pt=(qe+520192|0)>>>16&4,qe=qe<<pt,G=(qe+245760|0)>>>16&2,G=14-(pt|rt|G)+(qe<<G>>>15)|0,G=O>>>(G+7|0)&1|G<<1):G=0,q=3328+(G<<2)|0,F[lt+28>>2]=G,F[lt+20>>2]=0,F[lt+16>>2]=0,j=F[757]|0,X=1<<G;e:do if(j&X){q=F[q>>2]|0;t:do if((F[q+4>>2]&-8|0)!=(O|0)){for(G=O<<((G|0)==31?0:25-(G>>>1)|0);j=q+16+(G>>>31<<2)|0,X=F[j>>2]|0,!!X;)if((F[X+4>>2]&-8|0)==(O|0)){Je=X;break t}else G=G<<1,q=X;if(j>>>0<(F[760]|0)>>>0)Ai();else{F[j>>2]=lt,F[lt+24>>2]=q,F[lt+12>>2]=lt,F[lt+8>>2]=lt;break e}}else Je=q;while(!1);if(q=Je+8|0,j=F[q>>2]|0,qe=F[760]|0,j>>>0>=qe>>>0&Je>>>0>=qe>>>0){F[j+12>>2]=lt,F[q>>2]=lt,F[lt+8>>2]=j,F[lt+12>>2]=Je,F[lt+24>>2]=0;break}else Ai()}else F[757]=j|X,F[q>>2]=lt,F[lt+24>>2]=q,F[lt+12>>2]=lt,F[lt+8>>2]=lt;while(!1);if(lt=(F[764]|0)+-1|0,F[764]=lt,!lt)q=3480;else return;for(;q=F[q>>2]|0,q;)q=q+8|0;F[764]=-1}}function f0(W,q){W=W|0,q=q|0;var j=0;return W?(j=kt(q,W)|0,(q|W)>>>0>65535&&(j=((j>>>0)/(W>>>0)|0|0)==(q|0)?j:-1)):j=0,q=$i(j)|0,!q||!(F[q+-4>>2]&3)||ii(q|0,0,j|0)|0,q|0}function zl(W,q){W=W|0,q=q|0;var j=0,X=0;return W?q>>>0>4294967231?(F[(Is()|0)>>2]=12,W=0,W|0):(j=Dc(W+-8|0,q>>>0<11?16:q+11&-8)|0,j?(W=j+8|0,W|0):(j=$i(q)|0,j?(X=F[W+-4>>2]|0,X=(X&-8)-(X&3|0?4:8)|0,Ko(j|0,W|0,(X>>>0<q>>>0?X:q)|0)|0,Mr(W),W=j,W|0):(W=0,W|0))):(W=$i(q)|0,W|0)}function Dc(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;if(Qe=W+4|0,We=F[Qe>>2]|0,le=We&-8,he=W+le|0,J=F[760]|0,j=We&3,(j|0)!=1&W>>>0>=J>>>0&W>>>0<he>>>0||Ai(),X=W+(le|4)|0,G=F[X>>2]|0,G&1||Ai(),!j)return q>>>0<256?(W=0,W|0):(le>>>0>=(q+4|0)>>>0&&(le-q|0)>>>0<=F[876]<<1>>>0||(W=0),W|0);if(le>>>0>=q>>>0)return j=le-q|0,j>>>0<=15||(F[Qe>>2]=We&1|q|2,F[W+(q+4)>>2]=j|3,F[X>>2]=F[X>>2]|1,p0(W+q|0,j)),W|0;if((he|0)==(F[762]|0))return j=(F[759]|0)+le|0,j>>>0<=q>>>0?(W=0,W|0):(De=j-q|0,F[Qe>>2]=We&1|q|2,F[W+(q+4)>>2]=De|1,F[762]=W+q,F[759]=De,W|0);if((he|0)==(F[761]|0))return X=(F[758]|0)+le|0,X>>>0<q>>>0?(W=0,W|0):(j=X-q|0,j>>>0>15?(F[Qe>>2]=We&1|q|2,F[W+(q+4)>>2]=j|1,F[W+X>>2]=j,X=W+(X+4)|0,F[X>>2]=F[X>>2]&-2,X=W+q|0):(F[Qe>>2]=We&1|X|2,X=W+(X+4)|0,F[X>>2]=F[X>>2]|1,X=0,j=0),F[758]=j,F[761]=X,W|0);if(G&2||(Ce=(G&-8)+le|0,Ce>>>0<q>>>0))return W=0,W|0;De=Ce-q|0,O=G>>>3;do if(G>>>0>=256){ee=F[W+(le+24)>>2]|0,O=F[W+(le+12)>>2]|0;do if((O|0)==(he|0)){if(X=W+(le+20)|0,j=F[X>>2]|0,!j&&(X=W+(le+16)|0,j=F[X>>2]|0,!j)){ce=0;break}for(;;){if(G=j+20|0,O=F[G>>2]|0,O){j=O,X=G;continue}if(G=j+16|0,O=F[G>>2]|0,O)j=O,X=G;else break}if(X>>>0<J>>>0)Ai();else{F[X>>2]=0,ce=j;break}}else if(G=F[W+(le+8)>>2]|0,G>>>0<J>>>0&&Ai(),j=G+12|0,(F[j>>2]|0)!=(he|0)&&Ai(),X=O+8|0,(F[X>>2]|0)==(he|0)){F[j>>2]=O,F[X>>2]=G,ce=O;break}else Ai();while(!1);if(ee){if(j=F[W+(le+28)>>2]|0,X=3328+(j<<2)|0,(he|0)==(F[X>>2]|0)){if(F[X>>2]=ce,!ce){F[757]=F[757]&~(1<<j);break}}else if(ee>>>0<(F[760]|0)>>>0&&Ai(),j=ee+16|0,(F[j>>2]|0)==(he|0)?F[j>>2]=ce:F[ee+20>>2]=ce,!ce)break;X=F[760]|0,ce>>>0<X>>>0&&Ai(),F[ce+24>>2]=ee,j=F[W+(le+16)>>2]|0;do if(j)if(j>>>0<X>>>0)Ai();else{F[ce+16>>2]=j,F[j+24>>2]=ce;break}while(!1);if(j=F[W+(le+20)>>2]|0,j)if(j>>>0<(F[760]|0)>>>0)Ai();else{F[ce+20>>2]=j,F[j+24>>2]=ce;break}}}else{if(G=F[W+(le+8)>>2]|0,X=F[W+(le+12)>>2]|0,j=3064+(O<<1<<2)|0,(G|0)!=(j|0)&&(G>>>0<J>>>0&&Ai(),(F[G+12>>2]|0)!=(he|0)&&Ai()),(X|0)==(G|0)){F[756]=F[756]&~(1<<O);break}(X|0)!=(j|0)?(X>>>0<J>>>0&&Ai(),j=X+8|0,(F[j>>2]|0)==(he|0)?ee=j:Ai()):ee=X+8|0,F[G+12>>2]=X,F[ee>>2]=G}while(!1);return De>>>0<16?(F[Qe>>2]=Ce|We&1|2,q=W+(Ce|4)|0,F[q>>2]=F[q>>2]|1,W|0):(F[Qe>>2]=We&1|q|2,F[W+(q+4)>>2]=De|3,We=W+(Ce|4)|0,F[We>>2]=F[We>>2]|1,p0(W+q|0,De),W|0)}function p0(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0;pt=W+q|0,j=F[W+4>>2]|0;do if(j&1)Je=W,ee=q;else{if(ce=F[W>>2]|0,!(j&3))return;if(De=W+(0-ce)|0,Ce=ce+q|0,le=F[760]|0,De>>>0<le>>>0&&Ai(),(De|0)==(F[761]|0)){if(X=W+(q+4)|0,j=F[X>>2]|0,(j&3|0)!=3){Je=De,ee=Ce;break}F[758]=Ce,F[X>>2]=j&-2,F[W+(4-ce)>>2]=Ce|1,F[pt>>2]=Ce;return}if(O=ce>>>3,ce>>>0<256){if(G=F[W+(8-ce)>>2]|0,X=F[W+(12-ce)>>2]|0,j=3064+(O<<1<<2)|0,(G|0)!=(j|0)&&(G>>>0<le>>>0&&Ai(),(F[G+12>>2]|0)!=(De|0)&&Ai()),(X|0)==(G|0)){F[756]=F[756]&~(1<<O),Je=De,ee=Ce;break}(X|0)!=(j|0)?(X>>>0<le>>>0&&Ai(),j=X+8|0,(F[j>>2]|0)==(De|0)?J=j:Ai()):J=X+8|0,F[G+12>>2]=X,F[J>>2]=G,Je=De,ee=Ce;break}J=F[W+(24-ce)>>2]|0,G=F[W+(12-ce)>>2]|0;do if((G|0)==(De|0)){if(G=16-ce|0,X=W+(G+4)|0,j=F[X>>2]|0,!j&&(X=W+G|0,j=F[X>>2]|0,!j)){he=0;break}for(;;){if(G=j+20|0,O=F[G>>2]|0,O){j=O,X=G;continue}if(G=j+16|0,O=F[G>>2]|0,O)j=O,X=G;else break}if(X>>>0<le>>>0)Ai();else{F[X>>2]=0,he=j;break}}else if(O=F[W+(8-ce)>>2]|0,O>>>0<le>>>0&&Ai(),j=O+12|0,(F[j>>2]|0)!=(De|0)&&Ai(),X=G+8|0,(F[X>>2]|0)==(De|0)){F[j>>2]=G,F[X>>2]=O,he=G;break}else Ai();while(!1);if(J){if(j=F[W+(28-ce)>>2]|0,X=3328+(j<<2)|0,(De|0)==(F[X>>2]|0)){if(F[X>>2]=he,!he){F[757]=F[757]&~(1<<j),Je=De,ee=Ce;break}}else if(J>>>0<(F[760]|0)>>>0&&Ai(),j=J+16|0,(F[j>>2]|0)==(De|0)?F[j>>2]=he:F[J+20>>2]=he,!he){Je=De,ee=Ce;break}G=F[760]|0,he>>>0<G>>>0&&Ai(),F[he+24>>2]=J,j=16-ce|0,X=F[W+j>>2]|0;do if(X)if(X>>>0<G>>>0)Ai();else{F[he+16>>2]=X,F[X+24>>2]=he;break}while(!1);if(j=F[W+(j+4)>>2]|0,j)if(j>>>0<(F[760]|0)>>>0)Ai();else{F[he+20>>2]=j,F[j+24>>2]=he,Je=De,ee=Ce;break}else Je=De,ee=Ce}else Je=De,ee=Ce}while(!1);if(le=F[760]|0,pt>>>0<le>>>0&&Ai(),j=W+(q+4)|0,X=F[j>>2]|0,X&2)F[j>>2]=X&-2,F[Je+4>>2]=ee|1,F[Je+ee>>2]=ee;else{if((pt|0)==(F[762]|0)){if(qe=(F[759]|0)+ee|0,F[759]=qe,F[762]=Je,F[Je+4>>2]=qe|1,(Je|0)!=(F[761]|0))return;F[761]=0,F[758]=0;return}if((pt|0)==(F[761]|0)){qe=(F[758]|0)+ee|0,F[758]=qe,F[761]=Je,F[Je+4>>2]=qe|1,F[Je+qe>>2]=qe;return}ee=(X&-8)+ee|0,O=X>>>3;do if(X>>>0>=256){J=F[W+(q+24)>>2]|0,G=F[W+(q+12)>>2]|0;do if((G|0)==(pt|0)){if(X=W+(q+20)|0,j=F[X>>2]|0,!j&&(X=W+(q+16)|0,j=F[X>>2]|0,!j)){We=0;break}for(;;){if(G=j+20|0,O=F[G>>2]|0,O){j=O,X=G;continue}if(G=j+16|0,O=F[G>>2]|0,O)j=O,X=G;else break}if(X>>>0<le>>>0)Ai();else{F[X>>2]=0,We=j;break}}else if(O=F[W+(q+8)>>2]|0,O>>>0<le>>>0&&Ai(),j=O+12|0,(F[j>>2]|0)!=(pt|0)&&Ai(),X=G+8|0,(F[X>>2]|0)==(pt|0)){F[j>>2]=G,F[X>>2]=O,We=G;break}else Ai();while(!1);if(J){if(j=F[W+(q+28)>>2]|0,X=3328+(j<<2)|0,(pt|0)==(F[X>>2]|0)){if(F[X>>2]=We,!We){F[757]=F[757]&~(1<<j);break}}else if(J>>>0<(F[760]|0)>>>0&&Ai(),j=J+16|0,(F[j>>2]|0)==(pt|0)?F[j>>2]=We:F[J+20>>2]=We,!We)break;X=F[760]|0,We>>>0<X>>>0&&Ai(),F[We+24>>2]=J,j=F[W+(q+16)>>2]|0;do if(j)if(j>>>0<X>>>0)Ai();else{F[We+16>>2]=j,F[j+24>>2]=We;break}while(!1);if(j=F[W+(q+20)>>2]|0,j)if(j>>>0<(F[760]|0)>>>0)Ai();else{F[We+20>>2]=j,F[j+24>>2]=We;break}}}else{if(G=F[W+(q+8)>>2]|0,X=F[W+(q+12)>>2]|0,j=3064+(O<<1<<2)|0,(G|0)!=(j|0)&&(G>>>0<le>>>0&&Ai(),(F[G+12>>2]|0)!=(pt|0)&&Ai()),(X|0)==(G|0)){F[756]=F[756]&~(1<<O);break}(X|0)!=(j|0)?(X>>>0<le>>>0&&Ai(),j=X+8|0,(F[j>>2]|0)==(pt|0)?Qe=j:Ai()):Qe=X+8|0,F[G+12>>2]=X,F[Qe>>2]=G}while(!1);if(F[Je+4>>2]=ee|1,F[Je+ee>>2]=ee,(Je|0)==(F[761]|0)){F[758]=ee;return}}if(j=ee>>>3,ee>>>0<256){X=j<<1,O=3064+(X<<2)|0,G=F[756]|0,j=1<<j,G&j?(j=3064+(X+2<<2)|0,X=F[j>>2]|0,X>>>0<(F[760]|0)>>>0?Ai():(rt=j,qe=X)):(F[756]=G|j,rt=3064+(X+2<<2)|0,qe=O),F[rt>>2]=Je,F[qe+12>>2]=Je,F[Je+8>>2]=qe,F[Je+12>>2]=O;return}if(j=ee>>>8,j?ee>>>0>16777215?O=31:(rt=(j+1048320|0)>>>16&8,qe=j<<rt,pt=(qe+520192|0)>>>16&4,qe=qe<<pt,O=(qe+245760|0)>>>16&2,O=14-(pt|rt|O)+(qe<<O>>>15)|0,O=ee>>>(O+7|0)&1|O<<1):O=0,j=3328+(O<<2)|0,F[Je+28>>2]=O,F[Je+20>>2]=0,F[Je+16>>2]=0,X=F[757]|0,G=1<<O,!(X&G)){F[757]=X|G,F[j>>2]=Je,F[Je+24>>2]=j,F[Je+12>>2]=Je,F[Je+8>>2]=Je;return}j=F[j>>2]|0;e:do if((F[j+4>>2]&-8|0)!=(ee|0)){for(O=ee<<((O|0)==31?0:25-(O>>>1)|0);X=j+16+(O>>>31<<2)|0,G=F[X>>2]|0,!!G;)if((F[G+4>>2]&-8|0)==(ee|0)){j=G;break e}else O=O<<1,j=G;X>>>0<(F[760]|0)>>>0&&Ai(),F[X>>2]=Je,F[Je+24>>2]=j,F[Je+12>>2]=Je,F[Je+8>>2]=Je;return}while(!1);X=j+8|0,G=F[X>>2]|0,qe=F[760]|0,G>>>0>=qe>>>0&j>>>0>=qe>>>0||Ai(),F[G+12>>2]=Je,F[X>>2]=Je,F[Je+8>>2]=G,F[Je+12>>2]=j,F[Je+24>>2]=0}function Wl(W,q,j,X,G,O,ee,J,le,ce,he,Ce){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0,J=J|0,le=le|0,ce=ce|0,he=+he,Ce=Ce|0;var De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0,jr=0,wr=0,ks=0,ho=0,zs=0,Fi=0,ar=0,Cr=0;if(wr=me,me=me+240|0,qe=wr+224|0,rt=wr+216|0,je=wr+208|0,At=wr+200|0,De=wr+136|0,tr=wr+72|0,wn=wr,ci=wr+232|0,Rn=wr+228|0,se[De>>3]=100,se[De+8>>3]=100,se[De+16>>3]=110,se[De+24>>3]=100,se[De+32>>3]=110,se[De+40>>3]=110,se[De+48>>3]=100,se[De+56>>3]=110,se[tr>>3]=+se[ce>>3],se[tr+8>>3]=+se[ce+8>>3],se[tr+16>>3]=+se[ce+16>>3],se[tr+24>>3]=+se[ce+24>>3],se[tr+32>>3]=+se[ce+32>>3],se[tr+40>>3]=+se[ce+40>>3],se[tr+48>>3]=+se[ce+48>>3],se[tr+56>>3]=+se[ce+56>>3],$0(De,tr,wn),Et=+se[tr>>3],ho=+se[tr+16>>3],Je=Et-ho,Pn=+se[tr+8>>3],ks=+se[tr+24>>3],We=Pn-ks,De=~~(Je*Je+We*We),We=+se[tr+32>>3],Je=+se[tr+48>>3],Fi=We-Je,pt=+se[tr+40>>3],lt=+se[tr+56>>3],zs=pt-lt,tr=~~(Fi*Fi+zs*zs),We=ho-We,pt=ks-pt,Qe=~~(We*We+pt*pt),Et=Je-Et,Pn=lt-Pn,Di=~~(Et*Et+Pn*Pn),De=~~(+(((tr|0)>(De|0)?tr:De)|0)*he*he),Qe=~~(+(((Di|0)>(Qe|0)?Di:Qe)|0)*he*he),W){for(ce=j;(ce|0)<(X|0)&(kt(ce<<2,ce)|0)<(De|0);)ce=ce<<1;for(De=j;(De|0)<(X|0)&(kt(De<<2,De)|0)<(Qe|0);)De=De<<1}else{for(ce=j;(ce|0)<(X|0)&(kt(ce,ce)|0)<(De|0);)ce=ce<<1;for(De=j;(De|0)<(X|0)&(kt(De,De)|0)<(Qe|0);)De=De<<1}Di=(ce|0)>(X|0)?X:ce,Gi=(De|0)>(X|0)?X:De,mi=(Di|0)/(j|0)|0,Yi=(Gi|0)/(j|0)|0,We=(1-he)*.5*10,Pn=he*10,tr=kt(j,j)|0;e:do if(q){ce=f0(tr,4)|0,ce||(Jn(3,5472,rt),zt(1));t:do if(J>>>0<2){if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=((kt(Qe,O)|0)+De|0)*3|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+((((fe[G+(ar+1)>>0]|0)+(fe[G+ar>>0]|0)+(fe[G+(ar+2)>>0]|0)|0)>>>0)/3|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}}else{if((J&-2|0)==2){if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break;for(q=(Di|0)>0,qe=0;;){if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<2,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+((((fe[G+(ar|1)>>0]|0)+(fe[G+ar>>0]|0)+(fe[G+(ar|2)>>0]|0)|0)>>>0)/3|0)),rt=rt+1|0}while((rt|0)<(Di|0))}if(qe=qe+1|0,(qe|0)>=(Gi|0))break t}}if((J&-3|0)==4){if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break;for(q=(Di|0)>0,qe=0;;){if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<2,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+((((fe[G+(ar|2)>>0]|0)+(fe[G+(ar|1)>>0]|0)+(fe[G+(ar|3)>>0]|0)|0)>>>0)/3|0)),rt=rt+1|0}while((rt|0)<(Di|0))}if(qe=qe+1|0,(qe|0)>=(Gi|0))break t}}switch(J|0){case 5:case 12:case 13:case 14:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break t;q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=fe[G+((kt(Qe,O)|0)+De)>>0]|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+ar),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0));break}case 7:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break t;q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=fe[G+((kt(Qe,O)|0)+De<<1|1)>>0]|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+ar),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0));break}case 8:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break t;q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=fe[G+((kt(Qe,O)|0)+De<<1)>>0]|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+ar),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0));break}case 9:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break t;q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<1,ei=fe[G+ar>>0]|0,ar=fe[G+(ar|1)>>0]|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+((((ar<<3&248|4)+(ei&248|4)+(ei<<5&224|ar>>>3&28|2)|0)>>>0)/3|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0));break}case 10:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break t;q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<1,ei=fe[G+ar>>0]|0,ar=fe[G+(ar|1)>>0]|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+((((ar<<2&248|4)+(ei&248|4)+(ei<<5&224|ar>>>3&24|4)|0)>>>0)/3|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0));break}case 11:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)<=0)break t;q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<1,ei=fe[G+ar>>0]|0,Cr=ce+((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)<<2)|0,F[Cr>>2]=(F[Cr>>2]|0)+((((ei<<4&240|8)+(ei&240|8)+((fe[G+(ar|1)>>0]|0)&240|8)|0)>>>0)/3|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0));break}default:{Jn(3,4615,qe),jr=278;break e}}}while(!1);if(De=kt(Yi,mi)|0,tr){Qe=0;do ie[Ce+Qe>>0]=((F[ce+(Qe<<2)>>2]|0)>>>0)/(De>>>0)|0,Qe=Qe+1|0;while((Qe|0)<(tr|0))}Mr(ce),ce=0}else{ei=tr*3|0,ce=f0(ei,4)|0,ce||(Jn(3,5472,At),zt(1));do switch(J|0){case 0:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=((kt(Qe,O)|0)+De|0)*3|0,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe+2)>>0]|0),De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe+1)>>0]|0),W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+(fe[G+Qe>>0]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 1:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=((kt(Qe,O)|0)+De|0)*3|0,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+Qe>>0]|0),De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe+1)>>0]|0),W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+(fe[G+(Qe+2)>>0]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 2:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=(kt(Qe,O)|0)+De<<2,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|2)>>0]|0),De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|1)>>0]|0),W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+(fe[G+Qe>>0]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 3:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=(kt(Qe,O)|0)+De<<2,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+Qe>>0]|0),De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|1)>>0]|0),W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+(fe[G+(Qe|2)>>0]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 4:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=(kt(Qe,O)|0)+De<<2,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|1)>>0]|0),De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|2)>>0]|0),W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+(fe[G+(Qe|3)>>0]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 5:case 12:case 13:case 14:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=fe[G+((kt(Qe,O)|0)+De)>>0]|0,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+Qe,De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+Qe,W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+Qe),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 6:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=(kt(Qe,O)|0)+De<<2,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|3)>>0]|0),De=ce+(W+1<<2)|0,F[De>>2]=(F[De>>2]|0)+(fe[G+(Qe|2)>>0]|0),W=ce+(W+2<<2)|0,F[W>>2]=(F[W>>2]|0)+(fe[G+(Qe|1)>>0]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 7:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Cr=kt(Qe,O)|0,ar=(De&65534)+Cr<<1,ho=+((fe[G+ar>>0]|0)+-128|0),Fi=+((fe[G+(ar+2)>>0]|0)+-128|0),zs=+((fe[G+(Cr+De<<1|1)>>0]|0)+-16|0)*298.0820007324219,Cr=~~(ho*516.4110107421875+zs)>>8,ar=~~(zs-ho*100.29100036621094-Fi*208.1199951171875)>>8,Qe=~~(zs+Fi*408.5830078125)>>8,Cr=(Cr|0)>0?Cr:0,W=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,De=ce+(W<<2)|0,F[De>>2]=((Cr|0)<255?Cr:255)+(F[De>>2]|0),ar=(ar|0)>0?ar:0,De=ce+(W+1<<2)|0,F[De>>2]=((ar|0)<255?ar:255)+(F[De>>2]|0),Qe=(Qe|0)>0?Qe:0,W=ce+(W+2<<2)|0,F[W>>2]=((Qe|0)<255?Qe:255)+(F[W>>2]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 8:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(Qe=kt(Qe,O)|0,ar=(De&65534)+Qe<<1,ho=+((fe[G+(ar|1)>>0]|0)+-128|0),Fi=+((fe[G+(ar+3)>>0]|0)+-128|0),zs=+((fe[G+(Qe+De<<1)>>0]|0)+-16|0)*298.0820007324219,De=~~(zs+ho*516.4110107421875)>>8,Qe=~~(zs-ho*100.29100036621094-Fi*208.1199951171875)>>8,ar=~~(zs+Fi*408.5830078125)>>8,De=(De|0)>0?De:0,Cr=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,W=ce+(Cr<<2)|0,F[W>>2]=((De|0)<255?De:255)+(F[W>>2]|0),Qe=(Qe|0)>0?Qe:0,W=ce+(Cr+1<<2)|0,F[W>>2]=((Qe|0)<255?Qe:255)+(F[W>>2]|0),ar=(ar|0)>0?ar:0,Cr=ce+(Cr+2<<2)|0,F[Cr>>2]=((ar|0)<255?ar:255)+(F[Cr>>2]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 9:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<1,Qe=fe[G+(ar|1)>>0]|0,Cr=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,W=ce+(Cr<<2)|0,F[W>>2]=(Qe<<3&248|4)+(F[W>>2]|0),ar=fe[G+ar>>0]|0,W=ce+(Cr+1<<2)|0,F[W>>2]=(ar<<5&224|Qe>>>3&28|2)+(F[W>>2]|0),Cr=ce+(Cr+2<<2)|0,F[Cr>>2]=(ar&248|4)+(F[Cr>>2]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 10:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<1,Qe=fe[G+(ar|1)>>0]|0,Cr=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,W=ce+(Cr<<2)|0,F[W>>2]=(Qe<<2&248|4)+(F[W>>2]|0),ar=fe[G+ar>>0]|0,W=ce+(Cr+1<<2)|0,F[W>>2]=(ar<<5&224|Qe>>>3&24|4)+(F[W>>2]|0),Cr=ce+(Cr+2<<2)|0,F[Cr>>2]=(ar&248|4)+(F[Cr>>2]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}case 11:{if(Je=We+100,lt=+(Gi|0),Et=+(Di|0),At=wn+48|0,je=wn+56|0,J=wn+64|0,Ye=wn+8|0,Qt=wn+16|0,Bn=wn+24|0,Gn=wn+32|0,Wn=wn+40|0,X=(W|0)==1,(Gi|0)>0){q=(Di|0)>0,qe=0;do{if(pt=Je+Pn*(+(qe|0)+.5)/lt,q){rt=0;do{if(We=Je+Pn*(+(rt|0)+.5)/Et,he=+se[J>>3]+(+se[At>>3]*We+pt*+se[je>>3]),he==0){jr=278;break e}Fi=(+se[Qt>>3]+(We*+se[wn>>3]+pt*+se[Ye>>3]))/he,ve[ci>>2]=Fi,We=(+se[Wn>>3]+(We*+se[Bn>>3]+pt*+se[Gn>>3]))/he,ve[Rn>>2]=We,Ks(le,Fi,We,ci,Rn)|0,We=+ve[ci>>2],X?(De=((~~(We+1)|0)/2|0)<<1,Qe=((~~(+ve[Rn>>2]+1)|0)/2|0)<<1):(De=~~(We+.5),Qe=~~(+ve[Rn>>2]+.5)),(De|0)>-1&&(Qe|0)<(ee|0)&((Qe|0)>-1&(De|0)<(O|0))&&(ar=(kt(Qe,O)|0)+De<<1,Cr=((kt((qe|0)/(Yi|0)|0,j)|0)+((rt|0)/(mi|0)|0)|0)*3|0,W=ce+(Cr<<2)|0,F[W>>2]=(F[W>>2]|0)+((fe[G+(ar|1)>>0]|0)&240|8),ar=fe[G+ar>>0]|0,W=ce+(Cr+1<<2)|0,F[W>>2]=(ar<<4&240|8)+(F[W>>2]|0),Cr=ce+(Cr+2<<2)|0,F[Cr>>2]=(ar&240|8)+(F[Cr>>2]|0)),rt=rt+1|0}while((rt|0)<(Di|0))}qe=qe+1|0}while((qe|0)<(Gi|0))}break}default:{Jn(3,4615,je),jr=278;break e}}while(!1);if(Qe=kt(Yi,mi)|0,tr){De=0;do ie[Ce+De>>0]=((F[ce+(De<<2)>>2]|0)>>>0)/(Qe>>>0)|0,De=De+1|0;while((De|0)<(ei|0))}Mr(ce),ce=0}while(!1);return(jr|0)==278&&(Mr(ce),ce=-1),me=wr,ce|0}function Sa(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0;var J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0;rt=me,me=me+32|0,he=rt+24|0,ce=rt+8|0,pt=rt;e:do if((q+-3|0)>>>0>5)F[j>>2]=-1,F[X>>2]=0,se[G>>3]=-1,J=-1;else{if(F[ce>>2]=0,We=q+-1|0,F[ce+4>>2]=kt(We,q)|0,De=kt(q,q)|0,F[ce+8>>2]=De+-1,F[ce+12>>2]=We,le=ie[W+(F[ce>>2]|0)>>0]|0,J=(le&255)>0?le:0,le=(le&255)<255?le:-1,Qe=ie[W+(F[ce+4>>2]|0)>>0]|0,J=(Qe&255)>(J&255)?Qe:J,le=(Qe&255)<(le&255)?Qe:le,Qe=ie[W+(F[ce+8>>2]|0)>>0]|0,J=(Qe&255)>(J&255)?Qe:J,le=(Qe&255)<(le&255)?Qe:le,Qe=ie[W+(F[ce+12>>2]|0)>>0]|0,J=((Qe&255)>(J&255)?Qe:J)&255,le=((Qe&255)<(le&255)?Qe:le)&255,(J-le|0)<30){F[j>>2]=-1,F[X>>2]=0,se[G>>3]=-1,J=-2;break}for(Ce=(J+le|0)>>>1,ie[he>>0]=(fe[W+(F[ce>>2]|0)>>0]|0)>>>0<Ce>>>0&1,ie[he+1>>0]=(fe[W+(F[ce+4>>2]|0)>>0]|0)>>>0<Ce>>>0&1,ie[he+2>>0]=(fe[W+(F[ce+8>>2]|0)>>0]|0)>>>0<Ce>>>0&1,ie[he+3>>0]=(fe[W+(F[ce+12>>2]|0)>>0]|0)>>>0<Ce>>>0&1,le=0;;){if(J=le+1|0,(ie[he+le>>0]|0)==1&&(ie[he+((J|0)%4|0)>>0]|0)==1&&!(ie[he+((le+2|0)%4|0)>>0]|0)){J=le,le=10;break}if((J|0)<4)le=J;else{le=12;break}}if((le|0)==10)F[X>>2]=J;else if((le|0)==12&&(J|0)==4){F[j>>2]=-1,F[X>>2]=0,se[G>>3]=-1,J=-3;break}if(!De)Qe=255;else{J=255,le=0;do Qe=W+le|0,he=fe[Qe>>0]|0,ce=he-Ce|0,ce=(ce|0)<0?0-ce|0:ce,J=(ce|0)<(J|0)?ce:J,ie[Qe>>0]=he>>>0<Ce>>>0&1,le=le+1|0;while((le|0)<(De|0));Qe=J}switch(F[X>>2]|0){case 0:{if((q|0)>0){De=(q|0)==0,le=0,J=0,X=0;do{if(he=(X|0)==(We|0),Ce=kt(X,q)|0,!De){ce=0;do ce|X|0&&!(he&((ce|0)==0|(ce|0)==(We|0)))&&(le=Bo(le|0,J|0,1)|0,le=(ie[W+(ce+Ce)>>0]|0)!=0|le,J=_t),ce=ce+1|0;while((ce|0)!=(q|0))}X=X+1|0}while((X|0)<(q|0))}else le=0,J=0;break}case 1:{if((q|0)>0){De=(q|0)>0,le=0,J=0,X=0;do{if(he=(X|0)==0,Ce=(X|0)==(We|0),De)for(ce=We;qe=(ce|0)==(We|0),!(he&qe)&&!(Ce&(qe|(ce|0)==0))&&(le=Bo(le|0,J|0,1)|0,le=(ie[W+((kt(ce,q)|0)+X)>>0]|0)!=0|le,J=_t),(ce|0)>0;)ce=ce+-1|0;X=X+1|0}while((X|0)<(q|0))}else le=0,J=0;break}case 2:{if((q|0)>0)for(De=(q|0)>0,le=0,J=0,X=We;;){if(Ce=(X|0)==(We|0)|(X|0)==0,he=kt(X,q)|0,De)for(ce=We;Ce&(ce|0)==(We|0)|(ce|X|0)==0||(le=Bo(le|0,J|0,1)|0,le=(ie[W+(ce+he)>>0]|0)!=0|le,J=_t),(ce|0)>0;)ce=ce+-1|0;if((X|0)>0)X=X+-1|0;else break}else le=0,J=0;break}case 3:{if((q|0)>0)for(De=(q|0)>0,le=0,J=0,X=We;;){if(he=(X|0)==(We|0),Ce=(X|0)==0,De){ce=0;do he&(ce|0)==0|(ce|X|0)==0|Ce&(ce|0)==(We|0)||(le=Bo(le|0,J|0,1)|0,le=(ie[W+((kt(ce,q)|0)+X)>>0]|0)!=0|le,J=_t),ce=ce+1|0;while((ce|0)<(q|0))}if((X|0)>0)X=X+-1|0;else break}else le=0,J=0;break}default:le=0,J=0}switch(se[G>>3]=(Qe|0)>30?1:+(Qe|0)/30,O|0){case 259:{if(qe=ie[4551+le>>0]|0,O=qe<<24>>24,ee=pt,F[ee>>2]=O,F[ee+4>>2]=((O|0)<0)<<31>>31,qe<<24>>24<0){F[j>>2]=-1,se[G>>3]=-1,J=-4;break e}break}case 515:{if(J=ie[4423+le>>0]|0,O=J<<24>>24,qe=pt,F[qe>>2]=O,F[qe+4>>2]=((O|0)<0)<<31>>31,ee&&(F[ee>>2]=fe[4487+le>>0]),J<<24>>24<0){F[j>>2]=-1,se[G>>3]=-1,J=-4;break e}break}case 772:case 1028:{if(J=N0(O,le,J,0,pt)|0,(J|0)<0){F[j>>2]=-1,se[G>>3]=-1,J=-4;break e}(ee|0)!=0&(J|0)>0&&(F[ee>>2]=J);break}default:qe=pt,F[qe>>2]=le,F[qe+4>>2]=J}F[j>>2]=F[pt>>2],J=0}while(!1);return me=rt,J|0}function Ds(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0;var J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0;Qt=me,me=me+16|0,J=Qt+8|0,ce=Qt;e:do if(!W)F[G>>2]=0,F[O>>2]=0,se[ee>>3]=-1,q=-1;else switch(q|0){case 0:{if(he=kt(X,X)|0,At=he*3|0,je=$i(he*12|0)|0,je||(Jn(3,5472,ce),zt(1)),!he)q=0;else{q=0,J=0;do q=((fe[j+J>>0]|0)^255)+q|0,J=J+1|0;while((J|0)<(At|0))}if(J=(q|0)/(At|0)|0,!he)le=0;else{ce=0,q=0;do lt=((fe[j+ce>>0]|0)^255)-J|0,F[je+(ce<<2)>>2]=lt,q=(kt(lt,lt)|0)+q|0,ce=ce+1|0;while((ce|0)<(At|0));le=+(q|0)}if(Et=+Qn(+le),Et/(+(X|0)*1.7320508)<15){F[G>>2]=0,F[O>>2]=0,se[ee>>3]=-1,Mr(je),q=-2;break e}if(qe=F[W>>2]|0,Je=W+12|0,lt=W+16|0,(qe|0)>0){rt=F[W+8>>2]|0,We=(he|0)==0,ce=-1,pt=0,le=0,J=-1,q=-1;do{t:for(;;)switch(ce=ce+1|0,F[rt+(ce<<2)>>2]|0){case 0:break;case 2:break t;default:{Ye=17;break t}}if((Ye|0)==17){Ye=0,Ce=ce<<2,De=F[lt>>2]|0,Qe=0;do{if(W=Qe+Ce|0,We)he=0;else{j=F[(F[Je>>2]|0)+(W<<2)>>2]|0,X=0,he=0;do he=(kt(F[j+(X<<2)>>2]|0,F[je+(X<<2)>>2]|0)|0)+he|0,X=X+1|0;while((X|0)<(At|0))}Bn=+(he|0)/+se[De+(W<<3)>>3]/Et,W=Bn>le,J=W?Qe:J,q=W?ce:q,le=W?Bn:le,Qe=Qe+1|0}while((Qe|0)!=4)}pt=pt+1|0}while((pt|0)<(qe|0))}else le=0,J=-1,q=-1;F[O>>2]=J,F[G>>2]=q,se[ee>>3]=le,Mr(je),q=0;break e}case 1:{if(At=kt(X,X)|0,je=$i(At<<2)|0,je||(Jn(3,5472,J),zt(1)),!At)q=0;else{q=0,J=0;do q=((fe[j+J>>0]|0)^255)+q|0,J=J+1|0;while((J|0)<(At|0))}if(J=(q|0)/(At|0)|0,!At)le=0;else{ce=0,q=0;do lt=((fe[j+ce>>0]|0)^255)-J|0,F[je+(ce<<2)>>2]=lt,q=(kt(lt,lt)|0)+q|0,ce=ce+1|0;while((ce|0)<(At|0));le=+(q|0)}if(Et=+Qn(+le),Et/+(X|0)<15){F[G>>2]=0,F[O>>2]=0,se[ee>>3]=-1,Mr(je),q=-2;break e}if(qe=F[W>>2]|0,Je=W+20|0,lt=W+24|0,(qe|0)>0){We=F[W+8>>2]|0,pt=(At|0)==0,ce=-1,rt=0,le=0,J=-1,q=-1;do{t:for(;;)switch(ce=ce+1|0,F[We+(ce<<2)>>2]|0){case 0:break;case 2:break t;default:{Ye=37;break t}}if((Ye|0)==37){Ye=0,Ce=ce<<2,De=F[lt>>2]|0,Qe=0;do{if(W=Qe+Ce|0,pt)he=0;else{j=F[(F[Je>>2]|0)+(W<<2)>>2]|0,X=0,he=0;do he=(kt(F[j+(X<<2)>>2]|0,F[je+(X<<2)>>2]|0)|0)+he|0,X=X+1|0;while((X|0)<(At|0))}Bn=+(he|0)/+se[De+(W<<3)>>3]/Et,W=Bn>le,J=W?Qe:J,q=W?ce:q,le=W?Bn:le,Qe=Qe+1|0}while((Qe|0)!=4)}rt=rt+1|0}while((rt|0)<(qe|0))}else le=0,J=-1,q=-1;F[O>>2]=J,F[G>>2]=q,se[ee>>3]=le,Mr(je),q=0;break e}default:{q=-1;break e}}while(!1);return me=Qt,q|0}function $0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0;X=Ja(8,8)|0,G=Ja(8,1)|0,O=Ja(8,1)|0,ee=F[X>>2]|0,J=F[G>>2]|0,le=0;do Qe=W+(le<<4)|0,ce=le<<4,se[ee+(ce<<3)>>3]=+se[Qe>>3],De=W+(le<<4)+8|0,se[ee+((ce|1)<<3)>>3]=+se[De>>3],se[ee+((ce|2)<<3)>>3]=1,se[ee+((ce|3)<<3)>>3]=0,se[ee+((ce|4)<<3)>>3]=0,se[ee+((ce|5)<<3)>>3]=0,Ce=q+(le<<4)|0,se[ee+((ce|6)<<3)>>3]=-(+se[Qe>>3]*+se[Ce>>3]),se[ee+((ce|7)<<3)>>3]=-(+se[De>>3]*+se[Ce>>3]),se[ee+((ce|8)<<3)>>3]=0,se[ee+((ce|9)<<3)>>3]=0,se[ee+((ce|10)<<3)>>3]=0,se[ee+((ce|11)<<3)>>3]=+se[Qe>>3],se[ee+((ce|12)<<3)>>3]=+se[De>>3],se[ee+((ce|13)<<3)>>3]=1,he=q+(le<<4)+8|0,se[ee+((ce|14)<<3)>>3]=-(+se[Qe>>3]*+se[he>>3]),se[ee+((ce|15)<<3)>>3]=-(+se[De>>3]*+se[he>>3]),ce=le<<1,se[J+(ce<<3)>>3]=+se[Ce>>3],se[J+((ce|1)<<3)>>3]=+se[he>>3],le=le+1|0;while((le|0)!=4);yc(X)|0,Xl(O,X,G)|0,Qe=F[O>>2]|0,se[j>>3]=+se[Qe>>3],se[j+8>>3]=+se[Qe+8>>3],se[j+16>>3]=+se[Qe+16>>3],Qe=F[O>>2]|0,se[j+24>>3]=+se[Qe+24>>3],se[j+32>>3]=+se[Qe+32>>3],se[j+40>>3]=+se[Qe+40>>3],Qe=F[O>>2]|0,se[j+48>>3]=+se[Qe+48>>3],se[j+56>>3]=+se[Qe+56>>3],se[j+64>>3]=1,es(X)|0,es(G)|0,es(O)|0}function N0(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0;switch(Pn=me,me=me+2320|0,ee=Pn+2304|0,Et=Pn+864|0,rt=Pn+784|0,ei=Pn+704|0,Je=Pn+624|0,qe=Pn+548|0,Wn=Pn+40|0,Bn=Pn,W|0){case 772:{X=9,O=1,J=3;break}case 1028:{X=5,O=2,J=3;break}case 2830:{je=900,We=1472,Qt=64,Gn=120,At=127,Ye=X,O=9,J=6;break}default:j=-1}if((J|0)==3){for(W=0;ie[ee+W>>0]=q&1,q=nc(q|0,j|0,1)|0,W=W+1|0,(W|0)!=13;)j=_t;je=840,We=1408,Qt=X,Gn=13,At=15,Ye=ee,J=6}do if((J|0)==6){for(Qe=O<<1,ee=1,j=0;;){X=qe+(ee<<2)|0,F[X>>2]=0,W=0,q=0;do ie[Ye+q>>0]|0&&(W=W^F[je+(((kt(q,ee)|0)%(At|0)|0)<<2)>>2],F[X>>2]=W),q=q+1|0;while((q|0)<(Gn|0));if(j=W|0?1:j,F[X>>2]=F[We+(W<<2)>>2],(ee|0)<(Qe|0))ee=ee+1|0;else break}if(lt=(j|0)!=0,lt){if(F[rt>>2]=0,j=F[qe+4>>2]|0,F[rt+4>>2]=j,F[Et>>2]=0,F[Et+72>>2]=1,(Qe|0)>1){W=1;do F[Et+(W<<2)>>2]=-1,F[Et+72+(W<<2)>>2]=0,W=W+1|0;while((W|0)<(Qe|0))}for(F[ei>>2]=0,F[ei+4>>2]=0,F[Je>>2]=-1,F[Je+4>>2]=0,Ce=0,De=0;;){if(X=De,De=De+1|0,he=rt+(De<<2)|0,(j|0)==-1)if(ee=X+2|0,F[ei+(ee<<2)>>2]=Ce,(Ce|0)<0)ce=Ce;else for(j=0;;)if(he=Et+(De*72|0)+(j<<2)|0,ce=F[he>>2]|0,F[Et+(ee*72|0)+(j<<2)>>2]=ce,F[he>>2]=F[We+(ce<<2)>>2],(j|0)<(Ce|0))j=j+1|0;else{ce=Ce;break}else{for(W=X;j=(W|0)>0,j&(F[rt+(W<<2)>>2]|0)==-1;)W=W+-1|0;if(j){q=W;do j=q,q=q+-1|0,(F[rt+(q<<2)>>2]|0)!=-1&&(W=(F[Je+(W<<2)>>2]|0)<(F[Je+(q<<2)>>2]|0)?q:W);while((j|0)>1)}q=ei+(W<<2)|0,le=De-W|0,ce=le+(F[q>>2]|0)|0,ee=X+2|0,ce=(Ce|0)>(ce|0)?Ce:ce,F[ei+(ee<<2)>>2]=ce,j=0;do F[Et+(ee*72|0)+(j<<2)>>2]=0,j=j+1|0;while((j|0)<(Qe|0));if(j=F[q>>2]|0,q=rt+(W<<2)|0,(j|0)>=0)for(J=0;X=F[Et+(W*72|0)+(J<<2)>>2]|0,(X|0)!=-1&&(F[Et+(ee*72|0)+(le+J<<2)>>2]=F[je+(((X+At+(F[he>>2]|0)-(F[q>>2]|0)|0)%(At|0)|0)<<2)>>2]),(J|0)<(j|0);)J=J+1|0;if((Ce|0)>=0)for(j=0;he=Et+(De*72|0)+(j<<2)|0,le=F[he>>2]|0,J=Et+(ee*72|0)+(j<<2)|0,F[J>>2]=F[J>>2]^le,F[he>>2]=F[We+(le<<2)>>2],(j|0)<(Ce|0);)j=j+1|0}if(F[Je+(ee<<2)>>2]=De-ce,(De|0)>=(Qe|0))break;if(j=F[qe+(ee<<2)>>2]|0,(j|0)==-1?j=0:j=F[je+(j<<2)>>2]|0,X=rt+(ee<<2)|0,F[X>>2]=j,(ce|0)>=1)for(q=1;W=F[qe+(ee-q<<2)>>2]|0,(W|0)!=-1&&(pt=F[Et+(ee*72|0)+(q<<2)>>2]|0,(pt|0)!=0)&&(j=j^F[je+((((F[We+(pt<<2)>>2]|0)+W|0)%(At|0)|0)<<2)>>2],F[X>>2]=j),(q|0)<(ce|0);)q=q+1|0;if(j=F[We+(j<<2)>>2]|0,F[X>>2]=j,(ce|0)>(O|0))break;Ce=ce}if((ce|0)>(O|0)){j=-1;break}if((ce|0)>=0)for(j=0;Je=Et+(ee*72|0)+(j<<2)|0,F[Je>>2]=F[We+(F[Je>>2]<<2)>>2],(j|0)<(ce|0);)j=j+1|0;if((ce|0)>=1)for(j=1;F[Bn+(j<<2)>>2]=F[Et+(ee*72|0)+(j<<2)>>2],(j|0)<(ce|0);)j=j+1|0;J=(ce|0)<1,j=0,le=1;do{if(J)W=1;else for(O=1,W=1;q=Bn+(O<<2)|0,X=F[q>>2]|0,(X|0)!=-1&&(Et=(X+O|0)%(At|0)|0,F[q>>2]=Et,W=F[je+(Et<<2)>>2]^W),(O|0)<(ce|0);)O=O+1|0;W||(F[Wn+(j<<2)>>2]=At-le,j=j+1|0),le=le+1|0}while((At|0)>=(le|0));if((j|0)!=(ce|0)){j=-1;break}if((ce|0)>0){j=0;do Bn=Ye+(F[Wn+(j<<2)>>2]|0)|0,ie[Bn>>0]=fe[Bn>>0]^1,j=j+1|0;while((j|0)<(ce|0))}}else ee=0;for(W=G,F[W>>2]=0,F[W+4>>2]=0,W=1,q=0,X=0,O=0,j=Gn-Qt|0;Wn=E0(fe[Ye+j>>0]|0,0,W|0,q|0)|0,X=Bs(Wn|0,_t|0,X|0,O|0)|0,O=_t,Wn=G,F[Wn>>2]=X,F[Wn+4>>2]=O,W=Bo(W|0,q|0,1)|0,j=j+1|0,!((j|0)>=(Gn|0));)q=_t;lt?j=F[ei+(ee<<2)>>2]|0:j=0}while(!1);return me=Pn,j|0}function xu(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;Ye=me,me=me+32|0,je=Ye+24|0,O=Ye+16|0,j=Ye+8|0;do if(W){if(!q){Jn(3,4674,j),j=-1;break}At=W+8|0,G=F[W+4>>2]|0;e:do if((G|0)>0){X=F[At>>2]|0,j=0;do{if(!(F[X+(j<<2)>>2]|0))break e;j=j+1|0}while((j|0)<(G|0))}else j=0;while(!1);if((j|0)!=(G|0)){if(Et=Oa(q)|0,!Et){Jn(3,4719,O),j=-1;break}We=W+28|0,pt=j<<2,rt=W+12|0,qe=W+20|0,Je=W+16|0,lt=W+24|0,G=d0(Et,4742)|0,X=0;e:for(;;){Qe=X+pt|0,De=0,q=0;do{if(he=(De|0)==0,Ce=(De|0)==2,O=F[We>>2]|0,(O|0)>0){ce=0;do{if((O|0)>0){le=0;do{if(!G){X=17;break e}O=Ju(G)|0,G=d0(0,4742)|0,O=255-O|0,J=(((kt(F[We>>2]|0,ce)|0)+le|0)*3|0)+De|0,F[(F[(F[rt>>2]|0)+(Qe<<2)>>2]|0)+(J<<2)>>2]=O,J=(kt(F[We>>2]|0,ce)|0)+le|0,ee=F[(F[qe>>2]|0)+(Qe<<2)>>2]|0,J=ee+(J<<2)|0,he?F[J>>2]=O:(F[J>>2]=(F[J>>2]|0)+O,Ce&&(J=ee+((kt(F[We>>2]|0,ce)|0)+le<<2)|0,F[J>>2]=(F[J>>2]|0)/3|0)),q=O+q|0,le=le+1|0,O=F[We>>2]|0}while((le|0)<(O|0))}ce=ce+1|0}while((ce|0)<(O|0))}De=De+1|0}while((De|0)<3);if(O=F[We>>2]|0,le=(q|0)/(kt(O*3|0,O)|0)|0,(kt(O*3|0,O)|0)>0){ee=F[(F[rt>>2]|0)+(Qe<<2)>>2]|0,J=0,q=0;do De=ee+(J<<2)|0,O=(F[De>>2]|0)-le|0,F[De>>2]=O,q=(kt(O,O)|0)+q|0,J=J+1|0,O=F[We>>2]|0;while((J|0)<(kt(O*3|0,O)|0))}else q=0;if(Qt=+Qn(+ +(q|0)),se[(F[Je>>2]|0)+(Qe<<3)>>3]=Qt==0?1e-7:Qt,!(kt(O,O)|0))q=0;else{O=F[(F[qe>>2]|0)+(Qe<<2)>>2]|0,ee=0,q=0;do Ce=O+(ee<<2)|0,De=(F[Ce>>2]|0)-le|0,F[Ce>>2]=De,q=(kt(De,De)|0)+q|0,ee=ee+1|0,De=F[We>>2]|0;while((ee|0)<(kt(De,De)|0))}if(Qt=+Qn(+ +(q|0)),se[(F[lt>>2]|0)+(Qe<<3)>>3]=Qt==0?1e-7:Qt,X=X+1|0,(X|0)>=4){X=32;break}}if((X|0)==17){Jn(3,4747,je),Mr(Et),j=-1;break}else if((X|0)==32){Mr(Et),F[(F[At>>2]|0)+(j<<2)>>2]=1,F[W>>2]=(F[W>>2]|0)+1;break}}else j=-1}else Jn(3,4649,Ye),j=-1;while(!1);return me=Ye,j|0}function Uh(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0;J=me,me=me+32|0,ee=J+16|0,O=J+8|0,j=J,G=va(q,4854)|0;do if(G){if(eu(G,0,2)|0,j=qu(G)|0,eu(G,0,0)|0,X=$i(j+1|0)|0,!X){Jn(3,5472,O),W0(G)|0,j=-1;break}if(O=Ac(X,j,1,G)|0,W0(G)|0,O){ie[X+j>>0]=0,j=xu(W,X)|0,Mr(X);break}else{F[ee>>2]=q,Jn(3,4820,ee),Mr(X),j=-1;break}}else F[j>>2]=q,Jn(3,4774,j),j=-1;while(!1);return me=J,j|0}function U0(W,q){return W=W|0,q=q|0,q=(F[W+8>>2]|0)+(q<<2)|0,F[q>>2]|0?(F[q>>2]=0,F[W>>2]=(F[W>>2]|0)+-1,q=1):q=-1,q|0}function Jn(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;if(ee=me,me=me+32|0,O=ee+16|0,X=ee,F[O>>2]=0,(q|0)!=0&(F[496]|0)<=(W|0)&&ie[q>>0]|0&&(F[X>>2]=j,G=Hl(O,q,X)|0,(G|0)>-1)){X=F[497]|0;do if(X){if(!(F[498]|0)){rr[X&15](F[O>>2]|0);break}if(j=er()|0,W=F[500]|0,(j|0)==(F[499]|0)){(W|0)>0&&(rr[X&15](F[502]|0),F[500]=0,X=F[497]|0),rr[X&15](F[O>>2]|0);break}if(X=F[501]|0,(W|0)<(X|0))if(q=(F[502]|0)+W|0,(G|0)<(-3-W+X|0)){Oh(q,F[O>>2]|0)|0,F[500]=(F[500]|0)+G;break}else{ie[q>>0]=46,ie[q+1>>0]=46,ie[q+2>>0]=46,ie[q+3>>0]=0,F[500]=F[501];break}}else Ka(F[O>>2]|0,F[659]|0)|0;while(!1);Mr(F[O>>2]|0)}me=ee}function $l(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0;J=0;do{X=W+(J<<5)|0,G=W+(J<<5)+8|0,O=W+(J<<5)+16|0,ee=0;do se[j+(J<<5)+(ee<<3)>>3]=+se[X>>3]*+se[q+(ee<<3)>>3]+ +se[G>>3]*+se[q+32+(ee<<3)>>3]+ +se[O>>3]*+se[q+64+(ee<<3)>>3],ee=ee+1|0;while((ee|0)!=4);ee=j+(J<<5)+24|0,se[ee>>3]=+se[W+(J<<5)+24>>3]+ +se[ee>>3],J=J+1|0}while((J|0)!=3);return 0}function kh(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0;J=Ja(4,4)|0,j=F[J>>2]|0,X=F[J>>2]|0,G=F[J>>2]|0,O=F[J>>2]|0,ee=0;do le=ee<<2,se[j+(le<<3)>>3]=+se[W+(ee<<5)>>3],se[X+(1+le<<3)>>3]=+se[W+(ee<<5)+8>>3],se[G+(2+le<<3)>>3]=+se[W+(ee<<5)+16>>3],se[O+(3+le<<3)>>3]=+se[W+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3);j=F[J>>2]|0,X=j+96|0,F[X>>2]=0,F[X+4>>2]=0,F[X+8>>2]=0,F[X+12>>2]=0,F[X+16>>2]=0,F[X+20>>2]=0,se[j+120>>3]=1,yc(J)|0,j=F[J>>2]|0,X=F[J>>2]|0,G=F[J>>2]|0,O=F[J>>2]|0,ee=0;do le=ee<<2,se[q+(ee<<5)>>3]=+se[j+(le<<3)>>3],se[q+(ee<<5)+8>>3]=+se[X+(1+le<<3)>>3],se[q+(ee<<5)+16>>3]=+se[G+(2+le<<3)>>3],se[q+(ee<<5)+24>>3]=+se[O+(3+le<<3)>>3],ee=ee+1|0;while((ee|0)!=3);return es(J)|0,0}function nl(W){switch(W=W|0,W|0){case 1:case 0:{W=3;break}case 6:case 4:case 3:case 2:{W=4;break}case 14:case 13:case 12:case 5:{W=1;break}case 11:case 10:case 9:case 8:case 7:{W=2;break}default:W=0}return W|0}function gl(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0;do if((W|0)!=0&(q|0)!=0&(j|0)!=0){if(G=Ua(q,47)|0,!G){ie[W>>0]=0;break}G=G+((X|0)!=0&1)-q|0,(G+1|0)>>>0<=j>>>0?(Io(W,q,G)|0,ie[W+G>>0]=0):W=0}else W=0;while(!1);return W|0}function Ja(W,q){W=W|0,q=q|0;var j=0,X=0;j=$i(12)|0;do if(j)if(X=$i(kt(W<<3,q)|0)|0,F[j>>2]=X,X){F[j+4>>2]=W,F[j+8>>2]=q;break}else{Mr(j),j=0;break}else j=0;while(!1);return j|0}function ju(W){W=W|0;var q=0;return q=Ja(F[W+4>>2]|0,F[W+8>>2]|0)|0,q?(wu(q,W)|0)<0&&(es(q)|0,q=0):q=0,q|0}function Ec(W,q){W=W|0,q=q|0;var j=0;return j=Ja(F[W+4>>2]|0,F[q+8>>2]|0)|0,j?(Xl(j,W,q)|0)<0&&(es(j)|0,j=0):j=0,j|0}function Gh(W){W=W|0;var q=0;return q=Ja(F[W+8>>2]|0,F[W+4>>2]|0)|0,q?(il(q,W)|0)<0&&(es(q)|0,q=0):q=0,q|0}function wu(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0;if(j=F[W+4>>2]|0,(j|0)==(F[q+4>>2]|0)&&(J=F[W+8>>2]|0,(J|0)==(F[q+8>>2]|0)))if((j|0)>0){X=(J|0)>0,ce=0;do{if(G=kt(J,ce)|0,X){O=F[q>>2]|0,ee=F[W>>2]|0,le=0;do he=G+le|0,se[ee+(he<<3)>>3]=+se[O+(he<<3)>>3],le=le+1|0;while((le|0)<(J|0))}ce=ce+1|0}while((ce|0)<(j|0));j=0}else j=0;else j=-1;return j|0}function es(W){return W=W|0,W&&(Mr(F[W>>2]|0),Mr(W)),0}function Xl(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0;if(Ce=F[q+8>>2]|0,(Ce|0)==(F[j+4>>2]|0)&&(pt=F[W+4>>2]|0,(pt|0)==(F[q+4>>2]|0))&&(De=F[W+8>>2]|0,(De|0)==(F[j+8>>2]|0)))if(rt=(De|0)>0?De:0,(pt|0)>0)for(Qe=(De|0)>0,We=(Ce|0)>0,le=F[W>>2]|0,he=0;;){if(W=kt(Ce,he)|0,Qe)for(G=0,ce=le;;){if(se[ce>>3]=0,We)for(X=0,O=0,ee=(F[q>>2]|0)+(W<<3)|0,J=(F[j>>2]|0)+(G<<3)|0;X=X+ +se[ee>>3]*+se[J>>3],se[ce>>3]=X,O=O+1|0,!((O|0)>=(Ce|0));)ee=ee+8|0,J=J+(De<<3)|0;if(G=G+1|0,(G|0)>=(De|0))break;ce=ce+8|0}if(he=he+1|0,(he|0)>=(pt|0)){W=0;break}else le=le+(rt<<3)|0}else W=0;else W=-1;return W|0}function Zo(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0;We=F[W+4>>2]|0,rt=F[W+8>>2]|0,G=(We|0)<(rt|0)?We:rt;e:do if(!((We|0)<2|(rt|0)<2)&&(F[q+8>>2]|0)==(rt|0)&&(F[q+4>>2]|0)==(G|0)&&(qe=j+4|0,(F[qe>>2]|0)==(G|0))&&(O=X+4|0,(F[O>>2]|0)==(rt|0))&&(Je=ju(W)|0,(Je|0)!=0)){if(pt=+Qn(+ +(We|0)),De=F[Je+4>>2]|0,Qe=F[Je+8>>2]|0,!((De|0)<1|(Qe|0)<1)&&(F[O>>2]|0)==(Qe|0)){if(Qe){G=F[X>>2]|0,W=0;do se[G+(W<<3)>>3]=0,W=W+1|0;while((W|0)!=(Qe|0))}if(Ce=F[Je>>2]|0,De)for(G=(Qe|0)==0,W=0,J=Ce;;){if(!G)for(O=0,le=J,ce=F[X>>2]|0;se[ce>>3]=+se[le>>3]+ +se[ce>>3],O=O+1|0,(O|0)!=(Qe|0);)le=le+8|0,ce=ce+8|0;if(W=W+1|0,(W|0)==(De|0))break;J=J+(Qe<<3)|0}if(ee=+(De|0),Qe){G=F[X>>2]|0,W=0;do he=G+(W<<3)|0,se[he>>3]=+se[he>>3]/ee,W=W+1|0;while((W|0)!=(Qe|0))}if(ce=(Qe|0)>0?Qe:0,(De|0)>0)for(G=(Qe|0)>0,W=0,J=Ce;;){if(G)for(O=0,le=J,he=F[X>>2]|0;se[le>>3]=+se[le>>3]-+se[he>>3],O=O+1|0,!((O|0)>=(Qe|0));)le=le+8|0,he=he+8|0;if(W=W+1|0,(W|0)>=(De|0))break;J=J+(ce<<3)|0}if(G=kt(rt,We)|0,(G|0)>0){W=0;do X=Ce+(W<<3)|0,se[X>>3]=+se[X>>3]/pt,W=W+1|0;while((W|0)<(G|0))}if(G=tu(Je,q,j)|0,es(Je)|0,J=F[qe>>2]|0,(J|0)>0){W=F[j>>2]|0,O=0,ee=0;do ee=ee+ +se[W+(O<<3)>>3],O=O+1|0;while((O|0)<(J|0))}else ee=0;if((J|0)<=0)break;for(W=F[j>>2]|0,O=0;;)if(j=W+(O<<3)|0,se[j>>3]=+se[j>>3]/ee,O=O+1|0,(O|0)>=(J|0))break e}es(Je)|0,G=-1}else G=-1;while(!1);return G|0}function tu(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0,jr=0,wr=0,ks=0,ho=0,zs=0,Fi=0,ar=0,Cr=0,no=0;ho=me,me=me+16|0,lt=ho,ei=W+4|0,mi=F[ei>>2]|0,Gi=W+8|0,tr=F[Gi>>2]|0,wr=(tr|0)<(mi|0)?tr:mi;e:do if(!((mi|0)<2|(tr|0)<2)&&(jr=q+8|0,(F[jr>>2]|0)==(tr|0))&&(Di=q+4|0,(F[Di>>2]|0)==(wr|0))&&(wn=j+4|0,(F[wn>>2]|0)==(wr|0))){if(ks=Ja(wr,wr)|0,ci=ks+4|0,(F[ci>>2]|0)==(wr|0)&&(Rn=ks+8|0,(F[Rn>>2]|0)==(wr|0))){if(Pn=(mi|0)<(tr|0),pt=F[ei>>2]|0,rt=F[Gi>>2]|0,Pn){if((wr|0)!=(pt|0)){es(ks)|0,X=-1;break}if(O=F[ks>>2]|0,(wr|0)>0)for(ce=(wr|0)==0,ee=(rt|0)>0,he=0,We=O;;){if(le=kt(he,rt)|0,!ce)for(De=0,pt=We;;){if((De|0)>=(he|0)){if(X=F[W>>2]|0,se[pt>>3]=0,ee)for(J=0,Ce=X+(le<<3)|0,X=X+((kt(De,rt)|0)<<3)|0,G=0;J=J+ +se[Ce>>3]*+se[X>>3],se[pt>>3]=J,G=G+1|0,!((G|0)>=(rt|0));)Ce=Ce+8|0,X=X+8|0}else se[pt>>3]=+se[O+((kt(De,wr)|0)+he<<3)>>3];if(De=De+1|0,(De|0)==(wr|0))break;pt=pt+8|0}if(he=he+1|0,(he|0)>=(wr|0))break;We=We+(wr<<3)|0}}else{if((wr|0)!=(rt|0)){es(ks)|0,X=-1;break}if(O=F[ks>>2]|0,(wr|0)>0)for(le=(wr|0)==0,ee=(pt|0)>0,ce=0,De=O;;){if(!le)for(Ce=0,We=De;;){if((Ce|0)>=(ce|0)){if(X=F[W>>2]|0,se[We>>3]=0,ee)for(J=0,he=X+(ce<<3)|0,X=X+(Ce<<3)|0,G=0;J=J+ +se[he>>3]*+se[X>>3],se[We>>3]=J,G=G+1|0,!((G|0)>=(pt|0));)he=he+(wr<<3)|0,X=X+(wr<<3)|0}else se[We>>3]=+se[O+((kt(Ce,wr)|0)+ce<<3)>>3];if(Ce=Ce+1|0,(Ce|0)==(wr|0))break;We=We+8|0}if(ce=ce+1|0,(ce|0)>=(wr|0))break;De=De+(wr<<3)|0}}do if((wr|0)>=2&&(F[wn>>2]|0)==(wr|0)&&(Yi=jo(wr)|0,(Yi|0)!=0)){if(Wn=wr+-1|0,F[lt+4>>2]=Wn,F[lt>>2]=(F[Yi>>2]|0)+8,(ba(ks,j,lt)|0)<0){b0(Yi)|0;break}if(Qt=F[Yi>>2]|0,se[Qt>>3]=0,(Wn|0)>0){Bn=(wr|0)==0,Gn=Wn;do{for(G=Gn;!((G|0)<=0);)if(Je=+Nn(+ +se[Qt+(G<<3)>>3]),X=G+-1|0,Ye=F[j>>2]|0,Et=+Nn(+ +se[Ye+(X<<3)>>3]),Je>(Et+ +Nn(+ +se[Ye+(G<<3)>>3]))*1e-6)G=X;else break;At=Gn,Gn=Gn+-1|0;t:do if((G|0)!=(At|0)){Ce=Qt+(At<<3)|0,De=Qt+(G+1<<3)|0,We=(G|0)<(At|0),je=0;do{if((je|0)>99)break t;if(je=je+1|0,pt=F[j>>2]|0,rt=pt+(Gn<<3)|0,lt=pt+(At<<3)|0,J=+se[lt>>3],Qe=(+se[rt>>3]-J)*.5,qe=+se[Ce>>3],qe=qe*qe,Je=+Qn(+(qe+Qe*Qe)),We)for(Ye=G,Qe=+se[pt+(G<<3)>>3]-J+qe/(Qe+(Qe<0?-Je:Je)),qe=+se[De>>3];;){J=+Nn(+Qe);do if(!(J>=+Nn(+qe)))Je=-Qe/qe,Et=1/+Qn(+(Je*Je+1)),Je=Je*Et;else{if(!(J>1e-16)){Je=1,Et=0;break}J=-qe/Qe,Et=1/+Qn(+(J*J+1)),Je=Et,Et=J*Et}while(!1);if(ee=pt+(Ye<<3)|0,ar=+se[ee>>3],he=Ye,Ye=Ye+1|0,le=pt+(Ye<<3)|0,Fi=+se[le>>3],J=ar-Fi,ce=Qt+(Ye<<3)|0,zs=Et*(Et*J+Je*2*+se[ce>>3]),se[ee>>3]=ar-zs,se[le>>3]=Fi+zs,(he|0)>(G|0)&&(le=Qt+(he<<3)|0,se[le>>3]=Je*+se[le>>3]-qe*Et),ar=+se[ce>>3],se[ce>>3]=ar+Et*(Je*J-Et*2*ar),ee=kt(he,wr)|0,le=kt(Ye,wr)|0,Bn)J=qe;else{X=F[ks>>2]|0,O=0;do no=X+(O+ee<<3)|0,Qe=+se[no>>3],Cr=X+(O+le<<3)|0,J=+se[Cr>>3],se[no>>3]=Je*Qe-Et*J,se[Cr>>3]=Et*Qe+Je*J,O=O+1|0;while((O|0)!=(wr|0))}if((he|0)<(Gn|0)&&(Qe=+se[ce>>3],no=Qt+(he+2<<3)|0,J=+se[no>>3],se[no>>3]=Je*J,J=-(Et*J)),(Ye|0)>=(At|0))break;qe=J}Fi=+Nn(+ +se[Ce>>3]),ar=+Nn(+ +se[rt>>3])}while(Fi>(ar+ +Nn(+ +se[lt>>3]))*1e-6)}while(!1)}while((At|0)>1)}if(Wn){le=F[j>>2]|0,ce=F[ks>>2]|0,he=(wr|0)==0,Ce=0;do{if(O=le+(Ce<<3)|0,Qe=+se[O>>3],ee=Ce,Ce=Ce+1|0,(Ce|0)<(wr|0)){X=ee,G=Ce,J=Qe;do ar=+se[le+(G<<3)>>3],no=ar>J,J=no?ar:J,X=no?G:X,G=G+1|0;while((G|0)<(wr|0))}else X=ee,J=Qe;if(se[le+(X<<3)>>3]=Qe,se[O>>3]=J,!he)for(O=0,G=ce+((kt(X,wr)|0)<<3)|0,X=ce+((kt(ee,wr)|0)<<3)|0;ar=+se[G>>3],se[G>>3]=+se[X>>3],se[X>>3]=ar,O=O+1|0,(O|0)!=(wr|0);)G=G+8|0,X=X+8|0}while((Ce|0)!=(Wn|0))}b0(Yi)|0;t:do if(Pn){lt=F[ei>>2]|0,rt=F[Gi>>2]|0;do if(!((lt|0)<1|(rt|0)<1)){if((F[ci>>2]|0)!=(lt|0)||(F[Rn>>2]|0)!=(lt|0)||(F[Di>>2]|0)!=(lt|0)||(F[jr>>2]|0)!=(rt|0)||(F[wn>>2]|0)!=(lt|0))break;G=F[q>>2]|0;n:do if((lt|0)>0){De=F[j>>2]|0,pt=(rt|0)==0,We=(lt|0)==0,X=0;do{if(J=+se[De+(X<<3)>>3],J<1e-16)break n;if(Qe=1/+Qn(+ +Nn(+J)),ce=kt(X,lt)|0,!pt)for(he=0,Ce=G;;){if(We)J=0;else for(O=0,ee=(F[ks>>2]|0)+(ce<<3)|0,le=(F[W>>2]|0)+(he<<3)|0,J=0;J=J+ +se[ee>>3]*+se[le>>3],O=O+1|0,(O|0)!=(lt|0);)ee=ee+8|0,le=le+(rt<<3)|0;if(se[Ce>>3]=Qe*J,he=he+1|0,(he|0)==(rt|0))break;Ce=Ce+8|0}G=G+(rt<<3)|0,X=X+1|0}while((X|0)<(lt|0))}else X=0;while(!1);if(he=(rt|0)>0?rt:0,(X|0)>=(lt|0))break t;for(le=F[j>>2]|0,ce=(rt|0)>0,O=G;;){if(se[le+(X<<3)>>3]=0,ce)for(G=0,ee=O;se[ee>>3]=0,G=G+1|0,!((G|0)>=(rt|0));)ee=ee+8|0;if(X=X+1|0,(X|0)>=(lt|0))break t;O=O+(he<<3)|0}}while(!1);es(ks)|0,X=-1;break e}else{O=F[q>>2]|0,De=(mi|0)>(tr|0)?tr:mi;n:do if((wr|0)>0){ce=F[j>>2]|0,he=(De|0)==0,X=0,Ce=F[ks>>2]|0;do{if(+se[ce+(X<<3)>>3]<1e-16)break n;if(!he)for(G=0,ee=Ce,le=O;se[le>>3]=+se[ee>>3],G=G+1|0,(G|0)!=(De|0);)ee=ee+8|0,le=le+8|0;Ce=Ce+(De<<3)|0,O=O+(De<<3)|0,X=X+1|0}while((X|0)<(wr|0))}else X=0;while(!1);if(he=(De|0)>0?De:0,(X|0)<(wr|0))for(le=F[j>>2]|0,ce=(wr|0)>0;;){if(se[le+(X<<3)>>3]=0,ce)for(G=0,ee=O;se[ee>>3]=0,G=G+1|0,!((G|0)>=(wr|0));)ee=ee+8|0;if(X=X+1|0,(X|0)>=(wr|0))break;O=O+(he<<3)|0}}while(!1);es(ks)|0,X=0;break e}while(!1);es(ks)|0,X=-1;break}es(ks)|0,X=-1}else X=-1;while(!1);return me=ho,X|0}function yc(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0;Je=me,me=me+2e3|0,qe=Je,q=F[W>>2]|0,rt=F[W+4>>2]|0;e:do if((rt|0)<=500){switch(rt|0){case 0:{q=0;break e}case 1:{se[q>>3]=1/+se[q>>3];break e}default:}if((rt|0)>0){W=0;do F[qe+(W<<2)>>2]=W,W=W+1|0;while((W|0)<(rt|0))}if(pt=q+(rt+-1<<3)|0,(rt|0)>0)for(ce=(rt|0)==0,De=(rt|0)==1,Ce=(rt|0)==0,he=(rt|0)==1,Qe=pt,W=0,We=0;;){if(le=q+((kt(We,rt)|0)<<3)|0,(We|0)<(rt|0))for(X=We,G=0,j=le;lt=+Nn(+ +se[j>>3]),J=G<lt,W=J?X:W,G=J?lt:G,X=X+1|0,!((X|0)>=(rt|0));)j=j+(rt<<3)|0;else G=0;if(G<=1e-10){q=0;break e}if(O=qe+(W<<2)|0,ee=F[O>>2]|0,J=qe+(We<<2)|0,F[O>>2]=F[J>>2],F[J>>2]=ee,!ce)for(j=0,X=q+((kt(W,rt)|0)<<3)|0,O=le;lt=+se[X>>3],se[X>>3]=+se[O>>3],se[O>>3]=lt,j=j+1|0,(j|0)!=(rt|0);)X=X+8|0,O=O+8|0;if(G=+se[le>>3],!De){j=1,X=le;do J=X,X=X+8|0,se[J>>3]=+se[X>>3]/G,j=j+1|0;while((j|0)!=(rt|0))}if(se[Qe>>3]=1/G,!Ce)for(O=0,ee=pt;;){if((O|0)!=(We|0)){if(j=q+((kt(O,rt)|0)<<3)|0,G=+se[j>>3],!he)for(J=1,X=le;Et=j,j=j+8|0,se[Et>>3]=+se[j>>3]-G*+se[X>>3],J=J+1|0,(J|0)!=(rt|0);)X=X+8|0;se[ee>>3]=-(G*+se[Qe>>3])}if(O=O+1|0,(O|0)==(rt|0))break;ee=ee+(rt<<3)|0}if(We=We+1|0,(We|0)>=(rt|0))break;Qe=Qe+(rt<<3)|0}if((rt|0)>0){O=(rt|0)>0,ee=0;do{W=qe+(ee<<2)|0;t:do if((ee|0)<(rt|0)){j=ee;do{if((F[W>>2]|0)==(ee|0))break t;j=j+1|0,W=qe+(j<<2)|0}while((j|0)<(rt|0))}else j=ee;while(!1);if(F[W>>2]=F[qe+(ee<<2)>>2],O)for(X=0,W=q+(j<<3)|0,j=q+(ee<<3)|0;lt=+se[W>>3],se[W>>3]=+se[j>>3],se[j>>3]=lt,X=X+1|0,!((X|0)>=(rt|0));)W=W+(rt<<3)|0,j=j+(rt<<3)|0;ee=ee+1|0}while((ee|0)<(rt|0))}}else q=0;while(!1);return me=Je,((q|0)==0)<<31>>31|0}function il(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0;if(ee=F[W+4>>2]|0,(ee|0)==(F[q+8>>2]|0)&&(le=F[W+8>>2]|0,(le|0)==(F[q+4>>2]|0)))if(ce=(le|0)>0?le:0,(ee|0)>0)for(J=(le|0)>0,X=F[W>>2]|0,O=0;;){if(J)for(W=0,j=(F[q>>2]|0)+(O<<3)|0,G=X;se[G>>3]=+se[j>>3],W=W+1|0,!((W|0)>=(le|0));)j=j+(ee<<3)|0,G=G+8|0;if(O=O+1|0,(O|0)>=(ee|0)){W=0;break}else X=X+(ce<<3)|0}else W=0;else W=-1;return W|0}function nu(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0;G=+(q|0)/+(F[W>>2]|0),O=+(j|0)/+(F[W+4>>2]|0),F[X>>2]=q,F[X+4>>2]=j,q=0;do se[X+8+(q<<3)>>3]=G*+se[W+8+(q<<3)>>3],se[X+40+(q<<3)>>3]=O*+se[W+40+(q<<3)>>3],se[X+72+(q<<3)>>3]=+se[W+72+(q<<3)>>3],q=q+1|0;while((q|0)!=4);switch(q=F[W+176>>2]|0,q|0){case 4:{se[X+104>>3]=+se[W+104>>3],se[X+112>>3]=+se[W+112>>3],se[X+120>>3]=+se[W+120>>3],se[X+128>>3]=+se[W+128>>3],se[X+136>>3]=G*+se[W+136>>3],se[X+144>>3]=O*+se[W+144>>3],se[X+152>>3]=G*+se[W+152>>3],se[X+160>>3]=O*+se[W+160>>3],se[X+168>>3]=+se[W+168>>3],ee=8;break}case 3:{se[X+104>>3]=G*+se[W+104>>3],se[X+112>>3]=O*+se[W+112>>3],se[X+120>>3]=+se[W+120>>3],se[X+128>>3]=+se[W+128>>3],se[X+136>>3]=+se[W+136>>3]/(G*O),se[X+144>>3]=+se[W+144>>3]/(O*(G*G*O)),ee=8;break}case 2:{se[X+104>>3]=G*+se[W+104>>3],se[X+112>>3]=O*+se[W+112>>3],se[X+120>>3]=+se[W+120>>3],se[X+128>>3]=+se[W+128>>3]/(G*O),se[X+136>>3]=+se[W+136>>3]/(O*(G*G*O)),ee=8;break}case 1:{se[X+104>>3]=G*+se[W+104>>3],se[X+112>>3]=O*+se[W+112>>3],se[X+120>>3]=+se[W+120>>3],se[X+128>>3]=+se[W+128>>3]/(G*O),ee=8;break}default:q=-1}return(ee|0)==8&&(F[X+176>>2]=q,q=0),q|0}function r0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0;if(O=me,me=me+96|0,G=O,+se[W+88>>3]>=0){X=0;do se[G+(X<<5)>>3]=+se[W+(X<<5)>>3],se[G+(X<<5)+8>>3]=+se[W+(X<<5)+8>>3],se[G+(X<<5)+16>>3]=+se[W+(X<<5)+16>>3],se[G+(X<<5)+24>>3]=+se[W+(X<<5)+24>>3],X=X+1|0;while((X|0)!=3)}else{X=0;do se[G+(X<<5)>>3]=-+se[W+(X<<5)>>3],se[G+(X<<5)+8>>3]=-+se[W+(X<<5)+8>>3],se[G+(X<<5)+16>>3]=-+se[W+(X<<5)+16>>3],se[G+(X<<5)+24>>3]=-+se[W+(X<<5)+24>>3],X=X+1|0;while((X|0)!=3)}se[q>>3]=0,se[q+8>>3]=0,se[q+16>>3]=0,se[q+24>>3]=0,se[q+32>>3]=0,se[q+40>>3]=0,se[q+48>>3]=0,se[q+56>>3]=0,se[q+64>>3]=0,se[q+72>>3]=0,se[q+80>>3]=0,se[q+88>>3]=0,ee=+se[G+64>>3],De=+se[G+72>>3],Qe=+se[G+80>>3],At=+Qn(+(ee*ee+De*De+Qe*Qe)),W=q+80|0,se[W>>3]=At,At=ee/At,lt=j+64|0,se[lt>>3]=At,De=De/+se[W>>3],qe=j+72|0,se[qe>>3]=De,Qe=Qe/+se[W>>3],We=j+80|0,se[We>>3]=Qe,Ce=j+88|0,se[Ce>>3]=+se[G+88>>3]/+se[W>>3],ee=+se[G+32>>3],le=+se[G+40>>3],rt=+se[G+48>>3],Qe=At*ee+De*le+Qe*rt,he=q+48|0,se[he>>3]=Qe,ee=ee-Qe*+se[lt>>3],le=le-Qe*+se[qe>>3],Qe=rt-Qe*+se[We>>3],rt=+Qn(+(ee*ee+le*le+Qe*Qe)),ce=q+40|0,se[ce>>3]=rt,Et=j+32|0,se[Et>>3]=ee/rt,Je=j+40|0,se[Je>>3]=le/+se[ce>>3],pt=j+48|0,se[pt>>3]=Qe/+se[ce>>3],Qe=+se[G>>3],le=+se[G+8>>3],rt=+se[G+16>>3],ee=+se[lt>>3]*Qe+ +se[qe>>3]*le+ +se[We>>3]*rt,X=q+16|0,se[X>>3]=ee,De=+se[Et>>3]*Qe+ +se[Je>>3]*le+ +se[pt>>3]*rt,J=q+8|0,se[J>>3]=De,Qe=Qe-De*+se[Et>>3]-ee*+se[lt>>3],le=le-De*+se[Je>>3]-ee*+se[qe>>3],ee=rt-De*+se[pt>>3]-ee*+se[We>>3],De=+Qn(+(Qe*Qe+le*le+ee*ee)),se[q>>3]=De,se[j>>3]=Qe/De,se[j+8>>3]=le/+se[q>>3],se[j+16>>3]=ee/+se[q>>3],ee=+se[Ce>>3],le=(+se[G+56>>3]-+se[he>>3]*ee)/+se[ce>>3],se[j+56>>3]=le,se[j+24>>3]=(+se[G+24>>3]-le*+se[J>>3]-+se[X>>3]*ee)/+se[q>>3],X=0;do Et=q+(X<<5)|0,se[Et>>3]=+se[Et>>3]/+se[W>>3],Et=q+(X<<5)+8|0,se[Et>>3]=+se[Et>>3]/+se[W>>3],Et=q+(X<<5)+16|0,se[Et>>3]=+se[Et>>3]/+se[W>>3],X=X+1|0;while((X|0)!=3);return me=O,0}function sa(W,q,j,X,G,O){W=W|0,q=+q,j=+j,X=X|0,G=G|0,O=O|0;var ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0;switch(O|0){case 4:{pt=+se[W>>3],rt=+se[W+8>>3],qe=+se[W+16>>3],Je=+se[W+24>>3],Ye=+se[W+32>>3],Et=+se[W+40>>3],At=+se[W+48>>3],je=+se[W+56>>3],lt=+se[W+64>>3],We=(q-At)/Ye,le=(j-je)/Et,j=We*We,J=le*le,ce=qe*2,he=Je*6,Ce=Je*2,De=qe*6;e:do if(J!=0|j!=0)for(O=1,ee=We,q=le;;){if(Wn=J+j,Gn=pt*Wn+1+Wn*(rt*Wn),Qt=j*3,Bn=J*Qt,ee=ee-(Je*(Wn+j*2)+(q*(ce*ee)+ee*Gn)-We)/(he*ee+(ce*q+(pt*(J+Qt)+1+rt*(J*J+(j*(j*5)+Bn))))),Qt=Ce*ee,q=q-(qe*(J*2+Wn)+q*Gn+q*Qt-le)/(De*q+(pt*(j+J*3)+1+rt*(J*(J*5)+(j*j+Bn)))+Qt),(O|0)==4)break e;if(j=ee*ee,J=q*q,J!=0|j!=0)O=O+1|0;else{ee=0,q=0;break}}else ee=0,q=0;while(!1);se[X>>3]=At+Ye*ee/lt,se[G>>3]=je+Et*q/lt,O=0;break}case 3:{We=+se[W>>3],ee=(q-We)/+se[W+24>>3],Qe=W+8|0,q=j-+se[Qe>>3],le=+se[W+32>>3]/1e8,ce=+se[W+40>>3]/1e8/1e5,j=ee*ee+q*q,he=+Qn(+j),Ce=le*3,De=ce*5;e:do if(he!=0)for(O=1,J=he;;){if(Wn=J-(J*(1-le*j-j*(ce*j))-he)/(1-Ce*j-j*(De*j)),ee=ee*Wn/J,q=q*Wn/J,(O|0)==3)break e;if(j=ee*ee+q*q,J=+Qn(+j),J==0){ee=0,q=0;break}else O=O+1|0}else ee=0,q=0;while(!1);O=W+16|0,se[X>>3]=ee/+se[O>>3]+We,se[G>>3]=q/+se[O>>3]+ +se[Qe>>3],O=0;break}case 2:{We=+se[W>>3],ee=q-We,Qe=W+8|0,q=j-+se[Qe>>3],le=+se[W+24>>3]/1e8,ce=+se[W+32>>3]/1e8/1e5,j=ee*ee+q*q,he=+Qn(+j),Ce=le*3,De=ce*5;e:do if(he!=0)for(O=1,J=he;;){if(Wn=J-(J*(1-le*j-j*(ce*j))-he)/(1-Ce*j-j*(De*j)),ee=ee*Wn/J,q=q*Wn/J,(O|0)==3)break e;if(j=ee*ee+q*q,J=+Qn(+j),J==0){ee=0,q=0;break}else O=O+1|0}else ee=0,q=0;while(!1);O=W+16|0,se[X>>3]=ee/+se[O>>3]+We,se[G>>3]=q/+se[O>>3]+ +se[Qe>>3],O=0;break}case 1:{Ce=+se[W>>3],ee=q-Ce,Qe=W+8|0,q=j-+se[Qe>>3],le=+se[W+24>>3]/1e8,j=ee*ee+q*q,ce=+Qn(+j),he=le*3;e:do if(ce!=0)for(O=1,J=ce;;){if(Wn=J-(J*(1-le*j)-ce)/(1-he*j),ee=ee*Wn/J,q=q*Wn/J,(O|0)==3)break e;if(j=ee*ee+q*q,J=+Qn(+j),J==0){ee=0,q=0;break}else O=O+1|0}else ee=0,q=0;while(!1);O=W+16|0,se[X>>3]=ee/+se[O>>3]+Ce,se[G>>3]=q/+se[O>>3]+ +se[Qe>>3],O=0;break}default:O=-1}return O|0}function eh(W,q,j,X,G,O){W=W|0,q=+q,j=+j,X=X|0,G=G|0,O=O|0;var ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0;switch(O|0){case 4:{le=+se[W+16>>3],ce=+se[W+24>>3],De=+se[W+32>>3],he=+se[W+40>>3],Qe=+se[W+48>>3],Ce=+se[W+56>>3],J=+se[W+64>>3],q=(q-Qe)*J/De,J=(j-Ce)*J/he,ee=q*q+J*J,j=+se[W>>3]*ee+1+ee*(+se[W+8>>3]*ee),se[X>>3]=Qe+De*(ce*(q*(q*2)+ee)+(le*2*q*J+q*j)),se[G>>3]=Ce+he*(ce*2*q*J+(le*(ee+J*(J*2))+J*j)),O=0;break}case 3:{J=+se[W>>3],Qe=+se[W+16>>3],ee=(q-J)*Qe,O=W+8|0,q=Qe*(j-+se[O>>3]),ee==0&q==0?(se[X>>3]=J,q=+se[O>>3]):(Qe=ee*ee+q*q,Qe=1-Qe*(+se[W+32>>3]/1e8)-Qe*(Qe*(+se[W+40>>3]/1e8/1e5)),se[X>>3]=J+ +se[W+24>>3]*(ee*Qe),q=+se[O>>3]+q*Qe),se[G>>3]=q,O=0;break}case 2:{J=+se[W>>3],Qe=+se[W+16>>3],ee=(q-J)*Qe,O=W+8|0,q=Qe*(j-+se[O>>3]),ee==0&q==0?(se[X>>3]=J,q=+se[O>>3]):(Qe=ee*ee+q*q,Qe=1-Qe*(+se[W+24>>3]/1e8)-Qe*(Qe*(+se[W+32>>3]/1e8/1e5)),se[X>>3]=J+ee*Qe,q=+se[O>>3]+q*Qe),se[G>>3]=q,O=0;break}case 1:{J=+se[W>>3],Qe=+se[W+16>>3],ee=(q-J)*Qe,O=W+8|0,q=Qe*(j-+se[O>>3]),ee==0&q==0?(se[X>>3]=J,q=+se[O>>3]):(Qe=1-(ee*ee+q*q)*(+se[W+24>>3]/1e8),se[X>>3]=J+ee*Qe,q=+se[O>>3]+q*Qe),se[G>>3]=q,O=0;break}default:O=-1}return O|0}function Qh(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0;pt=me,me=me+256|0,he=pt+232|0,ce=pt+224|0,le=pt+216|0,J=pt+208|0,ee=pt+200|0,O=pt+192|0,G=pt+184|0,De=pt+240|0,Qe=pt;do if((W|0)!=0&(q|0)>0&(j|0)!=0){if(We=va(W,4854)|0,!We){We=Is()|0,F[G>>2]=F[We>>2],F[G+4>>2]=W,Jn(3,4857,G),W=aa(F[We>>2]|0)|0,F[O>>2]=5367,F[O+4>>2]=W,Jn(3,5361,O),W=-1;break}eu(We,0,2)|0;e:do if(Xo(We)|0)W=Is()|0,F[ee>>2]=F[W>>2],Jn(3,4926,ee),W=aa(F[W>>2]|0)|0,F[J>>2]=5367,F[J+4>>2]=W,Jn(3,5361,J),W=-1;else{O=qu(We)|0,uo(We),W=0;do{if((W|0)>=4){Ce=9;break}G=F[2012+(W<<3)+4>>2]|0,W=W+1|0}while((O|0)%(G|0)|0|0);do if((Ce|0)==9)if((W|0)==4){Jn(3,4971,le),W=-1;break e}else{G=F[504]|0,W=0;break}while(!1);if((Ac(Qe,G,1,We)|0)!=1){W=Is()|0,F[ce>>2]=F[W>>2],Jn(3,5051,ce),W=aa(F[W>>2]|0)|0,F[he>>2]=5367,F[he+4>>2]=W,Jn(3,5361,he),W=-1;break}if(le=Qe+176|0,F[le>>2]=W,Hh(Qe),ce=(W|0)==1,he=Qe+120|0,ce?(rt=+se[he>>3],J=Qe+128|0,se[he>>3]=+se[J>>3],se[J>>3]=rt):J=Qe+128|0,Ko(j|0,Qe|0,184)|0,F[De>>2]=X,G=j+176|0,(q|0)>1)for(ee=1;;){if(X=(F[De>>2]|0)+3&-4,O=F[X>>2]|0,F[De>>2]=X+4,F[O+176>>2]=F[G>>2],(Ac(Qe,F[2012+((F[G>>2]|0)+-1<<3)+4>>2]|0,1,We)|0)!=1){W=-1;break e}if(F[le>>2]=W,Hh(Qe),ce&&(rt=+se[he>>3],se[he>>3]=+se[J>>3],se[J>>3]=rt),Ko(O|0,Qe|0,184)|0,ee=ee+1|0,(ee|0)>=(q|0)){W=0;break}}else W=0}while(!1);W0(We)|0}else W=-1;while(!1);return me=pt,W|0}function Hh(W){W=W|0;var q=0,j=0,X=0,G=0,O=0;O=me,me=me+192|0,G=O,k0(W,G),k0(W+4|0,G+4|0),q=0;do Pc(W+8+(q<<5)|0,G+8+(q<<5)|0),Pc(W+8+(q<<5)+8|0,G+8+(q<<5)+8|0),Pc(W+8+(q<<5)+16|0,G+8+(q<<5)+16|0),Pc(W+8+(q<<5)+24|0,G+8+(q<<5)+24|0),q=q+1|0;while((q|0)!=3);j=W+176|0,X=0;do Pc(W+104+(X<<3)|0,G+104+(X<<3)|0),X=X+1|0,q=F[j>>2]|0;while((X|0)<(F[2012+(q+-1<<3)>>2]|0));F[G+176>>2]=q,Ko(W|0,G|0,184)|0,me=O}function Pc(W,q){W=W|0,q=q|0,ie[q>>0]=ie[W+7>>0]|0,ie[q+1>>0]=ie[W+6>>0]|0,ie[q+2>>0]=ie[W+5>>0]|0,ie[q+3>>0]=ie[W+4>>0]|0,ie[q+4>>0]=ie[W+3>>0]|0,ie[q+5>>0]=ie[W+2>>0]|0,ie[q+6>>0]=ie[W+1>>0]|0,ie[q+7>>0]=ie[W>>0]|0}function k0(W,q){W=W|0,q=q|0,ie[q>>0]=ie[W+3>>0]|0,ie[q+1>>0]=ie[W+2>>0]|0,ie[q+2>>0]=ie[W+1>>0]|0,ie[q+3>>0]=ie[W>>0]|0}function Kl(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0;if(lt=me,me=me+64|0,pt=lt+24|0,rt=lt+16|0,qe=lt+8|0,Je=lt,De=$i(208)|0,De||(Jn(3,5472,lt+32|0),zt(1)),Ko(De|0,W|0,184)|0,We=q<<1,Qe=(F[W>>2]|0)+We|0,F[De+192>>2]=Qe,We=(F[W+4>>2]|0)+We|0,F[De+196>>2]=We,F[De+200>>2]=q,F[De+204>>2]=q,j=kt(Qe<<3,We)|0,X=$i(j)|0,F[De+184>>2]=X,X||(Jn(3,5472,lt+40|0),zt(1)),j=$i(j)|0,F[De+188>>2]=j,j||(Jn(3,5472,lt+48|0),zt(1)),Ce=W+104|0,le=F[W+176>>2]|0,ce=(Qe|0)>0?Qe<<1:0,(We|0)>0)for(he=(Qe|0)>0,J=0;;){if(G=+(J-q|0),he)for(W=0,O=X,ee=j;Et=+(W-q|0),eh(Ce,Et,G,qe,Je,le)|0,ve[O>>2]=+se[qe>>3],ve[O+4>>2]=+se[Je>>3],sa(Ce,Et,G,pt,rt,le)|0,ve[ee>>2]=+se[pt>>3],ve[ee+4>>2]=+se[rt>>3],W=W+1|0,!((W|0)>=(Qe|0));)O=O+8|0,ee=ee+8|0;if(j=j+(ce<<2)|0,J=J+1|0,(J|0)>=(We|0))break;X=X+(ce<<2)|0}return me=lt,De|0}function Ro(W){W=W|0;var q=0;return W|0&&(q=F[W>>2]|0,(q|0)!=0)?(Mr(F[q+184>>2]|0),Mr(F[(F[W>>2]|0)+188>>2]|0),Mr(F[W>>2]|0),F[W>>2]=0,q=0):q=-1,q|0}function Ks(W,q,j,X,G){W=W|0,q=+q,j=+j,X=X|0,G=G|0;var O=0,ee=0,J=0;return ee=(F[W+16>>2]|0)+~~(q+.5)|0,O=(F[W+20>>2]|0)+~~(j+.5)|0,(ee|0)>=0&&(J=F[W+8>>2]|0,!((O|0)<0|(ee|0)>=(J|0)))&&(O|0)<(F[W+12>>2]|0)?(W=F[W>>2]|0,O=(kt(J,O)|0)+ee<<1,F[X>>2]=F[W+(O<<2)>>2],F[G>>2]=F[W+((O|1)<<2)>>2],O=0):O=-1,O|0}function Ma(W,q,j,X,G){W=W|0,q=+q,j=+j,X=X|0,G=G|0;var O=0,ee=0,J=0;return ee=(F[W+16>>2]|0)+~~(q+.5)|0,O=(F[W+20>>2]|0)+~~(j+.5)|0,(ee|0)>=0&&(J=F[W+8>>2]|0,!((O|0)<0|(ee|0)>=(J|0)))&&(O|0)<(F[W+12>>2]|0)?(W=F[W+4>>2]|0,O=(kt(J,O)|0)+ee<<1,F[X>>2]=F[W+(O<<2)>>2],F[G>>2]=F[W+((O|1)<<2)>>2],O=0):O=-1,O|0}function jo(W){W=W|0;var q=0,j=0;q=$i(8)|0;do if(q)if(j=$i(W<<3)|0,F[q>>2]=j,j){F[q+4>>2]=W;break}else{Mr(q),q=0;break}else q=0;while(!1);return q|0}function b0(W){return W=W|0,Mr(F[W>>2]|0),Mr(W),0}function Yl(W){W=W|0;var q=0,j=0,X=0,G=0,O=0;if(q=+Qn(+ +Vh(W,W)),q!=0&&(G=F[W>>2]|0,X=+se[G>>3],q=X<0?-q:q,X=X+q,se[G>>3]=X,X=1/+Qn(+(X*q)),W=F[W+4>>2]|0,(W|0)>0)){j=0;do O=G+(j<<3)|0,se[O>>3]=X*+se[O>>3],j=j+1|0;while((j|0)<(W|0))}return+-q}function Vh(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;if(G=F[W+4>>2]|0,(G|0)!=(F[q+4>>2]|0)&&zt(0),(G|0)>0){X=F[W>>2]|0,W=F[q>>2]|0,q=0,j=0;do j=j+ +se[X+(q<<3)>>3]*+se[W+(q<<3)>>3],q=q+1|0;while((q|0)<(G|0))}else j=0;return+j}function ba(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0;if(Wn=me,me=me+16|0,Bn=Wn+8|0,Gn=Wn,lt=F[W+8>>2]|0,(lt|0)==(F[W+4>>2]|0)&&(lt|0)==(F[q+4>>2]|0)&&(lt|0)==((F[j+4>>2]|0)+1|0)){if(je=lt+-2|0,Ye=Bn+4|0,Qt=Gn+4|0,(lt|0)>2){pt=lt+-1|0,rt=0;do if(Ce=kt(rt,lt)|0,De=F[W>>2]|0,se[(F[q>>2]|0)+(rt<<3)>>3]=+se[De+(Ce+rt<<3)>>3],J=lt-rt+-1|0,F[Ye>>2]=J,qe=rt,rt=rt+1|0,le=De+(Ce+rt<<3)|0,F[Bn>>2]=le,We=+Yl(Bn),se[(F[j>>2]|0)+(qe<<3)>>3]=We,We!=0){if((rt|0)<(lt|0)){ce=F[q>>2]|0,he=rt;do{if((rt|0)<(he|0)){X=F[W>>2]|0,G=rt,ee=0;do We=+se[X+((kt(G,lt)|0)+he<<3)>>3],ee=ee+We*+se[De+(G+Ce<<3)>>3],G=G+1|0;while((G|0)<(he|0))}else ee=0;if(X=kt(he,lt)|0,(he|0)<(lt|0)){G=F[W>>2]|0,O=he;do ee=ee+ +se[G+(O+X<<3)>>3]*+se[De+(O+Ce<<3)>>3],O=O+1|0;while((O|0)<(lt|0))}se[ce+(he<<3)>>3]=ee,he=he+1|0}while((he|0)<(lt|0))}if(F[Qt>>2]=J,F[Ye>>2]=J,F[Bn>>2]=le,F[Gn>>2]=(F[q>>2]|0)+(rt<<3),ee=+Vh(Bn,Gn)*.5,(pt|0)>(qe|0)){X=F[q>>2]|0,J=pt;do{if(Qe=+se[De+(J+Ce<<3)>>3],G=X+(J<<3)|0,We=+se[G>>3]-ee*Qe,se[G>>3]=We,G=kt(J,lt)|0,(J|0)<(lt|0)){O=F[W>>2]|0,le=J;do he=O+(le+G<<3)|0,se[he>>3]=+se[he>>3]-(Qe*+se[X+(le<<3)>>3]+We*+se[De+(le+Ce<<3)>>3]),le=le+1|0;while((le|0)<(lt|0))}J=J+-1|0}while((J|0)>(qe|0))}}while((rt|0)<(je|0))}if((lt|0)<=1?(lt|0)>0&&(G=0,O=F[W>>2]|0,X=F[q>>2]|0,Je=27):(Je=kt(je,lt)|0,O=F[W>>2]|0,X=F[q>>2]|0,se[X+(je<<3)>>3]=+se[O+(Je+je<<3)>>3],G=lt+-1|0,se[(F[j>>2]|0)+(je<<3)>>3]=+se[O+(G+Je<<3)>>3],Je=27),(Je|0)==27&&(se[X+(G<<3)>>3]=+se[O+((kt(G,lt)|0)+G<<3)>>3]),(lt|0)>0){ce=(lt|0)>0,De=lt;do{if(j=De,De=De+-1|0,he=kt(De,lt)|0,Ce=F[W>>2]|0,(j|0)<=(je|0)&&(Et=lt-De+-1|0,At=Ce+(he+j<<3)|0,(j|0)<(lt|0))){X=(j|0)<(lt|0),J=j;do{if(F[Qt>>2]=Et,F[Ye>>2]=Et,F[Bn>>2]=At,G=kt(J,lt)|0,F[Gn>>2]=(F[W>>2]|0)+(G+j<<3),ee=+Vh(Bn,Gn),X){O=F[W>>2]|0,le=j;do Je=O+(le+G<<3)|0,se[Je>>3]=+se[Je>>3]-ee*+se[Ce+(le+he<<3)>>3],le=le+1|0;while((le|0)<(lt|0))}J=J+1|0}while((J|0)<(lt|0))}if(ce){X=0;do se[Ce+(X+he<<3)>>3]=0,X=X+1|0;while((X|0)<(lt|0))}se[Ce+(he+De<<3)>>3]=1}while((j|0)>1);X=0}else X=0}else X=-1;return me=Wn,X|0}function th(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0;return O=+se[j>>3],ee=+se[j+8>>3],G=+se[j+16>>3],X=+se[q+88>>3]+(O*+se[q+64>>3]+ee*+se[q+72>>3]+G*+se[q+80>>3]),X==0?j=-1:(J=+se[q+56>>3]+(O*+se[q+32>>3]+ee*+se[q+40>>3]+G*+se[q+48>>3]),se[W>>3]=(+se[q+24>>3]+(O*+se[q>>3]+ee*+se[q+8>>3]+G*+se[q+16>>3]))/X,se[W+8>>3]=J/X,j=0),j|0}function Su(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0;Qt=me,me=me+1072|0,At=Qt+1056|0,Et=Qt+768|0,lt=Qt+192|0,Ye=Qt+48|0,je=Qt,tr=+se[j>>3],ei=+se[X>>3],pt=tr*ei,Gi=+se[j+8>>3],rt=X+8|0,Wn=+se[rt>>3],Je=Gi*Wn,ee=+se[j+16>>3],Pn=+se[X+16>>3],le=ee*Pn,ce=+se[j+24>>3],mi=+se[j+32>>3],Yi=+se[j+40>>3],he=Wn*Yi,J=+se[j+48>>3],Ce=Pn*J,De=+se[j+56>>3],Gn=+se[j+64>>3],Bn=+se[j+72>>3],Qe=Wn*Bn,G=+se[j+80>>3],We=Pn*G,O=+se[j+88>>3],se[Et>>3]=pt,se[Et+8>>3]=tr*Wn,se[Et+16>>3]=tr*Pn,se[Et+24>>3]=ei*Gi,se[Et+32>>3]=Je,se[Et+40>>3]=Pn*Gi,se[Et+48>>3]=ei*ee,se[Et+56>>3]=Wn*ee,se[Et+64>>3]=le,se[Et+72>>3]=tr,se[Et+80>>3]=Gi,se[Et+88>>3]=ee,ee=ei*mi,se[Et+96>>3]=ee,se[Et+104>>3]=Wn*mi,se[Et+112>>3]=Pn*mi,se[Et+120>>3]=ei*Yi,se[Et+128>>3]=he,se[Et+136>>3]=Pn*Yi,se[Et+144>>3]=ei*J,se[Et+152>>3]=Wn*J,se[Et+160>>3]=Ce,se[Et+168>>3]=mi,se[Et+176>>3]=Yi,se[Et+184>>3]=J,J=Gn*ei,se[Et+192>>3]=J,se[Et+200>>3]=Wn*Gn,se[Et+208>>3]=Pn*Gn,se[Et+216>>3]=ei*Bn,Wn=+se[rt>>3],se[Et+224>>3]=Bn*Wn,se[Et+232>>3]=Pn*Bn,se[Et+240>>3]=ei*G,se[Et+248>>3]=Wn*G,se[Et+256>>3]=We,se[Et+264>>3]=Gn,se[Et+272>>3]=Bn,se[Et+280>>3]=G,X=lt+64|0,j=lt,rt=j+64|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=-1,X=lt+72|0,F[X>>2]=0,F[X+4>>2]=0,F[X+8>>2]=0,F[X+12>>2]=0,F[X+16>>2]=0,F[X+20>>2]=0,F[X+24>>2]=0,F[X+28>>2]=0,se[lt+104>>3]=1,X=lt+160|0,j=lt+112|0,rt=j+48|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=1,X=lt+240|0,j=lt+168|0,rt=j+72|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=-1,X=lt+296|0,j=lt+248|0,rt=j+48|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=-1,X=lt+304|0,F[X>>2]=0,F[X+4>>2]=0,F[X+8>>2]=0,F[X+12>>2]=0,F[X+16>>2]=0,F[X+20>>2]=0,F[X+24>>2]=0,F[X+28>>2]=0,se[lt+336>>3]=1,X=lt+456|0,j=lt+344|0,rt=j+112|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=1,X=lt+512|0,j=lt+464|0,rt=j+48|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=1,X=lt+568|0,j=lt+520|0,rt=j+48|0;do F[j>>2]=0,j=j+4|0;while((j|0)<(rt|0));se[X>>3]=1,qe=0;do{rt=0;do{j=Ye+(qe*48|0)+(rt<<3)|0,se[j>>3]=0,G=0,X=0;do G=G+ +se[Et+(qe*96|0)+(X<<3)>>3]*+se[lt+(X*48|0)+(rt<<3)>>3],X=X+1|0;while((X|0)!=12);se[j>>3]=G,rt=rt+1|0}while((rt|0)!=6);qe=qe+1|0}while((qe|0)!=3);if(Gi=ce+(pt+Je+le),tr=De+(ee+he+Ce),G=O+(J+Qe+We),O=+se[q>>3],ee=+se[q+8>>3],J=+se[q+16>>3],le=+se[q+24>>3]+(Gi*O+tr*ee+G*J),ce=+se[q+32>>3],he=+se[q+40>>3],Ce=+se[q+48>>3],De=+se[q+56>>3]+(Gi*ce+tr*he+G*Ce),Qe=+se[q+64>>3],We=+se[q+72>>3],pt=+se[q+80>>3],G=+se[q+88>>3]+(Gi*Qe+tr*We+G*pt),G==0)Jn(3,5089,At),X=-1;else{tr=G*G,se[je>>3]=(O*G-le*Qe)/tr,se[je+8>>3]=(G*ee-le*We)/tr,se[je+16>>3]=(G*J-le*pt)/tr,se[je+24>>3]=(G*ce-De*Qe)/tr,se[je+32>>3]=(G*he-De*We)/tr,se[je+40>>3]=(G*Ce-De*pt)/tr,j=0;do{G=+se[je+(j*24|0)>>3],O=+se[je+(j*24|0)+8>>3],ee=+se[je+(j*24|0)+16>>3],X=0;do At=W+(j*48|0)+(X<<3)|0,se[At>>3]=0,tr=G*+se[Ye+(X<<3)>>3]+0,se[At>>3]=tr,tr=tr+O*+se[Ye+48+(X<<3)>>3],se[At>>3]=tr,se[At>>3]=tr+ee*+se[Ye+96+(X<<3)>>3],X=X+1|0;while((X|0)!=6);j=j+1|0}while((j|0)!=2);X=0}return me=Qt,X|0}function zh(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0;J=me,me=me+48|0,ee=J+24|0,O=J+12|0,G=J,F[ee+4>>2]=6,F[ee+8>>2]=1,F[ee>>2]=W,F[O+4>>2]=X,F[O+8>>2]=1,F[O>>2]=q,F[G+4>>2]=X,F[G+8>>2]=6,F[G>>2]=j,q=Gh(G)|0;do if(q){if(W=Ec(q,G)|0,!W){es(q)|0,j=-1;break}if(j=Ec(q,O)|0,!j){es(q)|0,es(W)|0,j=-1;break}if((yc(W)|0)<0){es(q)|0,es(W)|0,es(j)|0,j=-1;break}else{Xl(ee,W,j)|0,es(q)|0,es(W)|0,es(j)|0,j=0;break}}else j=-1;while(!1);return me=J,j|0}function vl(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0;Ce=me,me=me+192|0,ce=Ce+96|0,he=Ce,ee=+se[q>>3],le=+se[q+8>>3],X=+se[q+16>>3],j=ee*ee+le*le+X*X,j==0?(J=0,G=0,X=1,j=0):(j=+Qn(+j),J=j,G=X/j,X=ee/j,j=le/j),Je=+se[q+24>>3],pt=+se[q+32>>3],le=+se[q+40>>3],De=+hi(+J),ee=1-De,J=+Qi(+J),se[ce>>3]=De+X*X*ee,qe=j*X*ee,rt=G*J,se[ce+8>>3]=qe-rt,We=X*G*ee,Qe=j*J,se[ce+16>>3]=We+Qe,se[ce+24>>3]=Je,se[ce+32>>3]=qe+rt,se[ce+40>>3]=De+j*j*ee,j=j*G*ee,J=X*J,se[ce+48>>3]=j-J,se[ce+56>>3]=pt,se[ce+64>>3]=We-Qe,se[ce+72>>3]=j+J,se[ce+80>>3]=De+G*G*ee,se[ce+88>>3]=le,O=0;do{j=+se[W+(O<<5)>>3],X=+se[W+(O<<5)+8>>3],G=+se[W+(O<<5)+16>>3],q=0;do se[he+(O<<5)+(q<<3)>>3]=j*+se[ce+(q<<3)>>3]+X*+se[ce+32+(q<<3)>>3]+G*+se[ce+64+(q<<3)>>3],q=q+1|0;while((q|0)!=4);q=he+(O<<5)+24|0,se[q>>3]=+se[W+(O<<5)+24>>3]+ +se[q>>3],O=O+1|0}while((O|0)!=3);q=0;do se[W+(q<<5)>>3]=+se[he+(q<<5)>>3],se[W+(q<<5)+8>>3]=+se[he+(q<<5)+8>>3],se[W+(q<<5)+16>>3]=+se[he+(q<<5)+16>>3],se[W+(q<<5)+24>>3]=+se[he+(q<<5)+24>>3],q=q+1|0;while((q|0)!=3);return me=Ce,0}function ka(W){W=W|0;var q=0,j=0;if(q=$i(136)|0,!q)q=0;else{j=0;do se[q+(j<<5)>>3]=+se[W+(j<<5)>>3],se[q+(j<<5)+8>>3]=+se[W+(j<<5)+8>>3],se[q+(j<<5)+16>>3]=+se[W+(j<<5)+16>>3],se[q+(j<<5)+24>>3]=+se[W+(j<<5)+24>>3],j=j+1|0;while((j|0)!=3);F[q+96>>2]=10,se[q+104>>3]=.10000000149011612,se[q+112>>3]=.9900000095367432,se[q+120>>3]=4,se[q+128>>3]=.5}return q|0}function El(W){W=W|0;var q=0;return q=F[W>>2]|0,q?(Mr(q),F[W>>2]=0,q=0):q=-1,q|0}function X0(W,q){return W=W|0,q=+q,W?(se[W+128>>3]=q,W=0):W=-1,W|0}function Cc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0;At=me,me=me+176|0,le=At+168|0,J=At+160|0,qe=At+48|0,lt=At+64|0,Je=At,pt=q+8|0,O=F[pt>>2]|0;do if((O|0)>=3){if(Et=$i(O*96|0)|0,!Et){Jn(3,5109,J),O=-1;break}if(rt=$i(O<<4)|0,rt)O=0;else{Jn(3,5109,le),Mr(Et),O=-1;break}do se[X+(O<<5)>>3]=+se[j+(O<<5)>>3],se[X+(O<<5)+8>>3]=+se[j+(O<<5)+8>>3],se[X+(O<<5)+16>>3]=+se[j+(O<<5)+16>>3],se[X+(O<<5)+24>>3]=+se[j+(O<<5)+24>>3],O=O+1|0;while((O|0)!=3);Qe=q+4|0,le=qe+8|0,j=W+104|0,he=W+120|0,Ce=W+112|0,De=W+96|0,ce=0,We=0;e:for(;;){if($l(W,X,lt)|0,O=F[pt>>2]|0,(O|0)>0){ee=0,J=0;do{if((th(qe,lt,(F[Qe>>2]|0)+(J*24|0)|0)|0)<0){J=10;break e}O=F[q>>2]|0,Ye=+se[O+(J<<4)>>3]-+se[qe>>3],je=+se[O+(J<<4)+8>>3]-+se[le>>3],ee=ee+(Ye*Ye+je*je),O=J<<1,se[rt+(O<<3)>>3]=Ye,se[rt+((O|1)<<3)>>3]=je,J=J+1|0,O=F[pt>>2]|0}while((J|0)<(O|0))}else ee=0;if(ee=ee/+(O|0),ee<+se[j>>3]){J=24;break}if((We|0)>0&&ee<+se[he>>3]&&ee/ce>+se[Ce>>3]){J=24;break}if((We|0)==(F[De>>2]|0)){J=24;break}if((O|0)>0){J=0;do{if((Su(Et+(J*12<<3)|0,W,X,(F[Qe>>2]|0)+(J*24|0)|0)|0)<0){J=20;break e}J=J+1|0,O=F[pt>>2]|0}while((J|0)<(O|0))}if((zh(Je,rt,Et,O<<1)|0)<0){J=22;break}vl(X,Je)|0,ce=ee,We=We+1|0}if((J|0)==10){Mu(Et,rt),O=-1;break}else if((J|0)==20){Mu(Et,rt),O=-1;break}else if((J|0)==22){Mu(Et,rt),O=-1;break}else if((J|0)==24){se[G>>3]=ee,Mr(Et),Mr(rt),O=0;break}}else O=-1;while(!1);return me=At,O|0}function Mu(W,q){W=W|0,q=q|0,Mr(W),Mr(q)}function G1(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0;Pn=me,me=me+192|0,he=Pn+184|0,ce=Pn+176|0,le=Pn+168|0,O=Pn+160|0,Qt=Pn+48|0,Gn=Pn+64|0,Bn=Pn,Ye=q+8|0,J=F[Ye>>2]|0;do if((J|0)>=4){if(Ce=~~(+(J|0)*+se[W+128>>3])+-1|0,Ce=(Ce|0)<3?3:Ce,ei=$i(J*96|0)|0,!ei){Jn(3,5109,O),O=-1;break}if(Wn=$i(J<<4)|0,!Wn){Jn(3,5109,le),Mr(ei),O=-1;break}if(O=J<<3,je=$i(O)|0,!je){Jn(3,5109,ce),Mr(ei),Mr(Wn),O=-1;break}if(At=$i(O)|0,At)O=0;else{Jn(3,5109,he),Mr(ei),Mr(Wn),Mr(je),O=-1;break}do se[X+(O<<5)>>3]=+se[j+(O<<5)>>3],se[X+(O<<5)+8>>3]=+se[j+(O<<5)+8>>3],se[X+(O<<5)+16>>3]=+se[j+(O<<5)+16>>3],se[X+(O<<5)+24>>3]=+se[j+(O<<5)+24>>3],O=O+1|0;while((O|0)!=3);lt=q+4|0,Et=Qt+8|0,he=At+(Ce<<3)|0,j=W+104|0,Ce=W+120|0,rt=W+112|0,qe=W+96|0,We=0,Je=0;e:for(;;){if($l(W,X,Gn)|0,O=F[Ye>>2]|0,(O|0)>0){J=0;do{if((th(Qt,Gn,(F[lt>>2]|0)+(J*24|0)|0)|0)<0){J=14;break e}O=F[q>>2]|0,Qe=+se[O+(J<<4)>>3]-+se[Qt>>3],pt=+se[O+(J<<4)+8>>3]-+se[Et>>3],O=J<<1,se[Wn+(O<<3)>>3]=Qe,se[Wn+((O|1)<<3)>>3]=pt,pt=Qe*Qe+pt*pt,se[At+(J<<3)>>3]=pt,se[je+(J<<3)>>3]=pt,J=J+1|0,O=F[Ye>>2]|0}while((J|0)<(O|0))}if(Eu(At,O,8,1),pt=+se[he>>3]*4,pt=pt<16?16:pt,J=F[Ye>>2]|0,Qe=pt/6,(J|0)>0){ee=0,O=0;do De=+se[At+(O<<3)>>3],De>pt?De=Qe:(De=1-De/pt,De=Qe*(1-De*(De*De))),ee=ee+De,O=O+1|0;while((O|0)<(J|0))}else ee=0;if(ee=ee/+(J|0),ee<+se[j>>3]){J=36;break}if((Je|0)>0&&ee<+se[Ce>>3]&&ee/We>+se[rt>>3]){J=36;break}if((Je|0)==(F[qe>>2]|0)){J=36;break}if((J|0)>0){ce=0,O=0;do{if(De=+se[je+(ce<<3)>>3],De<=pt){if(J=O*6|0,le=ei+(J<<3)|0,(Su(le,W,X,(F[lt>>2]|0)+(ce*24|0)|0)|0)<0){J=28;break e}We=1-De/pt,We=We*We,se[le>>3]=+se[le>>3]*We,le=ei+((J|1)<<3)|0,se[le>>3]=+se[le>>3]*We,le=ei+(J+2<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+3<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+4<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+5<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+6<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+7<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+8<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+9<<3)|0,se[le>>3]=We*+se[le>>3],le=ei+(J+10<<3)|0,se[le>>3]=We*+se[le>>3],J=ei+(J+11<<3)|0,se[J>>3]=We*+se[J>>3],J=ce<<1,se[Wn+(O<<3)>>3]=We*+se[Wn+(J<<3)>>3],se[Wn+(O+1<<3)>>3]=We*+se[Wn+((J|1)<<3)>>3],J=F[Ye>>2]|0,O=O+2|0}ce=ce+1|0}while((ce|0)<(J|0))}else O=0;if((O|0)<6){J=32;break}if((zh(Bn,Wn,ei,O)|0)<0){J=34;break}vl(X,Bn)|0,We=ee,Je=Je+1|0}if((J|0)==14){ql(ei,Wn,je,At),O=-1;break}else if((J|0)==28){ql(ei,Wn,je,At),O=-1;break}else if((J|0)==32){ql(ei,Wn,je,At),O=-1;break}else if((J|0)==34){ql(ei,Wn,je,At),O=-1;break}else if((J|0)==36){se[G>>3]=ee,Mr(ei),Mr(Wn),Mr(je),Mr(At),O=0;break}}else O=-1;while(!1);return me=Pn,O|0}function ql(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0,Mr(W),Mr(q),Mr(j),Mr(X)}function Q1(W,q){W=W|0,q=q|0;var j=0;return j=+se[W>>3]-+se[q>>3],(j<0?-1:j>0&1)|0}function H1(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0,jr=0,wr=0,ks=0,ho=0,zs=0,Fi=0,ar=0,Cr=0,no=0,ms=0;zs=me,me=me+64|0,Gn=zs+48|0,je=zs+40|0,At=zs+32|0,Et=zs+24|0,qe=zs+16|0,Ce=zs+8|0,le=zs;e:do if((X|0)>=4){for(O=0;!((O|0)>=(X|0));)if(+se[j+(O*24|0)+16>>3]!=0){O=-1;break e}else O=O+1|0;if(+se[W>>3]!=0&&+se[W+32>>3]==0&&(Qt=W+40|0,+se[Qt>>3]!=0)&&+se[W+64>>3]==0&&+se[W+72>>3]==0&&+se[W+80>>3]==1&&+se[W+24>>3]==0&&+se[W+56>>3]==0&&+se[W+88>>3]==0){if(O=X<<1,Bn=Ja(O,8)|0,!Bn){Jn(3,5124,le),O=-1;break}if(lt=Ja(O,1)|0,!lt){es(Bn)|0,Jn(3,5150,Ce),O=-1;break}if(X){O=F[Bn>>2]|0,le=F[lt>>2]|0,Ce=0;do ms=j+(Ce*24|0)|0,Fi=Ce<<4,se[O+(Fi<<3)>>3]=+se[ms>>3],no=j+(Ce*24|0)+8|0,se[O+((Fi|1)<<3)>>3]=+se[no>>3],se[O+((Fi|2)<<3)>>3]=1,se[O+((Fi|3)<<3)>>3]=0,se[O+((Fi|4)<<3)>>3]=0,se[O+((Fi|5)<<3)>>3]=0,Cr=q+(Ce<<4)|0,se[O+((Fi|6)<<3)>>3]=-(+se[ms>>3]*+se[Cr>>3]),se[O+((Fi|7)<<3)>>3]=-(+se[no>>3]*+se[Cr>>3]),se[O+((Fi|8)<<3)>>3]=0,se[O+((Fi|9)<<3)>>3]=0,se[O+((Fi|10)<<3)>>3]=0,se[O+((Fi|11)<<3)>>3]=+se[ms>>3],se[O+((Fi|12)<<3)>>3]=+se[no>>3],se[O+((Fi|13)<<3)>>3]=1,ar=q+(Ce<<4)+8|0,se[O+((Fi|14)<<3)>>3]=-(+se[ms>>3]*+se[ar>>3]),se[O+((Fi|15)<<3)>>3]=-(+se[no>>3]*+se[ar>>3]),Fi=Ce<<1,se[le+(Fi<<3)>>3]=+se[Cr>>3],se[le+((Fi|1)<<3)>>3]=+se[ar>>3],Ce=Ce+1|0;while((Ce|0)!=(X|0))}if(X=Gh(Bn)|0,!X){es(Bn)|0,es(lt)|0,Jn(3,5176,qe),O=-1;break}if(Ce=Ec(X,Bn)|0,!Ce){es(Bn)|0,es(lt)|0,es(X)|0,Jn(3,5202,Et),O=-1;break}if(le=Ec(X,lt)|0,!le){es(Bn)|0,es(lt)|0,es(X)|0,es(Ce)|0,Jn(3,5228,At),O=-1;break}if((yc(Ce)|0)<0){es(Bn)|0,es(lt)|0,es(X)|0,es(Ce)|0,es(le)|0,Jn(3,5254,je),O=-1;break}if(O=Ec(Ce,le)|0,!O){es(Bn)|0,es(lt)|0,es(X)|0,es(Ce)|0,es(le)|0,Jn(3,5280,Gn),O=-1;break}ms=F[O>>2]|0,De=+se[ms+48>>3],ks=+se[W+48>>3],rt=+se[Qt>>3],ee=(+se[ms+24>>3]-De*ks)/rt,pt=+se[W+16>>3],ho=+se[W+8>>3],We=+se[W>>3],Qe=(+se[ms>>3]-De*pt-ee*ho)/We,J=+se[ms+56>>3],ce=(+se[ms+32>>3]-ks*J)/rt,he=(+se[ms+8>>3]-pt*J-ho*ce)/We,rt=(+se[ms+40>>3]-ks)/rt,We=(+se[ms+16>>3]-pt-ho*rt)/We,es(Bn)|0,es(lt)|0,es(X)|0,es(Ce)|0,es(le)|0,es(O)|0,ho=+Qn(+(De*De+(ee*ee+Qe*Qe))),pt=+Qn(+(J*J+(ce*ce+he*he))),Qe=Qe/ho,ee=ee/ho,De=De/ho,he=he/pt,ce=ce/pt,J=J/pt,pt=(ho+pt)*.5,We=We/pt,ho=1/pt,ho<0?(Rn=-ee,J=-J,ce=-ce,De=-De,he=-he,jr=-Qe,ks=-We,wr=-ho):(Rn=ee,jr=Qe,ks=We,wr=rt/pt),ee=J*Rn-ce*De,Qe=he*De-J*jr,We=ce*jr-he*Rn,pt=+Qn(+(We*We+(ee*ee+Qe*Qe)));do if(pt!=0){if(rt=ee/pt,Qe=Qe/pt,ee=We/pt,ci=J*De+(ce*Rn+he*jr),ci=ci<0?-ci:ci,ci=(+Qn(+(ci+1))+ +Qn(+(1-ci)))*.5,jr*Qe-Rn*rt!=0?(O=0,Wn=jr,Je=Rn,ei=De,mi=rt,Yi=Qe):(ms=jr*ee-De*rt!=0,O=ms?1:2,Wn=ms?jr:De,Je=ms?De:Rn,ei=ms?Rn:jr,mi=ms?rt:ee,Yi=ms?ee:Qe,ee=ms?Qe:rt),We=Wn*Yi,pt=Je*mi,Qe=We-pt,Qe==0){Qe=Rn,ee=jr;break}if(Pn=(Je*ee-ei*Yi)/Qe,Ye=ci*Yi/Qe,We=pt-We,Qe=(Wn*ee-ei*mi)/We,We=ci*mi/We,pt=Pn*Pn+Qe*Qe+1,rt=Pn*Ye+Qe*We,Je=rt*rt-pt*(Ye*Ye+We*We+-1),Je<0){Qe=Rn,ee=jr;break}if(wn=+Qn(+Je),Di=(wn-rt)/pt,ei=Ye+Pn*Di,tr=We+Qe*Di,wn=(-rt-wn)/pt,Pn=Ye+Pn*wn,We=We+Qe*wn,ms=(O|0)==1,Qe=ms?Yi:ee,pt=ms?ee:Yi,Gi=ms?Di:tr,Di=ms?tr:Di,tr=ms?wn:We,Yi=ms?We:wn,ms=(O|0)==2&(ms^1),We=ms?mi:Qe,Qe=ms?Qe:mi,wn=ms?Di:ei,Di=ms?ei:Di,ee=ms?Yi:Pn,mi=ms?Pn:Yi,he*pt-ce*Qe!=0?(O=0,Wn=he,Je=ce,ei=J,Yi=Qe,Ye=pt):(ms=he*We-J*Qe!=0,O=ms?1:2,Wn=ms?he:J,Je=ms?J:ce,ei=ms?ce:he,Yi=ms?Qe:We,Ye=ms?We:pt,We=ms?pt:Qe),pt=Wn*Ye,rt=Je*Yi,Qe=pt-rt,Qe==0){Qe=Rn,ee=jr;break}if(Pn=(Je*We-ei*Ye)/Qe,Ye=ci*Ye/Qe,Qe=rt-pt,Je=(Wn*We-ei*Yi)/Qe,Qe=ci*Yi/Qe,We=Pn*Pn+Je*Je+1,pt=Pn*Ye+Je*Qe,rt=pt*pt-We*(Ye*Ye+Qe*Qe+-1),rt<0){Qe=Rn,ee=jr;break}if(rt=+Qn(+rt),J=(rt-pt)/We,jr=Ye+Pn*J,Rn=Qe+Je*J,rt=(-pt-rt)/We,De=Ye+Pn*rt,he=Qe+Je*rt,ms=(O|0)==1,ce=ms?J:Rn,J=ms?Rn:J,Je=ms?rt:he,rt=ms?he:rt,ms=(O|0)==2&(ms^1),he=ms?J:jr,J=ms?jr:J,Ye=ms?rt:De,rt=ms?De:rt,De=Di*J+(Gi*ce+wn*he),De=De<0?-De:De,Qe=Di*rt+(Gi*Je+wn*Ye),Qe=Qe<0?-Qe:Qe,We=mi*J+(tr*ce+ee*he),We=We<0?-We:We,pt=mi*rt+(tr*Je+ee*Ye),pt=pt<0?-pt:pt,De<Qe)if(De<We){if(De<pt){Qe=Gi,De=Di,ee=wn;break}Qe=tr,J=rt,ce=Je,De=mi,he=Ye;break}else{if(We<pt){Qe=tr,De=mi;break}Qe=tr,J=rt,ce=Je,De=mi,he=Ye;break}else if(Qe<We){if(Qe<pt){Qe=Gi,J=rt,ce=Je,De=Di,he=Ye,ee=wn;break}Qe=tr,J=rt,ce=Je,De=mi,he=Ye;break}else{if(We<pt){Qe=tr,De=mi;break}Qe=tr,J=rt,ce=Je,De=mi,he=Ye;break}}else Qe=Rn,ee=jr;while(!1);wn=J*Qe-ce*De,ci=he*De-J*ee,Rn=ce*ee-he*Qe,jr=+Qn(+(Rn*Rn+(wn*wn+ci*ci))),se[G>>3]=ee,se[G+32>>3]=Qe,se[G+64>>3]=De,se[G+8>>3]=he,se[G+40>>3]=ce,se[G+72>>3]=J,se[G+16>>3]=wn/jr,se[G+48>>3]=ci/jr,se[G+80>>3]=Rn/jr,se[G+24>>3]=ks,se[G+56>>3]=wr,se[G+88>>3]=ho,O=0}else O=-1}else O=-1;while(!1);return me=zs,O|0}function V1(W){return W=W|0,Mr(F[W>>2]|0),Mr(W),0}function z1(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,+ +bu(W,q,j,X,0)}function W1(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,+ +bu(W,q,j,X,1)}function bu(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0;if(ei=me,me=me+208|0,je=ei+200|0,At=ei+192|0,Ye=ei+96|0,Qt=ei,Bn=X+4|0,De=F[Bn>>2]|0,Qe=X+112|0,We=X+120|0,(De|0)>0){qe=F[X>>2]|0,Je=(j|0)>0,lt=(j|0)>0,Et=0;do{if(F[qe+(Et*320|0)+4>>2]|0){if(le=qe+(Et*320|0)+312|0,ce=qe+(Et*320|0)|0,lt){Ce=0,ee=-1;do J=F[q+(Ce<<8)+12>>2]|0,!(J|0)&&(rt=q+(Ce<<8)+248|0,pt=F[rt>>2]|0,rt=F[rt+4>>2]|0,!((pt|0)==0&(rt|0)==0))?(J=le,(pt|0)==(F[J>>2]|0)&&(rt|0)==(F[J+4>>2]|0)&&(Wn=20)):(J|0)==(F[ce>>2]|0)&&(Wn=20),(Wn|0)==20&&(Wn=0,O=+se[q+(Ce<<8)+48>>3],O<+se[We>>3]||(ee|0)!=-1&&!(+se[q+(ee<<8)+48>>3]<O)||(ee=Ce)),Ce=Ce+1|0;while((Ce|0)<(j|0))}else ee=-1;F[qe+(Et*320|0)+304>>2]=ee,(ee|0)>-1&&(F[q+(ee<<8)+16>>2]=F[q+(ee<<8)+24>>2])}else{if(Je){J=F[qe+(Et*320|0)>>2]|0,le=0,ee=-1;do(F[q+(le<<8)+8>>2]|0)==(J|0)&&(he=+se[q+(le<<8)+40>>3],!(he<+se[Qe>>3]))&&((ee|0)!=-1&&!(+se[q+(ee<<8)+40>>3]<he)||(ee=le)),le=le+1|0;while((le|0)<(j|0))}else ee=-1;F[qe+(Et*320|0)+304>>2]=ee,(ee|0)>-1&&(F[q+(ee<<8)+16>>2]=F[q+(ee<<8)+20>>2])}Et=Et+1|0}while((Et|0)<(De|0))}if((De|0)>0)for(Qe=0,ee=0,De=0,J=0;;){le=F[X>>2]|0,ce=F[le+(Qe*320|0)+304>>2]|0;do if((ce|0)<0)le=De;else{if(Ce=q+(ce<<8)|0,+nd(W,Ce,+se[le+(Qe*320|0)+8>>3],Qt)>4){if(F[(F[X>>2]|0)+(Qe*320|0)+304>>2]=-1,le=q+(ce<<8)+236|0,F[le>>2]|0){le=De;break}F[le>>2]=7,le=De;break}if(le=F[Ce>>2]|0,(J|0)==0|(De|0)<(le|0)){ee=0;do se[Ye+(ee<<5)>>3]=+se[Qt+(ee<<5)>>3],se[Ye+(ee<<5)+8>>3]=+se[Qt+(ee<<5)+8>>3],se[Ye+(ee<<5)+16>>3]=+se[Qt+(ee<<5)+16>>3],se[Ye+(ee<<5)+24>>3]=+se[Qt+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3);ee=Qe}else le=De;J=J+1|0}while(!1);if(Qe=Qe+1|0,(Qe|0)>=(F[Bn>>2]|0))break;De=le}else ee=0,J=0;do if(J|0&&(J|0)>=(F[X+128>>2]|0)){if($l(Ye,(F[X>>2]|0)+(ee*320|0)+112|0,Qt)|0,De=J<<2,We=$i(J<<6)|0,We||(Jn(3,5472,At),zt(1)),Qe=$i(J*96|0)|0,Qe||(Jn(3,5472,je),zt(1)),le=F[Bn>>2]|0,(le|0)>0){ce=F[X>>2]|0,Ce=0,ee=0;do J=F[ce+(Ce*320|0)+304>>2]|0,(J|0)>=0&&(At=F[q+(J<<8)+16>>2]|0,j=(4-At|0)%4|0,je=ee<<3,se[We+(je<<3)>>3]=+se[q+(J<<8)+168+(j<<4)>>3],se[We+((je|1)<<3)>>3]=+se[q+(J<<8)+168+(j<<4)+8>>3],j=(5-At|0)%4|0,se[We+((je|2)<<3)>>3]=+se[q+(J<<8)+168+(j<<4)>>3],se[We+((je|3)<<3)>>3]=+se[q+(J<<8)+168+(j<<4)+8>>3],j=(6-At|0)%4|0,se[We+((je|4)<<3)>>3]=+se[q+(J<<8)+168+(j<<4)>>3],se[We+((je|5)<<3)>>3]=+se[q+(J<<8)+168+(j<<4)+8>>3],At=(7-At|0)%4|0,se[We+((je|6)<<3)>>3]=+se[q+(J<<8)+168+(At<<4)>>3],se[We+((je|7)<<3)>>3]=+se[q+(J<<8)+168+(At<<4)+8>>3],je=ee*12|0,se[Qe+(je<<3)>>3]=+se[ce+(Ce*320|0)+208>>3],se[Qe+((je|1)<<3)>>3]=+se[ce+(Ce*320|0)+216>>3],se[Qe+((je|2)<<3)>>3]=+se[ce+(Ce*320|0)+224>>3],se[Qe+((je|3)<<3)>>3]=+se[ce+(Ce*320|0)+232>>3],se[Qe+(je+4<<3)>>3]=+se[ce+(Ce*320|0)+240>>3],se[Qe+(je+5<<3)>>3]=+se[ce+(Ce*320|0)+248>>3],se[Qe+(je+6<<3)>>3]=+se[ce+(Ce*320|0)+256>>3],se[Qe+(je+7<<3)>>3]=+se[ce+(Ce*320|0)+264>>3],se[Qe+(je+8<<3)>>3]=+se[ce+(Ce*320|0)+272>>3],se[Qe+(je+9<<3)>>3]=+se[ce+(Ce*320|0)+280>>3],At=F[X>>2]|0,se[Qe+(je+10<<3)>>3]=+se[At+(Ce*320|0)+288>>3],se[Qe+(je+11<<3)>>3]=+se[At+(Ce*320|0)+296>>3],ee=ee+1|0),Ce=Ce+1|0;while((Ce|0)<(le|0))}if(ce=X+104|0,J=(G|0)!=0,!(F[ce>>2]|0))ee=X+8|0,O=+v0(W,Qt,We,Qe,De,ee),J&O>=20&&(X0(F[W>>2]|0,.8)|0,O=+e0(W,Qt,We,Qe,De,ee),O>=20&&(X0(F[W>>2]|0,.6)|0,O=+e0(W,Qt,We,Qe,De,ee),O>=20&&(X0(F[W>>2]|0,.4)|0,O=+e0(W,Qt,We,Qe,De,ee),O>=20&&(X0(F[W>>2]|0,0)|0,O=+e0(W,Qt,We,Qe,De,ee))))),Mr(Qe),Mr(We);else{O=+v0(W,Qt,We,Qe,De,Ye),le=X+8|0,he=+v0(W,le,We,Qe,De,le),ee=O<he;do if(J){if(ee){ee=0;do se[X+8+(ee<<5)>>3]=+se[Ye+(ee<<5)>>3],se[X+8+(ee<<5)+8>>3]=+se[Ye+(ee<<5)+8>>3],se[X+8+(ee<<5)+16>>3]=+se[Ye+(ee<<5)+16>>3],se[X+8+(ee<<5)+24>>3]=+se[Ye+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3)}else O=he;if(O>=20){if(X0(F[W>>2]|0,.8)|0,O=+e0(W,Qt,We,Qe,De,Ye),he=+e0(W,le,We,Qe,De,le),O<he){ee=0;do se[X+8+(ee<<5)>>3]=+se[Ye+(ee<<5)>>3],se[X+8+(ee<<5)+8>>3]=+se[Ye+(ee<<5)+8>>3],se[X+8+(ee<<5)+16>>3]=+se[Ye+(ee<<5)+16>>3],se[X+8+(ee<<5)+24>>3]=+se[Ye+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3)}else O=he;if(O>=20){if(X0(F[W>>2]|0,.6)|0,O=+e0(W,Qt,We,Qe,De,Ye),he=+e0(W,le,We,Qe,De,le),O<he){ee=0;do se[X+8+(ee<<5)>>3]=+se[Ye+(ee<<5)>>3],se[X+8+(ee<<5)+8>>3]=+se[Ye+(ee<<5)+8>>3],se[X+8+(ee<<5)+16>>3]=+se[Ye+(ee<<5)+16>>3],se[X+8+(ee<<5)+24>>3]=+se[Ye+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3)}else O=he;if(O>=20){if(X0(F[W>>2]|0,.4)|0,O=+e0(W,Qt,We,Qe,De,Ye),he=+e0(W,le,We,Qe,De,le),O<he){ee=0;do se[X+8+(ee<<5)>>3]=+se[Ye+(ee<<5)>>3],se[X+8+(ee<<5)+8>>3]=+se[Ye+(ee<<5)+8>>3],se[X+8+(ee<<5)+16>>3]=+se[Ye+(ee<<5)+16>>3],se[X+8+(ee<<5)+24>>3]=+se[Ye+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3)}else O=he;if(O>=20){if(X0(F[W>>2]|0,0)|0,O=+e0(W,Qt,We,Qe,De,Ye),he=+e0(W,le,We,Qe,De,le),O<he)ee=0;else{O=he;break}do se[X+8+(ee<<5)>>3]=+se[Ye+(ee<<5)>>3],se[X+8+(ee<<5)+8>>3]=+se[Ye+(ee<<5)+8>>3],se[X+8+(ee<<5)+16>>3]=+se[Ye+(ee<<5)+16>>3],se[X+8+(ee<<5)+24>>3]=+se[Ye+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3)}}}}}else if(ee){ee=0;do se[X+8+(ee<<5)>>3]=+se[Ye+(ee<<5)>>3],se[X+8+(ee<<5)+8>>3]=+se[Ye+(ee<<5)+8>>3],se[X+8+(ee<<5)+16>>3]=+se[Ye+(ee<<5)+16>>3],se[X+8+(ee<<5)+24>>3]=+se[Ye+(ee<<5)+24>>3],ee=ee+1|0;while((ee|0)!=3)}else O=he;while(!1);Mr(Qe),Mr(We)}if(O<20){F[ce>>2]=1;break}if(F[ce>>2]=0,ce=F[Bn>>2]|0,(ce|0)>0){ee=F[X>>2]|0,le=0;do J=F[ee+(le*320|0)+304>>2]|0,(J|0)>=0&&(Gn=q+(J<<8)+236|0,(F[Gn>>2]|0)==0)&&(F[Gn>>2]=8),le=le+1|0;while((le|0)<(ce|0))}}else Wn=38;while(!1);return(Wn|0)==38&&(F[X+104>>2]=0,O=-1),me=ei,+O}function $1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0,jr=0,wr=0,ks=0,ho=0,zs=0,Fi=0,ar=0,Cr=0;Fi=me,me=me+2544|0,ho=Fi+208|0,ks=Fi+200|0,Pn=Fi+184|0,wr=Fi+176|0,ei=Fi+168|0,Wn=Fi+152|0,jr=Fi+144|0,Gn=Fi+136|0,wn=Fi+128|0,Di=Fi+120|0,tr=Fi+112|0,Bn=Fi+104|0,ee=Fi+96|0,O=Fi+88|0,G=Fi+80|0,X=Fi+72|0,j=Fi+64|0,Yi=Fi,mi=Fi+2280|0,Gi=Fi+232|0,je=Fi+224|0,Rn=Fi+220|0,Ye=Fi+216|0,Qt=Fi+212|0,zs=va(W,5306)|0;e:do if(!zs)F[j>>2]=W,Jn(3,5308,j),j=aa(F[(Is()|0)>>2]|0)|0,F[X>>2]=5367,F[X+4>>2]=j,Jn(3,5361,X),j=0;else{if(Fc(mi,zs),F[G>>2]=Rn,(Ya(mi,5368,G)|0)!=1){F[O>>2]=W,Jn(3,5371,O),W0(zs)|0,j=0;break}j=F[Rn>>2]|0,ci=$i(j*320|0)|0,ci||(Jn(3,5472,ee),zt(1)),We=Yi+8|0,pt=Yi+16|0,rt=Yi+24|0,qe=Yi+32|0,Je=Yi+40|0,lt=Yi+48|0,Et=Yi+56|0,At=(q|0)==0;t:do if((j|0)>0){j=0,G=0;n:for(;;){if(Fc(mi,zs),X=ci+(j*320|0)|0,O=ci+(j*320|0)+312|0,F[Bn>>2]=O,F[Bn+4>>2]=je,(Ya(mi,5489,Bn)|0)==1)Qe=F[O>>2]|0,F[X>>2]=(Qe&-32768|0)==0&!0?Qe&32767:0,F[ci+(j*320|0)+4>>2]=1,G=G|2;else{if(At){X=10;break}if(!(gl(Gi,W,2048,1)|0)){X=12;break}if(Oo(Gi,mi,2047-(Na(Gi)|0)|0)|0,Qe=Uh(q,Gi)|0,F[X>>2]=Qe,(Qe|0)<0){X=14;break}F[ci+(j*320|0)+4>>2]=0,G=G|1}if(Fc(mi,zs),X=ci+(j*320|0)+8|0,F[Gn>>2]=X,(Ya(mi,5785,Gn)|0)!=1){X=18;break}if(Fc(mi,zs),Ce=ci+(j*320|0)+16|0,De=ci+(j*320|0)+24|0,Qe=ci+(j*320|0)+40|0,F[Wn>>2]=Ce,F[Wn+4>>2]=De,F[Wn+8>>2]=ci+(j*320|0)+32,F[Wn+12>>2]=Qe,(Ya(mi,5894,Wn)|0)!=4)if(F[ei>>2]=Ye,F[ei+4>>2]=Qt,(Ya(mi,5910,ei)|0)==2)O=0;else{X=21;break}else O=1;do{if(Fc(mi,zs),F[Pn>>2]=ci+(j*320|0)+16+(O<<5),F[Pn+4>>2]=ci+(j*320|0)+16+(O<<5)+8,F[Pn+8>>2]=ci+(j*320|0)+16+(O<<5)+16,F[Pn+12>>2]=ci+(j*320|0)+16+(O<<5)+24,(Ya(mi,5894,Pn)|0)!=4){X=23;break n}O=O+1|0}while((O|0)<3);kh(Ce,ci+(j*320|0)+112|0)|0,Cr=+se[X>>3],ar=Cr*-.5,se[Yi>>3]=ar,Cr=Cr*.5,se[We>>3]=Cr,se[pt>>3]=Cr,se[rt>>3]=Cr,se[qe>>3]=Cr,se[Je>>3]=ar,se[lt>>3]=ar,se[Et>>3]=ar,X=ci+(j*320|0)+48|0,O=ci+(j*320|0)+56|0,ee=ci+(j*320|0)+72|0,J=ci+(j*320|0)+80|0,le=ci+(j*320|0)+88|0,ce=ci+(j*320|0)+104|0,he=0;do ar=+se[Yi+(he<<4)>>3],Cr=+se[Yi+(he<<4)+8>>3],se[ci+(j*320|0)+208+(he*24|0)>>3]=+se[Qe>>3]+(+se[Ce>>3]*ar+ +se[De>>3]*Cr),se[ci+(j*320|0)+208+(he*24|0)+8>>3]=+se[ee>>3]+(+se[X>>3]*ar+ +se[O>>3]*Cr),se[ci+(j*320|0)+208+(he*24|0)+16>>3]=+se[ce>>3]+(+se[J>>3]*ar+ +se[le>>3]*Cr),he=he+1|0;while((he|0)!=4);if(j=j+1|0,(j|0)>=(F[Rn>>2]|0))break t}(X|0)==10?(F[tr>>2]=W,F[tr+4>>2]=mi,Jn(3,5496,tr)):(X|0)==12?(F[Di>>2]=W,Jn(3,5624,Di)):(X|0)==14?(F[wn>>2]=W,F[wn+4>>2]=Gi,Jn(3,5708,wn)):(X|0)==18?(F[jr>>2]=W,F[jr+4>>2]=j+1,Jn(3,5789,jr)):(X|0)==21?(F[wr>>2]=W,F[wr+4>>2]=j+1,Jn(3,5916,wr)):(X|0)==23&&(F[ks>>2]=W,F[ks+4>>2]=j+1,Jn(3,5916,ks)),W0(zs)|0,Mr(ci),j=0;break e}else G=0;while(!1);W0(zs)|0,j=$i(136)|0,j||(Jn(3,5472,ho),zt(1)),F[j>>2]=ci,F[j+4>>2]=F[Rn>>2],F[j+104>>2]=0;do if((G&3|0)!=3)if(X=j+108|0,G&1){F[X>>2]=0;break}else{F[X>>2]=1;break}else F[j+108>>2]=2;while(!1);se[j+112>>3]=.5,se[j+120>>3]=.5}while(!1);return me=Fi,j|0}function Fc(W,q){W=W|0,q=q|0;var j=0,X=0;e:do if(i0(W,256,q)|0)for(;;){j=Na(W)|0;t:do if(j)for(;;){switch(j=j+-1|0,X=W+j|0,ie[X>>0]|0){case 13:case 10:break;default:break t}if(ie[X>>0]=0,!j)break t}while(!1);switch(ie[W>>0]|0){case 0:case 35:break;default:break e}if(!(i0(W,256,q)|0))break e}while(!1)}function Wh(W,q,j,X){W=W|0,q=+q,j=+j,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;if(We=me,me=me+400|0,he=We+296|0,Qe=We+200|0,Ce=We+128|0,De=We,J=F[W>>2]|0,G=F[W+4>>2]|0,!((r0(W+8|0,he,Qe)|0)<0)){ee=+(G+-1|0),G=he+32|0,se[G>>3]=ee*+se[he+64>>3]-+se[G>>3],G=he+40|0,se[G>>3]=ee*+se[he+72>>3]-+se[G>>3],G=he+48|0,se[G>>3]=ee*+se[he+80>>3]-+se[G>>3],G=he+56|0,se[G>>3]=ee*+se[he+88>>3]-+se[G>>3],O=+se[he+80>>3],G=0;do se[Ce+(G*24|0)>>3]=+se[he+(G<<5)>>3]/O,se[Ce+(G*24|0)+8>>3]=+se[he+(G<<5)+8>>3]/O,se[Ce+(G*24|0)+16>>3]=+se[he+(G<<5)+16>>3]/O,G=G+1|0;while((G|0)!=3);O=+(J+-1|0),se[De>>3]=+se[Ce>>3]*2/O,se[De+8>>3]=+se[Ce+8>>3]*2/O,se[De+16>>3]=+se[Ce+16>>3]*2/O+-1,J=De+24|0,F[J>>2]=0,F[J+4>>2]=0,F[J+8>>2]=0,F[J+12>>2]=0,se[De+40>>3]=+se[Ce+32>>3]*2/ee,se[De+48>>3]=+se[Ce+40>>3]*2/ee+-1,J=De+56|0,O=j-q,F[J>>2]=0,F[J+4>>2]=0,F[J+8>>2]=0,F[J+12>>2]=0,F[J+16>>2]=0,F[J+20>>2]=0,se[De+80>>3]=(q+j)/O,se[De+88>>3]=j*-2*q/O,J=De+96|0,F[J>>2]=0,F[J+4>>2]=0,F[J+8>>2]=0,F[J+12>>2]=0,se[De+112>>3]=1,se[De+120>>3]=0,O=+se[Qe+24>>3],ee=+se[Qe+56>>3],j=+se[Qe+88>>3],J=0;do{q=+se[De+(J<<5)>>3],G=De+(J<<5)+8|0,W=De+(J<<5)+16|0,le=+se[G>>3],ce=+se[W>>3],he=0;do se[X+((he<<2)+J<<3)>>3]=q*+se[Qe+(he<<3)>>3]+le*+se[Qe+32+(he<<3)>>3]+ce*+se[Qe+64+(he<<3)>>3],he=he+1|0;while((he|0)!=3);se[X+(J+12<<3)>>3]=+se[De+(J<<5)+24>>3]+(q*O+ +se[G>>3]*ee+ +se[W>>3]*j),J=J+1|0}while((J|0)!=4)}me=We}function X1(W){W=W|0,F[496]=W}function zd(){return F[496]|0}function Wd(W){W=W|0;var q=0,j=0;q=W+212|0,j=F[q>>2]|0,j&&(au(j)|0,Ga(F[q>>2]|0)|0,F[q>>2]=0),q=W+224|0,F[q>>2]|0&&(l1(q)|0,F[q>>2]=0),q=W+192|0,F[q>>2]|0&&(Ro(q)|0,F[q>>2]=0)}function K1(W){W=W|0;var q=0,j=0,X=0,G=0,O=0;if(O=me,me=me+16|0,j=O,F[j>>2]=W,!(Ys(2044,j)|0))W=-1;else{if(G=qs(2044,j)|0,W=G+196|0,q=F[W>>2]|0,q&&(Mr(q),F[W>>2]=0,F[G+200>>2]=0),Wd(G),jl(F[G+216>>2]|0)|0,gf(2044,j)|0,j=G+248|0,X=G+252|0,W=F[j>>2]|0,(F[X>>2]|0)!=(W|0)){q=0;do V1(F[W+(q<<3)+4>>2]|0)|0,q=q+1|0,W=F[j>>2]|0;while(q>>>0<(F[X>>2]|0)-W>>3>>>0)}Iu(j),oa(j),Iu(G+248|0),oa(G),W=0}return me=O,W|0}function Y1(W){W=W|0;var q=0,j=0,X=0,G=0,O=0;return O=me,me=me+208|0,G=O+192|0,X=O,j=O+196|0,ie[W>>0]&1?q=F[W+8>>2]|0:q=W+1|0,(Qh(q,1,X,O+184|0)|0)<0?(ie[W>>0]&1?q=F[W+8>>2]|0:q=W+1|0,F[G>>2]=q,Jn(3,6093,G),q=-1):(q=F[521]|0,F[521]=q+1,F[j>>2]=q,Ko(Zd(2064,j)|0,X|0,184)|0),me=O,q|0}function q1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0;he=me,me=me+48|0,ce=he+24|0,le=he+16|0,ee=he+8|0,G=he,j=he+32|0,X=he+28|0,F[j>>2]=W,F[X>>2]=q;do if(Ys(2044,j)|0&&(J=qs(2044,j)|0,(jd(2064,X)|0)!=0)){if(O=J+8|0,Ko(O|0,Zd(2064,X)|0,184)|0,X=F[O>>2]|0,j=J+204|0,q=F[J+12>>2]|0,W=J+208|0,(X|0)==(F[j>>2]|0)&&(q|0)==(F[W>>2]|0)||(F[G>>2]=X,F[G+4>>2]=q,Jn(2,6152,G),nu(O,F[j>>2]|0,F[W>>2]|0,O)|0),Wd(J),j=Kl(O,15)|0,W=J+192|0,F[W>>2]=j,!j){Jn(3,6199,ee),j=-1;break}if(j=Lf(j)|0,q=J+212|0,F[q>>2]=j,!j){Jn(3,6237,le),j=-1;break}if(rl(j,2)|0,le=fp(O)|0,F[J+224>>2]=le,le){p1(F[q>>2]|0,F[J+216>>2]|0)|0,Wh(F[W>>2]|0,+se[J+232>>3],+se[J+240>>3],J+264|0),j=0;break}else{Jn(3,6274,ce),j=-1;break}}else j=-1;while(!1);return me=he,j|0}function $d(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0;return ee=me,me=me+16|0,O=ee+8|0,G=ee,j=ee+12|0,F[j>>2]=W,Ys(2044,j)|0?(X=qs(2044,j)|0,ie[q>>0]&1?q=F[q+8>>2]|0:q=q+1|0,W=X+216|0,j=Uh(F[W>>2]|0,q)|0,F[X+260>>2]=j,(j|0)<0&&(F[G>>2]=q,Jn(3,6312,G),jl(F[W>>2]|0)|0,Jn(3,6358,O),j=-1)):j=-1,me=ee,j|0}function J1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0;le=me,me=me+32|0,G=le+16|0,X=le+8|0,j=le+20|0,J=le,F[j>>2]=W;do if(Ys(2044,j)|0){if(ee=qs(2044,j)|0,ie[q>>0]&1?j=F[q+8>>2]|0:j=q+1|0,W=F[ee+212>>2]|0,q=ee+216|0,O=ee+220|0,j=$1(j,F[q>>2]|0)|0,F[O>>2]=j,!j){Jn(3,6402,X),jl(F[q>>2]|0)|0,Jn(3,6429,G),j=-1;break}switch(F[j+108>>2]|0){case 0:{ru(W,0)|0;break}case 1:{ru(W,2)|0;break}default:ru(W,3)|0}if(W=ee+248|0,q=ee+252|0,X=F[q>>2]|0,j=X-(F[W>>2]|0)>>3,G=J,F[G>>2]=0,F[G+4>>2]=0,F[J>>2]=j,F[J+4>>2]=F[O>>2],(X|0)==(F[ee+256>>2]|0)){e1(W,J);break}else{ee=J,j=F[ee>>2]|0,ee=F[ee+4>>2]|0,J=X,F[J>>2]=j,F[J+4>>2]=ee,F[q>>2]=(F[q>>2]|0)+8;break}}else j=-1;while(!1);return me=le,j|0}function Z1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;return O=me,me=me+16|0,j=O,F[j>>2]=W,Ys(2044,j)|0&&(X=qs(2044,j)|0,(q|0)>=0)&&(G=F[X+248>>2]|0,(F[X+252>>2]|0)-G>>3>>>0>q>>>0)?j=F[(F[G+(q<<3)+4>>2]|0)+4>>2]|0:j=-1,me=O,j|0}function j1(W){W=W|0;var q=0,j=0;return j=me,me=me+16|0,q=j,F[q>>2]=W,Ys(2044,q)|0?(q=qs(2044,q)|0,q=(F[q+252>>2]|0)-(F[q+248>>2]|0)>>3):q=-1,me=j,q|0}function jf(W,q){W=W|0,q=+q;var j=0,X=0;X=me,me=me+16|0,j=X,F[j>>2]=W,Ys(2044,j)|0&&(se[(qs(2044,j)|0)+232>>3]=q),me=X}function ef(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,j=X,F[j>>2]=W,Ys(2044,j)|0?q=+se[(qs(2044,j)|0)+232>>3]:q=-1,me=X,+q}function ep(W,q){W=W|0,q=+q;var j=0,X=0;X=me,me=me+16|0,j=X,F[j>>2]=W,Ys(2044,j)|0&&(se[(qs(2044,j)|0)+240>>3]=q),me=X}function tp(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,j=X,F[j>>2]=W,Ys(2044,j)|0?q=+se[(qs(2044,j)|0)+240>>3]:q=-1,me=X,+q}function tf(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;G=me,me=me+16|0,X=G,j=G+4|0,F[j>>2]=W,Ys(2044,j)|0&&!(ru(F[(qs(2044,j)|0)+212>>2]|0,q)|0)&&(F[X>>2]=q,Jn(1,6478,X)),me=G}function nf(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(W=(rh(F[(qs(2044,q)|0)+212>>2]|0,j)|0)==0,me=X,(W?F[j>>2]|0:-1)|0):(me=X,-1)}function rf(W,q){W=W|0,q=+q;var j=0,X=0,G=0,O=0,ee=0,J=0;J=me,me=me+16|0,ee=J,j=J+8|0,F[j>>2]=W,Ys(2044,j)|0&&(X=qs(2044,j)|0,!(q<=0|q>=1))&&(G=q,O=F[X+212>>2]|0,(O|0)!=0)&&!(Nc(O,G)|0)&&(se[ee>>3]=G,Jn(1,6513,ee)),me=J}function $h(W){W=W|0;var q=0,j=0,X=0,G=0;return G=me,me=me+16|0,q=G+8|0,X=G,F[q>>2]=W,Ys(2044,q)|0&&(j=F[(qs(2044,q)|0)+212>>2]|0,(j|0)!=0)?(W=(u1(j,X)|0)==0,me=G,+(W?+se[X>>3]:-1)):(me=G,-1)}function np(W,q){W=W|0,q=q|0;var j=0,X=0;X=me,me=me+16|0,j=X,F[j>>2]=W,Ys(2044,j)|0&&Y0(F[(qs(2044,j)|0)+212>>2]|0,q)|0,me=X}function ip(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(Pf(F[(qs(2044,q)|0)+212>>2]|0,j)|0,q=F[j>>2]|0):q=-1,me=X,q|0}function rp(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;G=me,me=me+16|0,X=G,j=G+4|0,F[j>>2]=W,Ys(2044,j)|0&&!(sl(F[(qs(2044,j)|0)+212>>2]|0,q)|0)&&(F[X>>2]=q,Jn(1,6544,X)),me=G}function yl(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(W=(ih(F[(qs(2044,q)|0)+212>>2]|0,j)|0)==0,me=X,(W?F[j>>2]|0:-1)|0):(me=X,-1)}function Xd(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;O=me,me=me+16|0,G=O,j=O+4|0,F[j>>2]=W,Ys(2044,j)|0&&(X=qs(2044,j)|0,q>>>0<=255)&&!(ja(F[X+212>>2]|0,q)|0)&&(F[G>>2]=q,Jn(1,6569,G)),me=O}function Xh(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(W=(Zh(F[(qs(2044,q)|0)+212>>2]|0,j)|0)==0,me=X,(W?F[j>>2]|0:-1)|0):(me=X,-1)}function sf(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;G=me,me=me+16|0,X=G,j=G+4|0,F[j>>2]=W,Ys(2044,j)|0&&!(Za(F[(qs(2044,j)|0)+212>>2]|0,q)|0)&&(F[X>>2]=q,Jn(1,6590,X)),me=G}function of(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(W=(Du(F[(qs(2044,q)|0)+212>>2]|0,j)|0)==0,me=X,(W?F[j>>2]|0:-1)|0):(me=X,-1)}function af(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;return G=me,me=me+16|0,X=G,j=G+4|0,F[j>>2]=W,Ys(2044,j)|0?(W=(q|0)!=0,xo(F[(qs(2044,j)|0)+212>>2]|0,W&1)|0,F[X>>2]=W?6616:6620,Jn(1,6625,X)):q=0,me=G,q|0}function Kd(W){W=W|0;var q=0,j=0;return j=me,me=me+16|0,q=j,F[q>>2]=W,Ys(2044,q)|0?q=F[(F[(qs(2044,q)|0)+212>>2]|0)+4834148>>2]|0:q=0,me=j,q|0}function Tu(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(g0(F[(qs(2044,q)|0)+212>>2]|0,j)|0,q=F[j>>2]|0):q=0,me=X,q|0}function Yd(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;G=me,me=me+16|0,X=G,j=G+4|0,F[j>>2]=W,Ys(2044,j)|0&&!(c1(F[(qs(2044,j)|0)+212>>2]|0,q)|0)&&(F[X>>2]=q,Jn(1,6647,X)),me=G}function qd(W){W=W|0;var q=0,j=0,X=0;return X=me,me=me+16|0,q=X+4|0,j=X,F[q>>2]=W,Ys(2044,q)|0?(W=(Df(F[(qs(2044,q)|0)+212>>2]|0,j)|0)==0,me=X,(W?F[j>>2]|0:-1)|0):(me=X,-1)}function Jd(W,q){W=W|0,q=q|0;var j=0;j=0;do se[q+(j<<5)>>3]=+se[W+(j<<5)>>3],se[q+(j<<5)+8>>3]=+se[W+(j<<5)+8>>3],se[q+(j<<5)+16>>3]=+se[W+(j<<5)+16>>3],se[q+(j<<5)+24>>3]=+se[W+(j<<5)+24>>3],j=j+1|0;while((j|0)!=3)}function lf(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;G=me,me=me+16|0,X=G,F[X>>2]=W;do if(Ys(2044,X)|0)if(X=qs(2044,X)|0,W=F[X+212>>2]|0,(F[W+44>>2]|0)>(q|0)){+nd(F[X+224>>2]|0,(q|0)<0?8:W+48+(q<<8)|0,+(j|0),264),X=0;break}else{X=F[523]|0;break}else X=F[522]|0;while(!1);return me=G,X|0}function cf(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;G=me,me=me+16|0,X=G,F[X>>2]=W;do if(Ys(2044,X)|0)if(X=qs(2044,X)|0,W=F[X+212>>2]|0,(F[W+44>>2]|0)>(q|0)){+d1(F[X+224>>2]|0,(q|0)<0?8:W+48+(q<<8)|0,264,+(j|0),264),X=0;break}else{X=F[523]|0;break}else X=F[522]|0;while(!1);return me=G,X|0}function uf(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;G=me,me=me+16|0,X=G,F[X>>2]=W;do if(Ys(2044,X)|0)if(X=F[(qs(2044,X)|0)+212>>2]|0,(F[X+44>>2]|0)>(q|0)){F[((q|0)<0?8:X+48+(q<<8)|0)+16>>2]=j,X=0;break}else{X=F[523]|0;break}else X=F[522]|0;while(!1);return me=G,X|0}function hf(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0;X=me,me=me+16|0,j=X,F[j>>2]=W;do if(Ys(2044,j)|0)if(j=F[(qs(2044,j)|0)+212>>2]|0,(F[j+44>>2]|0)>(q|0)){j=(q|0)<0?8:j+48+(q<<8)|0,Ce=+se[33],se[j+168>>3]=Ce,J=+se[34],se[j+176>>3]=J,he=+se[35],se[j+184>>3]=he,ee=+se[36],se[j+192>>3]=ee,ce=+se[37],se[j+200>>3]=ce,O=+se[38],se[j+208>>3]=O,le=+se[39],se[j+216>>3]=le,G=+se[40],se[j+224>>3]=G,se[j+56>>3]=(Ce+he+ce+le)*.25,se[j+64>>3]=(J+ee+O+G)*.25,j=0;break}else{j=F[523]|0;break}else j=F[522]|0;while(!1);return me=X,j|0}function df(W,q){W=W|0,q=q|0;var j=0,X=0;X=me,me=me+16|0,j=X,F[j>>2]=W;do if(Ys(2044,j)|0)if(j=qs(2044,j)|0,W=F[j+248>>2]|0,(q|0)<0||(F[j+252>>2]|0)-W>>3>>>0<=q>>>0){j=F[524]|0;break}else{q=F[W+(q<<3)+4>>2]|0,W=F[j+212>>2]|0,+W1(F[j+224>>2]|0,W+48|0,F[W+44>>2]|0,q),Jd(q+8|0,264),j=0;break}else j=F[522]|0;while(!1);return me=X,j|0}function sp(W,q){W=W|0,q=q|0;var j=0,X=0;X=me,me=me+16|0,j=X,F[j>>2]=W;do if(Ys(2044,j)|0)if(j=qs(2044,j)|0,W=F[j+248>>2]|0,(q|0)<0||(F[j+252>>2]|0)-W>>3>>>0<=q>>>0){j=F[524]|0;break}else{q=F[W+(q<<3)+4>>2]|0,W=F[j+212>>2]|0,+z1(F[j+224>>2]|0,W+48|0,F[W+44>>2]|0,q),Jd(q+8|0,264),j=0;break}else j=F[522]|0;while(!1);return me=X,j|0}function G0(W){W=W|0;var q=0,j=0;return j=me,me=me+16|0,q=j,F[q>>2]=W,Ys(2044,q)|0?(q=qs(2044,q)|0,q=Ff(F[q+212>>2]|0,F[q+196>>2]|0)|0):q=F[522]|0,me=j,q|0}function T0(W){W=W|0;var q=0,j=0;return j=me,me=me+16|0,q=j,F[q>>2]=W,Ys(2044,q)|0?q=(F[(qs(2044,q)|0)+212>>2]|0)+44|0:q=2088,me=j,F[q>>2]|0}function ff(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;G=me,me=me+16|0,X=G,F[X>>2]=W;do if(Ys(2044,X)|0){if(W=qs(2044,X)|0,X=F[W+248>>2]|0,(q|0)<0||(F[W+252>>2]|0)-X>>3>>>0<=q>>>0){X=F[524]|0;break}if(X=F[X+(q<<3)+4>>2]|0,(j|0)<0||(F[X+4>>2]|0)<=(j|0)){X=F[523]|0;break}else{X=F[X>>2]|0,Jd(X+(j*320|0)+16|0,264),fa(0,F[X+(j*320|0)+304>>2]|0,F[X+(j*320|0)>>2]|0,F[X+(j*320|0)+4>>2]|0,+ +se[X+(j*320|0)+8>>3])|0,X=0;break}}else X=F[522]|0;while(!1);return me=G,X|0}function pf(W,q){W=W|0,q=q|0;var j=0,X=0;X=me,me=me+16|0,j=X,F[j>>2]=W;do if(Ys(2044,j)|0)if(j=F[(qs(2044,j)|0)+212>>2]|0,(F[j+44>>2]|0)>(q|0)){j=(q|0)<0?8:j+48+(q<<8)|0,q0(1,F[j>>2]|0,F[j+4>>2]|0,F[j+8>>2]|0,F[j+12>>2]|0,F[j+16>>2]|0,F[j+20>>2]|0,F[j+24>>2]|0,+ +se[j+32>>3],+ +se[j+40>>3],+ +se[j+48>>3],+ +se[j+56>>3],+ +se[j+64>>3],+ +se[j+72>>3],+ +se[j+80>>3],+ +se[j+88>>3],+ +se[j+96>>3],+ +se[j+104>>3],+ +se[j+112>>3],+ +se[j+120>>3],+ +se[j+128>>3],+ +se[j+136>>3],+ +se[j+144>>3],+ +se[j+152>>3],+ +se[j+160>>3],+ +se[j+168>>3],+ +se[j+176>>3],+ +se[j+184>>3],+ +se[j+192>>3],+ +se[j+200>>3],+ +se[j+208>>3],+ +se[j+216>>3],+ +se[j+224>>3],F[j+240>>2]|0)|0,j=0;break}else{j=F[523]|0;break}else j=F[522]|0;while(!1);return me=X,j|0}function Af(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0;return ee=me,me=me+16|0,O=ee+8|0,G=ee+12|0,X=F[525]|0,F[525]=X+1,F[G>>2]=X,G=qs(2044,G)|0,F[G>>2]=X,F[G+204>>2]=W,F[G+208>>2]=q,J=kt(W<<2,q)|0,q=G+200|0,F[q>>2]=J,W=G+196|0,F[W>>2]=$i(J)|0,J=Nf()|0,F[G+216>>2]=J,J||Jn(3,8285,ee),q1(X,j)|0,F[O>>2]=F[q>>2],Jn(1,8322,O),mo(2,F[G>>2]|0,F[W>>2]|0,F[q>>2]|0,G+264|0,264)|0,me=ee,F[G>>2]|0}function mf(W){W=W|0;var q=0;W=me,me=me+16|0,q=W,iu(8591,7),K0(8597,3),Kh(8606,2),Kh(8617,3),xc(8633,4),K0(8651,4),op(8671,5),iu(8683,8),xc(8700,5),iu(8720,9),iu(8738,10),xc(8760,6),xc(8783,7),K0(8812,6),K0(8825,7),iu(8838,11),xc(8857,8),xc(8867,9),K0(8880,8),K0(8893,9),vf(8912,10),t1(8924,1),n1(8936,1),Ru(8959,1),n1(8982,2),Ru(9004,2),Q0(9026,1),K0(9043,10),Q0(9060,2),K0(9073,11),Q0(9086,3),K0(9110,12),ap(9134,3),Ru(9147,3),Q0(9160,4),K0(9178,13),Q0(9196,5),K0(9212,14),Q0(9228,6),K0(9245,15),Yh(9262,2088),Yh(9291,2096),Yh(9319,2092),Ki(9352,680,0),Ki(9369,680,1),Ki(9385,680,0),Ki(9407,680,0),Ki(9432,680,1),Ki(9457,680,1),Ki(9482,680,100),Ki(9509,680,0),Ki(9535,680,1),Ki(9561,680,0),Ki(9588,680,0),Ki(9615,680,1),Ki(9641,680,2),Ki(9666,680,3),Ki(9704,680,4),Ki(9741,680,0),Ki(9775,680,0),Ki(9799,680,1),Ki(9825,680,2),Ki(9852,680,2),Ki(9886,680,5),se[q>>3]=.5,i1(9904,q),Ki(9925,680,0),Ki(9944,680,1),Ki(9962,680,2),Ki(9980,680,3),Ki(9999,680,4),Ki(10021,680,3),Ki(10040,680,515),Ki(10069,680,259),Ki(10097,680,4),Ki(10116,680,772),Ki(10146,680,1028),Ki(10176,680,0),Ki(10207,680,1),Ki(10243,680,2),Ki(10277,680,3),Ki(10315,680,0),Ki(10348,680,1),Ki(10395,680,2),Ki(10437,680,3),Ki(10480,680,4),Ki(10532,680,5),Ki(10583,680,6),Ki(10628,680,7),Ki(10667,680,8),Ki(10712,680,9),me=W}function Ys(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0;j=F[q>>2]|0,G=F[W+4>>2]|0;e:do if(G)if(O=G+-1|0,ee=(O&G|0)==0,ee?X=O&j:X=(j>>>0)%(G>>>0)|0,q=F[(F[W>>2]|0)+(X<<2)>>2]|0,q)do{if(q=F[q>>2]|0,!q){q=0;break e}if(W=F[q+4>>2]|0,ee?W=W&O:W=(W>>>0)%(G>>>0)|0,(W|0)!=(X|0)){q=0;break e}}while((F[q+8>>2]|0)!=(j|0));else q=0;else q=0;while(!1);return q|0}function qs(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;return O=me,me=me+32|0,G=O+8|0,X=O,j=Ys(W,q)|0,j||(Dh(G,W,q),Ph(X,W,F[G>>2]|0),j=F[X>>2]|0,F[G>>2]=0),me=O,j+16|0}function gf(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;return G=me,me=me+16|0,j=G+4|0,X=G,q=Ys(W,q)|0,q?(F[X>>2]=q,F[j>>2]=F[X>>2],$u(W,j)|0,q=1):q=0,me=G,q|0}function Iu(W){W=W|0;var q=0,j=0;if(j=F[W>>2]|0,j){if(q=W+4|0,W=F[q>>2]|0,(W|0)!=(j|0)){do W=W+-8|0;while((W|0)!=(j|0));F[q>>2]=W}oa(j)}}function Zd(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;return O=me,me=me+32|0,G=O+8|0,X=O,j=jd(W,q)|0,j||(s0(G,W,q),Cl(X,W,F[G>>2]|0),j=F[X>>2]|0,F[G>>2]=0),me=O,j+16|0}function jd(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0;j=F[q>>2]|0,G=F[W+4>>2]|0;e:do if(G)if(O=G+-1|0,ee=(O&G|0)==0,ee?X=O&j:X=(j>>>0)%(G>>>0)|0,q=F[(F[W>>2]|0)+(X<<2)>>2]|0,q)do{if(q=F[q>>2]|0,!q){q=0;break e}if(W=F[q+4>>2]|0,ee?W=W&O:W=(W>>>0)%(G>>>0)|0,(W|0)!=(X|0)){q=0;break e}}while((F[q+8>>2]|0)!=(j|0));else q=0;else q=0;while(!1);return q|0}function e1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0;J=me,me=me+32|0,ee=J,O=W+4|0,j=F[W>>2]|0,G=((F[O>>2]|0)-j>>3)+1|0,G>>>0>536870911&&mu(W),X=j,j=(F[W+8>>2]|0)-X|0,j>>3>>>0<268435455?(j=j>>2,j=j>>>0<G>>>0?G:j):j=536870911,Sf(ee,j,(F[O>>2]|0)-X>>3,W+8|0),O=ee+8|0,G=F[O>>2]|0,j=q,X=F[j+4>>2]|0,q=G,F[q>>2]=F[j>>2],F[q+4>>2]=X,F[O>>2]=G+8,o1(W,ee),a1(ee),me=J}function iu(W,q){W=W|0,q=q|0,Ts(W|0,4,2200,10911,1,q|0)}function K0(W,q){W=W|0,q=q|0,Ts(W|0,2,2192,10801,10,q|0)}function Kh(W,q){W=W|0,q=q|0,Ts(W|0,3,2180,10906,12,q|0)}function xc(W,q){W=W|0,q=q|0,Ts(W|0,3,2168,10906,13,q|0)}function op(W,q){W=W|0,q=q|0,Ts(W|0,2,2160,10801,11,q|0)}function vf(W,q){W=W|0,q=q|0,Ts(W|0,2,2152,10797,7,q|0)}function t1(W,q){W=W|0,q=q|0,Ts(W|0,1,2148,10794,16,q|0)}function n1(W,q){W=W|0,q=q|0,Ts(W|0,3,2136,10789,1,q|0)}function Ru(W,q){W=W|0,q=q|0,Ts(W|0,2,2128,10785,1,q|0)}function Q0(W,q){W=W|0,q=q|0,Ts(W|0,3,2116,10780,1,q|0)}function ap(W,q){W=W|0,q=q|0,Ts(W|0,3,2104,10775,2,q|0)}function Yh(W,q){W=W|0,q=q|0,Ki(W|0,680,F[q>>2]|0)}function i1(W,q){W=W|0,q=q|0,Ki(W|0,720,~~+se[q>>3]>>>0|0)}function Ef(){F[511]=0,F[512]=0,F[513]=0,F[514]=0,ve[515]=1,kn(11,2044,Le|0)|0,F[516]=0,F[517]=0,F[518]=0,F[519]=0,ve[520]=1,kn(12,2064,Le|0)|0,mf(0)}function yf(W){W=W|0,cp(W)}function nh(W){W=W|0,A0(W)}function A0(W){W=W|0;var q=0;lp(W,F[W+8>>2]|0),q=F[W>>2]|0,F[W>>2]=0,q&&oa(q)}function lp(W,q){if(W=W|0,q=q|0,q)do W=q,q=F[q>>2]|0,oa(W);while(q|0)}function cp(W){W=W|0;var q=0;qh(W,F[W+8>>2]|0),q=F[W>>2]|0,F[W>>2]=0,q&&oa(q)}function qh(W,q){if(W=W|0,q=q|0,q)do W=q,q=F[q>>2]|0,Iu(W+264|0),oa(W);while(q|0)}function m0(W,q,j){W=W|0,q=q|0,j=+j,Ei[W&3](q,j)}function up(W,q,j){W=W|0,q=q|0,j=j|0,Hr[W&7](q,j)}function ts(W,q){return W=W|0,q=q|0,+ +ur[W&3](q)}function Bu(W,q,j){W=W|0,q=q|0,j=+j,Ei[W&3](q,j)}function r1(W){return W=W|0,pr[W&1]()|0}function Cf(W,q){W=W|0,q=q|0,rr[W&15](q)}function hp(W,q){W=W|0,q=q|0;var j=0,X=0;return j=me,me=me+16|0,X=j,Lu(X,q),W=Zr[W&31](X)|0,ah(X),me=j,W|0}function Lu(W,q){W=W|0,q=q|0,A1(W,q+4|0,F[q>>2]|0)}function Jh(W,q,j){return W=W|0,q=q|0,j=j|0,dr[W&15](q,j)|0}function s1(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;return X=me,me=me+16|0,G=X,Lu(G,j),W=dr[W&15](q,G)|0,ah(G),me=X,W|0}function xf(W,q){return W=W|0,q=q|0,Zr[W&31](q)|0}function wf(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,en[W&15](q,j,X)|0}function Sf(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0,F[W+12>>2]=0,F[W+16>>2]=X,q?X=uc(q<<3)|0:X=0,F[W>>2]=X,j=X+(j<<3)|0,F[W+8>>2]=j,F[W+4>>2]=j,F[W+12>>2]=X+(q<<3)}function o1(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0;X=F[W>>2]|0,O=W+4|0,j=q+4|0,G=(F[O>>2]|0)-X|0,ee=(F[j>>2]|0)+(0-(G>>3)<<3)|0,F[j>>2]=ee,Ko(ee|0,X|0,G|0)|0,G=F[W>>2]|0,F[W>>2]=F[j>>2],F[j>>2]=G,G=q+8|0,X=F[O>>2]|0,F[O>>2]=F[G>>2],F[G>>2]=X,G=W+8|0,W=q+12|0,X=F[G>>2]|0,F[G>>2]=F[W>>2],F[W>>2]=X,F[q>>2]=F[j>>2]}function a1(W){W=W|0;var q=0,j=0,X=0;if(j=F[W+4>>2]|0,X=W+8|0,q=F[X>>2]|0,(q|0)!=(j|0)){do q=q+-8|0;while((q|0)!=(j|0));F[X>>2]=q}q=F[W>>2]|0,q&&oa(q)}function s0(W,q,j){W=W|0,q=q|0,j=j|0;var X=0;X=uc(200)|0,F[X+8>>2]=F[j>>2],ii(X+16|0,0,184)|0,F[W>>2]=X,W=W+4|0,F[W>>2]=q+8,F[W+4>>2]=257}function Cl(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0;ce=F[j+8>>2]|0,pt=j+4|0,F[pt>>2]=ce,We=q+4|0,le=F[We>>2]|0,Qe=(le|0)==0;e:do if(Qe)G=0,De=12;else if(he=le+-1|0,Ce=(he&le|0)==0,Ce?G=he&ce:G=(ce>>>0)%(le>>>0)|0,X=F[(F[q>>2]|0)+(G<<2)>>2]|0,!X)De=12;else for(;;){if(O=F[X>>2]|0,!O){De=12;break e}if(X=F[O+4>>2]|0,Ce?X=X&he:X=(X>>>0)%(le>>>0)|0,(X|0)!=(G|0)){De=12;break e}if((F[O+8>>2]|0)==(ce|0)){X=0,j=O;break}else X=O}while(!1);if((De|0)==12){ce=q+12|0,ee=+(((F[ce>>2]|0)+1|0)>>>0),J=+ve[q+16>>2];do if(Qe|ee>+(le>>>0)*J)if(le>>>0>2?X=(le+-1&le|0)==0:X=0,O=(X&1|le<<1)^1,X=~~+Br(+(ee/J))>>>0,Bh(q,O>>>0<X>>>0?X:O),O=F[We>>2]|0,X=F[pt>>2]|0,G=O+-1|0,G&O){le=O,G=(X>>>0)%(O>>>0)|0;break}else{le=O,G=G&X;break}while(!1);X=F[(F[q>>2]|0)+(G<<2)>>2]|0,X?(F[j>>2]=F[X>>2],F[X>>2]=j):(X=q+8|0,F[j>>2]=F[X>>2],F[X>>2]=j,F[(F[q>>2]|0)+(G<<2)>>2]=X,X=F[j>>2]|0,X&&(X=F[X+4>>2]|0,G=le+-1|0,G&le?X=(X>>>0)%(le>>>0)|0:X=X&G,F[(F[q>>2]|0)+(X<<2)>>2]=j)),F[ce>>2]=(F[ce>>2]|0)+1,X=1}F[W>>2]=j,ie[W+4>>0]=X}function Oc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O*3|0)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){do if(((fe[De+1>>0]|0)+(fe[De>>0]|0)+(fe[De+2>>0]|0)|0)>(Et|0)){if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}else ne[W>>1]=0,ie[O>>0]=0,X=Ce;while(!1);if(Qe=Qe+1|0,J=De+3|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+6|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Mf(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<1)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){ce=fe[De>>0]|0,he=fe[De+1>>0]|0;do if(((ce&248)+10+(ce<<5&224)+(he>>>3&28)+(he<<3&248)|0)>(Et|0)){if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}else ne[W>>1]=0,ie[O>>0]=0,X=Ce;while(!1);if(Qe=Qe+1|0,J=De+2|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+4|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function bf(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<2)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){do if(((fe[De+1>>0]|0)+(fe[De>>0]|0)+(fe[De+2>>0]|0)|0)>(Et|0)){if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}else ne[W>>1]=0,ie[O>>0]=0,X=Ce;while(!1);if(Qe=Qe+1|0,J=De+4|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+8|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function xl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<1)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){he=fe[De>>0]|0;do if(((he&240)+24+(he<<4&240)+((fe[De+1>>0]|0)&240)|0)>(Et|0)){if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}else ne[W>>1]=0,ie[O>>0]=0,X=Ce;while(!1);if(Qe=Qe+1|0,J=De+2|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+4|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Tf(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<1)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){ce=fe[De>>0]|0,he=fe[De+1>>0]|0;do if(((ce&248)+12+(ce<<5&224)+(he>>>3&24)+(he<<2&248)|0)>(Et|0)){if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}else ne[W>>1]=0,ie[O>>0]=0,X=Ce;while(!1);if(Qe=Qe+1|0,J=De+2|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+4|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Jl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,ce=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=ce,J=ce+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=X*3|0,lt=q+-1|0,(j|0)>0)for(O=0,X=ce,ee=ce+(lt<<1)|0;ne[ee>>1]=0,ne[X>>1]=0,O=O+1|0,!((O|0)>=(j|0));)X=X+(q<<1)|0,ee=ee+(q<<1)|0;ee=G+1179664|0,O=q+1|0,rt=0-q|0,We=1-q|0,pt=~q;e:do if((At|0)>1){qe=(lt|0)>1,le=(F[G+4>>2]|0)+O|0,Je=1,J=W+(O<<2)|0,W=ce+(O<<1)|0,X=0;t:for(;;){if(qe)for(O=le,Qe=1,De=J,Ce=X;;){do if(((fe[De+2>>0]|0)+(fe[De+1>>0]|0)+(fe[De+3>>0]|0)|0)>(Et|0)){if(ie[O>>0]=-1,X=ne[W+(rt<<1)>>1]|0,X<<16>>16>0){ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(le=ne[W+(We<<1)>>1]|0,ce=le<<16>>16,X=ne[W+(pt<<1)>>1]|0,he=X<<16>>16,J=X<<16>>16>0,le<<16>>16<=0){if(J){ne[W>>1]=X,X=he*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-3<<2)|0,(F[J>>2]|0)<(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=ne[W+-2>>1]|0,X<<16>>16>0){if(ne[W>>1]=X,X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,X=G+1310736+(X+-3<<2)|0,(F[X>>2]|0)>=(Qe|0)){X=Ce;break}F[X>>2]=Qe,X=Ce;break}else{if(X=Ce+1|0,(Ce|0)>32767)break t;ne[W>>1]=X,F[G+1179664+(Ce<<2)>>2]=X<<16>>16,Ce=Ce*7|0,F[G+1310736+(Ce<<2)>>2]=1,F[G+1310736+(Ce+1<<2)>>2]=Qe,F[G+1310736+(Ce+2<<2)>>2]=Je,F[G+1310736+(Ce+3<<2)>>2]=Qe,F[G+1310736+(Ce+4<<2)>>2]=Qe,F[G+1310736+(Ce+5<<2)>>2]=Je,F[G+1310736+(Ce+6<<2)>>2]=Je;break}}if(J){if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+(he+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,he=G+1310736+(X+-5<<2)|0,F[he>>2]=(F[he>>2]|0)+Je,F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(J=ne[W+-2>>1]|0,J<<16>>16<=0){ne[W>>1]=le,X=ce*7|0,J=G+1310736+(X+-7<<2)|0,F[J>>2]=(F[J>>2]|0)+1,J=G+1310736+(X+-6<<2)|0,F[J>>2]=(F[J>>2]|0)+Qe,J=G+1310736+(X+-5<<2)|0,F[J>>2]=(F[J>>2]|0)+Je,J=G+1310736+(X+-4<<2)|0,(F[J>>2]|0)>(Qe|0)&&(F[J>>2]=Qe),F[G+1310736+(X+-1<<2)>>2]=Je,X=Ce;break}if(X=F[G+1179664+(ce+-1<<2)>>2]|0,ce=F[G+1179664+((J<<16>>16)+-1<<2)>>2]|0,(X|0)>(ce|0))if(ne[W>>1]=ce,(Ce|0)>0)for(J=0,le=ee;;)if((F[le>>2]|0)==(X|0)&&(F[le>>2]=ce),J=J+1|0,(J|0)>=(Ce|0)){X=ce;break}else le=le+4|0;else X=ce;else if(ne[W>>1]=X,(X|0)<(ce|0)&(Ce|0)>0)for(J=0,le=ee;(F[le>>2]|0)==(ce|0)&&(F[le>>2]=X),J=J+1|0,!((J|0)>=(Ce|0));)le=le+4|0;X=(X<<16>>16)*7|0,he=G+1310736+(X+-7<<2)|0,F[he>>2]=(F[he>>2]|0)+1,he=G+1310736+(X+-6<<2)|0,F[he>>2]=(F[he>>2]|0)+Qe,X=G+1310736+(X+-5<<2)|0,F[X>>2]=(F[X>>2]|0)+Je,X=Ce}else ne[W>>1]=0,ie[O>>0]=0,X=Ce;while(!1);if(Qe=Qe+1|0,J=De+4|0,W=W+2|0,O=O+1|0,(Qe|0)>=(lt|0))break;De=J,Ce=X}else O=le;if(Je=Je+1|0,(Je|0)>=(At|0)){ce=X,Ye=52;break e}else le=O+2|0,J=J+8|0,W=W+4|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(W=G+12|0,(ce|0)<1)X=1;else for(J=1,X=1;O=F[ee>>2]|0,(O|0)==(J|0)?(O=X,X=X+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[ee>>2]=O,(J|0)<(ce|0);)J=J+1|0,ee=ee+4|0;if(le=G+8|0,O=X+-1|0,F[le>>2]=O,O){if(ii(W|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(X|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[le>>2]|0))}if((ce|0)>0){W=0;do ee=(F[G+1179664+(W<<2)>>2]|0)+-1|0,J=W*7|0,O=G+12+(ee<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(J<<2)>>2]|0),O=ee<<1,X=G+655376+(O<<3)|0,se[X>>3]=+se[X>>3]+ +(F[G+1310736+(J+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(J+2<<2)>>2]|0),ee=ee<<2,O=G+131084+(ee<<2)|0,X=F[G+1310736+(J+3<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),O=G+131084+((ee|1)<<2)|0,X=F[G+1310736+(J+4<<2)>>2]|0,(F[O>>2]|0)<(X|0)&&(F[O>>2]=X),O=G+131084+((ee|2)<<2)|0,X=F[G+1310736+(J+5<<2)>>2]|0,(F[O>>2]|0)>(X|0)&&(F[O>>2]=X),X=G+131084+((ee|3)<<2)|0,O=F[G+1310736+(J+6<<2)>>2]|0,(F[X>>2]|0)<(O|0)&&(F[X>>2]=O),W=W+1|0;while((W|0)<(ce|0))}if((F[le>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[le>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function dp(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,ce=(F[G+4>>2]|0)+O|0,lt=1,W=W+O|0,le=le+(O<<1)|0,ee=0;t:for(;;){if(Je)for(O=ce,We=1,Qe=W,De=ee;;){do if((fe[Qe>>0]|0|0)>(X|0)){if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}else ne[le>>1]=0,ie[O>>0]=0,ee=De;while(!1);if(We=We+1|0,W=Qe+1|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}else O=ce;if(lt=lt+1|0,(lt|0)>=(At|0)){he=ee,Ye=52;break e}else ce=O+2|0,W=W+2|0,le=le+4|0}Jn(3,3904,je),O=-1}else he=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function If(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,ce=(F[G+4>>2]|0)+O|0,lt=1,W=W+(O<<1)|0,le=le+(O<<1)|0,ee=0;t:for(;;){if(Je)for(O=ce,We=1,Qe=W,De=ee;;){do if((fe[Qe+1>>0]|0|0)>(X|0)){if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}else ne[le>>1]=0,ie[O>>0]=0,ee=De;while(!1);if(We=We+1|0,W=Qe+2|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}else O=ce;if(lt=lt+1|0,(lt|0)>=(At|0)){he=ee,Ye=52;break e}else ce=O+2|0,W=W+4|0,le=le+4|0}Jn(3,3904,je),O=-1}else he=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Rf(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,O=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,ce=(F[G+4>>2]|0)+O|0,lt=1,W=W+(O<<1)|0,le=le+(O<<1)|0,ee=0;t:for(;;){if(Je)for(O=ce,We=1,Qe=W,De=ee;;){do if((fe[Qe>>0]|0|0)>(X|0)){if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}else ne[le>>1]=0,ie[O>>0]=0,ee=De;while(!1);if(We=We+1|0,W=Qe+2|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}else O=ce;if(lt=lt+1|0,(lt|0)>=(At|0)){he=ee,Ye=52;break e}else ce=O+2|0,W=W+4|0,le=le+4|0}Jn(3,3904,je),O=-1}else he=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(he|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(he|0);)W=W+1|0,J=J+4|0;if(ce=G+8|0,O=ee+-1|0,F[ce>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[ce>>2]|0))}if((he|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(he|0))}if((F[ce>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[ce>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function Bf(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0;if(Qt=me,me=me+16|0,je=Qt,le=F[G>>2]|0,At=j+-1|0,(q|0)>0)for(O=0,ee=le,J=le+((kt(At,q)|0)<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(q|0));)ee=ee+2|0,J=J+2|0;if(Et=q+-1|0,(j|0)>0)for(O=0,ee=le,J=le+(Et<<1)|0;ne[J>>1]=0,ne[ee>>1]=0,O=O+1|0,!((O|0)>=(j|0));)ee=ee+(q<<1)|0,J=J+(q<<1)|0;J=G+1179664|0,ee=q+1|0,qe=0-q|0,pt=1-q|0,rt=~q;e:do if((At|0)>1){Je=(Et|0)>1,O=(F[G+4>>2]|0)+ee|0,lt=1,W=W+ee|0,le=le+(ee<<1)|0,X=X+ee|0,ee=0;t:for(;;){if(Je)for(We=1,Qe=W,De=ee;;){do if((fe[Qe>>0]|0)>(fe[X>>0]|0)){if(ie[O>>0]=-1,ee=ne[le+(qe<<1)>>1]|0,ee<<16>>16>0){ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ce=ne[le+(pt<<1)>>1]|0,he=ce<<16>>16,ee=ne[le+(rt<<1)>>1]|0,Ce=ee<<16>>16,W=ee<<16>>16>0,ce<<16>>16<=0){if(W){ne[le>>1]=ee,ee=Ce*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-3<<2)|0,(F[W>>2]|0)<(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=ne[le+-2>>1]|0,ee<<16>>16>0){if(ne[le>>1]=ee,ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,ee=G+1310736+(ee+-3<<2)|0,(F[ee>>2]|0)>=(We|0)){ee=De;break}F[ee>>2]=We,ee=De;break}else{if(ee=De+1|0,(De|0)>32767)break t;ne[le>>1]=ee,F[G+1179664+(De<<2)>>2]=ee<<16>>16,De=De*7|0,F[G+1310736+(De<<2)>>2]=1,F[G+1310736+(De+1<<2)>>2]=We,F[G+1310736+(De+2<<2)>>2]=lt,F[G+1310736+(De+3<<2)>>2]=We,F[G+1310736+(De+4<<2)>>2]=We,F[G+1310736+(De+5<<2)>>2]=lt,F[G+1310736+(De+6<<2)>>2]=lt;break}}if(W){if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+(Ce+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,Ce=G+1310736+(ee+-5<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+lt,F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(W=ne[le+-2>>1]|0,W<<16>>16<=0){ne[le>>1]=ce,ee=he*7|0,W=G+1310736+(ee+-7<<2)|0,F[W>>2]=(F[W>>2]|0)+1,W=G+1310736+(ee+-6<<2)|0,F[W>>2]=(F[W>>2]|0)+We,W=G+1310736+(ee+-5<<2)|0,F[W>>2]=(F[W>>2]|0)+lt,W=G+1310736+(ee+-4<<2)|0,(F[W>>2]|0)>(We|0)&&(F[W>>2]=We),F[G+1310736+(ee+-1<<2)>>2]=lt,ee=De;break}if(ee=F[G+1179664+(he+-1<<2)>>2]|0,he=F[G+1179664+((W<<16>>16)+-1<<2)>>2]|0,(ee|0)>(he|0))if(ne[le>>1]=he,(De|0)>0)for(W=0,ce=J;;)if((F[ce>>2]|0)==(ee|0)&&(F[ce>>2]=he),W=W+1|0,(W|0)>=(De|0)){ee=he;break}else ce=ce+4|0;else ee=he;else if(ne[le>>1]=ee,(ee|0)<(he|0)&(De|0)>0)for(W=0,ce=J;(F[ce>>2]|0)==(he|0)&&(F[ce>>2]=ee),W=W+1|0,!((W|0)>=(De|0));)ce=ce+4|0;ee=(ee<<16>>16)*7|0,Ce=G+1310736+(ee+-7<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+1,Ce=G+1310736+(ee+-6<<2)|0,F[Ce>>2]=(F[Ce>>2]|0)+We,ee=G+1310736+(ee+-5<<2)|0,F[ee>>2]=(F[ee>>2]|0)+lt,ee=De}else ne[le>>1]=0,ie[O>>0]=0,ee=De;while(!1);if(We=We+1|0,W=Qe+1|0,X=X+1|0,le=le+2|0,O=O+1|0,(We|0)>=(Et|0))break;Qe=W,De=ee}if(lt=lt+1|0,(lt|0)>=(At|0)){ce=ee,Ye=52;break e}else O=O+2|0,W=W+2|0,le=le+4|0,X=X+2|0}Jn(3,3904,je),O=-1}else ce=0,Ye=52;while(!1);if((Ye|0)==52){if(le=G+12|0,(ce|0)<1)ee=1;else for(W=1,ee=1;O=F[J>>2]|0,(O|0)==(W|0)?(O=ee,ee=ee+1|0):O=F[G+1179664+(O+-1<<2)>>2]|0,F[J>>2]=O,(W|0)<(ce|0);)W=W+1|0,J=J+4|0;if(X=G+8|0,O=ee+-1|0,F[X>>2]=O,O){if(ii(le|0,0,O<<2|0)|0,ii(G+655376|0,0,O<<4|0)|0,(ee|0)>1){O=0;do Ye=O<<2,F[G+131084+(Ye<<2)>>2]=q,F[G+131084+((Ye|1)<<2)>>2]=0,F[G+131084+((Ye|2)<<2)>>2]=j,F[G+131084+((Ye|3)<<2)>>2]=0,O=O+1|0;while((O|0)<(F[X>>2]|0))}if((ce|0)>0){le=0;do J=(F[G+1179664+(le<<2)>>2]|0)+-1|0,W=le*7|0,O=G+12+(J<<2)|0,F[O>>2]=(F[O>>2]|0)+(F[G+1310736+(W<<2)>>2]|0),O=J<<1,ee=G+655376+(O<<3)|0,se[ee>>3]=+se[ee>>3]+ +(F[G+1310736+(W+1<<2)>>2]|0),O=G+655376+((O|1)<<3)|0,se[O>>3]=+se[O>>3]+ +(F[G+1310736+(W+2<<2)>>2]|0),J=J<<2,O=G+131084+(J<<2)|0,ee=F[G+1310736+(W+3<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|1)<<2)|0,ee=F[G+1310736+(W+4<<2)>>2]|0,(F[O>>2]|0)<(ee|0)&&(F[O>>2]=ee),O=G+131084+((J|2)<<2)|0,ee=F[G+1310736+(W+5<<2)>>2]|0,(F[O>>2]|0)>(ee|0)&&(F[O>>2]=ee),ee=G+131084+((J|3)<<2)|0,O=F[G+1310736+(W+6<<2)>>2]|0,(F[ee>>2]|0)<(O|0)&&(F[ee>>2]=O),le=le+1|0;while((le|0)<(ce|0))}if((F[X>>2]|0)>0){O=0;do q=G+12+(O<<2)|0,j=O<<1,Ye=G+655376+(j<<3)|0,se[Ye>>3]=+se[Ye>>3]/+(F[q>>2]|0),j=G+655376+((j|1)<<3)|0,se[j>>3]=+se[j>>3]/+(F[q>>2]|0),O=O+1|0;while((O|0)<(F[X>>2]|0));O=0}else O=0}else O=0}return me=Qt,O|0}function fp(W){return W=W|0,Gp(W+8|0)|0}function Gp(W){W=W|0;var q=0,j=0;return j=me,me=me+16|0,q=$i(4)|0,q||(Jn(3,5472,j),zt(1)),W=ka(W)|0,F[q>>2]=W,W||(Mr(q),q=0),me=j,q|0}function l1(W){W=W|0;var q=0;return q=F[W>>2]|0,q?(El(q)|0,Mr(F[W>>2]|0),F[W>>2]=0,q=0):q=-1,q|0}function Lf(W){W=W|0;var q=0,j=0,X=0;if(j=me,me=me+16|0,q=$i(7062432)|0,q||(Jn(3,5472,j),zt(1)),F[q>>2]=0,F[q+4834148>>2]=0,F[q+7062408>>2]=0,F[q+4>>2]=-1,F[q+8>>2]=0,F[q+12>>2]=1,F[q+16>>2]=100,F[q+20>>2]=0,F[q+24>>2]=0,F[q+28>>2]=2,se[q+7062416>>3]=.5,F[q+7062424>>2]=3,F[q+32>>2]=W,X=F[W>>2]|0,F[q+36>>2]=X,W=F[W+4>>2]|0,F[q+40>>2]=W,F[q+44>>2]=0,F[q+15408>>2]=0,F[q+4834152>>2]=0,F[q+4818296>>2]=0,W=$i(kt(X<<1,W)|0)|0,F[q+4834144>>2]=W,!W)Jn(3,5472,j+8|0),zt(1);else return F[q+7062384>>2]=0,rl(q,2)|0,xo(q,0)|0,F[q+7062388>>2]=-1,Za(q,0)|0,F[q+7062392>>2]=7,F[q+7062396>>2]=0,me=j,q|0;return 0}function rl(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;O=me,me=me+16|0,j=O;e:do if(W)if(X=W+4|0,(F[X>>2]|0)!=(q|0)){switch(q|0){case 11:case 10:case 9:case 8:case 7:case 6:case 4:case 3:case 2:case 1:case 0:{G=0;break}case 14:case 13:case 12:case 5:{G=1;break}default:{F[j>>2]=q,Jn(3,3936,j),j=-1;break e}}if(F[X>>2]=q,F[W+8>>2]=nl(q)|0,j=W+7062408|0,q=F[j>>2]|0,q&&(vs(q),F[j>>2]=wl(F[W+36>>2]|0,F[W+40>>2]|0,F[X>>2]|0,0)|0),j=W+24|0,q=F[j>>2]|0,G)switch(q|0){case 0:{F[j>>2]=1,j=0;break e}case 3:{F[j>>2]=4,j=0;break e}default:{j=0;break e}}else switch(q|0){case 1:{F[j>>2]=4,j=0;break e}case 4:{F[j>>2]=3,j=0;break e}default:{j=0;break e}}}else j=0;else j=-1;while(!1);return me=O,j|0}function xo(W,q){W=W|0,q=q|0;var j=0,X=0,G=0;G=me,me=me+16|0,X=G;do if(W)if((F[W>>2]|0)!=(q|0)){if(F[W>>2]=q,!q){j=W+4834148|0,Mr(F[j>>2]|0),F[j>>2]=0,j=0;break}q=$i(kt(F[W+40>>2]|0,F[W+36>>2]|0)|0)|0,F[W+4834148>>2]=q,q?j=0:(Jn(3,5472,X),zt(1))}else j=0;else j=-1;while(!1);return me=G,j|0}function Za(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0;if(J=me,me=me+16|0,ee=J+8|0,G=J,W)if(O=W+7062388|0,(F[O>>2]|0)!=(q|0)){switch(j=W+7062408|0,X=F[j>>2]|0,X&&(vs(X),F[j>>2]=0),q|0){case 3:case 2:case 1:{F[j>>2]=wl(F[W+36>>2]|0,F[W+40>>2]|0,F[W+4>>2]|0,0)|0;break}case 4:{F[W+7062404>>2]=1,F[W+7062400>>2]=1,q=4;break}case 0:{q=0;break}default:Jn(3,3985,G),q=0}F[O>>2]=q,(F[W>>2]|0)==1&&(F[ee>>2]=F[760+(q<<2)>>2],Jn(3,4059,ee)),q=0}else q=0;else q=-1;return me=J,q|0}function Ga(W){W=W|0;var q=0,j=0;return W?(q=W+7062408|0,j=F[q>>2]|0,j&&(vs(j),F[q>>2]=0),Mr(F[W+4834144>>2]|0),Mr(F[W+4834148>>2]|0),Mr(W),q=0):q=-1,q|0}function g0(W,q){return W=W|0,q=q|0,(W|0)!=0&(q|0)!=0?(F[q>>2]=F[W>>2],W=0):W=-1,W|0}function sl(W,q){return W=W|0,q=q|0,(W|0)!=0&q>>>0<2?(F[W+12>>2]=q,W=0):W=-1,W|0}function ih(W,q){return W=W|0,q=q|0,(W|0)!=0&(q|0)!=0?(F[q>>2]=F[W+12>>2],W=0):W=-1,W|0}function ja(W,q){return W=W|0,q=q|0,(W|0)==0|q>>>0>255?W=-1:(F[W+16>>2]=q,W=0),W|0}function Zh(W,q){return W=W|0,q=q|0,(W|0)!=0&(q|0)!=0?(F[q>>2]=F[W+16>>2],W=0):W=-1,W|0}function Du(W,q){return W=W|0,q=q|0,(W|0)!=0&(q|0)!=0?(F[q>>2]=F[W+7062388>>2],W=0):W=-1,W|0}function c1(W,q){return W=W|0,q=q|0,(W|0)!=0&q>>>0<2?(F[W+20>>2]=q,W=0):W=-1,W|0}function Df(W,q){return W=W|0,q=q|0,W?(F[q>>2]=F[W+20>>2],W=0):W=-1,W|0}function ru(W,q){return W=W|0,q=q|0,(W|0)!=0&q>>>0<5?(F[W+24>>2]=q,W=0):W=-1,W|0}function Y0(W,q){return W=W|0,q=q|0,W?(F[W+7062424>>2]=q,W=0):W=-1,W|0}function Pf(W,q){return W=W|0,q=q|0,(W|0)!=0&(q|0)!=0?(F[q>>2]=F[W+7062424>>2],W=0):W=-1,W|0}function rh(W,q){return W=W|0,q=q|0,W?(F[q>>2]=F[W+24>>2],W=0):W=-1,W|0}function Nc(W,q){return W=W|0,q=+q,W|0&&!(q<=0|q>=1)?(se[W+7062416>>3]=q,W=0):W=-1,W|0}function u1(W,q){return W=W|0,q=q|0,W?(se[q>>3]=+se[W+7062416>>3],W=0):W=-1,W|0}function Ff(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0,ci=0,Rn=0,jr=0,wr=0,ks=0;jr=me,me=me+80|0,Di=jr+32|0,ei=jr+24|0,At=jr,Et=jr+52|0,Bn=jr+40|0,tr=jr+64|0,Rn=W+44|0,F[Rn>>2]=0,mi=W+7062388|0,X=F[mi>>2]|0;e:do if((X|0)==4){Yi=W+7062396|0,j=F[Yi>>2]|0;do if((j|0)>0)X=4,j=j+-1|0;else{Qt=W+16|0,Wn=F[Qt>>2]|0,Gn=W+7062400|0,je=(F[Gn>>2]|0)+Wn|0,je=(je|0)>255?255:je,F[Et>>2]=je,Pn=W+7062404|0,Ye=Wn-(F[Pn>>2]|0)|0,Ye=(Ye|0)<0?0:Ye,F[Et+4>>2]=Ye,F[Et+8>>2]=Wn,j=W+36|0,X=W+40|0,G=W+4|0,ee=W+12|0,J=W+20|0,le=W+4834144|0,Ce=W+15416|0,De=W+15408|0,Qe=W+7062384|0,We=W+24|0,pt=W+32|0,rt=W+7062416|0,qe=W+48|0,Je=W+7062424|0,lt=0;do{if((wc(q,F[j>>2]|0,F[X>>2]|0,F[G>>2]|0,F[W>>2]|0,F[ee>>2]|0,F[Et+(lt<<2)>>2]|0,F[J>>2]|0,le,0)|0)<0){j=-1;break e}(jh(F[j>>2]|0,F[X>>2]|0,le,F[J>>2]|0,1e6,70,1,Ce,De)|0)<0,(h1(q,F[j>>2]|0,F[X>>2]|0,F[G>>2]|0,Ce,F[De>>2]|0,F[Qe>>2]|0,F[J>>2]|0,F[We>>2]|0,(F[pt>>2]|0)+184|0,+se[rt>>3],qe,Rn,F[Je>>2]|0)|0)<0,F[Bn+(lt<<2)>>2]=F[Rn>>2],lt=lt+1|0}while((lt|0)<3);if((F[W>>2]|0)==1?(wn=F[Bn+4>>2]|0,G=F[Bn+8>>2]|0,X=F[Bn>>2]|0,F[At>>2]=Ye,F[At+4>>2]=wn,F[At+8>>2]=Wn,F[At+12>>2]=G,F[At+16>>2]=je,F[At+20>>2]=X,Jn(3,4153,At)):(X=F[Bn>>2]|0,G=F[Bn+8>>2]|0),j=F[Bn+4>>2]|0,(X|0)>(G|0)|(j|0)>(G|0)){X=(X|0)>=(j|0)?je:Ye,F[Qt>>2]=X,j=X-Wn|0,(j|0)>0?(F[Gn>>2]=j,j=1):(F[Gn>>2]=1,j=0-j|0),F[Pn>>2]=j,(F[W>>2]|0)==1&&(F[ei>>2]=X,Jn(3,4229,ei)),X=F[mi>>2]|0,j=F[W+7062392>>2]|0;break}j=F[Gn>>2]|0,X=F[Pn>>2]|0;do if((j|0)>=(X|0))if((j|0)>(X|0)){F[Pn>>2]=X+1;break}else{j=j+1|0,F[Gn>>2]=j,F[Pn>>2]=X+1;break}else j=j+1|0,F[Gn>>2]=j;while(!1);(j+Wn|0)>254&&(F[Gn>>2]=1,j=1),(Wn|0)<=(j|0)&&(F[Pn>>2]=1),F[Yi>>2]=F[W+7062392>>2],wn=47;break e}while(!1);F[Yi>>2]=j,wn=30}else wn=30;while(!1);e:do if((wn|0)==30){t:do switch(X|0){case 3:{if(X=W+7062408|0,j=f1(F[X>>2]|0,q,9,-7)|0,(j|0)<0||(j=F[X>>2]|0,X=W+4834144|0,j=wc(F[j>>2]|0,F[j+8>>2]|0,F[j+12>>2]|0,5,F[W>>2]|0,F[W+12>>2]|0,0,0,X,F[j+4>>2]|0)|0,(j|0)<0))break e;j=W+36|0,G=W+40|0,ee=W+20|0;break}case 2:case 1:{if(G=W+7062396|0,j=F[G>>2]|0,(j|0)>0){F[G>>2]=j+-1,wn=44;break t}if(j=F[W+7062408>>2]|0,(X|0)==1?j=kc(j,q,tr)|0:j=Of(j,q,tr)|0,(j|0)<0)break e;j=W+16|0,(F[W>>2]|0)==1&&(Gi=fe[tr>>0]|0,(F[j>>2]|0)!=(Gi|0))&&(F[Di>>2]=(F[mi>>2]|0)==1?4281:4288,F[Di+4>>2]=Gi,Jn(3,4293,Di)),F[j>>2]=fe[tr>>0],F[G>>2]=F[W+7062392>>2],wn=44;break}default:wn=44}while(!1);if((wn|0)==44&&(j=W+36|0,G=W+40|0,ee=W+20|0,X=W+4834144|0,(wc(q,F[j>>2]|0,F[G>>2]|0,F[W+4>>2]|0,F[W>>2]|0,F[W+12>>2]|0,F[W+16>>2]|0,F[ee>>2]|0,X,0)|0)<0)){j=-1;break}J=W+15416|0,le=W+15408|0,(jh(F[j>>2]|0,F[G>>2]|0,X,F[ee>>2]|0,1e6,70,1,J,le)|0)>=0&&(h1(q,F[j>>2]|0,F[G>>2]|0,F[W+4>>2]|0,J,F[le>>2]|0,F[W+7062384>>2]|0,F[ee>>2]|0,F[W+24>>2]|0,(F[W+32>>2]|0)+184|0,+se[W+7062416>>3],W+48|0,Rn,F[W+7062424>>2]|0)|0)>=0&&(wn=47)}while(!1);e:do if((wn|0)==47){if(pt=W+28|0,(F[pt>>2]|0)==1){Uc(W),j=0;break}if(rt=W+4818296|0,Qe=W+24|0,De=F[rt>>2]|0,(De|0)>0){We=0;do{if(X=F[Rn>>2]|0,G=W+4818304+(We*264|0)+56|0,ee=W+4818304+(We*264|0)+64|0,(X|0)>0)for(he=+(F[W+4818304+(We*264|0)>>2]|0),j=-1,J=0,ce=.5;;)if(O=+(F[W+48+(J<<8)>>2]|0),wr=he/O,!(wr<.7|wr>1.43)&&(wr=+se[W+48+(J<<8)+56>>3]-+se[G>>3],ci=+se[W+48+(J<<8)+64>>3]-+se[ee>>3],ci=(wr*wr+ci*ci)/O,ci<ce)?(j=J,O=ci):O=ce,J=J+1|0,(J|0)>=(X|0)){Ce=j;break}else ce=O;else Ce=-1;t:do if((Ce|0)>-1){switch(le=F[Qe>>2]|0,le|0){case 2:case 1:case 0:break;case 4:case 3:{if(G=W+48+(Ce<<8)+40|0,O=+se[W+4818304+(We*264|0)+40>>3],+se[G>>3]<O)X=W+4818304+(We*264|0)+48|0,j=W+48+(Ce<<8)+48|0;else if(j=W+48+(Ce<<8)+48|0,X=W+4818304+(We*264|0)+48|0,!(+se[j>>3]<+se[X>>3]))break t;for(se[G>>3]=O,F[W+48+(Ce<<8)+8>>2]=F[W+4818304+(We*264|0)+8>>2],se[j>>3]=+se[X>>3],F[W+48+(Ce<<8)+12>>2]=F[W+4818304+(We*264|0)+12>>2],j=-1,ce=1e8,G=0;;){O=0,X=0;do q=(X+G|0)%4|0,he=+se[W+4818304+(We*264|0)+168+(X<<4)>>3]-+se[W+48+(Ce<<8)+168+(q<<4)>>3],wr=+se[W+4818304+(We*264|0)+168+(X<<4)+8>>3]-+se[W+48+(Ce<<8)+168+(q<<4)+8>>3],O=O+(he*he+wr*wr),X=X+1|0;while((X|0)!=4);if(X=O<ce,j=X?G:j,G=G+1|0,(G|0)==4)break;ce=X?O:ce}q=4-j|0,F[W+48+(Ce<<8)+20>>2]=(q+(F[W+4818304+(We*264|0)+20>>2]|0)|0)%4|0,F[W+48+(Ce<<8)+24>>2]=(q+(F[W+4818304+(We*264|0)+24>>2]|0)|0)%4|0;break t}default:{j=-1;break e}}if(j=W+48+(Ce<<8)+32|0,he=+se[W+4818304+(We*264|0)+32>>3],+se[j>>3]<he){for(se[j>>3]=he,J=F[W+4818304+(We*264|0)+4>>2]|0,F[W+48+(Ce<<8)+4>>2]=J,G=W+4818304+(We*264|0)+16|0,j=-1,ce=1e8,ee=0;;){O=0,X=0;do q=(X+ee|0)%4|0,ks=+se[W+4818304+(We*264|0)+168+(X<<4)>>3]-+se[W+48+(Ce<<8)+168+(q<<4)>>3],wr=+se[W+4818304+(We*264|0)+168+(X<<4)+8>>3]-+se[W+48+(Ce<<8)+168+(q<<4)+8>>3],O=O+(ks*ks+wr*wr),X=X+1|0;while((X|0)!=4);if(O<ce?j=(4-ee+(F[G>>2]|0)|0)%4|0:O=ce,ee=ee+1|0,(ee|0)==4)break;ce=O}if(F[W+48+(Ce<<8)+16>>2]=j,le>>>0<2){F[W+48+(Ce<<8)+8>>2]=J,se[W+48+(Ce<<8)+40>>3]=he,F[W+48+(Ce<<8)+20>>2]=j;break}else{F[W+48+(Ce<<8)+12>>2]=J,se[W+48+(Ce<<8)+48>>3]=he,F[W+48+(Ce<<8)+24>>2]=j;break}}}while(!1);We=We+1|0}while((We|0)<(De|0))}if(Uc(W),(F[rt>>2]|0)>0){G=0,j=0;do X=W+4818304+(G*264|0)|0,wn=W+4818304+(G*264|0)+256|0,q=(F[wn>>2]|0)+1|0,F[wn>>2]=q,(q|0)<4&&((G|0)!=(j|0)&&Ko(W+4818304+(j*264|0)|0,X|0,264)|0,j=j+1|0),G=G+1|0;while((G|0)<(F[rt>>2]|0))}else j=0;F[rt>>2]=j,j=F[Rn>>2]|0;t:do if((j|0)>0){le=0;do{if(ee=W+48+(le<<8)|0,G=F[W+48+(le<<8)+4>>2]|0,(G|0)>=0){J=F[rt>>2]|0;n:do if((J|0)>0){X=0;do{if((F[W+4818304+(X*264|0)+4>>2]|0)==(G|0))break n;X=X+1|0}while((X|0)<(J|0))}else X=0;while(!1);if((X|0)==(J|0)){if((J|0)==60)break t;F[rt>>2]=J+1}Ko(W+4818304+(X*264|0)|0,ee|0,256)|0,F[W+4818304+(X*264|0)+256>>2]=1}le=le+1|0,j=F[Rn>>2]|0}while((le|0)<(j|0))}while(!1);if((F[pt>>2]|0)!=2&&(F[rt>>2]|0)>0)for(J=0;;){G=W+4818304+(J*264|0)+56|0,ee=W+4818304+(J*264|0)+64|0;t:do if((j|0)>0){ce=+(F[W+4818304+(J*264|0)>>2]|0),X=0;do{if(O=+(F[W+48+(X<<8)>>2]|0),ks=ce/O,!(ks<.7|ks>1.43)&&(wr=+se[W+48+(X<<8)+56>>3]-+se[G>>3],ks=+se[W+48+(X<<8)+64>>3]-+se[ee>>3],(wr*wr+ks*ks)/O<.5))break t;X=X+1|0}while((X|0)<(j|0))}else X=0;while(!1);if((X|0)==(j|0)&&(Ko(W+48+(j<<8)|0,W+4818304+(J*264|0)|0,256)|0,j=(F[Rn>>2]|0)+1|0,F[Rn>>2]=j),J=J+1|0,(J|0)>=(F[rt>>2]|0)){j=0;break}}else j=0}while(!1);return me=jr,j|0}function Uc(W){W=W|0;var q=0,j=0,X=0,G=0;switch(F[W+24>>2]|0){case 1:case 0:{if(j=F[W+44>>2]|0,(j|0)>0){X=0;do q=W+48+(X<<8)+4|0,(F[q>>2]|0)>-1&&+se[W+48+(X<<8)+32>>3]<.5&&(F[W+48+(X<<8)+8>>2]=-1,F[q>>2]=-1,F[W+48+(X<<8)+236>>2]=6),X=X+1|0;while((X|0)<(j|0))}break}case 2:{if(j=F[W+44>>2]|0,(j|0)>0){X=0;do q=W+48+(X<<8)+4|0,(F[q>>2]|0)>-1&&+se[W+48+(X<<8)+32>>3]<.5&&(F[W+48+(X<<8)+12>>2]=-1,F[q>>2]=-1,F[W+48+(X<<8)+236>>2]=6),X=X+1|0;while((X|0)<(j|0))}break}default:if(X=F[W+44>>2]|0,(X|0)>0){G=0;do q=W+48+(G<<8)+8|0,(F[q>>2]|0)>-1&&+se[W+48+(G<<8)+40>>3]<.5?(F[q>>2]=-1,j=0):j=1,q=W+48+(G<<8)+12|0,(F[q>>2]|0)>-1&&+se[W+48+(G<<8)+48>>3]<.5&&(F[q>>2]=-1,(j|0)==0)&&(F[W+48+(G<<8)+236>>2]=6),G=G+1|0;while((G|0)<(X|0))}}}function jh(W,q,j,X,G,O,ee,J,le){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=+ee,J=J|0,le=le|0;var ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0,tr=0,Di=0,wn=0;Di=me,me=me+96|0,ei=Di+56|0,Yi=Di+48|0,Pn=Di+8|0,mi=Di,tr=(X|0)==1,tr&&(W=(W|0)/2|0,q=(q|0)/2|0,G=(G|0)/4|0,O=(O|0)/4|0),F[le>>2]=0,Bn=j+8|0,Gn=W+-2|0,je=q+-2|0,Ye=j+1179664|0;e:do if((F[Bn>>2]|0)>0)for(Qt=0;;){lt=j+12+(Qt<<2)|0,At=F[lt>>2]|0;t:do if(!((At|0)<(O|0)|(At|0)>(G|0))&&(Wn=j+131084+(Qt<<4)|0,(F[Wn>>2]|0)!=1)&&(F[j+131084+(Qt<<4)+4>>2]|0)!=(Gn|0)&&(F[j+131084+(Qt<<4)+8>>2]|0)!=1&&(F[j+131084+(Qt<<4)+12>>2]|0)!=(je|0)&&(su(F[j>>2]|0,W,0,Ye,Qt+1|0,Wn,J+((F[le>>2]|0)*80048|0)|0)|0)>=0){if(rt=F[lt>>2]|0,Et=F[le>>2]|0,qe=J+(Et*80048|0)+28|0,q=F[qe>>2]|0,Je=J+(Et*80048|0)+40028|0,he=F[Je>>2]|0,At=J+(Et*80048|0)+24|0,Ce=(F[At>>2]|0)+-1|0,(Ce|0)>1)for(We=0,pt=1,X=0;De=(F[J+(Et*80048|0)+28+(pt<<2)>>2]|0)-q|0,De=kt(De,De)|0,Qe=(F[J+(Et*80048|0)+40028+(pt<<2)>>2]|0)-he|0,De=(kt(Qe,Qe)|0)+De|0,Qe=(De|0)>(We|0),X=Qe?pt:X,pt=pt+1|0,!((pt|0)>=(Ce|0));)We=Qe?De:We;else X=0;ce=+(rt|0)/.75*.01*ee,F[Yi>>2]=0,F[mi>>2]=0;n:do if((Zl(qe,Je,0,X,ce,ei,Yi)|0)>=0&&(Zl(qe,Je,X,(F[At>>2]|0)+-1|0,ce,Pn,mi)|0)>=0){q=F[Yi>>2]|0,he=F[mi>>2]|0;do if((q|0)==1&(he|0)==1)q=F[Pn>>2]|0,he=F[ei>>2]|0;else{if((q|0)>1&(he|0)==0){if(q=(X|0)/2|0,F[mi>>2]=0,F[Yi>>2]=0,(Zl(qe,Je,0,q,ce,ei,Yi)|0)<0||(Zl(qe,Je,q,X,ce,Pn,mi)|0)<0||!((F[Yi>>2]|0)==1&(F[mi>>2]|0)==1))break n;q=X,he=F[ei>>2]|0,X=F[Pn>>2]|0;break}if(!((q|0)==0&(he|0)>1)||(q=(X+-1+(F[At>>2]|0)|0)/2|0,F[mi>>2]=0,F[Yi>>2]=0,(Zl(qe,Je,X,q,ce,ei,Yi)|0)<0)||(Zl(qe,Je,q,(F[At>>2]|0)+-1|0,ce,Pn,mi)|0)<0||!((F[Yi>>2]|0)==1&(F[mi>>2]|0)==1))break n;q=F[Pn>>2]|0,he=X,X=F[ei>>2]|0}while(!1);if(F[J+(Et*80048|0)+80028>>2]=0,F[J+(Et*80048|0)+80032>>2]=he,F[J+(Et*80048|0)+80036>>2]=X,F[J+(Et*80048|0)+80040>>2]=q,F[J+(Et*80048|0)+80044>>2]=(F[At>>2]|0)+-1,F[J+((F[le>>2]|0)*80048|0)>>2]=F[lt>>2],At=F[le>>2]|0,se[J+(At*80048|0)+8>>3]=+se[j+655376+(Qt<<4)>>3],se[J+(At*80048|0)+16>>3]=+se[j+655376+(Qt<<4)+8>>3],At=At+1|0,F[le>>2]=At,(At|0)==60){X=60;break e}else break t}while(!1)}while(!1);if(Qt=Qt+1|0,(Qt|0)>=(F[Bn>>2]|0)){Gi=4;break}}else Gi=4;while(!1);if((Gi|0)==4&&(X=F[le>>2]|0),(X|0)>0){Ce=0;do if(W=Ce,Ce=Ce+1|0,O=J+(W*80048|0)+16|0,he=J+(W*80048|0)|0,(Ce|0)<(X|0)){ee=+se[J+(W*80048|0)+8>>3],G=Ce;do wn=ee-+se[J+(G*80048|0)+8>>3],ce=+se[O>>3]-+se[J+(G*80048|0)+16>>3],ce=wn*wn+ce*ce,X=F[he>>2]|0,W=J+(G*80048|0)|0,q=F[W>>2]|0,(X|0)>(q|0)?ce<+((X|0)/4|0|0)&&(F[W>>2]=0):ce<+((q|0)/4|0|0)&&(F[he>>2]=0),G=G+1|0,X=F[le>>2]|0;while((G|0)<(X|0))}while((Ce|0)<(X|0))}if((X|0)>0){G=0;do{if(!(F[J+(G*80048|0)>>2]|0)){if(W=G+1|0,(W|0)<(X|0))for(X=G,q=W;Ko(J+(X*80048|0)|0,J+(q*80048|0)|0,80048)|0,X=F[le>>2]|0,W=q+1|0,(W|0)<(X|0);)X=q,q=W;X=X+-1|0,F[le>>2]=X}G=G+1|0}while((G|0)<(X|0))}if(tr&(X|0)>0)for(q=0;;){if(F[J>>2]=F[J>>2]<<2,X=J+8|0,se[X>>3]=+se[X>>3]*2,X=J+16|0,se[X>>3]=+se[X>>3]*2,X=J+24|0,(F[X>>2]|0)>0){W=0;do tr=J+28+(W<<2)|0,F[tr>>2]=F[tr>>2]<<1,tr=J+40028+(W<<2)|0,F[tr>>2]=F[tr>>2]<<1,W=W+1|0;while((W|0)<(F[X>>2]|0))}if(q=q+1|0,(q|0)>=(F[le>>2]|0))break;J=J+80048|0}return me=Di,0}function su(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0;var J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0;lt=me,me=me+80032|0,De=lt+16|0,Ce=lt+8|0,le=lt,qe=lt+40024|0,Je=lt+24|0,rt=F[O+8>>2]|0,j=F[O>>2]|0,O=F[O+4>>2]|0;e:do if((j|0)<=(O|0)){for(J=j,j=W+((kt(rt,q)|0)+j<<1)|0;;){if(pt=ne[j>>1]|0,pt<<16>>16>0&&(F[X+((pt<<16>>16)+-1<<2)>>2]|0)==(G|0)){he=J;break}if((J|0)<(O|0))J=J+1|0,j=j+2|0;else{Et=6;break e}}for(Qe=ee+24|0,F[Qe>>2]=1,We=ee+28|0,F[We>>2]=he,pt=ee+40028|0,F[pt>>2]=rt,X=rt,ce=he,J=1,j=5;;){for(O=(j+5|0)%8|0,j=0;;){if(G=F[776+(O<<2)>>2]|0,le=F[808+(O<<2)>>2]|0,(ne[W+(le+ce+(kt(G+X|0,q)|0)<<1)>>1]|0)>0){j=G,G=O;break}if(j=j+1|0,O=(O+1|0)%8|0,(j|0)>=8){Et=11;break}}if((Et|0)==11){if(Et=0,(j|0)==8){Et=13;break}le=F[808+(O<<2)>>2]|0,j=F[776+(O<<2)>>2]|0,G=O}if(F[ee+28+(J<<2)>>2]=le+ce,O=F[Qe>>2]|0,F[ee+40028+(O<<2)>>2]=j+(F[ee+40028+(O+-1<<2)>>2]|0),j=F[Qe>>2]|0,O=ee+28+(j<<2)|0,(F[O>>2]|0)==(he|0)&&(F[ee+40028+(j<<2)>>2]|0)==(rt|0)){X=j,Et=16;break}if(J=j+1|0,F[Qe>>2]=J,(J|0)==9999){Et=19;break}X=F[ee+40028+(j<<2)>>2]|0,ce=F[O>>2]|0,j=G}if((Et|0)==13){Jn(3,4347,Ce),j=-1;break}else if((Et|0)==16){if((X|0)>1)for(le=0,G=1,O=0;j=(F[ee+28+(G<<2)>>2]|0)-he|0,j=kt(j,j)|0,J=(F[ee+40028+(G<<2)>>2]|0)-rt|0,j=(kt(J,J)|0)+j|0,J=(j|0)>(le|0),O=J?G:O,G=G+1|0,!((G|0)>=(X|0));)le=J?j:le;else O=0;if((O|0)>0){j=0;do F[qe+(j<<2)>>2]=F[ee+28+(j<<2)>>2],F[Je+(j<<2)>>2]=F[ee+40028+(j<<2)>>2],j=j+1|0;while((j|0)<(O|0))}if((O|0)<(X|0)){j=O;do rt=j-O|0,F[ee+28+(rt<<2)>>2]=F[ee+28+(j<<2)>>2],F[ee+40028+(rt<<2)>>2]=F[ee+40028+(j<<2)>>2],j=j+1|0;while((j|0)<(F[Qe>>2]|0))}if((O|0)>0){j=0;do rt=j-O|0,F[ee+28+((F[Qe>>2]|0)+rt<<2)>>2]=F[qe+(j<<2)>>2],F[ee+40028+((F[Qe>>2]|0)+rt<<2)>>2]=F[Je+(j<<2)>>2],j=j+1|0;while((j|0)<(O|0))}F[ee+28+(F[Qe>>2]<<2)>>2]=F[We>>2],F[ee+40028+(F[Qe>>2]<<2)>>2]=F[pt>>2],F[Qe>>2]=(F[Qe>>2]|0)+1,j=0;break}else if((Et|0)==19){Jn(3,4354,De),j=-1;break}}else Et=6;while(!1);return(Et|0)==6&&(Jn(3,4340,le),j=-1),me=lt,j|0}function Zl(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=+G,O=O|0,ee=ee|0;var J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0;if(J=F[q+(X<<2)>>2]|0,pt=F[q+(j<<2)>>2]|0,Qe=+(J-pt|0),he=F[W+(j<<2)>>2]|0,rt=F[W+(X<<2)>>2]|0,Ce=+(he-rt|0),ce=+((kt(rt,pt)|0)-(kt(he,J)|0)|0),J=j+1|0,(J|0)<(X|0)){le=0,he=J;do qe=ce+(Qe*+(F[W+(he<<2)>>2]|0)+Ce*+(F[q+(he<<2)>>2]|0)),qe=qe*qe,rt=qe>le,le=rt?qe:le,J=rt?he:J,he=he+1|0;while((he|0)<(X|0))}else le=0;return le/(Qe*Qe+Ce*Ce)>G?(Zl(W,q,j,J,G,O,ee)|0)>=0&&(De=F[ee>>2]|0,(De|0)<=5)&&(F[O+(De<<2)>>2]=J,F[ee>>2]=(F[ee>>2]|0)+1,(Zl(W,q,J,X,G,O,ee)|0)>=0)?We=7:J=-1:We=7,(We|0)==7&&(J=0),J|0}function ed(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0;var J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0;Et=me,me=me+16|0,pt=Et+4|0,rt=Et,qe=jo(2)|0,Je=jo(2)|0,lt=Ja(2,2)|0,De=0;e:for(;;){if(Qe=De,De=De+1|0,We=F[X+(De<<2)>>2]|0,J=F[X+(Qe<<2)>>2]|0,Ce=+(We+1-J|0)*.05+.5,J=~~(+(J|0)+Ce),We=~~(+(We|0)-Ce)-J|0,ce=We+1|0,j=Ja(ce,2)|0,(We|0)>-1){We=0;do{if(At=We+J|0,(Ma(G,+(F[W+(At<<2)>>2]|0),+(F[q+(At<<2)>>2]|0),pt,rt)|0)<0){J=10;break e}At=We<<1,je=F[j>>2]|0,se[je+(At<<3)>>3]=+ve[pt>>2],se[je+((At|1)<<3)>>3]=+ve[rt>>2],We=We+1|0}while((We|0)<(ce|0))}if((Zo(j,lt,qe,Je)|0)<0){J=10;break}if(je=F[lt>>2]|0,he=+se[je+8>>3],se[O+(Qe*24|0)>>3]=he,Ce=-+se[je>>3],se[O+(Qe*24|0)+8>>3]=Ce,je=F[Je>>2]|0,se[O+(Qe*24|0)+16>>3]=-(he*+se[je>>3]+ +se[je+8>>3]*Ce),es(j)|0,(De|0)>=4){J=7;break}}e:do if((J|0)==7)for(es(lt)|0,b0(Je)|0,b0(qe)|0,De=0;;){if(j=(De+3|0)%4|0,J=O+(j*24|0)|0,le=+se[O+(De*24|0)+8>>3],ce=O+(De*24|0)|0,he=+se[O+(j*24|0)+8>>3],Ce=+se[J>>3]*le-+se[ce>>3]*he,+Nn(+Ce)<1e-4){j=-1;break e}if(je=O+(De*24|0)+16|0,At=O+(j*24|0)+16|0,se[ee+(De<<4)>>3]=(he*+se[je>>3]-le*+se[At>>3])/Ce,se[ee+(De<<4)+8>>3]=(+se[ce>>3]*+se[At>>3]-+se[J>>3]*+se[je>>3])/Ce,De=De+1|0,(De|0)>=4){j=0;break}}else(J|0)==10&&(es(j)|0,es(lt)|0,b0(Je)|0,b0(qe)|0,j=-1);while(!1);return me=Et,j|0}function h1(W,q,j,X,G,O,ee,J,le,ce,he,Ce,De,Qe){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0,J=J|0,le=le|0,ce=ce|0,he=+he,Ce=Ce|0,De=De|0,Qe=Qe|0;var We=0,pt=0,rt=0,qe=0,Je=0,lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0;if(Wn=me,me=me+16|0,Bn=Wn+4|0,Gn=Wn,At=le>>>0<2,je=(le|0)==2,(O|0)>0){Qt=0,We=0;do{if(F[Ce+(We<<8)>>2]=F[G+(Qt*80048|0)>>2],(Ma(ce,+se[G+(Qt*80048|0)+8>>3],+se[G+(Qt*80048|0)+16>>3],Bn,Gn)|0)>=0&&(se[Ce+(We<<8)+56>>3]=+ve[Bn>>2],se[Ce+(We<<8)+64>>3]=+ve[Gn>>2],Ye=Ce+(We<<8)+168|0,(ed(G+(Qt*80048|0)+28|0,G+(Qt*80048|0)+40028|0,F[G+(Qt*80048|0)+24>>2]|0,G+(Qt*80048|0)+80028|0,ce,Ce+(We<<8)+72|0,Ye)|0)>=0)){switch(pt=Ce+(We<<8)+8|0,rt=Ce+(We<<8)+20|0,qe=Ce+(We<<8)+40|0,Je=Ce+(We<<8)+12|0,lt=Ce+(We<<8)+24|0,Et=Ce+(We<<8)+48|0,oh(ee,J,le,W,q,j,X,ce,Ye,he,pt,rt,qe,Je,lt,Et,Qe,Ce+(We<<8)+240|0,Ce+(We<<8)+248|0)|0){case 0:{F[Ce+(We<<8)+236>>2]=0;break}case-1:{F[Ce+(We<<8)+236>>2]=2;break}case-2:{F[Ce+(We<<8)+236>>2]=3;break}case-3:{F[Ce+(We<<8)+236>>2]=4;break}case-4:{F[Ce+(We<<8)+236>>2]=5;break}case-5:{F[Ce+(We<<8)+236>>2]=9;break}case-6:{F[Ce+(We<<8)+236>>2]=1;break}default:}At?(F[Ce+(We<<8)+4>>2]=F[pt>>2],F[Ce+(We<<8)+16>>2]=F[rt>>2],se[Ce+(We<<8)+32>>3]=+se[qe>>3]):je&&(F[Ce+(We<<8)+4>>2]=F[Je>>2],F[Ce+(We<<8)+16>>2]=F[lt>>2],se[Ce+(We<<8)+32>>3]=+se[Et>>3]),We=We+1|0}Qt=Qt+1|0}while((Qt|0)<(O|0))}else We=0;return F[De>>2]=We,me=Wn,0}function nd(W,q,j,X){W=W|0,q=q|0,j=+j,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0;return J=me,me=me+288|0,ce=J+200|0,le=J+104|0,G=J+264|0,ee=J+8|0,O=J,Ce=F[q+16>>2]|0,De=(4-Ce|0)%4|0,se[ce>>3]=+se[q+168+(De<<4)>>3],se[ce+8>>3]=+se[q+168+(De<<4)+8>>3],De=(5-Ce|0)%4|0,se[ce+16>>3]=+se[q+168+(De<<4)>>3],se[ce+24>>3]=+se[q+168+(De<<4)+8>>3],De=(6-Ce|0)%4|0,se[ce+32>>3]=+se[q+168+(De<<4)>>3],se[ce+40>>3]=+se[q+168+(De<<4)+8>>3],Ce=(7-Ce|0)%4|0,se[ce+48>>3]=+se[q+168+(Ce<<4)>>3],se[ce+56>>3]=+se[q+168+(Ce<<4)+8>>3],he=j*-.5,se[le>>3]=he,j=j*.5,se[le+8>>3]=j,se[le+16>>3]=0,se[le+24>>3]=j,se[le+32>>3]=j,se[le+40>>3]=0,se[le+48>>3]=j,se[le+56>>3]=he,se[le+64>>3]=0,se[le+72>>3]=he,se[le+80>>3]=he,se[le+88>>3]=0,F[G>>2]=ce,F[G+4>>2]=le,F[G+8>>2]=4,(H1(F[W>>2]|0,ce,le,4,ee)|0)<0?j=1e8:(De=(Cc(F[W>>2]|0,G,ee,X,O)|0)<0,j=De?1e8:+se[O>>3]),me=J,+j}function d1(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=+X,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0;return ee=me,me=me+192|0,ce=ee+104|0,le=ee+8|0,J=ee+168|0,O=ee,Ce=F[q+16>>2]|0,De=(4-Ce|0)%4|0,se[ce>>3]=+se[q+168+(De<<4)>>3],se[ce+8>>3]=+se[q+168+(De<<4)+8>>3],De=(5-Ce|0)%4|0,se[ce+16>>3]=+se[q+168+(De<<4)>>3],se[ce+24>>3]=+se[q+168+(De<<4)+8>>3],De=(6-Ce|0)%4|0,se[ce+32>>3]=+se[q+168+(De<<4)>>3],se[ce+40>>3]=+se[q+168+(De<<4)+8>>3],Ce=(7-Ce|0)%4|0,se[ce+48>>3]=+se[q+168+(Ce<<4)>>3],se[ce+56>>3]=+se[q+168+(Ce<<4)+8>>3],he=X*-.5,se[le>>3]=he,X=X*.5,se[le+8>>3]=X,se[le+16>>3]=0,se[le+24>>3]=X,se[le+32>>3]=X,se[le+40>>3]=0,se[le+48>>3]=X,se[le+56>>3]=he,se[le+64>>3]=0,se[le+72>>3]=he,se[le+80>>3]=he,se[le+88>>3]=0,F[J>>2]=ce,F[J+4>>2]=le,F[J+8>>2]=4,q=(Cc(F[W>>2]|0,J,j,G,O)|0)<0,me=ee,+(q?1e8:+se[O>>3])}function v0(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0;var ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0;if(De=me,me=me+32|0,ce=De+20|0,he=De,ee=$i(G<<4)|0,F[ce>>2]=ee,ee||(Jn(3,5472,De+8|0),zt(1)),J=$i(G*24|0)|0,le=ce+4|0,F[le>>2]=J,J||(Jn(3,5472,De+16|0),zt(1)),(G|0)>0){Ce=0;do se[ee+(Ce<<4)>>3]=+se[j+(Ce<<4)>>3],se[ee+(Ce<<4)+8>>3]=+se[j+(Ce<<4)+8>>3],se[J+(Ce*24|0)>>3]=+se[X+(Ce*24|0)>>3],se[J+(Ce*24|0)+8>>3]=+se[X+(Ce*24|0)+8>>3],se[J+(Ce*24|0)+16>>3]=+se[X+(Ce*24|0)+16>>3],Ce=Ce+1|0;while((Ce|0)<(G|0))}return F[ce+8>>2]=G,(Cc(F[W>>2]|0,ce,q,O,he)|0)<0&&(se[he>>3]=1e8),Mr(F[ce>>2]|0),Mr(F[le>>2]|0),me=De,+ +se[he>>3]}function e0(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0;var ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0;if(De=me,me=me+32|0,ce=De+20|0,he=De,ee=$i(G<<4)|0,F[ce>>2]=ee,ee||(Jn(3,5472,De+8|0),zt(1)),J=$i(G*24|0)|0,le=ce+4|0,F[le>>2]=J,J||(Jn(3,5472,De+16|0),zt(1)),(G|0)>0){Ce=0;do se[ee+(Ce<<4)>>3]=+se[j+(Ce<<4)>>3],se[ee+(Ce<<4)+8>>3]=+se[j+(Ce<<4)+8>>3],se[J+(Ce*24|0)>>3]=+se[X+(Ce*24|0)>>3],se[J+(Ce*24|0)+8>>3]=+se[X+(Ce*24|0)+8>>3],se[J+(Ce*24|0)+16>>3]=+se[X+(Ce*24|0)+16>>3],Ce=Ce+1|0;while((Ce|0)<(G|0))}return F[ce+8>>2]=G,(G1(F[W>>2]|0,ce,q,O,he)|0)<0&&(se[he>>3]=1e8),Mr(F[ce>>2]|0),Mr(F[le>>2]|0),me=De,+ +se[he>>3]}function wl(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0;G=$i(2080)|0;e:do if(G){F[G+2068>>2]=j;t:do if(X)O=4;else{switch(j|0){case 5:case 12:case 13:case 14:break;default:{O=4;break t}}F[G+2076>>2]=0}while(!1);do if((O|0)==4)if(O=$i(kt(q,W)|0)|0,F[G>>2]=O,O){F[G+2076>>2]=1;break}else{Mr(G),G=0;break e}while(!1);F[G+2072>>2]=X,F[G+4>>2]=0,F[G+8>>2]=W,F[G+12>>2]=q}while(!1);return G|0}function vs(W){W=W|0,W&&(F[W+2076>>2]|0&&Mr(F[W>>2]|0),Mr(F[W+4>>2]|0),Mr(W))}function Or(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0;ee=me,me=me+16|0,X=ee,j=F[W+2068>>2]|0;e:do switch(j|0){case 5:case 12:case 13:case 14:if(F[W+2072>>2]|0){Ko(F[W>>2]|0,q|0,kt(F[W+12>>2]|0,F[W+8>>2]|0)|0)|0,j=0;break e}else{F[W>>2]=q,j=0;break e}default:{if((j&-2|0)==2){if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(ie[(F[W>>2]|0)+G>>0]=(((fe[q+(O|1)>>0]|0)+(fe[q+O>>0]|0)+(fe[q+(O|2)>>0]|0)|0)>>>0)/3|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break e}else O=O+4|0}if((j&-3|0)==4){if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(ie[(F[W>>2]|0)+G>>0]=(((fe[q+(O|2)>>0]|0)+(fe[q+(O|1)>>0]|0)+(fe[q+(O|3)>>0]|0)|0)>>>0)/3|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break e}else O=O+4|0}if(j>>>0<2){if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(ie[(F[W>>2]|0)+G>>0]=(((fe[q+(O+1)>>0]|0)+(fe[q+O>>0]|0)+(fe[q+(O+2)>>0]|0)|0)>>>0)/3|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break e}else O=O+3|0}switch(j|0){case 8:{if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(ie[(F[W>>2]|0)+G>>0]=ie[q+O>>0]|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break}else O=O+2|0;break}case 7:{if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(ie[(F[W>>2]|0)+G>>0]=ie[q+(O|1)>>0]|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break}else O=O+2|0;break}case 9:{if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(le=fe[q+O>>0]|0,J=fe[q+(O|1)>>0]|0,ie[(F[W>>2]|0)+G>>0]=(((le&248)+10+(le<<5&224)+(J>>>3&28)+(J<<3&248)|0)>>>0)/3|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break}else O=O+2|0;break}case 10:{if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(J=fe[q+O>>0]|0,le=fe[q+(O|1)>>0]|0,ie[(F[W>>2]|0)+G>>0]=(((J&248)+12+(J<<5&224)+(le>>>3&24)+(le<<2&248)|0)>>>0)/3|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break}else O=O+2|0;break}case 11:{if(j=W+8|0,X=W+12|0,kt(F[X>>2]|0,F[j>>2]|0)|0)G=0,O=0;else{j=0;break e}for(;;)if(le=fe[q+O>>0]|0,ie[(F[W>>2]|0)+G>>0]=(((le&240)+24+(le<<4&240)+((fe[q+(O|1)>>0]|0)&240)|0)>>>0)/3|0,G=G+1|0,G>>>0>=(kt(F[X>>2]|0,F[j>>2]|0)|0)>>>0){j=0;break}else O=O+2|0;break}default:{Jn(3,4361,X),j=-1;break e}}}}while(!1);return me=ee,j|0}function I0(W,q){W=W|0,q=q|0;var j=0,X=0;if((W|0)!=0&(q|0)!=0&&(Or(W,q)|0)>=0)if(ii(W+16|0,0,1024)|0,q=F[W>>2]|0,X=kt(F[W+12>>2]|0,F[W+8>>2]|0)|0,j=q+X|0,(X|0)>0){do X=W+16+((fe[q>>0]|0)<<2)|0,F[X>>2]=(F[X>>2]|0)+1,q=q+1|0;while(q>>>0<j>>>0);q=0}else q=0;else q=-1;return q|0}function Pu(W,q){W=W|0,q=q|0;var j=0;if(q=I0(W,q)|0,(q|0)>=0){q=0,j=0;do q=(F[W+16+(j<<2)>>2]|0)+q|0,F[W+1040+(j<<2)>>2]=q,j=j+1|0;while((j|0)!=256);q=0}return q|0}function ou(W,q,j,X){W=W|0,q=q|0,j=+j,X=X|0;var G=0,O=0,ee=0;if(j<0|j>1)q=-1;else if(q=Pu(W,q)|0,(q|0)>=0){for(ee=~~(+(kt(F[W+12>>2]|0,F[W+8>>2]|0)|0)*j)>>>0,q=0;O=q&255,G=F[W+1040+(O<<2)>>2]|0,G>>>0<ee>>>0;)q=q+1<<24>>24;if((G|0)==(ee|0))do q=q+1<<24>>24;while((F[W+1040+((q&255)<<2)>>2]|0)==(ee|0));ie[X>>0]=((q&255)+O|0)>>>1,q=0}return q|0}function kc(W,q,j){return W=W|0,q=q|0,j=j|0,ou(W,q,.5,j)|0}function Of(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0;if(q=I0(W,q)|0,(q|0)>=0){q=1,X=0;do X=X+ +((kt(F[W+16+(q<<2)>>2]|0,q)|0)>>>0),q=q+1|0;while((q|0)!=256);for(le=+(kt(F[W+12>>2]|0,F[W+8>>2]|0)|0),ce=0,O=0,q=0,J=0,he=0;;){if(G=F[W+16+(ce<<2)>>2]|0,he=he+ +(G>>>0),he!=0){if(ee=le-he,ee==0)break;O=O+ +((kt(ce,G)|0)>>>0),Ce=O/he-(X-O)/ee,ee=Ce*(he*ee*Ce),ee>J?q=ce&255:ee=J}else ee=J;if((ce&255)<<24>>24==-1)break;ce=ce+1|0,J=ee}ie[j>>0]=q,q=0}return q|0}function f1(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0,rt=0,qe=0;q=I0(W,q)|0;do if((q|0)>=0){if(rt=W+4|0,F[rt>>2]|0)pt=W+8|0,G=W+12|0;else if(q=W+8|0,G=W+12|0,pt=$i(kt(F[G>>2]|0,F[q>>2]|0)|0)|0,F[rt>>2]=pt,pt)pt=q;else{q=-1;break}if(Qe=j>>1,We=0-Qe|0,q=F[G>>2]|0,(q|0)>0){he=(Qe|0)<(We|0),Ce=(Qe|0)<(We|0),De=0;do{if(q=F[pt>>2]|0,(q|0)>0){ce=0;do{if(he)O=0,j=0;else for(O=0,le=We,j=0;;){if(ee=le+De|0,(ee|0)>=0&&(ee|0)<(F[G>>2]|0)&&(qe=kt(q,ee)|0,!Ce))for(J=We;ee=J+ce|0,(ee|0)>-1&(ee|0)<(q|0)&&(O=O+1|0,j=(fe[(F[W>>2]|0)+(qe+ee)>>0]|0)+j|0),(J|0)<(Qe|0);)J=J+1|0;if((le|0)<(Qe|0))le=le+1|0;else break}le=(kt(q,De)|0)+ce|0,ie[(F[rt>>2]|0)+le>>0]=(j|0)/(O|0)|0,ce=ce+1|0,q=F[pt>>2]|0}while((ce|0)<(q|0))}De=De+1|0,q=F[G>>2]|0}while((De|0)<(q|0))}if(X|0&&(kt(q,F[pt>>2]|0)|0)>0){q=0;do W=(F[rt>>2]|0)+q|0,ie[W>>0]=(fe[W>>0]|0)+X,q=q+1|0;while((q|0)<(kt(F[G>>2]|0,F[pt>>2]|0)|0));q=0}else q=0}while(!1);return q|0}function wc(W,q,j,X,G,O,ee,J,le,ce){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0,J=J|0,le=le|0,ce=ce|0;var he=0;e:do switch(G|0){case 0:{switch(O|0){case 1:{if(ce){he=Td(W,q,j,ce,le)|0;break e}switch(J|0){case 0:{if(X>>>0<2){he=wh(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=Mh(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=Sd(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=Md(W,q,j,ee,le)|0;break e}case 8:{he=Th(W,q,j,ee,le)|0;break e}case 7:{he=bd(W,q,j,ee,le)|0;break e}case 9:{he=Sh(W,q,j,ee,le)|0;break e}case 10:{he=sc(W,q,j,ee,le)|0;break e}case 11:{he=bh(W,q,j,ee,le)|0;break e}default:zt(0)}break}case 1:{if(X>>>0<2){he=Cd(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=Hu(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=yh(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=Ch(W,q,j,ee,le)|0;break e}case 8:{he=du(W,q,j,ee,le)|0;break e}case 7:{he=xh(W,q,j,ee,le)|0;break e}case 9:{he=xd(W,q,j,ee,le)|0;break e}case 10:{he=Vu(W,q,j,ee,le)|0;break e}case 11:{he=wd(W,q,j,ee,le)|0;break e}default:zt(0)}break}default:zt(0)}break}case 0:{if(ce){he=Ih(W,q,j,ce,le)|0;break e}switch(J|0){case 0:{if(X>>>0<2){he=Wu(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=ac(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=Dl(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=Dd(W,q,j,ee,le)|0;break e}case 8:{he=Wc(W,q,j,ee,le)|0;break e}case 7:{he=Pd(W,q,j,ee,le)|0;break e}case 9:{he=Ll(W,q,j,ee,le)|0;break e}case 10:{he=qo(W,q,j,ee,le)|0;break e}case 11:{he=c0(W,q,j,ee,le)|0;break e}default:zt(0)}break}case 1:{if(X>>>0<2){he=Id(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=Bd(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=j0(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=oc(W,q,j,ee,le)|0;break e}case 8:{he=Wa(W,q,j,ee,le)|0;break e}case 7:{he=La(W,q,j,ee,le)|0;break e}case 9:{he=Rd(W,q,j,ee,le)|0;break e}case 10:{he=zu(W,q,j,ee,le)|0;break e}case 11:{he=Ld(W,q,j,ee,le)|0;break e}default:zt(0)}break}default:zt(0)}break}default:zt(0)}break}case 1:{switch(O|0){case 1:{if(ce){he=lo(W,q,j,ce,le)|0;break e}switch(J|0){case 0:{if(X>>>0<2){he=C0(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=D0(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=Il(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=Va(W,q,j,ee,le)|0;break e}case 8:{he=Ba(W,q,j,ee,le)|0;break e}case 7:{he=V0(W,q,j,ee,le)|0;break e}case 9:{he=H0(W,q,j,ee,le)|0;break e}case 10:{he=Tl(W,q,j,ee,le)|0;break e}case 11:{he=Z0(W,q,j,ee,le)|0;break e}default:zt(0)}break}case 1:{if(X>>>0<2){he=Rh(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=Xc(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=Od(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=ma(W,q,j,ee,le)|0;break e}case 8:{he=J0(W,q,j,ee,le)|0;break e}case 7:{he=L0(W,q,j,ee,le)|0;break e}case 9:{he=$c(W,q,j,ee,le)|0;break e}case 10:{he=fu(W,q,j,ee,le)|0;break e}case 11:{he=Fd(W,q,j,ee,le)|0;break e}default:zt(0)}break}default:zt(0)}break}case 0:{if(ce){he=Bf(W,q,j,ce,le)|0;break e}switch(J|0){case 0:{if(X>>>0<2){he=Oc(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=bf(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=Jl(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=dp(W,q,j,ee,le)|0;break e}case 8:{he=Rf(W,q,j,ee,le)|0;break e}case 7:{he=If(W,q,j,ee,le)|0;break e}case 9:{he=Mf(W,q,j,ee,le)|0;break e}case 10:{he=Tf(W,q,j,ee,le)|0;break e}case 11:{he=xl(W,q,j,ee,le)|0;break e}default:zt(0)}break}case 1:{if(X>>>0<2){he=za(W,q,j,ee,le)|0;break e}if((X&-2|0)==2){he=Rl(W,q,j,ee,le)|0;break e}if((X&-3|0)==4){he=Bl(W,q,j,ee,le)|0;break e}switch(X|0){case 5:case 12:case 13:case 14:{he=Ic(W,q,j,ee,le)|0;break e}case 8:{he=P0(W,q,j,ee,le)|0;break e}case 7:{he=x0(W,q,j,ee,le)|0;break e}case 9:{he=bc(W,q,j,ee,le)|0;break e}case 10:{he=bo(W,q,j,ee,le)|0;break e}case 11:{he=Tc(W,q,j,ee,le)|0;break e}default:zt(0)}break}default:zt(0)}break}default:zt(0)}break}default:zt(0)}while(!1);return he|0}function p1(W,q){W=W|0,q=q|0;var j=0;return W|0&&(j=W+7062384|0,(F[j>>2]|0)==0)?(F[j>>2]=q,j=0):j=-1,j|0}function au(W){W=W|0;var q=0;return W|0&&(q=W+7062384|0,(F[q>>2]|0)!=0)?(F[q>>2]=0,q=0):q=-1,q|0}function Nf(){return sh(16,50)|0}function sh(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0,pt=0;pt=me,me=me+64|0,We=pt+56|0,Qe=pt+48|0,J=pt+40|0,ee=pt+32|0,O=pt+24|0,G=pt+16|0,X=pt+8|0,j=pt;e:do if((W+-16|0)>>>0>48|(q|0)<1)De=0;else if(Ce=$i(32)|0,Ce||(Jn(3,5472,j),zt(1)),F[Ce>>2]=0,F[Ce+4>>2]=q,F[Ce+28>>2]=W,he=$i(q<<2)|0,F[Ce+8>>2]=he,he||(Jn(3,5472,X),zt(1)),j=q<<4,ce=$i(j)|0,F[Ce+12>>2]=ce,ce||(Jn(3,5472,G),zt(1)),G=$i(j)|0,le=Ce+20|0,F[le>>2]=G,G||(Jn(3,5472,O),zt(1)),j=q<<5,O=$i(j)|0,F[Ce+16>>2]=O,O||(Jn(3,5472,ee),zt(1)),ee=$i(j)|0,F[Ce+24>>2]=ee,ee||(Jn(3,5472,J),zt(1)),X=kt(W,W)|0,j=X*12|0,X=X<<2,(q|0)>0){W=0;t:for(;;){for(F[he+(W<<2)>>2]=0,G=W<<2,ee=0;!((ee|0)>=4);){if(J=$i(j)|0,O=ee+G|0,F[ce+(O<<2)>>2]=J,!J){j=18;break t}if(J=$i(X)|0,F[(F[le>>2]|0)+(O<<2)>>2]=J,J)ee=ee+1|0;else{j=20;break t}}if(W=W+1|0,(W|0)>=(q|0)){De=Ce;break e}}(j|0)==18?(Jn(3,5472,Qe),zt(1)):(j|0)==20&&(Jn(3,5472,We),zt(1))}else De=Ce;while(!1);return me=pt,De|0}function jl(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0,J=0;if(!W)q=-1;else{if(q=W+4|0,j=W+8|0,X=W+12|0,G=W+20|0,(F[q>>2]|0)>0){O=0;do F[(F[j>>2]|0)+(O<<2)>>2]|0&&U0(W,O)|0,ee=O<<2,Mr(F[(F[X>>2]|0)+(ee<<2)>>2]|0),Mr(F[(F[G>>2]|0)+(ee<<2)>>2]|0),J=1+ee|0,Mr(F[(F[X>>2]|0)+(J<<2)>>2]|0),Mr(F[(F[G>>2]|0)+(J<<2)>>2]|0),J=2+ee|0,Mr(F[(F[X>>2]|0)+(J<<2)>>2]|0),Mr(F[(F[G>>2]|0)+(J<<2)>>2]|0),ee=3+ee|0,Mr(F[(F[X>>2]|0)+(ee<<2)>>2]|0),Mr(F[(F[G>>2]|0)+(ee<<2)>>2]|0),O=O+1|0;while((O|0)<(F[q>>2]|0))}Mr(W),q=0}return q|0}function oh(W,q,j,X,G,O,ee,J,le,ce,he,Ce,De,Qe,We,pt,rt,qe,Je){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0,J=J|0,le=le|0,ce=+ce,he=he|0,Ce=Ce|0,De=De|0,Qe=Qe|0,We=We|0,pt=pt|0,rt=rt|0,qe=qe|0,Je=Je|0;var lt=0,Et=0,At=0,je=0,Ye=0,Qt=0,Bn=0,Gn=0,Wn=0,ei=0,Pn=0,Yi=0,mi=0,Gi=0;Gi=me,me=me+12448|0,At=Gi+12440|0,Et=Gi+8|0,Yi=Gi,Pn=Gi+12312|0,mi=Gi+24|0;do if((j+-2|0)>>>0<3){if((rt|0)!=2830){if(lt=rt&255,(Wl(q,2,lt,lt*3|0,X,G,O,ee,J,le,ce,mi)|0)<0){F[Qe>>2]=-1,lt=-6;break}if(lt=Sa(mi,lt,Qe,We,pt,rt,qe)|0,!Je)break;F[Je>>2]=0,F[Je+4>>2]=0;break}if((Wl(q,2,14,42,X,G,O,ee,J,le,.875,mi)|0)<0){F[Qe>>2]=-1,lt=-6;break}F[Et>>2]=0,F[Et+4>>2]=182,F[Et+8>>2]=195,F[Et+12>>2]=13,rt=ie[mi+(F[Et>>2]|0)>>0]|0,lt=(rt&255)>0?rt:0,rt=(rt&255)<255?rt:-1,ei=ie[mi+(F[Et+4>>2]|0)>>0]|0,lt=(ei&255)>(lt&255)?ei:lt,rt=(ei&255)<(rt&255)?ei:rt,ei=ie[mi+(F[Et+8>>2]|0)>>0]|0,lt=(ei&255)>(lt&255)?ei:lt,rt=(ei&255)<(rt&255)?ei:rt,ei=ie[mi+(F[Et+12>>2]|0)>>0]|0,lt=((ei&255)>(lt&255)?ei:lt)&255,rt=((ei&255)<(rt&255)?ei:rt)&255;e:do if((lt-rt|0)>=30){for(ei=(lt+rt|0)>>>1,ie[At>>0]=(fe[mi+(F[Et>>2]|0)>>0]|0)>>>0<ei>>>0&1,ie[At+1>>0]=(fe[mi+(F[Et+4>>2]|0)>>0]|0)>>>0<ei>>>0&1,ie[At+2>>0]=(fe[mi+(F[Et+8>>2]|0)>>0]|0)>>>0<ei>>>0&1,ie[At+3>>0]=(fe[mi+(F[Et+12>>2]|0)>>0]|0)>>>0<ei>>>0&1,rt=0;;){if(lt=rt+1|0,(ie[At+rt>>0]|0)==1&&(ie[At+((lt|0)%4|0)>>0]|0)==1&&!(ie[At+((rt+2|0)%4|0)>>0]|0)){Wn=rt;break}if((lt|0)<4)rt=lt;else{Wn=lt;break}}switch(Wn|0){case 4:{F[We>>2]=0,se[pt>>3]=-1,lt=-3,rt=0,Et=0;break e}case 0:{Et=119,lt=255,rt=0;do{Qt=rt+-3|0,je=(rt&-2|0)==12,Ye=rt*14|0,At=0;do(At+-3|Qt)>>>0>=8&&(Gn=At&-2,(At|rt)>>>0>=2)&&!(je&((Gn|0)==0|(Gn|0)==12))&&(Bn=(fe[mi+(At+Ye)>>0]|0)-ei|0,ie[Pn+Et>>0]=Bn>>>31,Bn=(Bn|0)>-1?Bn:0-Bn|0,Et=Et+-1|0,lt=(Bn|0)<(lt|0)?Bn:lt),At=At+1|0;while((At|0)!=14);rt=rt+1|0}while((rt|0)!=14);break}case 1:{Et=119,lt=255,rt=0;do{for(Qt=rt+-3|0,Ye=rt&-2,je=(Ye|0)==0,Ye=(Ye|0)==12,At=13;(At+-3|Qt)>>>0>=8&&(Bn=(At&-2|0)==12,!(je&Bn))&&!(Ye&(At>>>0<2|Bn))&&(Gn=(fe[mi+((At*14|0)+rt)>>0]|0)-ei|0,ie[Pn+Et>>0]=Gn>>>31,Gn=(Gn|0)>-1?Gn:0-Gn|0,Et=Et+-1|0,lt=(Gn|0)<(lt|0)?Gn:lt),(At|0)>0;)At=At+-1|0;rt=rt+1|0}while((rt|0)!=14);break}case 2:{for(rt=119,lt=255,Qt=13;;){for(je=Qt+-3|0,Ye=Qt>>>0<2|(Qt&-2|0)==12,At=Qt*14|0,Et=13;(Et+-3|je)>>>0>=8&&!((Et|Qt)>>>0<2|Ye&(Et&-2|0)==12)&&(Gn=(fe[mi+(Et+At)>>0]|0)-ei|0,ie[Pn+rt>>0]=Gn>>>31,Gn=(Gn|0)>-1?Gn:0-Gn|0,rt=rt+-1|0,lt=(Gn|0)<(lt|0)?Gn:lt),(Et|0)>0;)Et=Et+-1|0;if((Qt|0)>0)Qt=Qt+-1|0;else break}break}case 3:{for(rt=119,lt=255,Qt=13;;){Ye=Qt+-3|0,je=Qt&-2,At=(je|0)==12,je=(je|0)==0,Et=0;do(Et+-3|Ye)>>>0>=8&&!(At&Et>>>0<2|(Et|Qt)>>>0<2)&&!(je&(Et&-2|0)==12)&&(Gn=(fe[mi+((Et*14|0)+Qt)>>0]|0)-ei|0,ie[Pn+rt>>0]=Gn>>>31,Gn=(Gn|0)>-1?Gn:0-Gn|0,rt=rt+-1|0,lt=(Gn|0)<(lt|0)?Gn:lt),Et=Et+1|0;while((Et|0)!=14);if((Qt|0)>0)Qt=Qt+-1|0;else break}break}default:lt=255}F[We>>2]=Wn,se[pt>>3]=(lt|0)>30?1:+(lt|0)/30,lt=N0(2830,0,0,Pn,Yi)|0,(lt|0)<0?(lt=-4,rt=0,Et=0):(qe&&(F[qe>>2]=lt),Et=Yi,lt=0,rt=F[Et>>2]|0,Et=F[Et+4>>2]|0)}else F[We>>2]=0,se[pt>>3]=-1,lt=-2,rt=0,Et=0;while(!1);if((lt|0)<0){F[Qe>>2]=-1;break}if((rt|0)==-1&(Et|0)==-1){F[Qe>>2]=-1,lt=-5;break}F[Qe>>2]=(rt&-32768|0)==0&!0?rt&32767:0,Je&&(lt=Je,F[lt>>2]=rt,F[lt+4>>2]=Et),lt=0}else lt=1;while(!1);e:do switch(j|0){case 0:case 1:case 3:case 4:{if(!W){F[he>>2]=-1,rt=-1;break e}switch(rt=W+28|0,Et=F[rt>>2]|0,At=Et<<2,j|0){case 0:case 3:if((Wl(q,0,Et,At,X,G,O,ee,J,le,ce,mi)|0)<0){F[he>>2]=-1,rt=-6;break e}else{rt=Ds(W,0,mi,F[rt>>2]|0,he,Ce,De)|0;break e}default:if((Wl(q,1,Et,At,X,G,O,ee,J,le,ce,mi)|0)<0){F[he>>2]=-1,rt=-6;break e}else{rt=Ds(W,1,mi,F[rt>>2]|0,he,Ce,De)|0;break e}}}default:rt=1}while(!1);return(lt|0)!=1?(rt|0)!=1&&(lt=(rt&lt|0)<0?rt:0):lt=rt,me=Gi,lt|0}function tc(W){W=W|0;var q=0,j=0,X=0,G=0,O=0,ee=0,J=0,le=0;le=me,me=me+16|0,q=le+8|0,ee=le+4|0,j=le,F[ee>>2]=W;do if(W>>>0>=212){O=(W>>>0)/210|0,X=O*210|0,F[j>>2]=W-X,q=(id(3712,3904,j,q)|0)-3712>>2,G=q,q=(F[3712+(q<<2)>>2]|0)+X|0;e:for(;;){for(X=5;;){if(X>>>0>=47){X=211,J=8;break}if(j=F[3520+(X<<2)>>2]|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=106;break e}if((q|0)==(kt(W,j)|0))break;X=X+1|0}t:do if((J|0)==8)for(;;){if(J=0,j=(q>>>0)/(X>>>0)|0,j>>>0<X>>>0){J=105;break e}if((q|0)==(kt(j,X)|0))break t;if(j=X+10|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+12|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+16|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+18|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+22|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+28|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+30|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+36|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+40|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+42|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+46|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+52|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+58|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+60|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+66|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+70|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+72|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+78|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+82|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+88|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+96|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+100|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+102|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+106|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+108|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+112|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+120|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+126|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+130|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+136|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+138|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+142|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+148|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+150|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+156|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+162|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+166|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+168|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+172|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+178|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+180|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+186|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+190|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+192|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+196|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+198|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break t;if(j=X+208|0,W=(q>>>0)/(j>>>0)|0,W>>>0<j>>>0){J=105;break e}if((q|0)==(kt(W,j)|0))break;X=X+210|0,J=8}while(!1);X=G+1|0,q=(X|0)==48,X=q?0:X,q=(q&1)+O|0,G=X,O=q,q=(F[3712+(X<<2)>>2]|0)+(q*210|0)|0}if((J|0)==105){F[ee>>2]=q;break}else if((J|0)==106){F[ee>>2]=q;break}}else q=F[(id(3520,3712,ee,q)|0)>>2]|0;while(!1);return me=le,q|0}function id(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0;G=F[j>>2]|0,X=W,j=q-W>>2;e:for(;;){for(;;){if(!j)break e;if(W=(j|0)/2|0,(F[X+(W<<2)>>2]|0)>>>0<G>>>0)break;j=W}X=X+(W+1<<2)|0,j=j+-1-W|0}return X|0}function A1(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0;j>>>0>4294967279&&xa(W),j>>>0<11?(ie[W>>0]=j<<1,W=W+1|0):(G=j+16&-16,X=uc(G)|0,F[W+8>>2]=X,F[W>>2]=G|1,F[W+4>>2]=j,W=X),Ko(W|0,q|0,j|0)|0,ie[W+j>>0]=0}function ah(W){W=W|0,ie[W>>0]&1&&oa(F[W+8>>2]|0)}function Sc(){}function o0(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,X=q-X-(j>>>0>W>>>0|0)>>>0,_t=X,W-j>>>0|0|0}function ii(W,q,j){W=W|0,q=q|0,j=j|0;var X=0,G=0,O=0,ee=0;if(X=W+j|0,(j|0)>=20){if(q=q&255,O=W&3,ee=q|q<<8|q<<16|q<<24,G=X&-4,O)for(O=W+4-O|0;(W|0)<(O|0);)ie[W>>0]=q,W=W+1|0;for(;(W|0)<(G|0);)F[W>>2]=ee,W=W+4|0}for(;(W|0)<(X|0);)ie[W>>0]=q,W=W+1|0;return W-j|0}function Bo(W,q,j){return W=W|0,q=q|0,j=j|0,(j|0)<32?(_t=q<<j|(W&(1<<j)-1<<32-j)>>>32-j,W<<j):(_t=W<<j-32,0)}function Bs(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,j=W+j>>>0,_t=q+X+(j>>>0<W>>>0|0)>>>0,j|0|0}function nc(W,q,j){return W=W|0,q=q|0,j=j|0,(j|0)<32?(_t=q>>>j,W>>>j|(q&(1<<j)-1)<<32-j):(_t=0,q>>>j-32|0)}function Ko(W,q,j){W=W|0,q=q|0,j=j|0;var X=0;if((j|0)>=4096)return Vn(W|0,q|0,j|0)|0;if(X=W|0,(W&3)==(q&3)){for(;W&3;){if(!j)return X|0;ie[W>>0]=ie[q>>0]|0,W=W+1|0,q=q+1|0,j=j-1|0}for(;(j|0)>=4;)F[W>>2]=F[q>>2],W=W+4|0,q=q+4|0,j=j-4|0}for(;(j|0)>0;)ie[W>>0]=ie[q>>0]|0,W=W+1|0,q=q+1|0,j=j-1|0;return X|0}function Qp(W,q,j){return W=W|0,q=q|0,j=j|0,(j|0)<32?(_t=q>>j,W>>>j|(q&(1<<j)-1)<<32-j):(_t=(q|0)<0?-1:0,q>>j-32|0)}function m1(W){W=W|0;var q=0;return q=ie[Pe+(W&255)>>0]|0,(q|0)<8?q|0:(q=ie[Pe+(W>>8&255)>>0]|0,(q|0)<8?q+8|0:(q=ie[Pe+(W>>16&255)>>0]|0,(q|0)<8?q+16|0:(ie[Pe+(W>>>24)>>0]|0)+24|0))}function lh(W,q){W=W|0,q=q|0;var j=0,X=0,G=0,O=0;return O=W&65535,G=q&65535,j=kt(G,O)|0,X=W>>>16,W=(j>>>16)+(kt(G,X)|0)|0,G=q>>>16,q=kt(G,O)|0,_t=(W>>>16)+(kt(G,X)|0)+(((W&65535)+q|0)>>>16)|0,W+q<<16|j&65535|0|0}function pp(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0;return ce=q>>31|((q|0)<0?-1:0)<<1,le=((q|0)<0?-1:0)>>31|((q|0)<0?-1:0)<<1,O=X>>31|((X|0)<0?-1:0)<<1,G=((X|0)<0?-1:0)>>31|((X|0)<0?-1:0)<<1,J=o0(ce^W,le^q,ce,le)|0,ee=_t,W=O^ce,q=G^le,o0((Sl(J,ee,o0(O^j,G^X,O,G)|0,_t,0)|0)^W,_t^q,W,q)|0}function Ap(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0,ee=0,J=0,le=0,ce=0;return G=me,me=me+16|0,J=G|0,ee=q>>31|((q|0)<0?-1:0)<<1,O=((q|0)<0?-1:0)>>31|((q|0)<0?-1:0)<<1,ce=X>>31|((X|0)<0?-1:0)<<1,le=((X|0)<0?-1:0)>>31|((X|0)<0?-1:0)<<1,W=o0(ee^W,O^q,ee,O)|0,q=_t,Sl(W,q,o0(ce^j,le^X,ce,le)|0,_t,J)|0,X=o0(F[J>>2]^ee,F[J+4>>2]^O,ee,O)|0,j=_t,me=G,_t=j,X|0}function E0(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0;return G=W,O=j,j=lh(G,O)|0,W=_t,_t=(kt(q,O)|0)+(kt(X,G)|0)+W|W&0,j|0|0|0}function Gc(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,Sl(W,q,j,X,0)|0}function g1(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0;var G=0,O=0;return O=me,me=me+16|0,G=O|0,Sl(W,q,j,X,G)|0,me=O,_t=F[G+4>>2]|0,F[G>>2]|0|0}function Sl(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0;var O=0,ee=0,J=0,le=0,ce=0,he=0,Ce=0,De=0,Qe=0,We=0;if(he=W,le=q,ce=le,ee=j,De=X,J=De,!ce)return O=(G|0)!=0,J?O?(F[G>>2]=W|0,F[G+4>>2]=q&0,De=0,G=0,_t=De,G|0):(De=0,G=0,_t=De,G|0):(O&&(F[G>>2]=(he>>>0)%(ee>>>0),F[G+4>>2]=0),De=0,G=(he>>>0)/(ee>>>0)>>>0,_t=De,G|0);O=(J|0)==0;do if(ee){if(!O){if(O=(Kn(J|0)|0)-(Kn(ce|0)|0)|0,O>>>0<=31){Ce=O+1|0,J=31-O|0,q=O-31>>31,ee=Ce,W=he>>>(Ce>>>0)&q|ce<<J,q=ce>>>(Ce>>>0)&q,O=0,J=he<<J;break}return G?(F[G>>2]=W|0,F[G+4>>2]=le|q&0,De=0,G=0,_t=De,G|0):(De=0,G=0,_t=De,G|0)}if(O=ee-1|0,O&ee){J=(Kn(ee|0)|0)+33-(Kn(ce|0)|0)|0,We=64-J|0,Ce=32-J|0,le=Ce>>31,Qe=J-32|0,q=Qe>>31,ee=J,W=Ce-1>>31&ce>>>(Qe>>>0)|(ce<<Ce|he>>>(J>>>0))&q,q=q&ce>>>(J>>>0),O=he<<We&le,J=(ce<<We|he>>>(Qe>>>0))&le|he<<Ce&J-33>>31;break}return G&&(F[G>>2]=O&he,F[G+4>>2]=0),(ee|0)==1?(Qe=le|q&0,We=W|0|0,_t=Qe,We|0):(We=m1(ee|0)|0,Qe=ce>>>(We>>>0)|0,We=ce<<32-We|he>>>(We>>>0)|0,_t=Qe,We|0)}else{if(O)return G&&(F[G>>2]=(ce>>>0)%(ee>>>0),F[G+4>>2]=0),Qe=0,We=(ce>>>0)/(ee>>>0)>>>0,_t=Qe,We|0;if(!he)return G&&(F[G>>2]=0,F[G+4>>2]=(ce>>>0)%(J>>>0)),Qe=0,We=(ce>>>0)/(J>>>0)>>>0,_t=Qe,We|0;if(O=J-1|0,!(O&J))return G&&(F[G>>2]=W|0,F[G+4>>2]=O&ce|q&0),Qe=0,We=ce>>>((m1(J|0)|0)>>>0),_t=Qe,We|0;if(O=(Kn(J|0)|0)-(Kn(ce|0)|0)|0,O>>>0<=30){q=O+1|0,J=31-O|0,ee=q,W=ce<<J|he>>>(q>>>0),q=ce>>>(q>>>0),O=0,J=he<<J;break}return G?(F[G>>2]=W|0,F[G+4>>2]=le|q&0,Qe=0,We=0,_t=Qe,We|0):(Qe=0,We=0,_t=Qe,We|0)}while(!1);if(!ee)ce=J,le=0,J=0;else{Ce=j|0|0,he=De|X&0,ce=Bs(Ce|0,he|0,-1,-1)|0,j=_t,le=J,J=0;do X=le,le=O>>>31|le<<1,O=J|O<<1,X=W<<1|X>>>31|0,De=W>>>31|q<<1|0,o0(ce,j,X,De)|0,We=_t,Qe=We>>31|((We|0)<0?-1:0)<<1,J=Qe&1,W=o0(X,De,Qe&Ce,(((We|0)<0?-1:0)>>31|((We|0)<0?-1:0)<<1)&he)|0,q=_t,ee=ee-1|0;while(ee|0);ce=le,le=0}return ee=0,G&&(F[G>>2]=W,F[G+4>>2]=q),Qe=(O|0)>>>31|(ce|ee)<<1|(ee<<1|O>>>31)&0|le,We=(O<<1|0)&-2|J,_t=Qe,We|0}function rd(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,en[W&15](q|0,j|0,X|0)|0}function lu(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,Tn[W&3](q|0,j|0,X|0,G|0,O|0)}function sd(W,q,j){return W=W|0,q=q|0,j=j|0,+Hn[W&1](q|0,j|0)}function v1(W,q,j){W=W|0,q=q|0,j=+j,Ei[W&3](q|0,+j)}function E1(W,q){return W=W|0,q=q|0,+ur[W&3](q|0)}function mp(W){return W=W|0,pr[W&1]()|0}function ch(W,q){W=W|0,q=q|0,rr[W&15](q|0)}function Uf(W,q,j){W=W|0,q=q|0,j=j|0,Hr[W&7](q|0,j|0)}function _1(W,q){return W=W|0,q=q|0,Zr[W&31](q|0)|0}function y1(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0,cs[W&1](q|0,j|0,X|0)}function uh(W){W=W|0,ua[W&0]()}function hh(W,q,j,X){W=W|0,q=q|0,j=j|0,X=+X,li[W&3](q|0,j|0,+X)}function C1(W,q,j,X,G){return W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,$n[W&1](q|0,j|0,X|0,G|0)|0}function od(W,q,j,X,G,O,ee){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ee=ee|0,ui[W&3](q|0,j|0,X|0,G|0,O|0,ee|0)}function x1(W,q,j){return W=W|0,q=q|0,j=j|0,dr[W&15](q|0,j|0)|0}function ad(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,ls[W&3](q|0,j|0,X|0,G|0)}function dh(W,q,j){return W=W|0,q=q|0,j=j|0,ai(0),0}function Qc(W,q,j,X,G){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,ai(1)}function ca(W,q){return W=W|0,q=q|0,ai(2),0}function Ta(W,q){W=W|0,q=+q,ai(3)}function ld(W){return W=W|0,ai(4),0}function cd(){return ai(5),0}function kf(W){W=W|0,ai(6)}function fh(W,q){W=W|0,q=q|0,ai(7)}function _0(W){return W=W|0,ai(8),0}function ud(W,q,j){W=W|0,q=q|0,j=j|0,ai(9)}function Ee(){ai(10)}function Se(W,q,j){W=W|0,q=q|0,j=+j,ai(11)}function Ge(W,q,j,X){return W=W|0,q=q|0,j=j|0,X=X|0,ai(12),0}function nt(W,q,j,X,G,O){W=W|0,q=q|0,j=j|0,X=X|0,G=G|0,O=O|0,ai(13)}function gt(W,q){return W=W|0,q=q|0,ai(14),0}function Pt(W,q,j,X){W=W|0,q=q|0,j=j|0,X=X|0,ai(15)}var en=[dh,Fo,go,Cu,dl,Bc,n0,Af,uf,lf,cf,ff,s1,Jh,Zf,_u],Tn=[Qc,Zs,Rs,vn],Hn=[ca,ts],Ei=[Ta,jf,ep,rf],ur=[ld,ef,tp,$h],pr=[cd,zd],rr=[kf,hc,gu,Ul,Kc,cl,dc,Wo,Yc,Yu,X1,yf,nh,Hd,Ea,kf],Hr=[fh,sf,Xd,tf,np,rp,Yd,Cf],Zr=[_0,Ol,kd,K1,j1,Y1,G0,T0,Tu,Kd,of,Xh,nf,ip,yl,qd,r1,_0,_0,_0,_0,_0,_0,_0,_0,_0,_0,_0,_0,_0,_0,_0],cs=[ud,up],ua=[Ee],li=[Se,Bu,m0,Se],$n=[Ge,wf],ui=[nt,w0,F0,Da],dr=[gt,Q1,$d,J1,Z1,hf,sp,df,pf,af,xf,hp,gt,gt,gt,gt],ls=[Pt,ga,Rc,Fs];return{_i64Subtract:o0,_fflush:Co,_i64Add:Bs,_memset:ii,_malloc:$i,_memcpy:Ko,___getTypeName:Us,_bitshift64Lshr:nc,_free:Mr,___errno_location:Is,_bitshift64Shl:Bo,__GLOBAL__sub_I_ARToolKitJS_cpp:Ef,__GLOBAL__sub_I_bind_cpp:qi,runPostSets:Sc,stackAlloc:Uu,stackSave:zc,stackRestore:Ed,establishStackSpace:ku,setThrew:Gu,setTempRet0:Eh,getTempRet0:yd,dynCall_iiii:rd,dynCall_viiiii:lu,dynCall_dii:sd,dynCall_vid:v1,dynCall_di:E1,dynCall_i:mp,dynCall_vi:ch,dynCall_vii:Uf,dynCall_ii:_1,dynCall_viii:y1,dynCall_v:uh,dynCall_viid:hh,dynCall_iiiii:C1,dynCall_viiiiii:od,dynCall_iii:x1,dynCall_viiii:ad}}(Module.asmGlobalArg,Module.asmLibraryArg,buffer),_i64Subtract=Module._i64Subtract=asm._i64Subtract,__GLOBAL__sub_I_bind_cpp=Module.__GLOBAL__sub_I_bind_cpp=asm.__GLOBAL__sub_I_bind_cpp;Module._fflush=asm._fflush;var __GLOBAL__sub_I_ARToolKitJS_cpp=Module.__GLOBAL__sub_I_ARToolKitJS_cpp=asm.__GLOBAL__sub_I_ARToolKitJS_cpp,_i64Add=Module._i64Add=asm._i64Add,_memset=Module._memset=asm._memset;Module.runPostSets=asm.runPostSets;var _malloc=Module._malloc=asm._malloc,_memcpy=Module._memcpy=asm._memcpy,___getTypeName=Module.___getTypeName=asm.___getTypeName,_bitshift64Lshr=Module._bitshift64Lshr=asm._bitshift64Lshr,_free=Module._free=asm._free;Module.___errno_location=asm.___errno_location;var _bitshift64Shl=Module._bitshift64Shl=asm._bitshift64Shl;Module.dynCall_iiii=asm.dynCall_iiii,Module.dynCall_viiiii=asm.dynCall_viiiii,Module.dynCall_dii=asm.dynCall_dii,Module.dynCall_vid=asm.dynCall_vid,Module.dynCall_di=asm.dynCall_di,Module.dynCall_i=asm.dynCall_i,Module.dynCall_vi=asm.dynCall_vi,Module.dynCall_vii=asm.dynCall_vii,Module.dynCall_ii=asm.dynCall_ii,Module.dynCall_viii=asm.dynCall_viii,Module.dynCall_v=asm.dynCall_v,Module.dynCall_viid=asm.dynCall_viid,Module.dynCall_iiiii=asm.dynCall_iiiii,Module.dynCall_viiiiii=asm.dynCall_viiiiii,Module.dynCall_iii=asm.dynCall_iii,Module.dynCall_viiii=asm.dynCall_viiii,Runtime.stackAlloc=asm.stackAlloc,Runtime.stackSave=asm.stackSave,Runtime.stackRestore=asm.stackRestore,Runtime.establishStackSpace=asm.establishStackSpace,Runtime.setTempRet0=asm.setTempRet0,Runtime.getTempRet0=asm.getTempRet0;function ExitStatus(re){this.name="ExitStatus",this.message="Program terminated with exit("+re+")",this.status=re}ExitStatus.prototype=new Error,ExitStatus.prototype.constructor=ExitStatus;var initialStackTop;dependenciesFulfilled=function re(){Module.calledRun||run(),Module.calledRun||(dependenciesFulfilled=re)},Module.callMain=Module.callMain=function re(U){assert(runDependencies==0,"cannot call main when async dependencies remain! (listen on __ATMAIN__)"),assert(__ATPRERUN__.length==0,"cannot call main when preRun functions remain to be called"),U=U||[],ensureInitRuntime();var Y=U.length+1;function ie(){for(var pe=0;pe<3;pe++)ne.push(0)}var ne=[allocate(intArrayFromString(Module.thisProgram),"i8",ALLOC_NORMAL)];ie();for(var F=0;F<Y-1;F=F+1)ne.push(allocate(intArrayFromString(U[F]),"i8",ALLOC_NORMAL)),ie();ne.push(0),ne=allocate(ne,"i32",ALLOC_NORMAL);try{var fe=Module._main(Y,ne,0);exit(fe,!0)}catch(pe){if(pe instanceof ExitStatus)return;if(pe=="SimulateInfiniteLoop"){Module.noExitRuntime=!0;return}else throw pe&&typeof pe=="object"&&pe.stack&&Module.printErr("exception thrown: "+[pe,pe.stack]),pe}finally{}};function run(re){if(re=re||Module.arguments,runDependencies>0||(preRun(),runDependencies>0)||Module.calledRun)return;function U(){Module.calledRun||(Module.calledRun=!0,!ABORT&&(ensureInitRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),Module._main&&shouldRunNow&&Module.callMain(re),postRun()))}Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),U()},1)):U()}Module.run=Module.run=run;function exit(re,U){if(!(U&&Module.noExitRuntime))throw Module.noExitRuntime||(ABORT=!0,STACKTOP=initialStackTop,exitRuntime(),Module.onExit&&Module.onExit(re)),ENVIRONMENT_IS_NODE?(process.stdout.once("drain",function(){process.exit(re)}),console.log(" "),setTimeout(function(){process.exit(re)},500)):ENVIRONMENT_IS_SHELL&&typeof quit=="function"&&quit(re),new ExitStatus(re)}Module.exit=Module.exit=exit;var abortDecorators=[];function abort(re){re!==void 0?(Module.print(re),Module.printErr(re),re=JSON.stringify(re)):re="",ABORT=!0;var U=`
If this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.`,Y="abort("+re+") at "+stackTrace()+U;throw abortDecorators.forEach(function(ie){Y=ie(Y,re)}),Y}if(Module.abort=Module.abort=abort,Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run(),function(){var re=function(xe,Fe,Oe){var Ne=xe,ke=Fe;if(this.orientation="landscape",this.listeners={},typeof xe!="number"){var Ve=xe;Oe=Fe,Ne=Ve.videoWidth||Ve.width,ke=Ve.videoHeight||Ve.height,this.image=Ve}if(this.defaultMarkerWidth=1,this.patternMarkers={},this.barcodeMarkers={},this.transform_mat=new Float32Array(16),this.canvas=document.createElement("canvas"),this.canvas.width=Ne,this.canvas.height=ke,this.ctx=this.canvas.getContext("2d"),this.videoWidth=Ne,this.videoHeight=ke,typeof Oe=="string"){var Xe=this;this.cameraParam=new U(Oe,function(){Xe._initialize()},function($e){console.error("ARController: Failed to load ARCameraParam",$e)})}else this.cameraParam=Oe,this._initialize()};re.prototype.dispose=function(){Y.teardown(this.id);for(var xe in this)this[xe]=null},re.prototype.process=function(xe){this.detectMarker(xe);var Fe=this.getMarkerNum(),Oe,Ne;for(Oe in this.patternMarkers)Ne=this.patternMarkers[Oe],Ne.inPrevious=Ne.inCurrent,Ne.inCurrent=!1;for(Oe in this.barcodeMarkers)Ne=this.barcodeMarkers[Oe],Ne.inPrevious=Ne.inCurrent,Ne.inCurrent=!1;for(var ke=0;ke<Fe;ke++){var Ve=this.getMarker(ke),Xe=Y.UNKNOWN_MARKER,$e=this.trackPatternMarkerId(-1);Ve.idPatt>-1&&(Ve.id===Ve.idPatt||Ve.idMatrix===-1)?($e=this.trackPatternMarkerId(Ve.idPatt),Xe=Y.PATTERN_MARKER,Ve.dir!==Ve.dirPatt&&this.setMarkerInfoDir(ke,Ve.dirPatt)):Ve.idMatrix>-1&&($e=this.trackBarcodeMarkerId(Ve.idMatrix),Xe=Y.BARCODE_MARKER,Ve.dir!==Ve.dirMatrix&&this.setMarkerInfoDir(ke,Ve.dirMatrix)),Xe!==Y.UNKNOWN_MARKER&&$e.inPrevious?this.getTransMatSquareCont(ke,$e.markerWidth,$e.matrix,$e.matrix):this.getTransMatSquare(ke,$e.markerWidth,$e.matrix),$e.inCurrent=!0,this.transMatToGLMat($e.matrix,this.transform_mat),this.dispatchEvent({name:"getMarker",target:this,data:{index:ke,type:Xe,marker:Ve,matrix:this.transform_mat}})}for(var st=this.getMultiMarkerCount(),ke=0;ke<st;ke++){var ze=this.getMultiMarkerPatternCount(ke),$e=!1;Y.getTransMatMultiSquareRobust(this.id,ke),this.transMatToGLMat(this.marker_transform_mat,this.transform_mat);for(var tt=0;tt<ze;tt++){var ft=this.getMultiEachMarker(ke,tt);if(ft.visible>=0){$e=!0,this.dispatchEvent({name:"getMultiMarker",target:this,data:{multiMarkerId:ke,matrix:this.transform_mat}});break}}if($e)for(var tt=0;tt<ze;tt++){var ft=this.getMultiEachMarker(ke,tt);this.transMatToGLMat(this.marker_transform_mat,this.transform_mat),this.dispatchEvent({name:"getMultiMarkerSub",target:this,data:{multiMarkerId:ke,markerIndex:tt,marker:ft,matrix:this.transform_mat}})}}this._bwpointer&&this.debugDraw()},re.prototype.trackPatternMarkerId=function(xe,Fe){var Oe=this.patternMarkers[xe];return Oe||(this.patternMarkers[xe]=Oe={inPrevious:!1,inCurrent:!1,matrix:new Float32Array(12),markerWidth:Fe||this.defaultMarkerWidth}),Fe&&(Oe.markerWidth=Fe),Oe},re.prototype.trackBarcodeMarkerId=function(xe,Fe){var Oe=this.barcodeMarkers[xe];return Oe||(this.barcodeMarkers[xe]=Oe={inPrevious:!1,inCurrent:!1,matrix:new Float32Array(12),markerWidth:Fe||this.defaultMarkerWidth}),Fe&&(Oe.markerWidth=Fe),Oe},re.prototype.getMultiMarkerCount=function(){return Y.getMultiMarkerCount(this.id)},re.prototype.getMultiMarkerPatternCount=function(xe){return Y.getMultiMarkerNum(this.id,xe)},re.prototype.addEventListener=function(xe,Fe){this.listeners[xe]||(this.listeners[xe]=[]),this.listeners[xe].push(Fe)},re.prototype.removeEventListener=function(xe,Fe){if(this.listeners[xe]){var Oe=this.listeners[xe].indexOf(Fe);Oe>-1&&this.listeners[xe].splice(Oe,1)}},re.prototype.dispatchEvent=function(xe){var Fe=this.listeners[xe.name];if(Fe)for(var Oe=0;Oe<Fe.length;Oe++)Fe[Oe].call(this,xe)},re.prototype.debugSetup=function(){document.body.appendChild(this.canvas),this.setDebugMode(1),this._bwpointer=this.getProcessingImage()},re.prototype.loadMarker=function(xe,Fe,Oe){return Y.addMarker(this.id,xe,Fe,Oe)},re.prototype.loadMultiMarker=function(xe,Fe,Oe){return Y.addMultiMarker(this.id,xe,Fe,Oe)},re.prototype.getTransMatSquare=function(xe,Fe,Oe){return Y.getTransMatSquare(this.id,xe,Fe),Oe.set(this.marker_transform_mat),Oe},re.prototype.getTransMatSquareCont=function(xe,Fe,Oe,Ne){return this.marker_transform_mat.set(Oe),Y.getTransMatSquareCont(this.id,xe,Fe),Ne.set(this.marker_transform_mat),Ne},re.prototype.getTransMatMultiSquare=function(xe,Fe){return Y.getTransMatMultiSquare(this.id,xe),Fe.set(this.marker_transform_mat),Fe},re.prototype.getTransMatMultiSquareRobust=function(xe,Fe){return Y.getTransMatMultiSquare(this.id,xe),Fe.set(this.marker_transform_mat),Fe},re.prototype.transMatToGLMat=function(xe,Fe,Oe){return Fe[0+0*4]=xe[0],Fe[0+1*4]=xe[1],Fe[0+2*4]=xe[2],Fe[0+3*4]=xe[3],Fe[1+0*4]=xe[4],Fe[1+1*4]=xe[5],Fe[1+2*4]=xe[6],Fe[1+3*4]=xe[7],Fe[2+0*4]=xe[8],Fe[2+1*4]=xe[9],Fe[2+2*4]=xe[10],Fe[2+3*4]=xe[11],Fe[3+0*4]=0,Fe[3+1*4]=0,Fe[3+2*4]=0,Fe[3+3*4]=1,Oe!=null&&Oe!==0&&(Fe[12]*=Oe,Fe[13]*=Oe,Fe[14]*=Oe),Fe},re.prototype.detectMarker=function(xe){return this._copyImageToHeap(xe)?Y.detectMarker(this.id):-99},re.prototype.getMarkerNum=function(){return Y.getMarkerNum(this.id)},re.prototype.getMarker=function(xe){if(Y.getMarker(this.id,xe)===0)return Y.markerInfo},re.prototype.setMarkerInfoVertex=function(xe,Fe){for(var Oe=0;Oe<Fe.length;Oe++)this.marker_transform_mat[Oe*2+0]=Fe[Oe][0],this.marker_transform_mat[Oe*2+1]=Fe[Oe][1];return Y.setMarkerInfoVertex(this.id,xe)},re.prototype.cloneMarkerInfo=function(xe){return JSON.parse(JSON.stringify(xe))},re.prototype.getMultiEachMarker=function(xe,Fe){if(Y.getMultiEachMarker(this.id,xe,Fe)===0)return Y.multiEachMarkerInfo},re.prototype.getTransformationMatrix=function(){return this.transform_mat},re.prototype.getCameraMatrix=function(){return this.camera_mat},re.prototype.getMarkerTransformationMatrix=function(){return this.marker_transform_mat},re.prototype.setDebugMode=function(xe){return Y.setDebugMode(this.id,xe)},re.prototype.getDebugMode=function(){return Y.getDebugMode(this.id)},re.prototype.getProcessingImage=function(){return Y.getProcessingImage(this.id)},re.prototype.setLogLevel=function(xe){return Y.setLogLevel(xe)},re.prototype.getLogLevel=function(){return Y.getLogLevel()},re.prototype.setMarkerInfoDir=function(xe,Fe){return Y.setMarkerInfoDir(this.id,xe,Fe)},re.prototype.setProjectionNearPlane=function(xe){return Y.setProjectionNearPlane(this.id,xe)},re.prototype.getProjectionNearPlane=function(){return Y.getProjectionNearPlane(this.id)},re.prototype.setProjectionFarPlane=function(xe){return Y.setProjectionFarPlane(this.id,xe)},re.prototype.getProjectionFarPlane=function(){return Y.getProjectionFarPlane(this.id)},re.prototype.setThresholdMode=function(xe){return Y.setThresholdMode(this.id,xe)},re.prototype.getThresholdMode=function(){return Y.getThresholdMode(this.id)},re.prototype.setThreshold=function(xe){return Y.setThreshold(this.id,xe)},re.prototype.getThreshold=function(){return Y.getThreshold(this.id)},re.prototype.setPatternDetectionMode=function(xe){return Y.setPatternDetectionMode(this.id,xe)},re.prototype.getPatternDetectionMode=function(){return Y.getPatternDetectionMode(this.id)},re.prototype.setMatrixCodeType=function(xe){return Y.setMatrixCodeType(this.id,xe)},re.prototype.getMatrixCodeType=function(){return Y.getMatrixCodeType(this.id)},re.prototype.setLabelingMode=function(xe){return Y.setLabelingMode(this.id,xe)},re.prototype.getLabelingMode=function(){return Y.getLabelingMode(this.id)},re.prototype.setPattRatio=function(xe){return Y.setPattRatio(this.id,xe)},re.prototype.getPattRatio=function(){return Y.getPattRatio(this.id)},re.prototype.setImageProcMode=function(xe){return Y.setImageProcMode(this.id,xe)},re.prototype.getImageProcMode=function(){return Y.getImageProcMode(this.id)},re.prototype.debugDraw=function(){var xe=new Uint8ClampedArray(Module.HEAPU8.buffer,this._bwpointer,this.framesize),Fe=new ImageData(xe,this.canvas.width,this.canvas.height);this.ctx.putImageData(Fe,0,0);for(var Oe=this.getMarkerNum(),Ne=0;Ne<Oe;Ne++)this._debugMarker(this.getMarker(Ne))},re.prototype._initialize=function(){this.id=Y.setup(this.canvas.width,this.canvas.height,this.cameraParam.id);var xe=Y.frameMalloc;this.framepointer=xe.framepointer,this.framesize=xe.framesize,this.dataHeap=new Uint8Array(Module.HEAPU8.buffer,this.framepointer,this.framesize),this.camera_mat=new Float64Array(Module.HEAPU8.buffer,xe.camera,16),this.marker_transform_mat=new Float64Array(Module.HEAPU8.buffer,xe.transform,12),this.setProjectionNearPlane(.1),this.setProjectionFarPlane(1e3);var Fe=this;setTimeout(function(){Fe.onload&&Fe.onload(),Fe.dispatchEvent({name:"load",target:Fe})},1)},re.prototype._copyImageToHeap=function(xe){if(xe||(xe=this.image),xe.nodeName==="IMG"&&xe.width>xe.height||xe.nodeName==="VIDEO"&&xe.videoWidth>xe.videoHeight)this.ctx.drawImage(xe,0,0,this.canvas.width,this.canvas.height);else{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var Fe=this.canvas.height/this.canvas.width,Oe=this.canvas.width*Fe,Ne=this.canvas.height*Fe,ke=(this.canvas.width-Ne)/2;this.ctx.drawImage(xe,ke,0,Ne,Oe)}var Ve=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),Xe=Ve.data;return this.dataHeap?(this.dataHeap.set(Xe),!0):!1},re.prototype._debugMarker=function(xe){var Fe,Oe;Fe=xe.vertex;var Ne=this.ctx;Ne.strokeStyle="red",Ne.beginPath(),Ne.moveTo(Fe[0][0],Fe[0][1]),Ne.lineTo(Fe[1][0],Fe[1][1]),Ne.stroke(),Ne.beginPath(),Ne.moveTo(Fe[2][0],Fe[2][1]),Ne.lineTo(Fe[3][0],Fe[3][1]),Ne.stroke(),Ne.strokeStyle="green",Ne.beginPath(),Ne.lineTo(Fe[1][0],Fe[1][1]),Ne.lineTo(Fe[2][0],Fe[2][1]),Ne.stroke(),Ne.beginPath(),Ne.moveTo(Fe[3][0],Fe[3][1]),Ne.lineTo(Fe[0][0],Fe[0][1]),Ne.stroke(),Oe=xe.pos,Ne.beginPath(),Ne.arc(Oe[0],Oe[1],8,0,Math.PI*2),Ne.fillStyle="red",Ne.fill()},re.getUserMedia=function(xe){xe.facingMode;var Fe=xe.onSuccess,Oe=xe.onError||function(ft){console.error("ARController.getUserMedia",ft)},Ne=document.createElement("video"),ke=function(){this.videoWidth!==0&&Fe(Ne)},Ve=!1,Xe=["touchstart","touchend","touchmove","touchcancel","click","mousedown","mouseup","mousemove","keydown","keyup","keypress","scroll"],$e=function(ft){Ve&&(Ne.play(),Ne.paused||Xe.forEach(function(Rt){window.removeEventListener(Rt,$e,!0)}))};Xe.forEach(function(ft){window.addEventListener(ft,$e,!0)});var st=function(ft){Ne.addEventListener("loadedmetadata",ke,!1),Ne.src=window.URL.createObjectURL(ft),Ve=!0,$e()},ze={};xe.width&&(xe.width,typeof xe.width=="object"?(xe.width.max&&(ze.maxWidth=xe.width.max),xe.width.min&&(ze.minWidth=xe.width.max)):ze.maxWidth=xe.width),xe.height&&(xe.height,typeof xe.height=="object"?(xe.height.max&&(ze.maxHeight=xe.height.max),xe.height.min&&(ze.minHeight=xe.height.max)):ze.maxHeight=xe.height),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var tt={audio:!1,video:{mandatory:ze}};return navigator.getUserMedia?navigator.getUserMedia(tt,st,Oe):Oe("navigator.getUserMedia is not supported on your browser"),Ne},re.getUserMediaARController=function(xe){var Fe={};for(var Oe in xe)Fe[Oe]=xe[Oe];var Ne=xe.onSuccess,ke=xe.cameraParam;Fe.onSuccess=function(){new U(ke,function(){var Xe=this,$e=xe.maxARVideoSize||Math.max(Ve.videoWidth,Ve.videoHeight),st=$e/Math.max(Ve.videoWidth,Ve.videoHeight),ze=st*Ve.videoWidth,tt=st*Ve.videoHeight;if(Ve.videoWidth<Ve.videoHeight){var ft=ze;ze=tt,tt=ft}var Rt=new re(ze,tt,Xe);Rt.image=Ve,Ve.videoWidth<Ve.videoHeight?(Rt.orientation="portrait",Rt.videoWidth=Ve.videoHeight,Rt.videoHeight=Ve.videoWidth):(Rt.orientation="landscape",Rt.videoWidth=Ve.videoWidth,Rt.videoHeight=Ve.videoHeight),Ne(Rt,Xe)},function(Xe){console.error("ARController: Failed to load ARCameraParam",Xe)})};var Ve=this.getUserMedia(Fe);return Ve};var U=function(xe,Fe,Oe){this.id=-1,this._src="",this.complete=!1,this.onload=Fe,this.onerror=Oe,xe&&this.load(xe)};U.prototype.load=function(xe){if(this._src!=="")throw"ARCameraParam: Trying to load camera parameters twice.";if(this._src=xe,xe){var Fe=this;Y.loadCamera(xe,function(Oe){Fe.id=Oe,Fe.complete=!0,Fe.onload()},function(Oe){Fe.onerror(Oe)})}},Object.defineProperty(U.prototype,"src",{set:function(xe){this.load(xe)},get:function(){return this._src}}),U.prototype.dispose=function(){this.id!==-1&&Y.deleteCamera(this.id),this.id=-1,this._src="",this.complete=!1};var Y={UNKNOWN_MARKER:-1,PATTERN_MARKER:0,BARCODE_MARKER:1,loadCamera:Te,addMarker:fe,addMultiMarker:se},ie=["setup","teardown","setLogLevel","getLogLevel","setDebugMode","getDebugMode","getProcessingImage","setMarkerInfoDir","setMarkerInfoVertex","getTransMatSquare","getTransMatSquareCont","getTransMatMultiSquare","getTransMatMultiSquareRobust","getMultiMarkerNum","getMultiMarkerCount","detectMarker","getMarkerNum","getMarker","getMultiEachMarker","setProjectionNearPlane","getProjectionNearPlane","setProjectionFarPlane","getProjectionFarPlane","setThresholdMode","getThresholdMode","setThreshold","getThreshold","setPatternDetectionMode","getPatternDetectionMode","setMatrixCodeType","getMatrixCodeType","setLabelingMode","getLabelingMode","setPattRatio","getPattRatio","setImageProcMode","getImageProcMode"];function ne(){ie.forEach(function(Fe){Y[Fe]=Module[Fe]});for(var xe in Module)xe.match(/^AR/)&&(Y[xe]=Module[xe])}var F=0;function fe(xe,Fe,Oe){var Ne="/marker_"+F++;Pe(Fe,Ne,function(){var ke=Module._addMarker(xe,Ne);Oe&&Oe(ke)})}function pe(xe){return String.fromCharCode.apply(String,xe)}function Me(xe){var Fe=pe(xe),Oe=Fe.split(`
`),Ne=[],ke=0;return Oe.forEach(function(Ve){if(Ve=Ve.trim(),!(!Ve||Ve.startsWith("#")))switch(ke){case 0:ke=1;return;case 1:Ve.match(/^\d+$/)||Ne.push(Ve);case 2:case 3:case 4:ke++;return;case 5:ke=1;return}}),Ne}var ve=0;function se(xe,Fe,Oe){var Ne="/multi_marker_"+ve++;Pe(Fe,Ne,function(ke){var Ve=Me(ke);function Xe(){var st=Module._addMultiMarker(xe,Ne),ze=Module.getMultiMarkerNum(xe,st);Oe&&Oe(st,ze)}if(!Ve.length)return Xe();var $e=Fe.split("/").slice(0,-1).join("/");Ve=Ve.map(function(st){return st==="patt.hiro"||st==="patt.kanji"||st==="patt2.hiro"||st==="patt2.kanji"?["http://127.0.0.1:8080/data/data/"+st,st]:[$e+"/"+st,st]}),Le(Ve,Xe)})}var me=0;function Te(xe,Fe){var Oe="/camera_param_"+me++,Ne=function(){var ke=Module._loadCamera(Oe);Fe&&Fe(ke)};typeof xe=="object"?be(Oe,xe,Ne):xe.indexOf(`
`)>-1?Re(Oe,xe,Ne):Pe(xe,Oe,Ne)}function Re(xe,Fe,Oe){for(var Ne=new Uint8Array(Fe.length),ke=0;ke<Ne.length;ke++)Ne[ke]=Fe.charCodeAt(ke)&255;be(xe,Ne,Oe)}function be(xe,Fe,Oe){FS.writeFile(xe,Fe,{encoding:"binary"}),Oe(Fe)}function Pe(xe,Fe,Oe){var Ne=new XMLHttpRequest;Ne.open("GET",xe,!0),Ne.responseType="arraybuffer",Ne.onload=function(ke){var Ve=Ne.response,Xe=new Uint8Array(Ve);be(Fe,Xe,Oe)},Ne.send()}function Le(xe,Fe){var Oe=xe.pop();Oe?Pe(Oe[0],Oe[1],function(){Le(xe,Fe)}):Fe()}window.artoolkit=Y,window.ARController=re,window.ARCameraParam=U,window.Module?ne():window.Module={onRuntimeInitialized:function(){ne()}}}();var THREEx=THREEx||{};THREEx.ArBaseControls=function(re){this.id=THREEx.ArBaseControls.id++,this.object3d=re,this.object3d.matrixAutoUpdate=!1,this.object3d.visible=!1},THREEx.ArBaseControls.id=0,Object.assign(THREEx.ArBaseControls.prototype,THREE.EventDispatcher.prototype),THREEx.ArBaseControls.prototype.update=function(){console.assert(!1,"you need to implement your own update")},THREEx.ArBaseControls.prototype.name=function(){return console.assert(!1,"you need to implement your own .name()"),"Not yet implemented - name()"};var THREEx=THREEx||{};THREEx.ARClickability=function(re){this._sourceElement=re;var U=parseInt(re.style.width),Y=parseInt(re.style.height);this._cameraPicking=new THREE.PerspectiveCamera(42,U/Y,.1,100),console.warn("THREEx.ARClickability works only in modelViewMatrix"),console.warn("OBSOLETE OBSOLETE! instead use THREEx.HitTestingPlane or THREEx.HitTestingTango")},THREEx.ARClickability.prototype.onResize=function(){var re=this._sourceElement,U=this._cameraPicking,Y=parseInt(re.style.width),ie=parseInt(re.style.height);U.aspect=Y/ie,U.updateProjectionMatrix()},THREEx.ARClickability.prototype.computeIntersects=function(re,U){var Y=this._sourceElement,ie=this._cameraPicking,ne=new THREE.Vector3;ne.x=re.layerX/parseInt(Y.style.width)*2-1,ne.y=-(re.layerY/parseInt(Y.style.height))*2+1;var F=new THREE.Raycaster;F.setFromCamera(ne,ie);var fe=F.intersectObjects(U);return fe},THREEx.ARClickability.prototype.update=function(){};var THREEx=THREEx||{};THREEx.ArMarkerCloak=function(re){var me=new THREE.PlaneGeometry(1.55,2.1,1,8).translate(0,-.3,0),se=new THREE.ShaderMaterial({vertexShader:THREEx.ArMarkerCloak.vertexShader,fragmentShader:THREEx.ArMarkerCloak.fragmentShader,transparent:!0,uniforms:{texture:{value:re},opacity:{value:.5}},defines:{updateInShaderEnabled:1}}),U=new THREE.Mesh(me,se);U.rotation.x=-Math.PI/2,this.object3d=U;for(var Y=-.65,ie=.65,ne=.65+.1,F=.95+.1,fe=[[]],pe=0;pe<U.geometry.faces.length;pe++)fe[0][pe]=[],fe[0][pe][0]=new THREE.Vector2,fe[0][pe][1]=new THREE.Vector2,fe[0][pe][2]=new THREE.Vector2;for(var Me=0;Me<U.geometry.parameters.heightSegments/2;Me++)fe[0][Me*4+0][0].set(Y/2+.5,F/2+.5),fe[0][Me*4+0][1].set(Y/2+.5,ne/2+.5),fe[0][Me*4+0][2].set(ie/2+.5,F/2+.5),fe[0][Me*4+1][0].set(Y/2+.5,ne/2+.5),fe[0][Me*4+1][1].set(ie/2+.5,ne/2+.5),fe[0][Me*4+1][2].set(ie/2+.5,F/2+.5),fe[0][Me*4+2][0].set(Y/2+.5,ne/2+.5),fe[0][Me*4+2][1].set(Y/2+.5,F/2+.5),fe[0][Me*4+2][2].set(ie/2+.5,ne/2+.5),fe[0][Me*4+3][0].set(Y/2+.5,F/2+.5),fe[0][Me*4+3][1].set(ie/2+.5,F/2+.5),fe[0][Me*4+3][2].set(ie/2+.5,ne/2+.5);U.geometry.faceVertexUvs=fe,U.geometry.uvsNeedUpdate=!0;var ve=[];ve.push(new THREE.Vector3(Y,F,0)),ve.push(new THREE.Vector3(ie,F,0)),ve.push(new THREE.Vector3(Y,ne,0)),ve.push(new THREE.Vector3(ie,ne,0));var se=new THREE.MeshNormalMaterial({transparent:!0,opacity:.5,side:THREE.DoubleSide}),me=new THREE.PlaneGeometry(1,1),Te=new THREE.Mesh(me,se);this.orthoMesh=Te,this.update=function(be,Pe){Re(be,Pe)};return;function Re(be,Pe){var Le=[];ve.forEach(function(Fe,Oe){var Ne=Fe.clone();Ne.applyMatrix4(be),Ne.applyMatrix4(Pe),Ne.x/=Ne.z,Ne.y/=Ne.z,Le.push(Ne)});for(var xe=0;xe<Le.length;xe++)Te.geometry.vertices[xe].copy(Le[xe]);Te.geometry.computeBoundingSphere(),Te.geometry.verticesNeedUpdate=!0}},THREEx.ArMarkerCloak.markerSpaceShaderFunction=`
        vec2 transformUvToMarkerSpace(vec2 originalUv){
                vec3 transformedUv;
                // set transformedUv - from UV coord to clip coord
                transformedUv.x = originalUv.x * 2.0 - 1.0;
                transformedUv.y = originalUv.y * 2.0 - 1.0;
                transformedUv.z = 0.0;

		// apply modelViewMatrix and projectionMatrix
                transformedUv = (projectionMatrix * modelViewMatrix * vec4( transformedUv, 1.0 ) ).xyz;

		// apply perspective
		transformedUv.x /= transformedUv.z;
		transformedUv.y /= transformedUv.z;

                // set back from clip coord to Uv coord
                transformedUv.x = transformedUv.x / 2.0 + 0.5;
                transformedUv.y = transformedUv.y / 2.0 + 0.5;

                // return the result
                return transformedUv.xy;
        }`,THREEx.ArMarkerCloak.vertexShader=THREEx.ArMarkerCloak.markerSpaceShaderFunction+`	varying vec2 vUv;

	void main(){
                // pass the UV to the fragment
                #if (updateInShaderEnabled == 1)
		        vUv = transformUvToMarkerSpace(uv);
                #else
		        vUv = uv;
                #endif

                // compute gl_Position
		vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
		gl_Position = projectionMatrix * mvPosition;
	}`,THREEx.ArMarkerCloak.fragmentShader=`
	varying vec2 vUv;
	uniform sampler2D texture;
	uniform float opacity;

	void main(void){
		vec3 color = texture2D( texture, vUv ).rgb;

		gl_FragColor = vec4( color, opacity);
	}`;var ARjs=ARjs||{},THREEx=THREEx||{};ARjs.MarkerControls=THREEx.ArMarkerControls=function(re,U,Y){var ie=this;THREEx.ArBaseControls.call(this,U),this.context=re,this.parameters={size:1,type:"unknown",patternUrl:null,barcodeValue:null,changeMatrixMode:"modelViewMatrix",minConfidence:.6,smooth:!1,smoothCount:5,smoothTolerance:.01,smoothThreshold:2};var ne=["pattern","barcode","unknown"];console.assert(ne.indexOf(this.parameters.type)!==-1,"illegal value",this.parameters.type);var ne=["modelViewMatrix","cameraTransformMatrix"];console.assert(ne.indexOf(this.parameters.changeMatrixMode)!==-1,"illegal value",this.parameters.changeMatrixMode),this.object3d=U,this.object3d.matrixAutoUpdate=!1,this.object3d.visible=!1,F(Y);function F(fe){if(fe!==void 0)for(var pe in fe){var Me=fe[pe];if(Me===void 0){console.warn("THREEx.ArMarkerControls: '"+pe+"' parameter is undefined.");continue}var ve=ie.parameters[pe];if(ve===void 0){console.warn("THREEx.ArMarkerControls: '"+pe+"' is not a property of this material.");continue}ie.parameters[pe]=Me}}this.parameters.smooth&&(this.smoothMatrices=[]),re.addMarker(this),ie.context.parameters.trackingBackend==="artoolkit"?this._initArtoolkit():ie.context.parameters.trackingBackend==="aruco"?this._arucoPosit=new POS.Posit(this.parameters.size,ie.context.arucoContext.canvas.width):ie.context.parameters.trackingBackend==="tango"?this._initTango():console.assert(!1)},ARjs.MarkerControls.prototype=Object.create(THREEx.ArBaseControls.prototype),ARjs.MarkerControls.prototype.constructor=THREEx.ArMarkerControls,ARjs.MarkerControls.prototype.dispose=function(){this.context.removeMarker(this)},ARjs.MarkerControls.prototype.updateWithModelViewMatrix=function(re){var U=this.object3d;if(U.visible=!0,this.context.parameters.trackingBackend==="artoolkit"){var Y=new THREE.Matrix4().copy(this.context._artoolkitProjectionAxisTransformMatrix);Y.multiply(re),re.copy(Y)}else this.context.parameters.trackingBackend==="aruco"||this.context.parameters.trackingBackend==="tango"||console.assert(!1);if(this.context.parameters.trackingBackend!=="tango"){var ie=new THREE.Matrix4().makeRotationX(Math.PI/2);re.multiply(ie)}var ne=!1;if(this.parameters.changeMatrixMode==="modelViewMatrix")if(this.parameters.smooth){var F,fe,pe,Me,ve=0;if(this.smoothMatrices.push(re.elements.slice()),this.smoothMatrices.length<this.parameters.smoothCount+1)U.matrix.copy(re);else{this.smoothMatrices.shift(),Me=[];for(fe in re.elements){F=0;for(pe in this.smoothMatrices)F+=this.smoothMatrices[pe][fe];Me[fe]=F/this.parameters.smoothCount,Math.abs(Me[fe]-re.elements[fe])>=this.parameters.smoothTolerance&&ve++}if(ve>=this.parameters.smoothThreshold){for(fe in re.elements)re.elements[fe]=Me[fe];U.matrix.copy(re),ne=!0}}}else U.matrix.copy(re);else this.parameters.changeMatrixMode==="cameraTransformMatrix"?U.matrix.getInverse(re):console.assert(!1);return U.matrix.decompose(U.position,U.quaternion,U.scale),this.dispatchEvent({type:"markerFound"}),ne},ARjs.MarkerControls.prototype.name=function(){var re="";if(re+=this.parameters.type,this.parameters.type==="pattern"){var U=this.parameters.patternUrl,Y=U.replace(/^.*\//g,"");re+=" - "+Y}else this.parameters.type==="barcode"?re+=" - "+this.parameters.barcodeValue:console.assert(!1,"no .name() implemented for this marker controls");return re},ARjs.MarkerControls.prototype._initArtoolkit=function(){var re=this,U=null,Y=setInterval(function(){var F=re.context.arController;F!==null&&(clearInterval(Y),Y=null,ie())},1e3/50);return;function ie(){var F=re.context.arController;console.assert(F!==null),re.parameters.type==="pattern"?F.loadMarker(re.parameters.patternUrl,function(fe){U=fe,F.trackPatternMarkerId(U,re.parameters.size)}):re.parameters.type==="barcode"?(U=re.parameters.barcodeValue,F.trackBarcodeMarkerId(U,re.parameters.size)):re.parameters.type==="unknown"?U=null:console.log(!1,"invalid marker type",re.parameters.type),F.addEventListener("getMarker",function(fe){if(fe.data.type===artoolkit.PATTERN_MARKER&&re.parameters.type==="pattern"){if(U===null)return;fe.data.marker.idPatt===U&&ne(fe)}else if(fe.data.type===artoolkit.BARCODE_MARKER&&re.parameters.type==="barcode"){if(U===null)return;fe.data.marker.idMatrix===U&&ne(fe)}else fe.data.type===artoolkit.UNKNOWN_MARKER&&re.parameters.type==="unknown"&&ne(fe)})}function ne(F){if(!(F.data.type===artoolkit.PATTERN_MARKER&&F.data.marker.cfPatt<re.parameters.minConfidence)&&!(F.data.type===artoolkit.BARCODE_MARKER&&F.data.marker.cfMatt<re.parameters.minConfidence)){var fe=new THREE.Matrix4().fromArray(F.data.matrix);re.updateWithModelViewMatrix(fe)}}},ARjs.MarkerControls.prototype._initAruco=function(){this._arucoPosit=new POS.Posit(this.parameters.size,_this.context.arucoContext.canvas.width)},ARjs.MarkerControls.prototype._initTango=function(){console.log("init tango ArMarkerControls")};var THREEx=THREEx||{};THREEx.ArMarkerHelper=function(re){this.object3d=new THREE.Group;var pe=new THREE.AxesHelper;this.object3d.add(pe);var U=re.id,Y=document.createElement("canvas");Y.width=64,Y.height=64;var ie=Y.getContext("2d"),ne=new THREE.CanvasTexture(Y);ie.font="48px monospace",ie.fillStyle="rgba(192,192,255, 0.5)",ie.fillRect(0,0,Y.width,Y.height),ie.fillStyle="darkblue",ie.fillText(U,Y.width/4,3*Y.height/4),ne.needsUpdate=!0;var F=new THREE.PlaneGeometry(1,1),fe=new THREE.MeshBasicMaterial({map:ne,transparent:!0}),pe=new THREE.Mesh(F,fe);pe.rotation.x=-Math.PI/2,this.object3d.add(pe)};var THREEx=THREEx||{};THREEx.ArSmoothedControls=function(re,U){var Y=this;THREEx.ArBaseControls.call(this,re),this.object3d.visible=!1,this._lastLerpStepAt=null,this._visibleStartedAt=null,this._unvisibleStartedAt=null,U=U||{},this.parameters={lerpPosition:.8,lerpQuaternion:.2,lerpScale:.7,lerpStepDelay:1/60,minVisibleDelay:0,minUnvisibleDelay:.2},ie(U);function ie(ne){if(ne!==void 0)for(var F in ne){var fe=ne[F];if(fe===void 0){console.warn("THREEx.ArSmoothedControls: '"+F+"' parameter is undefined.");continue}var pe=Y.parameters[F];if(pe===void 0){console.warn("THREEx.ArSmoothedControls: '"+F+"' is not a property of this material.");continue}Y.parameters[F]=fe}}},THREEx.ArSmoothedControls.prototype=Object.create(THREEx.ArBaseControls.prototype),THREEx.ArSmoothedControls.prototype.constructor=THREEx.ArSmoothedControls,THREEx.ArSmoothedControls.prototype.update=function(re){var U=this.object3d,Y=this.parameters,ie=U.visible,ne=performance.now()/1e3;if(re.visible===!1&&(this._visibleStartedAt=null),re.visible===!0&&(this._unvisibleStartedAt=null),re.visible===!0&&this._visibleStartedAt===null&&(this._visibleStartedAt=ne),re.visible===!1&&this._unvisibleStartedAt===null&&(this._unvisibleStartedAt=ne),ie===!1&&re.visible===!0){var F=ne-this._visibleStartedAt;F>=this.parameters.minVisibleDelay&&(U.visible=!0,ve())}if(ie===!0&&re.visible===!1){var fe=ne-this._unvisibleStartedAt;fe>=this.parameters.minUnvisibleDelay&&(U.visible=!1)}if(this._lastLerpStepAt===null)se(),this._lastLerpStepAt=ne;else for(var pe=Math.floor((ne-this._lastLerpStepAt)/this.parameters.lerpStepDelay),Me=0;Me<pe;Me++)se(),this._lastLerpStepAt+=this.parameters.lerpStepDelay;this.object3d.updateMatrix(),ie===!1&&U.visible===!0&&this.dispatchEvent({type:"becameVisible"}),ie===!0&&U.visible===!1&&this.dispatchEvent({type:"becameUnVisible"});return;function ve(){U.position.copy(re.position),U.quaternion.copy(re.quaternion),U.scale.copy(re.scale)}function se(){U.position.lerp(re.position,Y.lerpPosition),U.quaternion.slerp(re.quaternion,Y.lerpQuaternion),U.scale.lerp(re.scale,Y.lerpScale)}};var ARjs=ARjs||{},THREEx=THREEx||{};ARjs.Context=THREEx.ArToolkitContext=function(re){var U=this;U._updatedAt=null,this.parameters={trackingBackend:"artoolkit",debug:!1,detectionMode:"mono",matrixCodeType:"3x3",cameraParametersUrl:ARjs.Context.baseURL+"parameters/camera_para.dat",maxDetectionRate:60,canvasWidth:640,canvasHeight:480,patternRatio:.5,labelingMode:"black_region",imageSmoothingEnabled:!1},console.assert(["artoolkit","aruco"].indexOf(this.parameters.trackingBackend)!==-1,"invalid parameter trackingBackend",this.parameters.trackingBackend),console.assert(["color","color_and_matrix","mono","mono_and_matrix"].indexOf(this.parameters.detectionMode)!==-1,"invalid parameter detectionMode",this.parameters.detectionMode),console.assert(["black_region","white_region"].indexOf(this.parameters.labelingMode)!==-1,"invalid parameter labelingMode",this.parameters.labelingMode),this.arController=null,this.arucoContext=null,U.initialized=!1,this._arMarkersControls=[],Y(re);function Y(ie){if(ie!==void 0)for(var ne in ie){var F=ie[ne];if(F===void 0){console.warn("THREEx.ArToolkitContext: '"+ne+"' parameter is undefined.");continue}var fe=U.parameters[ne];if(fe===void 0){console.warn("THREEx.ArToolkitContext: '"+ne+"' is not a property of this material.");continue}U.parameters[ne]=F}}},Object.assign(ARjs.Context.prototype,THREE.EventDispatcher.prototype),ARjs.Context.baseURL="https://jeromeetienne.github.io/AR.js/three.js/",ARjs.Context.REVISION="2.2.2",ARjs.Context.createDefaultCamera=function(re){if(console.assert(!1,"use ARjs.Utils.createDefaultCamera instead"),re==="artoolkit")var U=new THREE.Camera;else if(re==="aruco")var U=new THREE.PerspectiveCamera(42,renderer.domElement.width/renderer.domElement.height,.01,100);else console.assert(!1);return U},ARjs.Context.prototype.init=function(re){var U=this;this.parameters.trackingBackend==="artoolkit"?this._initArtoolkit(Y):this.parameters.trackingBackend==="aruco"?this._initAruco(Y):console.assert(!1);return;function Y(){U.dispatchEvent({type:"initialized"}),U.initialized=!0,re&&re()}},ARjs.Context.prototype.update=function(re){if(this.parameters.trackingBackend==="artoolkit"&&this.arController===null)return!1;var U=performance.now();return this._updatedAt!==null&&U-this._updatedAt<1e3/this.parameters.maxDetectionRate?!1:(this._updatedAt=U,this._arMarkersControls.forEach(function(Y){Y.object3d.visible=!1}),this.parameters.trackingBackend==="artoolkit"?this._updateArtoolkit(re):this.parameters.trackingBackend==="aruco"?this._updateAruco(re):console.assert(!1),this.dispatchEvent({type:"sourceProcessed"}),!0)},ARjs.Context.prototype.addMarker=function(re){console.assert(re instanceof THREEx.ArMarkerControls),this._arMarkersControls.push(re)},ARjs.Context.prototype.removeMarker=function(re){console.assert(re instanceof THREEx.ArMarkerControls);var U=this.arMarkerControlss.indexOf(artoolkitMarker);console.assert(U!==U),this._arMarkersControls.splice(U,1)},ARjs.Context.prototype._initArtoolkit=function(re){var U=this;this._artoolkitProjectionAxisTransformMatrix=new THREE.Matrix4,this._artoolkitProjectionAxisTransformMatrix.multiply(new THREE.Matrix4().makeRotationY(Math.PI)),this._artoolkitProjectionAxisTransformMatrix.multiply(new THREE.Matrix4().makeRotationZ(Math.PI));var Y=new ARCameraParam(U.parameters.cameraParametersUrl,function(){var ie=new ARController(U.parameters.canvasWidth,U.parameters.canvasHeight,Y);U.arController=ie,ie.ctx.mozImageSmoothingEnabled=U.parameters.imageSmoothingEnabled,ie.ctx.webkitImageSmoothingEnabled=U.parameters.imageSmoothingEnabled,ie.ctx.msImageSmoothingEnabled=U.parameters.imageSmoothingEnabled,ie.ctx.imageSmoothingEnabled=U.parameters.imageSmoothingEnabled,U.parameters.debug===!0&&(ie.debugSetup(),ie.canvas.style.position="absolute",ie.canvas.style.top="0px",ie.canvas.style.opacity="0.6",ie.canvas.style.pointerEvents="none",ie.canvas.style.zIndex="-1");var ne={color:artoolkit.AR_TEMPLATE_MATCHING_COLOR,color_and_matrix:artoolkit.AR_TEMPLATE_MATCHING_COLOR_AND_MATRIX,mono:artoolkit.AR_TEMPLATE_MATCHING_MONO,mono_and_matrix:artoolkit.AR_TEMPLATE_MATCHING_MONO_AND_MATRIX},F=ne[U.parameters.detectionMode];console.assert(F!==void 0),ie.setPatternDetectionMode(F);var fe={"3x3":artoolkit.AR_MATRIX_CODE_3x3,"3x3_HAMMING63":artoolkit.AR_MATRIX_CODE_3x3_HAMMING63,"3x3_PARITY65":artoolkit.AR_MATRIX_CODE_3x3_PARITY65,"4x4":artoolkit.AR_MATRIX_CODE_4x4,"4x4_BCH_13_9_3":artoolkit.AR_MATRIX_CODE_4x4_BCH_13_9_3,"4x4_BCH_13_5_5":artoolkit.AR_MATRIX_CODE_4x4_BCH_13_5_5},pe=fe[U.parameters.matrixCodeType];console.assert(pe!==void 0),ie.setMatrixCodeType(pe),ie.setPattRatio(U.parameters.patternRatio);var Me={black_region:artoolkit.AR_LABELING_BLACK_REGION,white_region:artoolkit.AR_LABELING_WHITE_REGION},ve=Me[U.parameters.labelingMode];console.assert(ve!==void 0),ie.setLabelingMode(ve),re()});return this},ARjs.Context.prototype.getProjectionMatrix=function(re){console.assert(this.parameters.trackingBackend==="artoolkit"),console.assert(this.arController,"arController MUST be initialized to call this function");var U=this.arController.getCameraMatrix(),Y=new THREE.Matrix4().fromArray(U);return Y.multiply(this._artoolkitProjectionAxisTransformMatrix),Y},ARjs.Context.prototype._updateArtoolkit=function(re){this.arController.process(re)},ARjs.Context.prototype._initAruco=function(re){this.arucoContext=new THREEx.ArucoContext,this.arucoContext.canvas.width=this.parameters.canvasWidth,this.arucoContext.canvas.height=this.parameters.canvasHeight;var U=this.arucoContext.canvas.getContext("2d");U.webkitImageSmoothingEnabled=this.parameters.imageSmoothingEnabled,U.msImageSmoothingEnabled=this.parameters.imageSmoothingEnabled,U.imageSmoothingEnabled=this.parameters.imageSmoothingEnabled,setTimeout(function(){re()},0)},ARjs.Context.prototype._updateAruco=function(re){var U=this,Y=this._arMarkersControls,ie=this.arucoContext.detect(re);ie.forEach(function(ne){for(var F=null,fe=0;fe<Y.length;fe++)if(console.assert(Y[fe].parameters.type==="barcode"),Y[fe].parameters.barcodeValue===ne.id){F=Y[fe];break}if(F!==null){var pe=new THREE.Object3D;U.arucoContext.updateObject3D(pe,F._arucoPosit,F.parameters.size,ne),pe.updateMatrix(),F.updateWithModelViewMatrix(pe.matrix)}})};var ARjs=ARjs||{},THREEx=THREEx||{};ARjs.Profile=THREEx.ArToolkitProfile=function(){this.reset(),this.performance("default")},ARjs.Profile.prototype._guessPerformanceLabel=function(){var re=!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i));return re===!0?"phone-normal":"desktop-normal"},ARjs.Profile.prototype.reset=function(){return this.sourceParameters={sourceType:"webcam"},this.contextParameters={cameraParametersUrl:THREEx.ArToolkitContext.baseURL+"../data/data/camera_para.dat",detectionMode:"mono",labelingMode:"black_region"},this.defaultMarkerParameters={type:"pattern",patternUrl:THREEx.ArToolkitContext.baseURL+"../data/data/patt.hiro",changeMatrixMode:"modelViewMatrix"},this},ARjs.Profile.prototype.performance=function(re){return re==="default"&&(re=this._guessPerformanceLabel()),re==="desktop-fast"?(this.contextParameters.canvasWidth=640*3,this.contextParameters.canvasHeight=480*3,this.contextParameters.maxDetectionRate=30):re==="desktop-normal"?(this.contextParameters.canvasWidth=640,this.contextParameters.canvasHeight=480,this.contextParameters.maxDetectionRate=60):re==="phone-normal"?(this.contextParameters.canvasWidth=80*4,this.contextParameters.canvasHeight=60*4,this.contextParameters.maxDetectionRate=30):re==="phone-slow"?(this.contextParameters.canvasWidth=80*3,this.contextParameters.canvasHeight=60*3,this.contextParameters.maxDetectionRate=30):console.assert(!1,"unknonwn label "+re),this},ARjs.Profile.prototype.defaultMarker=function(re){return re=re||this.contextParameters.trackingBackend,re==="artoolkit"?(this.contextParameters.detectionMode="mono",this.defaultMarkerParameters.type="pattern",this.defaultMarkerParameters.patternUrl=THREEx.ArToolkitContext.baseURL+"../data/data/patt.hiro",this.contextParameters.labelingMode="black_region"):re==="aruco"?(this.contextParameters.detectionMode="mono",this.defaultMarkerParameters.type="barcode",this.defaultMarkerParameters.barcodeValue=1001,this.contextParameters.labelingMode="black_region"):console.assert(!1),this},ARjs.Profile.prototype.sourceWebcam=function(){return this.sourceParameters.sourceType="webcam",delete this.sourceParameters.sourceUrl,this},ARjs.Profile.prototype.sourceVideo=function(re){return this.sourceParameters.sourceType="video",this.sourceParameters.sourceUrl=re,this},ARjs.Profile.prototype.sourceImage=function(re){return this.sourceParameters.sourceType="image",this.sourceParameters.sourceUrl=re,this},ARjs.Profile.prototype.trackingBackend=function(re){return console.warn("stop profile.trackingBackend() obsolete function. use .trackingMethod instead"),this.contextParameters.trackingBackend=re,this},ARjs.Profile.prototype.changeMatrixMode=function(re){return this.defaultMarkerParameters.changeMatrixMode=re,this},ARjs.Profile.prototype.trackingMethod=function(re){var U=ARjs.Utils.parseTrackingMethod(re);return this.defaultMarkerParameters.markersAreaEnabled=U.markersAreaEnabled,this.contextParameters.trackingBackend=U.trackingBackend,this},ARjs.Profile.prototype.checkIfValid=function(){return this};var ARjs=ARjs||{},THREEx=THREEx||{};ARjs.Source=THREEx.ArToolkitSource=function(re){var U=this;this.ready=!1,this.domElement=null,this.parameters={sourceType:"webcam",sourceUrl:null,deviceId:null,sourceWidth:640,sourceHeight:480,displayWidth:640,displayHeight:480},Y(re);function Y(ie){if(ie!==void 0)for(var ne in ie){var F=ie[ne];if(F===void 0){console.warn("THREEx.ArToolkitSource: '"+ne+"' parameter is undefined.");continue}var fe=U.parameters[ne];if(fe===void 0){console.warn("THREEx.ArToolkitSource: '"+ne+"' is not a property of this material.");continue}U.parameters[ne]=F}}},ARjs.Source.prototype.init=function(re,U){var Y=this;if(this.parameters.sourceType==="image")var ie=this._initSourceImage(ne,U);else if(this.parameters.sourceType==="video")var ie=this._initSourceVideo(ne,U);else if(this.parameters.sourceType==="webcam")var ie=this._initSourceWebcam(ne,U);else console.assert(!1);return this.domElement=ie,this.domElement.style.position="absolute",this.domElement.style.top="0px",this.domElement.style.left="0px",this.domElement.style.zIndex="-2",this.domElement.setAttribute("id","arjs-video"),this;function ne(){document.body.appendChild(Y.domElement),window.dispatchEvent(new CustomEvent("arjs-video-loaded",{detail:{component:document.querySelector("#arjs-video")}})),Y.ready=!0,re&&re()}},ARjs.Source.prototype._initSourceImage=function(re){var U=document.createElement("img");return U.src=this.parameters.sourceUrl,U.width=this.parameters.sourceWidth,U.height=this.parameters.sourceHeight,U.style.width=this.parameters.displayWidth+"px",U.style.height=this.parameters.displayHeight+"px",U.onload=re,U},ARjs.Source.prototype._initSourceVideo=function(re){var U=document.createElement("video");return U.src=this.parameters.sourceUrl,U.style.objectFit="initial",U.autoplay=!0,U.webkitPlaysinline=!0,U.controls=!1,U.loop=!0,U.muted=!0,document.body.addEventListener("click",function Y(){document.body.removeEventListener("click",Y),U.play()}),U.width=this.parameters.sourceWidth,U.height=this.parameters.sourceHeight,U.style.width=this.parameters.displayWidth+"px",U.style.height=this.parameters.displayHeight+"px",U.onloadeddata=re,U},ARjs.Source.prototype._initSourceWebcam=function(re,U){var Y=this;U=U||function(F){alert(`Webcam Error
Name: `+F.name+`
Message: `+F.message);var fe=new CustomEvent("camera-error",{error:F});window.dispatchEvent(fe)};var ie=document.createElement("video");if(ie.setAttribute("autoplay",""),ie.setAttribute("muted",""),ie.setAttribute("playsinline",""),ie.style.width=this.parameters.displayWidth+"px",ie.style.height=this.parameters.displayHeight+"px",navigator.mediaDevices===void 0||navigator.mediaDevices.enumerateDevices===void 0||navigator.mediaDevices.getUserMedia===void 0){if(navigator.mediaDevices===void 0)var ne="navigator.mediaDevices";else if(navigator.mediaDevices.enumerateDevices===void 0)var ne="navigator.mediaDevices.enumerateDevices";else if(navigator.mediaDevices.getUserMedia===void 0)var ne="navigator.mediaDevices.getUserMedia";else console.assert(!1);return U({name:"",message:"WebRTC issue-! "+ne+" not present in your browser"}),null}return navigator.mediaDevices.enumerateDevices().then(function(F){var fe={audio:!1,video:{facingMode:"environment",width:{ideal:Y.parameters.sourceWidth},height:{ideal:Y.parameters.sourceHeight}}};Y.parameters.deviceId!==null&&(fe.video.deviceId={exact:Y.parameters.deviceId}),navigator.mediaDevices.getUserMedia(fe).then(function(Me){ie.srcObject=Me;var ve=new CustomEvent("camera-init",{stream:Me});window.dispatchEvent(ve),document.body.addEventListener("click",function(){ie.play()}),re()}).catch(function(pe){U({name:pe.name,message:pe.message})})}).catch(function(F){U({message:F.message})}),ie},ARjs.Source.prototype.hasMobileTorch=function(){var re=arToolkitSource.domElement.srcObject;if(!(re instanceof MediaStream))return!1;this._currentTorchStatus===void 0&&(this._currentTorchStatus=!1);var U=re.getVideoTracks()[0];if(U.getCapabilities===void 0)return!1;var Y=U.getCapabilities();return!!Y.torch},ARjs.Source.prototype.toggleMobileTorch=function(){console.assert(this.hasMobileTorch()===!0);var re=arToolkitSource.domElement.srcObject;if(!(re instanceof MediaStream)){alert("enabling mobile torch is available only on webcam");return}this._currentTorchStatus===void 0&&(this._currentTorchStatus=!1);var U=re.getVideoTracks()[0],Y=U.getCapabilities();if(!Y.torch){alert("no mobile torch is available on your camera");return}this._currentTorchStatus=this._currentTorchStatus===!1,U.applyConstraints({advanced:[{torch:this._currentTorchStatus}]}).catch(function(ie){console.log(ie)})},ARjs.Source.prototype.domElementWidth=function(){return parseInt(this.domElement.style.width)},ARjs.Source.prototype.domElementHeight=function(){return parseInt(this.domElement.style.height)},ARjs.Source.prototype.onResizeElement=function(){var re=window.innerWidth,U=window.innerHeight;if(console.assert(arguments.length===0),this.domElement.nodeName==="IMG")var Y=this.domElement.naturalWidth,ie=this.domElement.naturalHeight;else if(this.domElement.nodeName==="VIDEO")var Y=this.domElement.videoWidth,ie=this.domElement.videoHeight;else console.assert(!1);var ne=Y/ie,F=re/U;if(F<ne){var fe=ne*U;this.domElement.style.width=fe+"px",this.domElement.style.marginLeft=-(fe-re)/2+"px",this.domElement.style.height=U+"px",this.domElement.style.marginTop="0px"}else{var pe=1/(ne/re);this.domElement.style.height=pe+"px",this.domElement.style.marginTop=-(pe-U)/2+"px",this.domElement.style.width=re+"px",this.domElement.style.marginLeft="0px"}},ARjs.Source.prototype.copyElementSizeTo=function(re){window.innerWidth>window.innerHeight?(re.style.width=this.domElement.style.width,re.style.height=this.domElement.style.height,re.style.marginLeft=this.domElement.style.marginLeft,re.style.marginTop=this.domElement.style.marginTop):(re.style.height=this.domElement.style.height,re.style.width=parseInt(re.style.height)*4/3+"px",re.style.marginLeft=(window.innerWidth-parseInt(re.style.width))/2+"px",re.style.marginTop=0)},ARjs.Source.prototype.copySizeTo=function(){console.warn("obsolete function arToolkitSource.copySizeTo. Use arToolkitSource.copyElementSizeTo"),this.copyElementSizeTo.apply(this,arguments)},ARjs.Source.prototype.onResize=function(re,U,Y){if(arguments.length!==3)return console.warn("obsolete function arToolkitSource.onResize. Use arToolkitSource.onResizeElement"),this.onResizeElement.apply(this,arguments);var ie=re.parameters.trackingBackend;if(ie==="artoolkit"){this.onResizeElement();var ne=!!U.domElement.dataset.aframeCanvas;ne===!1&&this.copyElementSizeTo(U.domElement),re.arController!==null&&this.copyElementSizeTo(re.arController.canvas)}else ie==="aruco"?(this.onResizeElement(),this.copyElementSizeTo(U.domElement),this.copyElementSizeTo(re.arucoContext.canvas)):console.assert(!1,"unhandled trackingBackend "+ie);ie==="artoolkit"?re.arController!==null&&Y.projectionMatrix.copy(re.getProjectionMatrix()):ie==="aruco"?(Y.aspect=U.domElement.width/U.domElement.height,Y.updateProjectionMatrix()):console.assert(!1,"unhandled trackingBackend "+ie)};var THREEx=THREEx||{};THREEx.ArVideoInWebgl=function(re){var U=new THREE.PlaneGeometry(2,2),Y=new THREE.MeshBasicMaterial({map:re}),ie=new THREE.Mesh(U,Y);this.object3d=ie,this.update=function(ne){ne.updateMatrixWorld(!0);var F=new THREE.Vector3(-0,0,-20),F=new THREE.Vector3(-0,0,-20);ie.position.copy(F),ne.localToWorld(ie.position),ne.matrixWorld.decompose(ne.position,ne.quaternion,ne.scale),ie.quaternion.copy(ne.quaternion);var fe=THREE.Math.radToDeg(Math.atan(1/ne.projectionMatrix.elements[5]))*2,pe=parseFloat(arToolkitSource.domElement.style.width.replace(/px$/,""),10),Me=parseFloat(arToolkitSource.domElement.style.height.replace(/px$/,""),10),ve=pe/Me;ie.scale.y=Math.tan(THREE.Math.DEG2RAD*fe/2)*F.length(),ie.scale.x=ie.scale.y*ve}};var THREEx=THREEx||{};THREEx.HitTestingPlane=function(re){this._sourceElement=re,this._pickingScene=new THREE.Scene;var U=new THREE.PlaneGeometry(20,20,19,19).rotateX(-Math.PI/2),Y=new THREE.MeshBasicMaterial({wireframe:!0});this._pickingPlane=new THREE.Mesh(U,Y),this._pickingScene.add(this._pickingPlane);var ie=parseInt(re.style.width),ne=parseInt(re.style.height);this._pickingCamera=new THREE.PerspectiveCamera(42,ie/ne,.1,30)},THREEx.HitTestingPlane.prototype.update=function(re,U,Y){if(this.onResize(),Y==="modelViewMatrix"){var ie=this._pickingPlane;U.parent.updateMatrixWorld(),ie.matrix.copy(U.parent.matrixWorld),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale)}else if(Y==="cameraTransformMatrix"){var ne=this._pickingCamera;re.updateMatrixWorld(),ne.matrix.copy(re.matrixWorld),ne.matrix.decompose(ne.position,ne.quaternion,ne.scale)}else console.assert(!1)},THREEx.HitTestingPlane.prototype.onResize=function(){var re=this._sourceElement,U=this._pickingCamera,Y=parseInt(re.style.width),ie=parseInt(re.style.height);U.aspect=Y/ie,U.updateProjectionMatrix()},THREEx.HitTestingPlane.prototype.test=function(re,U){re=(re-.5)*2,U=-(U-.5)*2,this._pickingScene.updateMatrixWorld(!0);var Y=new THREE.Raycaster,ie=new THREE.Vector3(re,U,1);Y.setFromCamera(ie,this._pickingCamera);var ne=Y.intersectObjects([this._pickingPlane]);if(ne.length===0)return null;var F=this._pickingPlane.worldToLocal(ne[0].point.clone()),fe=new THREE.Quaternion,pe=new THREE.Vector3(1,1,1);return{position:F,quaternion:fe,scale:pe}},THREEx.HitTestingPlane.prototype.renderDebug=function(re){re.render(this._pickingScene,this._pickingCamera)};var ARjs=ARjs||{};ARjs.Anchor=function(re,U){var Y=this,ie=re.arContext,ne=re.parameters.scene,F=re.parameters.camera;this.arSession=re,this.parameters=U,console.log("ARjs.Anchor -","changeMatrixMode:",this.parameters.changeMatrixMode,"/ markersAreaEnabled:",U.markersAreaEnabled);var fe=new THREE.Group;if(ne.add(fe),U.changeMatrixMode==="modelViewMatrix")var pe=fe;else if(U.changeMatrixMode==="cameraTransformMatrix")var pe=F;else console.assert(!1);if(U.markersAreaEnabled===!1){var Me=new THREEx.ArMarkerControls(ie,pe,U);this.controls=Me}else{if(console.assert(ie.parameters.trackingBackend==="artoolkit"||ie.parameters.trackingBackend==="aruco"),location.hash.substring(1).startsWith("markers-page-resolution=")===!0){var ve=location.hash.substring(1),se=ve.match(/markers-page-resolution=(\d+)x(\d+)/);console.assert(se.length===3);var me=parseInt(se[1]),Te=parseInt(se[2]),ie=re.arContext;ARjs.MarkersAreaUtils.storeMarkersAreaFileFromResolution(ie.parameters.trackingBackend,me,Te)}localStorage.getItem("ARjsMultiMarkerFile")===null&&ARjs.MarkersAreaUtils.storeDefaultMultiMarkerFile(ie.parameters.trackingBackend),console.assert(localStorage.getItem("ARjsMultiMarkerFile")!==null);var Re=localStorage.getItem("ARjsMultiMarkerFile");if(U.changeMatrixMode==="modelViewMatrix")var be=ne;else if(U.changeMatrixMode==="cameraTransformMatrix")var be=F;else console.assert(!1);var Pe=ARjs.MarkersAreaControls.fromJSON(ie,be,pe,Re);this.controls=Pe,Pe.parameters.changeMatrixMode=U.changeMatrixMode;var Le=[];Pe.subMarkersControls.forEach(function(Oe){var Ne=new THREEx.ArMarkerHelper(Oe);Ne.object3d.visible=!1,Oe.object3d.add(Ne.object3d),Le.push(Ne)}),this.markersArea={},this.markersArea.setSubMarkersVisibility=function(Oe){Le.forEach(function(Ne){Ne.object3d.visible=Oe})}}this.object3d=new THREE.Group;{var xe=new THREE.Group;ne.add(xe);var Fe=new THREEx.ArSmoothedControls(xe);xe.add(this.object3d)}this.update=function(){Y.object3d.visible=Y.object3d.parent.visible,Fe!==void 0&&(Pe!==void 0&&Pe.updateSmoothedControls(Fe),Fe.update(fe))}};var ARjs=ARjs||{};ARjs.SessionDebugUI=function(re){var U=re.arContext.parameters.trackingBackend;this.domElement=document.createElement("div"),this.domElement.style.color="rgba(0,0,0,0.9)",this.domElement.style.backgroundColor="rgba(127,127,127,0.5)",this.domElement.style.display="block",this.domElement.style.padding="0.5em",this.domElement.style.position="fixed",this.domElement.style.left="5px",this.domElement.style.bottom="10px",this.domElement.style.textAlign="right";var Y=document.createElement("span");Y.style.display="block",Y.innerHTML="<b>trackingBackend</b> : "+U,this.domElement.appendChild(Y)},ARjs.SessionDebugUI.AugmentedWebsiteURL="https://webxr.io/augmented-website",ARjs.AnchorDebugUI=function(re){var U=re.arSession,Y=U.arContext.parameters.trackingBackend;this.domElement=document.createElement("div"),this.domElement.style.color="rgba(0,0,0,0.9)",this.domElement.style.backgroundColor="rgba(127,127,127,0.5)",this.domElement.style.display="inline-block",this.domElement.style.padding="0.5em",this.domElement.style.margin="0.5em",this.domElement.style.textAlign="left";var ie=document.createElement("span");if(ie.style.display="block",ie.style.padding="0.5em",ie.style.color="rgba(0,0,0,0.9)",ie.style.backgroundColor="rgba(127,127,127,0.5)",ie.style.position="fixed",ie.style.left="5px",ie.style.bottom="40px",this.domElement.appendChild(ie),ie.innerHTML="<b>markersAreaEnabled</b> :"+re.parameters.markersAreaEnabled,re.parameters.markersAreaEnabled){var ie=document.createElement("button");ie.style.display="block",this.domElement.style.padding="0.5em",this.domElement.style.position="fixed",this.domElement.style.textAlign="left",this.domElement.appendChild(ie),ie.id="buttonToggleMarkerHelpers",ie.innerHTML="toggle-marker-helper",ie.href="javascript:void(0)";var ne=!1;ie.addEventListener("click",function(){ne=!ne,re.markersArea.setSubMarkersVisibility(ne)})}if(re.parameters.markersAreaEnabled){var ie=document.createElement("button");ie.style.display="block",this.domElement.appendChild(ie),ie.id="buttonMarkersAreaLearner",ie.innerHTML="Learn-new-marker-area",ie.href="javascript:void(0)",ie.addEventListener("click",function(){if(ARjs.AnchorDebugUI.MarkersAreaLearnerURL!==null)var fe=ARjs.AnchorDebugUI.MarkersAreaLearnerURL;else var fe=ARjs.Context.baseURL+"examples/multi-markers/examples/learner.html";ARjs.MarkersAreaUtils.navigateToLearnerPage(fe,Y)})}if(re.parameters.markersAreaEnabled){var ie=document.createElement("button");ie.style.display="block",this.domElement.appendChild(ie),ie.id="buttonMarkersAreaReset",ie.innerHTML="Reset-marker-area",ie.href="javascript:void(0)",ie.addEventListener("click",function(){ARjs.MarkersAreaUtils.storeDefaultMultiMarkerFile(Y),location.reload()})}},ARjs.AnchorDebugUI.MarkersAreaLearnerURL=null;var ARjs=ARjs||{};ARjs.HitTesting=function(re){var U=this,Y=re.arContext;Y.parameters.trackingBackend,this.enabled=!0,this._arSession=re,this._hitTestingPlane=null,U._hitTestingPlane=new THREEx.HitTestingPlane(re.arSource.domElement)},ARjs.HitTesting.prototype.update=function(re,U,Y){this.enabled!==!1&&(this._hitTestingPlane!==null?this._hitTestingPlane.update(re,U,Y):console.assert(!1))},ARjs.HitTesting.prototype.testDomEvent=function(re){this._arSession.arContext.parameters.trackingBackend;var U=this._arSession.arSource;if(this.enabled===!1)return[];var Y=re.clientX/U.domElementWidth(),ie=re.clientY/U.domElementHeight();return this.test(Y,ie)},ARjs.HitTesting.prototype.test=function(re,U){var Y=this._arSession.arContext;Y.parameters.trackingBackend;var ie=[];if(this.enabled===!1)return[];var ne=this._hitTestingPlane.test(re,U);if(ne===null)return ie;var F=new ARjs.HitTesting.Result(ne.position,ne.quaternion,ne.scale);return ie.push(F),ie},ARjs.HitTesting.Result=function(re,U,Y){this.position=re,this.quaternion=U,this.scale=Y},ARjs.HitTesting.Result.prototype.apply=function(re){re.position.copy(this.position),re.quaternion.copy(this.quaternion),re.scale.copy(this.scale),re.updateMatrix()},ARjs.HitTesting.Result.prototype.applyPosition=function(re){return re.position.copy(this.position),re.updateMatrix(),this},ARjs.HitTesting.Result.prototype.applyQuaternion=function(re){return re.quaternion.copy(this.quaternion),re.updateMatrix(),this};var ARjs=ARjs||{};ARjs.Session=function(re){var U=this;this.parameters={renderer:null,camera:null,scene:null,sourceParameters:{},contextParameters:{}},Y(re);function Y(F){if(F!==void 0)for(var fe in F){var pe=F[fe];if(pe===void 0){console.warn("THREEx.Session: '"+fe+"' parameter is undefined.");continue}var Me=U.parameters[fe];if(Me===void 0){console.warn("THREEx.Session: '"+fe+"' is not a property of this material.");continue}U.parameters[fe]=pe}}console.assert(this.parameters.renderer instanceof THREE.WebGLRenderer),console.assert(this.parameters.camera instanceof THREE.Camera),console.assert(this.parameters.scene instanceof THREE.Scene),Object.defineProperty(this,"renderer",{get:function(){return console.warn("use .parameters.renderer renderer"),this.parameters.renderer}}),Object.defineProperty(this,"camera",{get:function(){return console.warn("use .parameters.camera instead"),this.parameters.camera}}),Object.defineProperty(this,"scene",{get:function(){return console.warn("use .parameters.scene instead"),this.parameters.scene}}),console.log("AR.js",ARjs.Context.REVISION,"- trackingBackend:",re.contextParameters.trackingBackend);var ie=U.arSource=new ARjs.Source(re.sourceParameters);ie.init(function(){ie.onResize(ne,U.parameters.renderer,U.parameters.camera)}),window.addEventListener("resize",function(){ie.onResize(ne,U.parameters.renderer,U.parameters.camera)});var ne=U.arContext=new ARjs.Context(re.contextParameters);U.arContext.init(),ne.addEventListener("initialized",function(F){ie.onResize(ne,U.parameters.renderer,U.parameters.camera)}),this.update=function(){ie.ready!==!1&&ne.update(ie.domElement)}},ARjs.Session.prototype.onResize=function(){this.arSource.onResize(this.arContext,this.parameters.renderer,this.parameters.camera)};var ARjs=ARjs||{};ARjs.Utils={},ARjs.Utils.createDefaultCamera=function(re){var U=this.parseTrackingMethod(re).trackingBackend;if(U==="artoolkit")var Y=new THREE.Camera;else if(U==="aruco")var Y=new THREE.PerspectiveCamera(42,window.innerWidth/window.innerHeight,.01,100);else console.assert(!1,"unknown trackingBackend: "+U);return Y},ARjs.Utils.parseTrackingMethod=function(re){return re==="best"&&(re="area-artoolkit"),re.startsWith("area-")?{trackingBackend:re.replace("area-",""),markersAreaEnabled:!0}:{trackingBackend:re,markersAreaEnabled:!1}};var ARjs=ARjs||{},THREEx=THREEx||{};ARjs.MarkersAreaControls=THREEx.ArMultiMarkerControls=function(re,U,Y){var ie=this;THREEx.ArBaseControls.call(this,U),arguments.length>3&&console.assert("wrong api for",THREEx.ArMultiMarkerControls),this.parameters={subMarkersControls:Y.subMarkersControls,subMarkerPoses:Y.subMarkerPoses,changeMatrixMode:Y.changeMatrixMode!==void 0?Y.changeMatrixMode:"modelViewMatrix"},this.object3d.visible=!1,this.subMarkersControls=this.parameters.subMarkersControls,this.subMarkerPoses=this.parameters.subMarkerPoses,re.addEventListener("sourceProcessed",function(){ie._onSourceProcessed()})},ARjs.MarkersAreaControls.prototype=Object.create(THREEx.ArBaseControls.prototype),ARjs.MarkersAreaControls.prototype.constructor=ARjs.MarkersAreaControls,ARjs.MarkersAreaControls.prototype._onSourceProcessed=function(){var re=this,U={count:0,position:{sum:new THREE.Vector3(0,0,0),average:new THREE.Vector3(0,0,0)},quaternion:{sum:new THREE.Quaternion(0,0,0,0),average:new THREE.Quaternion(0,0,0,0)},scale:{sum:new THREE.Vector3(0,0,0),average:new THREE.Vector3(0,0,0)}},Y=re.parameters.subMarkersControls[0].object3d.quaternion;if(this.parameters.subMarkersControls.forEach(function(ne,F){var fe=ne.object3d;if(fe.visible!==!1){var pe=fe.matrix.clone(),Me=re.parameters.subMarkerPoses[F];pe.multiply(new THREE.Matrix4().getInverse(Me));var ve=new THREE.Vector3,se=new THREE.Quaternion,me=new THREE.Vector3;pe.decompose(ve,se,me),U.count++,ARjs.MarkersAreaControls.averageVector3(U.position.sum,ve,U.count,U.position.average),ARjs.MarkersAreaControls.averageQuaternion(U.quaternion.sum,se,Y,U.count,U.quaternion.average),ARjs.MarkersAreaControls.averageVector3(U.scale.sum,me,U.count,U.scale.average)}}),U.count>0?re.object3d.visible=!0:re.object3d.visible=!1,U.count>0){var ie=new THREE.Matrix4;ie.compose(U.position.average,U.quaternion.average,U.scale.average),this.parameters.changeMatrixMode==="modelViewMatrix"?re.object3d.matrix.copy(ie):this.parameters.changeMatrixMode==="cameraTransformMatrix"?re.object3d.matrix.getInverse(ie):console.assert(!1),re.object3d.matrix.decompose(re.object3d.position,re.object3d.quaternion,re.object3d.scale)}},ARjs.MarkersAreaControls.averageQuaternion=function(re,U,Y,ie,ne){return ne=ne||new THREE.Quaternion,console.assert(Y instanceof THREE.Quaternion),U.dot(Y)>0&&(U=new THREE.Quaternion(-U.x,-U.y,-U.z,-U.w)),re.x+=U.x,re.y+=U.y,re.z+=U.z,re.w+=U.w,ne.x=re.x/ie,ne.y=re.y/ie,ne.z=re.z/ie,ne.w=re.w/ie,ne.normalize(),ne},ARjs.MarkersAreaControls.averageVector3=function(re,U,Y,ie){return ie=ie||new THREE.Vector3,re.x+=U.x,re.y+=U.y,re.z+=U.z,ie.x=re.x/Y,ie.y=re.y/Y,ie.z=re.z/Y,ie},ARjs.MarkersAreaControls.computeCenter=function(re){var U=JSON.parse(re),Y={count:0,position:{sum:new THREE.Vector3(0,0,0),average:new THREE.Vector3(0,0,0)},quaternion:{sum:new THREE.Quaternion(0,0,0,0),average:new THREE.Quaternion(0,0,0,0)},scale:{sum:new THREE.Vector3(0,0,0),average:new THREE.Vector3(0,0,0)}},ie=new THREE.Quaternion;U.subMarkersControls.forEach(function(F){var fe=new THREE.Matrix4().fromArray(F.poseMatrix),pe=new THREE.Vector3,Me=new THREE.Quaternion,ve=new THREE.Vector3;fe.decompose(pe,Me,ve),Y.count++,ARjs.MarkersAreaControls.averageVector3(Y.position.sum,pe,Y.count,Y.position.average),ARjs.MarkersAreaControls.averageQuaternion(Y.quaternion.sum,Me,ie,Y.count,Y.quaternion.average),ARjs.MarkersAreaControls.averageVector3(Y.scale.sum,ve,Y.count,Y.scale.average)});var ne=new THREE.Matrix4;return ne.compose(Y.position.average,Y.quaternion.average,Y.scale.average),ne},ARjs.MarkersAreaControls.computeBoundingBox=function(re){var U=JSON.parse(re),Y=new THREE.Box3;return U.subMarkersControls.forEach(function(ie){var ne=new THREE.Matrix4().fromArray(ie.poseMatrix),F=new THREE.Vector3,fe=new THREE.Quaternion,pe=new THREE.Vector3;ne.decompose(F,fe,pe),Y.expandByPoint(F)}),Y},ARjs.MarkersAreaControls.prototype.updateSmoothedControls=function(re,U){U===void 0&&(U=[[.3+.1,.1,.3],[.4+.1,.1,.4],[.4+.1,.2,.5],[.5+.1,.2,.7],[.5+.1,.2,.7]]);var Y=0;if(this.parameters.subMarkersControls.forEach(function(ne,F){var fe=ne.object3d;fe.visible===!0&&Y++}),U[Y-1]!==void 0)var ie=U[Y-1];else var ie=U[U.length-1];re.parameters.lerpPosition=ie[0],re.parameters.lerpQuaternion=ie[1],re.parameters.lerpScale=ie[2]},ARjs.MarkersAreaControls.fromJSON=function(re,U,Y,ie,ne){var F=JSON.parse(ie),fe=[],pe=[];ne=ne||{},F.subMarkersControls.forEach(function(ve){var se=new THREE.Object3D;U.add(se);var me=new THREEx.ArMarkerControls(re,se,ve.parameters);fe.push(me),pe.push(new THREE.Matrix4().fromArray(ve.poseMatrix))}),ne.subMarkersControls=fe,ne.subMarkerPoses=pe;var Me=new THREEx.ArMultiMarkerControls(re,Y,ne);return Me};var ARjs=ARjs||{},THREEx=THREEx||{};ARjs.MarkersAreaLearning=THREEx.ArMultiMakersLearning=function(re,U){var Y=this;this._arToolkitContext=re,this.subMarkersControls=U,this.enabled=!0,re.addEventListener("sourceProcessed",function(){Y._onSourceProcessed()})},ARjs.MarkersAreaLearning.prototype._onSourceProcessed=function(){var re=this.subMarkersControls[0].object3d.quaternion;if(this.enabled!==!1)for(var U=this.subMarkersControls.filter(function(Re){return Re.object3d.visible===!0}),Y=Object.keys(U).length,ie=new THREE.Vector3,ne=new THREE.Quaternion,F=new THREE.Vector3,fe=new THREE.Matrix4,pe=0;pe<Y;pe++)for(var Me=U[pe],ve=0;ve<Y;ve++){var se=U[ve];if(pe!==ve){Me.object3d.userData.seenCouples===void 0&&(Me.object3d.userData.seenCouples={});var me=Me.object3d.userData.seenCouples;me[se.id]===void 0&&(me[se.id]={count:0,position:{sum:new THREE.Vector3(0,0,0),average:new THREE.Vector3(0,0,0)},quaternion:{sum:new THREE.Quaternion(0,0,0,0),average:new THREE.Quaternion(0,0,0,0)},scale:{sum:new THREE.Vector3(0,0,0),average:new THREE.Vector3(0,0,0)}}),fe.getInverse(Me.object3d.matrix),fe.multiply(se.object3d.matrix),fe.decompose(ie,ne,F);var Te=me[se.id];Te.count++,THREEx.ArMultiMarkerControls.averageVector3(Te.position.sum,ie,Te.count,Te.position.average),THREEx.ArMultiMarkerControls.averageQuaternion(Te.quaternion.sum,ne,re,Te.count,Te.quaternion.average),THREEx.ArMultiMarkerControls.averageVector3(Te.scale.sum,F,Te.count,Te.scale.average)}}},ARjs.MarkersAreaLearning.prototype.computeResult=function(){var re=this,U=this.subMarkersControls[0];this.deleteResult(),U.object3d.userData.result={averageMatrix:new THREE.Matrix4,confidenceFactor:1};do{var Y=!1;this.subMarkersControls.forEach(function(ie){var ne=ie.object3d.userData.result,F=ne!==void 0&&ne.confidenceFactor>=1;if(F!==!0){var fe=re._getLearnedCoupleStats(ie);if(fe!==null){var pe=re._getSubMarkerControlsByID(fe),Me=ie.object3d.userData.seenCouples[fe],ve=new THREE.Matrix4;ve.compose(Me.position.average,Me.quaternion.average,Me.scale.average);var se=pe.object3d.userData.result.averageMatrix,me=new THREE.Matrix4().getInverse(se).multiply(ve);me=new THREE.Matrix4().getInverse(me),console.assert(ie.object3d.userData.result===void 0),ie.object3d.userData.result={averageMatrix:me,confidenceFactor:1},Y=!0}}})}while(Y===!0)},ARjs.MarkersAreaLearning.prototype._getLearnedCoupleStats=function(re){if(re.object3d.userData.seenCouples===void 0)return null;for(var U=re.object3d.userData.seenCouples,Y=Object.keys(U).map(Number),ie=0;ie<Y.length;ie++){var ne=Y[ie],F=this._getSubMarkerControlsByID(ne),fe=F.object3d.userData.result,pe=fe!==void 0&&fe.confidenceFactor>=1;if(pe!==!1)return ne}return null},ARjs.MarkersAreaLearning.prototype._getSubMarkerControlsByID=function(re){for(var U=0;U<this.subMarkersControls.length;U++){var Y=this.subMarkersControls[U];if(Y.id===re)return Y}return null},ARjs.MarkersAreaLearning.prototype.toJSON=function(){this.computeResult();var re={meta:{createdBy:"Area Learning - AR.js "+THREEx.ArToolkitContext.REVISION,createdAt:new Date().toJSON()},trackingBackend:this._arToolkitContext.parameters.trackingBackend,subMarkersControls:[]},U=this.subMarkersControls[0];new THREE.Matrix4().getInverse(U.object3d.matrix),this.subMarkersControls.forEach(function(ie,ne){if(ie.object3d.userData.result!==void 0){var F=ie.object3d.userData.result.averageMatrix;console.assert(F instanceof THREE.Matrix4);var fe={parameters:{},poseMatrix:F.toArray()};ie.parameters.type==="pattern"?(fe.parameters.type=ie.parameters.type,fe.parameters.patternUrl=ie.parameters.patternUrl):ie.parameters.type==="barcode"?(fe.parameters.type=ie.parameters.type,fe.parameters.barcodeValue=ie.parameters.barcodeValue):console.assert(!1),re.subMarkersControls.push(fe)}});var Y=JSON.stringify(re,null,"	");return Y},ARjs.MarkersAreaLearning.prototype.resetStats=function(){this.deleteResult(),this.subMarkersControls.forEach(function(re){delete re.object3d.userData.seenCouples})},ARjs.MarkersAreaLearning.prototype.deleteResult=function(){this.subMarkersControls.forEach(function(re){delete re.object3d.userData.result})};var THREEx=THREEx||{},ARjs=ARjs||{},THREEx=THREEx||{};ARjs.MarkersAreaUtils=THREEx.ArMultiMarkerUtils={},ARjs.MarkersAreaUtils.navigateToLearnerPage=function(re,U){var Y={backURL:location.href,trackingBackend:U,markersControlsParameters:ARjs.MarkersAreaUtils.createDefaultMarkersControlsParameters(U)};location.href=re+"?"+encodeURIComponent(JSON.stringify(Y))},ARjs.MarkersAreaUtils.storeDefaultMultiMarkerFile=function(re){var U=ARjs.MarkersAreaUtils.createDefaultMultiMarkerFile(re);localStorage.setItem("ARjsMultiMarkerFile",JSON.stringify(U))},ARjs.MarkersAreaUtils.createDefaultMultiMarkerFile=function(re){if(console.assert(re),re===void 0)debugger;var U=document.createElement("a");U.href=ARjs.Context.baseURL;var Y=U.href,ie={meta:{createdBy:"AR.js "+ARjs.Context.REVISION+" - Default Marker",createdAt:new Date().toJSON()},trackingBackend:re,subMarkersControls:[]};return ie.subMarkersControls[0]={parameters:{},poseMatrix:new THREE.Matrix4().makeTranslation(0,0,0).toArray()},re==="artoolkit"?(ie.subMarkersControls[0].parameters.type="pattern",ie.subMarkersControls[0].parameters.patternUrl=Y+"examples/marker-training/examples/pattern-files/pattern-hiro.patt"):re==="aruco"?(ie.subMarkersControls[0].parameters.type="barcode",ie.subMarkersControls[0].parameters.barcodeValue=1001):console.assert(!1),ie},ARjs.MarkersAreaUtils.createDefaultMarkersControlsParameters=function(re){var U=document.createElement("a");U.href=ARjs.Context.baseURL;var Y=U.href;if(re==="artoolkit")var ie=[{type:"pattern",patternUrl:Y+"examples/marker-training/examples/pattern-files/pattern-hiro.patt"},{type:"pattern",patternUrl:Y+"examples/marker-training/examples/pattern-files/pattern-kanji.patt"},{type:"pattern",patternUrl:Y+"examples/marker-training/examples/pattern-files/pattern-letterA.patt"},{type:"pattern",patternUrl:Y+"examples/marker-training/examples/pattern-files/pattern-letterB.patt"},{type:"pattern",patternUrl:Y+"examples/marker-training/examples/pattern-files/pattern-letterC.patt"},{type:"pattern",patternUrl:Y+"examples/marker-training/examples/pattern-files/pattern-letterF.patt"}];else if(re==="aruco")var ie=[{type:"barcode",barcodeValue:1001},{type:"barcode",barcodeValue:1002},{type:"barcode",barcodeValue:1003},{type:"barcode",barcodeValue:1004},{type:"barcode",barcodeValue:1005},{type:"barcode",barcodeValue:1006}];else console.assert(!1);return ie},ARjs.MarkersAreaUtils.storeMarkersAreaFileFromResolution=function(re,U,Y){var ie=this.buildMarkersAreaFileFromResolution(re,U,Y);localStorage.setItem("ARjsMultiMarkerFile",JSON.stringify(ie))},ARjs.MarkersAreaUtils.buildMarkersAreaFileFromResolution=function(re,U,Y){var ie={meta:{createdBy:"AR.js - Augmented Website",createdAt:new Date().toJSON()},trackingBackend:re,subMarkersControls:[]},ne=.1;if(U>Y)var F=.4*Y;else if(U<Y)var F=.4*U;else if(U===Y)var F=.33*U;else console.assert(!1);var fe=F*(1-2*ne),pe=(U-F)/2/fe,Me=(Y-F)/2/fe,ve=se("center",0,0);ie.subMarkersControls.push(ve);var ve=se("topleft",-pe,-Me);ie.subMarkersControls.push(ve);var ve=se("topright",+pe,-Me);ie.subMarkersControls.push(ve);var ve=se("bottomleft",-pe,+Me);ie.subMarkersControls.push(ve);var ve=se("bottomright",+pe,+Me);return ie.subMarkersControls.push(ve),ie;function se(Re,be,Pe){console.log("buildSubMarkerControls",Re,be,Pe);var Le={parameters:{},poseMatrix:new THREE.Matrix4().makeTranslation(be,0,Pe).toArray()};return re==="artoolkit"?me(Le.parameters,Re):re==="aruco"?Te(Le.parameters,Re):console.assert(!1),Le}function me(Re,be){var Pe=document.createElement("a");Pe.href=ARjs.Context.baseURL;var Le=Pe.href,xe={center:Fe(Le+"examples/marker-training/examples/pattern-files/pattern-hiro.patt"),topleft:Fe(Le+"examples/marker-training/examples/pattern-files/pattern-letterA.patt"),topright:Fe(Le+"examples/marker-training/examples/pattern-files/pattern-letterB.patt"),bottomleft:Fe(Le+"examples/marker-training/examples/pattern-files/pattern-letterC.patt"),bottomright:Fe(Le+"examples/marker-training/examples/pattern-files/pattern-letterF.patt")};console.assert(xe[be]!==void 0),Re.type="pattern",Re.patternUrl=xe[be];return;function Fe(Oe){var Ne=document.createElement("a");return Ne.href=Oe,Ne.href}}function Te(Re,be){var Pe={center:1001,topleft:1002,topright:1003,bottomleft:1004,bottomright:1005};console.assert(Pe[be]),Re.type="barcode",Re.barcodeValue=Pe[be]}},AFRAME.registerComponent("arjs-anchor",{dependencies:["arjs","artoolkit"],schema:{preset:{type:"string"},markerhelpers:{type:"boolean",default:!1},size:{type:"number",default:1},type:{type:"string"},patternUrl:{type:"string"},barcodeValue:{type:"number"},changeMatrixMode:{type:"string",default:"modelViewMatrix"},minConfidence:{type:"number",default:.6},smooth:{type:"boolean",default:!1},smoothCount:{type:"number",default:5},smoothTolerance:{type:"number",default:.01},smoothThreshold:{type:"number",default:2}},init:function(){var re=this,U=this.el.sceneEl.systems.arjs||this.el.sceneEl.systems.artoolkit;re.isReady=!1,re._arAnchor=null,re.data.changeMatrixMode==="modelViewMatrix"?re.el.object3D.visible=!1:re.data.changeMatrixMode==="cameraTransformMatrix"?re.el.sceneEl.object3D.visible=!1:console.assert(!1);var Y=setInterval(function(){if(U.isReady!==!1){clearInterval(Y);var ie=U._arProfile;ie.changeMatrixMode(re.data.changeMatrixMode);var ne=Object.assign({},ie.defaultMarkerParameters);re.data.preset==="hiro"?(ne.type="pattern",ne.patternUrl=THREEx.ArToolkitContext.baseURL+"examples/marker-training/examples/pattern-files/pattern-hiro.patt",ne.markersAreaEnabled=!1):re.data.preset==="kanji"?(ne.type="pattern",ne.patternUrl=THREEx.ArToolkitContext.baseURL+"examples/marker-training/examples/pattern-files/pattern-kanji.patt",ne.markersAreaEnabled=!1):re.data.preset==="area"?(ne.type="barcode",ne.barcodeValue=1001,ne.markersAreaEnabled=!0):re.data.type==="barcode"?ne={type:re.data.type,changeMatrixMode:"modelViewMatrix",barcodeValue:re.data.barcodeValue,markersAreaEnabled:!1}:re.data.type==="pattern"&&(ne.type=re.data.type,ne.patternUrl=re.data.patternUrl,ne.markersAreaEnabled=!1),ne.smooth=re.data.smooth,ne.smoothCount=re.data.smoothCount,ne.smoothTolerance=re.data.smoothTolerance,ne.smoothThreshold=re.data.smoothThreshold;var F=U._arSession,fe=re._arAnchor=new ARjs.Anchor(F,ne);if(re.isReady=!0,U.data.debugUIEnabled){var pe=document.querySelector("#arjsDebugUIContainer");pe===null&&(pe=document.createElement("div"),pe.id="arjsDebugUIContainer",pe.setAttribute("style","position: fixed; bottom: 10px; width:100%; text-align: center; z-index: 1; color: grey;"),document.body.appendChild(pe));var Me=new ARjs.AnchorDebugUI(fe);pe.appendChild(Me.domElement)}}},1e3/60)},remove:function(){},update:function(){},tick:function(){var re=this;if(this.isReady!==!1){this.el.sceneEl.systems.arjs||this.el.sceneEl.systems.artoolkit,this._arAnchor.update();var U=this._arAnchor.object3d;if(U.updateMatrixWorld(!0),U.matrixWorld.decompose(this.el.object3D.position,this.el.object3D.quaternion,this.el.object3D.scale),re._arAnchor.parameters.changeMatrixMode==="modelViewMatrix"){var Y=re.el.object3D.visible;re.el.object3D.visible=this._arAnchor.object3d.visible}else if(re._arAnchor.parameters.changeMatrixMode==="cameraTransformMatrix"){var Y=re.el.sceneEl.object3D.visible;re.el.sceneEl.object3D.visible=this._arAnchor.object3d.visible}else console.assert(!1);re._arAnchor.object3d.visible===!0&&Y===!1?re.el.emit("markerFound"):re._arAnchor.object3d.visible===!1&&Y===!0&&re.el.emit("markerLost")}}}),AFRAME.registerPrimitive("a-anchor",AFRAME.utils.extendDeep({},AFRAME.primitives.getMeshMixin(),{defaultComponents:{"arjs-anchor":{},"arjs-hit-testing":{}},mappings:{type:"arjs-anchor.type",size:"arjs-anchor.size",url:"arjs-anchor.patternUrl",value:"arjs-anchor.barcodeValue",preset:"arjs-anchor.preset","min-confidence":"arjs-anchor.minConfidence","marker-helpers":"arjs-anchor.markerhelpers",smooth:"arjs-anchor.smooth","smooth-count":"arjs-anchor.smoothCount","smooth-tolerance":"arjs-anchor.smoothTolerance","smooth-threshold":"arjs-anchor.smoothThreshold","hit-testing-render-debug":"arjs-hit-testing.renderDebug","hit-testing-enabled":"arjs-hit-testing.enabled"}})),AFRAME.registerPrimitive("a-camera-static",AFRAME.utils.extendDeep({},AFRAME.primitives.getMeshMixin(),{defaultComponents:{camera:{}},mappings:{}})),AFRAME.registerPrimitive("a-marker",AFRAME.utils.extendDeep({},AFRAME.primitives.getMeshMixin(),{defaultComponents:{"arjs-anchor":{},"arjs-hit-testing":{}},mappings:{type:"arjs-anchor.type",size:"arjs-anchor.size",url:"arjs-anchor.patternUrl",value:"arjs-anchor.barcodeValue",preset:"arjs-anchor.preset","min-confidence":"arjs-anchor.minConfidence","marker-helpers":"arjs-anchor.markerhelpers",smooth:"arjs-anchor.smooth","smooth-count":"arjs-anchor.smoothCount","smooth-tolerance":"arjs-anchor.smoothTolerance","smooth-threshold":"arjs-anchor.smoothThreshold","hit-testing-render-debug":"arjs-hit-testing.renderDebug","hit-testing-enabled":"arjs-hit-testing.enabled"}})),AFRAME.registerPrimitive("a-marker-camera",AFRAME.utils.extendDeep({},AFRAME.primitives.getMeshMixin(),{defaultComponents:{"arjs-anchor":{changeMatrixMode:"cameraTransformMatrix"},camera:{}},mappings:{type:"arjs-anchor.type",size:"arjs-anchor.size",url:"arjs-anchor.patternUrl",value:"arjs-anchor.barcodeValue",preset:"arjs-anchor.preset","min-confidence":"arjs-anchor.minConfidence","marker-helpers":"arjs-anchor.markerhelpers"}})),AFRAME.registerComponent("arjs-hit-testing",{dependencies:["arjs","artoolkit"],schema:{enabled:{type:"boolean",default:!1},renderDebug:{type:"boolean",default:!1}},init:function(){var re=this,U=this.el.sceneEl.systems.arjs||this.el.sceneEl.systems.artoolkit;re.isReady=!1,re._arAnchor=null,re._arHitTesting=null;var Y=setInterval(function(){var ie=re.el,ne=ie.components["arjs-anchor"];if(!(ne===void 0||ne.isReady===!1)){clearInterval(Y),ne._arAnchor;var F=U._arSession;F.parameters.renderer;var fe=re._arHitTesting=new ARjs.HitTesting(F);fe.enabled=re.data.enabled,re.isReady=!0}},1e3/60)},remove:function(){},update:function(){},tick:function(){var re=this;if(this.isReady!==!1){var U=this.el.sceneEl.systems.arjs||this.el.sceneEl.systems.artoolkit,Y=U._arSession,ie=re.el,ne=ie.components["arjs-anchor"],F=ne._arAnchor,fe=this._arHitTesting,pe=Y.parameters.camera;fe.update(pe,F.object3d,F.parameters.changeMatrixMode)}}}),AFRAME.registerComponent("gps-camera-debug",{init:function(){this.current_coords_latitude,this.current_coords_longitude,this.origin_coords_latitude,this.origin_coords_longitude,this.camera_p_x,this.camera_p_z,this.entities=0,this._buildCameraDebugUI(document.body),this.current_coords_latitude=document.querySelector("#current_coords_latitude"),this.current_coords_longitude=document.querySelector("#current_coords_longitude"),this.origin_coords_latitude=document.querySelector("#origin_coords_latitude"),this.origin_coords_longitude=document.querySelector("#origin_coords_longitude"),this.camera_p_x=document.querySelector("#camera_p_x"),this.camera_p_z=document.querySelector("#camera_p_z"),this.placesLoadedEventHandler=function(){this.entities++;var re=document.querySelectorAll("[gps-entity-place]")&&document.querySelectorAll("[gps-entity-place]").length||0;re===this.entities&&(this._buildDistancesDebugUI(),window.removeEventListener("gps-entity-place-loaded",this.placesLoadedEventHandler.bind(this)),window.dispatchEvent(new CustomEvent("debug-ui-added")))},window.addEventListener("gps-entity-place-loaded",this.placesLoadedEventHandler.bind(this))},tick:function(){var re=document.querySelector("[gps-camera]"),U=re.getAttribute("position");this.camera_p_x.innerText=U.x.toFixed(6),this.camera_p_z.innerText=U.z.toFixed(6);var Y=re.components["gps-camera"];Y&&(Y.currentCoords&&(this.current_coords_longitude.innerText=Y.currentCoords.longitude.toFixed(6),this.current_coords_latitude.innerText=Y.currentCoords.latitude.toFixed(6)),Y.originCoords&&(this.origin_coords_longitude.innerText=Y.originCoords.longitude.toFixed(6),this.origin_coords_latitude.innerText=Y.originCoords.latitude.toFixed(6)))},_buildCameraDebugUI:function(re){var U=document.createElement("div");U.classList.add("debug");var Y=document.createElement("div");Y.innerText="current lng/lat coords: ";var ie=document.createElement("span");ie.id="current_coords_longitude";var ne=document.createElement("span");ne.id="current_coords_latitude",Y.appendChild(ie),Y.appendChild(ne),U.appendChild(Y);var F=document.createElement("div");F.innerText="origin lng/lat coords: ";var fe=document.createElement("span");fe.id="origin_coords_longitude";var pe=document.createElement("span");pe.id="origin_coords_latitude",F.appendChild(fe),F.appendChild(pe),U.appendChild(F);var Me=document.createElement("div");Me.innerText="camera 3d position: ";var ve=document.createElement("span");ve.id="camera_p_x";var se=document.createElement("span");se.id="camera_p_z",Me.appendChild(ve),Me.appendChild(se),U.appendChild(Me),re.appendChild(U)},_buildDistancesDebugUI:function(){var re=document.querySelector(".debug");document.querySelectorAll("[gps-entity-place]").forEach(function(U){var Y=document.createElement("div");Y.classList.add("debug-distance"),Y.innerHTML=U.getAttribute("value"),console.log(U.getAttribute("value")),Y.setAttribute("value",U.getAttribute("value")),re.appendChild(Y)})}}),AFRAME.registerComponent("gps-camera",{_watchPositionId:null,originCoords:null,currentCoords:null,lookControls:null,heading:null,schema:{simulateLatitude:{type:"number",default:0},simulateLongitude:{type:"number",default:0},simulateAltitude:{type:"number",default:0},positionMinAccuracy:{type:"int",default:100},alert:{type:"boolean",default:!1},minDistance:{type:"int",default:0}},init:function(){if(this.el.components["look-controls"]){this.loader=document.createElement("DIV"),this.loader.classList.add("arjs-loader"),document.body.appendChild(this.loader),window.addEventListener("gps-entity-place-added",(function(){this.originCoords&&(window.dispatchEvent(new CustomEvent("gps-camera-origin-coord-set")),console.debug("gps-camera-origin-coord-set")),this.loader&&this.loader.parentElement&&document.body.removeChild(this.loader)}).bind(this)),this.lookControls=this.el.components["look-controls"];var re=this._getDeviceOrientationEventName();if(this._onDeviceOrientation=this._onDeviceOrientation.bind(this),navigator.userAgent.match(/Version\/[\d.]+.*Safari/))if(typeof DeviceOrientationEvent.requestPermission=="function"){var U=function(){console.log("Requesting device orientation permissions..."),DeviceOrientationEvent.requestPermission(),document.removeEventListener("touchend",U)};document.addEventListener("touchend",function(){U()},!1),alert("After camera permission prompt, please tap the screen to activate geolocation.")}else{var Y=setTimeout(function(){alert("Please enable device orientation in Settings > Safari > Motion & Orientation Access.")},750);window.addEventListener(re,function(){clearTimeout(Y)})}window.addEventListener(re,this._onDeviceOrientation,!1),this._watchPositionId=this._initWatchGPS((function(ie){this.data.simulateLatitude!==0&&this.data.simulateLongitude!==0?(localPosition=Object.assign({},ie.coords),localPosition.longitude=this.data.simulateLongitude,localPosition.latitude=this.data.simulateLatitude,localPosition.altitude=this.data.simulateAltitude,this.currentCoords=localPosition):this.currentCoords=ie.coords,this._updatePosition()}).bind(this))}},tick:function(){this.heading!==null&&this._updateRotation()},remove:function(){this._watchPositionId&&navigator.geolocation.clearWatch(this._watchPositionId),this._watchPositionId=null;var re=this._getDeviceOrientationEventName();window.removeEventListener(re,this._onDeviceOrientation,!1)},_getDeviceOrientationEventName:function(){if("ondeviceorientationabsolute"in window)var re="deviceorientationabsolute";else if("ondeviceorientation"in window)var re="deviceorientation";else{var re="";console.error("Compass not supported")}return re},_initWatchGPS:function(re,U){return U||(U=function(Y){if(console.warn("ERROR("+Y.code+"): "+Y.message),Y.code===1){alert("Please activate Geolocation and refresh the page. If it is already active, please check permissions for this website.");return}if(Y.code===3){alert("Cannot retrieve GPS position. Signal is absent.");return}}),"geolocation"in navigator?navigator.geolocation.watchPosition(re,U,{enableHighAccuracy:!0,maximumAge:0,timeout:27e3}):(U({code:0,message:"Geolocation is not supported by your browser"}),Promise.resolve())},_updatePosition:function(){if(this.currentCoords.accuracy>this.data.positionMinAccuracy){if(this.data.alert&&!document.getElementById("alert-popup")){var re=document.createElement("div");re.innerHTML="GPS signal is very poor. Try move outdoor or to an area with a better signal.",re.setAttribute("id","alert-popup"),document.body.appendChild(re)}return}var U=document.getElementById("alert-popup");if(this.currentCoords.accuracy<=this.data.positionMinAccuracy&&U&&document.body.removeChild(U),this.originCoords)this._setPosition();else{this.originCoords=this.currentCoords,this._setPosition();var Y=document.querySelector(".arjs-loader");Y&&document.body.removeChild(Y),window.dispatchEvent(new CustomEvent("gps-camera-origin-coord-set")),console.debug("gps-camera-origin-coord-set")}},_setPosition:function(){var re=this.el.getAttribute("position"),U={longitude:this.currentCoords.longitude,latitude:this.originCoords.latitude};re.x=this.computeDistanceMeters(this.originCoords,U),re.x*=this.currentCoords.longitude>this.originCoords.longitude?1:-1;var U={longitude:this.originCoords.longitude,latitude:this.currentCoords.latitude};re.z=this.computeDistanceMeters(this.originCoords,U),re.z*=this.currentCoords.latitude>this.originCoords.latitude?-1:1,this.el.setAttribute("position",re),window.dispatchEvent(new CustomEvent("gps-camera-update-position",{detail:{position:this.currentCoords,origin:this.originCoords}}))},computeDistanceMeters:function(re,U,Y){var ie=THREE.Math.degToRad(U.longitude-re.longitude),ne=THREE.Math.degToRad(U.latitude-re.latitude),F=Math.sin(ne/2)*Math.sin(ne/2)+Math.cos(THREE.Math.degToRad(re.latitude))*Math.cos(THREE.Math.degToRad(U.latitude))*(Math.sin(ie/2)*Math.sin(ie/2)),fe=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F)),pe=fe*6378160;return Y&&this.data.minDistance&&this.data.minDistance>0&&pe<this.data.minDistance?Number.MAX_SAFE_INTEGER:pe},_computeCompassHeading:function(re,U,Y){var ie=re*(Math.PI/180),ne=U*(Math.PI/180),F=Y*(Math.PI/180),fe=Math.cos(ie),pe=Math.sin(ie),Me=Math.sin(ne),ve=Math.cos(F),se=Math.sin(F),me=-fe*se-pe*Me*ve,Te=-pe*se+fe*Me*ve,Re=Math.atan(me/Te);return Te<0?Re+=Math.PI:me<0&&(Re+=2*Math.PI),Re*=180/Math.PI,Re},_onDeviceOrientation:function(re){re.webkitCompassHeading!==void 0?re.webkitCompassAccuracy<50?this.heading=re.webkitCompassHeading:console.warn("webkitCompassAccuracy is event.webkitCompassAccuracy"):re.alpha!==null?re.absolute===!0||re.absolute===void 0?this.heading=this._computeCompassHeading(re.alpha,re.beta,re.gamma):console.warn("event.absolute === false"):console.warn("event.alpha === null")},_updateRotation:function(){var re=360-this.heading,U=this.el.getAttribute("rotation").y,Y=THREE.Math.radToDeg(this.lookControls.yawObject.rotation.y),ie=(re-(U-Y))%360;this.lookControls.yawObject.rotation.y=THREE.Math.degToRad(ie)}}),AFRAME.registerComponent("gps-entity-place",{_cameraGps:null,schema:{longitude:{type:"number",default:0},latitude:{type:"number",default:0}},init:function(){window.addEventListener("gps-camera-origin-coord-set",(function(){if(!this._cameraGps){var re=document.querySelector("[gps-camera]");if(!re.components["gps-camera"]){console.error("gps-camera not initialized");return}this._cameraGps=re.components["gps-camera"]}this._updatePosition()}).bind(this)),window.addEventListener("gps-camera-update-position",(function(re){if(!(!this.data||!this._cameraGps)){var U={longitude:this.data.longitude,latitude:this.data.latitude},Y=this._cameraGps.computeDistanceMeters(re.detail.position,U);this.el.setAttribute("distance",Y),this.el.setAttribute("distanceMsg",formatDistance(Y)),this.el.dispatchEvent(new CustomEvent("gps-entity-place-update-positon",{detail:{distance:Y}}))}}).bind(this)),this._positionXDebug=0,window.dispatchEvent(new CustomEvent("gps-entity-place-added")),console.debug("gps-entity-place-added"),this.debugUIAddedHandler=function(){this.setDebugData(this.el),window.removeEventListener("debug-ui-added",this.debugUIAddedHandler.bind(this))},window.addEventListener("debug-ui-added",this.debugUIAddedHandler.bind(this))},_updatePosition:function(){var re={x:0,y:this.el.getAttribute("position").y||0,z:0},U=!1,Y={longitude:this.data.longitude,latitude:this._cameraGps.originCoords.latitude};re.x=this._cameraGps.computeDistanceMeters(this._cameraGps.originCoords,Y,!0),re.x===Number.MAX_SAFE_INTEGER&&(U=!0),this._positionXDebug=re.x,re.x*=this.data.longitude>this._cameraGps.originCoords.longitude?1:-1;var Y={longitude:this._cameraGps.originCoords.longitude,latitude:this.data.latitude};re.z=this._cameraGps.computeDistanceMeters(this._cameraGps.originCoords,Y,!0),re.z===Number.MAX_SAFE_INTEGER&&(U=!0),re.z*=this.data.latitude>this._cameraGps.originCoords.latitude?-1:1,re.y!==0&&(re.y=re.y-this._cameraGps.originCoords.altitude),U?this.el.setAttribute("visible",!1):this.el.setAttribute("visible",!0),this.el.setAttribute("position",re)},setDebugData:function(re){var U=document.querySelectorAll(".debug-distance");U.forEach(function(Y){var ie=formatDistance(this._positionXDebug);re.getAttribute("value")==Y.getAttribute("value")&&(Y.innerHTML=Y.getAttribute("value")+": "+ie+"far")})}});function formatDistance(re){return re=re.toFixed(0),re>=1e3?re/1e3+" kilometers":re+" meters"}AFRAME.registerSystem("arjs",{schema:{trackingMethod:{type:"string",default:"best"},debugUIEnabled:{type:"boolean",default:!0},areaLearningButton:{type:"boolean",default:!0},performanceProfile:{type:"string",default:"default"},debug:{type:"boolean",default:!1},detectionMode:{type:"string",default:""},matrixCodeType:{type:"string",default:""},patternRatio:{type:"number",default:-1},labelingMode:{type:"string",default:""},cameraParametersUrl:{type:"string",default:""},maxDetectionRate:{type:"number",default:-1},sourceType:{type:"string",default:""},sourceUrl:{type:"string",default:""},sourceWidth:{type:"number",default:-1},sourceHeight:{type:"number",default:-1},deviceId:{type:"string",default:""},displayWidth:{type:"number",default:-1},displayHeight:{type:"number",default:-1},canvasWidth:{type:"number",default:-1},canvasHeight:{type:"number",default:-1}},init:function(){var re=this,U=this._arProfile=new ARjs.Profile().trackingMethod(this.data.trackingMethod).performance(this.data.performanceProfile).defaultMarker();this.data.debug!==!1&&(U.contextParameters.debug=this.data.debug),this.data.detectionMode!==""&&(U.contextParameters.detectionMode=this.data.detectionMode),this.data.matrixCodeType!==""&&(U.contextParameters.matrixCodeType=this.data.matrixCodeType),this.data.patternRatio!==-1&&(U.contextParameters.patternRatio=this.data.patternRatio),this.data.labelingMode!==""&&(U.contextParameters.labelingMode=this.data.labelingMode),this.data.cameraParametersUrl!==""&&(U.contextParameters.cameraParametersUrl=this.data.cameraParametersUrl),this.data.maxDetectionRate!==-1&&(U.contextParameters.maxDetectionRate=this.data.maxDetectionRate),this.data.canvasWidth!==-1&&(U.contextParameters.canvasWidth=this.data.canvasWidth),this.data.canvasHeight!==-1&&(U.contextParameters.canvasHeight=this.data.canvasHeight),this.data.sourceType!==""&&(U.sourceParameters.sourceType=this.data.sourceType),this.data.sourceUrl!==""&&(U.sourceParameters.sourceUrl=this.data.sourceUrl),this.data.sourceWidth!==-1&&(U.sourceParameters.sourceWidth=this.data.sourceWidth),this.data.sourceHeight!==-1&&(U.sourceParameters.sourceHeight=this.data.sourceHeight),this.data.deviceId!==""&&(U.sourceParameters.deviceId=this.data.deviceId),this.data.displayWidth!==-1&&(U.sourceParameters.displayWidth=this.data.displayWidth),this.data.displayHeight!==-1&&(U.sourceParameters.displayHeight=this.data.displayHeight),U.checkIfValid(),this._arSession=null,re.isReady=!1,re.needsOverride=!0,this.el.sceneEl.addEventListener("renderstart",function(){var ne=re.el.sceneEl.object3D,F=re.el.sceneEl.camera,fe=re.el.sceneEl.renderer,pe=re._arSession=new ARjs.Session({scene:ne,renderer:fe,camera:F,sourceParameters:U.sourceParameters,contextParameters:U.contextParameters});re.isReady=!0,window.addEventListener("resize",Me);function Me(){var se=re._arSession.arSource;U.contextParameters.trackingBackend!=="tango"&&se.copyElementSizeTo(document.body);var me=document.querySelector(".a-enter-vr");me&&(me.style.position="fixed")}re.data.debugUIEnabled&&ve();function ve(){var se=document.querySelector("#arjsDebugUIContainer");se===null&&(se=document.createElement("div"),se.id="arjsDebugUIContainer",se.setAttribute("style","position: fixed; bottom: 10px; width:100%; text-align: center; z-index: 1;color: grey;"),document.body.appendChild(se));var me=new ARjs.SessionDebugUI(pe);se.appendChild(me.domElement)}});var Y=Date.now(),ie=setInterval(function(){if(Date.now()-Y>1e4*1e3){clearInterval(ie);return}window.dispatchEvent(new Event("resize"))},1e3/30)},tick:function(re,U){this.isReady!==!1&&(this._arSession,this._arSession.update(),this._arSession.onResize())}})}(aframeAr_min)),aframeAr_min.exports}requireAframeAr_min();const ARModelViewer=()=>{const re="/webxr/model/sofa/wooden_sofa.glb";return jsxRuntimeExports.jsxs("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"},children:[jsxRuntimeExports.jsxs("a-scene",{embedded:!0,arjs:"sourceType: webcam; debugUIEnabled: false;",children:[jsxRuntimeExports.jsx("a-marker",{preset:"hiro",children:jsxRuntimeExports.jsx("a-entity",{"gltf-model":`url(${re})`,scale:"0.5 0.5 0.5",position:"0 0 0"})}),jsxRuntimeExports.jsx("a-entity",{camera:!0})]}),jsxRuntimeExports.jsx("model-viewer",{src:re,alt:"3D model","auto-rotate":!0,"camera-controls":!0,ar:!0,"ar-modes":"webxr scene-viewer quick-look",style:{width:"100%",height:"500px"}})]})};function App(){return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(ARModelViewer,{})})})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
